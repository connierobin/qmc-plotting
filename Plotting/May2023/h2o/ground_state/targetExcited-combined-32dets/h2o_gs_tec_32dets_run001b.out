Rank =    0  Free Memory = 45251 MB
Rank =    1  Free Memory = 45250 MB
Rank =    2  Free Memory = 45249 MB
Rank =    3  Free Memory = 45249 MB
Rank =    4  Free Memory = 45249 MB
Rank =    5  Free Memory = 45249 MB
Rank =    6  Free Memory = 45248 MB
Rank =    7  Free Memory = 45248 MB
Rank =    8  Free Memory = 45248 MB
Rank =    9  Free Memory = 45248 MB
Rank =   10  Free Memory = 45248 MB
Rank =   11  Free Memory = 45248 MB
Rank =   12  Free Memory = 45247 MB
Rank =   13  Free Memory = 45247 MB
Rank =   14  Free Memory = 45247 MB
Rank =   15  Free Memory = 45235 MB
Rank =   16  Free Memory = 45235 MB
Rank =   17  Free Memory = 45235 MB
Rank =   18  Free Memory = 45235 MB
Rank =   19  Free Memory = 45235 MB
Rank =   20  Free Memory = 45235 MB
Rank =   21  Free Memory = 45235 MB
Rank =   22  Free Memory = 45235 MB
Rank =   23  Free Memory = 45235 MB
Rank =   24  Free Memory = 45235 MB
Rank =   25  Free Memory = 45235 MB
Rank =   26  Free Memory = 45235 MB
Rank =   27  Free Memory = 45235 MB
Rank =   28  Free Memory = 45235 MB
Rank =   29  Free Memory = 45235 MB
Rank =   30  Free Memory = 45235 MB
Rank =   31  Free Memory = 45235 MB
Rank =   32  Free Memory = 68121 MB
Rank =   33  Free Memory = 68121 MB
Rank =   34  Free Memory = 68121 MB
Rank =   35  Free Memory = 68121 MB
Rank =   36  Free Memory = 68121 MB
Rank =   37  Free Memory = 68121 MB
Rank =   38  Free Memory = 68121 MB
Rank =   39  Free Memory = 68121 MB
Rank =   40  Free Memory = 68121 MB
Rank =   41  Free Memory = 68121 MB
Rank =   42  Free Memory = 68121 MB
Rank =   43  Free Memory = 68121 MB
Rank =   44  Free Memory = 68121 MB
Rank =   45  Free Memory = 68121 MB
Rank =   46  Free Memory = 68121 MB
Rank =   47  Free Memory = 68121 MB
Rank =   48  Free Memory = 68121 MB
Rank =   49  Free Memory = 68121 MB
Rank =   50  Free Memory = 68121 MB
Rank =   51  Free Memory = 68121 MB
Rank =   52  Free Memory = 68121 MB
Rank =   53  Free Memory = 68121 MB
Rank =   54  Free Memory = 68121 MB
Rank =   55  Free Memory = 68121 MB
Rank =   56  Free Memory = 68121 MB
Rank =   57  Free Memory = 68121 MB
Rank =   58  Free Memory = 68121 MB
Rank =   59  Free Memory = 68121 MB
Rank =   60  Free Memory = 68121 MB
Rank =   61  Free Memory = 68121 MB
Rank =   62  Free Memory = 68121 MB
Rank =   63  Free Memory = 68121 MB
Rank =   64  Free Memory = 73064 MB
Rank =   65  Free Memory = 73063 MB
Rank =   66  Free Memory = 73062 MB
Rank =   67  Free Memory = 73062 MB
Rank =   68  Free Memory = 73062 MB
Rank =   69  Free Memory = 73062 MB
Rank =   70  Free Memory = 73062 MB
Rank =   71  Free Memory = 73062 MB
Rank =   72  Free Memory = 73062 MB
Rank =   73  Free Memory = 73062 MB
Rank =   74  Free Memory = 73062 MB
Rank =   75  Free Memory = 73062 MB
Rank =   76  Free Memory = 73062 MB
Rank =   77  Free Memory = 73062 MB
Rank =   78  Free Memory = 73062 MB
Rank =   79  Free Memory = 73062 MB
Rank =   80  Free Memory = 73062 MB
Rank =   81  Free Memory = 73062 MB
Rank =   82  Free Memory = 73062 MB
Rank =   83  Free Memory = 73062 MB
Rank =   84  Free Memory = 73062 MB
Rank =   85  Free Memory = 73062 MB
Rank =   86  Free Memory = 73062 MB
Rank =   87  Free Memory = 73062 MB
Rank =   88  Free Memory = 73062 MB
Rank =   89  Free Memory = 73062 MB
Rank =   90  Free Memory = 73062 MB
Rank =   91  Free Memory = 73062 MB
Rank =   92  Free Memory = 73062 MB
Rank =   93  Free Memory = 73062 MB
Rank =   94  Free Memory = 73062 MB
Rank =   95  Free Memory = 73062 MB
Rank =   96  Free Memory = 42701 MB
Rank =   97  Free Memory = 42701 MB
Rank =   98  Free Memory = 42701 MB
Rank =   99  Free Memory = 42700 MB
Rank =  100  Free Memory = 42700 MB
Rank =  101  Free Memory = 42700 MB
Rank =  102  Free Memory = 42700 MB
Rank =  103  Free Memory = 42700 MB
Rank =  104  Free Memory = 42700 MB
Rank =  105  Free Memory = 42700 MB
Rank =  106  Free Memory = 42700 MB
Rank =  107  Free Memory = 42700 MB
Rank =  108  Free Memory = 42700 MB
Rank =  109  Free Memory = 42700 MB
Rank =  110  Free Memory = 42700 MB
Rank =  111  Free Memory = 42700 MB
Rank =  112  Free Memory = 42700 MB
Rank =  113  Free Memory = 42700 MB
Rank =  114  Free Memory = 42700 MB
Rank =  115  Free Memory = 42700 MB
Rank =  116  Free Memory = 42700 MB
Rank =  117  Free Memory = 42700 MB
Rank =  118  Free Memory = 42700 MB
Rank =  119  Free Memory = 42700 MB
Rank =  120  Free Memory = 42700 MB
Rank =  121  Free Memory = 42700 MB
Rank =  122  Free Memory = 42700 MB
Rank =  123  Free Memory = 42700 MB
Rank =  124  Free Memory = 42700 MB
Rank =  125  Free Memory = 42700 MB
Rank =  126  Free Memory = 42700 MB
Rank =  127  Free Memory = 42700 MB
  Input file(s): opt_h2o_gs_tec_32dets_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_tec_32dets_run001b.xml

  Project = H2O
  date    = 2023-05-07 17:46:36 PDT
  host    = n0052.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 620

  Range of prime numbers to use as seeds over processors and threads = 4597-5693


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.086608e-01    1         1  ON     0
     uu_1                 5.155669e-02    1         1  ON     1
     uu_2                -3.952686e-02    1         1  ON     2
     uu_3                -9.307196e-02    1         1  ON     3
     uu_4                -1.241176e-01    1         1  ON     4
     uu_5                -1.321754e-01    1         1  ON     5
     uu_6                -1.137541e-01    1         1  ON     6
     uu_7                -5.363770e-02    1         1  ON     7
     uu_8                 7.279945e-02    1         1  ON     8
     uu_9                 1.239382e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.085154e-01    1         1  ON     0
     ud_1                 7.844879e-02    1         1  ON     1
     ud_2                -2.368269e-02    1         1  ON     2
     ud_3                -7.705090e-02    1         1  ON     3
     ud_4                -1.140967e-01    1         1  ON     4
     ud_5                -1.346905e-01    1         1  ON     5
     ud_6                -1.310257e-01    1         1  ON     6
     ud_7                -9.038838e-02    1         1  ON     7
     ud_8                -4.135093e-03    1         1  ON     8
     ud_9                 8.825018e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.054827e-01    1         1  ON     0
     eO_1                -4.211440e-01    1         1  ON     1
     eO_2                -4.112224e-02    1         1  ON     2
     eO_3                 1.874217e-01    1         1  ON     3
     eO_4                 2.618045e-01    1         1  ON     4
     eO_5                 2.857790e-01    1         1  ON     5
     eO_6                 2.495686e-01    1         1  ON     6
     eO_7                 1.247020e-01    1         1  ON     7
     eO_8                 2.846476e-02    1         1  ON     8
     eO_9                 1.891541e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.019547e-01    1         1  ON     0
     eH1_1                -9.788255e-02    1         1  ON     1
     eH1_2                -4.727392e-02    1         1  ON     2
     eH1_3                -1.575868e-02    1         1  ON     3
     eH1_4                 1.899088e-02    1         1  ON     4
     eH1_5                 2.692052e-02    1         1  ON     5
     eH1_6                 7.513168e-02    1         1  ON     6
     eH1_7                 1.041385e-01    1         1  ON     7
     eH1_8                 9.682015e-02    1         1  ON     8
     eH1_9                 2.514611e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.029967e-01    1         1  ON     0
     eH2_1                -1.001575e-01    1         1  ON     1
     eH2_2                -4.953665e-02    1         1  ON     2
     eH2_3                -1.804713e-02    1         1  ON     3
     eH2_4                 1.648580e-02    1         1  ON     4
     eH2_5                 2.364186e-02    1         1  ON     5
     eH2_6                 7.815314e-02    1         1  ON     6
     eH2_7                 1.128118e-01    1         1  ON     7
     eH2_8                 9.938978e-02    1         1  ON     8
     eH2_9                 2.785337e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 32 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.679917e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 11 unique up determinants.
Found 11 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.0525e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 81
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2299
    reference variance = 0.202754
====================================================
  Execution time = 3.8542e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5399e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9460e-01
  Total weights = 1.973769267e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0822e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288459498937
                                         uncertainty =       0.001968041162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288459498937
                                         uncertainty =       0.001968041162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379783049
  error estimate for blocks of size 2^( 2) =       0.000394621518
  error estimate for blocks of size 2^( 3) =       0.000408269749
  error estimate for blocks of size 2^( 4) =       0.000418363973
  error estimate for blocks of size 2^( 5) =       0.000422396409
  error estimate for blocks of size 2^( 6) =       0.000425446369
  error estimate for blocks of size 2^( 7) =       0.000428452078

      target function =      -0.921170580252
              le_mean =     -17.206662208028
             les_mean =     296.363823095017
             stat err =       0.000423664707
             autocorr =       1.244438445461
   target nu stat err =       0.000423664707
   target dn stat err =       0.002280468790
      target stat err =       0.003659474399
              std dev =       0.537094339299
             le_variance =       0.288470329307


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.720666220803e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921183949545       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921239858221       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921256886320       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921264833749       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921267482732       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921267753866       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921268838712       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921269555405       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921271381933       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921271262779       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921272409139       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921272640341       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921273978123       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921273899490       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921273674149       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921273568670       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921273671261       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921274107473       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921274819380       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921274852285       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921274953817       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921274668783       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921274835229       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921274974701       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921274952278       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921274984661       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921274992754       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921274925258       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921274900404       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921274986181       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921275033776       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.921275150068       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.921275198530       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.921275224068       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.921275290364       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.921275332711       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.921275356111       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.921275368111       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.921275384423       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.921275340356       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e-01 is 1.490082e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921183949545       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921200932657       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921205941403       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921208246072       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921208962165       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921209005921       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921209323927       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921209530402       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921210036992       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921210003661       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921210342652       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921210402412       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921210740694       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921210685547       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921210617961       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921210587257       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921210632508       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921210772663       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921210919088       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921210898960       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921210925003       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921210868206       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921210893484       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921210942717       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921210939245       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921210929620       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921210933107       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921210915695       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921210920005       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921210932142       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921210948151       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.921210966801       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.921210981756       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.921210989726       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.921211000096       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.921211006713       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.921211009323       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.921211013980       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.921211013389       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.0000e+00 is 3.914459e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921183949545       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921188436553       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921189746159       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921190346723       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921190528788       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921190537108       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921190620341       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921190673880       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921190803726       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921190795370       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921190884511       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921190899277       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921190983157       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921190966472       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921190948967       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921190941302       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921190954423       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921190991213       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921191024956       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921191017794       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921191024544       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921191011665       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921191017164       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921191030081       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921191028888       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921191026236       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921191026425       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921191022721       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921191024220       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921191027008       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921191030905       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.921191034992       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.921191038594       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.921191040980       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.921191042897       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.921191044269       residual = 9.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 4.0000e+00 is 9.962748e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136761 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9511e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0   2.086593e-01                 1 1 ON  0
uu_1   5.157340e-02                 1 1 ON  1
uu_2   -3.948123e-02                1 1 ON  2
uu_3   -9.300463e-02                1 1 ON  3
uu_4   -1.240389e-01                1 1 ON  4
uu_5   -1.320654e-01                1 1 ON  5
uu_6   -1.137503e-01                1 1 ON  6
uu_7   -5.389925e-02                1 1 ON  7
uu_8   7.248354e-02                 1 1 ON  8
uu_9   1.240055e-01                 1 1 ON  9
ud_0   3.083787e-01                 1 1 ON  10
ud_1   7.836593e-02                 1 1 ON  11
ud_2   -2.374522e-02                1 1 ON  12
ud_3   -7.710268e-02                1 1 ON  13
ud_4   -1.140656e-01                1 1 ON  14
ud_5   -1.345943e-01                1 1 ON  15
ud_6   -1.308143e-01                1 1 ON  16
ud_7   -9.032081e-02                1 1 ON  17
ud_8   -4.316008e-03                1 1 ON  18
ud_9   8.819337e-02                 1 1 ON  19
eO_0   -7.052737e-01                1 1 ON  20
eO_1   -4.209765e-01                1 1 ON  21
eO_2   -4.106135e-02                1 1 ON  22
eO_3   1.873695e-01                 1 1 ON  23
eO_4   2.616232e-01                 1 1 ON  24
eO_5   2.853875e-01                 1 1 ON  25
eO_6   2.494189e-01                 1 1 ON  26
eO_7   1.249644e-01                 1 1 ON  27
eO_8   2.851256e-02                 1 1 ON  28
eO_9   1.893128e-02                 1 1 ON  29
eH1_0  -2.018675e-01                1 1 ON  30
eH1_1  -9.781206e-02                1 1 ON  31
eH1_2  -4.712858e-02                1 1 ON  32
eH1_3  -1.569092e-02                1 1 ON  33
eH1_4  1.892974e-02                 1 1 ON  34
eH1_5  2.662682e-02                 1 1 ON  35
eH1_6  7.503198e-02                 1 1 ON  36
eH1_7  1.040218e-01                 1 1 ON  37
eH1_8  9.693711e-02                 1 1 ON  38
eH1_9  2.519692e-02                 1 1 ON  39
eH2_0  -2.030674e-01                1 1 ON  40
eH2_1  -1.000394e-01                1 1 ON  41
eH2_2  -4.943613e-02                1 1 ON  42
eH2_3  -1.795765e-02                1 1 ON  43
eH2_4  1.649070e-02                 1 1 ON  44
eH2_5  2.347468e-02                 1 1 ON  45
eH2_6  7.798660e-02                 1 1 ON  46
eH2_7  1.127884e-01                 1 1 ON  47
eH2_8  9.950255e-02                 1 1 ON  48
eH2_9  2.786126e-02                 1 1 ON  49
ci_001 -4.264934e-02                3 1 ON  50
ci_002 -3.182626e-02                3 1 ON  51
ci_003 -1.248557e-02                3 1 ON  52
ci_004 2.581976e-02                 3 1 ON  53
ci_005 2.596954e-02                 3 1 ON  54
ci_006 -2.095170e-02                3 1 ON  55
ci_007 -2.067357e-02                3 1 ON  56
ci_008 -5.136760e-03                3 1 ON  57
ci_009 -1.556076e-02                3 1 ON  58
ci_010 -1.069150e-02                3 1 ON  59
ci_011 -1.052229e-02                3 1 ON  60
ci_012 -1.068515e-02                3 1 ON  61
ci_013 -2.144829e-02                3 1 ON  62
ci_014 1.389269e-02                 3 1 ON  63
ci_015 1.350895e-02                 3 1 ON  64
ci_016 1.684442e-02                 3 1 ON  65
ci_017 1.609413e-02                 3 1 ON  66
ci_018 1.114781e-02                 3 1 ON  67
ci_019 1.088096e-02                 3 1 ON  68
ci_020 1.827051e-02                 3 1 ON  69
ci_021 1.791993e-02                 3 1 ON  70
ci_022 1.041295e-02                 3 1 ON  71
ci_023 1.095428e-02                 3 1 ON  72
ci_024 7.225778e-03                 3 1 ON  73
ci_025 7.254204e-03                 3 1 ON  74
ci_026 1.199205e-02                 3 1 ON  75
ci_027 1.216998e-02                 3 1 ON  76
ci_028 -1.007654e-02                3 1 ON  77
ci_029 -9.913480e-03                3 1 ON  78
ci_030 -4.866150e-03                3 1 ON  79
ci_031 -5.066001e-03                3 1 ON  80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2351
    reference variance = 0.215627
====================================================
  Execution time = 3.8008e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0234e-01
  Total weights = 1.9736e+06
  Execution time = 3.2482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290691370529
                                         uncertainty =       0.002387018820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290691370529
                                         uncertainty =       0.002387018820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381262633
  error estimate for blocks of size 2^( 2) =       0.000396394182
  error estimate for blocks of size 2^( 3) =       0.000409681671
  error estimate for blocks of size 2^( 4) =       0.000419836970
  error estimate for blocks of size 2^( 5) =       0.000426226525
  error estimate for blocks of size 2^( 6) =       0.000430524356
  error estimate for blocks of size 2^( 7) =       0.000433708968

      target function =      -0.909249872668
              le_mean =     -17.206345319119
             les_mean =     296.360572755805
             stat err =       0.000427574205
             autocorr =       1.257692607850
   target nu stat err =       0.000427574205
   target dn stat err =       0.004778382447
      target stat err =       0.007354680644
              std dev =       0.539186785988
             le_variance =       0.290722390184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290531246762
                                         uncertainty =       0.002362990267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290531246762
                                         uncertainty =       0.002362990267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381157186
  error estimate for blocks of size 2^( 2) =       0.000396370773
  error estimate for blocks of size 2^( 3) =       0.000409746461
  error estimate for blocks of size 2^( 4) =       0.000419954917
  error estimate for blocks of size 2^( 5) =       0.000426378721
  error estimate for blocks of size 2^( 6) =       0.000430705173
  error estimate for blocks of size 2^( 7) =       0.000433907703

      target function =      -0.898177802714
              le_mean =     -17.206342382631
             les_mean =     296.367701690808
             stat err =       0.000427736629
             autocorr =       1.259344820323
   target nu stat err =       0.000427736629
   target dn stat err =       0.008718431837
      target stat err =       0.013052519402
              std dev =       0.539037661620
             le_variance =       0.290561600645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290592493035
                                         uncertainty =       0.002372953611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290592493035
                                         uncertainty =       0.002372953611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381197536
  error estimate for blocks of size 2^( 2) =       0.000396377958
  error estimate for blocks of size 2^( 3) =       0.000409717625
  error estimate for blocks of size 2^( 4) =       0.000419904326
  error estimate for blocks of size 2^( 5) =       0.000426312528
  error estimate for blocks of size 2^( 6) =       0.000430624212
  error estimate for blocks of size 2^( 7) =       0.000433818398

      target function =      -0.904509118970
              le_mean =     -17.206342656520
             les_mean =     296.363578540082
             stat err =       0.000427664866
             autocorr =       1.258655785098
   target nu stat err =       0.000427664866
   target dn stat err =       0.005596936904
      target stat err =       0.008514357609
              std dev =       0.539094725619
             le_variance =       0.290623123190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290677549208
                                         uncertainty =       0.002385161516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290677549208
                                         uncertainty =       0.002385161516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381253537
  error estimate for blocks of size 2^( 2) =       0.000396391486
  error estimate for blocks of size 2^( 3) =       0.000409685822
  error estimate for blocks of size 2^( 4) =       0.000419845281
  error estimate for blocks of size 2^( 5) =       0.000426237391
  error estimate for blocks of size 2^( 6) =       0.000430537217
  error estimate for blocks of size 2^( 7) =       0.000433723325

      target function =      -0.909244148953
              le_mean =     -17.206344912592
             les_mean =     296.360562567632
             stat err =       0.000427585803
             autocorr =       1.257820858660
   target nu stat err =       0.000427585803
   target dn stat err =       0.004774872571
      target stat err =       0.007349233828
              std dev =       0.539173922272
             le_variance =       0.290708518458


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909249872668        initial  <--
     2.5000e-01     2.5000e+00             1.4901e-03        -0.898177802714
     1.0000e+00     1.0000e+01             3.9145e-04        -0.904509118970
     4.0000e+00     4.0000e+01             9.9627e-05        -0.909244148953

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.3673
  </log>
  <optVariables href="H2O.s000.opt.xml">
  uu_0                 2.086608e-01 1 1  ON 0
  uu_1                 5.155669e-02 1 1  ON 1
  uu_2                -3.952686e-02 1 1  ON 2
  uu_3                -9.307196e-02 1 1  ON 3
  uu_4                -1.241176e-01 1 1  ON 4
  uu_5                -1.321754e-01 1 1  ON 5
  uu_6                -1.137541e-01 1 1  ON 6
  uu_7                -5.363770e-02 1 1  ON 7
  uu_8                 7.279945e-02 1 1  ON 8
  uu_9                 1.239382e-01 1 1  ON 9
  ud_0                 3.085154e-01 1 1  ON 10
  ud_1                 7.844879e-02 1 1  ON 11
  ud_2                -2.368269e-02 1 1  ON 12
  ud_3                -7.705090e-02 1 1  ON 13
  ud_4                -1.140967e-01 1 1  ON 14
  ud_5                -1.346905e-01 1 1  ON 15
  ud_6                -1.310257e-01 1 1  ON 16
  ud_7                -9.038838e-02 1 1  ON 17
  ud_8                -4.135093e-03 1 1  ON 18
  ud_9                 8.825018e-02 1 1  ON 19
  eO_0                -7.054827e-01 1 1  ON 20
  eO_1                -4.211440e-01 1 1  ON 21
  eO_2                -4.112224e-02 1 1  ON 22
  eO_3                 1.874217e-01 1 1  ON 23
  eO_4                 2.618045e-01 1 1  ON 24
  eO_5                 2.857790e-01 1 1  ON 25
  eO_6                 2.495686e-01 1 1  ON 26
  eO_7                 1.247020e-01 1 1  ON 27
  eO_8                 2.846476e-02 1 1  ON 28
  eO_9                 1.891541e-02 1 1  ON 29
 eH1_0                -2.019547e-01 1 1  ON 30
 eH1_1                -9.788255e-02 1 1  ON 31
 eH1_2                -4.727392e-02 1 1  ON 32
 eH1_3                -1.575868e-02 1 1  ON 33
 eH1_4                 1.899088e-02 1 1  ON 34
 eH1_5                 2.692052e-02 1 1  ON 35
 eH1_6                 7.513168e-02 1 1  ON 36
 eH1_7                 1.041385e-01 1 1  ON 37
 eH1_8                 9.682015e-02 1 1  ON 38
 eH1_9                 2.514611e-02 1 1  ON 39
 eH2_0                -2.029967e-01 1 1  ON 40
 eH2_1                -1.001575e-01 1 1  ON 41
 eH2_2                -4.953665e-02 1 1  ON 42
 eH2_3                -1.804713e-02 1 1  ON 43
 eH2_4                 1.648580e-02 1 1  ON 44
 eH2_5                 2.364186e-02 1 1  ON 45
 eH2_6                 7.815314e-02 1 1  ON 46
 eH2_7                 1.128118e-01 1 1  ON 47
 eH2_8                 9.938978e-02 1 1  ON 48
 eH2_9                 2.785337e-02 1 1  ON 49
ci_001                -4.278737e-02 3 1  ON 50
ci_002                -3.188122e-02 3 1  ON 51
ci_003                -1.253443e-02 3 1  ON 52
ci_004                 2.581348e-02 3 1  ON 53
ci_005                 2.602886e-02 3 1  ON 54
ci_006                -2.099298e-02 3 1  ON 55
ci_007                -2.075923e-02 3 1  ON 56
ci_008                -5.180412e-03 3 1  ON 57
ci_009                -1.560395e-02 3 1  ON 58
ci_010                -1.075455e-02 3 1  ON 59
ci_011                -1.057934e-02 3 1  ON 60
ci_012                -1.068346e-02 3 1  ON 61
ci_013                -2.151738e-02 3 1  ON 62
ci_014                 1.390516e-02 3 1  ON 63
ci_015                 1.356934e-02 3 1  ON 64
ci_016                 1.688731e-02 3 1  ON 65
ci_017                 1.609523e-02 3 1  ON 66
ci_018                 1.124470e-02 3 1  ON 67
ci_019                 1.086197e-02 3 1  ON 68
ci_020                 1.823821e-02 3 1  ON 69
ci_021                 1.787323e-02 3 1  ON 70
ci_022                 1.041364e-02 3 1  ON 71
ci_023                 1.097589e-02 3 1  ON 72
ci_024                 7.251450e-03 3 1  ON 73
ci_025                 7.368422e-03 3 1  ON 74
ci_026                 1.202754e-02 3 1  ON 75
ci_027                 1.219211e-02 3 1  ON 76
ci_028                -1.016849e-02 3 1  ON 77
ci_029                -9.940560e-03 3 1  ON 78
ci_030                -4.858133e-03 3 1  ON 79
ci_031                -5.141705e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0389e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7233e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1659
    reference variance = 0.188577
====================================================
  Execution time = 3.8627e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5398e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 2.9790e-01
  Total weights = 1.973424637e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1172e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290272340390
                                         uncertainty =       0.002084367317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290272340390
                                         uncertainty =       0.002084367317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380954370
  error estimate for blocks of size 2^( 2) =       0.000395865010
  error estimate for blocks of size 2^( 3) =       0.000409488775
  error estimate for blocks of size 2^( 4) =       0.000418765378
  error estimate for blocks of size 2^( 5) =       0.000423820521
  error estimate for blocks of size 2^( 6) =       0.000427178958
  error estimate for blocks of size 2^( 7) =       0.000428513124

      target function =      -0.915974838478
              le_mean =     -17.207576258712
             les_mean =     296.398585052259
             stat err =       0.000424569495
             autocorr =       1.242085967623
   target nu stat err =       0.000424569495
   target dn stat err =       0.002699430790
      target stat err =       0.004267223101
              std dev =       0.538750836572
             le_variance =       0.290252463908


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720757625871e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915993727587       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916004510871       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916009851369       residual = 5.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916011039006       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916011498158       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916012233480       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916012759544       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916013518836       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916013873260       residual = 7.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916014148872       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916014346399       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916014444601       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916014693178       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916014857788       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916014869237       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916014842472       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916014914042       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916014954918       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916014898583       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916014918607       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916014941488       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916014974760       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916014976095       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916014997447       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916015039454       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916015037449       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916015058455       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916015064295       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916015074374       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916015068417       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916015066239       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916015084767       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916015085256       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916015091048       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916015093150       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916015094889       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916015098649       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916015096318       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916015095482       residual = 7.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e+00 is 2.167546e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915993727587       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915996482293       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915997843487       residual = 5.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915998145277       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915998261377       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915998447419       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915998581228       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915998774170       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915998862742       residual = 7.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915998932472       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915998982590       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915999006865       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915999069954       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915999110399       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915999112813       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915999105667       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915999124472       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915999133521       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915999119553       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915999124791       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915999130648       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915999138738       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915999139152       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915999144166       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915999154725       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915999154024       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915999159113       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915999160595       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915999162969       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915999161444       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915999160951       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915999165537       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915999165630       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915999166954       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915999167453       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915999167930       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915999168811       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915999168217       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915999168012       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.0000e+01 is 5.479625e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915993727587       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915994420045       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915994762013       residual = 5.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915994837771       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915994866882       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915994913531       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915994947129       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915994995563       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915995017703       residual = 7.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915995035189       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915995047764       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915995053814       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915995069647       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915995079710       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915995080286       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915995078470       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915995083231       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915995085415       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915995081934       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915995083260       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915995084730       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915995086738       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915995086846       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915995088079       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915995090723       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915995090535       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915995091798       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915995092169       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915995092753       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915995092370       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915995092250       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915995093394       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915995093414       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915995093738       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915995093861       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915995093983       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915995094199       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915995094051       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915995093999       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 4.0000e+01 is 1.373767e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199914 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9869e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 2.086523e-01 1 1  ON 0
  uu_1                 5.155582e-02 1 1  ON 1
  uu_2                -3.952762e-02 1 1  ON 2
  uu_3                -9.307211e-02 1 1  ON 3
  uu_4                -1.241178e-01 1 1  ON 4
  uu_5                -1.321693e-01 1 1  ON 5
  uu_6                -1.137319e-01 1 1  ON 6
  uu_7                -5.363485e-02 1 1  ON 7
  uu_8                 7.275388e-02 1 1  ON 8
  uu_9                 1.239411e-01 1 1  ON 9
  ud_0                 3.084841e-01 1 1  ON 10
  ud_1                 7.842959e-02 1 1  ON 11
  ud_2                -2.370139e-02 1 1  ON 12
  ud_3                -7.706105e-02 1 1  ON 13
  ud_4                -1.140890e-01 1 1  ON 14
  ud_5                -1.346640e-01 1 1  ON 15
  ud_6                -1.310056e-01 1 1  ON 16
  ud_7                -9.035758e-02 1 1  ON 17
  ud_8                -4.152258e-03 1 1  ON 18
  ud_9                 8.824283e-02 1 1  ON 19
  eO_0                -7.054684e-01 1 1  ON 20
  eO_1                -4.211416e-01 1 1  ON 21
  eO_2                -4.114139e-02 1 1  ON 22
  eO_3                 1.873789e-01 1 1  ON 23
  eO_4                 2.617497e-01 1 1  ON 24
  eO_5                 2.858105e-01 1 1  ON 25
  eO_6                 2.496052e-01 1 1  ON 26
  eO_7                 1.247268e-01 1 1  ON 27
  eO_8                 2.846861e-02 1 1  ON 28
  eO_9                 1.891759e-02 1 1  ON 29
 eH1_0                -2.019407e-01 1 1  ON 30
 eH1_1                -9.786465e-02 1 1  ON 31
 eH1_2                -4.724922e-02 1 1  ON 32
 eH1_3                -1.574381e-02 1 1  ON 33
 eH1_4                 1.898826e-02 1 1  ON 34
 eH1_5                 2.688897e-02 1 1  ON 35
 eH1_6                 7.509486e-02 1 1  ON 36
 eH1_7                 1.041230e-01 1 1  ON 37
 eH1_8                 9.682862e-02 1 1  ON 38
 eH1_9                 2.515180e-02 1 1  ON 39
 eH2_0                -2.030057e-01 1 1  ON 40
 eH2_1                -1.001427e-01 1 1  ON 41
 eH2_2                -4.952300e-02 1 1  ON 42
 eH2_3                -1.803972e-02 1 1  ON 43
 eH2_4                 1.648654e-02 1 1  ON 44
 eH2_5                 2.363054e-02 1 1  ON 45
 eH2_6                 7.813267e-02 1 1  ON 46
 eH2_7                 1.127925e-01 1 1  ON 47
 eH2_8                 9.940641e-02 1 1  ON 48
 eH2_9                 2.785824e-02 1 1  ON 49
ci_001                -4.277939e-02 3 1  ON 50
ci_002                -3.187437e-02 3 1  ON 51
ci_003                -1.253385e-02 3 1  ON 52
ci_004                 2.581046e-02 3 1  ON 53
ci_005                 2.601941e-02 3 1  ON 54
ci_006                -2.097994e-02 3 1  ON 55
ci_007                -2.075387e-02 3 1  ON 56
ci_008                -5.178331e-03 3 1  ON 57
ci_009                -1.560726e-02 3 1  ON 58
ci_010                -1.073774e-02 3 1  ON 59
ci_011                -1.058126e-02 3 1  ON 60
ci_012                -1.067350e-02 3 1  ON 61
ci_013                -2.152498e-02 3 1  ON 62
ci_014                 1.390905e-02 3 1  ON 63
ci_015                 1.356133e-02 3 1  ON 64
ci_016                 1.689006e-02 3 1  ON 65
ci_017                 1.610156e-02 3 1  ON 66
ci_018                 1.123951e-02 3 1  ON 67
ci_019                 1.086204e-02 3 1  ON 68
ci_020                 1.822760e-02 3 1  ON 69
ci_021                 1.786930e-02 3 1  ON 70
ci_022                 1.041595e-02 3 1  ON 71
ci_023                 1.098230e-02 3 1  ON 72
ci_024                 7.251913e-03 3 1  ON 73
ci_025                 7.354166e-03 3 1  ON 74
ci_026                 1.202629e-02 3 1  ON 75
ci_027                 1.218847e-02 3 1  ON 76
ci_028                -1.015531e-02 3 1  ON 77
ci_029                -9.937936e-03 3 1  ON 78
ci_030                -4.851645e-03 3 1  ON 79
ci_031                -5.150152e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1579
    reference variance = 0.199992
====================================================
  Execution time = 3.8532e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0602e-01
  Total weights = 1.9736e+06
  Execution time = 3.2339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296215623030
                                         uncertainty =       0.002714032917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296215623030
                                         uncertainty =       0.002714032917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384816682
  error estimate for blocks of size 2^( 2) =       0.000399416630
  error estimate for blocks of size 2^( 3) =       0.000412484399
  error estimate for blocks of size 2^( 4) =       0.000422160347
  error estimate for blocks of size 2^( 5) =       0.000428749448
  error estimate for blocks of size 2^( 6) =       0.000432394432
  error estimate for blocks of size 2^( 7) =       0.000433729730

      target function =      -0.903503288684
              le_mean =     -17.206388122285
             les_mean =     296.365830305395
             stat err =       0.000429258489
             autocorr =       1.244314048095
   target nu stat err =       0.000429258489
   target dn stat err =       0.004086522511
      target stat err =       0.006222706135
              std dev =       0.544212970623
             le_variance =       0.296167757394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296191010801
                                         uncertainty =       0.002711926961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296191010801
                                         uncertainty =       0.002711926961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384800838
  error estimate for blocks of size 2^( 2) =       0.000399412456
  error estimate for blocks of size 2^( 3) =       0.000412492964
  error estimate for blocks of size 2^( 4) =       0.000422178104
  error estimate for blocks of size 2^( 5) =       0.000428773251
  error estimate for blocks of size 2^( 6) =       0.000432419914
  error estimate for blocks of size 2^( 7) =       0.000433754141

      target function =      -0.903587798862
              le_mean =     -17.206388105961
             les_mean =     296.365773905737
             stat err =       0.000429281353
             autocorr =       1.244549079665
   target nu stat err =       0.000429281353
   target dn stat err =       0.004084043193
      target stat err =       0.006220140765
              std dev =       0.544190564592
             le_variance =       0.296143370591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296202945329
                                         uncertainty =       0.002712954082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296202945329
                                         uncertainty =       0.002712954082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384808520
  error estimate for blocks of size 2^( 2) =       0.000399414406
  error estimate for blocks of size 2^( 3) =       0.000412488653
  error estimate for blocks of size 2^( 4) =       0.000422169278
  error estimate for blocks of size 2^( 5) =       0.000428761459
  error estimate for blocks of size 2^( 6) =       0.000432407284
  error estimate for blocks of size 2^( 7) =       0.000433742032

      target function =      -0.903553938160
              le_mean =     -17.206388091617
             les_mean =     296.365795782213
             stat err =       0.000429270013
             autocorr =       1.244433647158
   target nu stat err =       0.000429270013
   target dn stat err =       0.004085166178
      target stat err =       0.006221362871
              std dev =       0.544201428259
             le_variance =       0.296155194520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296214014677
                                         uncertainty =       0.002713896918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296214014677
                                         uncertainty =       0.002713896918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384815646
  error estimate for blocks of size 2^( 2) =       0.000399416339
  error estimate for blocks of size 2^( 3) =       0.000412484922
  error estimate for blocks of size 2^( 4) =       0.000422161457
  error estimate for blocks of size 2^( 5) =       0.000428750945
  error estimate for blocks of size 2^( 6) =       0.000432396034
  error estimate for blocks of size 2^( 7) =       0.000433731264

      target function =      -0.903510889465
              le_mean =     -17.206388115794
             les_mean =     296.365825059185
             stat err =       0.000429259925
             autocorr =       1.244329069419
   target nu stat err =       0.000429259925
   target dn stat err =       0.004086337757
      target stat err =       0.006222532732
              std dev =       0.544211506175
             le_variance =       0.296166163453


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.903503288684        initial
     2.5000e+00     2.5000e+01             2.1675e-04        -0.903587798862  <--
     1.0000e+01     1.0000e+02             5.4796e-05        -0.903553938160
     4.0000e+01     4.0000e+02             1.3738e-05        -0.903510889465

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 5.4812e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 2.086274e-01 1 1  ON 0
  uu_1                 5.155311e-02 1 1  ON 1
  uu_2                -3.952991e-02 1 1  ON 2
  uu_3                -9.307256e-02 1 1  ON 3
  uu_4                -1.241181e-01 1 1  ON 4
  uu_5                -1.321512e-01 1 1  ON 5
  uu_6                -1.136668e-01 1 1  ON 6
  uu_7                -5.362614e-02 1 1  ON 7
  uu_8                 7.261782e-02 1 1  ON 8
  uu_9                 1.239496e-01 1 1  ON 9
  ud_0                 3.083922e-01 1 1  ON 10
  ud_1                 7.837259e-02 1 1  ON 11
  ud_2                -2.375677e-02 1 1  ON 12
  ud_3                -7.709125e-02 1 1  ON 13
  ud_4                -1.140669e-01 1 1  ON 14
  ud_5                -1.345865e-01 1 1  ON 15
  ud_6                -1.309460e-01 1 1  ON 16
  ud_7                -9.026617e-02 1 1  ON 17
  ud_8                -4.203039e-03 1 1  ON 18
  ud_9                 8.822082e-02 1 1  ON 19
  eO_0                -7.054276e-01 1 1  ON 20
  eO_1                -4.211357e-01 1 1  ON 21
  eO_2                -4.119872e-02 1 1  ON 22
  eO_3                 1.872516e-01 1 1  ON 23
  eO_4                 2.615878e-01 1 1  ON 24
  eO_5                 2.859040e-01 1 1  ON 25
  eO_6                 2.497154e-01 1 1  ON 26
  eO_7                 1.248013e-01 1 1  ON 27
  eO_8                 2.848017e-02 1 1  ON 28
  eO_9                 1.892410e-02 1 1  ON 29
 eH1_0                -2.018986e-01 1 1  ON 30
 eH1_1                -9.781130e-02 1 1  ON 31
 eH1_2                -4.717609e-02 1 1  ON 32
 eH1_3                -1.569955e-02 1 1  ON 33
 eH1_4                 1.898081e-02 1 1  ON 34
 eH1_5                 2.679562e-02 1 1  ON 35
 eH1_6                 7.498445e-02 1 1  ON 36
 eH1_7                 1.040766e-01 1 1  ON 37
 eH1_8                 9.685404e-02 1 1  ON 38
 eH1_9                 2.516885e-02 1 1  ON 39
 eH2_0                -2.030316e-01 1 1  ON 40
 eH2_1                -1.000991e-01 1 1  ON 41
 eH2_2                -4.948272e-02 1 1  ON 42
 eH2_3                -1.801777e-02 1 1  ON 43
 eH2_4                 1.648880e-02 1 1  ON 44
 eH2_5                 2.359707e-02 1 1  ON 45
 eH2_6                 7.807132e-02 1 1  ON 46
 eH2_7                 1.127346e-01 1 1  ON 47
 eH2_8                 9.945628e-02 1 1  ON 48
 eH2_9                 2.787285e-02 1 1  ON 49
ci_001                -4.275601e-02 3 1  ON 50
ci_002                -3.185433e-02 3 1  ON 51
ci_003                -1.253210e-02 3 1  ON 52
ci_004                 2.580160e-02 3 1  ON 53
ci_005                 2.599171e-02 3 1  ON 54
ci_006                -2.094175e-02 3 1  ON 55
ci_007                -2.073815e-02 3 1  ON 56
ci_008                -5.172283e-03 3 1  ON 57
ci_009                -1.561694e-02 3 1  ON 58
ci_010                -1.068866e-02 3 1  ON 59
ci_011                -1.058687e-02 3 1  ON 60
ci_012                -1.064445e-02 3 1  ON 61
ci_013                -2.154730e-02 3 1  ON 62
ci_014                 1.392038e-02 3 1  ON 63
ci_015                 1.353791e-02 3 1  ON 64
ci_016                 1.689819e-02 3 1  ON 65
ci_017                 1.612018e-02 3 1  ON 66
ci_018                 1.122439e-02 3 1  ON 67
ci_019                 1.086218e-02 3 1  ON 68
ci_020                 1.819656e-02 3 1  ON 69
ci_021                 1.785777e-02 3 1  ON 70
ci_022                 1.042272e-02 3 1  ON 71
ci_023                 1.100101e-02 3 1  ON 72
ci_024                 7.253255e-03 3 1  ON 73
ci_025                 7.312448e-03 3 1  ON 74
ci_026                 1.202266e-02 3 1  ON 75
ci_027                 1.217781e-02 3 1  ON 76
ci_028                -1.011679e-02 3 1  ON 77
ci_029                -9.930281e-03 3 1  ON 78
ci_030                -4.832777e-03 3 1  ON 79
ci_031                -5.174739e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0469e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1774
    reference variance = 0.175756
====================================================
  Execution time = 3.8615e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5424e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9731e-01
  Total weights = 1.973907232e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0901e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289281276091
                                         uncertainty =       0.001925420359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289281276091
                                         uncertainty =       0.001925420359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380300908
  error estimate for blocks of size 2^( 2) =       0.000395152998
  error estimate for blocks of size 2^( 3) =       0.000408525253
  error estimate for blocks of size 2^( 4) =       0.000418368790
  error estimate for blocks of size 2^( 5) =       0.000424211885
  error estimate for blocks of size 2^( 6) =       0.000426802522
  error estimate for blocks of size 2^( 7) =       0.000428375137

      target function =      -0.916913222086
              le_mean =     -17.206659220091
             les_mean =     296.366436342833
             stat err =       0.000424439583
             autocorr =       1.245595513664
   target nu stat err =       0.000424439583
   target dn stat err =       0.002637655518
      target stat err =       0.004173673761
              std dev =       0.537826701424
             le_variance =       0.289257560765


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720665922009e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916931196922       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916993372085       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917006889998       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917011277920       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917012788791       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917012668670       residual = 8.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917013633707       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917014254023       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917014367698       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917014380124       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917014497167       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917014672992       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917014557609       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917015183645       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917015189984       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917015018366       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917015078564       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917015421993       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917015615319       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917015648940       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917015868813       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917015727744       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917015707900       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917015896728       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917015774437       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917015810684       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917015849381       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917015910947       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917015918224       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917015913584       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917015945150       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917015950178       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917015986296       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917015955154       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917015923030       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917015914176       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917015918276       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917015920501       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917015914592       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e-01 is 6.706797e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916931196922       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916948165045       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916951785927       residual = 6.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916952968149       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916953357111       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916953318986       residual = 8.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916953580212       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916953741452       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916953775575       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916953775833       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916953803357       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916953851982       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916953823246       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916953977973       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916953977672       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916953935366       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916953955370       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916954044284       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916954088894       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916954092375       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916954151284       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916954109572       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916954117583       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916954157797       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916954122734       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916954137006       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916954141873       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916954157077       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916954158290       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916954160701       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916954162894       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916954169581       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916954173889       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916954166475       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916954159221       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916954157805       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916954159083       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916954158819       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916954157777       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e+00 is 1.733654e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916931196922       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916935538402       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916936459990       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916936761448       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916936859303       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916936849301       residual = 8.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916936916033       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916936956594       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916936965606       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916936965429       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916936972173       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916936984679       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916936977495       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916937015977       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916937015794       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916937005335       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916937010630       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916937033023       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916937043945       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916937044398       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916937059462       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916937048624       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916937051575       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916937060909       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916937052009       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916937055862       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916937056886       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916937060401       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916937060997       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916937061398       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916937062430       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916937064659       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916937064304       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916937062840       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916937061085       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916937060765       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916937061095       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916937060978       residual = 9.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.0000e+01 is 4.372379e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.263500 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9586e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 2.086929e-01 1 1  ON 0
  uu_1                 5.158750e-02 1 1  ON 1
  uu_2                -3.949091e-02 1 1  ON 2
  uu_3                -9.302423e-02 1 1  ON 3
  uu_4                -1.240895e-01 1 1  ON 4
  uu_5                -1.321580e-01 1 1  ON 5
  uu_6                -1.136903e-01 1 1  ON 6
  uu_7                -5.369541e-02 1 1  ON 7
  uu_8                 7.245234e-02 1 1  ON 8
  uu_9                 1.239624e-01 1 1  ON 9
  ud_0                 3.083238e-01 1 1  ON 10
  ud_1                 7.831044e-02 1 1  ON 11
  ud_2                -2.381248e-02 1 1  ON 12
  ud_3                -7.714958e-02 1 1  ON 13
  ud_4                -1.141000e-01 1 1  ON 14
  ud_5                -1.345673e-01 1 1  ON 15
  ud_6                -1.308238e-01 1 1  ON 16
  ud_7                -9.009281e-02 1 1  ON 17
  ud_8                -4.267402e-03 1 1  ON 18
  ud_9                 8.820728e-02 1 1  ON 19
  eO_0                -7.054130e-01 1 1  ON 20
  eO_1                -4.211343e-01 1 1  ON 21
  eO_2                -4.121996e-02 1 1  ON 22
  eO_3                 1.872185e-01 1 1  ON 23
  eO_4                 2.615744e-01 1 1  ON 24
  eO_5                 2.858078e-01 1 1  ON 25
  eO_6                 2.497432e-01 1 1  ON 26
  eO_7                 1.249187e-01 1 1  ON 27
  eO_8                 2.847877e-02 1 1  ON 28
  eO_9                 1.892635e-02 1 1  ON 29
 eH1_0                -2.018989e-01 1 1  ON 30
 eH1_1                -9.777788e-02 1 1  ON 31
 eH1_2                -4.712248e-02 1 1  ON 32
 eH1_3                -1.565962e-02 1 1  ON 33
 eH1_4                 1.900570e-02 1 1  ON 34
 eH1_5                 2.665747e-02 1 1  ON 35
 eH1_6                 7.490308e-02 1 1  ON 36
 eH1_7                 1.040832e-01 1 1  ON 37
 eH1_8                 9.689954e-02 1 1  ON 38
 eH1_9                 2.518291e-02 1 1  ON 39
 eH2_0                -2.030438e-01 1 1  ON 40
 eH2_1                -1.000286e-01 1 1  ON 41
 eH2_2                -4.945677e-02 1 1  ON 42
 eH2_3                -1.803294e-02 1 1  ON 43
 eH2_4                 1.644549e-02 1 1  ON 44
 eH2_5                 2.351620e-02 1 1  ON 45
 eH2_6                 7.807521e-02 1 1  ON 46
 eH2_7                 1.127403e-01 1 1  ON 47
 eH2_8                 9.949180e-02 1 1  ON 48
 eH2_9                 2.787869e-02 1 1  ON 49
ci_001                -4.271523e-02 3 1  ON 50
ci_002                -3.181066e-02 3 1  ON 51
ci_003                -1.251685e-02 3 1  ON 52
ci_004                 2.580752e-02 3 1  ON 53
ci_005                 2.602213e-02 3 1  ON 54
ci_006                -2.091611e-02 3 1  ON 55
ci_007                -2.073885e-02 3 1  ON 56
ci_008                -5.138144e-03 3 1  ON 57
ci_009                -1.560658e-02 3 1  ON 58
ci_010                -1.065781e-02 3 1  ON 59
ci_011                -1.057868e-02 3 1  ON 60
ci_012                -1.060953e-02 3 1  ON 61
ci_013                -2.152869e-02 3 1  ON 62
ci_014                 1.393442e-02 3 1  ON 63
ci_015                 1.356067e-02 3 1  ON 64
ci_016                 1.687341e-02 3 1  ON 65
ci_017                 1.609040e-02 3 1  ON 66
ci_018                 1.119571e-02 3 1  ON 67
ci_019                 1.083761e-02 3 1  ON 68
ci_020                 1.819951e-02 3 1  ON 69
ci_021                 1.789864e-02 3 1  ON 70
ci_022                 1.042099e-02 3 1  ON 71
ci_023                 1.097269e-02 3 1  ON 72
ci_024                 7.213720e-03 3 1  ON 73
ci_025                 7.294127e-03 3 1  ON 74
ci_026                 1.202241e-02 3 1  ON 75
ci_027                 1.212574e-02 3 1  ON 76
ci_028                -1.005818e-02 3 1  ON 77
ci_029                -9.947468e-03 3 1  ON 78
ci_030                -4.847255e-03 3 1  ON 79
ci_031                -5.127851e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2247
    reference variance = 0.161587
====================================================
  Execution time = 3.7418e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9518e-01
  Total weights = 1.9738e+06
  Execution time = 3.1336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288174300558
                                         uncertainty =       0.001690926545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288174300558
                                         uncertainty =       0.001690926545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379550614
  error estimate for blocks of size 2^( 2) =       0.000394276503
  error estimate for blocks of size 2^( 3) =       0.000408118548
  error estimate for blocks of size 2^( 4) =       0.000417844715
  error estimate for blocks of size 2^( 5) =       0.000425028400
  error estimate for blocks of size 2^( 6) =       0.000427653429
  error estimate for blocks of size 2^( 7) =       0.000429153213

      target function =      -0.920490058015
              le_mean =     -17.206852958262
             les_mean =     296.370820581572
             stat err =       0.000424919939
             autocorr =       1.253357097602
   target nu stat err =       0.000424919939
   target dn stat err =       0.002038266848
      target stat err =       0.003283753450
              std dev =       0.536765625804
             le_variance =       0.288117337045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288221076974
                                         uncertainty =       0.001694066125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288221076974
                                         uncertainty =       0.001694066125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379581518
  error estimate for blocks of size 2^( 2) =       0.000394346196
  error estimate for blocks of size 2^( 3) =       0.000408226160
  error estimate for blocks of size 2^( 4) =       0.000417979092
  error estimate for blocks of size 2^( 5) =       0.000425172645
  error estimate for blocks of size 2^( 6) =       0.000427808415
  error estimate for blocks of size 2^( 7) =       0.000429302859

      target function =      -0.918913899070
              le_mean =     -17.206852558603
             les_mean =     296.371807155890
             stat err =       0.000425065753
             autocorr =       1.254013218277
   target nu stat err =       0.000425065753
   target dn stat err =       0.002610995850
      target stat err =       0.004152208747
              std dev =       0.536809331034
             le_variance =       0.288164257885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288197716268
                                         uncertainty =       0.001692548448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288197716268
                                         uncertainty =       0.001692548448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379566090
  error estimate for blocks of size 2^( 2) =       0.000394312894
  error estimate for blocks of size 2^( 3) =       0.000408175348
  error estimate for blocks of size 2^( 4) =       0.000417915864
  error estimate for blocks of size 2^( 5) =       0.000425104814
  error estimate for blocks of size 2^( 6) =       0.000427735706
  error estimate for blocks of size 2^( 7) =       0.000429232609

      target function =      -0.919897492410
              le_mean =     -17.206852457904
             les_mean =     296.371179364235
             stat err =       0.000424997248
             autocorr =       1.253710964037
   target nu stat err =       0.000424997248
   target dn stat err =       0.002228127360
      target stat err =       0.003570836974
              std dev =       0.536787512388
             le_variance =       0.288140833456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288177033642
                                         uncertainty =       0.001691122928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288177033642
                                         uncertainty =       0.001691122928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379552421
  error estimate for blocks of size 2^( 2) =       0.000394280980
  error estimate for blocks of size 2^( 3) =       0.000408125627
  error estimate for blocks of size 2^( 4) =       0.000417853614
  error estimate for blocks of size 2^( 5) =       0.000425037967
  error estimate for blocks of size 2^( 6) =       0.000427663737
  error estimate for blocks of size 2^( 7) =       0.000429163149

      target function =      -0.920444513472
              le_mean =     -17.206852851840
             les_mean =     296.370845794886
             stat err =       0.000424929617
             autocorr =       1.253402254964
   target nu stat err =       0.000424929617
   target dn stat err =       0.002054487462
      target stat err =       0.003308299564
              std dev =       0.536768181423
             le_variance =       0.288120080588


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920490058015        initial  <--
     6.2500e-01     6.2500e+00             6.7068e-04        -0.918913899070
     2.5000e+00     2.5000e+01             1.7337e-04        -0.919897492410
     1.0000e+01     1.0000e+02             4.3724e-05        -0.920444513472

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.1738
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 2.086274e-01 1 1  ON 0
  uu_1                 5.155311e-02 1 1  ON 1
  uu_2                -3.952991e-02 1 1  ON 2
  uu_3                -9.307256e-02 1 1  ON 3
  uu_4                -1.241181e-01 1 1  ON 4
  uu_5                -1.321512e-01 1 1  ON 5
  uu_6                -1.136668e-01 1 1  ON 6
  uu_7                -5.362614e-02 1 1  ON 7
  uu_8                 7.261782e-02 1 1  ON 8
  uu_9                 1.239496e-01 1 1  ON 9
  ud_0                 3.083922e-01 1 1  ON 10
  ud_1                 7.837259e-02 1 1  ON 11
  ud_2                -2.375677e-02 1 1  ON 12
  ud_3                -7.709125e-02 1 1  ON 13
  ud_4                -1.140669e-01 1 1  ON 14
  ud_5                -1.345865e-01 1 1  ON 15
  ud_6                -1.309460e-01 1 1  ON 16
  ud_7                -9.026617e-02 1 1  ON 17
  ud_8                -4.203039e-03 1 1  ON 18
  ud_9                 8.822082e-02 1 1  ON 19
  eO_0                -7.054276e-01 1 1  ON 20
  eO_1                -4.211357e-01 1 1  ON 21
  eO_2                -4.119872e-02 1 1  ON 22
  eO_3                 1.872516e-01 1 1  ON 23
  eO_4                 2.615878e-01 1 1  ON 24
  eO_5                 2.859040e-01 1 1  ON 25
  eO_6                 2.497154e-01 1 1  ON 26
  eO_7                 1.248013e-01 1 1  ON 27
  eO_8                 2.848017e-02 1 1  ON 28
  eO_9                 1.892410e-02 1 1  ON 29
 eH1_0                -2.018986e-01 1 1  ON 30
 eH1_1                -9.781130e-02 1 1  ON 31
 eH1_2                -4.717609e-02 1 1  ON 32
 eH1_3                -1.569955e-02 1 1  ON 33
 eH1_4                 1.898081e-02 1 1  ON 34
 eH1_5                 2.679562e-02 1 1  ON 35
 eH1_6                 7.498445e-02 1 1  ON 36
 eH1_7                 1.040766e-01 1 1  ON 37
 eH1_8                 9.685404e-02 1 1  ON 38
 eH1_9                 2.516885e-02 1 1  ON 39
 eH2_0                -2.030316e-01 1 1  ON 40
 eH2_1                -1.000991e-01 1 1  ON 41
 eH2_2                -4.948272e-02 1 1  ON 42
 eH2_3                -1.801777e-02 1 1  ON 43
 eH2_4                 1.648880e-02 1 1  ON 44
 eH2_5                 2.359707e-02 1 1  ON 45
 eH2_6                 7.807132e-02 1 1  ON 46
 eH2_7                 1.127346e-01 1 1  ON 47
 eH2_8                 9.945628e-02 1 1  ON 48
 eH2_9                 2.787285e-02 1 1  ON 49
ci_001                -4.275601e-02 3 1  ON 50
ci_002                -3.185433e-02 3 1  ON 51
ci_003                -1.253210e-02 3 1  ON 52
ci_004                 2.580160e-02 3 1  ON 53
ci_005                 2.599171e-02 3 1  ON 54
ci_006                -2.094175e-02 3 1  ON 55
ci_007                -2.073815e-02 3 1  ON 56
ci_008                -5.172283e-03 3 1  ON 57
ci_009                -1.561694e-02 3 1  ON 58
ci_010                -1.068866e-02 3 1  ON 59
ci_011                -1.058687e-02 3 1  ON 60
ci_012                -1.064445e-02 3 1  ON 61
ci_013                -2.154730e-02 3 1  ON 62
ci_014                 1.392038e-02 3 1  ON 63
ci_015                 1.353791e-02 3 1  ON 64
ci_016                 1.689819e-02 3 1  ON 65
ci_017                 1.612018e-02 3 1  ON 66
ci_018                 1.122439e-02 3 1  ON 67
ci_019                 1.086218e-02 3 1  ON 68
ci_020                 1.819656e-02 3 1  ON 69
ci_021                 1.785777e-02 3 1  ON 70
ci_022                 1.042272e-02 3 1  ON 71
ci_023                 1.100101e-02 3 1  ON 72
ci_024                 7.253255e-03 3 1  ON 73
ci_025                 7.312448e-03 3 1  ON 74
ci_026                 1.202266e-02 3 1  ON 75
ci_027                 1.217781e-02 3 1  ON 76
ci_028                -1.011679e-02 3 1  ON 77
ci_029                -9.930281e-03 3 1  ON 78
ci_030                -4.832777e-03 3 1  ON 79
ci_031                -5.174739e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0277e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.262
    reference variance = 0.613379
====================================================
  Execution time = 3.7668e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5409e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9832e-01
  Total weights = 1.973673762e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1058e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288184294002
                                         uncertainty =       0.001611079226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288184294002
                                         uncertainty =       0.001611079226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379674859
  error estimate for blocks of size 2^( 2) =       0.000394738043
  error estimate for blocks of size 2^( 3) =       0.000408264939
  error estimate for blocks of size 2^( 4) =       0.000418518811
  error estimate for blocks of size 2^( 5) =       0.000424181215
  error estimate for blocks of size 2^( 6) =       0.000427898991
  error estimate for blocks of size 2^( 7) =       0.000428893313

      target function =      -0.915330356299
              le_mean =     -17.206804166948
             les_mean =     296.372428868143
             stat err =       0.000424873083
             autocorr =       1.252260709158
   target nu stat err =       0.000424873083
   target dn stat err =       0.003665694776
      target stat err =       0.005740476380
              std dev =       0.536941334999
             le_variance =       0.288305997230


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720680416695e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915365362168       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915377761684       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915379571287       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915379925805       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915380029544       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915380137583       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915380207089       residual = 7.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915380275731       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915380431519       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915380451034       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915380509227       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915380519046       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915380511143       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915380552390       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915380519633       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915380535968       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915380537259       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915380545329       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915380544661       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915380547499       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915380548477       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915380559683       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915380570343       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915380604424       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915380610275       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915380602115       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915380598762       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915380602649       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915380610020       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915380607891       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915380607391       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915380604413       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915380605406       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915380603971       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915380605637       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915380605129       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+00 is 7.330967e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915365362168       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915368492475       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915368947648       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915369036895       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915369062954       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915369090274       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915369107587       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915369125457       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915369164051       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915369168852       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915369183418       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915369185842       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915369183819       residual = 9.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915369194152       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915369185919       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915369190024       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915369190357       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915369192380       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915369192195       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915369192904       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915369193170       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915369196006       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915369198679       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915369207208       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915369208554       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915369206502       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915369205693       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915369206679       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915369208493       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915369207948       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915369207824       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915369207081       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915369207331       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915369206969       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915369207384       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915369207264       residual = 6.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e+01 is 1.841286e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915365362168       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915366146670       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915366260637       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915366282988       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915366289510       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915366296360       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915366300684       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915366305199       residual = 9.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915366314823       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915366316018       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915366319661       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915366320265       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915366319756       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915366322340       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915366320279       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915366321307       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915366321391       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915366321897       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915366321850       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915366322027       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915366322095       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915366322806       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915366323475       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915366325608       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915366325937       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915366325423       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915366325223       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915366325470       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915366325922       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915366325785       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915366325754       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915366325568       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915366325631       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915366325540       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915366325644       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915366325614       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.0000e+02 is 4.608589e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.314710 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8784e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 2.086266e-01 1 1  ON 0
  uu_1                 5.155442e-02 1 1  ON 1
  uu_2                -3.952801e-02 1 1  ON 2
  uu_3                -9.306920e-02 1 1  ON 3
  uu_4                -1.241144e-01 1 1  ON 4
  uu_5                -1.321494e-01 1 1  ON 5
  uu_6                -1.136678e-01 1 1  ON 6
  uu_7                -5.362808e-02 1 1  ON 7
  uu_8                 7.260082e-02 1 1  ON 8
  uu_9                 1.239533e-01 1 1  ON 9
  ud_0                 3.083859e-01 1 1  ON 10
  ud_1                 7.836743e-02 1 1  ON 11
  ud_2                -2.376192e-02 1 1  ON 12
  ud_3                -7.709620e-02 1 1  ON 13
  ud_4                -1.140695e-01 1 1  ON 14
  ud_5                -1.345855e-01 1 1  ON 15
  ud_6                -1.309338e-01 1 1  ON 16
  ud_7                -9.025757e-02 1 1  ON 17
  ud_8                -4.204564e-03 1 1  ON 18
  ud_9                 8.822149e-02 1 1  ON 19
  eO_0                -7.054253e-01 1 1  ON 20
  eO_1                -4.211378e-01 1 1  ON 21
  eO_2                -4.120344e-02 1 1  ON 22
  eO_3                 1.872500e-01 1 1  ON 23
  eO_4                 2.615848e-01 1 1  ON 24
  eO_5                 2.859034e-01 1 1  ON 25
  eO_6                 2.497151e-01 1 1  ON 26
  eO_7                 1.248093e-01 1 1  ON 27
  eO_8                 2.848146e-02 1 1  ON 28
  eO_9                 1.892477e-02 1 1  ON 29
 eH1_0                -2.018929e-01 1 1  ON 30
 eH1_1                -9.780626e-02 1 1  ON 31
 eH1_2                -4.717333e-02 1 1  ON 32
 eH1_3                -1.569829e-02 1 1  ON 33
 eH1_4                 1.897704e-02 1 1  ON 34
 eH1_5                 2.677720e-02 1 1  ON 35
 eH1_6                 7.498868e-02 1 1  ON 36
 eH1_7                 1.040730e-01 1 1  ON 37
 eH1_8                 9.685859e-02 1 1  ON 38
 eH1_9                 2.517071e-02 1 1  ON 39
 eH2_0                -2.030364e-01 1 1  ON 40
 eH2_1                -1.001028e-01 1 1  ON 41
 eH2_2                -4.948232e-02 1 1  ON 42
 eH2_3                -1.801851e-02 1 1  ON 43
 eH2_4                 1.648710e-02 1 1  ON 44
 eH2_5                 2.360143e-02 1 1  ON 45
 eH2_6                 7.807274e-02 1 1  ON 46
 eH2_7                 1.127324e-01 1 1  ON 47
 eH2_8                 9.946214e-02 1 1  ON 48
 eH2_9                 2.787358e-02 1 1  ON 49
ci_001                -4.275277e-02 3 1  ON 50
ci_002                -3.185027e-02 3 1  ON 51
ci_003                -1.252952e-02 3 1  ON 52
ci_004                 2.579966e-02 3 1  ON 53
ci_005                 2.599904e-02 3 1  ON 54
ci_006                -2.094126e-02 3 1  ON 55
ci_007                -2.073490e-02 3 1  ON 56
ci_008                -5.170802e-03 3 1  ON 57
ci_009                -1.561634e-02 3 1  ON 58
ci_010                -1.068166e-02 3 1  ON 59
ci_011                -1.058110e-02 3 1  ON 60
ci_012                -1.064151e-02 3 1  ON 61
ci_013                -2.154582e-02 3 1  ON 62
ci_014                 1.391616e-02 3 1  ON 63
ci_015                 1.353477e-02 3 1  ON 64
ci_016                 1.689781e-02 3 1  ON 65
ci_017                 1.611787e-02 3 1  ON 66
ci_018                 1.122520e-02 3 1  ON 67
ci_019                 1.086154e-02 3 1  ON 68
ci_020                 1.819710e-02 3 1  ON 69
ci_021                 1.785913e-02 3 1  ON 70
ci_022                 1.042489e-02 3 1  ON 71
ci_023                 1.099567e-02 3 1  ON 72
ci_024                 7.248603e-03 3 1  ON 73
ci_025                 7.312185e-03 3 1  ON 74
ci_026                 1.202123e-02 3 1  ON 75
ci_027                 1.216923e-02 3 1  ON 76
ci_028                -1.011953e-02 3 1  ON 77
ci_029                -9.931398e-03 3 1  ON 78
ci_030                -4.829557e-03 3 1  ON 79
ci_031                -5.172994e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1522
    reference variance = 0.236141
====================================================
  Execution time = 3.7756e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9622e-01
  Total weights = 1.9738e+06
  Execution time = 3.1407e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289870135314
                                         uncertainty =       0.001645863645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289870135314
                                         uncertainty =       0.001645863645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380718887
  error estimate for blocks of size 2^( 2) =       0.000395394529
  error estimate for blocks of size 2^( 3) =       0.000409351976
  error estimate for blocks of size 2^( 4) =       0.000419303952
  error estimate for blocks of size 2^( 5) =       0.000425240756
  error estimate for blocks of size 2^( 6) =       0.000428398617
  error estimate for blocks of size 2^( 7) =       0.000431338493

      target function =      -0.918625064280
              le_mean =     -17.206991515367
             les_mean =     296.376777498883
             stat err =       0.000426070455
             autocorr =       1.252431534984
   target nu stat err =       0.000426070455
   target dn stat err =       0.001957070144
      target stat err =       0.003148253310
              std dev =       0.538417813933
             le_variance =       0.289893742360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289865469773
                                         uncertainty =       0.001645600954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289865469773
                                         uncertainty =       0.001645600954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380715781
  error estimate for blocks of size 2^( 2) =       0.000395395363
  error estimate for blocks of size 2^( 3) =       0.000409356502
  error estimate for blocks of size 2^( 4) =       0.000419311474
  error estimate for blocks of size 2^( 5) =       0.000425249814
  error estimate for blocks of size 2^( 6) =       0.000428408173
  error estimate for blocks of size 2^( 7) =       0.000431347868

      target function =      -0.918634988260
              le_mean =     -17.206991498676
             les_mean =     296.376770582266
             stat err =       0.000426079332
             autocorr =       1.252504167118
   target nu stat err =       0.000426079332
   target dn stat err =       0.001957465715
      target stat err =       0.003148925442
              std dev =       0.538413420584
             le_variance =       0.289889011465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289867755058
                                         uncertainty =       0.001645730668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289867755058
                                         uncertainty =       0.001645730668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380717303
  error estimate for blocks of size 2^( 2) =       0.000395394930
  error estimate for blocks of size 2^( 3) =       0.000409354238
  error estimate for blocks of size 2^( 4) =       0.000419307723
  error estimate for blocks of size 2^( 5) =       0.000425245301
  error estimate for blocks of size 2^( 6) =       0.000428403414
  error estimate for blocks of size 2^( 7) =       0.000431343197

      target function =      -0.918631174676
              le_mean =     -17.206991503296
             les_mean =     296.376773178796
             stat err =       0.000426074909
             autocorr =       1.252468146377
   target nu stat err =       0.000426074909
   target dn stat err =       0.001957256368
      target stat err =       0.003148579409
              std dev =       0.538415572899
             le_variance =       0.289891329140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289869833931
                                         uncertainty =       0.001645846939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289869833931
                                         uncertainty =       0.001645846939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380718687
  error estimate for blocks of size 2^( 2) =       0.000395394577
  error estimate for blocks of size 2^( 3) =       0.000409352257
  error estimate for blocks of size 2^( 4) =       0.000419304422
  error estimate for blocks of size 2^( 5) =       0.000425241323
  error estimate for blocks of size 2^( 6) =       0.000428399216
  error estimate for blocks of size 2^( 7) =       0.000431339080

      target function =      -0.918625978557
              le_mean =     -17.206991513468
             les_mean =     296.376776849341
             stat err =       0.000426071010
             autocorr =       1.252436122120
   target nu stat err =       0.000426071010
   target dn stat err =       0.001957091693
      target stat err =       0.003148292439
              std dev =       0.538417530220
             le_variance =       0.289893436848


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918625064280        initial
     6.2500e+00     6.2500e+01             7.3310e-05        -0.918634988260  <--
     2.5000e+01     2.5000e+02             1.8413e-05        -0.918631174676
     1.0000e+02     1.0000e+03             4.6086e-06        -0.918625978557

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 5.3591e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 2.086245e-01 1 1  ON 0
  uu_1                 5.155835e-02 1 1  ON 1
  uu_2                -3.952230e-02 1 1  ON 2
  uu_3                -9.305918e-02 1 1  ON 3
  uu_4                -1.241035e-01 1 1  ON 4
  uu_5                -1.321439e-01 1 1  ON 5
  uu_6                -1.136709e-01 1 1  ON 6
  uu_7                -5.363393e-02 1 1  ON 7
  uu_8                 7.254992e-02 1 1  ON 8
  uu_9                 1.239642e-01 1 1  ON 9
  ud_0                 3.083673e-01 1 1  ON 10
  ud_1                 7.835198e-02 1 1  ON 11
  ud_2                -2.377730e-02 1 1  ON 12
  ud_3                -7.711098e-02 1 1  ON 13
  ud_4                -1.140771e-01 1 1  ON 14
  ud_5                -1.345828e-01 1 1  ON 15
  ud_6                -1.308975e-01 1 1  ON 16
  ud_7                -9.023180e-02 1 1  ON 17
  ud_8                -4.209077e-03 1 1  ON 18
  ud_9                 8.822351e-02 1 1  ON 19
  eO_0                -7.054185e-01 1 1  ON 20
  eO_1                -4.211441e-01 1 1  ON 21
  eO_2                -4.121751e-02 1 1  ON 22
  eO_3                 1.872454e-01 1 1  ON 23
  eO_4                 2.615758e-01 1 1  ON 24
  eO_5                 2.859017e-01 1 1  ON 25
  eO_6                 2.497142e-01 1 1  ON 26
  eO_7                 1.248332e-01 1 1  ON 27
  eO_8                 2.848533e-02 1 1  ON 28
  eO_9                 1.892678e-02 1 1  ON 29
 eH1_0                -2.018758e-01 1 1  ON 30
 eH1_1                -9.779126e-02 1 1  ON 31
 eH1_2                -4.716511e-02 1 1  ON 32
 eH1_3                -1.569454e-02 1 1  ON 33
 eH1_4                 1.896577e-02 1 1  ON 34
 eH1_5                 2.672231e-02 1 1  ON 35
 eH1_6                 7.500122e-02 1 1  ON 36
 eH1_7                 1.040624e-01 1 1  ON 37
 eH1_8                 9.687225e-02 1 1  ON 38
 eH1_9                 2.517627e-02 1 1  ON 39
 eH2_0                -2.030510e-01 1 1  ON 40
 eH2_1                -1.001139e-01 1 1  ON 41
 eH2_2                -4.948118e-02 1 1  ON 42
 eH2_3                -1.802075e-02 1 1  ON 43
 eH2_4                 1.648203e-02 1 1  ON 44
 eH2_5                 2.361440e-02 1 1  ON 45
 eH2_6                 7.807703e-02 1 1  ON 46
 eH2_7                 1.127260e-01 1 1  ON 47
 eH2_8                 9.947973e-02 1 1  ON 48
 eH2_9                 2.787578e-02 1 1  ON 49
ci_001                -4.274315e-02 3 1  ON 50
ci_002                -3.183819e-02 3 1  ON 51
ci_003                -1.252186e-02 3 1  ON 52
ci_004                 2.579390e-02 3 1  ON 53
ci_005                 2.602076e-02 3 1  ON 54
ci_006                -2.093980e-02 3 1  ON 55
ci_007                -2.072523e-02 3 1  ON 56
ci_008                -5.166421e-03 3 1  ON 57
ci_009                -1.561456e-02 3 1  ON 58
ci_010                -1.066091e-02 3 1  ON 59
ci_011                -1.056400e-02 3 1  ON 60
ci_012                -1.063279e-02 3 1  ON 61
ci_013                -2.154145e-02 3 1  ON 62
ci_014                 1.390365e-02 3 1  ON 63
ci_015                 1.352544e-02 3 1  ON 64
ci_016                 1.689669e-02 3 1  ON 65
ci_017                 1.611099e-02 3 1  ON 66
ci_018                 1.122764e-02 3 1  ON 67
ci_019                 1.085965e-02 3 1  ON 68
ci_020                 1.819872e-02 3 1  ON 69
ci_021                 1.786319e-02 3 1  ON 70
ci_022                 1.043133e-02 3 1  ON 71
ci_023                 1.097983e-02 3 1  ON 72
ci_024                 7.234779e-03 3 1  ON 73
ci_025                 7.311402e-03 3 1  ON 74
ci_026                 1.201700e-02 3 1  ON 75
ci_027                 1.214382e-02 3 1  ON 76
ci_028                -1.012764e-02 3 1  ON 77
ci_029                -9.934717e-03 3 1  ON 78
ci_030                -4.820015e-03 3 1  ON 79
ci_031                -5.167818e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0238e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2067
    reference variance = 0.459042
====================================================
  Execution time = 3.8133e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5428e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9971e-01
  Total weights = 1.973571608e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1102e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293219456072
                                         uncertainty =       0.002443584227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293219456072
                                         uncertainty =       0.002443584227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382872386
  error estimate for blocks of size 2^( 2) =       0.000397676286
  error estimate for blocks of size 2^( 3) =       0.000411601499
  error estimate for blocks of size 2^( 4) =       0.000421648105
  error estimate for blocks of size 2^( 5) =       0.000428785715
  error estimate for blocks of size 2^( 6) =       0.000432052884
  error estimate for blocks of size 2^( 7) =       0.000433557947

      target function =      -0.913199817615
              le_mean =     -17.206612952699
             les_mean =     296.367236634422
             stat err =       0.000429011163
             autocorr =       1.255535784130
   target nu stat err =       0.000429011163
   target dn stat err =       0.002702329166
      target stat err =       0.004239898518
              std dev =       0.541463321237
             le_variance =       0.293182528245


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720661295270e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913218601685       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913235827877       residual = 8.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913237824563       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913239092543       residual = 7.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913239378565       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913239791969       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913240132465       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913240703347       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913240855403       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913240908019       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913241175535       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913241217267       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913241506897       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913241612516       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913241704084       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913241643368       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913241639008       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913241825044       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913241867919       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913241892892       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913241957498       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913241927554       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913241910490       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913241926421       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913241917709       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913241924755       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913241927802       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913241928369       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913241957163       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913241978205       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913241995414       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913241967742       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913241966410       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913241966452       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913241969870       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913241968350       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913241976043       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913241981031       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913241980722       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+00 is 3.157172e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913218601685       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913223061326       residual = 8.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913223571538       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913223896703       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913223968619       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913224077292       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913224158323       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913224307018       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913224349054       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913224360767       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913224429725       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913224440208       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913224512836       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913224539053       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913224560586       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913224544669       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913224544723       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913224591741       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913224601277       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913224607546       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913224622931       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913224615520       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913224611330       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913224615277       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913224613205       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913224614729       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913224615212       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913224615833       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913224623233       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913224628324       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913224631790       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913224625055       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913224624808       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913224624990       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913224625668       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913224625281       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913224627215       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913224628301       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+00 is 7.914099e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913218601685       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913219726592       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913219854849       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913219936665       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913219954675       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913219982187       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913220002196       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913220039759       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913220050497       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913220053339       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913220070713       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913220073336       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913220091503       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913220098043       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913220103336       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913220099312       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913220099404       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913220111184       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913220113492       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913220115063       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913220118858       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913220117011       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913220115969       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913220116953       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913220116441       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913220116806       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913220116912       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913220117097       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913220118958       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913220120221       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913220121032       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913220119363       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913220119307       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913220119363       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913220119521       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913220119424       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913220119909       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913220120169       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e+01 is 1.980433e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.376240 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9304e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 2.086413e-01 1 1  ON 0
  uu_1                 5.157267e-02 1 1  ON 1
  uu_2                -3.951083e-02 1 1  ON 2
  uu_3                -9.304514e-02 1 1  ON 3
  uu_4                -1.240928e-01 1 1  ON 4
  uu_5                -1.321316e-01 1 1  ON 5
  uu_6                -1.137017e-01 1 1  ON 6
  uu_7                -5.365983e-02 1 1  ON 7
  uu_8                 7.247078e-02 1 1  ON 8
  uu_9                 1.239768e-01 1 1  ON 9
  ud_0                 3.083279e-01 1 1  ON 10
  ud_1                 7.831769e-02 1 1  ON 11
  ud_2                -2.381071e-02 1 1  ON 12
  ud_3                -7.714233e-02 1 1  ON 13
  ud_4                -1.140928e-01 1 1  ON 14
  ud_5                -1.345735e-01 1 1  ON 15
  ud_6                -1.308557e-01 1 1  ON 16
  ud_7                -9.016466e-02 1 1  ON 17
  ud_8                -4.206415e-03 1 1  ON 18
  ud_9                 8.821413e-02 1 1  ON 19
  eO_0                -7.054207e-01 1 1  ON 20
  eO_1                -4.211540e-01 1 1  ON 21
  eO_2                -4.121925e-02 1 1  ON 22
  eO_3                 1.872395e-01 1 1  ON 23
  eO_4                 2.615633e-01 1 1  ON 24
  eO_5                 2.858515e-01 1 1  ON 25
  eO_6                 2.497315e-01 1 1  ON 26
  eO_7                 1.248841e-01 1 1  ON 27
  eO_8                 2.849074e-02 1 1  ON 28
  eO_9                 1.893288e-02 1 1  ON 29
 eH1_0                -2.018729e-01 1 1  ON 30
 eH1_1                -9.777015e-02 1 1  ON 31
 eH1_2                -4.714713e-02 1 1  ON 32
 eH1_3                -1.568262e-02 1 1  ON 33
 eH1_4                 1.895554e-02 1 1  ON 34
 eH1_5                 2.666700e-02 1 1  ON 35
 eH1_6                 7.498124e-02 1 1  ON 36
 eH1_7                 1.040715e-01 1 1  ON 37
 eH1_8                 9.688659e-02 1 1  ON 38
 eH1_9                 2.518105e-02 1 1  ON 39
 eH2_0                -2.030656e-01 1 1  ON 40
 eH2_1                -1.000913e-01 1 1  ON 41
 eH2_2                -4.945589e-02 1 1  ON 42
 eH2_3                -1.800368e-02 1 1  ON 43
 eH2_4                 1.647761e-02 1 1  ON 44
 eH2_5                 2.357762e-02 1 1  ON 45
 eH2_6                 7.803870e-02 1 1  ON 46
 eH2_7                 1.127125e-01 1 1  ON 47
 eH2_8                 9.950829e-02 1 1  ON 48
 eH2_9                 2.788420e-02 1 1  ON 49
ci_001                -4.273299e-02 3 1  ON 50
ci_002                -3.183240e-02 3 1  ON 51
ci_003                -1.251163e-02 3 1  ON 52
ci_004                 2.578696e-02 3 1  ON 53
ci_005                 2.603021e-02 3 1  ON 54
ci_006                -2.093023e-02 3 1  ON 55
ci_007                -2.071690e-02 3 1  ON 56
ci_008                -5.165871e-03 3 1  ON 57
ci_009                -1.562620e-02 3 1  ON 58
ci_010                -1.063797e-02 3 1  ON 59
ci_011                -1.054201e-02 3 1  ON 60
ci_012                -1.061459e-02 3 1  ON 61
ci_013                -2.154006e-02 3 1  ON 62
ci_014                 1.389874e-02 3 1  ON 63
ci_015                 1.352843e-02 3 1  ON 64
ci_016                 1.689892e-02 3 1  ON 65
ci_017                 1.610587e-02 3 1  ON 66
ci_018                 1.121912e-02 3 1  ON 67
ci_019                 1.084734e-02 3 1  ON 68
ci_020                 1.819534e-02 3 1  ON 69
ci_021                 1.787376e-02 3 1  ON 70
ci_022                 1.042605e-02 3 1  ON 71
ci_023                 1.097686e-02 3 1  ON 72
ci_024                 7.224412e-03 3 1  ON 73
ci_025                 7.295389e-03 3 1  ON 74
ci_026                 1.202249e-02 3 1  ON 75
ci_027                 1.214897e-02 3 1  ON 76
ci_028                -1.011687e-02 3 1  ON 77
ci_029                -9.923718e-03 3 1  ON 78
ci_030                -4.810810e-03 3 1  ON 79
ci_031                -5.170017e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2016
    reference variance = 0.197303
====================================================
  Execution time = 3.8717e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7208e+01
  VMC Evar = 2.9480e-01
  Total weights = 1.9736e+06
  Execution time = 3.1603e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288010598365
                                         uncertainty =       0.001881248233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288010598365
                                         uncertainty =       0.001881248233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379436054
  error estimate for blocks of size 2^( 2) =       0.000394325298
  error estimate for blocks of size 2^( 3) =       0.000407548891
  error estimate for blocks of size 2^( 4) =       0.000417385835
  error estimate for blocks of size 2^( 5) =       0.000421970271
  error estimate for blocks of size 2^( 6) =       0.000424997997
  error estimate for blocks of size 2^( 7) =       0.000426451504

      target function =      -0.920843804730
              le_mean =     -17.207549259854
             les_mean =     296.394552580963
             stat err =       0.000422701402
             autocorr =       1.241052589750
   target nu stat err =       0.000422701402
   target dn stat err =       0.002056648046
      target stat err =       0.003317870175
              std dev =       0.536603614109
             le_variance =       0.287943438675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287988568970
                                         uncertainty =       0.001879061859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287988568970
                                         uncertainty =       0.001879061859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379421602
  error estimate for blocks of size 2^( 2) =       0.000394323703
  error estimate for blocks of size 2^( 3) =       0.000407560999
  error estimate for blocks of size 2^( 4) =       0.000417408877
  error estimate for blocks of size 2^( 5) =       0.000421998920
  error estimate for blocks of size 2^( 6) =       0.000425031163
  error estimate for blocks of size 2^( 7) =       0.000426486511

      target function =      -0.920852469687
              le_mean =     -17.207549125818
             les_mean =     296.394542474986
             stat err =       0.000422731368
             autocorr =       1.241323116948
   target nu stat err =       0.000422731368
   target dn stat err =       0.002055484191
      target stat err =       0.003316152933
              std dev =       0.536583175176
             le_variance =       0.287921503882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287999020466
                                         uncertainty =       0.001880114437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287999020466
                                         uncertainty =       0.001880114437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379428458
  error estimate for blocks of size 2^( 2) =       0.000394324319
  error estimate for blocks of size 2^( 3) =       0.000407554956
  error estimate for blocks of size 2^( 4) =       0.000417397527
  error estimate for blocks of size 2^( 5) =       0.000421984843
  error estimate for blocks of size 2^( 6) =       0.000425014912
  error estimate for blocks of size 2^( 7) =       0.000426469372

      target function =      -0.920849067621
              le_mean =     -17.207549161413
             les_mean =     296.394545856399
             stat err =       0.000422716663
             autocorr =       1.241191902908
   target nu stat err =       0.000422716663
   target dn stat err =       0.002055987953
      target stat err =       0.003316897891
              std dev =       0.536592871604
             le_variance =       0.287931909857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288009114047
                                         uncertainty =       0.001881104915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288009114047
                                         uncertainty =       0.001881104915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379435080
  error estimate for blocks of size 2^( 2) =       0.000394325158
  error estimate for blocks of size 2^( 3) =       0.000407549637
  error estimate for blocks of size 2^( 4) =       0.000417387290
  error estimate for blocks of size 2^( 5) =       0.000421972088
  error estimate for blocks of size 2^( 6) =       0.000425000109
  error estimate for blocks of size 2^( 7) =       0.000426453734

      target function =      -0.920845604939
              le_mean =     -17.207549243638
             les_mean =     296.394550880363
             stat err =       0.000422703305
             autocorr =       1.241070136691
   target nu stat err =       0.000422703305
   target dn stat err =       0.002056556823
      target stat err =       0.003317743264
              std dev =       0.536602236822
             le_variance =       0.287941960562


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920843804730        initial
     1.5625e+00     1.5625e+01             3.1572e-04        -0.920852469687  <--
     6.2500e+00     6.2500e+01             7.9141e-05        -0.920849067621
     2.5000e+01     2.5000e+02             1.9804e-05        -0.920845604939

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 5.4567e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 2.086907e-01 1 1  ON 0
  uu_1                 5.161478e-02 1 1  ON 1
  uu_2                -3.947679e-02 1 1  ON 2
  uu_3                -9.300381e-02 1 1  ON 3
  uu_4                -1.240609e-01 1 1  ON 4
  uu_5                -1.320958e-01 1 1  ON 5
  uu_6                -1.137902e-01 1 1  ON 6
  uu_7                -5.373762e-02 1 1  ON 7
  uu_8                 7.223420e-02 1 1  ON 8
  uu_9                 1.240142e-01 1 1  ON 9
  ud_0                 3.082116e-01 1 1  ON 10
  ud_1                 7.821609e-02 1 1  ON 11
  ud_2                -2.390959e-02 1 1  ON 12
  ud_3                -7.723492e-02 1 1  ON 13
  ud_4                -1.141398e-01 1 1  ON 14
  ud_5                -1.345470e-01 1 1  ON 15
  ud_6                -1.307335e-01 1 1  ON 16
  ud_7                -8.996666e-02 1 1  ON 17
  ud_8                -4.197039e-03 1 1  ON 18
  ud_9                 8.818612e-02 1 1  ON 19
  eO_0                -7.054279e-01 1 1  ON 20
  eO_1                -4.211835e-01 1 1  ON 21
  eO_2                -4.122560e-02 1 1  ON 22
  eO_3                 1.872211e-01 1 1  ON 23
  eO_4                 2.615259e-01 1 1  ON 24
  eO_5                 2.857033e-01 1 1  ON 25
  eO_6                 2.497829e-01 1 1  ON 26
  eO_7                 1.250367e-01 1 1  ON 27
  eO_8                 2.850705e-02 1 1  ON 28
  eO_9                 1.895119e-02 1 1  ON 29
 eH1_0                -2.018634e-01 1 1  ON 30
 eH1_1                -9.770847e-02 1 1  ON 31
 eH1_2                -4.709456e-02 1 1  ON 32
 eH1_3                -1.564781e-02 1 1  ON 33
 eH1_4                 1.892529e-02 1 1  ON 34
 eH1_5                 2.650424e-02 1 1  ON 35
 eH1_6                 7.492104e-02 1 1  ON 36
 eH1_7                 1.040986e-01 1 1  ON 37
 eH1_8                 9.692963e-02 1 1  ON 38
 eH1_9                 2.519544e-02 1 1  ON 39
 eH2_0                -2.031066e-01 1 1  ON 40
 eH2_1                -1.000252e-01 1 1  ON 41
 eH2_2                -4.938213e-02 1 1  ON 42
 eH2_3                -1.795393e-02 1 1  ON 43
 eH2_4                 1.646450e-02 1 1  ON 44
 eH2_5                 2.346895e-02 1 1  ON 45
 eH2_6                 7.792437e-02 1 1  ON 46
 eH2_7                 1.126717e-01 1 1  ON 47
 eH2_8                 9.959398e-02 1 1  ON 48
 eH2_9                 2.790949e-02 1 1  ON 49
ci_001                -4.270359e-02 3 1  ON 50
ci_002                -3.181560e-02 3 1  ON 51
ci_003                -1.248208e-02 3 1  ON 52
ci_004                 2.576703e-02 3 1  ON 53
ci_005                 2.605769e-02 3 1  ON 54
ci_006                -2.090264e-02 3 1  ON 55
ci_007                -2.069280e-02 3 1  ON 56
ci_008                -5.164311e-03 3 1  ON 57
ci_009                -1.565958e-02 3 1  ON 58
ci_010                -1.057216e-02 3 1  ON 59
ci_011                -1.047878e-02 3 1  ON 60
ci_012                -1.056236e-02 3 1  ON 61
ci_013                -2.153579e-02 3 1  ON 62
ci_014                 1.388459e-02 3 1  ON 63
ci_015                 1.353710e-02 3 1  ON 64
ci_016                 1.690537e-02 3 1  ON 65
ci_017                 1.609109e-02 3 1  ON 66
ci_018                 1.119488e-02 3 1  ON 67
ci_019                 1.081208e-02 3 1  ON 68
ci_020                 1.818546e-02 3 1  ON 69
ci_021                 1.790416e-02 3 1  ON 70
ci_022                 1.041091e-02 3 1  ON 71
ci_023                 1.096822e-02 3 1  ON 72
ci_024                 7.194663e-03 3 1  ON 73
ci_025                 7.249157e-03 3 1  ON 74
ci_026                 1.203816e-02 3 1  ON 75
ci_027                 1.216384e-02 3 1  ON 76
ci_028                -1.008609e-02 3 1  ON 77
ci_029                -9.891911e-03 3 1  ON 78
ci_030                -4.784511e-03 3 1  ON 79
ci_031                -5.176305e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0388e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2597
    reference variance = 0.256068
====================================================
  Execution time = 3.8051e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5417e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9267e-01
  Total weights = 1.973838056e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0839e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285194946042
                                         uncertainty =       0.001481577076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285194946042
                                         uncertainty =       0.001481577076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377638829
  error estimate for blocks of size 2^( 2) =       0.000392518050
  error estimate for blocks of size 2^( 3) =       0.000406029318
  error estimate for blocks of size 2^( 4) =       0.000416620090
  error estimate for blocks of size 2^( 5) =       0.000421758516
  error estimate for blocks of size 2^( 6) =       0.000424577078
  error estimate for blocks of size 2^( 7) =       0.000424334063

      target function =      -0.924222655810
              le_mean =     -17.206775832603
             les_mean =     296.365800169606
             stat err =       0.000421822437
             autocorr =       1.247688200653
   target nu stat err =       0.000421822437
   target dn stat err =       0.002120057677
      target stat err =       0.003434680460
              std dev =       0.534061953442
             le_variance =       0.285222170115


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720677583260e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924234376295       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924283277157       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924300704022       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924303787590       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924304585732       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924305160484       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924305792466       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924306051783       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924307109179       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924307168577       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924307859800       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924308426695       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924308861982       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924309133109       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924309606947       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924309921469       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924310147493       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924310161403       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.924310362792       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.924310724155       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.924310873685       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.924310934797       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.924310895093       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.924310930946       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.924311027718       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.924311007978       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.924310869789       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.924310852745       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.924310884890       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.924310884420       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.924310861902       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.924310872425       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.924310906256       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.924310911649       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.924310930578       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.924310928231       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.924310895915       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.924310926172       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.924310926972       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e-01 is 1.032277e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924234376295       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924248373982       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924253158039       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924254043386       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924254263706       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924254423410       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924254592681       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924254663755       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924254953409       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924254973087       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924255160159       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924255302894       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924255415632       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924255482716       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924255609273       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924255689234       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924255743025       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924255744065       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.924255800783       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.924255887107       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.924255912909       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.924255925428       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.924255915835       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.924255927310       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.924255942511       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.924255929245       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.924255899761       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.924255900517       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.924255908428       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.924255904711       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.924255899298       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.924255903868       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.924255910480       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.924255913252       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.924255914471       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.924255915575       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.924255908385       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.924255916333       residual = 5.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+00 is 2.616705e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924234376295       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924238007320       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924239232793       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924239462883       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924239519431       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924239560550       residual = 7.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924239603571       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924239621801       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924239695993       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924239701344       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924239749023       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924239784588       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924239812980       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924239829717       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924239861896       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924239881913       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924239895129       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924239895207       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.924239909883       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.924239930999       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.924239936623       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.924239939644       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.924239937301       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.924239940252       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.924239943320       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.924239939605       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.924239932684       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.924239933246       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.924239935097       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.924239933928       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.924239932639       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.924239933920       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.924239935450       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.924239936185       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.924239936314       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.924239936671       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.924239934998       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.924239936884       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+00 is 6.566188e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.438649 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8959e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 2.087103e-01 1 1  ON 0
  uu_1                 5.163982e-02 1 1  ON 1
  uu_2                -3.943363e-02 1 1  ON 2
  uu_3                -9.294786e-02 1 1  ON 3
  uu_4                -1.239904e-01 1 1  ON 4
  uu_5                -1.320462e-01 1 1  ON 5
  uu_6                -1.137813e-01 1 1  ON 6
  uu_7                -5.386399e-02 1 1  ON 7
  uu_8                 7.197253e-02 1 1  ON 8
  uu_9                 1.240132e-01 1 1  ON 9
  ud_0                 3.081768e-01 1 1  ON 10
  ud_1                 7.816995e-02 1 1  ON 11
  ud_2                -2.396469e-02 1 1  ON 12
  ud_3                -7.727050e-02 1 1  ON 13
  ud_4                -1.141139e-01 1 1  ON 14
  ud_5                -1.344277e-01 1 1  ON 15
  ud_6                -1.306347e-01 1 1  ON 16
  ud_7                -8.995546e-02 1 1  ON 17
  ud_8                -4.371820e-03 1 1  ON 18
  ud_9                 8.814330e-02 1 1  ON 19
  eO_0                -7.054161e-01 1 1  ON 20
  eO_1                -4.211782e-01 1 1  ON 21
  eO_2                -4.125440e-02 1 1  ON 22
  eO_3                 1.870984e-01 1 1  ON 23
  eO_4                 2.614487e-01 1 1  ON 24
  eO_5                 2.857407e-01 1 1  ON 25
  eO_6                 2.498100e-01 1 1  ON 26
  eO_7                 1.251772e-01 1 1  ON 27
  eO_8                 2.849107e-02 1 1  ON 28
  eO_9                 1.895782e-02 1 1  ON 29
 eH1_0                -2.018641e-01 1 1  ON 30
 eH1_1                -9.763557e-02 1 1  ON 31
 eH1_2                -4.698664e-02 1 1  ON 32
 eH1_3                -1.560788e-02 1 1  ON 33
 eH1_4                 1.891499e-02 1 1  ON 34
 eH1_5                 2.634720e-02 1 1  ON 35
 eH1_6                 7.481328e-02 1 1  ON 36
 eH1_7                 1.040853e-01 1 1  ON 37
 eH1_8                 9.699232e-02 1 1  ON 38
 eH1_9                 2.519229e-02 1 1  ON 39
 eH2_0                -2.031131e-01 1 1  ON 40
 eH2_1                -9.996392e-02 1 1  ON 41
 eH2_2                -4.932828e-02 1 1  ON 42
 eH2_3                -1.793875e-02 1 1  ON 43
 eH2_4                 1.640831e-02 1 1  ON 44
 eH2_5                 2.334139e-02 1 1  ON 45
 eH2_6                 7.785368e-02 1 1  ON 46
 eH2_7                 1.127128e-01 1 1  ON 47
 eH2_8                 9.967324e-02 1 1  ON 48
 eH2_9                 2.791094e-02 1 1  ON 49
ci_001                -4.265440e-02 3 1  ON 50
ci_002                -3.178065e-02 3 1  ON 51
ci_003                -1.244307e-02 3 1  ON 52
ci_004                 2.577463e-02 3 1  ON 53
ci_005                 2.602022e-02 3 1  ON 54
ci_006                -2.088910e-02 3 1  ON 55
ci_007                -2.068951e-02 3 1  ON 56
ci_008                -5.104046e-03 3 1  ON 57
ci_009                -1.563436e-02 3 1  ON 58
ci_010                -1.052073e-02 3 1  ON 59
ci_011                -1.043538e-02 3 1  ON 60
ci_012                -1.055234e-02 3 1  ON 61
ci_013                -2.151016e-02 3 1  ON 62
ci_014                 1.378079e-02 3 1  ON 63
ci_015                 1.356380e-02 3 1  ON 64
ci_016                 1.687133e-02 3 1  ON 65
ci_017                 1.606518e-02 3 1  ON 66
ci_018                 1.117683e-02 3 1  ON 67
ci_019                 1.082473e-02 3 1  ON 68
ci_020                 1.816896e-02 3 1  ON 69
ci_021                 1.790549e-02 3 1  ON 70
ci_022                 1.039384e-02 3 1  ON 71
ci_023                 1.093874e-02 3 1  ON 72
ci_024                 7.118937e-03 3 1  ON 73
ci_025                 7.232140e-03 3 1  ON 74
ci_026                 1.200814e-02 3 1  ON 75
ci_027                 1.216197e-02 3 1  ON 76
ci_028                -1.012652e-02 3 1  ON 77
ci_029                -9.868108e-03 3 1  ON 78
ci_030                -4.808055e-03 3 1  ON 79
ci_031                -5.149158e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1369
    reference variance = 0.543643
====================================================
  Execution time = 3.7837e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0048e-01
  Total weights = 1.9737e+06
  Execution time = 3.1399e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290116778104
                                         uncertainty =       0.002020434808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290116778104
                                         uncertainty =       0.002020434808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380815484
  error estimate for blocks of size 2^( 2) =       0.000395716560
  error estimate for blocks of size 2^( 3) =       0.000409394729
  error estimate for blocks of size 2^( 4) =       0.000418571674
  error estimate for blocks of size 2^( 5) =       0.000424360328
  error estimate for blocks of size 2^( 6) =       0.000428168154
  error estimate for blocks of size 2^( 7) =       0.000429706901

      target function =      -0.910520694709
              le_mean =     -17.207473720146
             les_mean =     296.398568043853
             stat err =       0.000425201764
             autocorr =       1.246697010216
   target nu stat err =       0.000425201764
   target dn stat err =       0.003813427628
      target stat err =       0.005913570250
              std dev =       0.538554422858
             le_variance =       0.290040866380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290089634513
                                         uncertainty =       0.002009863735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290089634513
                                         uncertainty =       0.002009863735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380797776
  error estimate for blocks of size 2^( 2) =       0.000395742487
  error estimate for blocks of size 2^( 3) =       0.000409469684
  error estimate for blocks of size 2^( 4) =       0.000418688624
  error estimate for blocks of size 2^( 5) =       0.000424494871
  error estimate for blocks of size 2^( 6) =       0.000428317567
  error estimate for blocks of size 2^( 7) =       0.000429866976

      target function =      -0.909864918008
              le_mean =     -17.207473596381
             les_mean =     296.398990768390
             stat err =       0.000425342010
             autocorr =       1.247635577482
   target nu stat err =       0.000425342010
   target dn stat err =       0.003766980632
      target stat err =       0.005834286801
              std dev =       0.538529379412
             le_variance =       0.290013892490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290099031869
                                         uncertainty =       0.002014298332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290099031869
                                         uncertainty =       0.002014298332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380803898
  error estimate for blocks of size 2^( 2) =       0.000395729338
  error estimate for blocks of size 2^( 3) =       0.000409434747
  error estimate for blocks of size 2^( 4) =       0.000418635122
  error estimate for blocks of size 2^( 5) =       0.000424433500
  error estimate for blocks of size 2^( 6) =       0.000428249515
  error estimate for blocks of size 2^( 7) =       0.000429794715

      target function =      -0.912260044319
              le_mean =     -17.207473221252
             les_mean =     296.397426260689
             stat err =       0.000425278213
             autocorr =       1.247221240346
   target nu stat err =       0.000425278213
   target dn stat err =       0.003546611324
      target stat err =       0.005527010152
              std dev =       0.538538037200
             le_variance =       0.290023217511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290114096763
                                         uncertainty =       0.002019622860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290114096763
                                         uncertainty =       0.002019622860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380813733
  error estimate for blocks of size 2^( 2) =       0.000395717944
  error estimate for blocks of size 2^( 3) =       0.000409399621
  error estimate for blocks of size 2^( 4) =       0.000418579579
  error estimate for blocks of size 2^( 5) =       0.000424369500
  error estimate for blocks of size 2^( 6) =       0.000428178395
  error estimate for blocks of size 2^( 7) =       0.000429717994

      target function =      -0.911157924057
              le_mean =     -17.207473605088
             les_mean =     296.398152010893
             stat err =       0.000425211367
             autocorr =       1.246764791475
   target nu stat err =       0.000425211367
   target dn stat err =       0.003682465026
      target stat err =       0.005721458392
              std dev =       0.538551945435
             le_variance =       0.290038197932


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910520694709        initial
     3.9062e-01     3.9062e+00             1.0323e-03        -0.909864918008
     1.5625e+00     1.5625e+01             2.6167e-04        -0.912260044319  <--
     6.2500e+00     6.2500e+01             6.5662e-05        -0.911157924057

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 5.3651e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 2.087103e-01 1 1  ON 0
  uu_1                 5.163982e-02 1 1  ON 1
  uu_2                -3.943363e-02 1 1  ON 2
  uu_3                -9.294786e-02 1 1  ON 3
  uu_4                -1.239904e-01 1 1  ON 4
  uu_5                -1.320462e-01 1 1  ON 5
  uu_6                -1.137813e-01 1 1  ON 6
  uu_7                -5.386399e-02 1 1  ON 7
  uu_8                 7.197253e-02 1 1  ON 8
  uu_9                 1.240132e-01 1 1  ON 9
  ud_0                 3.081768e-01 1 1  ON 10
  ud_1                 7.816995e-02 1 1  ON 11
  ud_2                -2.396469e-02 1 1  ON 12
  ud_3                -7.727050e-02 1 1  ON 13
  ud_4                -1.141139e-01 1 1  ON 14
  ud_5                -1.344277e-01 1 1  ON 15
  ud_6                -1.306347e-01 1 1  ON 16
  ud_7                -8.995546e-02 1 1  ON 17
  ud_8                -4.371820e-03 1 1  ON 18
  ud_9                 8.814330e-02 1 1  ON 19
  eO_0                -7.054161e-01 1 1  ON 20
  eO_1                -4.211782e-01 1 1  ON 21
  eO_2                -4.125440e-02 1 1  ON 22
  eO_3                 1.870984e-01 1 1  ON 23
  eO_4                 2.614487e-01 1 1  ON 24
  eO_5                 2.857407e-01 1 1  ON 25
  eO_6                 2.498100e-01 1 1  ON 26
  eO_7                 1.251772e-01 1 1  ON 27
  eO_8                 2.849107e-02 1 1  ON 28
  eO_9                 1.895782e-02 1 1  ON 29
 eH1_0                -2.018641e-01 1 1  ON 30
 eH1_1                -9.763557e-02 1 1  ON 31
 eH1_2                -4.698664e-02 1 1  ON 32
 eH1_3                -1.560788e-02 1 1  ON 33
 eH1_4                 1.891499e-02 1 1  ON 34
 eH1_5                 2.634720e-02 1 1  ON 35
 eH1_6                 7.481328e-02 1 1  ON 36
 eH1_7                 1.040853e-01 1 1  ON 37
 eH1_8                 9.699232e-02 1 1  ON 38
 eH1_9                 2.519229e-02 1 1  ON 39
 eH2_0                -2.031131e-01 1 1  ON 40
 eH2_1                -9.996392e-02 1 1  ON 41
 eH2_2                -4.932828e-02 1 1  ON 42
 eH2_3                -1.793875e-02 1 1  ON 43
 eH2_4                 1.640831e-02 1 1  ON 44
 eH2_5                 2.334139e-02 1 1  ON 45
 eH2_6                 7.785368e-02 1 1  ON 46
 eH2_7                 1.127128e-01 1 1  ON 47
 eH2_8                 9.967324e-02 1 1  ON 48
 eH2_9                 2.791094e-02 1 1  ON 49
ci_001                -4.265440e-02 3 1  ON 50
ci_002                -3.178065e-02 3 1  ON 51
ci_003                -1.244307e-02 3 1  ON 52
ci_004                 2.577463e-02 3 1  ON 53
ci_005                 2.602022e-02 3 1  ON 54
ci_006                -2.088910e-02 3 1  ON 55
ci_007                -2.068951e-02 3 1  ON 56
ci_008                -5.104046e-03 3 1  ON 57
ci_009                -1.563436e-02 3 1  ON 58
ci_010                -1.052073e-02 3 1  ON 59
ci_011                -1.043538e-02 3 1  ON 60
ci_012                -1.055234e-02 3 1  ON 61
ci_013                -2.151016e-02 3 1  ON 62
ci_014                 1.378079e-02 3 1  ON 63
ci_015                 1.356380e-02 3 1  ON 64
ci_016                 1.687133e-02 3 1  ON 65
ci_017                 1.606518e-02 3 1  ON 66
ci_018                 1.117683e-02 3 1  ON 67
ci_019                 1.082473e-02 3 1  ON 68
ci_020                 1.816896e-02 3 1  ON 69
ci_021                 1.790549e-02 3 1  ON 70
ci_022                 1.039384e-02 3 1  ON 71
ci_023                 1.093874e-02 3 1  ON 72
ci_024                 7.118937e-03 3 1  ON 73
ci_025                 7.232140e-03 3 1  ON 74
ci_026                 1.200814e-02 3 1  ON 75
ci_027                 1.216197e-02 3 1  ON 76
ci_028                -1.012652e-02 3 1  ON 77
ci_029                -9.868108e-03 3 1  ON 78
ci_030                -4.808055e-03 3 1  ON 79
ci_031                -5.149158e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0262e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1565
    reference variance = 0.216346
====================================================
  Execution time = 3.7870e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5423e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0142e-01
  Total weights = 1.973885407e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0951e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293715825143
                                         uncertainty =       0.002784653572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293715825143
                                         uncertainty =       0.002784653572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383169874
  error estimate for blocks of size 2^( 2) =       0.000397904015
  error estimate for blocks of size 2^( 3) =       0.000411481706
  error estimate for blocks of size 2^( 4) =       0.000421147517
  error estimate for blocks of size 2^( 5) =       0.000427506706
  error estimate for blocks of size 2^( 6) =       0.000430065217
  error estimate for blocks of size 2^( 7) =       0.000432665495

      target function =      -0.910547489419
              le_mean =     -17.207008383354
             les_mean =     296.382552668120
             stat err =       0.000427846234
             autocorr =       1.246788286428
   target nu stat err =       0.000427846234
   target dn stat err =       0.003260153526
      target stat err =       0.005065824732
              std dev =       0.541884033018
             le_variance =       0.293638305240


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720700838335e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910574278270       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910612204317       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910632123232       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910637116979       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910638999869       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910639973452       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910641589822       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910642982840       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910645446393       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910646274311       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910646643235       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910647099326       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910649013483       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910649143431       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910649503805       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910649390057       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910649394653       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910649922837       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910650039575       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910650547384       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910650838339       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910650769758       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910650817855       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910650938712       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910650954671       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910650934995       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910650946281       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910651042957       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910651000835       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910650990322       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910650994288       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910651027710       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910650935687       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910650948898       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910650974490       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910651011208       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.910651023070       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.910650984270       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.910650998982       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e-01 is 9.073701e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910574278270       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910584981226       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910590578182       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910591977123       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910592504049       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910592825767       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910593269542       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910593576414       residual = 7.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910594230970       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910594461751       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910594564871       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910594692376       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910595168198       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910595214233       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910595300595       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910595261291       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910595260857       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910595398444       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910595432263       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910595546636       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910595618745       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910595595695       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910595611306       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910595636160       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910595634750       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910595632388       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910595636233       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910595657042       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910595644863       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910595643592       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910595646131       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910595650260       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910595629406       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910595632926       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910595639998       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910595646893       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.910595648210       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.910595642553       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.910595643185       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+00 is 2.316433e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910574278270       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910577043047       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910578487142       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910578847492       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910578976216       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910579084273       residual = 9.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910579190495       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910579276382       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910579428358       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910579481413       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910579509382       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910579541854       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910579660264       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910579672855       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910579693825       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910579683447       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910579682995       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910579717738       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910579726676       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910579754385       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910579772230       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910579766081       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910579770329       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910579775989       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910579775341       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910579774951       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910579775998       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910579780902       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910579777814       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910579777619       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910579778318       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910579779028       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910579774060       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910579774939       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910579776727       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910579778288       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.910579778528       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.910579777408       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+00 is 5.810090e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.502263 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8892e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 2.087958e-01 1 1  ON 0
  uu_1                 5.177449e-02 1 1  ON 1
  uu_2                -3.932802e-02 1 1  ON 2
  uu_3                -9.289665e-02 1 1  ON 3
  uu_4                -1.239979e-01 1 1  ON 4
  uu_5                -1.321127e-01 1 1  ON 5
  uu_6                -1.138951e-01 1 1  ON 6
  uu_7                -5.388696e-02 1 1  ON 7
  uu_8                 7.174089e-02 1 1  ON 8
  uu_9                 1.240166e-01 1 1  ON 9
  ud_0                 3.080183e-01 1 1  ON 10
  ud_1                 7.808407e-02 1 1  ON 11
  ud_2                -2.402779e-02 1 1  ON 12
  ud_3                -7.731944e-02 1 1  ON 13
  ud_4                -1.140838e-01 1 1  ON 14
  ud_5                -1.343065e-01 1 1  ON 15
  ud_6                -1.304197e-01 1 1  ON 16
  ud_7                -8.979487e-02 1 1  ON 17
  ud_8                -4.511256e-03 1 1  ON 18
  ud_9                 8.805709e-02 1 1  ON 19
  eO_0                -7.053885e-01 1 1  ON 20
  eO_1                -4.212227e-01 1 1  ON 21
  eO_2                -4.125800e-02 1 1  ON 22
  eO_3                 1.871458e-01 1 1  ON 23
  eO_4                 2.613959e-01 1 1  ON 24
  eO_5                 2.855773e-01 1 1  ON 25
  eO_6                 2.498710e-01 1 1  ON 26
  eO_7                 1.253069e-01 1 1  ON 27
  eO_8                 2.849380e-02 1 1  ON 28
  eO_9                 1.895195e-02 1 1  ON 29
 eH1_0                -2.018164e-01 1 1  ON 30
 eH1_1                -9.755309e-02 1 1  ON 31
 eH1_2                -4.692918e-02 1 1  ON 32
 eH1_3                -1.557772e-02 1 1  ON 33
 eH1_4                 1.882904e-02 1 1  ON 34
 eH1_5                 2.617513e-02 1 1  ON 35
 eH1_6                 7.475928e-02 1 1  ON 36
 eH1_7                 1.040772e-01 1 1  ON 37
 eH1_8                 9.707093e-02 1 1  ON 38
 eH1_9                 2.521885e-02 1 1  ON 39
 eH2_0                -2.031087e-01 1 1  ON 40
 eH2_1                -9.989129e-02 1 1  ON 41
 eH2_2                -4.925560e-02 1 1  ON 42
 eH2_3                -1.787512e-02 1 1  ON 43
 eH2_4                 1.637538e-02 1 1  ON 44
 eH2_5                 2.320268e-02 1 1  ON 45
 eH2_6                 7.773858e-02 1 1  ON 46
 eH2_7                 1.127066e-01 1 1  ON 47
 eH2_8                 9.974455e-02 1 1  ON 48
 eH2_9                 2.791830e-02 1 1  ON 49
ci_001                -4.255383e-02 3 1  ON 50
ci_002                -3.173081e-02 3 1  ON 51
ci_003                -1.238255e-02 3 1  ON 52
ci_004                 2.580322e-02 3 1  ON 53
ci_005                 2.596315e-02 3 1  ON 54
ci_006                -2.082547e-02 3 1  ON 55
ci_007                -2.064705e-02 3 1  ON 56
ci_008                -5.109771e-03 3 1  ON 57
ci_009                -1.563172e-02 3 1  ON 58
ci_010                -1.048724e-02 3 1  ON 59
ci_011                -1.042583e-02 3 1  ON 60
ci_012                -1.054963e-02 3 1  ON 61
ci_013                -2.145399e-02 3 1  ON 62
ci_014                 1.377247e-02 3 1  ON 63
ci_015                 1.350394e-02 3 1  ON 64
ci_016                 1.686962e-02 3 1  ON 65
ci_017                 1.608508e-02 3 1  ON 66
ci_018                 1.117241e-02 3 1  ON 67
ci_019                 1.084189e-02 3 1  ON 68
ci_020                 1.811838e-02 3 1  ON 69
ci_021                 1.791854e-02 3 1  ON 70
ci_022                 1.040034e-02 3 1  ON 71
ci_023                 1.092490e-02 3 1  ON 72
ci_024                 7.115149e-03 3 1  ON 73
ci_025                 7.266775e-03 3 1  ON 74
ci_026                 1.197814e-02 3 1  ON 75
ci_027                 1.210634e-02 3 1  ON 76
ci_028                -1.015901e-02 3 1  ON 77
ci_029                -9.813534e-03 3 1  ON 78
ci_030                -4.803361e-03 3 1  ON 79
ci_031                -5.161233e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2405
    reference variance = 0.250226
====================================================
  Execution time = 3.7479e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0787e-01
  Total weights = 1.9736e+06
  Execution time = 3.1408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296585587839
                                         uncertainty =       0.003499212292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296585587839
                                         uncertainty =       0.003499212292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385096286
  error estimate for blocks of size 2^( 2) =       0.000399793612
  error estimate for blocks of size 2^( 3) =       0.000413010408
  error estimate for blocks of size 2^( 4) =       0.000422302331
  error estimate for blocks of size 2^( 5) =       0.000427482556
  error estimate for blocks of size 2^( 6) =       0.000432219430
  error estimate for blocks of size 2^( 7) =       0.000431872646

      target function =      -0.900892352313
              le_mean =     -17.206234174748
             les_mean =     296.362253468480
             stat err =       0.000428469240
             autocorr =       1.237942975440
   target nu stat err =       0.000428469240
   target dn stat err =       0.004994642487
      target stat err =       0.007543063138
              std dev =       0.544608390000
             le_variance =       0.296598298458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296634596723
                                         uncertainty =       0.003525742492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296634596723
                                         uncertainty =       0.003525742492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385127845
  error estimate for blocks of size 2^( 2) =       0.000399867131
  error estimate for blocks of size 2^( 3) =       0.000413130643
  error estimate for blocks of size 2^( 4) =       0.000422454438
  error estimate for blocks of size 2^( 5) =       0.000427659715
  error estimate for blocks of size 2^( 6) =       0.000432403162
  error estimate for blocks of size 2^( 7) =       0.000432075281

      target function =      -0.900234957973
              le_mean =     -17.206233282382
             les_mean =     296.362658871206
             stat err =       0.000428648149
             autocorr =       1.238773959000
   target nu stat err =       0.000428648149
   target dn stat err =       0.005088573723
      target stat err =       0.007672531076
              std dev =       0.544653021108
             le_variance =       0.296646913402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296607891076
                                         uncertainty =       0.003513105608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296607891076
                                         uncertainty =       0.003513105608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385110627
  error estimate for blocks of size 2^( 2) =       0.000399831513
  error estimate for blocks of size 2^( 3) =       0.000413074308
  error estimate for blocks of size 2^( 4) =       0.000422383793
  error estimate for blocks of size 2^( 5) =       0.000427577871
  error estimate for blocks of size 2^( 6) =       0.000432318227
  error estimate for blocks of size 2^( 7) =       0.000431982085

      target function =      -0.900088717075
              le_mean =     -17.206233243218
             les_mean =     296.362755528876
             stat err =       0.000428565494
             autocorr =       1.238406989948
   target nu stat err =       0.000428565494
   target dn stat err =       0.005054978334
      target stat err =       0.007619831065
              std dev =       0.544628672250
             le_variance =       0.296620390637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296587845615
                                         uncertainty =       0.003500899662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296587845615
                                         uncertainty =       0.003500899662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385097734
  error estimate for blocks of size 2^( 2) =       0.000399798086
  error estimate for blocks of size 2^( 3) =       0.000413018220
  error estimate for blocks of size 2^( 4) =       0.000422312404
  error estimate for blocks of size 2^( 5) =       0.000427494376
  error estimate for blocks of size 2^( 6) =       0.000432231719
  error estimate for blocks of size 2^( 7) =       0.000431886248

      target function =      -0.900823583484
              le_mean =     -17.206233980768
             les_mean =     296.362292464995
             stat err =       0.000428481187
             autocorr =       1.238002691327
   target nu stat err =       0.000428481187
   target dn stat err =       0.004999830384
      target stat err =       0.007549680300
              std dev =       0.544610438801
             le_variance =       0.296600530051


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.900892352313        initial  <--
     3.9062e-01     3.9062e+00             9.0737e-04        -0.900234957973
     1.5625e+00     1.5625e+01             2.3164e-04        -0.900088717075
     6.2500e+00     6.2500e+01             5.8101e-05        -0.900823583484

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.2510
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 2.087103e-01 1 1  ON 0
  uu_1                 5.163982e-02 1 1  ON 1
  uu_2                -3.943363e-02 1 1  ON 2
  uu_3                -9.294786e-02 1 1  ON 3
  uu_4                -1.239904e-01 1 1  ON 4
  uu_5                -1.320462e-01 1 1  ON 5
  uu_6                -1.137813e-01 1 1  ON 6
  uu_7                -5.386399e-02 1 1  ON 7
  uu_8                 7.197253e-02 1 1  ON 8
  uu_9                 1.240132e-01 1 1  ON 9
  ud_0                 3.081768e-01 1 1  ON 10
  ud_1                 7.816995e-02 1 1  ON 11
  ud_2                -2.396469e-02 1 1  ON 12
  ud_3                -7.727050e-02 1 1  ON 13
  ud_4                -1.141139e-01 1 1  ON 14
  ud_5                -1.344277e-01 1 1  ON 15
  ud_6                -1.306347e-01 1 1  ON 16
  ud_7                -8.995546e-02 1 1  ON 17
  ud_8                -4.371820e-03 1 1  ON 18
  ud_9                 8.814330e-02 1 1  ON 19
  eO_0                -7.054161e-01 1 1  ON 20
  eO_1                -4.211782e-01 1 1  ON 21
  eO_2                -4.125440e-02 1 1  ON 22
  eO_3                 1.870984e-01 1 1  ON 23
  eO_4                 2.614487e-01 1 1  ON 24
  eO_5                 2.857407e-01 1 1  ON 25
  eO_6                 2.498100e-01 1 1  ON 26
  eO_7                 1.251772e-01 1 1  ON 27
  eO_8                 2.849107e-02 1 1  ON 28
  eO_9                 1.895782e-02 1 1  ON 29
 eH1_0                -2.018641e-01 1 1  ON 30
 eH1_1                -9.763557e-02 1 1  ON 31
 eH1_2                -4.698664e-02 1 1  ON 32
 eH1_3                -1.560788e-02 1 1  ON 33
 eH1_4                 1.891499e-02 1 1  ON 34
 eH1_5                 2.634720e-02 1 1  ON 35
 eH1_6                 7.481328e-02 1 1  ON 36
 eH1_7                 1.040853e-01 1 1  ON 37
 eH1_8                 9.699232e-02 1 1  ON 38
 eH1_9                 2.519229e-02 1 1  ON 39
 eH2_0                -2.031131e-01 1 1  ON 40
 eH2_1                -9.996392e-02 1 1  ON 41
 eH2_2                -4.932828e-02 1 1  ON 42
 eH2_3                -1.793875e-02 1 1  ON 43
 eH2_4                 1.640831e-02 1 1  ON 44
 eH2_5                 2.334139e-02 1 1  ON 45
 eH2_6                 7.785368e-02 1 1  ON 46
 eH2_7                 1.127128e-01 1 1  ON 47
 eH2_8                 9.967324e-02 1 1  ON 48
 eH2_9                 2.791094e-02 1 1  ON 49
ci_001                -4.265440e-02 3 1  ON 50
ci_002                -3.178065e-02 3 1  ON 51
ci_003                -1.244307e-02 3 1  ON 52
ci_004                 2.577463e-02 3 1  ON 53
ci_005                 2.602022e-02 3 1  ON 54
ci_006                -2.088910e-02 3 1  ON 55
ci_007                -2.068951e-02 3 1  ON 56
ci_008                -5.104046e-03 3 1  ON 57
ci_009                -1.563436e-02 3 1  ON 58
ci_010                -1.052073e-02 3 1  ON 59
ci_011                -1.043538e-02 3 1  ON 60
ci_012                -1.055234e-02 3 1  ON 61
ci_013                -2.151016e-02 3 1  ON 62
ci_014                 1.378079e-02 3 1  ON 63
ci_015                 1.356380e-02 3 1  ON 64
ci_016                 1.687133e-02 3 1  ON 65
ci_017                 1.606518e-02 3 1  ON 66
ci_018                 1.117683e-02 3 1  ON 67
ci_019                 1.082473e-02 3 1  ON 68
ci_020                 1.816896e-02 3 1  ON 69
ci_021                 1.790549e-02 3 1  ON 70
ci_022                 1.039384e-02 3 1  ON 71
ci_023                 1.093874e-02 3 1  ON 72
ci_024                 7.118937e-03 3 1  ON 73
ci_025                 7.232140e-03 3 1  ON 74
ci_026                 1.200814e-02 3 1  ON 75
ci_027                 1.216197e-02 3 1  ON 76
ci_028                -1.012652e-02 3 1  ON 77
ci_029                -9.868108e-03 3 1  ON 78
ci_030                -4.808055e-03 3 1  ON 79
ci_031                -5.149158e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0215e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2305
    reference variance = 0.252207
====================================================
  Execution time = 3.8030e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5403e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9930e-01
  Total weights = 1.973833518e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0763e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292534822089
                                         uncertainty =       0.002853873915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292534822089
                                         uncertainty =       0.002853873915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382422164
  error estimate for blocks of size 2^( 2) =       0.000397106771
  error estimate for blocks of size 2^( 3) =       0.000410430714
  error estimate for blocks of size 2^( 4) =       0.000420176266
  error estimate for blocks of size 2^( 5) =       0.000424708494
  error estimate for blocks of size 2^( 6) =       0.000426605557
  error estimate for blocks of size 2^( 7) =       0.000429250829

      target function =      -0.913791072543
              le_mean =     -17.207402255368
             les_mean =     296.393996200365
             stat err =       0.000425185287
             autocorr =       1.236147644239
   target nu stat err =       0.000425185287
   target dn stat err =       0.003530245013
      target stat err =       0.005519513774
              std dev =       0.540826611136
             le_variance =       0.292493423313


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720740225537e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913823111042       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913833562077       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913835059929       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913835554314       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913835663655       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913835825383       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913835993045       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913836117135       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913836391226       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913836596923       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913836752187       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913836882389       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913836992531       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913837003683       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913836978103       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913836984698       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913836977245       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913837041472       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913837070318       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913837126157       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913837137865       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913837147657       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913837140373       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913837132211       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913837146765       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913837147838       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913837157221       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913837165719       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913837175228       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913837173419       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913837173225       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913837176880       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913837175639       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913837174805       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913837172872       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913837169623       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913837168013       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913837168214       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+00 is 1.225170e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913823111042       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913825762360       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913826141520       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913826266598       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913826294201       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913826335152       residual = 8.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913826377513       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913826408796       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913826477913       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913826529862       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913826569051       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913826601854       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913826629154       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913826631550       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913826624932       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913826626592       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913826624839       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913826641036       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913826648256       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913826662140       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913826664934       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913826667371       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913826665464       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913826663534       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913826667171       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913826667373       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913826669671       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913826671801       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913826674025       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913826673585       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913826673603       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913826674511       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913826674186       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913826673971       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913826673484       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913826672689       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913826672277       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913826672337       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+01 is 3.077074e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913823111042       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913823776326       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913823871414       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913823902778       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913823909695       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913823919966       residual = 8.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913823930585       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913823938422       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913823955738       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913823968759       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913823978580       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913823986796       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913823993606       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913823994180       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913823992512       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913823992927       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913823992496       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913823996554       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913823998360       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913824001825       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913824002515       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913824003125       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913824002642       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913824002167       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913824003076       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913824003122       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913824003694       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913824004226       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913824004773       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913824004664       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913824004672       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913824004899       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913824004817       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913824004762       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913824004641       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913824004443       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913824004340       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913824004355       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+01 is 7.701617e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.559834 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8859e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 2.087081e-01 1 1  ON 0
  uu_1                 5.163499e-02 1 1  ON 1
  uu_2                -3.943398e-02 1 1  ON 2
  uu_3                -9.294980e-02 1 1  ON 3
  uu_4                -1.239908e-01 1 1  ON 4
  uu_5                -1.320485e-01 1 1  ON 5
  uu_6                -1.137811e-01 1 1  ON 6
  uu_7                -5.384178e-02 1 1  ON 7
  uu_8                 7.195421e-02 1 1  ON 8
  uu_9                 1.240153e-01 1 1  ON 9
  ud_0                 3.081621e-01 1 1  ON 10
  ud_1                 7.815938e-02 1 1  ON 11
  ud_2                -2.397644e-02 1 1  ON 12
  ud_3                -7.727891e-02 1 1  ON 13
  ud_4                -1.141154e-01 1 1  ON 14
  ud_5                -1.344264e-01 1 1  ON 15
  ud_6                -1.306221e-01 1 1  ON 16
  ud_7                -8.993578e-02 1 1  ON 17
  ud_8                -4.365443e-03 1 1  ON 18
  ud_9                 8.814182e-02 1 1  ON 19
  eO_0                -7.054047e-01 1 1  ON 20
  eO_1                -4.211719e-01 1 1  ON 21
  eO_2                -4.125649e-02 1 1  ON 22
  eO_3                 1.870846e-01 1 1  ON 23
  eO_4                 2.614180e-01 1 1  ON 24
  eO_5                 2.857163e-01 1 1  ON 25
  eO_6                 2.498345e-01 1 1  ON 26
  eO_7                 1.252044e-01 1 1  ON 27
  eO_8                 2.849204e-02 1 1  ON 28
  eO_9                 1.895803e-02 1 1  ON 29
 eH1_0                -2.018741e-01 1 1  ON 30
 eH1_1                -9.763452e-02 1 1  ON 31
 eH1_2                -4.698245e-02 1 1  ON 32
 eH1_3                -1.560889e-02 1 1  ON 33
 eH1_4                 1.890614e-02 1 1  ON 34
 eH1_5                 2.633866e-02 1 1  ON 35
 eH1_6                 7.480932e-02 1 1  ON 36
 eH1_7                 1.040922e-01 1 1  ON 37
 eH1_8                 9.700941e-02 1 1  ON 38
 eH1_9                 2.519460e-02 1 1  ON 39
 eH2_0                -2.031178e-01 1 1  ON 40
 eH2_1                -9.996539e-02 1 1  ON 41
 eH2_2                -4.932223e-02 1 1  ON 42
 eH2_3                -1.793826e-02 1 1  ON 43
 eH2_4                 1.640444e-02 1 1  ON 44
 eH2_5                 2.333748e-02 1 1  ON 45
 eH2_6                 7.784754e-02 1 1  ON 46
 eH2_7                 1.127124e-01 1 1  ON 47
 eH2_8                 9.968449e-02 1 1  ON 48
 eH2_9                 2.791353e-02 1 1  ON 49
ci_001                -4.264744e-02 3 1  ON 50
ci_002                -3.177826e-02 3 1  ON 51
ci_003                -1.244268e-02 3 1  ON 52
ci_004                 2.578083e-02 3 1  ON 53
ci_005                 2.602502e-02 3 1  ON 54
ci_006                -2.088500e-02 3 1  ON 55
ci_007                -2.068586e-02 3 1  ON 56
ci_008                -5.098940e-03 3 1  ON 57
ci_009                -1.562800e-02 3 1  ON 58
ci_010                -1.051798e-02 3 1  ON 59
ci_011                -1.043946e-02 3 1  ON 60
ci_012                -1.054715e-02 3 1  ON 61
ci_013                -2.151158e-02 3 1  ON 62
ci_014                 1.377258e-02 3 1  ON 63
ci_015                 1.356098e-02 3 1  ON 64
ci_016                 1.686871e-02 3 1  ON 65
ci_017                 1.606645e-02 3 1  ON 66
ci_018                 1.117033e-02 3 1  ON 67
ci_019                 1.082549e-02 3 1  ON 68
ci_020                 1.816733e-02 3 1  ON 69
ci_021                 1.790722e-02 3 1  ON 70
ci_022                 1.039571e-02 3 1  ON 71
ci_023                 1.093579e-02 3 1  ON 72
ci_024                 7.119634e-03 3 1  ON 73
ci_025                 7.229228e-03 3 1  ON 74
ci_026                 1.200329e-02 3 1  ON 75
ci_027                 1.215105e-02 3 1  ON 76
ci_028                -1.012158e-02 3 1  ON 77
ci_029                -9.862883e-03 3 1  ON 78
ci_030                -4.811260e-03 3 1  ON 79
ci_031                -5.152083e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1419
    reference variance = 0.402617
====================================================
  Execution time = 3.8871e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0120e-01
  Total weights = 1.9738e+06
  Execution time = 3.1425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293325729638
                                         uncertainty =       0.002288228011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293325729638
                                         uncertainty =       0.002288228011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382947449
  error estimate for blocks of size 2^( 2) =       0.000397176940
  error estimate for blocks of size 2^( 3) =       0.000410781896
  error estimate for blocks of size 2^( 4) =       0.000420428474
  error estimate for blocks of size 2^( 5) =       0.000425938144
  error estimate for blocks of size 2^( 6) =       0.000429879982
  error estimate for blocks of size 2^( 7) =       0.000428325034

      target function =      -0.910894738395
              le_mean =     -17.206778211447
             les_mean =     296.374413265627
             stat err =       0.000426142909
             autocorr =       1.238317954679
   target nu stat err =       0.000426142909
   target dn stat err =       0.002952183644
      target stat err =       0.004598543809
              std dev =       0.541569476156
             le_variance =       0.293297497504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293313813694
                                         uncertainty =       0.002283079663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293313813694
                                         uncertainty =       0.002283079663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382939690
  error estimate for blocks of size 2^( 2) =       0.000397175826
  error estimate for blocks of size 2^( 3) =       0.000410787572
  error estimate for blocks of size 2^( 4) =       0.000420439152
  error estimate for blocks of size 2^( 5) =       0.000425951819
  error estimate for blocks of size 2^( 6) =       0.000429894885
  error estimate for blocks of size 2^( 7) =       0.000428343749

      target function =      -0.910889384671
              le_mean =     -17.206777471851
             les_mean =     296.374391336644
             stat err =       0.000426157401
             autocorr =       1.238452370568
   target nu stat err =       0.000426157401
   target dn stat err =       0.002949363795
      target stat err =       0.004594203018
              std dev =       0.541558502749
             le_variance =       0.293285611900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293319626228
                                         uncertainty =       0.002285611277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293319626228
                                         uncertainty =       0.002285611277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382943475
  error estimate for blocks of size 2^( 2) =       0.000397176329
  error estimate for blocks of size 2^( 3) =       0.000410784719
  error estimate for blocks of size 2^( 4) =       0.000420433826
  error estimate for blocks of size 2^( 5) =       0.000425945010
  error estimate for blocks of size 2^( 6) =       0.000429887471
  error estimate for blocks of size 2^( 7) =       0.000428334452

      target function =      -0.910893555228
              le_mean =     -17.206777829835
             les_mean =     296.374400924485
             stat err =       0.000426150190
             autocorr =       1.238385976043
   target nu stat err =       0.000426150190
   target dn stat err =       0.002950711637
      target stat err =       0.004596293845
              std dev =       0.541563855396
             le_variance =       0.293291409471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293324956913
                                         uncertainty =       0.002287899064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293324956913
                                         uncertainty =       0.002287899064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382946946
  error estimate for blocks of size 2^( 2) =       0.000397176859
  error estimate for blocks of size 2^( 3) =       0.000410782245
  error estimate for blocks of size 2^( 4) =       0.000420429140
  error estimate for blocks of size 2^( 5) =       0.000425939000
  error estimate for blocks of size 2^( 6) =       0.000429880916
  error estimate for blocks of size 2^( 7) =       0.000428326209

      target function =      -0.910894757479
              le_mean =     -17.206778162813
             les_mean =     296.374411582418
             stat err =       0.000426143816
             autocorr =       1.238326484399
   target nu stat err =       0.000426143816
   target dn stat err =       0.002951994514
      target stat err =       0.004598256424
              std dev =       0.541568764525
             le_variance =       0.293296726709


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910894738395        initial
     3.9062e+00     3.9062e+01             1.2252e-04        -0.910889384671
     1.5625e+01     1.5625e+02             3.0771e-05        -0.910893555228
     6.2500e+01     6.2500e+02             7.7016e-06        -0.910894757479  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 5.4684e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 2.087097e-01 1 1  ON 0
  uu_1                 5.163861e-02 1 1  ON 1
  uu_2                -3.943372e-02 1 1  ON 2
  uu_3                -9.294834e-02 1 1  ON 3
  uu_4                -1.239905e-01 1 1  ON 4
  uu_5                -1.320468e-01 1 1  ON 5
  uu_6                -1.137812e-01 1 1  ON 6
  uu_7                -5.385843e-02 1 1  ON 7
  uu_8                 7.196795e-02 1 1  ON 8
  uu_9                 1.240137e-01 1 1  ON 9
  ud_0                 3.081731e-01 1 1  ON 10
  ud_1                 7.816730e-02 1 1  ON 11
  ud_2                -2.396763e-02 1 1  ON 12
  ud_3                -7.727261e-02 1 1  ON 13
  ud_4                -1.141142e-01 1 1  ON 14
  ud_5                -1.344274e-01 1 1  ON 15
  ud_6                -1.306315e-01 1 1  ON 16
  ud_7                -8.995053e-02 1 1  ON 17
  ud_8                -4.370227e-03 1 1  ON 18
  ud_9                 8.814293e-02 1 1  ON 19
  eO_0                -7.054133e-01 1 1  ON 20
  eO_1                -4.211766e-01 1 1  ON 21
  eO_2                -4.125493e-02 1 1  ON 22
  eO_3                 1.870949e-01 1 1  ON 23
  eO_4                 2.614410e-01 1 1  ON 24
  eO_5                 2.857346e-01 1 1  ON 25
  eO_6                 2.498162e-01 1 1  ON 26
  eO_7                 1.251840e-01 1 1  ON 27
  eO_8                 2.849131e-02 1 1  ON 28
  eO_9                 1.895788e-02 1 1  ON 29
 eH1_0                -2.018666e-01 1 1  ON 30
 eH1_1                -9.763531e-02 1 1  ON 31
 eH1_2                -4.698559e-02 1 1  ON 32
 eH1_3                -1.560813e-02 1 1  ON 33
 eH1_4                 1.891278e-02 1 1  ON 34
 eH1_5                 2.634506e-02 1 1  ON 35
 eH1_6                 7.481229e-02 1 1  ON 36
 eH1_7                 1.040870e-01 1 1  ON 37
 eH1_8                 9.699659e-02 1 1  ON 38
 eH1_9                 2.519287e-02 1 1  ON 39
 eH2_0                -2.031143e-01 1 1  ON 40
 eH2_1                -9.996429e-02 1 1  ON 41
 eH2_2                -4.932676e-02 1 1  ON 42
 eH2_3                -1.793863e-02 1 1  ON 43
 eH2_4                 1.640734e-02 1 1  ON 44
 eH2_5                 2.334041e-02 1 1  ON 45
 eH2_6                 7.785214e-02 1 1  ON 46
 eH2_7                 1.127127e-01 1 1  ON 47
 eH2_8                 9.967606e-02 1 1  ON 48
 eH2_9                 2.791159e-02 1 1  ON 49
ci_001                -4.265266e-02 3 1  ON 50
ci_002                -3.178005e-02 3 1  ON 51
ci_003                -1.244297e-02 3 1  ON 52
ci_004                 2.577618e-02 3 1  ON 53
ci_005                 2.602142e-02 3 1  ON 54
ci_006                -2.088807e-02 3 1  ON 55
ci_007                -2.068860e-02 3 1  ON 56
ci_008                -5.102765e-03 3 1  ON 57
ci_009                -1.563276e-02 3 1  ON 58
ci_010                -1.052004e-02 3 1  ON 59
ci_011                -1.043640e-02 3 1  ON 60
ci_012                -1.055104e-02 3 1  ON 61
ci_013                -2.151052e-02 3 1  ON 62
ci_014                 1.377873e-02 3 1  ON 63
ci_015                 1.356309e-02 3 1  ON 64
ci_016                 1.687068e-02 3 1  ON 65
ci_017                 1.606550e-02 3 1  ON 66
ci_018                 1.117520e-02 3 1  ON 67
ci_019                 1.082492e-02 3 1  ON 68
ci_020                 1.816855e-02 3 1  ON 69
ci_021                 1.790593e-02 3 1  ON 70
ci_022                 1.039431e-02 3 1  ON 71
ci_023                 1.093800e-02 3 1  ON 72
ci_024                 7.119112e-03 3 1  ON 73
ci_025                 7.231410e-03 3 1  ON 74
ci_026                 1.200692e-02 3 1  ON 75
ci_027                 1.215923e-02 3 1  ON 76
ci_028                -1.012528e-02 3 1  ON 77
ci_029                -9.866798e-03 3 1  ON 78
ci_030                -4.808859e-03 3 1  ON 79
ci_031                -5.149892e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0355e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2254
    reference variance = 0.233253
====================================================
  Execution time = 3.7838e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5400e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9345e-01
  Total weights = 1.973569528e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0689e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288219771204
                                         uncertainty =       0.001553611228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288219771204
                                         uncertainty =       0.001553611228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379594388
  error estimate for blocks of size 2^( 2) =       0.000394125414
  error estimate for blocks of size 2^( 3) =       0.000408264694
  error estimate for blocks of size 2^( 4) =       0.000418924230
  error estimate for blocks of size 2^( 5) =       0.000425274067
  error estimate for blocks of size 2^( 6) =       0.000427671805
  error estimate for blocks of size 2^( 7) =       0.000429990176

      target function =      -0.922979640861
              le_mean =     -17.206789955518
             les_mean =     296.367074350002
             stat err =       0.000425465069
             autocorr =       1.256285232283
   target nu stat err =       0.000425465069
   target dn stat err =       0.001775408538
      target stat err =       0.002897385948
              std dev =       0.536827531770
             le_variance =       0.288183798866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720678995552e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922987647812       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922988924453       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922989270200       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922989322168       residual = 9.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922989356108       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922989364704       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922989395885       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922989417013       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922989426425       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922989443518       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922989456931       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922989456711       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922989475051       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922989483171       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922989486579       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922989485301       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922989491431       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922989502012       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922989511043       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922989512197       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922989513668       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922989515160       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922989516809       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922989521131       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922989521517       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.922989521054       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.922989522137       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.922989521691       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.922989522384       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.922989523343       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.922989523723       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.922989523578       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.922989524021       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.922989523083       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.922989523062       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.922989522454       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+01 is 2.876186e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922987647812       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922987968166       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922988054826       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922988067876       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922988076381       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922988078531       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922988086348       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922988091636       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922988093995       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922988098283       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922988101645       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922988101579       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922988106177       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922988108202       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922988109044       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922988108729       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922988110275       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922988112918       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922988115163       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922988115451       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922988115817       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922988116188       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922988116604       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922988117681       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922988117767       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.922988117656       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.922988117929       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.922988117809       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.922988117986       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.922988118233       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.922988118314       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.922988118293       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.922988118388       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.922988118157       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.922988118154       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.922988118001       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+01 is 7.193574e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922987647812       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922987727975       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922987749654       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922987752921       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922987755048       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922987755586       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922987757541       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922987758864       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922987759454       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922987760527       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922987761368       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922987761351       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922987762501       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922987763007       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922987763217       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922987763138       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922987763526       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922987764185       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922987764747       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922987764819       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922987764910       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922987765003       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922987765107       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922987765377       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922987765397       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.922987765369       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.922987765438       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.922987765406       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.922987765452       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.922987765513       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.922987765533       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.922987765530       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.922987765552       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.922987765494       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.922987765493       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.922987765455       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e+02 is 1.798588e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.609278 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8584e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.087105e-01 1 1  ON 0
  uu_1                 5.164021e-02 1 1  ON 1
  uu_2                -3.943202e-02 1 1  ON 2
  uu_3                -9.294685e-02 1 1  ON 3
  uu_4                -1.239894e-01 1 1  ON 4
  uu_5                -1.320461e-01 1 1  ON 5
  uu_6                -1.137806e-01 1 1  ON 6
  uu_7                -5.386252e-02 1 1  ON 7
  uu_8                 7.196075e-02 1 1  ON 8
  uu_9                 1.240148e-01 1 1  ON 9
  ud_0                 3.081715e-01 1 1  ON 10
  ud_1                 7.816577e-02 1 1  ON 11
  ud_2                -2.396962e-02 1 1  ON 12
  ud_3                -7.727435e-02 1 1  ON 13
  ud_4                -1.141143e-01 1 1  ON 14
  ud_5                -1.344259e-01 1 1  ON 15
  ud_6                -1.306292e-01 1 1  ON 16
  ud_7                -8.994647e-02 1 1  ON 17
  ud_8                -4.372527e-03 1 1  ON 18
  ud_9                 8.814206e-02 1 1  ON 19
  eO_0                -7.054133e-01 1 1  ON 20
  eO_1                -4.211771e-01 1 1  ON 21
  eO_2                -4.125531e-02 1 1  ON 22
  eO_3                 1.870948e-01 1 1  ON 23
  eO_4                 2.614404e-01 1 1  ON 24
  eO_5                 2.857329e-01 1 1  ON 25
  eO_6                 2.498158e-01 1 1  ON 26
  eO_7                 1.251872e-01 1 1  ON 27
  eO_8                 2.849159e-02 1 1  ON 28
  eO_9                 1.895790e-02 1 1  ON 29
 eH1_0                -2.018642e-01 1 1  ON 30
 eH1_1                -9.763239e-02 1 1  ON 31
 eH1_2                -4.698379e-02 1 1  ON 32
 eH1_3                -1.560727e-02 1 1  ON 33
 eH1_4                 1.891042e-02 1 1  ON 34
 eH1_5                 2.634094e-02 1 1  ON 35
 eH1_6                 7.481067e-02 1 1  ON 36
 eH1_7                 1.040849e-01 1 1  ON 37
 eH1_8                 9.699831e-02 1 1  ON 38
 eH1_9                 2.519315e-02 1 1  ON 39
 eH2_0                -2.031150e-01 1 1  ON 40
 eH2_1                -9.996277e-02 1 1  ON 41
 eH2_2                -4.932379e-02 1 1  ON 42
 eH2_3                -1.793675e-02 1 1  ON 43
 eH2_4                 1.640853e-02 1 1  ON 44
 eH2_5                 2.333947e-02 1 1  ON 45
 eH2_6                 7.784624e-02 1 1  ON 46
 eH2_7                 1.127107e-01 1 1  ON 47
 eH2_8                 9.967764e-02 1 1  ON 48
 eH2_9                 2.791194e-02 1 1  ON 49
ci_001                -4.265120e-02 3 1  ON 50
ci_002                -3.177872e-02 3 1  ON 51
ci_003                -1.244267e-02 3 1  ON 52
ci_004                 2.577541e-02 3 1  ON 53
ci_005                 2.602124e-02 3 1  ON 54
ci_006                -2.088750e-02 3 1  ON 55
ci_007                -2.068722e-02 3 1  ON 56
ci_008                -5.101097e-03 3 1  ON 57
ci_009                -1.563236e-02 3 1  ON 58
ci_010                -1.051933e-02 3 1  ON 59
ci_011                -1.043441e-02 3 1  ON 60
ci_012                -1.055063e-02 3 1  ON 61
ci_013                -2.150945e-02 3 1  ON 62
ci_014                 1.377781e-02 3 1  ON 63
ci_015                 1.356254e-02 3 1  ON 64
ci_016                 1.686960e-02 3 1  ON 65
ci_017                 1.606457e-02 3 1  ON 66
ci_018                 1.117458e-02 3 1  ON 67
ci_019                 1.082516e-02 3 1  ON 68
ci_020                 1.816885e-02 3 1  ON 69
ci_021                 1.790568e-02 3 1  ON 70
ci_022                 1.039381e-02 3 1  ON 71
ci_023                 1.093713e-02 3 1  ON 72
ci_024                 7.118209e-03 3 1  ON 73
ci_025                 7.230562e-03 3 1  ON 74
ci_026                 1.200661e-02 3 1  ON 75
ci_027                 1.215964e-02 3 1  ON 76
ci_028                -1.012362e-02 3 1  ON 77
ci_029                -9.868061e-03 3 1  ON 78
ci_030                -4.808096e-03 3 1  ON 79
ci_031                -5.149224e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1039
    reference variance = 0.427726
====================================================
  Execution time = 3.7465e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0097e-01
  Total weights = 1.9738e+06
  Execution time = 3.1257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290661535471
                                         uncertainty =       0.002021572950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290661535471
                                         uncertainty =       0.002021572950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381229349
  error estimate for blocks of size 2^( 2) =       0.000396179430
  error estimate for blocks of size 2^( 3) =       0.000409332402
  error estimate for blocks of size 2^( 4) =       0.000419540210
  error estimate for blocks of size 2^( 5) =       0.000426516414
  error estimate for blocks of size 2^( 6) =       0.000428536096
  error estimate for blocks of size 2^( 7) =       0.000429732027

      target function =      -0.911208311588
              le_mean =     -17.206733401243
             les_mean =     296.372649238928
             stat err =       0.000426081187
             autocorr =       1.249142721573
   target nu stat err =       0.000426081187
   target dn stat err =       0.004467523538
      target stat err =       0.006915137873
              std dev =       0.539139716148
             le_variance =       0.290671633529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290658005595
                                         uncertainty =       0.002021005768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290658005595
                                         uncertainty =       0.002021005768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381227043
  error estimate for blocks of size 2^( 2) =       0.000396178520
  error estimate for blocks of size 2^( 3) =       0.000409332908
  error estimate for blocks of size 2^( 4) =       0.000419541675
  error estimate for blocks of size 2^( 5) =       0.000426518220
  error estimate for blocks of size 2^( 6) =       0.000428538217
  error estimate for blocks of size 2^( 7) =       0.000429734126

      target function =      -0.911222007585
              le_mean =     -17.206733371120
             les_mean =     296.372639410305
             stat err =       0.000426083059
             autocorr =       1.249168817348
   target nu stat err =       0.000426083059
   target dn stat err =       0.004460592706
      target stat err =       0.006904731364
              std dev =       0.539136454206
             le_variance =       0.290668116254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290659762552
                                         uncertainty =       0.002021288282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290659762552
                                         uncertainty =       0.002021288282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381228191
  error estimate for blocks of size 2^( 2) =       0.000396178972
  error estimate for blocks of size 2^( 3) =       0.000409332654
  error estimate for blocks of size 2^( 4) =       0.000419540943
  error estimate for blocks of size 2^( 5) =       0.000426517318
  error estimate for blocks of size 2^( 6) =       0.000428537158
  error estimate for blocks of size 2^( 7) =       0.000429733078

      target function =      -0.911215376601
              le_mean =     -17.206733385773
             les_mean =     296.372644169779
             stat err =       0.000426082124
             autocorr =       1.249155811647
   target nu stat err =       0.000426082124
   target dn stat err =       0.004464044347
      target stat err =       0.006909916851
              std dev =       0.539138077795
             le_variance =       0.290669866929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290661313405
                                         uncertainty =       0.002021537314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290661313405
                                         uncertainty =       0.002021537314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381229204
  error estimate for blocks of size 2^( 2) =       0.000396179372
  error estimate for blocks of size 2^( 3) =       0.000409332433
  error estimate for blocks of size 2^( 4) =       0.000419540301
  error estimate for blocks of size 2^( 5) =       0.000426516527
  error estimate for blocks of size 2^( 6) =       0.000428536229
  error estimate for blocks of size 2^( 7) =       0.000429732159

      target function =      -0.911209214218
              le_mean =     -17.206733399270
             les_mean =     296.372648591259
             stat err =       0.000426081304
             autocorr =       1.249144359193
   target nu stat err =       0.000426081304
   target dn stat err =       0.004467087918
      target stat err =       0.006914484442
              std dev =       0.539139510937
             le_variance =       0.290671412253


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911208311588        initial
     1.5625e+01     1.5625e+02             2.8762e-05        -0.911222007585  <--
     6.2500e+01     6.2500e+02             7.1936e-06        -0.911215376601
     2.5000e+02     2.5000e+03             1.7986e-06        -0.911209214218

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 5.3221e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.087129e-01 1 1  ON 0
  uu_1                 5.164500e-02 1 1  ON 1
  uu_2                -3.942694e-02 1 1  ON 2
  uu_3                -9.294240e-02 1 1  ON 3
  uu_4                -1.239859e-01 1 1  ON 4
  uu_5                -1.320440e-01 1 1  ON 5
  uu_6                -1.137786e-01 1 1  ON 6
  uu_7                -5.387479e-02 1 1  ON 7
  uu_8                 7.193918e-02 1 1  ON 8
  uu_9                 1.240182e-01 1 1  ON 9
  ud_0                 3.081665e-01 1 1  ON 10
  ud_1                 7.816115e-02 1 1  ON 11
  ud_2                -2.397557e-02 1 1  ON 12
  ud_3                -7.727955e-02 1 1  ON 13
  ud_4                -1.141145e-01 1 1  ON 14
  ud_5                -1.344213e-01 1 1  ON 15
  ud_6                -1.306223e-01 1 1  ON 16
  ud_7                -8.993432e-02 1 1  ON 17
  ud_8                -4.379412e-03 1 1  ON 18
  ud_9                 8.813945e-02 1 1  ON 19
  eO_0                -7.054136e-01 1 1  ON 20
  eO_1                -4.211786e-01 1 1  ON 21
  eO_2                -4.125647e-02 1 1  ON 22
  eO_3                 1.870943e-01 1 1  ON 23
  eO_4                 2.614386e-01 1 1  ON 24
  eO_5                 2.857278e-01 1 1  ON 25
  eO_6                 2.498149e-01 1 1  ON 26
  eO_7                 1.251970e-01 1 1  ON 27
  eO_8                 2.849242e-02 1 1  ON 28
  eO_9                 1.895796e-02 1 1  ON 29
 eH1_0                -2.018569e-01 1 1  ON 30
 eH1_1                -9.762367e-02 1 1  ON 31
 eH1_2                -4.697838e-02 1 1  ON 32
 eH1_3                -1.560467e-02 1 1  ON 33
 eH1_4                 1.890336e-02 1 1  ON 34
 eH1_5                 2.632862e-02 1 1  ON 35
 eH1_6                 7.480582e-02 1 1  ON 36
 eH1_7                 1.040787e-01 1 1  ON 37
 eH1_8                 9.700345e-02 1 1  ON 38
 eH1_9                 2.519398e-02 1 1  ON 39
 eH2_0                -2.031170e-01 1 1  ON 40
 eH2_1                -9.995821e-02 1 1  ON 41
 eH2_2                -4.931491e-02 1 1  ON 42
 eH2_3                -1.793112e-02 1 1  ON 43
 eH2_4                 1.641210e-02 1 1  ON 44
 eH2_5                 2.333667e-02 1 1  ON 45
 eH2_6                 7.782856e-02 1 1  ON 46
 eH2_7                 1.127046e-01 1 1  ON 47
 eH2_8                 9.968237e-02 1 1  ON 48
 eH2_9                 2.791300e-02 1 1  ON 49
ci_001                -4.264686e-02 3 1  ON 50
ci_002                -3.177474e-02 3 1  ON 51
ci_003                -1.244177e-02 3 1  ON 52
ci_004                 2.577312e-02 3 1  ON 53
ci_005                 2.602067e-02 3 1  ON 54
ci_006                -2.088580e-02 3 1  ON 55
ci_007                -2.068312e-02 3 1  ON 56
ci_008                -5.096119e-03 3 1  ON 57
ci_009                -1.563115e-02 3 1  ON 58
ci_010                -1.051719e-02 3 1  ON 59
ci_011                -1.042849e-02 3 1  ON 60
ci_012                -1.054941e-02 3 1  ON 61
ci_013                -2.150626e-02 3 1  ON 62
ci_014                 1.377506e-02 3 1  ON 63
ci_015                 1.356088e-02 3 1  ON 64
ci_016                 1.686639e-02 3 1  ON 65
ci_017                 1.606179e-02 3 1  ON 66
ci_018                 1.117272e-02 3 1  ON 67
ci_019                 1.082589e-02 3 1  ON 68
ci_020                 1.816975e-02 3 1  ON 69
ci_021                 1.790493e-02 3 1  ON 70
ci_022                 1.039231e-02 3 1  ON 71
ci_023                 1.093451e-02 3 1  ON 72
ci_024                 7.115510e-03 3 1  ON 73
ci_025                 7.228028e-03 3 1  ON 74
ci_026                 1.200568e-02 3 1  ON 75
ci_027                 1.216087e-02 3 1  ON 76
ci_028                -1.011865e-02 3 1  ON 77
ci_029                -9.871836e-03 3 1  ON 78
ci_030                -4.805818e-03 3 1  ON 79
ci_031                -5.147230e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0181e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7195e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.3086
    reference variance = 0.262818
====================================================
  Execution time = 3.7969e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5397e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 3.0037e-01
  Total weights = 1.973661901e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0805e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291930781942
                                         uncertainty =       0.001862881979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291930781942
                                         uncertainty =       0.001862881979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382024726
  error estimate for blocks of size 2^( 2) =       0.000396786578
  error estimate for blocks of size 2^( 3) =       0.000410658766
  error estimate for blocks of size 2^( 4) =       0.000420015367
  error estimate for blocks of size 2^( 5) =       0.000426263397
  error estimate for blocks of size 2^( 6) =       0.000429206717
  error estimate for blocks of size 2^( 7) =       0.000431040853

      target function =      -0.912155348799
              le_mean =     -17.207586346378
             les_mean =     296.401395306878
             stat err =       0.000426631583
             autocorr =       1.247162545042
   target nu stat err =       0.000426631583
   target dn stat err =       0.002537721138
      target stat err =       0.003986929594
              std dev =       0.540264549152
             le_variance =       0.291885783071


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720758634638e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912171904372       residual = 8.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912179172636       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912181421925       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912182181685       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912182377413       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912182655110       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912182720839       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912182797444       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912182926870       residual = 8.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912182963318       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912183159025       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912183268425       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912183419099       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912183536742       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912183584462       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912183597979       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912183599134       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912183659499       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912183677177       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912183695874       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912183685731       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912183682982       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912183730507       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912183753598       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912183761130       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912183764997       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912183761282       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912183763689       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912183756472       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912183753088       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912183762027       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912183767919       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912183764161       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912183765380       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912183766656       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912183766781       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912183765843       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912183766409       residual = 9.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+00 is 1.277060e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912171904372       residual = 8.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912173748111       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912174317256       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912174509872       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912174559111       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912174629947       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912174645211       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912174668478       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912174698008       residual = 8.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912174706988       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912174756352       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912174783880       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912174821836       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912174851308       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912174863058       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912174866351       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912174866611       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912174881756       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912174886161       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912174890675       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912174888128       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912174887555       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912174899421       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912174905140       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912174906895       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912174907779       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912174906908       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912174907489       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912174905648       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912174904844       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912174907062       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912174908443       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912174907519       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912174907839       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912174908154       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912174908177       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912174907945       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912174908095       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+01 is 3.222630e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912171904372       residual = 8.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912172367004       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912172509723       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912172558048       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912172570377       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912172588170       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912172591892       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912172598118       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912172605204       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912172607449       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912172619805       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912172626696       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912172636203       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912172643575       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912172646501       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912172647319       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912172647382       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912172651172       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912172652272       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912172653390       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912172652753       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912172652617       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912172655582       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912172657008       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912172657439       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912172657655       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912172657441       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912172657585       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912172657122       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912172656924       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912172657477       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912172657817       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912172657587       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912172657668       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912172657746       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912172657752       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912172657694       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912172657732       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+01 is 8.075558e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.666660 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8838e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 2.087085e-01 1 1  ON 0
  uu_1                 5.164819e-02 1 1  ON 1
  uu_2                -3.942277e-02 1 1  ON 2
  uu_3                -9.293662e-02 1 1  ON 3
  uu_4                -1.239768e-01 1 1  ON 4
  uu_5                -1.320317e-01 1 1  ON 5
  uu_6                -1.137778e-01 1 1  ON 6
  uu_7                -5.388659e-02 1 1  ON 7
  uu_8                 7.191265e-02 1 1  ON 8
  uu_9                 1.240206e-01 1 1  ON 9
  ud_0                 3.081554e-01 1 1  ON 10
  ud_1                 7.815146e-02 1 1  ON 11
  ud_2                -2.398534e-02 1 1  ON 12
  ud_3                -7.729103e-02 1 1  ON 13
  ud_4                -1.141229e-01 1 1  ON 14
  ud_5                -1.344171e-01 1 1  ON 15
  ud_6                -1.305901e-01 1 1  ON 16
  ud_7                -8.991066e-02 1 1  ON 17
  ud_8                -4.388232e-03 1 1  ON 18
  ud_9                 8.812959e-02 1 1  ON 19
  eO_0                -7.054067e-01 1 1  ON 20
  eO_1                -4.211793e-01 1 1  ON 21
  eO_2                -4.126073e-02 1 1  ON 22
  eO_3                 1.870884e-01 1 1  ON 23
  eO_4                 2.614262e-01 1 1  ON 24
  eO_5                 2.857146e-01 1 1  ON 25
  eO_6                 2.498292e-01 1 1  ON 26
  eO_7                 1.252109e-01 1 1  ON 27
  eO_8                 2.849312e-02 1 1  ON 28
  eO_9                 1.895850e-02 1 1  ON 29
 eH1_0                -2.018619e-01 1 1  ON 30
 eH1_1                -9.762622e-02 1 1  ON 31
 eH1_2                -4.697543e-02 1 1  ON 32
 eH1_3                -1.560438e-02 1 1  ON 33
 eH1_4                 1.889170e-02 1 1  ON 34
 eH1_5                 2.630234e-02 1 1  ON 35
 eH1_6                 7.483415e-02 1 1  ON 36
 eH1_7                 1.040854e-01 1 1  ON 37
 eH1_8                 9.700931e-02 1 1  ON 38
 eH1_9                 2.519574e-02 1 1  ON 39
 eH2_0                -2.031205e-01 1 1  ON 40
 eH2_1                -9.995871e-02 1 1  ON 41
 eH2_2                -4.930734e-02 1 1  ON 42
 eH2_3                -1.792747e-02 1 1  ON 43
 eH2_4                 1.640646e-02 1 1  ON 44
 eH2_5                 2.333506e-02 1 1  ON 45
 eH2_6                 7.781750e-02 1 1  ON 46
 eH2_7                 1.127079e-01 1 1  ON 47
 eH2_8                 9.968755e-02 1 1  ON 48
 eH2_9                 2.791563e-02 1 1  ON 49
ci_001                -4.264046e-02 3 1  ON 50
ci_002                -3.176732e-02 3 1  ON 51
ci_003                -1.243672e-02 3 1  ON 52
ci_004                 2.577356e-02 3 1  ON 53
ci_005                 2.602582e-02 3 1  ON 54
ci_006                -2.088394e-02 3 1  ON 55
ci_007                -2.068237e-02 3 1  ON 56
ci_008                -5.090775e-03 3 1  ON 57
ci_009                -1.563184e-02 3 1  ON 58
ci_010                -1.051182e-02 3 1  ON 59
ci_011                -1.042593e-02 3 1  ON 60
ci_012                -1.054109e-02 3 1  ON 61
ci_013                -2.150510e-02 3 1  ON 62
ci_014                 1.376832e-02 3 1  ON 63
ci_015                 1.356420e-02 3 1  ON 64
ci_016                 1.686395e-02 3 1  ON 65
ci_017                 1.606383e-02 3 1  ON 66
ci_018                 1.117113e-02 3 1  ON 67
ci_019                 1.082739e-02 3 1  ON 68
ci_020                 1.816693e-02 3 1  ON 69
ci_021                 1.790638e-02 3 1  ON 70
ci_022                 1.039532e-02 3 1  ON 71
ci_023                 1.093346e-02 3 1  ON 72
ci_024                 7.118605e-03 3 1  ON 73
ci_025                 7.226402e-03 3 1  ON 74
ci_026                 1.199819e-02 3 1  ON 75
ci_027                 1.215596e-02 3 1  ON 76
ci_028                -1.011533e-02 3 1  ON 77
ci_029                -9.868717e-03 3 1  ON 78
ci_030                -4.807895e-03 3 1  ON 79
ci_031                -5.142284e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2446
    reference variance = 0.179216
====================================================
  Execution time = 3.8091e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0789e-01
  Total weights = 1.9737e+06
  Execution time = 3.1559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301237124072
                                         uncertainty =       0.013851291892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301237124072
                                         uncertainty =       0.013851291892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388040250
  error estimate for blocks of size 2^( 2) =       0.000402462231
  error estimate for blocks of size 2^( 3) =       0.000416060271
  error estimate for blocks of size 2^( 4) =       0.000425539767
  error estimate for blocks of size 2^( 5) =       0.000431528451
  error estimate for blocks of size 2^( 6) =       0.000434310526
  error estimate for blocks of size 2^( 7) =       0.000436752693

      target function =      -0.900204013886
              le_mean =     -17.206889460086
             les_mean =     296.384948045498
             stat err =       0.000432032859
             autocorr =       1.239595542152
   target nu stat err =       0.000432032859
   target dn stat err =       0.014245270177
      target stat err =       0.021432681356
              std dev =       0.548771784954
             le_variance =       0.301150471962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301235211546
                                         uncertainty =       0.013857408958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301235211546
                                         uncertainty =       0.013857408958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388038990
  error estimate for blocks of size 2^( 2) =       0.000402467493
  error estimate for blocks of size 2^( 3) =       0.000416072415
  error estimate for blocks of size 2^( 4) =       0.000425556350
  error estimate for blocks of size 2^( 5) =       0.000431548910
  error estimate for blocks of size 2^( 6) =       0.000434332881
  error estimate for blocks of size 2^( 7) =       0.000436775342

      target function =      -0.900267592064
              le_mean =     -17.206889668071
             les_mean =     296.384912609000
             stat err =       0.000432053371
             autocorr =       1.239721302652
   target nu stat err =       0.000432053371
   target dn stat err =       0.014250796043
      target stat err =       0.021444033347
              std dev =       0.548770002552
             le_variance =       0.301148515701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301236110274
                                         uncertainty =       0.013854387066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301236110274
                                         uncertainty =       0.013854387066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388039583
  error estimate for blocks of size 2^( 2) =       0.000402464863
  error estimate for blocks of size 2^( 3) =       0.000416066383
  error estimate for blocks of size 2^( 4) =       0.000425548122
  error estimate for blocks of size 2^( 5) =       0.000431538765
  error estimate for blocks of size 2^( 6) =       0.000434321799
  error estimate for blocks of size 2^( 7) =       0.000436764113

      target function =      -0.900238169586
              le_mean =     -17.206889558931
             les_mean =     296.384928573502
             stat err =       0.000432043200
             autocorr =       1.239659147357
   target nu stat err =       0.000432043200
   target dn stat err =       0.014248043727
      target stat err =       0.021438485520
              std dev =       0.548770841081
             le_variance =       0.301149436021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301236992106
                                         uncertainty =       0.013851679961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301236992106
                                         uncertainty =       0.013851679961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388040164
  error estimate for blocks of size 2^( 2) =       0.000402462558
  error estimate for blocks of size 2^( 3) =       0.000416061034
  error estimate for blocks of size 2^( 4) =       0.000425540811
  error estimate for blocks of size 2^( 5) =       0.000431529741
  error estimate for blocks of size 2^( 6) =       0.000434311935
  error estimate for blocks of size 2^( 7) =       0.000436754121

      target function =      -0.900208541064
              le_mean =     -17.206889471733
             les_mean =     296.384945415549
             stat err =       0.000432034152
             autocorr =       1.239603515383
   target nu stat err =       0.000432034152
   target dn stat err =       0.014245615027
      target stat err =       0.021433416308
              std dev =       0.548771662188
             le_variance =       0.301150337220


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.900204013886        initial
     3.9062e+00     3.9062e+01             1.2771e-04        -0.900267592064  <--
     1.5625e+01     1.5625e+02             3.2226e-05        -0.900238169586
     6.2500e+01     6.2500e+02             8.0756e-06        -0.900208541064

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 5.3956e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 2.086956e-01 1 1  ON 0
  uu_1                 5.165774e-02 1 1  ON 1
  uu_2                -3.941031e-02 1 1  ON 2
  uu_3                -9.291939e-02 1 1  ON 3
  uu_4                -1.239497e-01 1 1  ON 4
  uu_5                -1.319950e-01 1 1  ON 5
  uu_6                -1.137753e-01 1 1  ON 6
  uu_7                -5.392180e-02 1 1  ON 7
  uu_8                 7.183320e-02 1 1  ON 8
  uu_9                 1.240279e-01 1 1  ON 9
  ud_0                 3.081223e-01 1 1  ON 10
  ud_1                 7.812255e-02 1 1  ON 11
  ud_2                -2.401441e-02 1 1  ON 12
  ud_3                -7.732509e-02 1 1  ON 13
  ud_4                -1.141480e-01 1 1  ON 14
  ud_5                -1.344045e-01 1 1  ON 15
  ud_6                -1.304946e-01 1 1  ON 16
  ud_7                -8.983998e-02 1 1  ON 17
  ud_8                -4.414365e-03 1 1  ON 18
  ud_9                 8.810004e-02 1 1  ON 19
  eO_0                -7.053865e-01 1 1  ON 20
  eO_1                -4.211813e-01 1 1  ON 21
  eO_2                -4.127349e-02 1 1  ON 22
  eO_3                 1.870708e-01 1 1  ON 23
  eO_4                 2.613893e-01 1 1  ON 24
  eO_5                 2.856750e-01 1 1  ON 25
  eO_6                 2.498721e-01 1 1  ON 26
  eO_7                 1.252528e-01 1 1  ON 27
  eO_8                 2.849522e-02 1 1  ON 28
  eO_9                 1.896010e-02 1 1  ON 29
 eH1_0                -2.018769e-01 1 1  ON 30
 eH1_1                -9.763385e-02 1 1  ON 31
 eH1_2                -4.696690e-02 1 1  ON 32
 eH1_3                -1.560373e-02 1 1  ON 33
 eH1_4                 1.885693e-02 1 1  ON 34
 eH1_5                 2.622426e-02 1 1  ON 35
 eH1_6                 7.491855e-02 1 1  ON 36
 eH1_7                 1.041058e-01 1 1  ON 37
 eH1_8                 9.702690e-02 1 1  ON 38
 eH1_9                 2.520101e-02 1 1  ON 39
 eH2_0                -2.031309e-01 1 1  ON 40
 eH2_1                -9.996011e-02 1 1  ON 41
 eH2_2                -4.928499e-02 1 1  ON 42
 eH2_3                -1.791671e-02 1 1  ON 43
 eH2_4                 1.638972e-02 1 1  ON 44
 eH2_5                 2.333014e-02 1 1  ON 45
 eH2_6                 7.778455e-02 1 1  ON 46
 eH2_7                 1.127179e-01 1 1  ON 47
 eH2_8                 9.970308e-02 1 1  ON 48
 eH2_9                 2.792352e-02 1 1  ON 49
ci_001                -4.262155e-02 3 1  ON 50
ci_002                -3.174541e-02 3 1  ON 51
ci_003                -1.242181e-02 3 1  ON 52
ci_004                 2.577483e-02 3 1  ON 53
ci_005                 2.604101e-02 3 1  ON 54
ci_006                -2.087846e-02 3 1  ON 55
ci_007                -2.068018e-02 3 1  ON 56
ci_008                -5.075069e-03 3 1  ON 57
ci_009                -1.563388e-02 3 1  ON 58
ci_010                -1.049597e-02 3 1  ON 59
ci_011                -1.041840e-02 3 1  ON 60
ci_012                -1.051659e-02 3 1  ON 61
ci_013                -2.150169e-02 3 1  ON 62
ci_014                 1.374845e-02 3 1  ON 63
ci_015                 1.357401e-02 3 1  ON 64
ci_016                 1.685673e-02 3 1  ON 65
ci_017                 1.606987e-02 3 1  ON 66
ci_018                 1.116644e-02 3 1  ON 67
ci_019                 1.083182e-02 3 1  ON 68
ci_020                 1.815864e-02 3 1  ON 69
ci_021                 1.791064e-02 3 1  ON 70
ci_022                 1.040419e-02 3 1  ON 71
ci_023                 1.093033e-02 3 1  ON 72
ci_024                 7.127740e-03 3 1  ON 73
ci_025                 7.221599e-03 3 1  ON 74
ci_026                 1.197614e-02 3 1  ON 75
ci_027                 1.214155e-02 3 1  ON 76
ci_028                -1.010550e-02 3 1  ON 77
ci_029                -9.859519e-03 3 1  ON 78
ci_030                -4.814005e-03 3 1  ON 79
ci_031                -5.127731e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0281e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1562
    reference variance = 0.150046
====================================================
  Execution time = 3.7885e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5432e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9967e-01
  Total weights = 1.973650534e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0774e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292225563134
                                         uncertainty =       0.002018697754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292225563134
                                         uncertainty =       0.002018697754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382212199
  error estimate for blocks of size 2^( 2) =       0.000397294556
  error estimate for blocks of size 2^( 3) =       0.000411007011
  error estimate for blocks of size 2^( 4) =       0.000421198674
  error estimate for blocks of size 2^( 5) =       0.000427461815
  error estimate for blocks of size 2^( 6) =       0.000429973630
  error estimate for blocks of size 2^( 7) =       0.000433612184

      target function =      -0.913238103723
              le_mean =     -17.207485078877
             les_mean =     296.397210651550
             stat err =       0.000428061576
             autocorr =       1.254305719768
   target nu stat err =       0.000428061576
   target dn stat err =       0.002758560698
      target stat err =       0.004332653803
              std dev =       0.540529675656
             le_variance =       0.292172330265


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720748507888e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913256805033       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913316489223       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913327394237       residual = 7.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913328682656       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913330428091       residual = 8.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913330750179       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913331471116       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913332337553       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913332483936       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913332596821       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913332918786       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913333165904       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913333530915       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913333734663       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913333833342       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913333925664       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913334013280       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913334448951       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913334499550       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913334490755       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913334580508       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913334582315       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913334601160       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913334632799       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913334663630       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913334709950       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913334688062       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913334656443       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913334667632       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913334650340       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913334629879       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913334609410       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913334611511       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913334613931       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913334627583       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913334627473       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913334629023       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913334627417       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e-01 is 4.746513e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913256805033       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913272630236       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913275478091       residual = 7.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913275809638       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913276261858       residual = 8.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913276343786       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913276534561       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913276757598       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913276795662       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913276824180       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913276907829       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913276972249       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913277064611       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913277115386       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913277139126       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913277163479       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913277186033       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913277296080       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913277304970       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913277301162       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913277322795       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913277324557       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913277328360       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913277334066       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913277346298       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913277353011       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913277347367       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913277340631       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913277344605       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913277337708       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913277333541       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913277328716       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913277329328       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913277330159       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913277333272       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913277332779       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913277333527       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913277333258       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+00 is 1.194661e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913256805033       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913260822186       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913261542146       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913261625635       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913261739723       residual = 8.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913261760293       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913261808696       residual = 8.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913261864852       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913261874475       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913261881622       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913261902740       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913261919019       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913261942168       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913261954844       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913261960718       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913261966893       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913261972570       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913262000120       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913262002101       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913262001055       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913262006408       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913262006943       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913262007829       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913262009114       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913262012452       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913262013758       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913262012429       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913262010893       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913262011767       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913262009835       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913262009039       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913262007809       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913262007981       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913262008197       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913262008950       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913262008806       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913262009017       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913262008955       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+01 is 2.991748e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.724955 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8724e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.087298e-01 1 1  ON 0
  uu_1                 5.168648e-02 1 1  ON 1
  uu_2                -3.938101e-02 1 1  ON 2
  uu_3                -9.289603e-02 1 1  ON 3
  uu_4                -1.239331e-01 1 1  ON 4
  uu_5                -1.320124e-01 1 1  ON 5
  uu_6                -1.138202e-01 1 1  ON 6
  uu_7                -5.394405e-02 1 1  ON 7
  uu_8                 7.171373e-02 1 1  ON 8
  uu_9                 1.240498e-01 1 1  ON 9
  ud_0                 3.080550e-01 1 1  ON 10
  ud_1                 7.806446e-02 1 1  ON 11
  ud_2                -2.406294e-02 1 1  ON 12
  ud_3                -7.736216e-02 1 1  ON 13
  ud_4                -1.141439e-01 1 1  ON 14
  ud_5                -1.343490e-01 1 1  ON 15
  ud_6                -1.304003e-01 1 1  ON 16
  ud_7                -8.976489e-02 1 1  ON 17
  ud_8                -4.467863e-03 1 1  ON 18
  ud_9                 8.808033e-02 1 1  ON 19
  eO_0                -7.053861e-01 1 1  ON 20
  eO_1                -4.211964e-01 1 1  ON 21
  eO_2                -4.128682e-02 1 1  ON 22
  eO_3                 1.870420e-01 1 1  ON 23
  eO_4                 2.613644e-01 1 1  ON 24
  eO_5                 2.856676e-01 1 1  ON 25
  eO_6                 2.498776e-01 1 1  ON 26
  eO_7                 1.253252e-01 1 1  ON 27
  eO_8                 2.850147e-02 1 1  ON 28
  eO_9                 1.896118e-02 1 1  ON 29
 eH1_0                -2.018870e-01 1 1  ON 30
 eH1_1                -9.760455e-02 1 1  ON 31
 eH1_2                -4.694128e-02 1 1  ON 32
 eH1_3                -1.559403e-02 1 1  ON 33
 eH1_4                 1.883342e-02 1 1  ON 34
 eH1_5                 2.616892e-02 1 1  ON 35
 eH1_6                 7.489725e-02 1 1  ON 36
 eH1_7                 1.041097e-01 1 1  ON 37
 eH1_8                 9.706040e-02 1 1  ON 38
 eH1_9                 2.520747e-02 1 1  ON 39
 eH2_0                -2.031155e-01 1 1  ON 40
 eH2_1                -9.990907e-02 1 1  ON 41
 eH2_2                -4.924371e-02 1 1  ON 42
 eH2_3                -1.789279e-02 1 1  ON 43
 eH2_4                 1.635997e-02 1 1  ON 44
 eH2_5                 2.328291e-02 1 1  ON 45
 eH2_6                 7.774115e-02 1 1  ON 46
 eH2_7                 1.126761e-01 1 1  ON 47
 eH2_8                 9.972407e-02 1 1  ON 48
 eH2_9                 2.793126e-02 1 1  ON 49
ci_001                -4.260514e-02 3 1  ON 50
ci_002                -3.173268e-02 3 1  ON 51
ci_003                -1.238960e-02 3 1  ON 52
ci_004                 2.580024e-02 3 1  ON 53
ci_005                 2.602935e-02 3 1  ON 54
ci_006                -2.084489e-02 3 1  ON 55
ci_007                -2.066377e-02 3 1  ON 56
ci_008                -5.031612e-03 3 1  ON 57
ci_009                -1.562826e-02 3 1  ON 58
ci_010                -1.049565e-02 3 1  ON 59
ci_011                -1.038586e-02 3 1  ON 60
ci_012                -1.047887e-02 3 1  ON 61
ci_013                -2.151859e-02 3 1  ON 62
ci_014                 1.373634e-02 3 1  ON 63
ci_015                 1.357982e-02 3 1  ON 64
ci_016                 1.684169e-02 3 1  ON 65
ci_017                 1.604890e-02 3 1  ON 66
ci_018                 1.115736e-02 3 1  ON 67
ci_019                 1.082925e-02 3 1  ON 68
ci_020                 1.815567e-02 3 1  ON 69
ci_021                 1.790410e-02 3 1  ON 70
ci_022                 1.042584e-02 3 1  ON 71
ci_023                 1.091025e-02 3 1  ON 72
ci_024                 7.114249e-03 3 1  ON 73
ci_025                 7.194585e-03 3 1  ON 74
ci_026                 1.194090e-02 3 1  ON 75
ci_027                 1.215197e-02 3 1  ON 76
ci_028                -1.009513e-02 3 1  ON 77
ci_029                -9.812500e-03 3 1  ON 78
ci_030                -4.813970e-03 3 1  ON 79
ci_031                -5.089440e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2368
    reference variance = 0.272704
====================================================
  Execution time = 3.9200e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9616e-01
  Total weights = 1.9735e+06
  Execution time = 3.1613e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288487814421
                                         uncertainty =       0.001726130455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288487814421
                                         uncertainty =       0.001726130455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380024454
  error estimate for blocks of size 2^( 2) =       0.000395515457
  error estimate for blocks of size 2^( 3) =       0.000409115726
  error estimate for blocks of size 2^( 4) =       0.000418911317
  error estimate for blocks of size 2^( 5) =       0.000424575193
  error estimate for blocks of size 2^( 6) =       0.000427935174
  error estimate for blocks of size 2^( 7) =       0.000430225606

      target function =      -0.918673122107
              le_mean =     -17.205608482486
             les_mean =     296.329164176389
             stat err =       0.000425411822
             autocorr =       1.253129696304
   target nu stat err =       0.000425411822
   target dn stat err =       0.002122407192
      target stat err =       0.003392016724
              std dev =       0.537435736885
             le_variance =       0.288837171281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288458718400
                                         uncertainty =       0.001723901598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288458718400
                                         uncertainty =       0.001723901598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380005605
  error estimate for blocks of size 2^( 2) =       0.000395530359
  error estimate for blocks of size 2^( 3) =       0.000409163244
  error estimate for blocks of size 2^( 4) =       0.000418982555
  error estimate for blocks of size 2^( 5) =       0.000424658852
  error estimate for blocks of size 2^( 6) =       0.000428025557
  error estimate for blocks of size 2^( 7) =       0.000430313898

      target function =      -0.918583658439
              le_mean =     -17.205607708718
             les_mean =     296.329194867271
             stat err =       0.000425495215
             autocorr =       1.253745415772
   target nu stat err =       0.000425495215
   target dn stat err =       0.002121031422
      target stat err =       0.003389298047
              std dev =       0.537409079746
             le_variance =       0.288808518993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288471323061
                                         uncertainty =       0.001724926624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288471323061
                                         uncertainty =       0.001724926624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380013759
  error estimate for blocks of size 2^( 2) =       0.000395522454
  error estimate for blocks of size 2^( 3) =       0.000409139859
  error estimate for blocks of size 2^( 4) =       0.000418947836
  error estimate for blocks of size 2^( 5) =       0.000424618309
  error estimate for blocks of size 2^( 6) =       0.000427981828
  error estimate for blocks of size 2^( 7) =       0.000430270646

      target function =      -0.918731419043
              le_mean =     -17.205607892614
             les_mean =     296.329106563375
             stat err =       0.000425454655
             autocorr =       1.253452601751
   target nu stat err =       0.000425454655
   target dn stat err =       0.002120417115
      target stat err =       0.003389412880
              std dev =       0.537420611937
             le_variance =       0.288820914134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288485577370
                                         uncertainty =       0.001725974522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288485577370
                                         uncertainty =       0.001725974522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380023002
  error estimate for blocks of size 2^( 2) =       0.000395516241
  error estimate for blocks of size 2^( 3) =       0.000409118672
  error estimate for blocks of size 2^( 4) =       0.000418915812
  error estimate for blocks of size 2^( 5) =       0.000424580544
  error estimate for blocks of size 2^( 6) =       0.000427940970
  error estimate for blocks of size 2^( 7) =       0.000430231178

      target function =      -0.918734636046
              le_mean =     -17.205608385147
             les_mean =     296.329121438215
             stat err =       0.000425417126
             autocorr =       1.253170521923
   target nu stat err =       0.000425417126
   target dn stat err =       0.002121837833
      target stat err =       0.003391593255
              std dev =       0.537433683188
             le_variance =       0.288834963825


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918673122107        initial
     9.7656e-01     9.7656e+00             4.7465e-04        -0.918583658439
     3.9062e+00     3.9062e+01             1.1947e-04        -0.918731419043
     1.5625e+01     1.5625e+02             2.9917e-05        -0.918734636046  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 5.5099e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.087042e-01 1 1  ON 0
  uu_1                 5.166497e-02 1 1  ON 1
  uu_2                -3.940294e-02 1 1  ON 2
  uu_3                -9.291352e-02 1 1  ON 3
  uu_4                -1.239455e-01 1 1  ON 4
  uu_5                -1.319994e-01 1 1  ON 5
  uu_6                -1.137866e-01 1 1  ON 6
  uu_7                -5.392734e-02 1 1  ON 7
  uu_8                 7.180328e-02 1 1  ON 8
  uu_9                 1.240334e-01 1 1  ON 9
  ud_0                 3.081054e-01 1 1  ON 10
  ud_1                 7.810792e-02 1 1  ON 11
  ud_2                -2.402663e-02 1 1  ON 12
  ud_3                -7.733442e-02 1 1  ON 13
  ud_4                -1.141470e-01 1 1  ON 14
  ud_5                -1.343905e-01 1 1  ON 15
  ud_6                -1.304708e-01 1 1  ON 16
  ud_7                -8.982114e-02 1 1  ON 17
  ud_8                -4.427811e-03 1 1  ON 18
  ud_9                 8.809512e-02 1 1  ON 19
  eO_0                -7.053863e-01 1 1  ON 20
  eO_1                -4.211851e-01 1 1  ON 21
  eO_2                -4.127678e-02 1 1  ON 22
  eO_3                 1.870636e-01 1 1  ON 23
  eO_4                 2.613830e-01 1 1  ON 24
  eO_5                 2.856731e-01 1 1  ON 25
  eO_6                 2.498735e-01 1 1  ON 26
  eO_7                 1.252709e-01 1 1  ON 27
  eO_8                 2.849679e-02 1 1  ON 28
  eO_9                 1.896037e-02 1 1  ON 29
 eH1_0                -2.018795e-01 1 1  ON 30
 eH1_1                -9.762645e-02 1 1  ON 31
 eH1_2                -4.696043e-02 1 1  ON 32
 eH1_3                -1.560128e-02 1 1  ON 33
 eH1_4                 1.885101e-02 1 1  ON 34
 eH1_5                 2.621035e-02 1 1  ON 35
 eH1_6                 7.491324e-02 1 1  ON 36
 eH1_7                 1.041068e-01 1 1  ON 37
 eH1_8                 9.703528e-02 1 1  ON 38
 eH1_9                 2.520262e-02 1 1  ON 39
 eH2_0                -2.031271e-01 1 1  ON 40
 eH2_1                -9.994725e-02 1 1  ON 41
 eH2_2                -4.927461e-02 1 1  ON 42
 eH2_3                -1.791070e-02 1 1  ON 43
 eH2_4                 1.638219e-02 1 1  ON 44
 eH2_5                 2.331828e-02 1 1  ON 45
 eH2_6                 7.777369e-02 1 1  ON 46
 eH2_7                 1.127075e-01 1 1  ON 47
 eH2_8                 9.970833e-02 1 1  ON 48
 eH2_9                 2.792546e-02 1 1  ON 49
ci_001                -4.261740e-02 3 1  ON 50
ci_002                -3.174219e-02 3 1  ON 51
ci_003                -1.241365e-02 3 1  ON 52
ci_004                 2.578127e-02 3 1  ON 53
ci_005                 2.603805e-02 3 1  ON 54
ci_006                -2.086997e-02 3 1  ON 55
ci_007                -2.067603e-02 3 1  ON 56
ci_008                -5.064032e-03 3 1  ON 57
ci_009                -1.563246e-02 3 1  ON 58
ci_010                -1.049589e-02 3 1  ON 59
ci_011                -1.041016e-02 3 1  ON 60
ci_012                -1.050703e-02 3 1  ON 61
ci_013                -2.150596e-02 3 1  ON 62
ci_014                 1.374538e-02 3 1  ON 63
ci_015                 1.357548e-02 3 1  ON 64
ci_016                 1.685292e-02 3 1  ON 65
ci_017                 1.606457e-02 3 1  ON 66
ci_018                 1.116414e-02 3 1  ON 67
ci_019                 1.083117e-02 3 1  ON 68
ci_020                 1.815789e-02 3 1  ON 69
ci_021                 1.790899e-02 3 1  ON 70
ci_022                 1.040967e-02 3 1  ON 71
ci_023                 1.092525e-02 3 1  ON 72
ci_024                 7.124330e-03 3 1  ON 73
ci_025                 7.214766e-03 3 1  ON 74
ci_026                 1.196719e-02 3 1  ON 75
ci_027                 1.214419e-02 3 1  ON 76
ci_028                -1.010287e-02 3 1  ON 77
ci_029                -9.847612e-03 3 1  ON 78
ci_030                -4.813996e-03 3 1  ON 79
ci_031                -5.118016e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0383e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2162
    reference variance = 0.313634
====================================================
  Execution time = 3.8430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5432e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9964e-01
  Total weights = 1.973712984e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0781e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291322717897
                                         uncertainty =       0.001614700673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291322717897
                                         uncertainty =       0.001614700673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381622045
  error estimate for blocks of size 2^( 2) =       0.000396684211
  error estimate for blocks of size 2^( 3) =       0.000410276093
  error estimate for blocks of size 2^( 4) =       0.000420106707
  error estimate for blocks of size 2^( 5) =       0.000425155763
  error estimate for blocks of size 2^( 6) =       0.000427533887
  error estimate for blocks of size 2^( 7) =       0.000428445007

      target function =      -0.913297781569
              le_mean =     -17.206786024148
             les_mean =     296.373126518736
             stat err =       0.000425310341
             autocorr =       1.242066861425
   target nu stat err =       0.000425310341
   target dn stat err =       0.002705992006
      target stat err =       0.004246669457
              std dev =       0.539695072226
             le_variance =       0.291270770985


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720678602415e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913316473404       residual = 8.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913325409950       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913327703700       residual = 4.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913328216497       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913328351080       residual = 9.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913328442880       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913328571873       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913328776162       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913328851936       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913328906483       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913328973414       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913329031441       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913329107386       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913329221769       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913329282627       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913329328802       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913329373313       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913329338756       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913329362119       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913329401949       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913329413164       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913329410543       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913329396240       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913329405526       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913329421178       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913329432949       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913329434458       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913329425940       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913329426278       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913329423111       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913329440373       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913329445393       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913329440912       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913329434516       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913329438326       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913329436922       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913329435909       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913329436912       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913329438163       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+00 is 1.206189e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913316473404       residual = 8.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913318739021       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913319319553       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913319449434       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913319483478       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913319506921       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913319539328       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913319590622       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913319609755       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913319623587       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913319640556       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913319655109       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913319674060       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913319702856       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913319718119       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913319729553       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913319740598       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913319731910       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913319737817       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913319747827       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913319750434       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913319749674       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913319746066       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913319748482       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913319752422       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913319755307       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913319755576       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913319753408       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913319753511       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913319752851       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913319757138       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913319758240       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913319757100       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913319755682       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913319756592       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913319756141       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+01 is 2.992966e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913316473404       residual = 8.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913317041810       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913317187394       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913317219971       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913317228507       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913317234401       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913317242512       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913317255348       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913317260144       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913317263614       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913317267871       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913317271512       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913317276248       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913317283459       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913317287278       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913317290129       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913317292885       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913317290710       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913317292191       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913317294697       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913317295336       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913317295139       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913317294236       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913317294846       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913317295832       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913317296549       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913317296610       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913317296066       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913317296093       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913317295936       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913317297006       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913317297272       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913317296986       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913317296642       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913317296867       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913317296748       residual = 9.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+01 is 7.486106e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.779005 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9273e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.087067e-01 1 1  ON 0
  uu_1                 5.167342e-02 1 1  ON 1
  uu_2                -3.939426e-02 1 1  ON 2
  uu_3                -9.290626e-02 1 1  ON 3
  uu_4                -1.239426e-01 1 1  ON 4
  uu_5                -1.319979e-01 1 1  ON 5
  uu_6                -1.137853e-01 1 1  ON 6
  uu_7                -5.393877e-02 1 1  ON 7
  uu_8                 7.177335e-02 1 1  ON 8
  uu_9                 1.240344e-01 1 1  ON 9
  ud_0                 3.080918e-01 1 1  ON 10
  ud_1                 7.809803e-02 1 1  ON 11
  ud_2                -2.403481e-02 1 1  ON 12
  ud_3                -7.734221e-02 1 1  ON 13
  ud_4                -1.141484e-01 1 1  ON 14
  ud_5                -1.343831e-01 1 1  ON 15
  ud_6                -1.304530e-01 1 1  ON 16
  ud_7                -8.980038e-02 1 1  ON 17
  ud_8                -4.437451e-03 1 1  ON 18
  ud_9                 8.809478e-02 1 1  ON 19
  eO_0                -7.053828e-01 1 1  ON 20
  eO_1                -4.211888e-01 1 1  ON 21
  eO_2                -4.128297e-02 1 1  ON 22
  eO_3                 1.870600e-01 1 1  ON 23
  eO_4                 2.613834e-01 1 1  ON 24
  eO_5                 2.856591e-01 1 1  ON 25
  eO_6                 2.498776e-01 1 1  ON 26
  eO_7                 1.252876e-01 1 1  ON 27
  eO_8                 2.849979e-02 1 1  ON 28
  eO_9                 1.896045e-02 1 1  ON 29
 eH1_0                -2.018712e-01 1 1  ON 30
 eH1_1                -9.762007e-02 1 1  ON 31
 eH1_2                -4.694653e-02 1 1  ON 32
 eH1_3                -1.559695e-02 1 1  ON 33
 eH1_4                 1.884445e-02 1 1  ON 34
 eH1_5                 2.618834e-02 1 1  ON 35
 eH1_6                 7.490635e-02 1 1  ON 36
 eH1_7                 1.041008e-01 1 1  ON 37
 eH1_8                 9.704226e-02 1 1  ON 38
 eH1_9                 2.520389e-02 1 1  ON 39
 eH2_0                -2.031349e-01 1 1  ON 40
 eH2_1                -9.994295e-02 1 1  ON 41
 eH2_2                -4.926739e-02 1 1  ON 42
 eH2_3                -1.790481e-02 1 1  ON 43
 eH2_4                 1.638822e-02 1 1  ON 44
 eH2_5                 2.330843e-02 1 1  ON 45
 eH2_6                 7.776435e-02 1 1  ON 46
 eH2_7                 1.127002e-01 1 1  ON 47
 eH2_8                 9.971517e-02 1 1  ON 48
 eH2_9                 2.792937e-02 1 1  ON 49
ci_001                -4.261356e-02 3 1  ON 50
ci_002                -3.173779e-02 3 1  ON 51
ci_003                -1.240848e-02 3 1  ON 52
ci_004                 2.578316e-02 3 1  ON 53
ci_005                 2.603267e-02 3 1  ON 54
ci_006                -2.086576e-02 3 1  ON 55
ci_007                -2.067433e-02 3 1  ON 56
ci_008                -5.061624e-03 3 1  ON 57
ci_009                -1.562701e-02 3 1  ON 58
ci_010                -1.049104e-02 3 1  ON 59
ci_011                -1.040259e-02 3 1  ON 60
ci_012                -1.050644e-02 3 1  ON 61
ci_013                -2.150585e-02 3 1  ON 62
ci_014                 1.373791e-02 3 1  ON 63
ci_015                 1.357325e-02 3 1  ON 64
ci_016                 1.685110e-02 3 1  ON 65
ci_017                 1.606514e-02 3 1  ON 66
ci_018                 1.115522e-02 3 1  ON 67
ci_019                 1.083172e-02 3 1  ON 68
ci_020                 1.815462e-02 3 1  ON 69
ci_021                 1.790671e-02 3 1  ON 70
ci_022                 1.041123e-02 3 1  ON 71
ci_023                 1.091179e-02 3 1  ON 72
ci_024                 7.124326e-03 3 1  ON 73
ci_025                 7.207156e-03 3 1  ON 74
ci_026                 1.196954e-02 3 1  ON 75
ci_027                 1.214489e-02 3 1  ON 76
ci_028                -1.010345e-02 3 1  ON 77
ci_029                -9.854755e-03 3 1  ON 78
ci_030                -4.816261e-03 3 1  ON 79
ci_031                -5.121629e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2838
    reference variance = 0.458063
====================================================
  Execution time = 3.7768e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0247e-01
  Total weights = 1.9737e+06
  Execution time = 3.1290e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293433089388
                                         uncertainty =       0.002267766103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293433089388
                                         uncertainty =       0.002267766103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383055865
  error estimate for blocks of size 2^( 2) =       0.000397813467
  error estimate for blocks of size 2^( 3) =       0.000411256597
  error estimate for blocks of size 2^( 4) =       0.000420700715
  error estimate for blocks of size 2^( 5) =       0.000426697352
  error estimate for blocks of size 2^( 6) =       0.000429202589
  error estimate for blocks of size 2^( 7) =       0.000431032589

      target function =      -0.908936213523
              le_mean =     -17.206679108416
             les_mean =     296.372279943910
             stat err =       0.000426908311
             autocorr =       1.242066893634
   target nu stat err =       0.000426908311
   target dn stat err =       0.003036830798
      target stat err =       0.004706477668
              std dev =       0.541722799940
             le_variance =       0.293463591975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293419706294
                                         uncertainty =       0.002266626978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293419706294
                                         uncertainty =       0.002266626978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383047120
  error estimate for blocks of size 2^( 2) =       0.000397811453
  error estimate for blocks of size 2^( 3) =       0.000411261694
  error estimate for blocks of size 2^( 4) =       0.000420711444
  error estimate for blocks of size 2^( 5) =       0.000426710706
  error estimate for blocks of size 2^( 6) =       0.000429217398
  error estimate for blocks of size 2^( 7) =       0.000431047189

      target function =      -0.908793476232
              le_mean =     -17.206679181995
             les_mean =     296.372375690187
             stat err =       0.000426921684
             autocorr =       1.242201429460
   target nu stat err =       0.000426921684
   target dn stat err =       0.003036802352
      target stat err =       0.004704977858
              std dev =       0.541710432454
             le_variance =       0.293450192630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293426225162
                                         uncertainty =       0.002267187853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293426225162
                                         uncertainty =       0.002267187853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383051380
  error estimate for blocks of size 2^( 2) =       0.000397812392
  error estimate for blocks of size 2^( 3) =       0.000411259125
  error estimate for blocks of size 2^( 4) =       0.000420706089
  error estimate for blocks of size 2^( 5) =       0.000426704059
  error estimate for blocks of size 2^( 6) =       0.000429210010
  error estimate for blocks of size 2^( 7) =       0.000431039921

      target function =      -0.908932950545
              le_mean =     -17.206679134023
             les_mean =     296.372282963097
             stat err =       0.000426915020
             autocorr =       1.242135019806
   target nu stat err =       0.000426915020
   target dn stat err =       0.003036091373
      target stat err =       0.004705326981
              std dev =       0.541716456724
             le_variance =       0.293456719486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293432221853
                                         uncertainty =       0.002267693468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293432221853
                                         uncertainty =       0.002267693468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383055298
  error estimate for blocks of size 2^( 2) =       0.000397813328
  error estimate for blocks of size 2^( 3) =       0.000411256909
  error estimate for blocks of size 2^( 4) =       0.000420701384
  error estimate for blocks of size 2^( 5) =       0.000426698188
  error estimate for blocks of size 2^( 6) =       0.000429203514
  error estimate for blocks of size 2^( 7) =       0.000431033503

      target function =      -0.908936123089
              le_mean =     -17.206679110713
             les_mean =     296.372280083014
             stat err =       0.000426909147
             autocorr =       1.242075434732
   target nu stat err =       0.000426909147
   target dn stat err =       0.003036732891
      target stat err =       0.004706328777
              std dev =       0.541721998266
             le_variance =       0.293462723405


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908936213523        initial  <--
     3.9062e+00     3.9062e+01             1.2062e-04        -0.908793476232
     1.5625e+01     1.5625e+02             2.9930e-05        -0.908932950545
     6.2500e+01     6.2500e+02             7.4861e-06        -0.908936123089

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.5030
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.087042e-01 1 1  ON 0
  uu_1                 5.166497e-02 1 1  ON 1
  uu_2                -3.940294e-02 1 1  ON 2
  uu_3                -9.291352e-02 1 1  ON 3
  uu_4                -1.239455e-01 1 1  ON 4
  uu_5                -1.319994e-01 1 1  ON 5
  uu_6                -1.137866e-01 1 1  ON 6
  uu_7                -5.392734e-02 1 1  ON 7
  uu_8                 7.180328e-02 1 1  ON 8
  uu_9                 1.240334e-01 1 1  ON 9
  ud_0                 3.081054e-01 1 1  ON 10
  ud_1                 7.810792e-02 1 1  ON 11
  ud_2                -2.402663e-02 1 1  ON 12
  ud_3                -7.733442e-02 1 1  ON 13
  ud_4                -1.141470e-01 1 1  ON 14
  ud_5                -1.343905e-01 1 1  ON 15
  ud_6                -1.304708e-01 1 1  ON 16
  ud_7                -8.982114e-02 1 1  ON 17
  ud_8                -4.427811e-03 1 1  ON 18
  ud_9                 8.809512e-02 1 1  ON 19
  eO_0                -7.053863e-01 1 1  ON 20
  eO_1                -4.211851e-01 1 1  ON 21
  eO_2                -4.127678e-02 1 1  ON 22
  eO_3                 1.870636e-01 1 1  ON 23
  eO_4                 2.613830e-01 1 1  ON 24
  eO_5                 2.856731e-01 1 1  ON 25
  eO_6                 2.498735e-01 1 1  ON 26
  eO_7                 1.252709e-01 1 1  ON 27
  eO_8                 2.849679e-02 1 1  ON 28
  eO_9                 1.896037e-02 1 1  ON 29
 eH1_0                -2.018795e-01 1 1  ON 30
 eH1_1                -9.762645e-02 1 1  ON 31
 eH1_2                -4.696043e-02 1 1  ON 32
 eH1_3                -1.560128e-02 1 1  ON 33
 eH1_4                 1.885101e-02 1 1  ON 34
 eH1_5                 2.621035e-02 1 1  ON 35
 eH1_6                 7.491324e-02 1 1  ON 36
 eH1_7                 1.041068e-01 1 1  ON 37
 eH1_8                 9.703528e-02 1 1  ON 38
 eH1_9                 2.520262e-02 1 1  ON 39
 eH2_0                -2.031271e-01 1 1  ON 40
 eH2_1                -9.994725e-02 1 1  ON 41
 eH2_2                -4.927461e-02 1 1  ON 42
 eH2_3                -1.791070e-02 1 1  ON 43
 eH2_4                 1.638219e-02 1 1  ON 44
 eH2_5                 2.331828e-02 1 1  ON 45
 eH2_6                 7.777369e-02 1 1  ON 46
 eH2_7                 1.127075e-01 1 1  ON 47
 eH2_8                 9.970833e-02 1 1  ON 48
 eH2_9                 2.792546e-02 1 1  ON 49
ci_001                -4.261740e-02 3 1  ON 50
ci_002                -3.174219e-02 3 1  ON 51
ci_003                -1.241365e-02 3 1  ON 52
ci_004                 2.578127e-02 3 1  ON 53
ci_005                 2.603805e-02 3 1  ON 54
ci_006                -2.086997e-02 3 1  ON 55
ci_007                -2.067603e-02 3 1  ON 56
ci_008                -5.064032e-03 3 1  ON 57
ci_009                -1.563246e-02 3 1  ON 58
ci_010                -1.049589e-02 3 1  ON 59
ci_011                -1.041016e-02 3 1  ON 60
ci_012                -1.050703e-02 3 1  ON 61
ci_013                -2.150596e-02 3 1  ON 62
ci_014                 1.374538e-02 3 1  ON 63
ci_015                 1.357548e-02 3 1  ON 64
ci_016                 1.685292e-02 3 1  ON 65
ci_017                 1.606457e-02 3 1  ON 66
ci_018                 1.116414e-02 3 1  ON 67
ci_019                 1.083117e-02 3 1  ON 68
ci_020                 1.815789e-02 3 1  ON 69
ci_021                 1.790899e-02 3 1  ON 70
ci_022                 1.040967e-02 3 1  ON 71
ci_023                 1.092525e-02 3 1  ON 72
ci_024                 7.124330e-03 3 1  ON 73
ci_025                 7.214766e-03 3 1  ON 74
ci_026                 1.196719e-02 3 1  ON 75
ci_027                 1.214419e-02 3 1  ON 76
ci_028                -1.010287e-02 3 1  ON 77
ci_029                -9.847612e-03 3 1  ON 78
ci_030                -4.813996e-03 3 1  ON 79
ci_031                -5.118016e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0278e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2395
    reference variance = 0.32025
====================================================
  Execution time = 3.7803e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5405e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9568e-01
  Total weights = 1.973859133e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0822e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288340665335
                                         uncertainty =       0.001546830731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288340665335
                                         uncertainty =       0.001546830731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379679640
  error estimate for blocks of size 2^( 2) =       0.000394568029
  error estimate for blocks of size 2^( 3) =       0.000408178050
  error estimate for blocks of size 2^( 4) =       0.000417510943
  error estimate for blocks of size 2^( 5) =       0.000423663456
  error estimate for blocks of size 2^( 6) =       0.000427902901
  error estimate for blocks of size 2^( 7) =       0.000430259128

      target function =      -0.919474488028
              le_mean =     -17.206576665455
             les_mean =     296.361962258732
             stat err =       0.000424834107
             autocorr =       1.251999435842
   target nu stat err =       0.000424834107
   target dn stat err =       0.001998951572
      target stat err =       0.003214922362
              std dev =       0.536948096924
             le_variance =       0.288313258791


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720657666546e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919484687961       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919485374797       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919485510918       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919485550346       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919485570851       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919485571829       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919485578672       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919485581769       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919485580553       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919485588275       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919485599283       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919485601413       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919485608606       residual = 8.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919485611887       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919485617858       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919485615433       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919485617506       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919485617514       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919485621022       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919485620518       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919485621457       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919485623211       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919485622756       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919485622279       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919485622993       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919485623233       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919485623890       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919485623283       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919485622738       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919485623363       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919485623366       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919485623423       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919485623135       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919485623117       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919485623061       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+01 is 8.339486e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919484687961       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919484859922       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919484893989       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919484903856       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919484908985       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919484909228       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919484910941       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919484911717       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919484911412       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919484913344       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919484916100       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919484916633       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919484918432       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919484919252       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919484920744       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919484920138       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919484920656       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919484920659       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919484921535       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919484921408       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919484921644       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919484922081       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919484921967       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919484921848       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919484922026       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919484922087       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919484922250       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919484922097       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919484921962       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919484922119       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919484922119       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919484922133       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919484922061       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919484922057       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919484922043       residual = 9.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+02 is 2.085425e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919484687961       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919484730967       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919484739486       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919484741953       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919484743236       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919484743297       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919484743725       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919484743919       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919484743842       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919484744326       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919484745013       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919484745148       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919484745598       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919484745804       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919484746176       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919484746023       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919484746154       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919484746156       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919484746374       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919484746342       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919484746402       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919484746508       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919484746481       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919484746453       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919484746496       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919484746509       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919484746551       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919484746515       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919484746480       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919484746518       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919484746517       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919484746523       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919484746505       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919484746504       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919484746500       residual = 9.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+02 is 5.213908e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.824700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8677e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.087044e-01 1 1  ON 0
  uu_1                 5.166465e-02 1 1  ON 1
  uu_2                -3.940296e-02 1 1  ON 2
  uu_3                -9.291324e-02 1 1  ON 3
  uu_4                -1.239451e-01 1 1  ON 4
  uu_5                -1.319991e-01 1 1  ON 5
  uu_6                -1.137866e-01 1 1  ON 6
  uu_7                -5.392704e-02 1 1  ON 7
  uu_8                 7.180119e-02 1 1  ON 8
  uu_9                 1.240334e-01 1 1  ON 9
  ud_0                 3.081049e-01 1 1  ON 10
  ud_1                 7.810751e-02 1 1  ON 11
  ud_2                -2.402714e-02 1 1  ON 12
  ud_3                -7.733506e-02 1 1  ON 13
  ud_4                -1.141473e-01 1 1  ON 14
  ud_5                -1.343903e-01 1 1  ON 15
  ud_6                -1.304695e-01 1 1  ON 16
  ud_7                -8.982041e-02 1 1  ON 17
  ud_8                -4.428042e-03 1 1  ON 18
  ud_9                 8.809479e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211847e-01 1 1  ON 21
  eO_2                -4.127679e-02 1 1  ON 22
  eO_3                 1.870633e-01 1 1  ON 23
  eO_4                 2.613823e-01 1 1  ON 24
  eO_5                 2.856715e-01 1 1  ON 25
  eO_6                 2.498737e-01 1 1  ON 26
  eO_7                 1.252721e-01 1 1  ON 27
  eO_8                 2.849709e-02 1 1  ON 28
  eO_9                 1.896054e-02 1 1  ON 29
 eH1_0                -2.018792e-01 1 1  ON 30
 eH1_1                -9.762594e-02 1 1  ON 31
 eH1_2                -4.695948e-02 1 1  ON 32
 eH1_3                -1.560076e-02 1 1  ON 33
 eH1_4                 1.885114e-02 1 1  ON 34
 eH1_5                 2.620903e-02 1 1  ON 35
 eH1_6                 7.491201e-02 1 1  ON 36
 eH1_7                 1.041059e-01 1 1  ON 37
 eH1_8                 9.703601e-02 1 1  ON 38
 eH1_9                 2.520277e-02 1 1  ON 39
 eH2_0                -2.031277e-01 1 1  ON 40
 eH2_1                -9.994667e-02 1 1  ON 41
 eH2_2                -4.927382e-02 1 1  ON 42
 eH2_3                -1.791026e-02 1 1  ON 43
 eH2_4                 1.638249e-02 1 1  ON 44
 eH2_5                 2.331701e-02 1 1  ON 45
 eH2_6                 7.777323e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.970893e-02 1 1  ON 48
 eH2_9                 2.792571e-02 1 1  ON 49
ci_001                -4.261676e-02 3 1  ON 50
ci_002                -3.174188e-02 3 1  ON 51
ci_003                -1.241344e-02 3 1  ON 52
ci_004                 2.578113e-02 3 1  ON 53
ci_005                 2.603803e-02 3 1  ON 54
ci_006                -2.086952e-02 3 1  ON 55
ci_007                -2.067547e-02 3 1  ON 56
ci_008                -5.063763e-03 3 1  ON 57
ci_009                -1.563161e-02 3 1  ON 58
ci_010                -1.049566e-02 3 1  ON 59
ci_011                -1.041040e-02 3 1  ON 60
ci_012                -1.050628e-02 3 1  ON 61
ci_013                -2.150539e-02 3 1  ON 62
ci_014                 1.374512e-02 3 1  ON 63
ci_015                 1.357538e-02 3 1  ON 64
ci_016                 1.685317e-02 3 1  ON 65
ci_017                 1.606439e-02 3 1  ON 66
ci_018                 1.116362e-02 3 1  ON 67
ci_019                 1.083065e-02 3 1  ON 68
ci_020                 1.815789e-02 3 1  ON 69
ci_021                 1.790852e-02 3 1  ON 70
ci_022                 1.040995e-02 3 1  ON 71
ci_023                 1.092462e-02 3 1  ON 72
ci_024                 7.124050e-03 3 1  ON 73
ci_025                 7.213876e-03 3 1  ON 74
ci_026                 1.196720e-02 3 1  ON 75
ci_027                 1.214433e-02 3 1  ON 76
ci_028                -1.010266e-02 3 1  ON 77
ci_029                -9.847541e-03 3 1  ON 78
ci_030                -4.814128e-03 3 1  ON 79
ci_031                -5.117500e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1758
    reference variance = 0.182661
====================================================
  Execution time = 3.7372e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0418e-01
  Total weights = 1.9738e+06
  Execution time = 3.1480e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291244048253
                                         uncertainty =       0.001783235717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291244048253
                                         uncertainty =       0.001783235717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381560984
  error estimate for blocks of size 2^( 2) =       0.000396619849
  error estimate for blocks of size 2^( 3) =       0.000410698767
  error estimate for blocks of size 2^( 4) =       0.000420365421
  error estimate for blocks of size 2^( 5) =       0.000426525494
  error estimate for blocks of size 2^( 6) =       0.000428294966
  error estimate for blocks of size 2^( 7) =       0.000430931045

      target function =      -0.906339406953
              le_mean =     -17.206269650810
             les_mean =     296.359890498896
             stat err =       0.000426529231
             autocorr =       1.249596156057
   target nu stat err =       0.000426529231
   target dn stat err =       0.003825179093
      target stat err =       0.005864732849
              std dev =       0.539608718054
             le_variance =       0.291177568600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291243372556
                                         uncertainty =       0.001783086145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291243372556
                                         uncertainty =       0.001783086145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381560538
  error estimate for blocks of size 2^( 2) =       0.000396619970
  error estimate for blocks of size 2^( 3) =       0.000410699486
  error estimate for blocks of size 2^( 4) =       0.000420366551
  error estimate for blocks of size 2^( 5) =       0.000426526763
  error estimate for blocks of size 2^( 6) =       0.000428296301
  error estimate for blocks of size 2^( 7) =       0.000430932351

      target function =      -0.906322215361
              le_mean =     -17.206269627624
             les_mean =     296.359900968944
             stat err =       0.000426530491
             autocorr =       1.249606459955
   target nu stat err =       0.000426530491
   target dn stat err =       0.003827624459
      target stat err =       0.005868205517
              std dev =       0.539608087481
             le_variance =       0.291176888075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291243709530
                                         uncertainty =       0.001783160806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291243709530
                                         uncertainty =       0.001783160806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381560760
  error estimate for blocks of size 2^( 2) =       0.000396619909
  error estimate for blocks of size 2^( 3) =       0.000410699127
  error estimate for blocks of size 2^( 4) =       0.000420365986
  error estimate for blocks of size 2^( 5) =       0.000426526129
  error estimate for blocks of size 2^( 6) =       0.000428295634
  error estimate for blocks of size 2^( 7) =       0.000430931698

      target function =      -0.906331313796
              le_mean =     -17.206269639167
             les_mean =     296.359895401824
             stat err =       0.000426529862
             autocorr =       1.249601314414
   target nu stat err =       0.000426529862
   target dn stat err =       0.003826400315
      target stat err =       0.005866473464
              std dev =       0.539608401954
             le_variance =       0.291177227459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291244005843
                                         uncertainty =       0.001783226347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291244005843
                                         uncertainty =       0.001783226347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381560956
  error estimate for blocks of size 2^( 2) =       0.000396619856
  error estimate for blocks of size 2^( 3) =       0.000410698812
  error estimate for blocks of size 2^( 4) =       0.000420365492
  error estimate for blocks of size 2^( 5) =       0.000426525573
  error estimate for blocks of size 2^( 6) =       0.000428295049
  error estimate for blocks of size 2^( 7) =       0.000430931126

      target function =      -0.906338439906
              le_mean =     -17.206269649350
             les_mean =     296.359891082295
             stat err =       0.000426529310
             autocorr =       1.249596801046
   target nu stat err =       0.000426529310
   target dn stat err =       0.003825331480
      target stat err =       0.005864950601
              std dev =       0.539608678477
             le_variance =       0.291177525888


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.906339406953        initial  <--
     3.9062e+01     3.9062e+02             8.3395e-06        -0.906322215361
     1.5625e+02     1.5625e+03             2.0854e-06        -0.906331313796
     6.2500e+02     6.2500e+03             5.2139e-07        -0.906338439906

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.2215
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.087042e-01 1 1  ON 0
  uu_1                 5.166497e-02 1 1  ON 1
  uu_2                -3.940294e-02 1 1  ON 2
  uu_3                -9.291352e-02 1 1  ON 3
  uu_4                -1.239455e-01 1 1  ON 4
  uu_5                -1.319994e-01 1 1  ON 5
  uu_6                -1.137866e-01 1 1  ON 6
  uu_7                -5.392734e-02 1 1  ON 7
  uu_8                 7.180328e-02 1 1  ON 8
  uu_9                 1.240334e-01 1 1  ON 9
  ud_0                 3.081054e-01 1 1  ON 10
  ud_1                 7.810792e-02 1 1  ON 11
  ud_2                -2.402663e-02 1 1  ON 12
  ud_3                -7.733442e-02 1 1  ON 13
  ud_4                -1.141470e-01 1 1  ON 14
  ud_5                -1.343905e-01 1 1  ON 15
  ud_6                -1.304708e-01 1 1  ON 16
  ud_7                -8.982114e-02 1 1  ON 17
  ud_8                -4.427811e-03 1 1  ON 18
  ud_9                 8.809512e-02 1 1  ON 19
  eO_0                -7.053863e-01 1 1  ON 20
  eO_1                -4.211851e-01 1 1  ON 21
  eO_2                -4.127678e-02 1 1  ON 22
  eO_3                 1.870636e-01 1 1  ON 23
  eO_4                 2.613830e-01 1 1  ON 24
  eO_5                 2.856731e-01 1 1  ON 25
  eO_6                 2.498735e-01 1 1  ON 26
  eO_7                 1.252709e-01 1 1  ON 27
  eO_8                 2.849679e-02 1 1  ON 28
  eO_9                 1.896037e-02 1 1  ON 29
 eH1_0                -2.018795e-01 1 1  ON 30
 eH1_1                -9.762645e-02 1 1  ON 31
 eH1_2                -4.696043e-02 1 1  ON 32
 eH1_3                -1.560128e-02 1 1  ON 33
 eH1_4                 1.885101e-02 1 1  ON 34
 eH1_5                 2.621035e-02 1 1  ON 35
 eH1_6                 7.491324e-02 1 1  ON 36
 eH1_7                 1.041068e-01 1 1  ON 37
 eH1_8                 9.703528e-02 1 1  ON 38
 eH1_9                 2.520262e-02 1 1  ON 39
 eH2_0                -2.031271e-01 1 1  ON 40
 eH2_1                -9.994725e-02 1 1  ON 41
 eH2_2                -4.927461e-02 1 1  ON 42
 eH2_3                -1.791070e-02 1 1  ON 43
 eH2_4                 1.638219e-02 1 1  ON 44
 eH2_5                 2.331828e-02 1 1  ON 45
 eH2_6                 7.777369e-02 1 1  ON 46
 eH2_7                 1.127075e-01 1 1  ON 47
 eH2_8                 9.970833e-02 1 1  ON 48
 eH2_9                 2.792546e-02 1 1  ON 49
ci_001                -4.261740e-02 3 1  ON 50
ci_002                -3.174219e-02 3 1  ON 51
ci_003                -1.241365e-02 3 1  ON 52
ci_004                 2.578127e-02 3 1  ON 53
ci_005                 2.603805e-02 3 1  ON 54
ci_006                -2.086997e-02 3 1  ON 55
ci_007                -2.067603e-02 3 1  ON 56
ci_008                -5.064032e-03 3 1  ON 57
ci_009                -1.563246e-02 3 1  ON 58
ci_010                -1.049589e-02 3 1  ON 59
ci_011                -1.041016e-02 3 1  ON 60
ci_012                -1.050703e-02 3 1  ON 61
ci_013                -2.150596e-02 3 1  ON 62
ci_014                 1.374538e-02 3 1  ON 63
ci_015                 1.357548e-02 3 1  ON 64
ci_016                 1.685292e-02 3 1  ON 65
ci_017                 1.606457e-02 3 1  ON 66
ci_018                 1.116414e-02 3 1  ON 67
ci_019                 1.083117e-02 3 1  ON 68
ci_020                 1.815789e-02 3 1  ON 69
ci_021                 1.790899e-02 3 1  ON 70
ci_022                 1.040967e-02 3 1  ON 71
ci_023                 1.092525e-02 3 1  ON 72
ci_024                 7.124330e-03 3 1  ON 73
ci_025                 7.214766e-03 3 1  ON 74
ci_026                 1.196719e-02 3 1  ON 75
ci_027                 1.214419e-02 3 1  ON 76
ci_028                -1.010287e-02 3 1  ON 77
ci_029                -9.847612e-03 3 1  ON 78
ci_030                -4.813996e-03 3 1  ON 79
ci_031                -5.118016e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0190e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2239
    reference variance = 0.41395
====================================================
  Execution time = 3.8354e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5410e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9928e-01
  Total weights = 1.973596838e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0852e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290796922472
                                         uncertainty =       0.002121522921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290796922472
                                         uncertainty =       0.002121522921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381360119
  error estimate for blocks of size 2^( 2) =       0.000396316092
  error estimate for blocks of size 2^( 3) =       0.000410250709
  error estimate for blocks of size 2^( 4) =       0.000420459296
  error estimate for blocks of size 2^( 5) =       0.000427470828
  error estimate for blocks of size 2^( 6) =       0.000432170079
  error estimate for blocks of size 2^( 7) =       0.000434968922

      target function =      -0.913853508640
              le_mean =     -17.206691568874
             les_mean =     296.369514072599
             stat err =       0.000428767281
             autocorr =       1.264074662091
   target nu stat err =       0.000428767281
   target dn stat err =       0.003128453497
      target stat err =       0.004897780707
              std dev =       0.539324652437
             le_variance =       0.290871080726


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720669156887e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913878835580       residual = 6.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913878905207       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913878922666       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913878927936       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913878928984       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913878930401       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913878931524       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913878933273       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913878934208       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913878934757       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913878935511       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913878937007       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913878937825       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913878938139       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913878938457       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913878938279       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913878938401       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913878939887       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913878939969       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913878940221       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913878940005       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913878939858       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913878939910       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913878940088       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913878940267       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913878940181       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913878940202       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913878940158       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913878940153       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913878940205       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913878940182       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913878940202       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913878940211       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913878940182       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913878940146       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913878940139       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913878940180       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+02 is 1.673089e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913878835580       residual = 6.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913878852989       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913878857354       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913878858672       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913878858936       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913878859292       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913878859569       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913878860004       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913878860237       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913878860380       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913878860565       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913878860945       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913878861145       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913878861226       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913878861300       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913878861261       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913878861284       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913878861664       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913878861679       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913878861740       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913878861690       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913878861650       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913878861662       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913878861709       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913878861759       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913878861732       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913878861741       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913878861727       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913878861726       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913878861746       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913878861737       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913878861732       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913878861736       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913878861732       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913878861730       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913878861724       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913878861729       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+03 is 4.182799e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913878835580       residual = 6.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913878839932       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913878841024       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913878841350       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913878841421       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913878841514       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913878841587       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913878841685       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913878841746       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913878841782       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913878841840       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913878841924       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913878841943       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913878841981       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913878842012       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913878841999       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913878842003       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913878842105       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913878842114       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913878842115       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913878842144       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913878842088       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913878842092       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913878842099       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913878842137       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913878842113       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913878842121       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913878842113       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913878842089       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913878842101       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913878842081       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913878842138       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913878842108       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913878842119       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913878842116       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913878842114       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913878842132       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+03 is 1.045705e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.877748 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9266e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.087043e-01 1 1  ON 0
  uu_1                 5.166507e-02 1 1  ON 1
  uu_2                -3.940283e-02 1 1  ON 2
  uu_3                -9.291344e-02 1 1  ON 3
  uu_4                -1.239454e-01 1 1  ON 4
  uu_5                -1.319994e-01 1 1  ON 5
  uu_6                -1.137866e-01 1 1  ON 6
  uu_7                -5.392749e-02 1 1  ON 7
  uu_8                 7.180286e-02 1 1  ON 8
  uu_9                 1.240334e-01 1 1  ON 9
  ud_0                 3.081052e-01 1 1  ON 10
  ud_1                 7.810781e-02 1 1  ON 11
  ud_2                -2.402671e-02 1 1  ON 12
  ud_3                -7.733447e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343904e-01 1 1  ON 15
  ud_6                -1.304706e-01 1 1  ON 16
  ud_7                -8.982100e-02 1 1  ON 17
  ud_8                -4.427925e-03 1 1  ON 18
  ud_9                 8.809507e-02 1 1  ON 19
  eO_0                -7.053862e-01 1 1  ON 20
  eO_1                -4.211851e-01 1 1  ON 21
  eO_2                -4.127681e-02 1 1  ON 22
  eO_3                 1.870635e-01 1 1  ON 23
  eO_4                 2.613830e-01 1 1  ON 24
  eO_5                 2.856730e-01 1 1  ON 25
  eO_6                 2.498735e-01 1 1  ON 26
  eO_7                 1.252710e-01 1 1  ON 27
  eO_8                 2.849679e-02 1 1  ON 28
  eO_9                 1.896038e-02 1 1  ON 29
 eH1_0                -2.018796e-01 1 1  ON 30
 eH1_1                -9.762645e-02 1 1  ON 31
 eH1_2                -4.696043e-02 1 1  ON 32
 eH1_3                -1.560126e-02 1 1  ON 33
 eH1_4                 1.885097e-02 1 1  ON 34
 eH1_5                 2.621037e-02 1 1  ON 35
 eH1_6                 7.491333e-02 1 1  ON 36
 eH1_7                 1.041067e-01 1 1  ON 37
 eH1_8                 9.703535e-02 1 1  ON 38
 eH1_9                 2.520265e-02 1 1  ON 39
 eH2_0                -2.031271e-01 1 1  ON 40
 eH2_1                -9.994709e-02 1 1  ON 41
 eH2_2                -4.927442e-02 1 1  ON 42
 eH2_3                -1.791063e-02 1 1  ON 43
 eH2_4                 1.638219e-02 1 1  ON 44
 eH2_5                 2.331810e-02 1 1  ON 45
 eH2_6                 7.777345e-02 1 1  ON 46
 eH2_7                 1.127074e-01 1 1  ON 47
 eH2_8                 9.970841e-02 1 1  ON 48
 eH2_9                 2.792546e-02 1 1  ON 49
ci_001                -4.261734e-02 3 1  ON 50
ci_002                -3.174213e-02 3 1  ON 51
ci_003                -1.241355e-02 3 1  ON 52
ci_004                 2.578131e-02 3 1  ON 53
ci_005                 2.603806e-02 3 1  ON 54
ci_006                -2.086995e-02 3 1  ON 55
ci_007                -2.067599e-02 3 1  ON 56
ci_008                -5.063998e-03 3 1  ON 57
ci_009                -1.563241e-02 3 1  ON 58
ci_010                -1.049583e-02 3 1  ON 59
ci_011                -1.041011e-02 3 1  ON 60
ci_012                -1.050700e-02 3 1  ON 61
ci_013                -2.150597e-02 3 1  ON 62
ci_014                 1.374538e-02 3 1  ON 63
ci_015                 1.357545e-02 3 1  ON 64
ci_016                 1.685291e-02 3 1  ON 65
ci_017                 1.606461e-02 3 1  ON 66
ci_018                 1.116418e-02 3 1  ON 67
ci_019                 1.083113e-02 3 1  ON 68
ci_020                 1.815792e-02 3 1  ON 69
ci_021                 1.790900e-02 3 1  ON 70
ci_022                 1.040970e-02 3 1  ON 71
ci_023                 1.092520e-02 3 1  ON 72
ci_024                 7.124290e-03 3 1  ON 73
ci_025                 7.214765e-03 3 1  ON 74
ci_026                 1.196721e-02 3 1  ON 75
ci_027                 1.214412e-02 3 1  ON 76
ci_028                -1.010292e-02 3 1  ON 77
ci_029                -9.847626e-03 3 1  ON 78
ci_030                -4.814005e-03 3 1  ON 79
ci_031                -5.117968e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1796
    reference variance = 0.334994
====================================================
  Execution time = 3.8474e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9883e-01
  Total weights = 1.9739e+06
  Execution time = 3.1374e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291098404934
                                         uncertainty =       0.003029227311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291098404934
                                         uncertainty =       0.003029227311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381454640
  error estimate for blocks of size 2^( 2) =       0.000396092696
  error estimate for blocks of size 2^( 3) =       0.000409872277
  error estimate for blocks of size 2^( 4) =       0.000419225542
  error estimate for blocks of size 2^( 5) =       0.000424616617
  error estimate for blocks of size 2^( 6) =       0.000426610470
  error estimate for blocks of size 2^( 7) =       0.000428414061

      target function =      -0.914553309389
              le_mean =     -17.206354419991
             les_mean =     296.357460430842
             stat err =       0.000424716673
             autocorr =       1.239689192443
   target nu stat err =       0.000424716673
   target dn stat err =       0.003540014816
      target stat err =       0.005532822834
              std dev =       0.539458325748
             le_variance =       0.291015285219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291098277464
                                         uncertainty =       0.003029210139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291098277464
                                         uncertainty =       0.003029210139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381454557
  error estimate for blocks of size 2^( 2) =       0.000396092677
  error estimate for blocks of size 2^( 3) =       0.000409872318
  error estimate for blocks of size 2^( 4) =       0.000419225632
  error estimate for blocks of size 2^( 5) =       0.000424616742
  error estimate for blocks of size 2^( 6) =       0.000426610607
  error estimate for blocks of size 2^( 7) =       0.000428414202

      target function =      -0.914556156611
              le_mean =     -17.206354414164
             les_mean =     296.357458395450
             stat err =       0.000424716796
             autocorr =       1.239690453433
   target nu stat err =       0.000424716796
   target dn stat err =       0.003539806384
      target stat err =       0.005532536681
              std dev =       0.539458207855
             le_variance =       0.291015158023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291098341185
                                         uncertainty =       0.003029218724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291098341185
                                         uncertainty =       0.003029218724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381454599
  error estimate for blocks of size 2^( 2) =       0.000396092687
  error estimate for blocks of size 2^( 3) =       0.000409872298
  error estimate for blocks of size 2^( 4) =       0.000419225587
  error estimate for blocks of size 2^( 5) =       0.000424616679
  error estimate for blocks of size 2^( 6) =       0.000426610539
  error estimate for blocks of size 2^( 7) =       0.000428414132

      target function =      -0.914554735300
              le_mean =     -17.206354417076
             les_mean =     296.357459411633
             stat err =       0.000424716734
             autocorr =       1.239689823027
   target nu stat err =       0.000424716734
   target dn stat err =       0.003539910364
      target stat err =       0.005532679423
              std dev =       0.539458266789
             le_variance =       0.291015221607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291098396964
                                         uncertainty =       0.003029226238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291098396964
                                         uncertainty =       0.003029226238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381454635
  error estimate for blocks of size 2^( 2) =       0.000396092695
  error estimate for blocks of size 2^( 3) =       0.000409872279
  error estimate for blocks of size 2^( 4) =       0.000419225548
  error estimate for blocks of size 2^( 5) =       0.000424616625
  error estimate for blocks of size 2^( 6) =       0.000426610479
  error estimate for blocks of size 2^( 7) =       0.000428414070

      target function =      -0.914553487864
              le_mean =     -17.206354419626
             les_mean =     296.357460303287
             stat err =       0.000424716680
             autocorr =       1.239689271283
   target nu stat err =       0.000424716680
   target dn stat err =       0.003540001735
      target stat err =       0.005532804872
              std dev =       0.539458318377
             le_variance =       0.291015277266


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914553309389        initial
     3.9062e+02     3.9062e+03             1.6731e-06        -0.914556156611  <--
     1.5625e+03     1.5625e+04             4.1828e-07        -0.914554735300
     6.2500e+03     6.2500e+04             1.0457e-07        -0.914553487864

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 5.4252e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.087044e-01 1 1  ON 0
  uu_1                 5.166539e-02 1 1  ON 1
  uu_2                -3.940249e-02 1 1  ON 2
  uu_3                -9.291321e-02 1 1  ON 3
  uu_4                -1.239453e-01 1 1  ON 4
  uu_5                -1.319993e-01 1 1  ON 5
  uu_6                -1.137865e-01 1 1  ON 6
  uu_7                -5.392794e-02 1 1  ON 7
  uu_8                 7.180160e-02 1 1  ON 8
  uu_9                 1.240334e-01 1 1  ON 9
  ud_0                 3.081048e-01 1 1  ON 10
  ud_1                 7.810746e-02 1 1  ON 11
  ud_2                -2.402698e-02 1 1  ON 12
  ud_3                -7.733464e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343900e-01 1 1  ON 15
  ud_6                -1.304701e-01 1 1  ON 16
  ud_7                -8.982059e-02 1 1  ON 17
  ud_8                -4.428269e-03 1 1  ON 18
  ud_9                 8.809492e-02 1 1  ON 19
  eO_0                -7.053860e-01 1 1  ON 20
  eO_1                -4.211850e-01 1 1  ON 21
  eO_2                -4.127691e-02 1 1  ON 22
  eO_3                 1.870631e-01 1 1  ON 23
  eO_4                 2.613829e-01 1 1  ON 24
  eO_5                 2.856729e-01 1 1  ON 25
  eO_6                 2.498734e-01 1 1  ON 26
  eO_7                 1.252715e-01 1 1  ON 27
  eO_8                 2.849681e-02 1 1  ON 28
  eO_9                 1.896041e-02 1 1  ON 29
 eH1_0                -2.018799e-01 1 1  ON 30
 eH1_1                -9.762646e-02 1 1  ON 31
 eH1_2                -4.696041e-02 1 1  ON 32
 eH1_3                -1.560121e-02 1 1  ON 33
 eH1_4                 1.885085e-02 1 1  ON 34
 eH1_5                 2.621041e-02 1 1  ON 35
 eH1_6                 7.491361e-02 1 1  ON 36
 eH1_7                 1.041064e-01 1 1  ON 37
 eH1_8                 9.703555e-02 1 1  ON 38
 eH1_9                 2.520271e-02 1 1  ON 39
 eH2_0                -2.031271e-01 1 1  ON 40
 eH2_1                -9.994661e-02 1 1  ON 41
 eH2_2                -4.927386e-02 1 1  ON 42
 eH2_3                -1.791042e-02 1 1  ON 43
 eH2_4                 1.638219e-02 1 1  ON 44
 eH2_5                 2.331757e-02 1 1  ON 45
 eH2_6                 7.777270e-02 1 1  ON 46
 eH2_7                 1.127072e-01 1 1  ON 47
 eH2_8                 9.970864e-02 1 1  ON 48
 eH2_9                 2.792546e-02 1 1  ON 49
ci_001                -4.261715e-02 3 1  ON 50
ci_002                -3.174197e-02 3 1  ON 51
ci_003                -1.241327e-02 3 1  ON 52
ci_004                 2.578144e-02 3 1  ON 53
ci_005                 2.603806e-02 3 1  ON 54
ci_006                -2.086989e-02 3 1  ON 55
ci_007                -2.067588e-02 3 1  ON 56
ci_008                -5.063895e-03 3 1  ON 57
ci_009                -1.563229e-02 3 1  ON 58
ci_010                -1.049565e-02 3 1  ON 59
ci_011                -1.040999e-02 3 1  ON 60
ci_012                -1.050690e-02 3 1  ON 61
ci_013                -2.150601e-02 3 1  ON 62
ci_014                 1.374539e-02 3 1  ON 63
ci_015                 1.357537e-02 3 1  ON 64
ci_016                 1.685289e-02 3 1  ON 65
ci_017                 1.606475e-02 3 1  ON 66
ci_018                 1.116430e-02 3 1  ON 67
ci_019                 1.083103e-02 3 1  ON 68
ci_020                 1.815802e-02 3 1  ON 69
ci_021                 1.790904e-02 3 1  ON 70
ci_022                 1.040978e-02 3 1  ON 71
ci_023                 1.092507e-02 3 1  ON 72
ci_024                 7.124170e-03 3 1  ON 73
ci_025                 7.214763e-03 3 1  ON 74
ci_026                 1.196727e-02 3 1  ON 75
ci_027                 1.214391e-02 3 1  ON 76
ci_028                -1.010304e-02 3 1  ON 77
ci_029                -9.847668e-03 3 1  ON 78
ci_030                -4.814033e-03 3 1  ON 79
ci_031                -5.117827e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0352e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.3171
    reference variance = 1.27895
====================================================
  Execution time = 3.8096e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5394e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0211e-01
  Total weights = 1.973688997e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0733e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293139600910
                                         uncertainty =       0.002247233730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293139600910
                                         uncertainty =       0.002247233730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382902842
  error estimate for blocks of size 2^( 2) =       0.000397784887
  error estimate for blocks of size 2^( 3) =       0.000411472361
  error estimate for blocks of size 2^( 4) =       0.000420927263
  error estimate for blocks of size 2^( 5) =       0.000427737676
  error estimate for blocks of size 2^( 6) =       0.000432638622
  error estimate for blocks of size 2^( 7) =       0.000434172661

      target function =      -0.909474987000
              le_mean =     -17.207172703355
             les_mean =     296.388906546577
             stat err =       0.000428869056
             autocorr =       1.254504555108
   target nu stat err =       0.000428869056
   target dn stat err =       0.002826003266
      target stat err =       0.004397332176
              std dev =       0.541506392747
             le_variance =       0.293229173386


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720717270335e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909495150342       residual = 8.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909495533879       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909495587481       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909495608964       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909495613723       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909495616971       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909495619250       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909495622177       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909495626882       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909495628672       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909495631877       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909495632092       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909495635017       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909495638547       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909495640684       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.909495642851       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909495643057       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909495642091       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909495642870       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909495642921       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909495642910       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909495643808       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909495643177       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909495643368       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909495643467       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909495643577       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909495644016       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909495644273       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909495644459       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909495644541       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909495644600       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909495644560       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909495644481       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909495644481       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909495644490       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909495644423       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909495644436       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e+01 is 4.919690e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909495150342       residual = 8.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909495246282       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909495259688       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909495265061       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909495266252       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909495267063       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909495267633       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909495268365       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909495269542       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909495269991       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909495270792       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909495270845       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909495271576       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909495272460       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909495272994       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.909495273534       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909495273586       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909495273345       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909495273540       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909495273551       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909495273549       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909495273772       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909495273617       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909495273664       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909495273688       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909495273717       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909495273826       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909495273891       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909495273936       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909495273958       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909495273971       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909495273958       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909495273941       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909495273942       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909495273945       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909495273928       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909495273932       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+02 is 1.230026e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909495150342       residual = 8.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909495174330       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909495177682       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909495179026       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909495179324       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909495179526       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909495179671       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909495179850       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909495180145       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909495180257       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909495180458       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909495180473       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909495180654       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909495180877       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909495181010       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.909495181143       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909495181162       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909495181098       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909495181146       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909495181146       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909495181151       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909495181206       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909495181167       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909495181175       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909495181180       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909495181186       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909495181214       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909495181235       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909495181243       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909495181244       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909495181250       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909495181250       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909495181251       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909495181244       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909495181249       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909495181237       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909495181242       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+03 is 3.075130e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.930565 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8889e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.087046e-01 1 1  ON 0
  uu_1                 5.166550e-02 1 1  ON 1
  uu_2                -3.940247e-02 1 1  ON 2
  uu_3                -9.291316e-02 1 1  ON 3
  uu_4                -1.239452e-01 1 1  ON 4
  uu_5                -1.319992e-01 1 1  ON 5
  uu_6                -1.137864e-01 1 1  ON 6
  uu_7                -5.392802e-02 1 1  ON 7
  uu_8                 7.180037e-02 1 1  ON 8
  uu_9                 1.240335e-01 1 1  ON 9
  ud_0                 3.081044e-01 1 1  ON 10
  ud_1                 7.810720e-02 1 1  ON 11
  ud_2                -2.402727e-02 1 1  ON 12
  ud_3                -7.733486e-02 1 1  ON 13
  ud_4                -1.141470e-01 1 1  ON 14
  ud_5                -1.343899e-01 1 1  ON 15
  ud_6                -1.304693e-01 1 1  ON 16
  ud_7                -8.982000e-02 1 1  ON 17
  ud_8                -4.428549e-03 1 1  ON 18
  ud_9                 8.809478e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211849e-01 1 1  ON 21
  eO_2                -4.127695e-02 1 1  ON 22
  eO_3                 1.870630e-01 1 1  ON 23
  eO_4                 2.613824e-01 1 1  ON 24
  eO_5                 2.856722e-01 1 1  ON 25
  eO_6                 2.498737e-01 1 1  ON 26
  eO_7                 1.252720e-01 1 1  ON 27
  eO_8                 2.849688e-02 1 1  ON 28
  eO_9                 1.896046e-02 1 1  ON 29
 eH1_0                -2.018799e-01 1 1  ON 30
 eH1_1                -9.762654e-02 1 1  ON 31
 eH1_2                -4.696036e-02 1 1  ON 32
 eH1_3                -1.560131e-02 1 1  ON 33
 eH1_4                 1.885069e-02 1 1  ON 34
 eH1_5                 2.620975e-02 1 1  ON 35
 eH1_6                 7.491402e-02 1 1  ON 36
 eH1_7                 1.041065e-01 1 1  ON 37
 eH1_8                 9.703587e-02 1 1  ON 38
 eH1_9                 2.520283e-02 1 1  ON 39
 eH2_0                -2.031268e-01 1 1  ON 40
 eH2_1                -9.994640e-02 1 1  ON 41
 eH2_2                -4.927354e-02 1 1  ON 42
 eH2_3                -1.791019e-02 1 1  ON 43
 eH2_4                 1.638218e-02 1 1  ON 44
 eH2_5                 2.331700e-02 1 1  ON 45
 eH2_6                 7.777225e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.970887e-02 1 1  ON 48
 eH2_9                 2.792550e-02 1 1  ON 49
ci_001                -4.261696e-02 3 1  ON 50
ci_002                -3.174167e-02 3 1  ON 51
ci_003                -1.241289e-02 3 1  ON 52
ci_004                 2.578140e-02 3 1  ON 53
ci_005                 2.603808e-02 3 1  ON 54
ci_006                -2.086989e-02 3 1  ON 55
ci_007                -2.067577e-02 3 1  ON 56
ci_008                -5.063783e-03 3 1  ON 57
ci_009                -1.563208e-02 3 1  ON 58
ci_010                -1.049552e-02 3 1  ON 59
ci_011                -1.040965e-02 3 1  ON 60
ci_012                -1.050671e-02 3 1  ON 61
ci_013                -2.150611e-02 3 1  ON 62
ci_014                 1.374545e-02 3 1  ON 63
ci_015                 1.357512e-02 3 1  ON 64
ci_016                 1.685253e-02 3 1  ON 65
ci_017                 1.606454e-02 3 1  ON 66
ci_018                 1.116409e-02 3 1  ON 67
ci_019                 1.083082e-02 3 1  ON 68
ci_020                 1.815816e-02 3 1  ON 69
ci_021                 1.790929e-02 3 1  ON 70
ci_022                 1.040982e-02 3 1  ON 71
ci_023                 1.092477e-02 3 1  ON 72
ci_024                 7.124106e-03 3 1  ON 73
ci_025                 7.214629e-03 3 1  ON 74
ci_026                 1.196735e-02 3 1  ON 75
ci_027                 1.214374e-02 3 1  ON 76
ci_028                -1.010288e-02 3 1  ON 77
ci_029                -9.847688e-03 3 1  ON 78
ci_030                -4.813975e-03 3 1  ON 79
ci_031                -5.117640e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1788
    reference variance = 0.1527
====================================================
  Execution time = 3.7532e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9826e-01
  Total weights = 1.9740e+06
  Execution time = 3.1504e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290745813956
                                         uncertainty =       0.001824037909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290745813956
                                         uncertainty =       0.001824037909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381271179
  error estimate for blocks of size 2^( 2) =       0.000396178901
  error estimate for blocks of size 2^( 3) =       0.000409475177
  error estimate for blocks of size 2^( 4) =       0.000419425036
  error estimate for blocks of size 2^( 5) =       0.000426531342
  error estimate for blocks of size 2^( 6) =       0.000429502914
  error estimate for blocks of size 2^( 7) =       0.000432017191

      target function =      -0.915435801557
              le_mean =     -17.207094382105
             les_mean =     296.382355067865
             stat err =       0.000426869121
             autocorr =       1.253491876415
   target nu stat err =       0.000426869121
   target dn stat err =       0.002679141418
      target stat err =       0.004228043076
              std dev =       0.539198872663
             le_variance =       0.290735424281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290745517461
                                         uncertainty =       0.001823984697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290745517461
                                         uncertainty =       0.001823984697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381270985
  error estimate for blocks of size 2^( 2) =       0.000396178993
  error estimate for blocks of size 2^( 3) =       0.000409475534
  error estimate for blocks of size 2^( 4) =       0.000419425611
  error estimate for blocks of size 2^( 5) =       0.000426532053
  error estimate for blocks of size 2^( 6) =       0.000429503725
  error estimate for blocks of size 2^( 7) =       0.000432018064

      target function =      -0.915435095919
              le_mean =     -17.207094379080
             les_mean =     296.382355417876
             stat err =       0.000426869863
             autocorr =       1.253497512744
   target nu stat err =       0.000426869863
   target dn stat err =       0.002679119619
      target stat err =       0.004228003456
              std dev =       0.539198598195
             le_variance =       0.290735128295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290745665540
                                         uncertainty =       0.001824011285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290745665540
                                         uncertainty =       0.001824011285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381271082
  error estimate for blocks of size 2^( 2) =       0.000396178947
  error estimate for blocks of size 2^( 3) =       0.000409475355
  error estimate for blocks of size 2^( 4) =       0.000419425323
  error estimate for blocks of size 2^( 5) =       0.000426531698
  error estimate for blocks of size 2^( 6) =       0.000429503320
  error estimate for blocks of size 2^( 7) =       0.000432017628

      target function =      -0.915435456528
              le_mean =     -17.207094380580
             les_mean =     296.382355237439
             stat err =       0.000426869492
             autocorr =       1.253494696031
   target nu stat err =       0.000426869492
   target dn stat err =       0.002679130422
      target stat err =       0.004228023189
              std dev =       0.539198735273
             le_variance =       0.290735276120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290745795392
                                         uncertainty =       0.001824034581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290745795392
                                         uncertainty =       0.001824034581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381271167
  error estimate for blocks of size 2^( 2) =       0.000396178907
  error estimate for blocks of size 2^( 3) =       0.000409475199
  error estimate for blocks of size 2^( 4) =       0.000419425072
  error estimate for blocks of size 2^( 5) =       0.000426531387
  error estimate for blocks of size 2^( 6) =       0.000429502965
  error estimate for blocks of size 2^( 7) =       0.000432017246

      target function =      -0.915435759300
              le_mean =     -17.207094381913
             les_mean =     296.382355088457
             stat err =       0.000426869167
             autocorr =       1.253492228913
   target nu stat err =       0.000426869167
   target dn stat err =       0.002679140033
      target stat err =       0.004228040583
              std dev =       0.539198855478
             le_variance =       0.290735405748


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915435801557        initial  <--
     9.7656e+01     9.7656e+02             4.9197e-06        -0.915435095919
     3.9062e+02     3.9062e+03             1.2300e-06        -0.915435456528
     1.5625e+03     1.5625e+04             3.0751e-07        -0.915435759300

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.3770
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.087044e-01 1 1  ON 0
  uu_1                 5.166539e-02 1 1  ON 1
  uu_2                -3.940249e-02 1 1  ON 2
  uu_3                -9.291321e-02 1 1  ON 3
  uu_4                -1.239453e-01 1 1  ON 4
  uu_5                -1.319993e-01 1 1  ON 5
  uu_6                -1.137865e-01 1 1  ON 6
  uu_7                -5.392794e-02 1 1  ON 7
  uu_8                 7.180160e-02 1 1  ON 8
  uu_9                 1.240334e-01 1 1  ON 9
  ud_0                 3.081048e-01 1 1  ON 10
  ud_1                 7.810746e-02 1 1  ON 11
  ud_2                -2.402698e-02 1 1  ON 12
  ud_3                -7.733464e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343900e-01 1 1  ON 15
  ud_6                -1.304701e-01 1 1  ON 16
  ud_7                -8.982059e-02 1 1  ON 17
  ud_8                -4.428269e-03 1 1  ON 18
  ud_9                 8.809492e-02 1 1  ON 19
  eO_0                -7.053860e-01 1 1  ON 20
  eO_1                -4.211850e-01 1 1  ON 21
  eO_2                -4.127691e-02 1 1  ON 22
  eO_3                 1.870631e-01 1 1  ON 23
  eO_4                 2.613829e-01 1 1  ON 24
  eO_5                 2.856729e-01 1 1  ON 25
  eO_6                 2.498734e-01 1 1  ON 26
  eO_7                 1.252715e-01 1 1  ON 27
  eO_8                 2.849681e-02 1 1  ON 28
  eO_9                 1.896041e-02 1 1  ON 29
 eH1_0                -2.018799e-01 1 1  ON 30
 eH1_1                -9.762646e-02 1 1  ON 31
 eH1_2                -4.696041e-02 1 1  ON 32
 eH1_3                -1.560121e-02 1 1  ON 33
 eH1_4                 1.885085e-02 1 1  ON 34
 eH1_5                 2.621041e-02 1 1  ON 35
 eH1_6                 7.491361e-02 1 1  ON 36
 eH1_7                 1.041064e-01 1 1  ON 37
 eH1_8                 9.703555e-02 1 1  ON 38
 eH1_9                 2.520271e-02 1 1  ON 39
 eH2_0                -2.031271e-01 1 1  ON 40
 eH2_1                -9.994661e-02 1 1  ON 41
 eH2_2                -4.927386e-02 1 1  ON 42
 eH2_3                -1.791042e-02 1 1  ON 43
 eH2_4                 1.638219e-02 1 1  ON 44
 eH2_5                 2.331757e-02 1 1  ON 45
 eH2_6                 7.777270e-02 1 1  ON 46
 eH2_7                 1.127072e-01 1 1  ON 47
 eH2_8                 9.970864e-02 1 1  ON 48
 eH2_9                 2.792546e-02 1 1  ON 49
ci_001                -4.261715e-02 3 1  ON 50
ci_002                -3.174197e-02 3 1  ON 51
ci_003                -1.241327e-02 3 1  ON 52
ci_004                 2.578144e-02 3 1  ON 53
ci_005                 2.603806e-02 3 1  ON 54
ci_006                -2.086989e-02 3 1  ON 55
ci_007                -2.067588e-02 3 1  ON 56
ci_008                -5.063895e-03 3 1  ON 57
ci_009                -1.563229e-02 3 1  ON 58
ci_010                -1.049565e-02 3 1  ON 59
ci_011                -1.040999e-02 3 1  ON 60
ci_012                -1.050690e-02 3 1  ON 61
ci_013                -2.150601e-02 3 1  ON 62
ci_014                 1.374539e-02 3 1  ON 63
ci_015                 1.357537e-02 3 1  ON 64
ci_016                 1.685289e-02 3 1  ON 65
ci_017                 1.606475e-02 3 1  ON 66
ci_018                 1.116430e-02 3 1  ON 67
ci_019                 1.083103e-02 3 1  ON 68
ci_020                 1.815802e-02 3 1  ON 69
ci_021                 1.790904e-02 3 1  ON 70
ci_022                 1.040978e-02 3 1  ON 71
ci_023                 1.092507e-02 3 1  ON 72
ci_024                 7.124170e-03 3 1  ON 73
ci_025                 7.214763e-03 3 1  ON 74
ci_026                 1.196727e-02 3 1  ON 75
ci_027                 1.214391e-02 3 1  ON 76
ci_028                -1.010304e-02 3 1  ON 77
ci_029                -9.847668e-03 3 1  ON 78
ci_030                -4.814033e-03 3 1  ON 79
ci_031                -5.117827e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0227e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2192
    reference variance = 0.410388
====================================================
  Execution time = 3.7920e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5442e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 3.0063e-01
  Total weights = 1.973687762e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0967e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292347804371
                                         uncertainty =       0.002048654993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292347804371
                                         uncertainty =       0.002048654993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382328614
  error estimate for blocks of size 2^( 2) =       0.000397180524
  error estimate for blocks of size 2^( 3) =       0.000410653861
  error estimate for blocks of size 2^( 4) =       0.000419984218
  error estimate for blocks of size 2^( 5) =       0.000424728725
  error estimate for blocks of size 2^( 6) =       0.000428973557
  error estimate for blocks of size 2^( 7) =       0.000432303975

      target function =      -0.911757571305
              le_mean =     -17.207537979525
             les_mean =     296.399988813523
             stat err =       0.000426497619
             autocorr =       1.244398892766
   target nu stat err =       0.000426497619
   target dn stat err =       0.002614205468
      target stat err =       0.004099272507
              std dev =       0.540694311311
             le_variance =       0.292350338284


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720753797952e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911774828825       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911774861495       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911774868485       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911774870247       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911774871415       residual = 9.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911774871740       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911774873095       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911774873892       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911774874991       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911774875595       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911774876193       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911774876901       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911774877475       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911774877264       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911774877380       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911774877377       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911774877500       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911774877799       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911774878064       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911774878023       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911774877928       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911774877812       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911774878004       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911774878187       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911774878259       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911774878287       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911774878308       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911774878288       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911774878258       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911774878240       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911774878234       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911774878272       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911774878280       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911774878285       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911774878295       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911774878300       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911774878289       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911774878300       residual = 7.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e+02 is 6.488412e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911774828825       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911774836993       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911774838741       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911774839182       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911774839475       residual = 9.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911774839551       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911774839899       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911774840092       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911774840367       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911774840511       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911774840674       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911774840834       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911774840989       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911774840934       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911774840970       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911774840967       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911774840992       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911774841071       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911774841137       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911774841128       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911774841096       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911774841066       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911774841115       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911774841155       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911774841184       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911774841175       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911774841190       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911774841184       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911774841195       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911774841171       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911774841169       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911774841200       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911774841211       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911774841207       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911774841197       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911774841179       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911774841212       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911774841188       residual = 7.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+03 is 1.622117e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911774828825       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911774830867       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911774831304       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911774831414       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911774831479       residual = 9.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911774831545       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911774831554       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911774831651       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911774831707       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911774831749       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911774831775       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911774831771       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911774831864       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911774831862       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911774831861       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911774831868       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911774831883       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911774831860       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911774831906       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911774832013       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911774831898       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911774831846       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911774831925       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911774831889       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911774831941       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911774831948       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911774831930       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911774831880       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911774831921       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911774831890       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911774831979       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911774831894       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911774831923       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911774831891       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911774831943       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911774831885       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911774831862       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911774831945       residual = 7.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+04 is 4.055300e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.988066 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8953e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.087044e-01 1 1  ON 0
  uu_1                 5.166540e-02 1 1  ON 1
  uu_2                -3.940248e-02 1 1  ON 2
  uu_3                -9.291319e-02 1 1  ON 3
  uu_4                -1.239452e-01 1 1  ON 4
  uu_5                -1.319993e-01 1 1  ON 5
  uu_6                -1.137865e-01 1 1  ON 6
  uu_7                -5.392793e-02 1 1  ON 7
  uu_8                 7.180144e-02 1 1  ON 8
  uu_9                 1.240334e-01 1 1  ON 9
  ud_0                 3.081047e-01 1 1  ON 10
  ud_1                 7.810740e-02 1 1  ON 11
  ud_2                -2.402705e-02 1 1  ON 12
  ud_3                -7.733468e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343900e-01 1 1  ON 15
  ud_6                -1.304700e-01 1 1  ON 16
  ud_7                -8.982049e-02 1 1  ON 17
  ud_8                -4.428240e-03 1 1  ON 18
  ud_9                 8.809495e-02 1 1  ON 19
  eO_0                -7.053860e-01 1 1  ON 20
  eO_1                -4.211850e-01 1 1  ON 21
  eO_2                -4.127692e-02 1 1  ON 22
  eO_3                 1.870631e-01 1 1  ON 23
  eO_4                 2.613828e-01 1 1  ON 24
  eO_5                 2.856728e-01 1 1  ON 25
  eO_6                 2.498735e-01 1 1  ON 26
  eO_7                 1.252716e-01 1 1  ON 27
  eO_8                 2.849682e-02 1 1  ON 28
  eO_9                 1.896041e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762642e-02 1 1  ON 31
 eH1_2                -4.696036e-02 1 1  ON 32
 eH1_3                -1.560119e-02 1 1  ON 33
 eH1_4                 1.885082e-02 1 1  ON 34
 eH1_5                 2.621031e-02 1 1  ON 35
 eH1_6                 7.491358e-02 1 1  ON 36
 eH1_7                 1.041064e-01 1 1  ON 37
 eH1_8                 9.703558e-02 1 1  ON 38
 eH1_9                 2.520272e-02 1 1  ON 39
 eH2_0                -2.031271e-01 1 1  ON 40
 eH2_1                -9.994655e-02 1 1  ON 41
 eH2_2                -4.927381e-02 1 1  ON 42
 eH2_3                -1.791041e-02 1 1  ON 43
 eH2_4                 1.638216e-02 1 1  ON 44
 eH2_5                 2.331749e-02 1 1  ON 45
 eH2_6                 7.777263e-02 1 1  ON 46
 eH2_7                 1.127072e-01 1 1  ON 47
 eH2_8                 9.970869e-02 1 1  ON 48
 eH2_9                 2.792547e-02 1 1  ON 49
ci_001                -4.261714e-02 3 1  ON 50
ci_002                -3.174195e-02 3 1  ON 51
ci_003                -1.241323e-02 3 1  ON 52
ci_004                 2.578144e-02 3 1  ON 53
ci_005                 2.603805e-02 3 1  ON 54
ci_006                -2.086989e-02 3 1  ON 55
ci_007                -2.067586e-02 3 1  ON 56
ci_008                -5.063865e-03 3 1  ON 57
ci_009                -1.563227e-02 3 1  ON 58
ci_010                -1.049566e-02 3 1  ON 59
ci_011                -1.040997e-02 3 1  ON 60
ci_012                -1.050687e-02 3 1  ON 61
ci_013                -2.150601e-02 3 1  ON 62
ci_014                 1.374539e-02 3 1  ON 63
ci_015                 1.357536e-02 3 1  ON 64
ci_016                 1.685288e-02 3 1  ON 65
ci_017                 1.606473e-02 3 1  ON 66
ci_018                 1.116429e-02 3 1  ON 67
ci_019                 1.083102e-02 3 1  ON 68
ci_020                 1.815803e-02 3 1  ON 69
ci_021                 1.790906e-02 3 1  ON 70
ci_022                 1.040978e-02 3 1  ON 71
ci_023                 1.092508e-02 3 1  ON 72
ci_024                 7.124153e-03 3 1  ON 73
ci_025                 7.214777e-03 3 1  ON 74
ci_026                 1.196725e-02 3 1  ON 75
ci_027                 1.214390e-02 3 1  ON 76
ci_028                -1.010303e-02 3 1  ON 77
ci_029                -9.847649e-03 3 1  ON 78
ci_030                -4.814031e-03 3 1  ON 79
ci_031                -5.117811e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2008
    reference variance = 0.254886
====================================================
  Execution time = 3.7750e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9654e-01
  Total weights = 1.9737e+06
  Execution time = 3.1425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289641609322
                                         uncertainty =       0.001618374766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289641609322
                                         uncertainty =       0.001618374766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380557122
  error estimate for blocks of size 2^( 2) =       0.000395491772
  error estimate for blocks of size 2^( 3) =       0.000409691268
  error estimate for blocks of size 2^( 4) =       0.000419950413
  error estimate for blocks of size 2^( 5) =       0.000425806792
  error estimate for blocks of size 2^( 6) =       0.000429263621
  error estimate for blocks of size 2^( 7) =       0.000431788407

      target function =      -0.918123077549
              le_mean =     -17.206754608811
             les_mean =     296.368947430814
             stat err =       0.000426702308
             autocorr =       1.257217093262
   target nu stat err =       0.000426702308
   target dn stat err =       0.002043595150
      target stat err =       0.003275495455
              std dev =       0.538189042989
             le_variance =       0.289647445993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289641562866
                                         uncertainty =       0.001618373431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289641562866
                                         uncertainty =       0.001618373431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380557091
  error estimate for blocks of size 2^( 2) =       0.000395491774
  error estimate for blocks of size 2^( 3) =       0.000409691299
  error estimate for blocks of size 2^( 4) =       0.000419950465
  error estimate for blocks of size 2^( 5) =       0.000425806855
  error estimate for blocks of size 2^( 6) =       0.000429263686
  error estimate for blocks of size 2^( 7) =       0.000431788475

      target function =      -0.918123256822
              le_mean =     -17.206754607144
             les_mean =     296.368947258870
             stat err =       0.000426702370
             autocorr =       1.257217656819
   target nu stat err =       0.000426702370
   target dn stat err =       0.002043582796
      target stat err =       0.003275477888
              std dev =       0.538189000030
             le_variance =       0.289647399753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289641586092
                                         uncertainty =       0.001618374098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289641586092
                                         uncertainty =       0.001618374098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380557107
  error estimate for blocks of size 2^( 2) =       0.000395491773
  error estimate for blocks of size 2^( 3) =       0.000409691284
  error estimate for blocks of size 2^( 4) =       0.000419950439
  error estimate for blocks of size 2^( 5) =       0.000425806823
  error estimate for blocks of size 2^( 6) =       0.000429263654
  error estimate for blocks of size 2^( 7) =       0.000431788441

      target function =      -0.918123167196
              le_mean =     -17.206754607977
             les_mean =     296.368947344830
             stat err =       0.000426702339
             autocorr =       1.257217375061
   target nu stat err =       0.000426702339
   target dn stat err =       0.002043588973
      target stat err =       0.003275486671
              std dev =       0.538189021507
             le_variance =       0.289647422871

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289641606418
                                         uncertainty =       0.001618374682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289641606418
                                         uncertainty =       0.001618374682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380557120
  error estimate for blocks of size 2^( 2) =       0.000395491773
  error estimate for blocks of size 2^( 3) =       0.000409691270
  error estimate for blocks of size 2^( 4) =       0.000419950417
  error estimate for blocks of size 2^( 5) =       0.000425806796
  error estimate for blocks of size 2^( 6) =       0.000429263625
  error estimate for blocks of size 2^( 7) =       0.000431788412

      target function =      -0.918123088755
              le_mean =     -17.206754608706
             les_mean =     296.368947420065
             stat err =       0.000426702312
             autocorr =       1.257217128494
   target nu stat err =       0.000426702312
   target dn stat err =       0.002043594378
      target stat err =       0.003275494357
              std dev =       0.538189040303
             le_variance =       0.289647443103


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918123077549        initial
     9.7656e+02     9.7656e+03             6.4884e-07        -0.918123256822  <--
     3.9062e+03     3.9062e+04             1.6221e-07        -0.918123167196
     1.5625e+04     1.5625e+05             4.0553e-08        -0.918123088755

*****************************************************************************
Applying the update for shift_i =   9.7656e+02     and shift_s =   9.7656e+03
*****************************************************************************

  Execution time = 5.3590e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.087044e-01 1 1  ON 0
  uu_1                 5.166543e-02 1 1  ON 1
  uu_2                -3.940245e-02 1 1  ON 2
  uu_3                -9.291314e-02 1 1  ON 3
  uu_4                -1.239451e-01 1 1  ON 4
  uu_5                -1.319993e-01 1 1  ON 5
  uu_6                -1.137864e-01 1 1  ON 6
  uu_7                -5.392787e-02 1 1  ON 7
  uu_8                 7.180096e-02 1 1  ON 8
  uu_9                 1.240334e-01 1 1  ON 9
  ud_0                 3.081045e-01 1 1  ON 10
  ud_1                 7.810721e-02 1 1  ON 11
  ud_2                -2.402725e-02 1 1  ON 12
  ud_3                -7.733481e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343900e-01 1 1  ON 15
  ud_6                -1.304697e-01 1 1  ON 16
  ud_7                -8.982021e-02 1 1  ON 17
  ud_8                -4.428154e-03 1 1  ON 18
  ud_9                 8.809504e-02 1 1  ON 19
  eO_0                -7.053860e-01 1 1  ON 20
  eO_1                -4.211850e-01 1 1  ON 21
  eO_2                -4.127696e-02 1 1  ON 22
  eO_3                 1.870630e-01 1 1  ON 23
  eO_4                 2.613826e-01 1 1  ON 24
  eO_5                 2.856727e-01 1 1  ON 25
  eO_6                 2.498736e-01 1 1  ON 26
  eO_7                 1.252719e-01 1 1  ON 27
  eO_8                 2.849685e-02 1 1  ON 28
  eO_9                 1.896041e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762630e-02 1 1  ON 31
 eH1_2                -4.696021e-02 1 1  ON 32
 eH1_3                -1.560112e-02 1 1  ON 33
 eH1_4                 1.885072e-02 1 1  ON 34
 eH1_5                 2.621004e-02 1 1  ON 35
 eH1_6                 7.491348e-02 1 1  ON 36
 eH1_7                 1.041063e-01 1 1  ON 37
 eH1_8                 9.703564e-02 1 1  ON 38
 eH1_9                 2.520273e-02 1 1  ON 39
 eH2_0                -2.031271e-01 1 1  ON 40
 eH2_1                -9.994636e-02 1 1  ON 41
 eH2_2                -4.927367e-02 1 1  ON 42
 eH2_3                -1.791038e-02 1 1  ON 43
 eH2_4                 1.638205e-02 1 1  ON 44
 eH2_5                 2.331725e-02 1 1  ON 45
 eH2_6                 7.777239e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.970884e-02 1 1  ON 48
 eH2_9                 2.792549e-02 1 1  ON 49
ci_001                -4.261712e-02 3 1  ON 50
ci_002                -3.174188e-02 3 1  ON 51
ci_003                -1.241312e-02 3 1  ON 52
ci_004                 2.578141e-02 3 1  ON 53
ci_005                 2.603803e-02 3 1  ON 54
ci_006                -2.086987e-02 3 1  ON 55
ci_007                -2.067582e-02 3 1  ON 56
ci_008                -5.063776e-03 3 1  ON 57
ci_009                -1.563219e-02 3 1  ON 58
ci_010                -1.049570e-02 3 1  ON 59
ci_011                -1.040988e-02 3 1  ON 60
ci_012                -1.050677e-02 3 1  ON 61
ci_013                -2.150602e-02 3 1  ON 62
ci_014                 1.374540e-02 3 1  ON 63
ci_015                 1.357532e-02 3 1  ON 64
ci_016                 1.685284e-02 3 1  ON 65
ci_017                 1.606468e-02 3 1  ON 66
ci_018                 1.116425e-02 3 1  ON 67
ci_019                 1.083099e-02 3 1  ON 68
ci_020                 1.815805e-02 3 1  ON 69
ci_021                 1.790911e-02 3 1  ON 70
ci_022                 1.040979e-02 3 1  ON 71
ci_023                 1.092510e-02 3 1  ON 72
ci_024                 7.124102e-03 3 1  ON 73
ci_025                 7.214821e-03 3 1  ON 74
ci_026                 1.196720e-02 3 1  ON 75
ci_027                 1.214386e-02 3 1  ON 76
ci_028                -1.010299e-02 3 1  ON 77
ci_029                -9.847592e-03 3 1  ON 78
ci_030                -4.814026e-03 3 1  ON 79
ci_031                -5.117764e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0255e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2008
    reference variance = 0.328033
====================================================
  Execution time = 3.7842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5409e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0316e-01
  Total weights = 1.973761588e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0728e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292997605169
                                         uncertainty =       0.002304086725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292997605169
                                         uncertainty =       0.002304086725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382733496
  error estimate for blocks of size 2^( 2) =       0.000397406332
  error estimate for blocks of size 2^( 3) =       0.000411133757
  error estimate for blocks of size 2^( 4) =       0.000420448172
  error estimate for blocks of size 2^( 5) =       0.000427309113
  error estimate for blocks of size 2^( 6) =       0.000431125767
  error estimate for blocks of size 2^( 7) =       0.000431302151

      target function =      -0.907872411380
              le_mean =     -17.206508070458
             les_mean =     296.367083707571
             stat err =       0.000427546301
             autocorr =       1.247881541416
   target nu stat err =       0.000427546301
   target dn stat err =       0.003853514590
      target stat err =       0.005930216848
              std dev =       0.541266901051
             le_variance =       0.292969858174


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720650807046e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907910262014       residual = 6.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907910373557       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907910398704       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907910411208       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907910413347       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907910414767       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907910415980       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907910417558       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907910419334       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907910420232       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907910419931       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907910420089       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907910420332       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907910421315       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907910421534       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907910421677       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907910421737       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.907910422080       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.907910422020       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.907910422221       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.907910422097       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.907910422414       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.907910422590       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.907910422456       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907910422592       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.907910422689       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.907910422699       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.907910422739       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.907910422746       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.907910422726       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.907910422757       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907910422735       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907910422726       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e+02 is 1.361561e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907910262014       residual = 6.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907910289906       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907910296194       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907910299321       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907910299856       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907910300211       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907910300514       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907910300909       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907910301353       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907910301577       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907910301502       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907910301540       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907910301602       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907910301849       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907910301899       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907910301939       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907910301952       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.907910302041       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.907910302026       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.907910302077       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.907910302044       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.907910302122       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.907910302165       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.907910302133       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907910302169       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.907910302194       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.907910302193       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.907910302201       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.907910302208       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.907910302202       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.907910302207       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907910302205       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907910302204       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e+02 is 3.403979e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907910262014       residual = 6.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907910268988       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907910270560       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907910271342       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907910271475       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907910271559       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907910271640       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907910271738       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907910271836       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907910271900       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907910271893       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907910271896       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907910271909       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907910271971       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907910271986       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907910271992       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907910272001       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.907910272020       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.907910272021       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.907910272018       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.907910272022       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.907910272046       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.907910272041       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.907910272045       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907910272048       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.907910272069       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.907910272066       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.907910272062       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.907910272054       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.907910272063       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.907910272066       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907910272064       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907910272060       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+03 is 8.509996e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.026267 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8615e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.087046e-01 1 1  ON 0
  uu_1                 5.166554e-02 1 1  ON 1
  uu_2                -3.940238e-02 1 1  ON 2
  uu_3                -9.291316e-02 1 1  ON 3
  uu_4                -1.239452e-01 1 1  ON 4
  uu_5                -1.319993e-01 1 1  ON 5
  uu_6                -1.137864e-01 1 1  ON 6
  uu_7                -5.392798e-02 1 1  ON 7
  uu_8                 7.180062e-02 1 1  ON 8
  uu_9                 1.240334e-01 1 1  ON 9
  ud_0                 3.081044e-01 1 1  ON 10
  ud_1                 7.810720e-02 1 1  ON 11
  ud_2                -2.402723e-02 1 1  ON 12
  ud_3                -7.733482e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343899e-01 1 1  ON 15
  ud_6                -1.304697e-01 1 1  ON 16
  ud_7                -8.982025e-02 1 1  ON 17
  ud_8                -4.428286e-03 1 1  ON 18
  ud_9                 8.809493e-02 1 1  ON 19
  eO_0                -7.053861e-01 1 1  ON 20
  eO_1                -4.211852e-01 1 1  ON 21
  eO_2                -4.127702e-02 1 1  ON 22
  eO_3                 1.870631e-01 1 1  ON 23
  eO_4                 2.613827e-01 1 1  ON 24
  eO_5                 2.856726e-01 1 1  ON 25
  eO_6                 2.498736e-01 1 1  ON 26
  eO_7                 1.252722e-01 1 1  ON 27
  eO_8                 2.849687e-02 1 1  ON 28
  eO_9                 1.896042e-02 1 1  ON 29
 eH1_0                -2.018799e-01 1 1  ON 30
 eH1_1                -9.762623e-02 1 1  ON 31
 eH1_2                -4.696013e-02 1 1  ON 32
 eH1_3                -1.560107e-02 1 1  ON 33
 eH1_4                 1.885072e-02 1 1  ON 34
 eH1_5                 2.620999e-02 1 1  ON 35
 eH1_6                 7.491342e-02 1 1  ON 36
 eH1_7                 1.041062e-01 1 1  ON 37
 eH1_8                 9.703571e-02 1 1  ON 38
 eH1_9                 2.520278e-02 1 1  ON 39
 eH2_0                -2.031272e-01 1 1  ON 40
 eH2_1                -9.994641e-02 1 1  ON 41
 eH2_2                -4.927364e-02 1 1  ON 42
 eH2_3                -1.791030e-02 1 1  ON 43
 eH2_4                 1.638197e-02 1 1  ON 44
 eH2_5                 2.331711e-02 1 1  ON 45
 eH2_6                 7.777248e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.970901e-02 1 1  ON 48
 eH2_9                 2.792552e-02 1 1  ON 49
ci_001                -4.261704e-02 3 1  ON 50
ci_002                -3.174184e-02 3 1  ON 51
ci_003                -1.241315e-02 3 1  ON 52
ci_004                 2.578152e-02 3 1  ON 53
ci_005                 2.603799e-02 3 1  ON 54
ci_006                -2.086985e-02 3 1  ON 55
ci_007                -2.067577e-02 3 1  ON 56
ci_008                -5.063801e-03 3 1  ON 57
ci_009                -1.563215e-02 3 1  ON 58
ci_010                -1.049564e-02 3 1  ON 59
ci_011                -1.040989e-02 3 1  ON 60
ci_012                -1.050671e-02 3 1  ON 61
ci_013                -2.150600e-02 3 1  ON 62
ci_014                 1.374543e-02 3 1  ON 63
ci_015                 1.357525e-02 3 1  ON 64
ci_016                 1.685283e-02 3 1  ON 65
ci_017                 1.606464e-02 3 1  ON 66
ci_018                 1.116414e-02 3 1  ON 67
ci_019                 1.083104e-02 3 1  ON 68
ci_020                 1.815799e-02 3 1  ON 69
ci_021                 1.790909e-02 3 1  ON 70
ci_022                 1.040985e-02 3 1  ON 71
ci_023                 1.092515e-02 3 1  ON 72
ci_024                 7.124156e-03 3 1  ON 73
ci_025                 7.214731e-03 3 1  ON 74
ci_026                 1.196709e-02 3 1  ON 75
ci_027                 1.214386e-02 3 1  ON 76
ci_028                -1.010290e-02 3 1  ON 77
ci_029                -9.847432e-03 3 1  ON 78
ci_030                -4.814029e-03 3 1  ON 79
ci_031                -5.117802e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1963
    reference variance = 0.348558
====================================================
  Execution time = 3.8291e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9971e-01
  Total weights = 1.9737e+06
  Execution time = 3.1645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292418960726
                                         uncertainty =       0.002072894404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292418960726
                                         uncertainty =       0.002072894404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382362438
  error estimate for blocks of size 2^( 2) =       0.000397301677
  error estimate for blocks of size 2^( 3) =       0.000411044582
  error estimate for blocks of size 2^( 4) =       0.000420495749
  error estimate for blocks of size 2^( 5) =       0.000426320769
  error estimate for blocks of size 2^( 6) =       0.000429982925
  error estimate for blocks of size 2^( 7) =       0.000429428374

      target function =      -0.913201727085
              le_mean =     -17.206442418239
             les_mean =     296.361372057906
             stat err =       0.000426556954
             autocorr =       1.244524951640
   target nu stat err =       0.000426556954
   target dn stat err =       0.002421865313
      target stat err =       0.003811493998
              std dev =       0.540742146188
             le_variance =       0.292402068664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292419001584
                                         uncertainty =       0.002072883533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292419001584
                                         uncertainty =       0.002072883533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382362466
  error estimate for blocks of size 2^( 2) =       0.000397301762
  error estimate for blocks of size 2^( 3) =       0.000411044718
  error estimate for blocks of size 2^( 4) =       0.000420495925
  error estimate for blocks of size 2^( 5) =       0.000426320970
  error estimate for blocks of size 2^( 6) =       0.000429983163
  error estimate for blocks of size 2^( 7) =       0.000429428625

      target function =      -0.913201858377
              le_mean =     -17.206442411529
             les_mean =     296.361371742359
             stat err =       0.000426557171
             autocorr =       1.244526037168
   target nu stat err =       0.000426557171
   target dn stat err =       0.002421837111
      target stat err =       0.003811452302
              std dev =       0.540742184663
             le_variance =       0.292402110274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292418981147
                                         uncertainty =       0.002072888967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292418981147
                                         uncertainty =       0.002072888967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382362452
  error estimate for blocks of size 2^( 2) =       0.000397301719
  error estimate for blocks of size 2^( 3) =       0.000411044650
  error estimate for blocks of size 2^( 4) =       0.000420495837
  error estimate for blocks of size 2^( 5) =       0.000426320869
  error estimate for blocks of size 2^( 6) =       0.000429983044
  error estimate for blocks of size 2^( 7) =       0.000429428500

      target function =      -0.913201794098
              le_mean =     -17.206442414882
             les_mean =     296.361371899168
             stat err =       0.000426557062
             autocorr =       1.244525494525
   target nu stat err =       0.000426557062
   target dn stat err =       0.002421851182
      target stat err =       0.003811473115
              std dev =       0.540742165418
             le_variance =       0.292402089461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292418963278
                                         uncertainty =       0.002072893725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292418963278
                                         uncertainty =       0.002072893725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382362440
  error estimate for blocks of size 2^( 2) =       0.000397301682
  error estimate for blocks of size 2^( 3) =       0.000411044590
  error estimate for blocks of size 2^( 4) =       0.000420495760
  error estimate for blocks of size 2^( 5) =       0.000426320782
  error estimate for blocks of size 2^( 6) =       0.000429982940
  error estimate for blocks of size 2^( 7) =       0.000429428390

      target function =      -0.913201735611
              le_mean =     -17.206442417819
             les_mean =     296.361372037960
             stat err =       0.000426556968
             autocorr =       1.244525019514
   target nu stat err =       0.000426556968
   target dn stat err =       0.002421863544
      target stat err =       0.003811491384
              std dev =       0.540742148591
             le_variance =       0.292402071263


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913201727085        initial
     2.4414e+02     2.4414e+03             1.3616e-06        -0.913201858377  <--
     9.7656e+02     9.7656e+03             3.4040e-07        -0.913201794098
     3.9062e+03     3.9062e+04             8.5100e-08        -0.913201735611

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 5.4216e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.087052e-01 1 1  ON 0
  uu_1                 5.166586e-02 1 1  ON 1
  uu_2                -3.940218e-02 1 1  ON 2
  uu_3                -9.291324e-02 1 1  ON 3
  uu_4                -1.239456e-01 1 1  ON 4
  uu_5                -1.319995e-01 1 1  ON 5
  uu_6                -1.137863e-01 1 1  ON 6
  uu_7                -5.392831e-02 1 1  ON 7
  uu_8                 7.179959e-02 1 1  ON 8
  uu_9                 1.240335e-01 1 1  ON 9
  ud_0                 3.081043e-01 1 1  ON 10
  ud_1                 7.810717e-02 1 1  ON 11
  ud_2                -2.402720e-02 1 1  ON 12
  ud_3                -7.733488e-02 1 1  ON 13
  ud_4                -1.141468e-01 1 1  ON 14
  ud_5                -1.343897e-01 1 1  ON 15
  ud_6                -1.304695e-01 1 1  ON 16
  ud_7                -8.982036e-02 1 1  ON 17
  ud_8                -4.428680e-03 1 1  ON 18
  ud_9                 8.809460e-02 1 1  ON 19
  eO_0                -7.053867e-01 1 1  ON 20
  eO_1                -4.211857e-01 1 1  ON 21
  eO_2                -4.127720e-02 1 1  ON 22
  eO_3                 1.870634e-01 1 1  ON 23
  eO_4                 2.613831e-01 1 1  ON 24
  eO_5                 2.856722e-01 1 1  ON 25
  eO_6                 2.498736e-01 1 1  ON 26
  eO_7                 1.252731e-01 1 1  ON 27
  eO_8                 2.849693e-02 1 1  ON 28
  eO_9                 1.896047e-02 1 1  ON 29
 eH1_0                -2.018801e-01 1 1  ON 30
 eH1_1                -9.762604e-02 1 1  ON 31
 eH1_2                -4.695991e-02 1 1  ON 32
 eH1_3                -1.560090e-02 1 1  ON 33
 eH1_4                 1.885071e-02 1 1  ON 34
 eH1_5                 2.620984e-02 1 1  ON 35
 eH1_6                 7.491323e-02 1 1  ON 36
 eH1_7                 1.041059e-01 1 1  ON 37
 eH1_8                 9.703592e-02 1 1  ON 38
 eH1_9                 2.520290e-02 1 1  ON 39
 eH2_0                -2.031276e-01 1 1  ON 40
 eH2_1                -9.994654e-02 1 1  ON 41
 eH2_2                -4.927358e-02 1 1  ON 42
 eH2_3                -1.791005e-02 1 1  ON 43
 eH2_4                 1.638175e-02 1 1  ON 44
 eH2_5                 2.331669e-02 1 1  ON 45
 eH2_6                 7.777274e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.970952e-02 1 1  ON 48
 eH2_9                 2.792559e-02 1 1  ON 49
ci_001                -4.261678e-02 3 1  ON 50
ci_002                -3.174173e-02 3 1  ON 51
ci_003                -1.241323e-02 3 1  ON 52
ci_004                 2.578183e-02 3 1  ON 53
ci_005                 2.603787e-02 3 1  ON 54
ci_006                -2.086978e-02 3 1  ON 55
ci_007                -2.067561e-02 3 1  ON 56
ci_008                -5.063877e-03 3 1  ON 57
ci_009                -1.563201e-02 3 1  ON 58
ci_010                -1.049546e-02 3 1  ON 59
ci_011                -1.040992e-02 3 1  ON 60
ci_012                -1.050655e-02 3 1  ON 61
ci_013                -2.150594e-02 3 1  ON 62
ci_014                 1.374552e-02 3 1  ON 63
ci_015                 1.357502e-02 3 1  ON 64
ci_016                 1.685280e-02 3 1  ON 65
ci_017                 1.606453e-02 3 1  ON 66
ci_018                 1.116380e-02 3 1  ON 67
ci_019                 1.083119e-02 3 1  ON 68
ci_020                 1.815779e-02 3 1  ON 69
ci_021                 1.790904e-02 3 1  ON 70
ci_022                 1.041002e-02 3 1  ON 71
ci_023                 1.092530e-02 3 1  ON 72
ci_024                 7.124316e-03 3 1  ON 73
ci_025                 7.214459e-03 3 1  ON 74
ci_026                 1.196677e-02 3 1  ON 75
ci_027                 1.214385e-02 3 1  ON 76
ci_028                -1.010265e-02 3 1  ON 77
ci_029                -9.846955e-03 3 1  ON 78
ci_030                -4.814039e-03 3 1  ON 79
ci_031                -5.117917e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0284e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2946
    reference variance = 0.26498
====================================================
  Execution time = 3.8364e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5419e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0199e-01
  Total weights = 1.973722332e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0779e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292649620997
                                         uncertainty =       0.002105439848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292649620997
                                         uncertainty =       0.002105439848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382588613
  error estimate for blocks of size 2^( 2) =       0.000397647744
  error estimate for blocks of size 2^( 3) =       0.000411884728
  error estimate for blocks of size 2^( 4) =       0.000421413661
  error estimate for blocks of size 2^( 5) =       0.000427380481
  error estimate for blocks of size 2^( 6) =       0.000429859182
  error estimate for blocks of size 2^( 7) =       0.000432835241

      target function =      -0.909676247857
              le_mean =     -17.206625452496
             les_mean =     296.369951143350
             stat err =       0.000427872141
             autocorr =       1.250731073177
   target nu stat err =       0.000427872141
   target dn stat err =       0.003096168685
      target stat err =       0.004803807737
              std dev =       0.541062005861
             le_variance =       0.292748094186


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720662545250e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909700601743       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909701059105       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909701195997       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909701227657       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909701243052       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909701251403       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909701270260       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909701287401       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909701306618       residual = 7.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909701308724       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909701313509       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909701318133       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909701332922       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909701338466       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909701339569       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.909701341565       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909701350560       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909701355543       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909701357615       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909701356629       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909701355447       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909701354524       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909701354364       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909701356031       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909701355649       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909701355393       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909701355364       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909701355451       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909701356077       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909701356868       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909701356827       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909701356736       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909701356811       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909701356887       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909701356773       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909701356646       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909701356690       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.909701356642       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.909701356769       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.1035e+01 is 8.144453e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909700601743       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909700716189       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909700750436       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909700758358       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909700762208       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909700764297       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909700769015       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909700773300       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909700778107       residual = 7.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909700778634       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909700779831       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909700780989       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909700784686       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909700786071       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909700786347       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.909700786846       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909700789096       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909700790342       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909700790858       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909700790610       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909700790315       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909700790084       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909700790045       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909700790461       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909700790364       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909700790301       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909700790293       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909700790316       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909700790473       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909700790671       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909700790659       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909700790637       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909700790655       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909700790675       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909700790646       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909700790614       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909700790626       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.909700790614       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.909700790644       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e+02 is 2.036492e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909700601743       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909700630361       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909700638924       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909700640905       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909700641868       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909700642390       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909700643569       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909700644639       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909700645844       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909700645975       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909700646276       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909700646564       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909700647486       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909700647833       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909700647906       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.909700648028       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909700648590       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909700648901       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909700649030       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909700648969       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909700648898       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909700648838       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909700648827       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909700648932       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909700648906       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909700648889       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909700648888       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909700648894       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909700648931       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909700648983       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909700648979       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909700648976       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909700648978       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909700648986       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909700648978       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909700648963       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909700648972       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.909700648969       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.909700648976       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e+02 is 5.091466e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.088159 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9212e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.087054e-01 1 1  ON 0
  uu_1                 5.166618e-02 1 1  ON 1
  uu_2                -3.940210e-02 1 1  ON 2
  uu_3                -9.291319e-02 1 1  ON 3
  uu_4                -1.239456e-01 1 1  ON 4
  uu_5                -1.319992e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.392897e-02 1 1  ON 7
  uu_8                 7.179762e-02 1 1  ON 8
  uu_9                 1.240337e-01 1 1  ON 9
  ud_0                 3.081033e-01 1 1  ON 10
  ud_1                 7.810621e-02 1 1  ON 11
  ud_2                -2.402780e-02 1 1  ON 12
  ud_3                -7.733527e-02 1 1  ON 13
  ud_4                -1.141467e-01 1 1  ON 14
  ud_5                -1.343893e-01 1 1  ON 15
  ud_6                -1.304681e-01 1 1  ON 16
  ud_7                -8.981936e-02 1 1  ON 17
  ud_8                -4.428724e-03 1 1  ON 18
  ud_9                 8.809429e-02 1 1  ON 19
  eO_0                -7.053863e-01 1 1  ON 20
  eO_1                -4.211856e-01 1 1  ON 21
  eO_2                -4.127760e-02 1 1  ON 22
  eO_3                 1.870624e-01 1 1  ON 23
  eO_4                 2.613817e-01 1 1  ON 24
  eO_5                 2.856708e-01 1 1  ON 25
  eO_6                 2.498754e-01 1 1  ON 26
  eO_7                 1.252747e-01 1 1  ON 27
  eO_8                 2.849704e-02 1 1  ON 28
  eO_9                 1.896052e-02 1 1  ON 29
 eH1_0                -2.018807e-01 1 1  ON 30
 eH1_1                -9.762585e-02 1 1  ON 31
 eH1_2                -4.695969e-02 1 1  ON 32
 eH1_3                -1.560073e-02 1 1  ON 33
 eH1_4                 1.885024e-02 1 1  ON 34
 eH1_5                 2.620790e-02 1 1  ON 35
 eH1_6                 7.491322e-02 1 1  ON 36
 eH1_7                 1.041074e-01 1 1  ON 37
 eH1_8                 9.703669e-02 1 1  ON 38
 eH1_9                 2.520296e-02 1 1  ON 39
 eH2_0                -2.031269e-01 1 1  ON 40
 eH2_1                -9.994596e-02 1 1  ON 41
 eH2_2                -4.927270e-02 1 1  ON 42
 eH2_3                -1.790962e-02 1 1  ON 43
 eH2_4                 1.638149e-02 1 1  ON 44
 eH2_5                 2.331610e-02 1 1  ON 45
 eH2_6                 7.777070e-02 1 1  ON 46
 eH2_7                 1.127067e-01 1 1  ON 47
 eH2_8                 9.971012e-02 1 1  ON 48
 eH2_9                 2.792576e-02 1 1  ON 49
ci_001                -4.261682e-02 3 1  ON 50
ci_002                -3.174146e-02 3 1  ON 51
ci_003                -1.241295e-02 3 1  ON 52
ci_004                 2.578167e-02 3 1  ON 53
ci_005                 2.603819e-02 3 1  ON 54
ci_006                -2.086913e-02 3 1  ON 55
ci_007                -2.067551e-02 3 1  ON 56
ci_008                -5.063631e-03 3 1  ON 57
ci_009                -1.563163e-02 3 1  ON 58
ci_010                -1.049499e-02 3 1  ON 59
ci_011                -1.040972e-02 3 1  ON 60
ci_012                -1.050624e-02 3 1  ON 61
ci_013                -2.150585e-02 3 1  ON 62
ci_014                 1.374512e-02 3 1  ON 63
ci_015                 1.357457e-02 3 1  ON 64
ci_016                 1.685277e-02 3 1  ON 65
ci_017                 1.606460e-02 3 1  ON 66
ci_018                 1.116338e-02 3 1  ON 67
ci_019                 1.083126e-02 3 1  ON 68
ci_020                 1.815773e-02 3 1  ON 69
ci_021                 1.790892e-02 3 1  ON 70
ci_022                 1.041034e-02 3 1  ON 71
ci_023                 1.092519e-02 3 1  ON 72
ci_024                 7.124254e-03 3 1  ON 73
ci_025                 7.214525e-03 3 1  ON 74
ci_026                 1.196681e-02 3 1  ON 75
ci_027                 1.214367e-02 3 1  ON 76
ci_028                -1.010235e-02 3 1  ON 77
ci_029                -9.847033e-03 3 1  ON 78
ci_030                -4.813833e-03 3 1  ON 79
ci_031                -5.118042e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2363
    reference variance = 0.165995
====================================================
  Execution time = 3.7227e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9803e-01
  Total weights = 1.9736e+06
  Execution time = 3.1324e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289056240351
                                         uncertainty =       0.001766412785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289056240351
                                         uncertainty =       0.001766412785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380186934
  error estimate for blocks of size 2^( 2) =       0.000395163784
  error estimate for blocks of size 2^( 3) =       0.000408303988
  error estimate for blocks of size 2^( 4) =       0.000417994857
  error estimate for blocks of size 2^( 5) =       0.000423515317
  error estimate for blocks of size 2^( 6) =       0.000427488118
  error estimate for blocks of size 2^( 7) =       0.000430460462

      target function =      -0.915776359295
              le_mean =     -17.207179884982
             les_mean =     296.385069994703
             stat err =       0.000424864688
             autocorr =       1.248840288057
   target nu stat err =       0.000424864688
   target dn stat err =       0.003383655449
      target stat err =       0.005314854340
              std dev =       0.537665517903
             le_variance =       0.289084209142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289056577851
                                         uncertainty =       0.001766595726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289056577851
                                         uncertainty =       0.001766595726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380187152
  error estimate for blocks of size 2^( 2) =       0.000395164488
  error estimate for blocks of size 2^( 3) =       0.000408305174
  error estimate for blocks of size 2^( 4) =       0.000417996377
  error estimate for blocks of size 2^( 5) =       0.000423517035
  error estimate for blocks of size 2^( 6) =       0.000427489985
  error estimate for blocks of size 2^( 7) =       0.000430462480

      target function =      -0.915776032696
              le_mean =     -17.207179899078
             les_mean =     296.385070672138
             stat err =       0.000424866469
             autocorr =       1.248849326480
   target nu stat err =       0.000424866469
   target dn stat err =       0.003385154758
      target stat err =       0.005317162871
              std dev =       0.537665826090
             le_variance =       0.289084540545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289056409001
                                         uncertainty =       0.001766504274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289056409001
                                         uncertainty =       0.001766504274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380187043
  error estimate for blocks of size 2^( 2) =       0.000395164136
  error estimate for blocks of size 2^( 3) =       0.000408304581
  error estimate for blocks of size 2^( 4) =       0.000417995617
  error estimate for blocks of size 2^( 5) =       0.000423516177
  error estimate for blocks of size 2^( 6) =       0.000427489052
  error estimate for blocks of size 2^( 7) =       0.000430461472

      target function =      -0.915776203526
              le_mean =     -17.207179892003
             les_mean =     296.385070327640
             stat err =       0.000424865579
             autocorr =       1.248844810640
   target nu stat err =       0.000424865579
   target dn stat err =       0.003384405232
      target stat err =       0.005316008889
              std dev =       0.537665671902
             le_variance =       0.289084374742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289056261408
                                         uncertainty =       0.001766424217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289056261408
                                         uncertainty =       0.001766424217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380186947
  error estimate for blocks of size 2^( 2) =       0.000395163828
  error estimate for blocks of size 2^( 3) =       0.000408304063
  error estimate for blocks of size 2^( 4) =       0.000417994952
  error estimate for blocks of size 2^( 5) =       0.000423515425
  error estimate for blocks of size 2^( 6) =       0.000427488235
  error estimate for blocks of size 2^( 7) =       0.000430460588

      target function =      -0.915776340673
              le_mean =     -17.207179885856
             les_mean =     296.385070035659
             stat err =       0.000424864800
             autocorr =       1.248840853483
   target nu stat err =       0.000424864800
   target dn stat err =       0.003383749138
      target stat err =       0.005314998616
              std dev =       0.537665537131
             le_variance =       0.289084229818


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915776359295        initial  <--
     6.1035e+01     6.1035e+02             8.1445e-06        -0.915776032696
     2.4414e+02     2.4414e+03             2.0365e-06        -0.915776203526
     9.7656e+02     9.7656e+03             5.0915e-07        -0.915776340673

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.9695
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.087052e-01 1 1  ON 0
  uu_1                 5.166586e-02 1 1  ON 1
  uu_2                -3.940218e-02 1 1  ON 2
  uu_3                -9.291324e-02 1 1  ON 3
  uu_4                -1.239456e-01 1 1  ON 4
  uu_5                -1.319995e-01 1 1  ON 5
  uu_6                -1.137863e-01 1 1  ON 6
  uu_7                -5.392831e-02 1 1  ON 7
  uu_8                 7.179959e-02 1 1  ON 8
  uu_9                 1.240335e-01 1 1  ON 9
  ud_0                 3.081043e-01 1 1  ON 10
  ud_1                 7.810717e-02 1 1  ON 11
  ud_2                -2.402720e-02 1 1  ON 12
  ud_3                -7.733488e-02 1 1  ON 13
  ud_4                -1.141468e-01 1 1  ON 14
  ud_5                -1.343897e-01 1 1  ON 15
  ud_6                -1.304695e-01 1 1  ON 16
  ud_7                -8.982036e-02 1 1  ON 17
  ud_8                -4.428680e-03 1 1  ON 18
  ud_9                 8.809460e-02 1 1  ON 19
  eO_0                -7.053867e-01 1 1  ON 20
  eO_1                -4.211857e-01 1 1  ON 21
  eO_2                -4.127720e-02 1 1  ON 22
  eO_3                 1.870634e-01 1 1  ON 23
  eO_4                 2.613831e-01 1 1  ON 24
  eO_5                 2.856722e-01 1 1  ON 25
  eO_6                 2.498736e-01 1 1  ON 26
  eO_7                 1.252731e-01 1 1  ON 27
  eO_8                 2.849693e-02 1 1  ON 28
  eO_9                 1.896047e-02 1 1  ON 29
 eH1_0                -2.018801e-01 1 1  ON 30
 eH1_1                -9.762604e-02 1 1  ON 31
 eH1_2                -4.695991e-02 1 1  ON 32
 eH1_3                -1.560090e-02 1 1  ON 33
 eH1_4                 1.885071e-02 1 1  ON 34
 eH1_5                 2.620984e-02 1 1  ON 35
 eH1_6                 7.491323e-02 1 1  ON 36
 eH1_7                 1.041059e-01 1 1  ON 37
 eH1_8                 9.703592e-02 1 1  ON 38
 eH1_9                 2.520290e-02 1 1  ON 39
 eH2_0                -2.031276e-01 1 1  ON 40
 eH2_1                -9.994654e-02 1 1  ON 41
 eH2_2                -4.927358e-02 1 1  ON 42
 eH2_3                -1.791005e-02 1 1  ON 43
 eH2_4                 1.638175e-02 1 1  ON 44
 eH2_5                 2.331669e-02 1 1  ON 45
 eH2_6                 7.777274e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.970952e-02 1 1  ON 48
 eH2_9                 2.792559e-02 1 1  ON 49
ci_001                -4.261678e-02 3 1  ON 50
ci_002                -3.174173e-02 3 1  ON 51
ci_003                -1.241323e-02 3 1  ON 52
ci_004                 2.578183e-02 3 1  ON 53
ci_005                 2.603787e-02 3 1  ON 54
ci_006                -2.086978e-02 3 1  ON 55
ci_007                -2.067561e-02 3 1  ON 56
ci_008                -5.063877e-03 3 1  ON 57
ci_009                -1.563201e-02 3 1  ON 58
ci_010                -1.049546e-02 3 1  ON 59
ci_011                -1.040992e-02 3 1  ON 60
ci_012                -1.050655e-02 3 1  ON 61
ci_013                -2.150594e-02 3 1  ON 62
ci_014                 1.374552e-02 3 1  ON 63
ci_015                 1.357502e-02 3 1  ON 64
ci_016                 1.685280e-02 3 1  ON 65
ci_017                 1.606453e-02 3 1  ON 66
ci_018                 1.116380e-02 3 1  ON 67
ci_019                 1.083119e-02 3 1  ON 68
ci_020                 1.815779e-02 3 1  ON 69
ci_021                 1.790904e-02 3 1  ON 70
ci_022                 1.041002e-02 3 1  ON 71
ci_023                 1.092530e-02 3 1  ON 72
ci_024                 7.124316e-03 3 1  ON 73
ci_025                 7.214459e-03 3 1  ON 74
ci_026                 1.196677e-02 3 1  ON 75
ci_027                 1.214385e-02 3 1  ON 76
ci_028                -1.010265e-02 3 1  ON 77
ci_029                -9.846955e-03 3 1  ON 78
ci_030                -4.814039e-03 3 1  ON 79
ci_031                -5.117917e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0219e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.3004
    reference variance = 0.432646
====================================================
  Execution time = 3.8141e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5402e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9964e-01
  Total weights = 1.973781707e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0934e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290247043227
                                         uncertainty =       0.001860347315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290247043227
                                         uncertainty =       0.001860347315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380882377
  error estimate for blocks of size 2^( 2) =       0.000395876955
  error estimate for blocks of size 2^( 3) =       0.000409470496
  error estimate for blocks of size 2^( 4) =       0.000420058784
  error estimate for blocks of size 2^( 5) =       0.000424999247
  error estimate for blocks of size 2^( 6) =       0.000427904489
  error estimate for blocks of size 2^( 7) =       0.000431251526

      target function =      -0.913294342452
              le_mean =     -17.206944847259
             les_mean =     296.378592008493
             stat err =       0.000426053512
             autocorr =       1.251257061960
   target nu stat err =       0.000426053512
   target dn stat err =       0.002684693397
      target stat err =       0.004215633638
              std dev =       0.538649022774
             le_variance =       0.290142769735


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720694484726e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913312755969       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913312775869       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913312786925       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913312789857       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913312791620       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913312792268       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913312792685       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913312793955       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913312794514       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913312795072       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913312795567       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913312796144       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913312796931       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913312797234       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913312797491       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913312797667       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913312797712       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913312797985       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913312798292       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913312798327       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913312798202       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913312798135       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913312798046       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913312798138       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913312798134       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913312798176       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913312798155       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913312798131       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913312798194       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913312798206       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913312798201       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913312798224       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913312798193       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913312798220       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913312798208       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913312798204       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913312798208       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913312798195       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913312798194       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.1035e+02 is 7.482162e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913312755969       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913312760945       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913312763709       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913312764441       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913312764883       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913312765044       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913312765148       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913312765472       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913312765609       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913312765746       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913312765867       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913312766008       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913312766209       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913312766291       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913312766350       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913312766394       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913312766398       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913312766472       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913312766552       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913312766553       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913312766537       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913312766511       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913312766489       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913312766509       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913312766516       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913312766522       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913312766513       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913312766514       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913312766521       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913312766542       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913312766521       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913312766523       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913312766533       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913312766532       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913312766522       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913312766532       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913312766523       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913312766529       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913312766530       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e+03 is 1.870561e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913312755969       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913312757213       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913312757904       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913312758088       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913312758193       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913312758238       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913312758265       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913312758352       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913312758381       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913312758412       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913312758456       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913312758477       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913312758544       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913312758528       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913312758573       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913312758545       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913312758587       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913312758600       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913312758620       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913312758623       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913312758619       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913312758601       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913312758622       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913312758587       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913312758612       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913312758601       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913312758607       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913312758572       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913312758584       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913312758611       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913312758609       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913312758592       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913312758623       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913312758604       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913312758620       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913312758597       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913312758587       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913312758603       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913312758659       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e+03 is 4.676415e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.150163 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9144e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.087052e-01 1 1  ON 0
  uu_1                 5.166589e-02 1 1  ON 1
  uu_2                -3.940216e-02 1 1  ON 2
  uu_3                -9.291322e-02 1 1  ON 3
  uu_4                -1.239455e-01 1 1  ON 4
  uu_5                -1.319995e-01 1 1  ON 5
  uu_6                -1.137863e-01 1 1  ON 6
  uu_7                -5.392838e-02 1 1  ON 7
  uu_8                 7.179941e-02 1 1  ON 8
  uu_9                 1.240335e-01 1 1  ON 9
  ud_0                 3.081042e-01 1 1  ON 10
  ud_1                 7.810710e-02 1 1  ON 11
  ud_2                -2.402726e-02 1 1  ON 12
  ud_3                -7.733493e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343896e-01 1 1  ON 15
  ud_6                -1.304694e-01 1 1  ON 16
  ud_7                -8.982023e-02 1 1  ON 17
  ud_8                -4.428656e-03 1 1  ON 18
  ud_9                 8.809457e-02 1 1  ON 19
  eO_0                -7.053867e-01 1 1  ON 20
  eO_1                -4.211857e-01 1 1  ON 21
  eO_2                -4.127722e-02 1 1  ON 22
  eO_3                 1.870633e-01 1 1  ON 23
  eO_4                 2.613830e-01 1 1  ON 24
  eO_5                 2.856721e-01 1 1  ON 25
  eO_6                 2.498736e-01 1 1  ON 26
  eO_7                 1.252732e-01 1 1  ON 27
  eO_8                 2.849694e-02 1 1  ON 28
  eO_9                 1.896047e-02 1 1  ON 29
 eH1_0                -2.018801e-01 1 1  ON 30
 eH1_1                -9.762599e-02 1 1  ON 31
 eH1_2                -4.695984e-02 1 1  ON 32
 eH1_3                -1.560083e-02 1 1  ON 33
 eH1_4                 1.885069e-02 1 1  ON 34
 eH1_5                 2.620966e-02 1 1  ON 35
 eH1_6                 7.491316e-02 1 1  ON 36
 eH1_7                 1.041059e-01 1 1  ON 37
 eH1_8                 9.703597e-02 1 1  ON 38
 eH1_9                 2.520290e-02 1 1  ON 39
 eH2_0                -2.031276e-01 1 1  ON 40
 eH2_1                -9.994650e-02 1 1  ON 41
 eH2_2                -4.927350e-02 1 1  ON 42
 eH2_3                -1.790999e-02 1 1  ON 43
 eH2_4                 1.638177e-02 1 1  ON 44
 eH2_5                 2.331667e-02 1 1  ON 45
 eH2_6                 7.777261e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.970957e-02 1 1  ON 48
 eH2_9                 2.792561e-02 1 1  ON 49
ci_001                -4.261674e-02 3 1  ON 50
ci_002                -3.174172e-02 3 1  ON 51
ci_003                -1.241321e-02 3 1  ON 52
ci_004                 2.578182e-02 3 1  ON 53
ci_005                 2.603783e-02 3 1  ON 54
ci_006                -2.086976e-02 3 1  ON 55
ci_007                -2.067557e-02 3 1  ON 56
ci_008                -5.063861e-03 3 1  ON 57
ci_009                -1.563201e-02 3 1  ON 58
ci_010                -1.049547e-02 3 1  ON 59
ci_011                -1.040991e-02 3 1  ON 60
ci_012                -1.050652e-02 3 1  ON 61
ci_013                -2.150596e-02 3 1  ON 62
ci_014                 1.374551e-02 3 1  ON 63
ci_015                 1.357500e-02 3 1  ON 64
ci_016                 1.685279e-02 3 1  ON 65
ci_017                 1.606453e-02 3 1  ON 66
ci_018                 1.116380e-02 3 1  ON 67
ci_019                 1.083119e-02 3 1  ON 68
ci_020                 1.815778e-02 3 1  ON 69
ci_021                 1.790903e-02 3 1  ON 70
ci_022                 1.041000e-02 3 1  ON 71
ci_023                 1.092528e-02 3 1  ON 72
ci_024                 7.124323e-03 3 1  ON 73
ci_025                 7.214491e-03 3 1  ON 74
ci_026                 1.196674e-02 3 1  ON 75
ci_027                 1.214383e-02 3 1  ON 76
ci_028                -1.010262e-02 3 1  ON 77
ci_029                -9.846976e-03 3 1  ON 78
ci_030                -4.814053e-03 3 1  ON 79
ci_031                -5.117924e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.0989
    reference variance = 0.20201
====================================================
  Execution time = 3.7400e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0087e-01
  Total weights = 1.9739e+06
  Execution time = 3.1373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291598521977
                                         uncertainty =       0.002102490252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291598521977
                                         uncertainty =       0.002102490252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381803095
  error estimate for blocks of size 2^( 2) =       0.000396804293
  error estimate for blocks of size 2^( 3) =       0.000410188539
  error estimate for blocks of size 2^( 4) =       0.000419931981
  error estimate for blocks of size 2^( 5) =       0.000425307628
  error estimate for blocks of size 2^( 6) =       0.000426621106
  error estimate for blocks of size 2^( 7) =       0.000426125019

      target function =      -0.911391191993
              le_mean =     -17.207246427285
             les_mean =     296.390199039056
             stat err =       0.000424496433
             autocorr =       1.236144391211
   target nu stat err =       0.000424496433
   target dn stat err =       0.002551360390
      target stat err =       0.003997877087
              std dev =       0.539951114727
             le_variance =       0.291547206295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291598475836
                                         uncertainty =       0.002102484976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291598475836
                                         uncertainty =       0.002102484976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381803065
  error estimate for blocks of size 2^( 2) =       0.000396804298
  error estimate for blocks of size 2^( 3) =       0.000410188580
  error estimate for blocks of size 2^( 4) =       0.000419932047
  error estimate for blocks of size 2^( 5) =       0.000425307708
  error estimate for blocks of size 2^( 6) =       0.000426621202
  error estimate for blocks of size 2^( 7) =       0.000426125110

      target function =      -0.911391273328
              le_mean =     -17.207246428131
             les_mean =     296.390199015411
             stat err =       0.000424496517
             autocorr =       1.236145071133
   target nu stat err =       0.000424496517
   target dn stat err =       0.002551359554
      target stat err =       0.003997876552
              std dev =       0.539951072117
             le_variance =       0.291547160281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291598498904
                                         uncertainty =       0.002102487614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291598498904
                                         uncertainty =       0.002102487614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381803080
  error estimate for blocks of size 2^( 2) =       0.000396804296
  error estimate for blocks of size 2^( 3) =       0.000410188560
  error estimate for blocks of size 2^( 4) =       0.000419932014
  error estimate for blocks of size 2^( 5) =       0.000425307668
  error estimate for blocks of size 2^( 6) =       0.000426621154
  error estimate for blocks of size 2^( 7) =       0.000426125064

      target function =      -0.911391232722
              le_mean =     -17.207246427708
             les_mean =     296.390199027189
             stat err =       0.000424496475
             autocorr =       1.236144731187
   target nu stat err =       0.000424496475
   target dn stat err =       0.002551359971
      target stat err =       0.003997876818
              std dev =       0.539951093419
             le_variance =       0.291547183285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291598519093
                                         uncertainty =       0.002102489923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291598519093
                                         uncertainty =       0.002102489923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381803093
  error estimate for blocks of size 2^( 2) =       0.000396804294
  error estimate for blocks of size 2^( 3) =       0.000410188542
  error estimate for blocks of size 2^( 4) =       0.000419931985
  error estimate for blocks of size 2^( 5) =       0.000425307633
  error estimate for blocks of size 2^( 6) =       0.000426621112
  error estimate for blocks of size 2^( 7) =       0.000426125025

      target function =      -0.911391197090
              le_mean =     -17.207246427338
             les_mean =     296.390199037568
             stat err =       0.000424496439
             autocorr =       1.236144433709
   target nu stat err =       0.000424496439
   target dn stat err =       0.002551360338
      target stat err =       0.003997877053
              std dev =       0.539951112064
             le_variance =       0.291547203419


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911391191993        initial
     6.1035e+02     6.1035e+03             7.4822e-07        -0.911391273328  <--
     2.4414e+03     2.4414e+04             1.8706e-07        -0.911391232722
     9.7656e+03     9.7656e+04             4.6764e-08        -0.911391197090

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 5.3254e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.087052e-01 1 1  ON 0
  uu_1                 5.166597e-02 1 1  ON 1
  uu_2                -3.940209e-02 1 1  ON 2
  uu_3                -9.291317e-02 1 1  ON 3
  uu_4                -1.239455e-01 1 1  ON 4
  uu_5                -1.319994e-01 1 1  ON 5
  uu_6                -1.137862e-01 1 1  ON 6
  uu_7                -5.392859e-02 1 1  ON 7
  uu_8                 7.179885e-02 1 1  ON 8
  uu_9                 1.240335e-01 1 1  ON 9
  ud_0                 3.081038e-01 1 1  ON 10
  ud_1                 7.810690e-02 1 1  ON 11
  ud_2                -2.402745e-02 1 1  ON 12
  ud_3                -7.733511e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343896e-01 1 1  ON 15
  ud_6                -1.304692e-01 1 1  ON 16
  ud_7                -8.981982e-02 1 1  ON 17
  ud_8                -4.428585e-03 1 1  ON 18
  ud_9                 8.809448e-02 1 1  ON 19
  eO_0                -7.053866e-01 1 1  ON 20
  eO_1                -4.211857e-01 1 1  ON 21
  eO_2                -4.127729e-02 1 1  ON 22
  eO_3                 1.870633e-01 1 1  ON 23
  eO_4                 2.613828e-01 1 1  ON 24
  eO_5                 2.856718e-01 1 1  ON 25
  eO_6                 2.498737e-01 1 1  ON 26
  eO_7                 1.252735e-01 1 1  ON 27
  eO_8                 2.849696e-02 1 1  ON 28
  eO_9                 1.896049e-02 1 1  ON 29
 eH1_0                -2.018801e-01 1 1  ON 30
 eH1_1                -9.762583e-02 1 1  ON 31
 eH1_2                -4.695960e-02 1 1  ON 32
 eH1_3                -1.560062e-02 1 1  ON 33
 eH1_4                 1.885062e-02 1 1  ON 34
 eH1_5                 2.620910e-02 1 1  ON 35
 eH1_6                 7.491294e-02 1 1  ON 36
 eH1_7                 1.041059e-01 1 1  ON 37
 eH1_8                 9.703613e-02 1 1  ON 38
 eH1_9                 2.520293e-02 1 1  ON 39
 eH2_0                -2.031277e-01 1 1  ON 40
 eH2_1                -9.994639e-02 1 1  ON 41
 eH2_2                -4.927326e-02 1 1  ON 42
 eH2_3                -1.790981e-02 1 1  ON 43
 eH2_4                 1.638182e-02 1 1  ON 44
 eH2_5                 2.331659e-02 1 1  ON 45
 eH2_6                 7.777223e-02 1 1  ON 46
 eH2_7                 1.127069e-01 1 1  ON 47
 eH2_8                 9.970971e-02 1 1  ON 48
 eH2_9                 2.792567e-02 1 1  ON 49
ci_001                -4.261661e-02 3 1  ON 50
ci_002                -3.174168e-02 3 1  ON 51
ci_003                -1.241315e-02 3 1  ON 52
ci_004                 2.578179e-02 3 1  ON 53
ci_005                 2.603770e-02 3 1  ON 54
ci_006                -2.086971e-02 3 1  ON 55
ci_007                -2.067545e-02 3 1  ON 56
ci_008                -5.063812e-03 3 1  ON 57
ci_009                -1.563203e-02 3 1  ON 58
ci_010                -1.049551e-02 3 1  ON 59
ci_011                -1.040990e-02 3 1  ON 60
ci_012                -1.050643e-02 3 1  ON 61
ci_013                -2.150601e-02 3 1  ON 62
ci_014                 1.374549e-02 3 1  ON 63
ci_015                 1.357496e-02 3 1  ON 64
ci_016                 1.685277e-02 3 1  ON 65
ci_017                 1.606451e-02 3 1  ON 66
ci_018                 1.116378e-02 3 1  ON 67
ci_019                 1.083120e-02 3 1  ON 68
ci_020                 1.815775e-02 3 1  ON 69
ci_021                 1.790898e-02 3 1  ON 70
ci_022                 1.040996e-02 3 1  ON 71
ci_023                 1.092521e-02 3 1  ON 72
ci_024                 7.124346e-03 3 1  ON 73
ci_025                 7.214585e-03 3 1  ON 74
ci_026                 1.196667e-02 3 1  ON 75
ci_027                 1.214376e-02 3 1  ON 76
ci_028                -1.010252e-02 3 1  ON 77
ci_029                -9.847040e-03 3 1  ON 78
ci_030                -4.814095e-03 3 1  ON 79
ci_031                -5.117946e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0241e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1807
    reference variance = 0.198767
====================================================
  Execution time = 3.9605e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5404e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0255e-01
  Total weights = 1.973824433e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1173e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291147523894
                                         uncertainty =       0.002082897340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291147523894
                                         uncertainty =       0.002082897340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381512701
  error estimate for blocks of size 2^( 2) =       0.000396218308
  error estimate for blocks of size 2^( 3) =       0.000409686856
  error estimate for blocks of size 2^( 4) =       0.000419959817
  error estimate for blocks of size 2^( 5) =       0.000425304406
  error estimate for blocks of size 2^( 6) =       0.000426786871
  error estimate for blocks of size 2^( 7) =       0.000428291119

      target function =      -0.908797499198
              le_mean =     -17.206679228483
             les_mean =     296.372362543522
             stat err =       0.000425085553
             autocorr =       1.241465597723
   target nu stat err =       0.000425085553
   target dn stat err =       0.004052134164
      target stat err =       0.006245638888
              std dev =       0.539540436323
             le_variance =       0.291103882428


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720667922848e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908839412299       residual = 7.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908839626086       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908839683133       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908839695917       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908839702284       residual = 7.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908839705618       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908839707134       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908839712534       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908839714520       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908839718391       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908839721557       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908839721644       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908839726398       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908839727735       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908839728070       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908839727284       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908839727937       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908839728406       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908839728308       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908839728578       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908839728859       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908839728755       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908839728933       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908839729516       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908839729728       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908839729892       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908839730056       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908839730159       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908839730417       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908839730420       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908839730514       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908839730625       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908839730686       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908839730619       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908839730607       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.908839730658       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.908839730686       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.908839730629       residual = 9.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5259e+02 is 2.597035e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908839412299       residual = 7.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908839465765       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908839480031       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908839483228       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908839484820       residual = 7.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908839485655       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908839486035       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908839487384       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908839487882       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908839488848       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908839489641       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908839489664       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908839490850       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908839491184       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908839491267       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908839491071       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908839491235       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908839491352       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908839491326       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908839491395       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908839491463       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908839491439       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908839491484       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908839491630       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908839491687       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908839491724       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908839491762       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908839491790       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908839491855       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908839491854       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908839491877       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908839491905       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908839491923       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908839491903       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908839491903       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.908839491913       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.908839491923       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.908839491909       residual = 8.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.1035e+02 is 6.492754e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908839412299       residual = 7.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908839425667       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908839429233       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908839430033       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908839430429       residual = 7.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908839430641       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908839430731       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908839431072       residual = 6.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908839431196       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908839431432       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908839431639       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908839431640       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908839431938       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908839432023       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908839432047       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908839431995       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908839432034       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908839432067       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908839432059       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908839432072       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908839432092       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908839432085       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908839432097       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908839432132       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908839432145       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908839432157       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908839432155       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908839432182       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908839432187       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908839432187       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908839432186       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908839432201       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908839432223       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908839432204       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908839432198       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.908839432195       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.908839432211       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.908839432205       residual = 8.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e+03 is 1.623199e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.207648 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0843e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.087055e-01 1 1  ON 0
  uu_1                 5.166620e-02 1 1  ON 1
  uu_2                -3.940188e-02 1 1  ON 2
  uu_3                -9.291298e-02 1 1  ON 3
  uu_4                -1.239453e-01 1 1  ON 4
  uu_5                -1.319993e-01 1 1  ON 5
  uu_6                -1.137864e-01 1 1  ON 6
  uu_7                -5.392913e-02 1 1  ON 7
  uu_8                 7.179820e-02 1 1  ON 8
  uu_9                 1.240335e-01 1 1  ON 9
  ud_0                 3.081035e-01 1 1  ON 10
  ud_1                 7.810671e-02 1 1  ON 11
  ud_2                -2.402770e-02 1 1  ON 12
  ud_3                -7.733535e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343893e-01 1 1  ON 15
  ud_6                -1.304687e-01 1 1  ON 16
  ud_7                -8.981934e-02 1 1  ON 17
  ud_8                -4.428786e-03 1 1  ON 18
  ud_9                 8.809424e-02 1 1  ON 19
  eO_0                -7.053865e-01 1 1  ON 20
  eO_1                -4.211857e-01 1 1  ON 21
  eO_2                -4.127717e-02 1 1  ON 22
  eO_3                 1.870632e-01 1 1  ON 23
  eO_4                 2.613823e-01 1 1  ON 24
  eO_5                 2.856715e-01 1 1  ON 25
  eO_6                 2.498739e-01 1 1  ON 26
  eO_7                 1.252739e-01 1 1  ON 27
  eO_8                 2.849702e-02 1 1  ON 28
  eO_9                 1.896051e-02 1 1  ON 29
 eH1_0                -2.018800e-01 1 1  ON 30
 eH1_1                -9.762566e-02 1 1  ON 31
 eH1_2                -4.695930e-02 1 1  ON 32
 eH1_3                -1.560042e-02 1 1  ON 33
 eH1_4                 1.885043e-02 1 1  ON 34
 eH1_5                 2.620854e-02 1 1  ON 35
 eH1_6                 7.491280e-02 1 1  ON 36
 eH1_7                 1.041058e-01 1 1  ON 37
 eH1_8                 9.703631e-02 1 1  ON 38
 eH1_9                 2.520297e-02 1 1  ON 39
 eH2_0                -2.031279e-01 1 1  ON 40
 eH2_1                -9.994621e-02 1 1  ON 41
 eH2_2                -4.927304e-02 1 1  ON 42
 eH2_3                -1.790977e-02 1 1  ON 43
 eH2_4                 1.638173e-02 1 1  ON 44
 eH2_5                 2.331610e-02 1 1  ON 45
 eH2_6                 7.777204e-02 1 1  ON 46
 eH2_7                 1.127070e-01 1 1  ON 47
 eH2_8                 9.971001e-02 1 1  ON 48
 eH2_9                 2.792567e-02 1 1  ON 49
ci_001                -4.261651e-02 3 1  ON 50
ci_002                -3.174142e-02 3 1  ON 51
ci_003                -1.241293e-02 3 1  ON 52
ci_004                 2.578187e-02 3 1  ON 53
ci_005                 2.603771e-02 3 1  ON 54
ci_006                -2.086957e-02 3 1  ON 55
ci_007                -2.067533e-02 3 1  ON 56
ci_008                -5.063701e-03 3 1  ON 57
ci_009                -1.563188e-02 3 1  ON 58
ci_010                -1.049536e-02 3 1  ON 59
ci_011                -1.040979e-02 3 1  ON 60
ci_012                -1.050630e-02 3 1  ON 61
ci_013                -2.150596e-02 3 1  ON 62
ci_014                 1.374545e-02 3 1  ON 63
ci_015                 1.357501e-02 3 1  ON 64
ci_016                 1.685263e-02 3 1  ON 65
ci_017                 1.606456e-02 3 1  ON 66
ci_018                 1.116371e-02 3 1  ON 67
ci_019                 1.083118e-02 3 1  ON 68
ci_020                 1.815769e-02 3 1  ON 69
ci_021                 1.790897e-02 3 1  ON 70
ci_022                 1.041002e-02 3 1  ON 71
ci_023                 1.092499e-02 3 1  ON 72
ci_024                 7.124513e-03 3 1  ON 73
ci_025                 7.214444e-03 3 1  ON 74
ci_026                 1.196654e-02 3 1  ON 75
ci_027                 1.214376e-02 3 1  ON 76
ci_028                -1.010252e-02 3 1  ON 77
ci_029                -9.847019e-03 3 1  ON 78
ci_030                -4.814134e-03 3 1  ON 79
ci_031                -5.117808e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1816
    reference variance = 0.343206
====================================================
  Execution time = 3.7532e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9793e-01
  Total weights = 1.9737e+06
  Execution time = 3.1435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289864188630
                                         uncertainty =       0.002077250140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289864188630
                                         uncertainty =       0.002077250140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380713439
  error estimate for blocks of size 2^( 2) =       0.000395419729
  error estimate for blocks of size 2^( 3) =       0.000408122617
  error estimate for blocks of size 2^( 4) =       0.000418034824
  error estimate for blocks of size 2^( 5) =       0.000424227499
  error estimate for blocks of size 2^( 6) =       0.000426199755
  error estimate for blocks of size 2^( 7) =       0.000429380605

      target function =      -0.915929952413
              le_mean =     -17.207387573712
             les_mean =     296.392122866483
             stat err =       0.000424460671
             autocorr =       1.243021090567
   target nu stat err =       0.000424460671
   target dn stat err =       0.002715692810
      target stat err =       0.004290247859
              std dev =       0.538410108576
             le_variance =       0.289885445017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289864035020
                                         uncertainty =       0.002077244998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289864035020
                                         uncertainty =       0.002077244998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380713339
  error estimate for blocks of size 2^( 2) =       0.000395419793
  error estimate for blocks of size 2^( 3) =       0.000408122830
  error estimate for blocks of size 2^( 4) =       0.000418035147
  error estimate for blocks of size 2^( 5) =       0.000424227923
  error estimate for blocks of size 2^( 6) =       0.000426200227
  error estimate for blocks of size 2^( 7) =       0.000429381048

      target function =      -0.915936729369
              le_mean =     -17.207387567227
             les_mean =     296.392118306805
             stat err =       0.000424461086
             autocorr =       1.243024178558
   target nu stat err =       0.000424461086
   target dn stat err =       0.002714019963
      target stat err =       0.004287742406
              std dev =       0.538409966716
             le_variance =       0.289885292260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289864111759
                                         uncertainty =       0.002077247563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289864111759
                                         uncertainty =       0.002077247563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380713389
  error estimate for blocks of size 2^( 2) =       0.000395419761
  error estimate for blocks of size 2^( 3) =       0.000408122723
  error estimate for blocks of size 2^( 4) =       0.000418034986
  error estimate for blocks of size 2^( 5) =       0.000424227711
  error estimate for blocks of size 2^( 6) =       0.000426199991
  error estimate for blocks of size 2^( 7) =       0.000429380827

      target function =      -0.915933382976
              le_mean =     -17.207387570465
             les_mean =     296.392120559464
             stat err =       0.000424460878
             autocorr =       1.243022635049
   target nu stat err =       0.000424460878
   target dn stat err =       0.002714854650
      target stat err =       0.004288992859
              std dev =       0.538410037585
             le_variance =       0.289885368572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289864179016
                                         uncertainty =       0.002077249818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289864179016
                                         uncertainty =       0.002077249818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380713433
  error estimate for blocks of size 2^( 2) =       0.000395419733
  error estimate for blocks of size 2^( 3) =       0.000408122631
  error estimate for blocks of size 2^( 4) =       0.000418034844
  error estimate for blocks of size 2^( 5) =       0.000424227526
  error estimate for blocks of size 2^( 6) =       0.000426199784
  error estimate for blocks of size 2^( 7) =       0.000429380633

      target function =      -0.915930386851
              le_mean =     -17.207387573306
             les_mean =     296.392122574484
             stat err =       0.000424460697
             autocorr =       1.243021283637
   target nu stat err =       0.000424460697
   target dn stat err =       0.002715587872
      target stat err =       0.004290090778
              std dev =       0.538410099697
             le_variance =       0.289885435456


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915929952413        initial
     1.5259e+02     1.5259e+03             2.5970e-06        -0.915936729369  <--
     6.1035e+02     6.1035e+03             6.4928e-07        -0.915933382976
     2.4414e+03     2.4414e+04             1.6232e-07        -0.915930386851

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 5.3353e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.087061e-01 1 1  ON 0
  uu_1                 5.166689e-02 1 1  ON 1
  uu_2                -3.940124e-02 1 1  ON 2
  uu_3                -9.291239e-02 1 1  ON 3
  uu_4                -1.239449e-01 1 1  ON 4
  uu_5                -1.319990e-01 1 1  ON 5
  uu_6                -1.137870e-01 1 1  ON 6
  uu_7                -5.393074e-02 1 1  ON 7
  uu_8                 7.179625e-02 1 1  ON 8
  uu_9                 1.240335e-01 1 1  ON 9
  ud_0                 3.081026e-01 1 1  ON 10
  ud_1                 7.810614e-02 1 1  ON 11
  ud_2                -2.402847e-02 1 1  ON 12
  ud_3                -7.733607e-02 1 1  ON 13
  ud_4                -1.141471e-01 1 1  ON 14
  ud_5                -1.343885e-01 1 1  ON 15
  ud_6                -1.304673e-01 1 1  ON 16
  ud_7                -8.981790e-02 1 1  ON 17
  ud_8                -4.429390e-03 1 1  ON 18
  ud_9                 8.809352e-02 1 1  ON 19
  eO_0                -7.053863e-01 1 1  ON 20
  eO_1                -4.211858e-01 1 1  ON 21
  eO_2                -4.127681e-02 1 1  ON 22
  eO_3                 1.870630e-01 1 1  ON 23
  eO_4                 2.613810e-01 1 1  ON 24
  eO_5                 2.856704e-01 1 1  ON 25
  eO_6                 2.498745e-01 1 1  ON 26
  eO_7                 1.252752e-01 1 1  ON 27
  eO_8                 2.849717e-02 1 1  ON 28
  eO_9                 1.896056e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762515e-02 1 1  ON 31
 eH1_2                -4.695839e-02 1 1  ON 32
 eH1_3                -1.559980e-02 1 1  ON 33
 eH1_4                 1.884987e-02 1 1  ON 34
 eH1_5                 2.620686e-02 1 1  ON 35
 eH1_6                 7.491237e-02 1 1  ON 36
 eH1_7                 1.041054e-01 1 1  ON 37
 eH1_8                 9.703686e-02 1 1  ON 38
 eH1_9                 2.520309e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994567e-02 1 1  ON 41
 eH2_2                -4.927237e-02 1 1  ON 42
 eH2_3                -1.790964e-02 1 1  ON 43
 eH2_4                 1.638145e-02 1 1  ON 44
 eH2_5                 2.331462e-02 1 1  ON 45
 eH2_6                 7.777145e-02 1 1  ON 46
 eH2_7                 1.127074e-01 1 1  ON 47
 eH2_8                 9.971091e-02 1 1  ON 48
 eH2_9                 2.792569e-02 1 1  ON 49
ci_001                -4.261620e-02 3 1  ON 50
ci_002                -3.174066e-02 3 1  ON 51
ci_003                -1.241225e-02 3 1  ON 52
ci_004                 2.578210e-02 3 1  ON 53
ci_005                 2.603774e-02 3 1  ON 54
ci_006                -2.086915e-02 3 1  ON 55
ci_007                -2.067494e-02 3 1  ON 56
ci_008                -5.063369e-03 3 1  ON 57
ci_009                -1.563144e-02 3 1  ON 58
ci_010                -1.049488e-02 3 1  ON 59
ci_011                -1.040947e-02 3 1  ON 60
ci_012                -1.050593e-02 3 1  ON 61
ci_013                -2.150582e-02 3 1  ON 62
ci_014                 1.374533e-02 3 1  ON 63
ci_015                 1.357517e-02 3 1  ON 64
ci_016                 1.685219e-02 3 1  ON 65
ci_017                 1.606468e-02 3 1  ON 66
ci_018                 1.116352e-02 3 1  ON 67
ci_019                 1.083111e-02 3 1  ON 68
ci_020                 1.815752e-02 3 1  ON 69
ci_021                 1.790894e-02 3 1  ON 70
ci_022                 1.041020e-02 3 1  ON 71
ci_023                 1.092431e-02 3 1  ON 72
ci_024                 7.125015e-03 3 1  ON 73
ci_025                 7.214022e-03 3 1  ON 74
ci_026                 1.196615e-02 3 1  ON 75
ci_027                 1.214378e-02 3 1  ON 76
ci_028                -1.010252e-02 3 1  ON 77
ci_029                -9.846956e-03 3 1  ON 78
ci_030                -4.814250e-03 3 1  ON 79
ci_031                -5.117396e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0420e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2287
    reference variance = 0.441219
====================================================
  Execution time = 3.8474e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5442e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0156e-01
  Total weights = 1.973714229e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0788e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292638887841
                                         uncertainty =       0.002560686103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292638887841
                                         uncertainty =       0.002560686103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382491874
  error estimate for blocks of size 2^( 2) =       0.000397306070
  error estimate for blocks of size 2^( 3) =       0.000410613716
  error estimate for blocks of size 2^( 4) =       0.000420459197
  error estimate for blocks of size 2^( 5) =       0.000427140566
  error estimate for blocks of size 2^( 6) =       0.000430979795
  error estimate for blocks of size 2^( 7) =       0.000432964673

      target function =      -0.910311080904
              le_mean =     -17.207051411262
             les_mean =     296.384182188346
             stat err =       0.000427886058
             autocorr =       1.251445225151
   target nu stat err =       0.000427886058
   target dn stat err =       0.003615542181
      target stat err =       0.005604961439
              std dev =       0.540925195362
             le_variance =       0.292600066977


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720705141126e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910344202580       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910345515069       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910345973550       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910346032656       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910346133439       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910346214037       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910346296675       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910346323221       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910346373461       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910346394328       residual = 9.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910346418493       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910346435367       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910346455644       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910346460374       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910346470851       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910346471269       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910346472475       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910346476948       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910346476356       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910346482682       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910346486358       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910346493006       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910346494111       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910346496109       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910346498626       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910346496720       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910346496664       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910346498735       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910346500081       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910346499634       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910346500341       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910346501057       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910346501353       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910346501152       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910346501056       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910346501688       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.910346501615       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.910346501376       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.910346501146       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.910346501217       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.8147e+01 is 1.611035e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910344202580       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910344531208       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910344645962       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910344660761       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910344685985       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910344706187       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910344726931       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910344733555       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910344746154       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910344751259       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910344757318       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910344761532       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910344766605       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910344767788       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910344770406       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910344770508       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910344770808       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910344771925       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910344771779       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910344773362       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910344774281       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910344775942       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910344776216       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910344776714       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910344777341       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910344776867       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910344776852       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910344777369       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910344777705       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910344777592       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910344777769       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910344777949       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910344778022       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910344777971       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910344777948       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910344778106       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.910344778088       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.910344778028       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.910344777971       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.910344777988       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5259e+02 is 4.031292e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910344202580       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910344284769       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910344313466       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910344317166       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910344323474       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910344328528       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910344333719       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910344335376       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910344338528       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910344339796       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910344341311       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910344342366       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910344343632       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910344343931       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910344344583       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910344344609       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910344344682       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910344344963       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910344344926       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910344345321       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910344345554       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910344345966       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910344346036       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910344346160       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910344346318       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910344346199       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910344346196       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910344346324       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910344346410       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910344346381       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910344346423       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910344346469       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910344346483       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910344346472       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910344346467       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910344346509       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.910344346504       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.910344346488       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.910344346474       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.910344346480       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.1035e+02 is 1.008055e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.273669 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9335e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.087079e-01 1 1  ON 0
  uu_1                 5.166886e-02 1 1  ON 1
  uu_2                -3.939935e-02 1 1  ON 2
  uu_3                -9.291084e-02 1 1  ON 3
  uu_4                -1.239441e-01 1 1  ON 4
  uu_5                -1.319992e-01 1 1  ON 5
  uu_6                -1.137895e-01 1 1  ON 6
  uu_7                -5.393313e-02 1 1  ON 7
  uu_8                 7.179265e-02 1 1  ON 8
  uu_9                 1.240333e-01 1 1  ON 9
  ud_0                 3.080994e-01 1 1  ON 10
  ud_1                 7.810385e-02 1 1  ON 11
  ud_2                -2.403024e-02 1 1  ON 12
  ud_3                -7.733729e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343864e-01 1 1  ON 15
  ud_6                -1.304633e-01 1 1  ON 16
  ud_7                -8.981523e-02 1 1  ON 17
  ud_8                -4.430005e-03 1 1  ON 18
  ud_9                 8.809294e-02 1 1  ON 19
  eO_0                -7.053846e-01 1 1  ON 20
  eO_1                -4.211851e-01 1 1  ON 21
  eO_2                -4.127755e-02 1 1  ON 22
  eO_3                 1.870604e-01 1 1  ON 23
  eO_4                 2.613781e-01 1 1  ON 24
  eO_5                 2.856721e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252765e-01 1 1  ON 27
  eO_8                 2.849728e-02 1 1  ON 28
  eO_9                 1.896066e-02 1 1  ON 29
 eH1_0                -2.018790e-01 1 1  ON 30
 eH1_1                -9.762376e-02 1 1  ON 31
 eH1_2                -4.695668e-02 1 1  ON 32
 eH1_3                -1.559859e-02 1 1  ON 33
 eH1_4                 1.885005e-02 1 1  ON 34
 eH1_5                 2.620423e-02 1 1  ON 35
 eH1_6                 7.491013e-02 1 1  ON 36
 eH1_7                 1.041045e-01 1 1  ON 37
 eH1_8                 9.703725e-02 1 1  ON 38
 eH1_9                 2.520324e-02 1 1  ON 39
 eH2_0                -2.031301e-01 1 1  ON 40
 eH2_1                -9.994697e-02 1 1  ON 41
 eH2_2                -4.927276e-02 1 1  ON 42
 eH2_3                -1.791043e-02 1 1  ON 43
 eH2_4                 1.638134e-02 1 1  ON 44
 eH2_5                 2.331459e-02 1 1  ON 45
 eH2_6                 7.777449e-02 1 1  ON 46
 eH2_7                 1.127080e-01 1 1  ON 47
 eH2_8                 9.971159e-02 1 1  ON 48
 eH2_9                 2.792594e-02 1 1  ON 49
ci_001                -4.261640e-02 3 1  ON 50
ci_002                -3.174009e-02 3 1  ON 51
ci_003                -1.241310e-02 3 1  ON 52
ci_004                 2.578195e-02 3 1  ON 53
ci_005                 2.603759e-02 3 1  ON 54
ci_006                -2.086881e-02 3 1  ON 55
ci_007                -2.067452e-02 3 1  ON 56
ci_008                -5.062463e-03 3 1  ON 57
ci_009                -1.563071e-02 3 1  ON 58
ci_010                -1.049335e-02 3 1  ON 59
ci_011                -1.041034e-02 3 1  ON 60
ci_012                -1.050506e-02 3 1  ON 61
ci_013                -2.150567e-02 3 1  ON 62
ci_014                 1.374510e-02 3 1  ON 63
ci_015                 1.357474e-02 3 1  ON 64
ci_016                 1.685141e-02 3 1  ON 65
ci_017                 1.606506e-02 3 1  ON 66
ci_018                 1.116321e-02 3 1  ON 67
ci_019                 1.083148e-02 3 1  ON 68
ci_020                 1.815808e-02 3 1  ON 69
ci_021                 1.790885e-02 3 1  ON 70
ci_022                 1.041030e-02 3 1  ON 71
ci_023                 1.092448e-02 3 1  ON 72
ci_024                 7.125652e-03 3 1  ON 73
ci_025                 7.213653e-03 3 1  ON 74
ci_026                 1.196608e-02 3 1  ON 75
ci_027                 1.214344e-02 3 1  ON 76
ci_028                -1.010208e-02 3 1  ON 77
ci_029                -9.847062e-03 3 1  ON 78
ci_030                -4.814378e-03 3 1  ON 79
ci_031                -5.117673e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.193
    reference variance = 0.113131
====================================================
  Execution time = 3.7488e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0293e-01
  Total weights = 1.9738e+06
  Execution time = 3.1449e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293174041704
                                         uncertainty =       0.002329887761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293174041704
                                         uncertainty =       0.002329887761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382919340
  error estimate for blocks of size 2^( 2) =       0.000397728598
  error estimate for blocks of size 2^( 3) =       0.000411156803
  error estimate for blocks of size 2^( 4) =       0.000421277608
  error estimate for blocks of size 2^( 5) =       0.000427187761
  error estimate for blocks of size 2^( 6) =       0.000430181135
  error estimate for blocks of size 2^( 7) =       0.000432369743

      target function =      -0.908232594388
              le_mean =     -17.206736678064
             les_mean =     296.374716464044
             stat err =       0.000427754062
             autocorr =       1.247882462334
   target nu stat err =       0.000427754062
   target dn stat err =       0.003334579187
      target stat err =       0.005150490141
              std dev =       0.541529723824
             le_variance =       0.293254441785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293176814498
                                         uncertainty =       0.002330558933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293176814498
                                         uncertainty =       0.002330558933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382921143
  error estimate for blocks of size 2^( 2) =       0.000397731321
  error estimate for blocks of size 2^( 3) =       0.000411160429
  error estimate for blocks of size 2^( 4) =       0.000421281911
  error estimate for blocks of size 2^( 5) =       0.000427192623
  error estimate for blocks of size 2^( 6) =       0.000430186213
  error estimate for blocks of size 2^( 7) =       0.000432374575

      target function =      -0.908210420820
              le_mean =     -17.206736590614
             les_mean =     296.374727902141
             stat err =       0.000427758830
             autocorr =       1.247898531955
   target nu stat err =       0.000427758830
   target dn stat err =       0.003339419822
      target stat err =       0.005157572071
              std dev =       0.541532273826
             le_variance =       0.293257203595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293175425438
                                         uncertainty =       0.002330222513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293175425438
                                         uncertainty =       0.002330222513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382920240
  error estimate for blocks of size 2^( 2) =       0.000397729958
  error estimate for blocks of size 2^( 3) =       0.000411158616
  error estimate for blocks of size 2^( 4) =       0.000421279759
  error estimate for blocks of size 2^( 5) =       0.000427190192
  error estimate for blocks of size 2^( 6) =       0.000430183675
  error estimate for blocks of size 2^( 7) =       0.000432372159

      target function =      -0.908221581982
              le_mean =     -17.206736634213
             les_mean =     296.374722130118
             stat err =       0.000427756446
             autocorr =       1.247890510059
   target nu stat err =       0.000427756446
   target dn stat err =       0.003336992427
      target stat err =       0.005154021287
              std dev =       0.541530996372
             le_variance =       0.293255820031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293174214246
                                         uncertainty =       0.002329929481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293174214246
                                         uncertainty =       0.002329929481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382919452
  error estimate for blocks of size 2^( 2) =       0.000397728767
  error estimate for blocks of size 2^( 3) =       0.000411157029
  error estimate for blocks of size 2^( 4) =       0.000421277877
  error estimate for blocks of size 2^( 5) =       0.000427188065
  error estimate for blocks of size 2^( 6) =       0.000430181453
  error estimate for blocks of size 2^( 7) =       0.000432370045

      target function =      -0.908231227073
              le_mean =     -17.206736672573
             les_mean =     296.374717165941
             stat err =       0.000427754360
             autocorr =       1.247883468940
   target nu stat err =       0.000427754360
   target dn stat err =       0.003334879824
      target stat err =       0.005150930104
              std dev =       0.541529882502
             le_variance =       0.293254613642


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908232594388        initial  <--
     3.8147e+01     3.8147e+02             1.6110e-05        -0.908210420820
     1.5259e+02     1.5259e+03             4.0313e-06        -0.908221581982
     6.1035e+02     6.1035e+03             1.0081e-06        -0.908231227073

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.3026
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.087061e-01 1 1  ON 0
  uu_1                 5.166689e-02 1 1  ON 1
  uu_2                -3.940124e-02 1 1  ON 2
  uu_3                -9.291239e-02 1 1  ON 3
  uu_4                -1.239449e-01 1 1  ON 4
  uu_5                -1.319990e-01 1 1  ON 5
  uu_6                -1.137870e-01 1 1  ON 6
  uu_7                -5.393074e-02 1 1  ON 7
  uu_8                 7.179625e-02 1 1  ON 8
  uu_9                 1.240335e-01 1 1  ON 9
  ud_0                 3.081026e-01 1 1  ON 10
  ud_1                 7.810614e-02 1 1  ON 11
  ud_2                -2.402847e-02 1 1  ON 12
  ud_3                -7.733607e-02 1 1  ON 13
  ud_4                -1.141471e-01 1 1  ON 14
  ud_5                -1.343885e-01 1 1  ON 15
  ud_6                -1.304673e-01 1 1  ON 16
  ud_7                -8.981790e-02 1 1  ON 17
  ud_8                -4.429390e-03 1 1  ON 18
  ud_9                 8.809352e-02 1 1  ON 19
  eO_0                -7.053863e-01 1 1  ON 20
  eO_1                -4.211858e-01 1 1  ON 21
  eO_2                -4.127681e-02 1 1  ON 22
  eO_3                 1.870630e-01 1 1  ON 23
  eO_4                 2.613810e-01 1 1  ON 24
  eO_5                 2.856704e-01 1 1  ON 25
  eO_6                 2.498745e-01 1 1  ON 26
  eO_7                 1.252752e-01 1 1  ON 27
  eO_8                 2.849717e-02 1 1  ON 28
  eO_9                 1.896056e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762515e-02 1 1  ON 31
 eH1_2                -4.695839e-02 1 1  ON 32
 eH1_3                -1.559980e-02 1 1  ON 33
 eH1_4                 1.884987e-02 1 1  ON 34
 eH1_5                 2.620686e-02 1 1  ON 35
 eH1_6                 7.491237e-02 1 1  ON 36
 eH1_7                 1.041054e-01 1 1  ON 37
 eH1_8                 9.703686e-02 1 1  ON 38
 eH1_9                 2.520309e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994567e-02 1 1  ON 41
 eH2_2                -4.927237e-02 1 1  ON 42
 eH2_3                -1.790964e-02 1 1  ON 43
 eH2_4                 1.638145e-02 1 1  ON 44
 eH2_5                 2.331462e-02 1 1  ON 45
 eH2_6                 7.777145e-02 1 1  ON 46
 eH2_7                 1.127074e-01 1 1  ON 47
 eH2_8                 9.971091e-02 1 1  ON 48
 eH2_9                 2.792569e-02 1 1  ON 49
ci_001                -4.261620e-02 3 1  ON 50
ci_002                -3.174066e-02 3 1  ON 51
ci_003                -1.241225e-02 3 1  ON 52
ci_004                 2.578210e-02 3 1  ON 53
ci_005                 2.603774e-02 3 1  ON 54
ci_006                -2.086915e-02 3 1  ON 55
ci_007                -2.067494e-02 3 1  ON 56
ci_008                -5.063369e-03 3 1  ON 57
ci_009                -1.563144e-02 3 1  ON 58
ci_010                -1.049488e-02 3 1  ON 59
ci_011                -1.040947e-02 3 1  ON 60
ci_012                -1.050593e-02 3 1  ON 61
ci_013                -2.150582e-02 3 1  ON 62
ci_014                 1.374533e-02 3 1  ON 63
ci_015                 1.357517e-02 3 1  ON 64
ci_016                 1.685219e-02 3 1  ON 65
ci_017                 1.606468e-02 3 1  ON 66
ci_018                 1.116352e-02 3 1  ON 67
ci_019                 1.083111e-02 3 1  ON 68
ci_020                 1.815752e-02 3 1  ON 69
ci_021                 1.790894e-02 3 1  ON 70
ci_022                 1.041020e-02 3 1  ON 71
ci_023                 1.092431e-02 3 1  ON 72
ci_024                 7.125015e-03 3 1  ON 73
ci_025                 7.214022e-03 3 1  ON 74
ci_026                 1.196615e-02 3 1  ON 75
ci_027                 1.214378e-02 3 1  ON 76
ci_028                -1.010252e-02 3 1  ON 77
ci_029                -9.846956e-03 3 1  ON 78
ci_030                -4.814250e-03 3 1  ON 79
ci_031                -5.117396e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0264e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1728
    reference variance = 0.255299
====================================================
  Execution time = 3.7805e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5426e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9872e-01
  Total weights = 1.974003776e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1065e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291770545886
                                         uncertainty =       0.002004259368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291770545886
                                         uncertainty =       0.002004259368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382005546
  error estimate for blocks of size 2^( 2) =       0.000397353966
  error estimate for blocks of size 2^( 3) =       0.000411252156
  error estimate for blocks of size 2^( 4) =       0.000421347858
  error estimate for blocks of size 2^( 5) =       0.000428537516
  error estimate for blocks of size 2^( 6) =       0.000432096782
  error estimate for blocks of size 2^( 7) =       0.000431455129

      target function =      -0.914713047147
              le_mean =     -17.207385839683
             les_mean =     296.392849065902
             stat err =       0.000428359321
             autocorr =       1.257410570299
   target nu stat err =       0.000428359321
   target dn stat err =       0.002331622725
      target stat err =       0.003693651475
              std dev =       0.540237424201
             le_variance =       0.291856474507


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720738583968e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914726886409       residual = 3.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914726938453       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914726949880       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914726953841       residual = 9.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914726956251       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914726955879       residual = 9.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914726958335       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914726959644       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914726959539       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914726959523       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914726960401       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914726960658       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914726961114       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914726962185       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914726962267       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914726962458       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914726962688       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914726963055       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914726962871       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914726963039       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914726963225       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914726963334       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914726963210       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914726963333       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914726963353       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914726963331       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914726963357       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914726963354       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914726963405       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914726963428       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914726963463       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914726963485       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914726963527       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914726963500       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914726963508       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914726963494       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914726963484       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914726963506       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.8147e+02 is 1.008854e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914726886409       residual = 3.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914726899422       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914726902279       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914726903269       residual = 9.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914726903872       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914726903778       residual = 9.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914726904393       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914726904720       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914726904694       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914726904690       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914726904910       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914726904974       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914726905083       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914726905355       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914726905376       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914726905424       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914726905481       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914726905572       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914726905531       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914726905570       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914726905616       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914726905648       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914726905614       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914726905645       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914726905648       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914726905641       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914726905644       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914726905645       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914726905657       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914726905668       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914726905680       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914726905678       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914726905695       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914726905681       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914726905687       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914726905690       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914726905677       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914726905682       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5259e+03 is 2.522172e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914726886409       residual = 3.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914726889662       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914726890377       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914726890624       residual = 9.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914726890775       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914726890751       residual = 9.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914726890905       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914726890987       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914726890980       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914726890979       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914726891034       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914726891050       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914726891067       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914726891146       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914726891152       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914726891160       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914726891180       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914726891194       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914726891209       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914726891206       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914726891223       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914726891192       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914726891196       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914726891220       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914726891228       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914726891219       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914726891217       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914726891228       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914726891200       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914726891220       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914726891221       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914726891229       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914726891223       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914726891230       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914726891232       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914726891232       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914726891196       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914726891232       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.1035e+03 is 6.305454e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.331058 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8934e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.087061e-01 1 1  ON 0
  uu_1                 5.166689e-02 1 1  ON 1
  uu_2                -3.940123e-02 1 1  ON 2
  uu_3                -9.291237e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137869e-01 1 1  ON 6
  uu_7                -5.393084e-02 1 1  ON 7
  uu_8                 7.179600e-02 1 1  ON 8
  uu_9                 1.240336e-01 1 1  ON 9
  ud_0                 3.081024e-01 1 1  ON 10
  ud_1                 7.810600e-02 1 1  ON 11
  ud_2                -2.402858e-02 1 1  ON 12
  ud_3                -7.733615e-02 1 1  ON 13
  ud_4                -1.141471e-01 1 1  ON 14
  ud_5                -1.343884e-01 1 1  ON 15
  ud_6                -1.304672e-01 1 1  ON 16
  ud_7                -8.981777e-02 1 1  ON 17
  ud_8                -4.429411e-03 1 1  ON 18
  ud_9                 8.809352e-02 1 1  ON 19
  eO_0                -7.053861e-01 1 1  ON 20
  eO_1                -4.211857e-01 1 1  ON 21
  eO_2                -4.127684e-02 1 1  ON 22
  eO_3                 1.870629e-01 1 1  ON 23
  eO_4                 2.613808e-01 1 1  ON 24
  eO_5                 2.856702e-01 1 1  ON 25
  eO_6                 2.498745e-01 1 1  ON 26
  eO_7                 1.252753e-01 1 1  ON 27
  eO_8                 2.849718e-02 1 1  ON 28
  eO_9                 1.896060e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762511e-02 1 1  ON 31
 eH1_2                -4.695838e-02 1 1  ON 32
 eH1_3                -1.559985e-02 1 1  ON 33
 eH1_4                 1.884976e-02 1 1  ON 34
 eH1_5                 2.620683e-02 1 1  ON 35
 eH1_6                 7.491236e-02 1 1  ON 36
 eH1_7                 1.041054e-01 1 1  ON 37
 eH1_8                 9.703691e-02 1 1  ON 38
 eH1_9                 2.520313e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994561e-02 1 1  ON 41
 eH2_2                -4.927230e-02 1 1  ON 42
 eH2_3                -1.790956e-02 1 1  ON 43
 eH2_4                 1.638148e-02 1 1  ON 44
 eH2_5                 2.331451e-02 1 1  ON 45
 eH2_6                 7.777128e-02 1 1  ON 46
 eH2_7                 1.127073e-01 1 1  ON 47
 eH2_8                 9.971103e-02 1 1  ON 48
 eH2_9                 2.792572e-02 1 1  ON 49
ci_001                -4.261620e-02 3 1  ON 50
ci_002                -3.174062e-02 3 1  ON 51
ci_003                -1.241224e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603770e-02 3 1  ON 54
ci_006                -2.086917e-02 3 1  ON 55
ci_007                -2.067495e-02 3 1  ON 56
ci_008                -5.063341e-03 3 1  ON 57
ci_009                -1.563144e-02 3 1  ON 58
ci_010                -1.049483e-02 3 1  ON 59
ci_011                -1.040947e-02 3 1  ON 60
ci_012                -1.050595e-02 3 1  ON 61
ci_013                -2.150583e-02 3 1  ON 62
ci_014                 1.374533e-02 3 1  ON 63
ci_015                 1.357505e-02 3 1  ON 64
ci_016                 1.685217e-02 3 1  ON 65
ci_017                 1.606470e-02 3 1  ON 66
ci_018                 1.116350e-02 3 1  ON 67
ci_019                 1.083110e-02 3 1  ON 68
ci_020                 1.815746e-02 3 1  ON 69
ci_021                 1.790892e-02 3 1  ON 70
ci_022                 1.041019e-02 3 1  ON 71
ci_023                 1.092425e-02 3 1  ON 72
ci_024                 7.124989e-03 3 1  ON 73
ci_025                 7.214021e-03 3 1  ON 74
ci_026                 1.196615e-02 3 1  ON 75
ci_027                 1.214382e-02 3 1  ON 76
ci_028                -1.010250e-02 3 1  ON 77
ci_029                -9.846931e-03 3 1  ON 78
ci_030                -4.814244e-03 3 1  ON 79
ci_031                -5.117374e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2513
    reference variance = 0.269212
====================================================
  Execution time = 3.7553e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9738e-01
  Total weights = 1.9737e+06
  Execution time = 3.1376e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290726357429
                                         uncertainty =       0.001639118130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290726357429
                                         uncertainty =       0.001639118130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381290370
  error estimate for blocks of size 2^( 2) =       0.000396234209
  error estimate for blocks of size 2^( 3) =       0.000409578556
  error estimate for blocks of size 2^( 4) =       0.000418725680
  error estimate for blocks of size 2^( 5) =       0.000424135581
  error estimate for blocks of size 2^( 6) =       0.000426239790
  error estimate for blocks of size 2^( 7) =       0.000428213446

      target function =      -0.916826506035
              le_mean =     -17.206606383078
             les_mean =     296.364678547828
             stat err =       0.000424328624
             autocorr =       1.238491368868
   target nu stat err =       0.000424328624
   target dn stat err =       0.002110644336
      target stat err =       0.003366655534
              std dev =       0.539226012944
             le_variance =       0.290764693036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290726266216
                                         uncertainty =       0.001639119862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290726266216
                                         uncertainty =       0.001639119862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381290310
  error estimate for blocks of size 2^( 2) =       0.000396234208
  error estimate for blocks of size 2^( 3) =       0.000409578612
  error estimate for blocks of size 2^( 4) =       0.000418725781
  error estimate for blocks of size 2^( 5) =       0.000424135703
  error estimate for blocks of size 2^( 6) =       0.000426239913
  error estimate for blocks of size 2^( 7) =       0.000428213563

      target function =      -0.916826793370
              le_mean =     -17.206606386081
             les_mean =     296.364678466702
             stat err =       0.000424328740
             autocorr =       1.238492434179
   target nu stat err =       0.000424328740
   target dn stat err =       0.002110643976
      target stat err =       0.003366657110
              std dev =       0.539225928000
             le_variance =       0.290764601427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290726311814
                                         uncertainty =       0.001639118996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290726311814
                                         uncertainty =       0.001639118996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381290340
  error estimate for blocks of size 2^( 2) =       0.000396234209
  error estimate for blocks of size 2^( 3) =       0.000409578584
  error estimate for blocks of size 2^( 4) =       0.000418725730
  error estimate for blocks of size 2^( 5) =       0.000424135642
  error estimate for blocks of size 2^( 6) =       0.000426239852
  error estimate for blocks of size 2^( 7) =       0.000428213505

      target function =      -0.916826649758
              le_mean =     -17.206606384579
             les_mean =     296.364678507221
             stat err =       0.000424328682
             autocorr =       1.238491901580
   target nu stat err =       0.000424328682
   target dn stat err =       0.002110644155
      target stat err =       0.003366656320
              std dev =       0.539225970464
             le_variance =       0.290764647222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290726351727
                                         uncertainty =       0.001639118238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290726351727
                                         uncertainty =       0.001639118238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381290367
  error estimate for blocks of size 2^( 2) =       0.000396234209
  error estimate for blocks of size 2^( 3) =       0.000409578559
  error estimate for blocks of size 2^( 4) =       0.000418725686
  error estimate for blocks of size 2^( 5) =       0.000424135588
  error estimate for blocks of size 2^( 6) =       0.000426239798
  error estimate for blocks of size 2^( 7) =       0.000428213454

      target function =      -0.916826524005
              le_mean =     -17.206606383266
             les_mean =     296.364678542748
             stat err =       0.000424328631
             autocorr =       1.238491435464
   target nu stat err =       0.000424328631
   target dn stat err =       0.002110644313
      target stat err =       0.003366655632
              std dev =       0.539226007634
             le_variance =       0.290764687308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916826506035        initial
     3.8147e+02     3.8147e+03             1.0089e-06        -0.916826793370  <--
     1.5259e+03     1.5259e+04             2.5222e-07        -0.916826649758
     6.1035e+03     6.1035e+04             6.3055e-08        -0.916826524005

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 5.3309e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166690e-02 1 1  ON 1
  uu_2                -3.940118e-02 1 1  ON 2
  uu_3                -9.291231e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393115e-02 1 1  ON 7
  uu_8                 7.179524e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810561e-02 1 1  ON 11
  ud_2                -2.402889e-02 1 1  ON 12
  ud_3                -7.733640e-02 1 1  ON 13
  ud_4                -1.141472e-01 1 1  ON 14
  ud_5                -1.343883e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981740e-02 1 1  ON 17
  ud_8                -4.429476e-03 1 1  ON 18
  ud_9                 8.809354e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127693e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856698e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849720e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762498e-02 1 1  ON 31
 eH1_2                -4.695835e-02 1 1  ON 32
 eH1_3                -1.559999e-02 1 1  ON 33
 eH1_4                 1.884943e-02 1 1  ON 34
 eH1_5                 2.620673e-02 1 1  ON 35
 eH1_6                 7.491236e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703706e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994542e-02 1 1  ON 41
 eH2_2                -4.927211e-02 1 1  ON 42
 eH2_3                -1.790933e-02 1 1  ON 43
 eH2_4                 1.638158e-02 1 1  ON 44
 eH2_5                 2.331419e-02 1 1  ON 45
 eH2_6                 7.777076e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.971140e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261621e-02 3 1  ON 50
ci_002                -3.174051e-02 3 1  ON 51
ci_003                -1.241220e-02 3 1  ON 52
ci_004                 2.578194e-02 3 1  ON 53
ci_005                 2.603760e-02 3 1  ON 54
ci_006                -2.086923e-02 3 1  ON 55
ci_007                -2.067499e-02 3 1  ON 56
ci_008                -5.063257e-03 3 1  ON 57
ci_009                -1.563144e-02 3 1  ON 58
ci_010                -1.049465e-02 3 1  ON 59
ci_011                -1.040947e-02 3 1  ON 60
ci_012                -1.050598e-02 3 1  ON 61
ci_013                -2.150588e-02 3 1  ON 62
ci_014                 1.374531e-02 3 1  ON 63
ci_015                 1.357468e-02 3 1  ON 64
ci_016                 1.685213e-02 3 1  ON 65
ci_017                 1.606474e-02 3 1  ON 66
ci_018                 1.116342e-02 3 1  ON 67
ci_019                 1.083106e-02 3 1  ON 68
ci_020                 1.815731e-02 3 1  ON 69
ci_021                 1.790886e-02 3 1  ON 70
ci_022                 1.041015e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124911e-03 3 1  ON 73
ci_025                 7.214019e-03 3 1  ON 74
ci_026                 1.196615e-02 3 1  ON 75
ci_027                 1.214393e-02 3 1  ON 76
ci_028                -1.010244e-02 3 1  ON 77
ci_029                -9.846857e-03 3 1  ON 78
ci_030                -4.814225e-03 3 1  ON 79
ci_031                -5.117306e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0225e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1688
    reference variance = 0.212046
====================================================
  Execution time = 3.9081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5419e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9588e-01
  Total weights = 1.973719600e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0797e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289058088532
                                         uncertainty =       0.001633400396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289058088532
                                         uncertainty =       0.001633400396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380129409
  error estimate for blocks of size 2^( 2) =       0.000394864399
  error estimate for blocks of size 2^( 3) =       0.000408373441
  error estimate for blocks of size 2^( 4) =       0.000418545557
  error estimate for blocks of size 2^( 5) =       0.000423053198
  error estimate for blocks of size 2^( 6) =       0.000425194328
  error estimate for blocks of size 2^( 7) =       0.000427630866

      target function =      -0.919165392380
              le_mean =     -17.206558453258
             les_mean =     296.361532099095
             stat err =       0.000423605987
             autocorr =       1.241827402216
   target nu stat err =       0.000423605987
   target dn stat err =       0.002120907659
      target stat err =       0.003398600364
              std dev =       0.537584165921
             le_variance =       0.288996735449


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720655845326e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919177002684       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919177210063       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919177263195       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919177279667       residual = 9.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919177281638       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919177284238       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919177287411       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919177292380       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919177296759       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919177296896       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919177297461       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919177297917       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919177297890       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919177296864       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919177297547       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919177298628       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919177299025       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919177299855       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919177300757       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919177301201       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919177301637       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919177301984       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919177301761       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919177301622       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919177301598       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919177301519       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919177301801       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919177301851       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919177302144       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919177302262       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919177302281       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919177302302       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919177302312       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919177302342       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919177302331       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.5367e+01 is 3.952980e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919177002684       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919177054559       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919177067849       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919177071969       residual = 9.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919177072462       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919177073112       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919177073905       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919177075148       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919177076243       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919177076278       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919177076418       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919177076533       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919177076526       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919177076269       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919177076440       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919177076712       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919177076810       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919177077017       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919177077243       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919177077353       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919177077463       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919177077550       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919177077494       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919177077459       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919177077453       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919177077434       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919177077503       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919177077516       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919177077589       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919177077617       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919177077623       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919177077629       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919177077631       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919177077640       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919177077635       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.8147e+02 is 9.883205e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919177002684       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919177015655       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919177018978       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919177020008       residual = 9.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919177020130       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919177020295       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919177020493       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919177020800       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919177021079       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919177021086       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919177021124       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919177021148       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919177021152       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919177021084       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919177021132       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919177021194       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919177021219       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919177021276       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919177021326       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919177021357       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919177021382       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919177021403       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919177021392       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919177021381       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919177021376       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919177021371       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919177021394       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919177021396       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919177021417       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919177021421       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919177021419       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919177021424       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919177021424       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919177021428       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919177021422       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5259e+03 is 2.470848e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.376585 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9931e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.087060e-01 1 1  ON 0
  uu_1                 5.166709e-02 1 1  ON 1
  uu_2                -3.940105e-02 1 1  ON 2
  uu_3                -9.291214e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319988e-01 1 1  ON 5
  uu_6                -1.137865e-01 1 1  ON 6
  uu_7                -5.393152e-02 1 1  ON 7
  uu_8                 7.179425e-02 1 1  ON 8
  uu_9                 1.240340e-01 1 1  ON 9
  ud_0                 3.081015e-01 1 1  ON 10
  ud_1                 7.810533e-02 1 1  ON 11
  ud_2                -2.402918e-02 1 1  ON 12
  ud_3                -7.733669e-02 1 1  ON 13
  ud_4                -1.141473e-01 1 1  ON 14
  ud_5                -1.343880e-01 1 1  ON 15
  ud_6                -1.304660e-01 1 1  ON 16
  ud_7                -8.981707e-02 1 1  ON 17
  ud_8                -4.429531e-03 1 1  ON 18
  ud_9                 8.809326e-02 1 1  ON 19
  eO_0                -7.053856e-01 1 1  ON 20
  eO_1                -4.211853e-01 1 1  ON 21
  eO_2                -4.127705e-02 1 1  ON 22
  eO_3                 1.870624e-01 1 1  ON 23
  eO_4                 2.613800e-01 1 1  ON 24
  eO_5                 2.856691e-01 1 1  ON 25
  eO_6                 2.498749e-01 1 1  ON 26
  eO_7                 1.252764e-01 1 1  ON 27
  eO_8                 2.849721e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018799e-01 1 1  ON 30
 eH1_1                -9.762488e-02 1 1  ON 31
 eH1_2                -4.695806e-02 1 1  ON 32
 eH1_3                -1.559979e-02 1 1  ON 33
 eH1_4                 1.884965e-02 1 1  ON 34
 eH1_5                 2.620649e-02 1 1  ON 35
 eH1_6                 7.491166e-02 1 1  ON 36
 eH1_7                 1.041054e-01 1 1  ON 37
 eH1_8                 9.703733e-02 1 1  ON 38
 eH1_9                 2.520329e-02 1 1  ON 39
 eH2_0                -2.031287e-01 1 1  ON 40
 eH2_1                -9.994545e-02 1 1  ON 41
 eH2_2                -4.927192e-02 1 1  ON 42
 eH2_3                -1.790925e-02 1 1  ON 43
 eH2_4                 1.638167e-02 1 1  ON 44
 eH2_5                 2.331417e-02 1 1  ON 45
 eH2_6                 7.777069e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971179e-02 1 1  ON 48
 eH2_9                 2.792584e-02 1 1  ON 49
ci_001                -4.261605e-02 3 1  ON 50
ci_002                -3.174030e-02 3 1  ON 51
ci_003                -1.241200e-02 3 1  ON 52
ci_004                 2.578182e-02 3 1  ON 53
ci_005                 2.603760e-02 3 1  ON 54
ci_006                -2.086911e-02 3 1  ON 55
ci_007                -2.067487e-02 3 1  ON 56
ci_008                -5.063254e-03 3 1  ON 57
ci_009                -1.563107e-02 3 1  ON 58
ci_010                -1.049454e-02 3 1  ON 59
ci_011                -1.040930e-02 3 1  ON 60
ci_012                -1.050590e-02 3 1  ON 61
ci_013                -2.150568e-02 3 1  ON 62
ci_014                 1.374515e-02 3 1  ON 63
ci_015                 1.357482e-02 3 1  ON 64
ci_016                 1.685188e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116331e-02 3 1  ON 67
ci_019                 1.083096e-02 3 1  ON 68
ci_020                 1.815747e-02 3 1  ON 69
ci_021                 1.790894e-02 3 1  ON 70
ci_022                 1.041009e-02 3 1  ON 71
ci_023                 1.092398e-02 3 1  ON 72
ci_024                 7.124876e-03 3 1  ON 73
ci_025                 7.213997e-03 3 1  ON 74
ci_026                 1.196625e-02 3 1  ON 75
ci_027                 1.214398e-02 3 1  ON 76
ci_028                -1.010245e-02 3 1  ON 77
ci_029                -9.846845e-03 3 1  ON 78
ci_030                -4.814178e-03 3 1  ON 79
ci_031                -5.117172e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1355
    reference variance = 0.165294
====================================================
  Execution time = 3.7258e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9357e-01
  Total weights = 1.9740e+06
  Execution time = 3.1591e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286775192797
                                         uncertainty =       0.001472025706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286775192797
                                         uncertainty =       0.001472025706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378692680
  error estimate for blocks of size 2^( 2) =       0.000393877441
  error estimate for blocks of size 2^( 3) =       0.000407299485
  error estimate for blocks of size 2^( 4) =       0.000417710089
  error estimate for blocks of size 2^( 5) =       0.000424703026
  error estimate for blocks of size 2^( 6) =       0.000427060639
  error estimate for blocks of size 2^( 7) =       0.000429689075

      target function =      -0.922794151203
              le_mean =     -17.206798542157
             les_mean =     296.367486171934
             stat err =       0.000424790707
             autocorr =       1.258276812055
   target nu stat err =       0.000424790707
   target dn stat err =       0.001948713354
      target stat err =       0.003161650778
              std dev =       0.535552324660
             le_variance =       0.286816292449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286775072462
                                         uncertainty =       0.001472007273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286775072462
                                         uncertainty =       0.001472007273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378692602
  error estimate for blocks of size 2^( 2) =       0.000393877588
  error estimate for blocks of size 2^( 3) =       0.000407299866
  error estimate for blocks of size 2^( 4) =       0.000417710660
  error estimate for blocks of size 2^( 5) =       0.000424703674
  error estimate for blocks of size 2^( 6) =       0.000427061322
  error estimate for blocks of size 2^( 7) =       0.000429689890

      target function =      -0.922793791227
              le_mean =     -17.206798522023
             les_mean =     296.367485707370
             stat err =       0.000424791386
             autocorr =       1.258281356826
   target nu stat err =       0.000424791386
   target dn stat err =       0.001948681907
      target stat err =       0.003161600201
              std dev =       0.535552213677
             le_variance =       0.286816173574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286775132552
                                         uncertainty =       0.001472016484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286775132552
                                         uncertainty =       0.001472016484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378692641
  error estimate for blocks of size 2^( 2) =       0.000393877515
  error estimate for blocks of size 2^( 3) =       0.000407299675
  error estimate for blocks of size 2^( 4) =       0.000417710374
  error estimate for blocks of size 2^( 5) =       0.000424703350
  error estimate for blocks of size 2^( 6) =       0.000427060981
  error estimate for blocks of size 2^( 7) =       0.000429689483

      target function =      -0.922793978454
              le_mean =     -17.206798532078
             les_mean =     296.367485934641
             stat err =       0.000424791047
             autocorr =       1.258279085561
   target nu stat err =       0.000424791047
   target dn stat err =       0.001948697573
      target stat err =       0.003161625450
              std dev =       0.535552269097
             le_variance =       0.286816232935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286775185261
                                         uncertainty =       0.001472024553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286775185261
                                         uncertainty =       0.001472024553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378692676
  error estimate for blocks of size 2^( 2) =       0.000393877451
  error estimate for blocks of size 2^( 3) =       0.000407299509
  error estimate for blocks of size 2^( 4) =       0.000417710125
  error estimate for blocks of size 2^( 5) =       0.000424703067
  error estimate for blocks of size 2^( 6) =       0.000427060682
  error estimate for blocks of size 2^( 7) =       0.000429689126

      target function =      -0.922794130402
              le_mean =     -17.206798540896
             les_mean =     296.367486141736
             stat err =       0.000424790750
             autocorr =       1.258277096270
   target nu stat err =       0.000424790750
   target dn stat err =       0.001948711376
      target stat err =       0.003161647609
              std dev =       0.535552317709
             le_variance =       0.286816285004


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922794151203        initial  <--
     9.5367e+01     9.5367e+02             3.9530e-06        -0.922793791227
     3.8147e+02     3.8147e+03             9.8832e-07        -0.922793978454
     1.5259e+03     1.5259e+04             2.4708e-07        -0.922794130402

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.0937
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166690e-02 1 1  ON 1
  uu_2                -3.940118e-02 1 1  ON 2
  uu_3                -9.291231e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393115e-02 1 1  ON 7
  uu_8                 7.179524e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810561e-02 1 1  ON 11
  ud_2                -2.402889e-02 1 1  ON 12
  ud_3                -7.733640e-02 1 1  ON 13
  ud_4                -1.141472e-01 1 1  ON 14
  ud_5                -1.343883e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981740e-02 1 1  ON 17
  ud_8                -4.429476e-03 1 1  ON 18
  ud_9                 8.809354e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127693e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856698e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849720e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762498e-02 1 1  ON 31
 eH1_2                -4.695835e-02 1 1  ON 32
 eH1_3                -1.559999e-02 1 1  ON 33
 eH1_4                 1.884943e-02 1 1  ON 34
 eH1_5                 2.620673e-02 1 1  ON 35
 eH1_6                 7.491236e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703706e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994542e-02 1 1  ON 41
 eH2_2                -4.927211e-02 1 1  ON 42
 eH2_3                -1.790933e-02 1 1  ON 43
 eH2_4                 1.638158e-02 1 1  ON 44
 eH2_5                 2.331419e-02 1 1  ON 45
 eH2_6                 7.777076e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.971140e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261621e-02 3 1  ON 50
ci_002                -3.174051e-02 3 1  ON 51
ci_003                -1.241220e-02 3 1  ON 52
ci_004                 2.578194e-02 3 1  ON 53
ci_005                 2.603760e-02 3 1  ON 54
ci_006                -2.086923e-02 3 1  ON 55
ci_007                -2.067499e-02 3 1  ON 56
ci_008                -5.063257e-03 3 1  ON 57
ci_009                -1.563144e-02 3 1  ON 58
ci_010                -1.049465e-02 3 1  ON 59
ci_011                -1.040947e-02 3 1  ON 60
ci_012                -1.050598e-02 3 1  ON 61
ci_013                -2.150588e-02 3 1  ON 62
ci_014                 1.374531e-02 3 1  ON 63
ci_015                 1.357468e-02 3 1  ON 64
ci_016                 1.685213e-02 3 1  ON 65
ci_017                 1.606474e-02 3 1  ON 66
ci_018                 1.116342e-02 3 1  ON 67
ci_019                 1.083106e-02 3 1  ON 68
ci_020                 1.815731e-02 3 1  ON 69
ci_021                 1.790886e-02 3 1  ON 70
ci_022                 1.041015e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124911e-03 3 1  ON 73
ci_025                 7.214019e-03 3 1  ON 74
ci_026                 1.196615e-02 3 1  ON 75
ci_027                 1.214393e-02 3 1  ON 76
ci_028                -1.010244e-02 3 1  ON 77
ci_029                -9.846857e-03 3 1  ON 78
ci_030                -4.814225e-03 3 1  ON 79
ci_031                -5.117306e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0303e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1985
    reference variance = 0.191392
====================================================
  Execution time = 3.7877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5426e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9515e-01
  Total weights = 1.974055144e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0954e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287879030839
                                         uncertainty =       0.002220762092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287879030839
                                         uncertainty =       0.002220762092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379451028
  error estimate for blocks of size 2^( 2) =       0.000394145690
  error estimate for blocks of size 2^( 3) =       0.000408052364
  error estimate for blocks of size 2^( 4) =       0.000417707325
  error estimate for blocks of size 2^( 5) =       0.000423556944
  error estimate for blocks of size 2^( 6) =       0.000425551683
  error estimate for blocks of size 2^( 7) =       0.000428686728

      target function =      -0.920284909698
              le_mean =     -17.206954227104
             les_mean =     296.374427569700
             stat err =       0.000423875670
             autocorr =       1.247858988819
   target nu stat err =       0.000423875670
   target dn stat err =       0.002961622450
      target stat err =       0.004708262680
              std dev =       0.536624789681
             le_variance =       0.287966164900


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720695422710e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920308000342       residual = 4.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920308020659       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920308027329       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920308029584       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920308030970       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920308031376       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920308031769       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920308032834       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920308033212       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920308033342       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920308033463       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920308033573       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920308033639       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920308033806       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920308033673       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920308033774       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920308033743       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920308033850       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920308033908       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920308034015       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920308034115       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920308034266       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920308034206       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920308034190       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920308034212       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920308034237       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920308034254       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920308034235       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920308034248       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920308034227       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920308034210       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920308034217       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920308034248       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920308034236       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920308034241       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.5367e+02 is 4.136808e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920308000342       residual = 4.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920308005421       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920308007089       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920308007653       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920308007999       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920308008110       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920308008202       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920308008468       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920308008555       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920308008585       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920308008615       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920308008661       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920308008667       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920308008708       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920308008675       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920308008706       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920308008677       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920308008714       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920308008737       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920308008746       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920308008781       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920308008823       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920308008797       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920308008809       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920308008813       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920308008824       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920308008821       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920308008811       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920308008805       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920308008804       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920308008802       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920308008813       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920308008817       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920308008808       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920308008818       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.8147e+03 is 1.034209e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920308000342       residual = 4.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920308001612       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920308002029       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920308002171       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920308002243       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920308002281       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920308002296       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920308002382       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920308002393       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920308002415       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920308002410       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920308002435       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920308002421       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920308002443       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920308002413       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920308002363       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920308002443       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920308002474       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920308002436       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920308002452       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920308002449       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920308002486       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920308002430       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920308002450       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920308002423       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920308002431       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920308002445       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920308002424       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920308002510       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920308002436       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920308002515       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920308002418       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920308002426       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920308002441       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920308002532       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5259e+04 is 2.585528e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.422340 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8884e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.087060e-01 1 1  ON 0
  uu_1                 5.166695e-02 1 1  ON 1
  uu_2                -3.940115e-02 1 1  ON 2
  uu_3                -9.291230e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393118e-02 1 1  ON 7
  uu_8                 7.179514e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810557e-02 1 1  ON 11
  ud_2                -2.402890e-02 1 1  ON 12
  ud_3                -7.733641e-02 1 1  ON 13
  ud_4                -1.141471e-01 1 1  ON 14
  ud_5                -1.343883e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981734e-02 1 1  ON 17
  ud_8                -4.429497e-03 1 1  ON 18
  ud_9                 8.809352e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127693e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856698e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849721e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018799e-01 1 1  ON 30
 eH1_1                -9.762498e-02 1 1  ON 31
 eH1_2                -4.695832e-02 1 1  ON 32
 eH1_3                -1.559997e-02 1 1  ON 33
 eH1_4                 1.884943e-02 1 1  ON 34
 eH1_5                 2.620670e-02 1 1  ON 35
 eH1_6                 7.491233e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703711e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031284e-01 1 1  ON 40
 eH2_1                -9.994539e-02 1 1  ON 41
 eH2_2                -4.927208e-02 1 1  ON 42
 eH2_3                -1.790932e-02 1 1  ON 43
 eH2_4                 1.638161e-02 1 1  ON 44
 eH2_5                 2.331418e-02 1 1  ON 45
 eH2_6                 7.777073e-02 1 1  ON 46
 eH2_7                 1.127070e-01 1 1  ON 47
 eH2_8                 9.971143e-02 1 1  ON 48
 eH2_9                 2.792582e-02 1 1  ON 49
ci_001                -4.261619e-02 3 1  ON 50
ci_002                -3.174052e-02 3 1  ON 51
ci_003                -1.241218e-02 3 1  ON 52
ci_004                 2.578194e-02 3 1  ON 53
ci_005                 2.603760e-02 3 1  ON 54
ci_006                -2.086923e-02 3 1  ON 55
ci_007                -2.067497e-02 3 1  ON 56
ci_008                -5.063260e-03 3 1  ON 57
ci_009                -1.563145e-02 3 1  ON 58
ci_010                -1.049465e-02 3 1  ON 59
ci_011                -1.040946e-02 3 1  ON 60
ci_012                -1.050599e-02 3 1  ON 61
ci_013                -2.150586e-02 3 1  ON 62
ci_014                 1.374530e-02 3 1  ON 63
ci_015                 1.357468e-02 3 1  ON 64
ci_016                 1.685210e-02 3 1  ON 65
ci_017                 1.606475e-02 3 1  ON 66
ci_018                 1.116341e-02 3 1  ON 67
ci_019                 1.083107e-02 3 1  ON 68
ci_020                 1.815729e-02 3 1  ON 69
ci_021                 1.790885e-02 3 1  ON 70
ci_022                 1.041018e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124925e-03 3 1  ON 73
ci_025                 7.214018e-03 3 1  ON 74
ci_026                 1.196615e-02 3 1  ON 75
ci_027                 1.214394e-02 3 1  ON 76
ci_028                -1.010241e-02 3 1  ON 77
ci_029                -9.846846e-03 3 1  ON 78
ci_030                -4.814196e-03 3 1  ON 79
ci_031                -5.117302e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1577
    reference variance = 0.302406
====================================================
  Execution time = 3.7814e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7208e+01
  VMC Evar = 2.9870e-01
  Total weights = 1.9736e+06
  Execution time = 3.1449e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292125866438
                                         uncertainty =       0.002244616943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292125866438
                                         uncertainty =       0.002244616943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382152420
  error estimate for blocks of size 2^( 2) =       0.000397261601
  error estimate for blocks of size 2^( 3) =       0.000410361726
  error estimate for blocks of size 2^( 4) =       0.000420227563
  error estimate for blocks of size 2^( 5) =       0.000425695573
  error estimate for blocks of size 2^( 6) =       0.000428414624
  error estimate for blocks of size 2^( 7) =       0.000433120899

      target function =      -0.914733125791
              le_mean =     -17.207539217940
             les_mean =     296.398108829296
             stat err =       0.000426864665
             autocorr =       1.247691408136
   target nu stat err =       0.000426864665
   target dn stat err =       0.002720298475
      target stat err =       0.004288148573
              std dev =       0.540445134964
             le_variance =       0.292080943906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292125901666
                                         uncertainty =       0.002244619588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292125901666
                                         uncertainty =       0.002244619588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382152443
  error estimate for blocks of size 2^( 2) =       0.000397261642
  error estimate for blocks of size 2^( 3) =       0.000410361784
  error estimate for blocks of size 2^( 4) =       0.000420227635
  error estimate for blocks of size 2^( 5) =       0.000425695656
  error estimate for blocks of size 2^( 6) =       0.000428414708
  error estimate for blocks of size 2^( 7) =       0.000433120986

      target function =      -0.914733063083
              le_mean =     -17.207539215547
             les_mean =     296.398108787245
             stat err =       0.000426864746
             autocorr =       1.247691733093
   target nu stat err =       0.000426864746
   target dn stat err =       0.002720311718
      target stat err =       0.004288168278
              std dev =       0.540445167598
             le_variance =       0.292080979180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292125884052
                                         uncertainty =       0.002244618265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292125884052
                                         uncertainty =       0.002244618265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382152431
  error estimate for blocks of size 2^( 2) =       0.000397261622
  error estimate for blocks of size 2^( 3) =       0.000410361755
  error estimate for blocks of size 2^( 4) =       0.000420227599
  error estimate for blocks of size 2^( 5) =       0.000425695614
  error estimate for blocks of size 2^( 6) =       0.000428414666
  error estimate for blocks of size 2^( 7) =       0.000433120942

      target function =      -0.914733094444
              le_mean =     -17.207539216743
             les_mean =     296.398108808261
             stat err =       0.000426864706
             autocorr =       1.247691570628
   target nu stat err =       0.000426864706
   target dn stat err =       0.002720305096
      target stat err =       0.004288158426
              std dev =       0.540445151281
             le_variance =       0.292080961543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292125868640
                                         uncertainty =       0.002244617108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292125868640
                                         uncertainty =       0.002244617108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382152421
  error estimate for blocks of size 2^( 2) =       0.000397261604
  error estimate for blocks of size 2^( 3) =       0.000410361729
  error estimate for blocks of size 2^( 4) =       0.000420227567
  error estimate for blocks of size 2^( 5) =       0.000425695578
  error estimate for blocks of size 2^( 6) =       0.000428414630
  error estimate for blocks of size 2^( 7) =       0.000433120905

      target function =      -0.914733121874
              le_mean =     -17.207539217790
             les_mean =     296.398108826666
             stat err =       0.000426864670
             autocorr =       1.247691428440
   target nu stat err =       0.000426864670
   target dn stat err =       0.002720299302
      target stat err =       0.004288149805
              std dev =       0.540445137003
             le_variance =       0.292080946111


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914733125791        initial  <--
     9.5367e+02     9.5367e+03             4.1368e-07        -0.914733063083
     3.8147e+03     3.8147e+04             1.0342e-07        -0.914733094444
     1.5259e+04     1.5259e+05             2.5855e-08        -0.914733121874

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.6214
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166690e-02 1 1  ON 1
  uu_2                -3.940118e-02 1 1  ON 2
  uu_3                -9.291231e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393115e-02 1 1  ON 7
  uu_8                 7.179524e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810561e-02 1 1  ON 11
  ud_2                -2.402889e-02 1 1  ON 12
  ud_3                -7.733640e-02 1 1  ON 13
  ud_4                -1.141472e-01 1 1  ON 14
  ud_5                -1.343883e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981740e-02 1 1  ON 17
  ud_8                -4.429476e-03 1 1  ON 18
  ud_9                 8.809354e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127693e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856698e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849720e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762498e-02 1 1  ON 31
 eH1_2                -4.695835e-02 1 1  ON 32
 eH1_3                -1.559999e-02 1 1  ON 33
 eH1_4                 1.884943e-02 1 1  ON 34
 eH1_5                 2.620673e-02 1 1  ON 35
 eH1_6                 7.491236e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703706e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994542e-02 1 1  ON 41
 eH2_2                -4.927211e-02 1 1  ON 42
 eH2_3                -1.790933e-02 1 1  ON 43
 eH2_4                 1.638158e-02 1 1  ON 44
 eH2_5                 2.331419e-02 1 1  ON 45
 eH2_6                 7.777076e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.971140e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261621e-02 3 1  ON 50
ci_002                -3.174051e-02 3 1  ON 51
ci_003                -1.241220e-02 3 1  ON 52
ci_004                 2.578194e-02 3 1  ON 53
ci_005                 2.603760e-02 3 1  ON 54
ci_006                -2.086923e-02 3 1  ON 55
ci_007                -2.067499e-02 3 1  ON 56
ci_008                -5.063257e-03 3 1  ON 57
ci_009                -1.563144e-02 3 1  ON 58
ci_010                -1.049465e-02 3 1  ON 59
ci_011                -1.040947e-02 3 1  ON 60
ci_012                -1.050598e-02 3 1  ON 61
ci_013                -2.150588e-02 3 1  ON 62
ci_014                 1.374531e-02 3 1  ON 63
ci_015                 1.357468e-02 3 1  ON 64
ci_016                 1.685213e-02 3 1  ON 65
ci_017                 1.606474e-02 3 1  ON 66
ci_018                 1.116342e-02 3 1  ON 67
ci_019                 1.083106e-02 3 1  ON 68
ci_020                 1.815731e-02 3 1  ON 69
ci_021                 1.790886e-02 3 1  ON 70
ci_022                 1.041015e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124911e-03 3 1  ON 73
ci_025                 7.214019e-03 3 1  ON 74
ci_026                 1.196615e-02 3 1  ON 75
ci_027                 1.214393e-02 3 1  ON 76
ci_028                -1.010244e-02 3 1  ON 77
ci_029                -9.846857e-03 3 1  ON 78
ci_030                -4.814225e-03 3 1  ON 79
ci_031                -5.117306e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0251e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1649
    reference variance = 0.378888
====================================================
  Execution time = 3.7897e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5404e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9493e-01
  Total weights = 1.973687459e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0940e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289073187554
                                         uncertainty =       0.001476869065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289073187554
                                         uncertainty =       0.001476869065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380141557
  error estimate for blocks of size 2^( 2) =       0.000395171660
  error estimate for blocks of size 2^( 3) =       0.000408441296
  error estimate for blocks of size 2^( 4) =       0.000418383959
  error estimate for blocks of size 2^( 5) =       0.000424201756
  error estimate for blocks of size 2^( 6) =       0.000427930774
  error estimate for blocks of size 2^( 7) =       0.000429477060

      target function =      -0.920640860682
              le_mean =     -17.207341467033
             les_mean =     296.387533376287
             stat err =       0.000424998387
             autocorr =       1.249924745327
   target nu stat err =       0.000424998387
   target dn stat err =       0.001885466312
      target stat err =       0.003053819304
              std dev =       0.537601345548
             le_variance =       0.289015206735


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720734146703e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920649930840       residual = 5.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920649933792       residual = 9.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920649934015       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920649934171       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920649934209       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920649934262       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920649934351       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920649934515       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920649934553       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920649934507       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920649934535       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920649934576       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920649934642       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920649934678       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920649934666       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920649934637       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920649934690       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920649934679       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920649934706       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920649934720       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920649934700       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920649934729       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920649934711       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920649934708       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920649934691       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920649934716       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920649934705       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920649934692       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920649934727       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920649934738       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920649934755       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920649934691       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920649934711       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920649934755       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920649934707       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920649934712       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.920649934717       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.920649934714       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.5367e+03 is 4.243292e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920649930840       residual = 5.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920649931578       residual = 9.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920649931634       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920649931673       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920649931775       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920649931673       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920649931632       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920649931718       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920649931726       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920649931686       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920649931772       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920649931735       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920649931682       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920649931859       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920649931809       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920649931777       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920649931648       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920649931728       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920649931762       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920649931757       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920649931866       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920649931671       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920649931870       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920649931681       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920649931714       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920649931806       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920649931804       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920649931781       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920649931565       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920649931787       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920649931754       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920649931848       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920649931893       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920649931860       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920649931855       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920649931842       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.920649931771       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.920649931808       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.8147e+04 is 1.060825e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920649930840       residual = 5.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920649931025       residual = 9.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920649931039       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920649931049       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920649931033       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920649930982       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920649931061       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920649931371       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920649931020       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920649931591       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920649931158       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920649930952       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920649931005       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920649931005       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920649931282       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920649931058       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920649931160       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920649930984       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920649930799       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920649931013       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920649931233       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920649931119       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920649931072       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920649930891       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920649931182       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920649931063       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920649930825       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920649930434       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920649931117       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920649931460       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920649931043       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920649931250       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920649931168       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920649930859       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920649930638       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920649930783       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.920649931106       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.920649930779       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5259e+05 is 2.652065e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.479390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8902e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166690e-02 1 1  ON 1
  uu_2                -3.940118e-02 1 1  ON 2
  uu_3                -9.291231e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393115e-02 1 1  ON 7
  uu_8                 7.179523e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810561e-02 1 1  ON 11
  ud_2                -2.402889e-02 1 1  ON 12
  ud_3                -7.733640e-02 1 1  ON 13
  ud_4                -1.141472e-01 1 1  ON 14
  ud_5                -1.343883e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981739e-02 1 1  ON 17
  ud_8                -4.429476e-03 1 1  ON 18
  ud_9                 8.809354e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127692e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856697e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849720e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762498e-02 1 1  ON 31
 eH1_2                -4.695834e-02 1 1  ON 32
 eH1_3                -1.559999e-02 1 1  ON 33
 eH1_4                 1.884943e-02 1 1  ON 34
 eH1_5                 2.620672e-02 1 1  ON 35
 eH1_6                 7.491236e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703706e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994542e-02 1 1  ON 41
 eH2_2                -4.927211e-02 1 1  ON 42
 eH2_3                -1.790933e-02 1 1  ON 43
 eH2_4                 1.638158e-02 1 1  ON 44
 eH2_5                 2.331419e-02 1 1  ON 45
 eH2_6                 7.777076e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.971141e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261621e-02 3 1  ON 50
ci_002                -3.174051e-02 3 1  ON 51
ci_003                -1.241220e-02 3 1  ON 52
ci_004                 2.578193e-02 3 1  ON 53
ci_005                 2.603760e-02 3 1  ON 54
ci_006                -2.086923e-02 3 1  ON 55
ci_007                -2.067499e-02 3 1  ON 56
ci_008                -5.063256e-03 3 1  ON 57
ci_009                -1.563144e-02 3 1  ON 58
ci_010                -1.049465e-02 3 1  ON 59
ci_011                -1.040947e-02 3 1  ON 60
ci_012                -1.050598e-02 3 1  ON 61
ci_013                -2.150588e-02 3 1  ON 62
ci_014                 1.374530e-02 3 1  ON 63
ci_015                 1.357468e-02 3 1  ON 64
ci_016                 1.685213e-02 3 1  ON 65
ci_017                 1.606474e-02 3 1  ON 66
ci_018                 1.116342e-02 3 1  ON 67
ci_019                 1.083106e-02 3 1  ON 68
ci_020                 1.815730e-02 3 1  ON 69
ci_021                 1.790886e-02 3 1  ON 70
ci_022                 1.041015e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124911e-03 3 1  ON 73
ci_025                 7.214016e-03 3 1  ON 74
ci_026                 1.196615e-02 3 1  ON 75
ci_027                 1.214394e-02 3 1  ON 76
ci_028                -1.010244e-02 3 1  ON 77
ci_029                -9.846855e-03 3 1  ON 78
ci_030                -4.814223e-03 3 1  ON 79
ci_031                -5.117304e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1348
    reference variance = 0.252161
====================================================
  Execution time = 3.7755e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7208e+01
  VMC Evar = 2.9398e-01
  Total weights = 1.9738e+06
  Execution time = 3.2445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288065869877
                                         uncertainty =       0.001720566213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288065869877
                                         uncertainty =       0.001720566213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379481384
  error estimate for blocks of size 2^( 2) =       0.000394267397
  error estimate for blocks of size 2^( 3) =       0.000408141920
  error estimate for blocks of size 2^( 4) =       0.000417669147
  error estimate for blocks of size 2^( 5) =       0.000423615940
  error estimate for blocks of size 2^( 6) =       0.000427385033
  error estimate for blocks of size 2^( 7) =       0.000427885179

      target function =      -0.922131902639
              le_mean =     -17.207694375740
             les_mean =     296.398729424399
             stat err =       0.000424138825
             autocorr =       1.249209001347
   target nu stat err =       0.000424138825
   target dn stat err =       0.001957485423
      target stat err =       0.003175716505
              std dev =       0.536667720154
             le_variance =       0.288012241856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288065869134
                                         uncertainty =       0.001720566051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288065869134
                                         uncertainty =       0.001720566051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379481384
  error estimate for blocks of size 2^( 2) =       0.000394267399
  error estimate for blocks of size 2^( 3) =       0.000408141925
  error estimate for blocks of size 2^( 4) =       0.000417669153
  error estimate for blocks of size 2^( 5) =       0.000423615947
  error estimate for blocks of size 2^( 6) =       0.000427385040
  error estimate for blocks of size 2^( 7) =       0.000427885186

      target function =      -0.922131900467
              le_mean =     -17.207694375639
             les_mean =     296.398729422284
             stat err =       0.000424138831
             autocorr =       1.249209044891
   target nu stat err =       0.000424138831
   target dn stat err =       0.001957485445
      target stat err =       0.003175716526
              std dev =       0.536667719462
             le_variance =       0.288012241112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288065869506
                                         uncertainty =       0.001720566132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288065869506
                                         uncertainty =       0.001720566132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379481384
  error estimate for blocks of size 2^( 2) =       0.000394267398
  error estimate for blocks of size 2^( 3) =       0.000408141922
  error estimate for blocks of size 2^( 4) =       0.000417669150
  error estimate for blocks of size 2^( 5) =       0.000423615943
  error estimate for blocks of size 2^( 6) =       0.000427385036
  error estimate for blocks of size 2^( 7) =       0.000427885183

      target function =      -0.922131901553
              le_mean =     -17.207694375690
             les_mean =     296.398729423341
             stat err =       0.000424138828
             autocorr =       1.249209023114
   target nu stat err =       0.000424138828
   target dn stat err =       0.001957485434
      target stat err =       0.003175716515
              std dev =       0.536667719808
             le_variance =       0.288012241484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288065869831
                                         uncertainty =       0.001720566203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288065869831
                                         uncertainty =       0.001720566203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379481384
  error estimate for blocks of size 2^( 2) =       0.000394267397
  error estimate for blocks of size 2^( 3) =       0.000408141921
  error estimate for blocks of size 2^( 4) =       0.000417669147
  error estimate for blocks of size 2^( 5) =       0.000423615940
  error estimate for blocks of size 2^( 6) =       0.000427385033
  error estimate for blocks of size 2^( 7) =       0.000427885180

      target function =      -0.922131902503
              le_mean =     -17.207694375734
             les_mean =     296.398729424267
             stat err =       0.000424138825
             autocorr =       1.249209004073
   target nu stat err =       0.000424138825
   target dn stat err =       0.001957485425
      target stat err =       0.003175716506
              std dev =       0.536667720111
             le_variance =       0.288012241809


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922131902639        initial  <--
     9.5367e+03     9.5367e+04             4.2433e-08        -0.922131900467
     3.8147e+04     3.8147e+05             1.0608e-08        -0.922131901553
     1.5259e+05     1.5259e+06             2.6521e-09        -0.922131902503

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.1032
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166690e-02 1 1  ON 1
  uu_2                -3.940118e-02 1 1  ON 2
  uu_3                -9.291231e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393115e-02 1 1  ON 7
  uu_8                 7.179524e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810561e-02 1 1  ON 11
  ud_2                -2.402889e-02 1 1  ON 12
  ud_3                -7.733640e-02 1 1  ON 13
  ud_4                -1.141472e-01 1 1  ON 14
  ud_5                -1.343883e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981740e-02 1 1  ON 17
  ud_8                -4.429476e-03 1 1  ON 18
  ud_9                 8.809354e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127693e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856698e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849720e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762498e-02 1 1  ON 31
 eH1_2                -4.695835e-02 1 1  ON 32
 eH1_3                -1.559999e-02 1 1  ON 33
 eH1_4                 1.884943e-02 1 1  ON 34
 eH1_5                 2.620673e-02 1 1  ON 35
 eH1_6                 7.491236e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703706e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994542e-02 1 1  ON 41
 eH2_2                -4.927211e-02 1 1  ON 42
 eH2_3                -1.790933e-02 1 1  ON 43
 eH2_4                 1.638158e-02 1 1  ON 44
 eH2_5                 2.331419e-02 1 1  ON 45
 eH2_6                 7.777076e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.971140e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261621e-02 3 1  ON 50
ci_002                -3.174051e-02 3 1  ON 51
ci_003                -1.241220e-02 3 1  ON 52
ci_004                 2.578194e-02 3 1  ON 53
ci_005                 2.603760e-02 3 1  ON 54
ci_006                -2.086923e-02 3 1  ON 55
ci_007                -2.067499e-02 3 1  ON 56
ci_008                -5.063257e-03 3 1  ON 57
ci_009                -1.563144e-02 3 1  ON 58
ci_010                -1.049465e-02 3 1  ON 59
ci_011                -1.040947e-02 3 1  ON 60
ci_012                -1.050598e-02 3 1  ON 61
ci_013                -2.150588e-02 3 1  ON 62
ci_014                 1.374531e-02 3 1  ON 63
ci_015                 1.357468e-02 3 1  ON 64
ci_016                 1.685213e-02 3 1  ON 65
ci_017                 1.606474e-02 3 1  ON 66
ci_018                 1.116342e-02 3 1  ON 67
ci_019                 1.083106e-02 3 1  ON 68
ci_020                 1.815731e-02 3 1  ON 69
ci_021                 1.790886e-02 3 1  ON 70
ci_022                 1.041015e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124911e-03 3 1  ON 73
ci_025                 7.214019e-03 3 1  ON 74
ci_026                 1.196615e-02 3 1  ON 75
ci_027                 1.214393e-02 3 1  ON 76
ci_028                -1.010244e-02 3 1  ON 77
ci_029                -9.846857e-03 3 1  ON 78
ci_030                -4.814225e-03 3 1  ON 79
ci_031                -5.117306e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0301e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1564
    reference variance = 0.22083
====================================================
  Execution time = 3.9574e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5413e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9652e-01
  Total weights = 1.974090589e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0943e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289166956640
                                         uncertainty =       0.001717317528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289166956640
                                         uncertainty =       0.001717317528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380247187
  error estimate for blocks of size 2^( 2) =       0.000395128914
  error estimate for blocks of size 2^( 3) =       0.000409133474
  error estimate for blocks of size 2^( 4) =       0.000419420722
  error estimate for blocks of size 2^( 5) =       0.000424823582
  error estimate for blocks of size 2^( 6) =       0.000428702319
  error estimate for blocks of size 2^( 7) =       0.000429034493

      target function =      -0.918152661878
              le_mean =     -17.207256533287
             les_mean =     296.386192888717
             stat err =       0.000425495279
             autocorr =       1.252153210151
   target nu stat err =       0.000425495279
   target dn stat err =       0.002468740137
      target stat err =       0.003929726518
              std dev =       0.537750729250
             le_variance =       0.289175846809


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720725653329e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918168606501       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918168606724       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918168606789       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918168606809       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918168606652       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918168606879       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918168606993       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918168606837       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918168606683       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918168606928       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918168606890       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918168606865       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918168606984       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918168607066       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918168606557       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918168607134       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918168606681       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918168606738       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918168606703       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918168606662       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918168606950       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918168606928       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918168607375       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918168607256       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918168607004       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918168606962       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918168606655       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918168606928       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918168606855       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918168606635       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918168606565       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918168606771       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918168607014       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918168606756       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918168606637       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918168606779       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918168607070       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918168606688       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.918168606949       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.5367e+04 is 6.293746e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918168606501       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918168606557       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918168606573       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918168606578       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918168606593       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918168606606       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918168606718       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918168605771       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918168606586       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918168606687       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918168606829       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918168606427       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918168605819       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918168607042       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918168605098       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918168607331       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918168605963       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918168605943       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918168605957       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918168606485       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918168606876       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918168605467       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918168605374       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918168606247       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918168606479       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918168605043       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918168605448       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918168607255       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918168605322       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918168608343       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918168607531       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918168604514       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918168607122       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918168607406       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918168603223       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918168606417       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918168607367       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918168606748       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.918168608120       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.8147e+05 is 1.573437e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918168606501       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918168606515       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918168606519       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918168606520       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918168606520       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918168607661       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918168606528       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918168608135       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918168607663       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918168604413       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918168605434       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918168606523       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918168608465       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918168604737       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918168606650       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918168603920       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918168608068       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918168608585       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918168604663       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918168607038       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918168607491       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918168603803       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918168610739       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918168604659       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918168600870       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918168608726       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918168614703       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918168598709       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918168606868       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918168602053       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918168613973       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918168599485       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918168605036       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918168612002       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918168605175       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918168602521       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918168606268       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918168600625       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.918168605451       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5259e+06 is 3.933590e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.540985 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0586e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166690e-02 1 1  ON 1
  uu_2                -3.940118e-02 1 1  ON 2
  uu_3                -9.291231e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393115e-02 1 1  ON 7
  uu_8                 7.179524e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810561e-02 1 1  ON 11
  ud_2                -2.402889e-02 1 1  ON 12
  ud_3                -7.733640e-02 1 1  ON 13
  ud_4                -1.141472e-01 1 1  ON 14
  ud_5                -1.343883e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981740e-02 1 1  ON 17
  ud_8                -4.429476e-03 1 1  ON 18
  ud_9                 8.809354e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127693e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856698e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849720e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762498e-02 1 1  ON 31
 eH1_2                -4.695835e-02 1 1  ON 32
 eH1_3                -1.559999e-02 1 1  ON 33
 eH1_4                 1.884943e-02 1 1  ON 34
 eH1_5                 2.620673e-02 1 1  ON 35
 eH1_6                 7.491236e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703706e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994542e-02 1 1  ON 41
 eH2_2                -4.927211e-02 1 1  ON 42
 eH2_3                -1.790933e-02 1 1  ON 43
 eH2_4                 1.638158e-02 1 1  ON 44
 eH2_5                 2.331419e-02 1 1  ON 45
 eH2_6                 7.777076e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.971140e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261621e-02 3 1  ON 50
ci_002                -3.174051e-02 3 1  ON 51
ci_003                -1.241220e-02 3 1  ON 52
ci_004                 2.578194e-02 3 1  ON 53
ci_005                 2.603760e-02 3 1  ON 54
ci_006                -2.086923e-02 3 1  ON 55
ci_007                -2.067499e-02 3 1  ON 56
ci_008                -5.063257e-03 3 1  ON 57
ci_009                -1.563144e-02 3 1  ON 58
ci_010                -1.049465e-02 3 1  ON 59
ci_011                -1.040947e-02 3 1  ON 60
ci_012                -1.050598e-02 3 1  ON 61
ci_013                -2.150588e-02 3 1  ON 62
ci_014                 1.374531e-02 3 1  ON 63
ci_015                 1.357468e-02 3 1  ON 64
ci_016                 1.685213e-02 3 1  ON 65
ci_017                 1.606474e-02 3 1  ON 66
ci_018                 1.116342e-02 3 1  ON 67
ci_019                 1.083106e-02 3 1  ON 68
ci_020                 1.815731e-02 3 1  ON 69
ci_021                 1.790886e-02 3 1  ON 70
ci_022                 1.041015e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124911e-03 3 1  ON 73
ci_025                 7.214019e-03 3 1  ON 74
ci_026                 1.196615e-02 3 1  ON 75
ci_027                 1.214393e-02 3 1  ON 76
ci_028                -1.010244e-02 3 1  ON 77
ci_029                -9.846857e-03 3 1  ON 78
ci_030                -4.814225e-03 3 1  ON 79
ci_031                -5.117306e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2415
    reference variance = 0.217188
====================================================
  Execution time = 3.8034e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9386e-01
  Total weights = 1.9739e+06
  Execution time = 3.2201e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287673610355
                                         uncertainty =       0.001687572293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287673610355
                                         uncertainty =       0.001687572293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379264054
  error estimate for blocks of size 2^( 2) =       0.000394347278
  error estimate for blocks of size 2^( 3) =       0.000408123104
  error estimate for blocks of size 2^( 4) =       0.000418348931
  error estimate for blocks of size 2^( 5) =       0.000425784992
  error estimate for blocks of size 2^( 6) =       0.000429821088
  error estimate for blocks of size 2^( 7) =       0.000431733196

      target function =      -0.922335186612
              le_mean =     -17.206602466157
             les_mean =     296.361030263733
             stat err =       0.000426422052
             autocorr =       1.264142244796
   target nu stat err =       0.000426422052
   target dn stat err =       0.001972929538
      target stat err =       0.003195250749
              std dev =       0.536360368927
             le_variance =       0.287682445355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287673609926
                                         uncertainty =       0.001687572263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287673609926
                                         uncertainty =       0.001687572263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379264054
  error estimate for blocks of size 2^( 2) =       0.000394347278
  error estimate for blocks of size 2^( 3) =       0.000408123104
  error estimate for blocks of size 2^( 4) =       0.000418348931
  error estimate for blocks of size 2^( 5) =       0.000425784993
  error estimate for blocks of size 2^( 6) =       0.000429821088
  error estimate for blocks of size 2^( 7) =       0.000431733197

      target function =      -0.922335186814
              le_mean =     -17.206602466177
             les_mean =     296.361030264301
             stat err =       0.000426422052
             autocorr =       1.264142251696
   target nu stat err =       0.000426422052
   target dn stat err =       0.001972929521
      target stat err =       0.003195250725
              std dev =       0.536360368528
             le_variance =       0.287682444927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287673610140
                                         uncertainty =       0.001687572278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287673610140
                                         uncertainty =       0.001687572278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379264054
  error estimate for blocks of size 2^( 2) =       0.000394347278
  error estimate for blocks of size 2^( 3) =       0.000408123104
  error estimate for blocks of size 2^( 4) =       0.000418348931
  error estimate for blocks of size 2^( 5) =       0.000425784993
  error estimate for blocks of size 2^( 6) =       0.000429821088
  error estimate for blocks of size 2^( 7) =       0.000431733197

      target function =      -0.922335186713
              le_mean =     -17.206602466167
             les_mean =     296.361030264017
             stat err =       0.000426422052
             autocorr =       1.264142248239
   target nu stat err =       0.000426422052
   target dn stat err =       0.001972929529
      target stat err =       0.003195250737
              std dev =       0.536360368727
             le_variance =       0.287682445141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287673610328
                                         uncertainty =       0.001687572291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287673610328
                                         uncertainty =       0.001687572291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379264054
  error estimate for blocks of size 2^( 2) =       0.000394347278
  error estimate for blocks of size 2^( 3) =       0.000408123104
  error estimate for blocks of size 2^( 4) =       0.000418348931
  error estimate for blocks of size 2^( 5) =       0.000425784992
  error estimate for blocks of size 2^( 6) =       0.000429821088
  error estimate for blocks of size 2^( 7) =       0.000431733196

      target function =      -0.922335186624
              le_mean =     -17.206602466158
             les_mean =     296.361030263769
             stat err =       0.000426422052
             autocorr =       1.264142245228
   target nu stat err =       0.000426422052
   target dn stat err =       0.001972929537
      target stat err =       0.003195250748
              std dev =       0.536360368902
             le_variance =       0.287682445328


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922335186612        initial
     9.5367e+04     9.5367e+05             6.2937e-09        -0.922335186814  <--
     3.8147e+05     3.8147e+06             1.5734e-09        -0.922335186713
     1.5259e+06     1.5259e+07             3.9336e-10        -0.922335186624

*****************************************************************************
Applying the update for shift_i =   9.5367e+04     and shift_s =   9.5367e+05
*****************************************************************************

  Execution time = 5.4298e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166690e-02 1 1  ON 1
  uu_2                -3.940118e-02 1 1  ON 2
  uu_3                -9.291231e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393114e-02 1 1  ON 7
  uu_8                 7.179524e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810561e-02 1 1  ON 11
  ud_2                -2.402889e-02 1 1  ON 12
  ud_3                -7.733640e-02 1 1  ON 13
  ud_4                -1.141472e-01 1 1  ON 14
  ud_5                -1.343883e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981740e-02 1 1  ON 17
  ud_8                -4.429477e-03 1 1  ON 18
  ud_9                 8.809354e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127693e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856698e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849720e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762498e-02 1 1  ON 31
 eH1_2                -4.695835e-02 1 1  ON 32
 eH1_3                -1.559999e-02 1 1  ON 33
 eH1_4                 1.884943e-02 1 1  ON 34
 eH1_5                 2.620673e-02 1 1  ON 35
 eH1_6                 7.491236e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703706e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994542e-02 1 1  ON 41
 eH2_2                -4.927211e-02 1 1  ON 42
 eH2_3                -1.790933e-02 1 1  ON 43
 eH2_4                 1.638158e-02 1 1  ON 44
 eH2_5                 2.331418e-02 1 1  ON 45
 eH2_6                 7.777076e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.971140e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261621e-02 3 1  ON 50
ci_002                -3.174051e-02 3 1  ON 51
ci_003                -1.241220e-02 3 1  ON 52
ci_004                 2.578194e-02 3 1  ON 53
ci_005                 2.603760e-02 3 1  ON 54
ci_006                -2.086923e-02 3 1  ON 55
ci_007                -2.067499e-02 3 1  ON 56
ci_008                -5.063256e-03 3 1  ON 57
ci_009                -1.563144e-02 3 1  ON 58
ci_010                -1.049465e-02 3 1  ON 59
ci_011                -1.040947e-02 3 1  ON 60
ci_012                -1.050598e-02 3 1  ON 61
ci_013                -2.150588e-02 3 1  ON 62
ci_014                 1.374531e-02 3 1  ON 63
ci_015                 1.357468e-02 3 1  ON 64
ci_016                 1.685213e-02 3 1  ON 65
ci_017                 1.606474e-02 3 1  ON 66
ci_018                 1.116342e-02 3 1  ON 67
ci_019                 1.083106e-02 3 1  ON 68
ci_020                 1.815731e-02 3 1  ON 69
ci_021                 1.790886e-02 3 1  ON 70
ci_022                 1.041015e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124911e-03 3 1  ON 73
ci_025                 7.214018e-03 3 1  ON 74
ci_026                 1.196615e-02 3 1  ON 75
ci_027                 1.214393e-02 3 1  ON 76
ci_028                -1.010244e-02 3 1  ON 77
ci_029                -9.846856e-03 3 1  ON 78
ci_030                -4.814225e-03 3 1  ON 79
ci_031                -5.117305e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0489e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1246
    reference variance = 0.224061
====================================================
  Execution time = 3.7983e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5430e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9313e-01
  Total weights = 1.973864685e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0920e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286433716642
                                         uncertainty =       0.001457419498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286433716642
                                         uncertainty =       0.001457419498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378393156
  error estimate for blocks of size 2^( 2) =       0.000392920044
  error estimate for blocks of size 2^( 3) =       0.000406163189
  error estimate for blocks of size 2^( 4) =       0.000416332954
  error estimate for blocks of size 2^( 5) =       0.000421640171
  error estimate for blocks of size 2^( 6) =       0.000424536361
  error estimate for blocks of size 2^( 7) =       0.000426485905

      target function =      -0.923492459154
              le_mean =     -17.206854654763
             les_mean =     296.368975208856
             stat err =       0.000422248848
             autocorr =       1.245232368146
   target nu stat err =       0.000422248848
   target dn stat err =       0.001907329763
      target stat err =       0.003101959700
              std dev =       0.535128732991
             le_variance =       0.286362760872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720685465476e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923501936876       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923501938425       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923501938626       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923501938711       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923501938740       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923501938752       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923501938755       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923501938803       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923501938807       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923501938849       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923501938777       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923501938770       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923501938872       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923501938839       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923501938844       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923501938857       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923501938853       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923501938853       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923501938886       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923501938882       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923501938802       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.923501938964       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.923501938830       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.923501938883       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.923501938777       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.923501938825       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.923501938799       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.923501938878       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.923501938931       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.923501938799       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.923501938907       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.923501938852       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.923501938824       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.923501938825       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.923501938850       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.923501938970       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.923501938950       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.923501938969       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3842e+04 is 1.829449e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923501936876       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923501937263       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923501937314       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923501937335       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923501937327       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923501937353       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923501937350       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923501937254       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923501937359       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923501937360       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923501937450       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923501937390       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923501937391       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923501937206       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923501937504       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923501937511       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923501937338       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923501937176       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923501937354       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923501937288       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923501937323       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.923501937379       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.923501937235       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.923501937875       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.923501937379       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.923501937551       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.923501937590       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.923501936954       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.923501937112       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.923501936952       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.923501937287       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.923501937457       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.923501937256       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.923501937275       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.923501937451       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.923501937316       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.923501937364       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.923501937713       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.5367e+04 is 4.573624e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923501936876       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923501936973       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923501936985       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923501937025       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923501936993       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923501936502       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923501936891       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923501937802       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923501936893       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923501937264       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923501936471       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923501935852       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923501936096       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923501937050       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923501936677       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923501937347       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923501936952       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923501936500       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923501937172       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923501936153       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923501937320       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.923501937646       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.923501937696       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.923501936841       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.923501937646       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.923501936706       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.923501935848       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.923501937706       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.923501935502       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.923501937328       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.923501935791       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.923501936094       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.923501936341       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.923501937166       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.923501937938       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.923501935584       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.923501936374       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.923501937890       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.8147e+05 is 1.143406e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.597874 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8967e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166690e-02 1 1  ON 1
  uu_2                -3.940118e-02 1 1  ON 2
  uu_3                -9.291231e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393115e-02 1 1  ON 7
  uu_8                 7.179524e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810561e-02 1 1  ON 11
  ud_2                -2.402889e-02 1 1  ON 12
  ud_3                -7.733640e-02 1 1  ON 13
  ud_4                -1.141472e-01 1 1  ON 14
  ud_5                -1.343883e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981740e-02 1 1  ON 17
  ud_8                -4.429478e-03 1 1  ON 18
  ud_9                 8.809354e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127693e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856697e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849720e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762498e-02 1 1  ON 31
 eH1_2                -4.695835e-02 1 1  ON 32
 eH1_3                -1.559999e-02 1 1  ON 33
 eH1_4                 1.884943e-02 1 1  ON 34
 eH1_5                 2.620673e-02 1 1  ON 35
 eH1_6                 7.491236e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703706e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994542e-02 1 1  ON 41
 eH2_2                -4.927211e-02 1 1  ON 42
 eH2_3                -1.790933e-02 1 1  ON 43
 eH2_4                 1.638158e-02 1 1  ON 44
 eH2_5                 2.331418e-02 1 1  ON 45
 eH2_6                 7.777076e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.971141e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261621e-02 3 1  ON 50
ci_002                -3.174051e-02 3 1  ON 51
ci_003                -1.241220e-02 3 1  ON 52
ci_004                 2.578194e-02 3 1  ON 53
ci_005                 2.603759e-02 3 1  ON 54
ci_006                -2.086923e-02 3 1  ON 55
ci_007                -2.067499e-02 3 1  ON 56
ci_008                -5.063257e-03 3 1  ON 57
ci_009                -1.563144e-02 3 1  ON 58
ci_010                -1.049465e-02 3 1  ON 59
ci_011                -1.040947e-02 3 1  ON 60
ci_012                -1.050598e-02 3 1  ON 61
ci_013                -2.150588e-02 3 1  ON 62
ci_014                 1.374531e-02 3 1  ON 63
ci_015                 1.357468e-02 3 1  ON 64
ci_016                 1.685213e-02 3 1  ON 65
ci_017                 1.606474e-02 3 1  ON 66
ci_018                 1.116342e-02 3 1  ON 67
ci_019                 1.083106e-02 3 1  ON 68
ci_020                 1.815731e-02 3 1  ON 69
ci_021                 1.790886e-02 3 1  ON 70
ci_022                 1.041015e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124910e-03 3 1  ON 73
ci_025                 7.214018e-03 3 1  ON 74
ci_026                 1.196615e-02 3 1  ON 75
ci_027                 1.214393e-02 3 1  ON 76
ci_028                -1.010244e-02 3 1  ON 77
ci_029                -9.846857e-03 3 1  ON 78
ci_030                -4.814225e-03 3 1  ON 79
ci_031                -5.117307e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1792
    reference variance = 0.289173
====================================================
  Execution time = 3.7725e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9704e-01
  Total weights = 1.9737e+06
  Execution time = 3.2102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289046999028
                                         uncertainty =       0.001742788830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289046999028
                                         uncertainty =       0.001742788830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380137929
  error estimate for blocks of size 2^( 2) =       0.000395113635
  error estimate for blocks of size 2^( 3) =       0.000408729690
  error estimate for blocks of size 2^( 4) =       0.000418481565
  error estimate for blocks of size 2^( 5) =       0.000424736305
  error estimate for blocks of size 2^( 6) =       0.000427833134
  error estimate for blocks of size 2^( 7) =       0.000430497183

      target function =      -0.917351713097
              le_mean =     -17.206304016640
             les_mean =     296.353938698899
             stat err =       0.000425387047
             autocorr =       1.252235794646
   target nu stat err =       0.000425387047
   target dn stat err =       0.002225078690
      target stat err =       0.003543379906
              std dev =       0.537596214652
             le_variance =       0.289009690008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289046997867
                                         uncertainty =       0.001742788784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289046997867
                                         uncertainty =       0.001742788784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380137928
  error estimate for blocks of size 2^( 2) =       0.000395113635
  error estimate for blocks of size 2^( 3) =       0.000408729691
  error estimate for blocks of size 2^( 4) =       0.000418481567
  error estimate for blocks of size 2^( 5) =       0.000424736307
  error estimate for blocks of size 2^( 6) =       0.000427833136
  error estimate for blocks of size 2^( 7) =       0.000430497185

      target function =      -0.917351723312
              le_mean =     -17.206304016614
             les_mean =     296.353938691443
             stat err =       0.000425387049
             autocorr =       1.252235811763
   target nu stat err =       0.000425387049
   target dn stat err =       0.002225078057
      target stat err =       0.003543379018
              std dev =       0.537596213573
             le_variance =       0.289009688848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289046998447
                                         uncertainty =       0.001742788807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289046998447
                                         uncertainty =       0.001742788807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380137929
  error estimate for blocks of size 2^( 2) =       0.000395113635
  error estimate for blocks of size 2^( 3) =       0.000408729691
  error estimate for blocks of size 2^( 4) =       0.000418481566
  error estimate for blocks of size 2^( 5) =       0.000424736306
  error estimate for blocks of size 2^( 6) =       0.000427833135
  error estimate for blocks of size 2^( 7) =       0.000430497184

      target function =      -0.917351718204
              le_mean =     -17.206304016627
             les_mean =     296.353938695171
             stat err =       0.000425387048
             autocorr =       1.252235803217
   target nu stat err =       0.000425387048
   target dn stat err =       0.002225078373
      target stat err =       0.003543379462
              std dev =       0.537596214112
             le_variance =       0.289009689428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289046998955
                                         uncertainty =       0.001742788827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289046998955
                                         uncertainty =       0.001742788827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380137929
  error estimate for blocks of size 2^( 2) =       0.000395113635
  error estimate for blocks of size 2^( 3) =       0.000408729690
  error estimate for blocks of size 2^( 4) =       0.000418481566
  error estimate for blocks of size 2^( 5) =       0.000424736305
  error estimate for blocks of size 2^( 6) =       0.000427833134
  error estimate for blocks of size 2^( 7) =       0.000430497183

      target function =      -0.917351713735
              le_mean =     -17.206304016638
             les_mean =     296.353938698433
             stat err =       0.000425387047
             autocorr =       1.252235795723
   target nu stat err =       0.000425387047
   target dn stat err =       0.002225078650
      target stat err =       0.003543379851
              std dev =       0.537596214584
             le_variance =       0.289009689935


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917351713097        initial
     2.3842e+04     2.3842e+05             1.8294e-08        -0.917351723312  <--
     9.5367e+04     9.5367e+05             4.5736e-09        -0.917351718204
     3.8147e+05     3.8147e+06             1.1434e-09        -0.917351713735

*****************************************************************************
Applying the update for shift_i =   2.3842e+04     and shift_s =   2.3842e+05
*****************************************************************************

  Execution time = 5.3933e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166690e-02 1 1  ON 1
  uu_2                -3.940117e-02 1 1  ON 2
  uu_3                -9.291230e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393115e-02 1 1  ON 7
  uu_8                 7.179522e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810560e-02 1 1  ON 11
  ud_2                -2.402889e-02 1 1  ON 12
  ud_3                -7.733640e-02 1 1  ON 13
  ud_4                -1.141471e-01 1 1  ON 14
  ud_5                -1.343883e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981739e-02 1 1  ON 17
  ud_8                -4.429482e-03 1 1  ON 18
  ud_9                 8.809354e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127693e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856697e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849720e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762497e-02 1 1  ON 31
 eH1_2                -4.695834e-02 1 1  ON 32
 eH1_3                -1.559999e-02 1 1  ON 33
 eH1_4                 1.884943e-02 1 1  ON 34
 eH1_5                 2.620672e-02 1 1  ON 35
 eH1_6                 7.491235e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703707e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994542e-02 1 1  ON 41
 eH2_2                -4.927210e-02 1 1  ON 42
 eH2_3                -1.790933e-02 1 1  ON 43
 eH2_4                 1.638158e-02 1 1  ON 44
 eH2_5                 2.331418e-02 1 1  ON 45
 eH2_6                 7.777076e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.971141e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261621e-02 3 1  ON 50
ci_002                -3.174051e-02 3 1  ON 51
ci_003                -1.241220e-02 3 1  ON 52
ci_004                 2.578193e-02 3 1  ON 53
ci_005                 2.603759e-02 3 1  ON 54
ci_006                -2.086923e-02 3 1  ON 55
ci_007                -2.067498e-02 3 1  ON 56
ci_008                -5.063257e-03 3 1  ON 57
ci_009                -1.563143e-02 3 1  ON 58
ci_010                -1.049465e-02 3 1  ON 59
ci_011                -1.040948e-02 3 1  ON 60
ci_012                -1.050597e-02 3 1  ON 61
ci_013                -2.150587e-02 3 1  ON 62
ci_014                 1.374531e-02 3 1  ON 63
ci_015                 1.357468e-02 3 1  ON 64
ci_016                 1.685213e-02 3 1  ON 65
ci_017                 1.606475e-02 3 1  ON 66
ci_018                 1.116342e-02 3 1  ON 67
ci_019                 1.083106e-02 3 1  ON 68
ci_020                 1.815730e-02 3 1  ON 69
ci_021                 1.790885e-02 3 1  ON 70
ci_022                 1.041015e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124909e-03 3 1  ON 73
ci_025                 7.214017e-03 3 1  ON 74
ci_026                 1.196614e-02 3 1  ON 75
ci_027                 1.214393e-02 3 1  ON 76
ci_028                -1.010244e-02 3 1  ON 77
ci_029                -9.846857e-03 3 1  ON 78
ci_030                -4.814224e-03 3 1  ON 79
ci_031                -5.117310e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0291e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1769
    reference variance = 0.176381
====================================================
  Execution time = 3.8438e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5404e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 3.1078e-01
  Total weights = 1.973874813e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0784e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292129581974
                                         uncertainty =       0.002167736019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292129581974
                                         uncertainty =       0.002167736019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382188703
  error estimate for blocks of size 2^( 2) =       0.000397108965
  error estimate for blocks of size 2^( 3) =       0.000410641373
  error estimate for blocks of size 2^( 4) =       0.000420190734
  error estimate for blocks of size 2^( 5) =       0.000426171769
  error estimate for blocks of size 2^( 6) =       0.000430808607
  error estimate for blocks of size 2^( 7) =       0.000432393499

      target function =      -0.896250040902
              le_mean =     -17.207662716914
             les_mean =     296.414440527685
             stat err =       0.000427391152
             autocorr =       1.250533596853
   target nu stat err =       0.000427391152
   target dn stat err =       0.006415388859
      target stat err =       0.009598074384
              std dev =       0.540496446531
             le_variance =       0.292136408712


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720766271691e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896351665895       residual = 2.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896351684464       residual = 8.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896351690457       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896351692434       residual = 7.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896351692882       residual = 7.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896351693524       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896351693921       residual = 5.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896351695081       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896351695855       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896351696059       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.896351696377       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.896351696715       residual = 9.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.896351697052       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.896351697334       residual = 9.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.896351697511       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.896351697847       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.896351697964       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.896351697976       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.896351698052       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.896351698132       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.896351698191       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.896351698196       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.896351698210       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.896351698242       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.896351698373       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.896351698347       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.896351698378       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.896351698367       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.896351698358       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.896351698400       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.896351698383       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.896351698393       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.896351698379       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.896351698378       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.896351698399       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.896351698374       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.896351698360       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.896351698382       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.896351698403       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.896351698393       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.896351698392       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.896351698378       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.9605e+03 is 3.302415e-07

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896351665895       residual = 2.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896351670537       residual = 8.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896351672036       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896351672530       residual = 7.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896351672571       residual = 7.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896351672802       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896351672908       residual = 5.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896351673182       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896351673413       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896351673406       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.896351673542       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.896351673605       residual = 9.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.896351673641       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.896351673704       residual = 9.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.896351673780       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.896351673839       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.896351673892       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.896351673919       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.896351673892       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.896351673774       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.896351673886       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.896351674021       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.896351673962       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.896351674015       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.896351673991       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.896351674031       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.896351674051       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.896351673969       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.896351673941       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.896351674038       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.896351674069       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.896351674020       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.896351674041       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.896351673929       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.896351674127       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.896351674046       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.896351673956       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.896351673954       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.896351673948       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.896351673964       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.896351673942       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.896351674065       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3842e+04 is 8.256040e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896351665895       residual = 2.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896351667056       residual = 8.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896351667430       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896351667554       residual = 7.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896351667663       residual = 7.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896351667508       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896351667766       residual = 5.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896351667704       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896351667595       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896351667622       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.896351667845       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.896351667633       residual = 9.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.896351667944       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.896351668036       residual = 9.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.896351667708       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.896351668164       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.896351668085       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.896351667983       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.896351667840       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.896351667956       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.896351667585       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.896351667949       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.896351668018       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.896351667502       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.896351667796       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.896351668045       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.896351667720       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.896351667894       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.896351668019       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.896351668269       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.896351667407       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.896351667802       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.896351667635       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.896351667747       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.896351667825       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.896351667901       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.896351668019       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.896351667740       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.896351668187       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.896351668158       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.896351668013       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.896351667691       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.5367e+04 is 2.064010e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.674086 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9306e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166689e-02 1 1  ON 1
  uu_2                -3.940118e-02 1 1  ON 2
  uu_3                -9.291231e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393113e-02 1 1  ON 7
  uu_8                 7.179521e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810560e-02 1 1  ON 11
  ud_2                -2.402890e-02 1 1  ON 12
  ud_3                -7.733641e-02 1 1  ON 13
  ud_4                -1.141472e-01 1 1  ON 14
  ud_5                -1.343883e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981737e-02 1 1  ON 17
  ud_8                -4.429488e-03 1 1  ON 18
  ud_9                 8.809353e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127694e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856697e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849720e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762496e-02 1 1  ON 31
 eH1_2                -4.695834e-02 1 1  ON 32
 eH1_3                -1.559999e-02 1 1  ON 33
 eH1_4                 1.884941e-02 1 1  ON 34
 eH1_5                 2.620670e-02 1 1  ON 35
 eH1_6                 7.491237e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703707e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031284e-01 1 1  ON 40
 eH2_1                -9.994543e-02 1 1  ON 41
 eH2_2                -4.927211e-02 1 1  ON 42
 eH2_3                -1.790932e-02 1 1  ON 43
 eH2_4                 1.638157e-02 1 1  ON 44
 eH2_5                 2.331414e-02 1 1  ON 45
 eH2_6                 7.777074e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.971143e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261621e-02 3 1  ON 50
ci_002                -3.174050e-02 3 1  ON 51
ci_003                -1.241219e-02 3 1  ON 52
ci_004                 2.578193e-02 3 1  ON 53
ci_005                 2.603759e-02 3 1  ON 54
ci_006                -2.086924e-02 3 1  ON 55
ci_007                -2.067498e-02 3 1  ON 56
ci_008                -5.063257e-03 3 1  ON 57
ci_009                -1.563143e-02 3 1  ON 58
ci_010                -1.049463e-02 3 1  ON 59
ci_011                -1.040947e-02 3 1  ON 60
ci_012                -1.050597e-02 3 1  ON 61
ci_013                -2.150587e-02 3 1  ON 62
ci_014                 1.374530e-02 3 1  ON 63
ci_015                 1.357467e-02 3 1  ON 64
ci_016                 1.685212e-02 3 1  ON 65
ci_017                 1.606475e-02 3 1  ON 66
ci_018                 1.116343e-02 3 1  ON 67
ci_019                 1.083105e-02 3 1  ON 68
ci_020                 1.815730e-02 3 1  ON 69
ci_021                 1.790886e-02 3 1  ON 70
ci_022                 1.041014e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124901e-03 3 1  ON 73
ci_025                 7.214013e-03 3 1  ON 74
ci_026                 1.196614e-02 3 1  ON 75
ci_027                 1.214393e-02 3 1  ON 76
ci_028                -1.010244e-02 3 1  ON 77
ci_029                -9.846854e-03 3 1  ON 78
ci_030                -4.814217e-03 3 1  ON 79
ci_031                -5.117310e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2751
    reference variance = 0.236505
====================================================
  Execution time = 3.7371e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9631e-01
  Total weights = 1.9736e+06
  Execution time = 3.2349e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290514109194
                                         uncertainty =       0.001947090932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290514109194
                                         uncertainty =       0.001947090932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381209874
  error estimate for blocks of size 2^( 2) =       0.000395934164
  error estimate for blocks of size 2^( 3) =       0.000409401285
  error estimate for blocks of size 2^( 4) =       0.000419308357
  error estimate for blocks of size 2^( 5) =       0.000425044439
  error estimate for blocks of size 2^( 6) =       0.000427082825
  error estimate for blocks of size 2^( 7) =       0.000427974349

      target function =      -0.918467993099
              le_mean =     -17.207453577199
             les_mean =     296.392773453058
             stat err =       0.000424852493
             autocorr =       1.242075682074
   target nu stat err =       0.000424852493
   target dn stat err =       0.002076503714
      target stat err =       0.003331740000
              std dev =       0.539112173829
             le_variance =       0.290641935970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290514105051
                                         uncertainty =       0.001947090538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290514105051
                                         uncertainty =       0.001947090538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381209871
  error estimate for blocks of size 2^( 2) =       0.000395934169
  error estimate for blocks of size 2^( 3) =       0.000409401298
  error estimate for blocks of size 2^( 4) =       0.000419308376
  error estimate for blocks of size 2^( 5) =       0.000425044460
  error estimate for blocks of size 2^( 6) =       0.000427082847
  error estimate for blocks of size 2^( 7) =       0.000427974370

      target function =      -0.918467945481
              le_mean =     -17.207453578207
             les_mean =     296.392773518119
             stat err =       0.000424852513
             autocorr =       1.242075820761
   target nu stat err =       0.000424852513
   target dn stat err =       0.002076505371
      target stat err =       0.003331742209
              std dev =       0.539112170028
             le_variance =       0.290641931873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290514107122
                                         uncertainty =       0.001947090735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290514107122
                                         uncertainty =       0.001947090735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381209873
  error estimate for blocks of size 2^( 2) =       0.000395934166
  error estimate for blocks of size 2^( 3) =       0.000409401292
  error estimate for blocks of size 2^( 4) =       0.000419308366
  error estimate for blocks of size 2^( 5) =       0.000425044450
  error estimate for blocks of size 2^( 6) =       0.000427082836
  error estimate for blocks of size 2^( 7) =       0.000427974359

      target function =      -0.918467969295
              le_mean =     -17.207453577703
             les_mean =     296.392773485585
             stat err =       0.000424852503
             autocorr =       1.242075751424
   target nu stat err =       0.000424852503
   target dn stat err =       0.002076504543
      target stat err =       0.003331741105
              std dev =       0.539112171929
             le_variance =       0.290641933922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290514108935
                                         uncertainty =       0.001947090907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290514108935
                                         uncertainty =       0.001947090907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381209874
  error estimate for blocks of size 2^( 2) =       0.000395934164
  error estimate for blocks of size 2^( 3) =       0.000409401286
  error estimate for blocks of size 2^( 4) =       0.000419308358
  error estimate for blocks of size 2^( 5) =       0.000425044440
  error estimate for blocks of size 2^( 6) =       0.000427082827
  error estimate for blocks of size 2^( 7) =       0.000427974350

      target function =      -0.918467990124
              le_mean =     -17.207453577262
             les_mean =     296.392773457123
             stat err =       0.000424852494
             autocorr =       1.242075690744
   target nu stat err =       0.000424852494
   target dn stat err =       0.002076503818
      target stat err =       0.003331740138
              std dev =       0.539112173591
             le_variance =       0.290641935714


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918467993099        initial  <--
     5.9605e+03     5.9605e+04             3.3024e-07        -0.918467945481
     2.3842e+04     2.3842e+05             8.2560e-08        -0.918467969295
     9.5367e+04     9.5367e+05             2.0640e-08        -0.918467990124

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.6711
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166690e-02 1 1  ON 1
  uu_2                -3.940117e-02 1 1  ON 2
  uu_3                -9.291230e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393115e-02 1 1  ON 7
  uu_8                 7.179522e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810560e-02 1 1  ON 11
  ud_2                -2.402889e-02 1 1  ON 12
  ud_3                -7.733640e-02 1 1  ON 13
  ud_4                -1.141471e-01 1 1  ON 14
  ud_5                -1.343883e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981739e-02 1 1  ON 17
  ud_8                -4.429482e-03 1 1  ON 18
  ud_9                 8.809354e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127693e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856697e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849720e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762497e-02 1 1  ON 31
 eH1_2                -4.695834e-02 1 1  ON 32
 eH1_3                -1.559999e-02 1 1  ON 33
 eH1_4                 1.884943e-02 1 1  ON 34
 eH1_5                 2.620672e-02 1 1  ON 35
 eH1_6                 7.491235e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703707e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994542e-02 1 1  ON 41
 eH2_2                -4.927210e-02 1 1  ON 42
 eH2_3                -1.790933e-02 1 1  ON 43
 eH2_4                 1.638158e-02 1 1  ON 44
 eH2_5                 2.331418e-02 1 1  ON 45
 eH2_6                 7.777076e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.971141e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261621e-02 3 1  ON 50
ci_002                -3.174051e-02 3 1  ON 51
ci_003                -1.241220e-02 3 1  ON 52
ci_004                 2.578193e-02 3 1  ON 53
ci_005                 2.603759e-02 3 1  ON 54
ci_006                -2.086923e-02 3 1  ON 55
ci_007                -2.067498e-02 3 1  ON 56
ci_008                -5.063257e-03 3 1  ON 57
ci_009                -1.563143e-02 3 1  ON 58
ci_010                -1.049465e-02 3 1  ON 59
ci_011                -1.040948e-02 3 1  ON 60
ci_012                -1.050597e-02 3 1  ON 61
ci_013                -2.150587e-02 3 1  ON 62
ci_014                 1.374531e-02 3 1  ON 63
ci_015                 1.357468e-02 3 1  ON 64
ci_016                 1.685213e-02 3 1  ON 65
ci_017                 1.606475e-02 3 1  ON 66
ci_018                 1.116342e-02 3 1  ON 67
ci_019                 1.083106e-02 3 1  ON 68
ci_020                 1.815730e-02 3 1  ON 69
ci_021                 1.790885e-02 3 1  ON 70
ci_022                 1.041015e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124909e-03 3 1  ON 73
ci_025                 7.214017e-03 3 1  ON 74
ci_026                 1.196614e-02 3 1  ON 75
ci_027                 1.214393e-02 3 1  ON 76
ci_028                -1.010244e-02 3 1  ON 77
ci_029                -9.846857e-03 3 1  ON 78
ci_030                -4.814224e-03 3 1  ON 79
ci_031                -5.117310e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0298e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2518
    reference variance = 0.428408
====================================================
  Execution time = 3.9750e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5414e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9803e-01
  Total weights = 1.973665251e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0614e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290297702200
                                         uncertainty =       0.001910648721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290297702200
                                         uncertainty =       0.001910648721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380953017
  error estimate for blocks of size 2^( 2) =       0.000395534503
  error estimate for blocks of size 2^( 3) =       0.000408873670
  error estimate for blocks of size 2^( 4) =       0.000418274248
  error estimate for blocks of size 2^( 5) =       0.000424295695
  error estimate for blocks of size 2^( 6) =       0.000427074880
  error estimate for blocks of size 2^( 7) =       0.000430584245

      target function =      -0.915781803454
              le_mean =     -17.207297391938
             les_mean =     296.389117297422
             stat err =       0.000425057267
             autocorr =       1.244950423587
   target nu stat err =       0.000425057267
   target dn stat err =       0.002540506899
      target stat err =       0.004019801032
              std dev =       0.538748922619
             le_variance =       0.290250401623


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720729739194e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915798488643       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915798489478       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915798489591       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915798489631       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915798489642       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915798489745       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915798489679       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915798489671       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915798489761       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915798489710       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915798489709       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915798489710       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915798489603       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915798489940       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915798489804       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915798489728       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915798489730       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915798489703       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915798489732       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915798489681       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915798489920       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915798489343       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915798489590       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915798489586       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915798489646       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915798489472       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915798489777       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915798489819       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915798489961       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915798489806       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915798489650       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915798489630       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915798489864       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915798489874       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915798489837       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915798489535       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915798489708       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915798489731       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.9605e+04 is 8.475958e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915798488643       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915798488852       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915798488880       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915798488888       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915798488895       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915798488900       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915798488902       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915798488906       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915798488908       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915798488909       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915798488909       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915798488757       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915798488912       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915798488913       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915798489088       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915798488914       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915798488519       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915798489126       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915798489436       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915798488775       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915798488953       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915798488514       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915798489446       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915798488311       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915798489113       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915798488593       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915798488679       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915798489469       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915798489975       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915798489170       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915798489010       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915798488797       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915798489215       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915798488121       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915798488656       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915798488097       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915798490438       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915798489226       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3842e+05 is 2.118989e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915798488643       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915798488695       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915798488702       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915798488704       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915798488306       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915798488707       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915798490610       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915798488708       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915798489557       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915798488709       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915798488709       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915798488938       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915798488710       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915798488710       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915798489972       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915798488710       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915798490360       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915798487378       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915798489250       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915798488646       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915798489508       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915798489386       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915798488335       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915798494412       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915798486206       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915798488654       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915798485444       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915798490721       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915798488695       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915798485862       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915798487467       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915798488398       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915798486036       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915798487545       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915798489958       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915798488712       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915798490603       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915798486694       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.5367e+05 is 5.297479e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.731172 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0429e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166690e-02 1 1  ON 1
  uu_2                -3.940117e-02 1 1  ON 2
  uu_3                -9.291230e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393115e-02 1 1  ON 7
  uu_8                 7.179522e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810560e-02 1 1  ON 11
  ud_2                -2.402889e-02 1 1  ON 12
  ud_3                -7.733640e-02 1 1  ON 13
  ud_4                -1.141471e-01 1 1  ON 14
  ud_5                -1.343883e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981739e-02 1 1  ON 17
  ud_8                -4.429483e-03 1 1  ON 18
  ud_9                 8.809354e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127693e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856697e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849720e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762497e-02 1 1  ON 31
 eH1_2                -4.695834e-02 1 1  ON 32
 eH1_3                -1.559999e-02 1 1  ON 33
 eH1_4                 1.884943e-02 1 1  ON 34
 eH1_5                 2.620671e-02 1 1  ON 35
 eH1_6                 7.491235e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703707e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994542e-02 1 1  ON 41
 eH2_2                -4.927210e-02 1 1  ON 42
 eH2_3                -1.790932e-02 1 1  ON 43
 eH2_4                 1.638158e-02 1 1  ON 44
 eH2_5                 2.331418e-02 1 1  ON 45
 eH2_6                 7.777076e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.971141e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261621e-02 3 1  ON 50
ci_002                -3.174051e-02 3 1  ON 51
ci_003                -1.241220e-02 3 1  ON 52
ci_004                 2.578193e-02 3 1  ON 53
ci_005                 2.603759e-02 3 1  ON 54
ci_006                -2.086923e-02 3 1  ON 55
ci_007                -2.067498e-02 3 1  ON 56
ci_008                -5.063257e-03 3 1  ON 57
ci_009                -1.563143e-02 3 1  ON 58
ci_010                -1.049465e-02 3 1  ON 59
ci_011                -1.040948e-02 3 1  ON 60
ci_012                -1.050597e-02 3 1  ON 61
ci_013                -2.150587e-02 3 1  ON 62
ci_014                 1.374531e-02 3 1  ON 63
ci_015                 1.357468e-02 3 1  ON 64
ci_016                 1.685213e-02 3 1  ON 65
ci_017                 1.606475e-02 3 1  ON 66
ci_018                 1.116342e-02 3 1  ON 67
ci_019                 1.083106e-02 3 1  ON 68
ci_020                 1.815730e-02 3 1  ON 69
ci_021                 1.790885e-02 3 1  ON 70
ci_022                 1.041015e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124908e-03 3 1  ON 73
ci_025                 7.214017e-03 3 1  ON 74
ci_026                 1.196614e-02 3 1  ON 75
ci_027                 1.214393e-02 3 1  ON 76
ci_028                -1.010244e-02 3 1  ON 77
ci_029                -9.846857e-03 3 1  ON 78
ci_030                -4.814223e-03 3 1  ON 79
ci_031                -5.117309e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2123
    reference variance = 0.27037
====================================================
  Execution time = 3.7571e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0390e-01
  Total weights = 1.9739e+06
  Execution time = 3.2418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293336927696
                                         uncertainty =       0.001677731146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293336927696
                                         uncertainty =       0.001677731146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382956579
  error estimate for blocks of size 2^( 2) =       0.000397784681
  error estimate for blocks of size 2^( 3) =       0.000411682212
  error estimate for blocks of size 2^( 4) =       0.000422261663
  error estimate for blocks of size 2^( 5) =       0.000428933675
  error estimate for blocks of size 2^( 6) =       0.000432281869
  error estimate for blocks of size 2^( 7) =       0.000433201075

      target function =      -0.906768700687
              le_mean =     -17.206120308704
             les_mean =     296.354479017013
             stat err =       0.000429169571
             autocorr =       1.255910737034
   target nu stat err =       0.000429169571
   target dn stat err =       0.003297890510
      target stat err =       0.005073225859
              std dev =       0.541582388217
             le_variance =       0.293311483227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293336928300
                                         uncertainty =       0.001677731215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293336928300
                                         uncertainty =       0.001677731215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382956580
  error estimate for blocks of size 2^( 2) =       0.000397784682
  error estimate for blocks of size 2^( 3) =       0.000411682213
  error estimate for blocks of size 2^( 4) =       0.000422261665
  error estimate for blocks of size 2^( 5) =       0.000428933677
  error estimate for blocks of size 2^( 6) =       0.000432281871
  error estimate for blocks of size 2^( 7) =       0.000433201077

      target function =      -0.906768859694
              le_mean =     -17.206120308717
             les_mean =     296.354478913762
             stat err =       0.000429169572
             autocorr =       1.255910743710
   target nu stat err =       0.000429169572
   target dn stat err =       0.003297826199
      target stat err =       0.005073130680
              std dev =       0.541582388776
             le_variance =       0.293311483832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293336927998
                                         uncertainty =       0.001677731181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293336927998
                                         uncertainty =       0.001677731181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382956579
  error estimate for blocks of size 2^( 2) =       0.000397784682
  error estimate for blocks of size 2^( 3) =       0.000411682212
  error estimate for blocks of size 2^( 4) =       0.000422261664
  error estimate for blocks of size 2^( 5) =       0.000428933676
  error estimate for blocks of size 2^( 6) =       0.000432281870
  error estimate for blocks of size 2^( 7) =       0.000433201076

      target function =      -0.906768780192
              le_mean =     -17.206120308711
             les_mean =     296.354478965386
             stat err =       0.000429169572
             autocorr =       1.255910740373
   target nu stat err =       0.000429169572
   target dn stat err =       0.003297858353
      target stat err =       0.005073178268
              std dev =       0.541582388496
             le_variance =       0.293311483529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293336927734
                                         uncertainty =       0.001677731150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293336927734
                                         uncertainty =       0.001677731150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382956579
  error estimate for blocks of size 2^( 2) =       0.000397784681
  error estimate for blocks of size 2^( 3) =       0.000411682212
  error estimate for blocks of size 2^( 4) =       0.000422261663
  error estimate for blocks of size 2^( 5) =       0.000428933675
  error estimate for blocks of size 2^( 6) =       0.000432281870
  error estimate for blocks of size 2^( 7) =       0.000433201075

      target function =      -0.906768710625
              le_mean =     -17.206120308705
             les_mean =     296.354479010559
             stat err =       0.000429169571
             autocorr =       1.255910737460
   target nu stat err =       0.000429169571
   target dn stat err =       0.003297886490
      target stat err =       0.005073219910
              std dev =       0.541582388252
             le_variance =       0.293311483264


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.906768700687        initial
     5.9605e+04     5.9605e+05             8.4760e-09        -0.906768859694  <--
     2.3842e+05     2.3842e+06             2.1190e-09        -0.906768780192
     9.5367e+05     9.5367e+06             5.2975e-10        -0.906768710625

*****************************************************************************
Applying the update for shift_i =   5.9605e+04     and shift_s =   5.9605e+05
*****************************************************************************

  Execution time = 5.3871e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166691e-02 1 1  ON 1
  uu_2                -3.940117e-02 1 1  ON 2
  uu_3                -9.291230e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393116e-02 1 1  ON 7
  uu_8                 7.179521e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810560e-02 1 1  ON 11
  ud_2                -2.402889e-02 1 1  ON 12
  ud_3                -7.733640e-02 1 1  ON 13
  ud_4                -1.141471e-01 1 1  ON 14
  ud_5                -1.343883e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981739e-02 1 1  ON 17
  ud_8                -4.429484e-03 1 1  ON 18
  ud_9                 8.809354e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127693e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856697e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849720e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762497e-02 1 1  ON 31
 eH1_2                -4.695834e-02 1 1  ON 32
 eH1_3                -1.559999e-02 1 1  ON 33
 eH1_4                 1.884943e-02 1 1  ON 34
 eH1_5                 2.620671e-02 1 1  ON 35
 eH1_6                 7.491235e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703707e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994542e-02 1 1  ON 41
 eH2_2                -4.927210e-02 1 1  ON 42
 eH2_3                -1.790932e-02 1 1  ON 43
 eH2_4                 1.638158e-02 1 1  ON 44
 eH2_5                 2.331418e-02 1 1  ON 45
 eH2_6                 7.777076e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.971141e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261621e-02 3 1  ON 50
ci_002                -3.174051e-02 3 1  ON 51
ci_003                -1.241220e-02 3 1  ON 52
ci_004                 2.578194e-02 3 1  ON 53
ci_005                 2.603759e-02 3 1  ON 54
ci_006                -2.086923e-02 3 1  ON 55
ci_007                -2.067498e-02 3 1  ON 56
ci_008                -5.063255e-03 3 1  ON 57
ci_009                -1.563143e-02 3 1  ON 58
ci_010                -1.049465e-02 3 1  ON 59
ci_011                -1.040947e-02 3 1  ON 60
ci_012                -1.050597e-02 3 1  ON 61
ci_013                -2.150588e-02 3 1  ON 62
ci_014                 1.374531e-02 3 1  ON 63
ci_015                 1.357468e-02 3 1  ON 64
ci_016                 1.685213e-02 3 1  ON 65
ci_017                 1.606474e-02 3 1  ON 66
ci_018                 1.116342e-02 3 1  ON 67
ci_019                 1.083106e-02 3 1  ON 68
ci_020                 1.815730e-02 3 1  ON 69
ci_021                 1.790885e-02 3 1  ON 70
ci_022                 1.041015e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124907e-03 3 1  ON 73
ci_025                 7.214017e-03 3 1  ON 74
ci_026                 1.196614e-02 3 1  ON 75
ci_027                 1.214394e-02 3 1  ON 76
ci_028                -1.010244e-02 3 1  ON 77
ci_029                -9.846856e-03 3 1  ON 78
ci_030                -4.814222e-03 3 1  ON 79
ci_031                -5.117307e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0431e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.22
    reference variance = 0.206663
====================================================
  Execution time = 3.8113e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5432e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9842e-01
  Total weights = 1.973856088e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0946e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290664847959
                                         uncertainty =       0.001843501857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290664847959
                                         uncertainty =       0.001843501857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381242643
  error estimate for blocks of size 2^( 2) =       0.000395988889
  error estimate for blocks of size 2^( 3) =       0.000409960922
  error estimate for blocks of size 2^( 4) =       0.000419847054
  error estimate for blocks of size 2^( 5) =       0.000425324174
  error estimate for blocks of size 2^( 6) =       0.000428369712
  error estimate for blocks of size 2^( 7) =       0.000430761037

      target function =      -0.915201048511
              le_mean =     -17.206225204108
             les_mean =     296.352607512211
             stat err =       0.000426075494
             autocorr =       1.249022233324
   target nu stat err =       0.000426075494
   target dn stat err =       0.002587317573
      target stat err =       0.004078582589
              std dev =       0.539158516757
             le_variance =       0.290691906192


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720622520411e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915218218575       residual = 4.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915218219628       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915218220061       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915218220144       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915218220202       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915218220207       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915218220215       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915218220264       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915218220255       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915218220245       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915218220341       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915218220274       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915218220275       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915218220318       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915218220317       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915218220337       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915218220314       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915218220316       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915218220356       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915218220287       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915218220330       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915218220346       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915218220335       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915218220287       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915218220291       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915218220278       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915218220423       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915218220277       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915218220342       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915218220313       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915218220319       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915218220422       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915218220255       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915218220413       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915218220318       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915218220330       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4901e+04 is 2.742691e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915218218575       residual = 4.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915218218839       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915218218947       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915218218968       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915218218982       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915218218985       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915218218991       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915218218991       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915218218995       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915218218961       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915218219034       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915218219051       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915218219021       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915218219247       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915218219157       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915218218832       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915218219065       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915218218953       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915218219145       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915218219036       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915218219011       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915218218988       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915218218928       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915218219081       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915218219036       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915218219009       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915218218814       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915218218901       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915218218968       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915218219114       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915218218854       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915218218907       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915218219086       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915218219161       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915218218872       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915218218939       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.9605e+04 is 6.856732e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915218218575       residual = 4.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915218218641       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915218218668       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915218218666       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915218218682       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915218218678       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915218219050       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915218218679       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915218218680       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915218218681       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915218218764       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915218218682       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915218217909       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915218219156       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915218218850       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915218219510       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915218219019       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915218218547       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915218218458       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915218219136       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915218218192       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915218217866       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915218218866       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915218218723       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915218220040       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915218218581       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915218217903       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915218217924       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915218219033       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915218216693       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915218219632       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915218219829       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915218217646       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915218218904       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915218217892       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915218218494       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3842e+05 is 1.714183e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.780373 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9115e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166691e-02 1 1  ON 1
  uu_2                -3.940117e-02 1 1  ON 2
  uu_3                -9.291230e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393116e-02 1 1  ON 7
  uu_8                 7.179521e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810560e-02 1 1  ON 11
  ud_2                -2.402890e-02 1 1  ON 12
  ud_3                -7.733640e-02 1 1  ON 13
  ud_4                -1.141471e-01 1 1  ON 14
  ud_5                -1.343883e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981739e-02 1 1  ON 17
  ud_8                -4.429483e-03 1 1  ON 18
  ud_9                 8.809354e-02 1 1  ON 19
  eO_0                -7.053858e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127693e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856697e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849720e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762497e-02 1 1  ON 31
 eH1_2                -4.695834e-02 1 1  ON 32
 eH1_3                -1.559998e-02 1 1  ON 33
 eH1_4                 1.884943e-02 1 1  ON 34
 eH1_5                 2.620670e-02 1 1  ON 35
 eH1_6                 7.491235e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703707e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994542e-02 1 1  ON 41
 eH2_2                -4.927210e-02 1 1  ON 42
 eH2_3                -1.790932e-02 1 1  ON 43
 eH2_4                 1.638158e-02 1 1  ON 44
 eH2_5                 2.331418e-02 1 1  ON 45
 eH2_6                 7.777076e-02 1 1  ON 46
 eH2_7                 1.127071e-01 1 1  ON 47
 eH2_8                 9.971141e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261621e-02 3 1  ON 50
ci_002                -3.174051e-02 3 1  ON 51
ci_003                -1.241220e-02 3 1  ON 52
ci_004                 2.578194e-02 3 1  ON 53
ci_005                 2.603759e-02 3 1  ON 54
ci_006                -2.086923e-02 3 1  ON 55
ci_007                -2.067498e-02 3 1  ON 56
ci_008                -5.063255e-03 3 1  ON 57
ci_009                -1.563143e-02 3 1  ON 58
ci_010                -1.049465e-02 3 1  ON 59
ci_011                -1.040947e-02 3 1  ON 60
ci_012                -1.050597e-02 3 1  ON 61
ci_013                -2.150588e-02 3 1  ON 62
ci_014                 1.374531e-02 3 1  ON 63
ci_015                 1.357468e-02 3 1  ON 64
ci_016                 1.685213e-02 3 1  ON 65
ci_017                 1.606474e-02 3 1  ON 66
ci_018                 1.116343e-02 3 1  ON 67
ci_019                 1.083106e-02 3 1  ON 68
ci_020                 1.815730e-02 3 1  ON 69
ci_021                 1.790885e-02 3 1  ON 70
ci_022                 1.041015e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124907e-03 3 1  ON 73
ci_025                 7.214016e-03 3 1  ON 74
ci_026                 1.196614e-02 3 1  ON 75
ci_027                 1.214394e-02 3 1  ON 76
ci_028                -1.010244e-02 3 1  ON 77
ci_029                -9.846856e-03 3 1  ON 78
ci_030                -4.814222e-03 3 1  ON 79
ci_031                -5.117306e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2255
    reference variance = 0.237361
====================================================
  Execution time = 3.7577e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0077e-01
  Total weights = 1.9737e+06
  Execution time = 3.2324e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292140035780
                                         uncertainty =       0.002186724438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292140035780
                                         uncertainty =       0.002186724438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382162386
  error estimate for blocks of size 2^( 2) =       0.000397321831
  error estimate for blocks of size 2^( 3) =       0.000410380763
  error estimate for blocks of size 2^( 4) =       0.000419571594
  error estimate for blocks of size 2^( 5) =       0.000426212540
  error estimate for blocks of size 2^( 6) =       0.000428565126
  error estimate for blocks of size 2^( 7) =       0.000428235512

      target function =      -0.911538738929
              le_mean =     -17.207197449335
             les_mean =     296.388410569885
             stat err =       0.000425646193
             autocorr =       1.240513878402
   target nu stat err =       0.000425646193
   target dn stat err =       0.003353999919
      target stat err =       0.005221287687
              std dev =       0.540459229304
             le_variance =       0.292096178540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292140033096
                                         uncertainty =       0.002186724854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292140033096
                                         uncertainty =       0.002186724854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382162384
  error estimate for blocks of size 2^( 2) =       0.000397321831
  error estimate for blocks of size 2^( 3) =       0.000410380764
  error estimate for blocks of size 2^( 4) =       0.000419571596
  error estimate for blocks of size 2^( 5) =       0.000426212544
  error estimate for blocks of size 2^( 6) =       0.000428565130
  error estimate for blocks of size 2^( 7) =       0.000428235516

      target function =      -0.911538751645
              le_mean =     -17.207197449334
             les_mean =     296.388410561593
             stat err =       0.000425646196
             autocorr =       1.240513908717
   target nu stat err =       0.000425646196
   target dn stat err =       0.003354001495
      target stat err =       0.005221290239
              std dev =       0.540459226822
             le_variance =       0.292096175857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292140034438
                                         uncertainty =       0.002186724646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292140034438
                                         uncertainty =       0.002186724646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382162385
  error estimate for blocks of size 2^( 2) =       0.000397321831
  error estimate for blocks of size 2^( 3) =       0.000410380763
  error estimate for blocks of size 2^( 4) =       0.000419571595
  error estimate for blocks of size 2^( 5) =       0.000426212542
  error estimate for blocks of size 2^( 6) =       0.000428565128
  error estimate for blocks of size 2^( 7) =       0.000428235514

      target function =      -0.911538745288
              le_mean =     -17.207197449335
             les_mean =     296.388410565738
             stat err =       0.000425646195
             autocorr =       1.240513893559
   target nu stat err =       0.000425646195
   target dn stat err =       0.003354000707
      target stat err =       0.005221288963
              std dev =       0.540459228063
             le_variance =       0.292096177198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292140035612
                                         uncertainty =       0.002186724464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292140035612
                                         uncertainty =       0.002186724464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382162386
  error estimate for blocks of size 2^( 2) =       0.000397321831
  error estimate for blocks of size 2^( 3) =       0.000410380763
  error estimate for blocks of size 2^( 4) =       0.000419571594
  error estimate for blocks of size 2^( 5) =       0.000426212541
  error estimate for blocks of size 2^( 6) =       0.000428565126
  error estimate for blocks of size 2^( 7) =       0.000428235512

      target function =      -0.911538739724
              le_mean =     -17.207197449335
             les_mean =     296.388410569367
             stat err =       0.000425646193
             autocorr =       1.240513880301
   target nu stat err =       0.000425646193
   target dn stat err =       0.003354000017
      target stat err =       0.005221287846
              std dev =       0.540459229149
             le_variance =       0.292096178372


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911538738929        initial
     1.4901e+04     1.4901e+05             2.7427e-08        -0.911538751645  <--
     5.9605e+04     5.9605e+05             6.8567e-09        -0.911538745288
     2.3842e+05     2.3842e+06             1.7142e-09        -0.911538739724

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 5.3887e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166691e-02 1 1  ON 1
  uu_2                -3.940117e-02 1 1  ON 2
  uu_3                -9.291230e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393116e-02 1 1  ON 7
  uu_8                 7.179519e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810559e-02 1 1  ON 11
  ud_2                -2.402890e-02 1 1  ON 12
  ud_3                -7.733640e-02 1 1  ON 13
  ud_4                -1.141472e-01 1 1  ON 14
  ud_5                -1.343883e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981738e-02 1 1  ON 17
  ud_8                -4.429482e-03 1 1  ON 18
  ud_9                 8.809354e-02 1 1  ON 19
  eO_0                -7.053857e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127693e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856697e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849720e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018798e-01 1 1  ON 30
 eH1_1                -9.762497e-02 1 1  ON 31
 eH1_2                -4.695833e-02 1 1  ON 32
 eH1_3                -1.559998e-02 1 1  ON 33
 eH1_4                 1.884942e-02 1 1  ON 34
 eH1_5                 2.620669e-02 1 1  ON 35
 eH1_6                 7.491234e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703708e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994542e-02 1 1  ON 41
 eH2_2                -4.927210e-02 1 1  ON 42
 eH2_3                -1.790932e-02 1 1  ON 43
 eH2_4                 1.638158e-02 1 1  ON 44
 eH2_5                 2.331417e-02 1 1  ON 45
 eH2_6                 7.777076e-02 1 1  ON 46
 eH2_7                 1.127070e-01 1 1  ON 47
 eH2_8                 9.971142e-02 1 1  ON 48
 eH2_9                 2.792582e-02 1 1  ON 49
ci_001                -4.261621e-02 3 1  ON 50
ci_002                -3.174051e-02 3 1  ON 51
ci_003                -1.241220e-02 3 1  ON 52
ci_004                 2.578193e-02 3 1  ON 53
ci_005                 2.603758e-02 3 1  ON 54
ci_006                -2.086923e-02 3 1  ON 55
ci_007                -2.067499e-02 3 1  ON 56
ci_008                -5.063255e-03 3 1  ON 57
ci_009                -1.563142e-02 3 1  ON 58
ci_010                -1.049465e-02 3 1  ON 59
ci_011                -1.040947e-02 3 1  ON 60
ci_012                -1.050597e-02 3 1  ON 61
ci_013                -2.150588e-02 3 1  ON 62
ci_014                 1.374531e-02 3 1  ON 63
ci_015                 1.357468e-02 3 1  ON 64
ci_016                 1.685213e-02 3 1  ON 65
ci_017                 1.606475e-02 3 1  ON 66
ci_018                 1.116343e-02 3 1  ON 67
ci_019                 1.083106e-02 3 1  ON 68
ci_020                 1.815730e-02 3 1  ON 69
ci_021                 1.790885e-02 3 1  ON 70
ci_022                 1.041015e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124905e-03 3 1  ON 73
ci_025                 7.214014e-03 3 1  ON 74
ci_026                 1.196614e-02 3 1  ON 75
ci_027                 1.214393e-02 3 1  ON 76
ci_028                -1.010244e-02 3 1  ON 77
ci_029                -9.846854e-03 3 1  ON 78
ci_030                -4.814222e-03 3 1  ON 79
ci_031                -5.117303e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0301e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2644
    reference variance = 0.285044
====================================================
  Execution time = 3.8041e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5384e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 2.9957e-01
  Total weights = 1.973736601e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0790e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291592236944
                                         uncertainty =       0.002158935882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291592236944
                                         uncertainty =       0.002158935882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381870822
  error estimate for blocks of size 2^( 2) =       0.000396790108
  error estimate for blocks of size 2^( 3) =       0.000410119184
  error estimate for blocks of size 2^( 4) =       0.000419493977
  error estimate for blocks of size 2^( 5) =       0.000425488464
  error estimate for blocks of size 2^( 6) =       0.000428069734
  error estimate for blocks of size 2^( 7) =       0.000429321561

      target function =      -0.913375603342
              le_mean =     -17.207759306523
             les_mean =     296.406553502765
             stat err =       0.000425593434
             autocorr =       1.242100926369
   target nu stat err =       0.000425593434
   target dn stat err =       0.002813922868
      target stat err =       0.004420075042
              std dev =       0.540046895616
             le_variance =       0.291650649464


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720775930652e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913395982495       residual = 8.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913395991146       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913395994124       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913395994932       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913395995075       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913395995206       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913395995368       residual = 7.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913395995425       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913395995415       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913395995467       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913395995513       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913395995568       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913395995663       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913395995724       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913395995781       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913395995834       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913395995898       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913395995901       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913395995893       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913395995895       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913395995846       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913395995875       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913395995883       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913395995904       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913395995891       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913395995894       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913395995903       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913395995887       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913395995919       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913395995916       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913395995929       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913395995935       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913395995900       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913395995906       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913395995908       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913395995918       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913395995894       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.7253e+03 is 1.222970e-07

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913395982495       residual = 8.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913395984658       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913395985403       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913395985605       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913395985633       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913395985674       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913395985729       residual = 7.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913395985732       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913395985717       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913395985753       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913395985788       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913395985711       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913395985769       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913395985833       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913395985747       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913395985813       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913395985868       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913395985820       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913395985895       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913395985811       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913395985854       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913395985821       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913395985850       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913395985844       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913395985870       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913395985810       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913395985829       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913395985903       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913395985830       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913395985787       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913395985846       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913395985872       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913395985856       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913395985886       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913395985804       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913395985857       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913395985826       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4901e+04 is 3.057432e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913395982495       residual = 8.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913395983036       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913395983222       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913395983273       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913395983282       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913395983277       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913395983268       residual = 7.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913395983215       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913395983226       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913395983383       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913395983288       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913395983251       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913395983141       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913395983478       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913395983265       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913395983320       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913395983342       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913395983328       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913395983368       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913395983349       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913395983382       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913395983348       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913395983416       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913395983201       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913395983147       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913395983096       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913395983228       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913395983233       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913395983497       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913395983512       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913395983137       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913395983468       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913395983309       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913395983379       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913395983312       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913395983449       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913395983462       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.9605e+04 is 7.643582e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.833622 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8891e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166691e-02 1 1  ON 1
  uu_2                -3.940116e-02 1 1  ON 2
  uu_3                -9.291229e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393118e-02 1 1  ON 7
  uu_8                 7.179516e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810559e-02 1 1  ON 11
  ud_2                -2.402890e-02 1 1  ON 12
  ud_3                -7.733641e-02 1 1  ON 13
  ud_4                -1.141471e-01 1 1  ON 14
  ud_5                -1.343882e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981736e-02 1 1  ON 17
  ud_8                -4.429488e-03 1 1  ON 18
  ud_9                 8.809353e-02 1 1  ON 19
  eO_0                -7.053857e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127693e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613803e-01 1 1  ON 24
  eO_5                 2.856697e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252759e-01 1 1  ON 27
  eO_8                 2.849721e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018799e-01 1 1  ON 30
 eH1_1                -9.762497e-02 1 1  ON 31
 eH1_2                -4.695832e-02 1 1  ON 32
 eH1_3                -1.559998e-02 1 1  ON 33
 eH1_4                 1.884943e-02 1 1  ON 34
 eH1_5                 2.620669e-02 1 1  ON 35
 eH1_6                 7.491234e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703709e-02 1 1  ON 38
 eH1_9                 2.520325e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994541e-02 1 1  ON 41
 eH2_2                -4.927209e-02 1 1  ON 42
 eH2_3                -1.790931e-02 1 1  ON 43
 eH2_4                 1.638157e-02 1 1  ON 44
 eH2_5                 2.331416e-02 1 1  ON 45
 eH2_6                 7.777075e-02 1 1  ON 46
 eH2_7                 1.127070e-01 1 1  ON 47
 eH2_8                 9.971143e-02 1 1  ON 48
 eH2_9                 2.792582e-02 1 1  ON 49
ci_001                -4.261621e-02 3 1  ON 50
ci_002                -3.174050e-02 3 1  ON 51
ci_003                -1.241220e-02 3 1  ON 52
ci_004                 2.578193e-02 3 1  ON 53
ci_005                 2.603758e-02 3 1  ON 54
ci_006                -2.086923e-02 3 1  ON 55
ci_007                -2.067499e-02 3 1  ON 56
ci_008                -5.063253e-03 3 1  ON 57
ci_009                -1.563142e-02 3 1  ON 58
ci_010                -1.049464e-02 3 1  ON 59
ci_011                -1.040946e-02 3 1  ON 60
ci_012                -1.050597e-02 3 1  ON 61
ci_013                -2.150588e-02 3 1  ON 62
ci_014                 1.374531e-02 3 1  ON 63
ci_015                 1.357467e-02 3 1  ON 64
ci_016                 1.685212e-02 3 1  ON 65
ci_017                 1.606474e-02 3 1  ON 66
ci_018                 1.116342e-02 3 1  ON 67
ci_019                 1.083106e-02 3 1  ON 68
ci_020                 1.815730e-02 3 1  ON 69
ci_021                 1.790886e-02 3 1  ON 70
ci_022                 1.041015e-02 3 1  ON 71
ci_023                 1.092407e-02 3 1  ON 72
ci_024                 7.124901e-03 3 1  ON 73
ci_025                 7.214001e-03 3 1  ON 74
ci_026                 1.196614e-02 3 1  ON 75
ci_027                 1.214394e-02 3 1  ON 76
ci_028                -1.010243e-02 3 1  ON 77
ci_029                -9.846858e-03 3 1  ON 78
ci_030                -4.814229e-03 3 1  ON 79
ci_031                -5.117296e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2831
    reference variance = 0.278933
====================================================
  Execution time = 3.7659e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0027e-01
  Total weights = 1.9736e+06
  Execution time = 3.1484e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292229194169
                                         uncertainty =       0.001900289095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292229194169
                                         uncertainty =       0.001900289095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382238417
  error estimate for blocks of size 2^( 2) =       0.000397191716
  error estimate for blocks of size 2^( 3) =       0.000411005738
  error estimate for blocks of size 2^( 4) =       0.000421295307
  error estimate for blocks of size 2^( 5) =       0.000427386152
  error estimate for blocks of size 2^( 6) =       0.000431688470
  error estimate for blocks of size 2^( 7) =       0.000430730710

      target function =      -0.912317808011
              le_mean =     -17.207232059254
             les_mean =     296.389104053856
             stat err =       0.000427775160
             autocorr =       1.252455939154
   target nu stat err =       0.000427775160
   target dn stat err =       0.002552055826
      target stat err =       0.004007830425
              std dev =       0.540566753558
             le_variance =       0.292212415052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292229194935
                                         uncertainty =       0.001900288463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292229194935
                                         uncertainty =       0.001900288463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382238418
  error estimate for blocks of size 2^( 2) =       0.000397191724
  error estimate for blocks of size 2^( 3) =       0.000411005754
  error estimate for blocks of size 2^( 4) =       0.000421295330
  error estimate for blocks of size 2^( 5) =       0.000427386179
  error estimate for blocks of size 2^( 6) =       0.000431688498
  error estimate for blocks of size 2^( 7) =       0.000430730738

      target function =      -0.912317892724
              le_mean =     -17.207232059578
             les_mean =     296.389104010210
             stat err =       0.000427775186
             autocorr =       1.252456090244
   target nu stat err =       0.000427775186
   target dn stat err =       0.002552051984
      target stat err =       0.004007825331
              std dev =       0.540566754330
             le_variance =       0.292212415887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292229194552
                                         uncertainty =       0.001900288779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292229194552
                                         uncertainty =       0.001900288779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382238417
  error estimate for blocks of size 2^( 2) =       0.000397191720
  error estimate for blocks of size 2^( 3) =       0.000411005746
  error estimate for blocks of size 2^( 4) =       0.000421295318
  error estimate for blocks of size 2^( 5) =       0.000427386166
  error estimate for blocks of size 2^( 6) =       0.000431688484
  error estimate for blocks of size 2^( 7) =       0.000430730724

      target function =      -0.912317850401
              le_mean =     -17.207232059416
             les_mean =     296.389104032011
             stat err =       0.000427775173
             autocorr =       1.252456014703
   target nu stat err =       0.000427775173
   target dn stat err =       0.002552053905
      target stat err =       0.004007827877
              std dev =       0.540566753944
             le_variance =       0.292212415469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292229194217
                                         uncertainty =       0.001900289056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292229194217
                                         uncertainty =       0.001900289056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382238417
  error estimate for blocks of size 2^( 2) =       0.000397191716
  error estimate for blocks of size 2^( 3) =       0.000411005739
  error estimate for blocks of size 2^( 4) =       0.000421295309
  error estimate for blocks of size 2^( 5) =       0.000427386154
  error estimate for blocks of size 2^( 6) =       0.000431688472
  error estimate for blocks of size 2^( 7) =       0.000430730711

      target function =      -0.912317813314
              le_mean =     -17.207232059274
             les_mean =     296.389104051123
             stat err =       0.000427775161
             autocorr =       1.252455948598
   target nu stat err =       0.000427775161
   target dn stat err =       0.002552055586
      target stat err =       0.004007830106
              std dev =       0.540566753606
             le_variance =       0.292212415105


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912317808011        initial
     3.7253e+03     3.7253e+04             1.2230e-07        -0.912317892724  <--
     1.4901e+04     1.4901e+05             3.0574e-08        -0.912317850401
     5.9605e+04     5.9605e+05             7.6436e-09        -0.912317813314

*****************************************************************************
Applying the update for shift_i =   3.7253e+03     and shift_s =   3.7253e+04
*****************************************************************************

  Execution time = 5.7452e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166694e-02 1 1  ON 1
  uu_2                -3.940114e-02 1 1  ON 2
  uu_3                -9.291227e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137867e-01 1 1  ON 6
  uu_7                -5.393123e-02 1 1  ON 7
  uu_8                 7.179506e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081019e-01 1 1  ON 10
  ud_1                 7.810557e-02 1 1  ON 11
  ud_2                -2.402891e-02 1 1  ON 12
  ud_3                -7.733642e-02 1 1  ON 13
  ud_4                -1.141471e-01 1 1  ON 14
  ud_5                -1.343882e-01 1 1  ON 15
  ud_6                -1.304668e-01 1 1  ON 16
  ud_7                -8.981732e-02 1 1  ON 17
  ud_8                -4.429507e-03 1 1  ON 18
  ud_9                 8.809351e-02 1 1  ON 19
  eO_0                -7.053857e-01 1 1  ON 20
  eO_1                -4.211854e-01 1 1  ON 21
  eO_2                -4.127692e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613802e-01 1 1  ON 24
  eO_5                 2.856697e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252760e-01 1 1  ON 27
  eO_8                 2.849721e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018799e-01 1 1  ON 30
 eH1_1                -9.762498e-02 1 1  ON 31
 eH1_2                -4.695831e-02 1 1  ON 32
 eH1_3                -1.559996e-02 1 1  ON 33
 eH1_4                 1.884945e-02 1 1  ON 34
 eH1_5                 2.620670e-02 1 1  ON 35
 eH1_6                 7.491234e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703710e-02 1 1  ON 38
 eH1_9                 2.520326e-02 1 1  ON 39
 eH2_0                -2.031284e-01 1 1  ON 40
 eH2_1                -9.994538e-02 1 1  ON 41
 eH2_2                -4.927206e-02 1 1  ON 42
 eH2_3                -1.790929e-02 1 1  ON 43
 eH2_4                 1.638154e-02 1 1  ON 44
 eH2_5                 2.331413e-02 1 1  ON 45
 eH2_6                 7.777072e-02 1 1  ON 46
 eH2_7                 1.127070e-01 1 1  ON 47
 eH2_8                 9.971145e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261620e-02 3 1  ON 50
ci_002                -3.174049e-02 3 1  ON 51
ci_003                -1.241219e-02 3 1  ON 52
ci_004                 2.578193e-02 3 1  ON 53
ci_005                 2.603757e-02 3 1  ON 54
ci_006                -2.086922e-02 3 1  ON 55
ci_007                -2.067499e-02 3 1  ON 56
ci_008                -5.063245e-03 3 1  ON 57
ci_009                -1.563140e-02 3 1  ON 58
ci_010                -1.049463e-02 3 1  ON 59
ci_011                -1.040944e-02 3 1  ON 60
ci_012                -1.050596e-02 3 1  ON 61
ci_013                -2.150588e-02 3 1  ON 62
ci_014                 1.374531e-02 3 1  ON 63
ci_015                 1.357466e-02 3 1  ON 64
ci_016                 1.685209e-02 3 1  ON 65
ci_017                 1.606474e-02 3 1  ON 66
ci_018                 1.116342e-02 3 1  ON 67
ci_019                 1.083105e-02 3 1  ON 68
ci_020                 1.815730e-02 3 1  ON 69
ci_021                 1.790886e-02 3 1  ON 70
ci_022                 1.041014e-02 3 1  ON 71
ci_023                 1.092406e-02 3 1  ON 72
ci_024                 7.124889e-03 3 1  ON 73
ci_025                 7.213962e-03 3 1  ON 74
ci_026                 1.196614e-02 3 1  ON 75
ci_027                 1.214396e-02 3 1  ON 76
ci_028                -1.010240e-02 3 1  ON 77
ci_029                -9.846872e-03 3 1  ON 78
ci_030                -4.814247e-03 3 1  ON 79
ci_031                -5.117274e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0635e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2208
    reference variance = 0.291443
====================================================
  Execution time = 3.7875e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5437e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9928e-01
  Total weights = 1.973541649e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0891e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291339463340
                                         uncertainty =       0.002308142019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291339463340
                                         uncertainty =       0.002308142019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381656330
  error estimate for blocks of size 2^( 2) =       0.000396186828
  error estimate for blocks of size 2^( 3) =       0.000409929920
  error estimate for blocks of size 2^( 4) =       0.000421266638
  error estimate for blocks of size 2^( 5) =       0.000427612434
  error estimate for blocks of size 2^( 6) =       0.000431414610
  error estimate for blocks of size 2^( 7) =       0.000431925710

      target function =      -0.913833962423
              le_mean =     -17.206684128478
             les_mean =     296.369260486844
             stat err =       0.000428054848
             autocorr =       1.257922541284
   target nu stat err =       0.000428054848
   target dn stat err =       0.003999123177
      target stat err =       0.006233705673
              std dev =       0.539743558725
             le_variance =       0.291323109185


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720668412848e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913875199261       residual = 6.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913875232758       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913875238444       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913875240528       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913875240891       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913875242006       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913875242603       residual = 9.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913875243951       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913875244548       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913875245129       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913875245497       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913875245850       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913875246319       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913875246615       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913875246818       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913875247002       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913875247125       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913875247239       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913875247372       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913875247419       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913875247492       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913875247447       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913875247521       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913875247607       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913875247661       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913875247661       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913875247617       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913875247642       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913875247620       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913875247638       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913875247642       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913875247634       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913875247638       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913875247613       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913875247618       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913875247616       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913875247617       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913875247637       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913875247636       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.3132e+02 is 5.702058e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913875199261       residual = 6.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913875207636       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913875209057       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913875209576       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913875209669       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913875209944       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913875210098       residual = 9.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913875210427       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913875210579       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913875210729       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913875210823       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913875210915       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913875211033       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913875211097       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913875211149       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913875211196       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913875211225       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913875211255       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913875211287       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913875211299       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913875211318       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913875211308       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913875211327       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913875211358       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913875211352       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913875211358       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913875211344       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913875211356       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913875211362       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913875211348       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913875211357       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913875211374       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913875211359       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913875211345       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913875211353       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913875211352       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913875211357       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913875211360       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913875211362       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.7253e+03 is 1.425524e-07

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913875199261       residual = 6.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913875201355       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913875201710       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913875201841       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913875201868       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913875201928       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913875201981       residual = 9.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913875202089       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913875202105       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913875202127       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913875202151       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913875202185       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913875202166       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913875202215       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913875202255       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913875202247       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913875202263       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913875202232       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913875202239       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913875202246       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913875202286       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913875202296       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913875202236       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913875202260       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913875202229       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913875202231       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913875202280       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913875202265       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913875202256       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913875202289       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913875202267       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913875202224       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913875202269       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913875202236       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913875202259       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913875202367       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913875202264       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913875202240       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913875202313       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4901e+04 is 3.563816e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.895605 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8834e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.087060e-01 1 1  ON 0
  uu_1                 5.166699e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291224e-02 1 1  ON 3
  uu_4                -1.239448e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137868e-01 1 1  ON 6
  uu_7                -5.393129e-02 1 1  ON 7
  uu_8                 7.179492e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081018e-01 1 1  ON 10
  ud_1                 7.810552e-02 1 1  ON 11
  ud_2                -2.402896e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141471e-01 1 1  ON 14
  ud_5                -1.343882e-01 1 1  ON 15
  ud_6                -1.304667e-01 1 1  ON 16
  ud_7                -8.981725e-02 1 1  ON 17
  ud_8                -4.429536e-03 1 1  ON 18
  ud_9                 8.809347e-02 1 1  ON 19
  eO_0                -7.053857e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127694e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613802e-01 1 1  ON 24
  eO_5                 2.856697e-01 1 1  ON 25
  eO_6                 2.498746e-01 1 1  ON 26
  eO_7                 1.252760e-01 1 1  ON 27
  eO_8                 2.849721e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018799e-01 1 1  ON 30
 eH1_1                -9.762499e-02 1 1  ON 31
 eH1_2                -4.695828e-02 1 1  ON 32
 eH1_3                -1.559995e-02 1 1  ON 33
 eH1_4                 1.884943e-02 1 1  ON 34
 eH1_5                 2.620672e-02 1 1  ON 35
 eH1_6                 7.491233e-02 1 1  ON 36
 eH1_7                 1.041055e-01 1 1  ON 37
 eH1_8                 9.703713e-02 1 1  ON 38
 eH1_9                 2.520327e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994532e-02 1 1  ON 41
 eH2_2                -4.927198e-02 1 1  ON 42
 eH2_3                -1.790924e-02 1 1  ON 43
 eH2_4                 1.638154e-02 1 1  ON 44
 eH2_5                 2.331404e-02 1 1  ON 45
 eH2_6                 7.777063e-02 1 1  ON 46
 eH2_7                 1.127070e-01 1 1  ON 47
 eH2_8                 9.971147e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261618e-02 3 1  ON 50
ci_002                -3.174048e-02 3 1  ON 51
ci_003                -1.241218e-02 3 1  ON 52
ci_004                 2.578193e-02 3 1  ON 53
ci_005                 2.603755e-02 3 1  ON 54
ci_006                -2.086920e-02 3 1  ON 55
ci_007                -2.067498e-02 3 1  ON 56
ci_008                -5.063234e-03 3 1  ON 57
ci_009                -1.563139e-02 3 1  ON 58
ci_010                -1.049462e-02 3 1  ON 59
ci_011                -1.040942e-02 3 1  ON 60
ci_012                -1.050591e-02 3 1  ON 61
ci_013                -2.150587e-02 3 1  ON 62
ci_014                 1.374531e-02 3 1  ON 63
ci_015                 1.357467e-02 3 1  ON 64
ci_016                 1.685209e-02 3 1  ON 65
ci_017                 1.606476e-02 3 1  ON 66
ci_018                 1.116340e-02 3 1  ON 67
ci_019                 1.083105e-02 3 1  ON 68
ci_020                 1.815730e-02 3 1  ON 69
ci_021                 1.790887e-02 3 1  ON 70
ci_022                 1.041011e-02 3 1  ON 71
ci_023                 1.092404e-02 3 1  ON 72
ci_024                 7.124887e-03 3 1  ON 73
ci_025                 7.213942e-03 3 1  ON 74
ci_026                 1.196612e-02 3 1  ON 75
ci_027                 1.214393e-02 3 1  ON 76
ci_028                -1.010241e-02 3 1  ON 77
ci_029                -9.846872e-03 3 1  ON 78
ci_030                -4.814232e-03 3 1  ON 79
ci_031                -5.117259e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1253
    reference variance = 0.181829
====================================================
  Execution time = 3.8273e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7208e+01
  VMC Evar = 3.0034e-01
  Total weights = 1.9735e+06
  Execution time = 3.1530e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291277418464
                                         uncertainty =       0.002241276407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291277418464
                                         uncertainty =       0.002241276407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381607967
  error estimate for blocks of size 2^( 2) =       0.000396382133
  error estimate for blocks of size 2^( 3) =       0.000410026025
  error estimate for blocks of size 2^( 4) =       0.000420248282
  error estimate for blocks of size 2^( 5) =       0.000425765713
  error estimate for blocks of size 2^( 6) =       0.000429041798
  error estimate for blocks of size 2^( 7) =       0.000429982251

      target function =      -0.912191789784
              le_mean =     -17.207504791037
             les_mean =     296.398560144083
             stat err =       0.000426259511
             autocorr =       1.247708974337
   target nu stat err =       0.000426259511
   target dn stat err =       0.003192615682
      target stat err =       0.004984987423
              std dev =       0.539675162443
             le_variance =       0.291249280958

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291277415307
                                         uncertainty =       0.002241272585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291277415307
                                         uncertainty =       0.002241272585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381607965
  error estimate for blocks of size 2^( 2) =       0.000396382163
  error estimate for blocks of size 2^( 3) =       0.000410026087
  error estimate for blocks of size 2^( 4) =       0.000420248365
  error estimate for blocks of size 2^( 5) =       0.000425765808
  error estimate for blocks of size 2^( 6) =       0.000429041901
  error estimate for blocks of size 2^( 7) =       0.000429982364

      target function =      -0.912191861945
              le_mean =     -17.207504791547
             les_mean =     296.398560114807
             stat err =       0.000426259610
             autocorr =       1.247709565290
   target nu stat err =       0.000426259610
   target dn stat err =       0.003192626616
      target stat err =       0.004985004949
              std dev =       0.539675159601
             le_variance =       0.291249277891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291277416885
                                         uncertainty =       0.002241274496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291277416885
                                         uncertainty =       0.002241274496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381607966
  error estimate for blocks of size 2^( 2) =       0.000396382148
  error estimate for blocks of size 2^( 3) =       0.000410026056
  error estimate for blocks of size 2^( 4) =       0.000420248324
  error estimate for blocks of size 2^( 5) =       0.000425765761
  error estimate for blocks of size 2^( 6) =       0.000429041850
  error estimate for blocks of size 2^( 7) =       0.000429982308

      target function =      -0.912191826180
              le_mean =     -17.207504791292
             les_mean =     296.398560129238
             stat err =       0.000426259560
             autocorr =       1.247709269825
   target nu stat err =       0.000426259560
   target dn stat err =       0.003192621148
      target stat err =       0.004984996187
              std dev =       0.539675161021
             le_variance =       0.291249279423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291277418267
                                         uncertainty =       0.002241276168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291277418267
                                         uncertainty =       0.002241276168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381607967
  error estimate for blocks of size 2^( 2) =       0.000396382135
  error estimate for blocks of size 2^( 3) =       0.000410026029
  error estimate for blocks of size 2^( 4) =       0.000420248287
  error estimate for blocks of size 2^( 5) =       0.000425765719
  error estimate for blocks of size 2^( 6) =       0.000429041804
  error estimate for blocks of size 2^( 7) =       0.000429982258

      target function =      -0.912191794368
              le_mean =     -17.207504791068
             les_mean =     296.398560142205
             stat err =       0.000426259517
             autocorr =       1.247709011286
   target nu stat err =       0.000426259517
   target dn stat err =       0.003192616365
      target stat err =       0.004984988519
              std dev =       0.539675162265
             le_variance =       0.291249280766


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912191789784        initial
     9.3132e+02     9.3132e+03             5.7021e-07        -0.912191861945  <--
     3.7253e+03     3.7253e+04             1.4255e-07        -0.912191826180
     1.4901e+04     1.4901e+05             3.5638e-08        -0.912191794368

*****************************************************************************
Applying the update for shift_i =   9.3132e+02     and shift_s =   9.3132e+03
*****************************************************************************

  Execution time = 5.4107e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.087062e-01 1 1  ON 0
  uu_1                 5.166713e-02 1 1  ON 1
  uu_2                -3.940093e-02 1 1  ON 2
  uu_3                -9.291212e-02 1 1  ON 3
  uu_4                -1.239447e-01 1 1  ON 4
  uu_5                -1.319989e-01 1 1  ON 5
  uu_6                -1.137869e-01 1 1  ON 6
  uu_7                -5.393146e-02 1 1  ON 7
  uu_8                 7.179449e-02 1 1  ON 8
  uu_9                 1.240338e-01 1 1  ON 9
  ud_0                 3.081016e-01 1 1  ON 10
  ud_1                 7.810535e-02 1 1  ON 11
  ud_2                -2.402912e-02 1 1  ON 12
  ud_3                -7.733653e-02 1 1  ON 13
  ud_4                -1.141472e-01 1 1  ON 14
  ud_5                -1.343880e-01 1 1  ON 15
  ud_6                -1.304664e-01 1 1  ON 16
  ud_7                -8.981705e-02 1 1  ON 17
  ud_8                -4.429622e-03 1 1  ON 18
  ud_9                 8.809336e-02 1 1  ON 19
  eO_0                -7.053856e-01 1 1  ON 20
  eO_1                -4.211855e-01 1 1  ON 21
  eO_2                -4.127702e-02 1 1  ON 22
  eO_3                 1.870625e-01 1 1  ON 23
  eO_4                 2.613802e-01 1 1  ON 24
  eO_5                 2.856696e-01 1 1  ON 25
  eO_6                 2.498745e-01 1 1  ON 26
  eO_7                 1.252762e-01 1 1  ON 27
  eO_8                 2.849723e-02 1 1  ON 28
  eO_9                 1.896071e-02 1 1  ON 29
 eH1_0                -2.018800e-01 1 1  ON 30
 eH1_1                -9.762502e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559993e-02 1 1  ON 33
 eH1_4                 1.884937e-02 1 1  ON 34
 eH1_5                 2.620678e-02 1 1  ON 35
 eH1_6                 7.491229e-02 1 1  ON 36
 eH1_7                 1.041054e-01 1 1  ON 37
 eH1_8                 9.703722e-02 1 1  ON 38
 eH1_9                 2.520330e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994512e-02 1 1  ON 41
 eH2_2                -4.927177e-02 1 1  ON 42
 eH2_3                -1.790910e-02 1 1  ON 43
 eH2_4                 1.638152e-02 1 1  ON 44
 eH2_5                 2.331377e-02 1 1  ON 45
 eH2_6                 7.777035e-02 1 1  ON 46
 eH2_7                 1.127069e-01 1 1  ON 47
 eH2_8                 9.971153e-02 1 1  ON 48
 eH2_9                 2.792581e-02 1 1  ON 49
ci_001                -4.261613e-02 3 1  ON 50
ci_002                -3.174047e-02 3 1  ON 51
ci_003                -1.241213e-02 3 1  ON 52
ci_004                 2.578193e-02 3 1  ON 53
ci_005                 2.603751e-02 3 1  ON 54
ci_006                -2.086915e-02 3 1  ON 55
ci_007                -2.067494e-02 3 1  ON 56
ci_008                -5.063199e-03 3 1  ON 57
ci_009                -1.563135e-02 3 1  ON 58
ci_010                -1.049456e-02 3 1  ON 59
ci_011                -1.040936e-02 3 1  ON 60
ci_012                -1.050577e-02 3 1  ON 61
ci_013                -2.150587e-02 3 1  ON 62
ci_014                 1.374529e-02 3 1  ON 63
ci_015                 1.357470e-02 3 1  ON 64
ci_016                 1.685209e-02 3 1  ON 65
ci_017                 1.606481e-02 3 1  ON 66
ci_018                 1.116336e-02 3 1  ON 67
ci_019                 1.083104e-02 3 1  ON 68
ci_020                 1.815730e-02 3 1  ON 69
ci_021                 1.790891e-02 3 1  ON 70
ci_022                 1.041002e-02 3 1  ON 71
ci_023                 1.092400e-02 3 1  ON 72
ci_024                 7.124878e-03 3 1  ON 73
ci_025                 7.213883e-03 3 1  ON 74
ci_026                 1.196604e-02 3 1  ON 75
ci_027                 1.214383e-02 3 1  ON 76
ci_028                -1.010242e-02 3 1  ON 77
ci_029                -9.846874e-03 3 1  ON 78
ci_030                -4.814187e-03 3 1  ON 79
ci_031                -5.117214e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0295e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1593
    reference variance = 0.206898
====================================================
  Execution time = 3.7748e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5415e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0350e-01
  Total weights = 1.973636717e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0834e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289642601861
                                         uncertainty =       0.001864110348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289642601861
                                         uncertainty =       0.001864110348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380527186
  error estimate for blocks of size 2^( 2) =       0.000395458873
  error estimate for blocks of size 2^( 3) =       0.000409391668
  error estimate for blocks of size 2^( 4) =       0.000419413401
  error estimate for blocks of size 2^( 5) =       0.000425171455
  error estimate for blocks of size 2^( 6) =       0.000430392088
  error estimate for blocks of size 2^( 7) =       0.000431483751

      target function =      -0.907263610611
              le_mean =     -17.207086435098
             les_mean =     296.387320210583
             stat err =       0.000426615174
             autocorr =       1.256901419956
   target nu stat err =       0.000426615174
   target dn stat err =       0.006784492916
      target stat err =       0.010386609064
              std dev =       0.538146707903
             le_variance =       0.289601879227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720708643510e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907381313743       residual = 3.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907382155060       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907382228846       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907382261769       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907382271241       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907382277294       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907382282430       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907382289935       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907382299731       residual = 9.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907382302478       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907382304741       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907382307562       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907382309374       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907382310588       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907382310722       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907382310562       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907382311061       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.907382312277       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.907382312661       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.907382312247       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.907382312745       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.907382313445       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.907382313982       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.907382314067       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907382313737       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.907382313831       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.907382314036       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.907382314112       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.907382314264       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.907382314101       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.907382314124       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907382314091       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907382314099       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.907382314040       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.907382314055       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.907382314040       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.907382314078       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.907382314078       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.907382314081       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3283e+02 is 2.885498e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907381313743       residual = 3.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907381524123       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907381542572       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907381550805       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907381553173       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907381554687       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907381555971       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907381557846       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907381560297       residual = 9.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907381560984       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907381561551       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907381562255       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907381562708       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907381563011       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907381563045       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907381563005       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907381563130       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.907381563434       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.907381563530       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.907381563426       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.907381563550       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.907381563726       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.907381563858       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.907381563883       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907381563800       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.907381563831       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.907381563878       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.907381563893       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.907381563930       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.907381563883       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.907381563900       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907381563882       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907381563887       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.907381563876       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.907381563874       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.907381563875       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.907381563882       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.907381563883       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.907381563887       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.3132e+02 is 7.215174e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907381313743       residual = 3.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907381366341       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907381370954       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907381373012       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907381373604       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907381373982       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907381374306       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907381374773       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907381375385       residual = 9.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907381375553       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907381375686       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907381375875       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907381375990       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907381376064       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907381376055       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907381376072       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907381376087       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.907381376165       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.907381376190       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.907381376166       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.907381376198       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.907381376249       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.907381376274       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.907381376289       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907381376266       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.907381376269       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.907381376284       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.907381376270       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.907381376284       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.907381376274       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.907381376259       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907381376286       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907381376284       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.907381376289       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.907381376283       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.907381376284       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.907381376271       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.907381376270       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.907381376271       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.7253e+03 is 1.803883e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.957336 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8650e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.087059e-01 1 1  ON 0
  uu_1                 5.166699e-02 1 1  ON 1
  uu_2                -3.940097e-02 1 1  ON 2
  uu_3                -9.291209e-02 1 1  ON 3
  uu_4                -1.239446e-01 1 1  ON 4
  uu_5                -1.319987e-01 1 1  ON 5
  uu_6                -1.137865e-01 1 1  ON 6
  uu_7                -5.393149e-02 1 1  ON 7
  uu_8                 7.179406e-02 1 1  ON 8
  uu_9                 1.240339e-01 1 1  ON 9
  ud_0                 3.081012e-01 1 1  ON 10
  ud_1                 7.810517e-02 1 1  ON 11
  ud_2                -2.402920e-02 1 1  ON 12
  ud_3                -7.733651e-02 1 1  ON 13
  ud_4                -1.141471e-01 1 1  ON 14
  ud_5                -1.343879e-01 1 1  ON 15
  ud_6                -1.304662e-01 1 1  ON 16
  ud_7                -8.981687e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809332e-02 1 1  ON 19
  eO_0                -7.053849e-01 1 1  ON 20
  eO_1                -4.211852e-01 1 1  ON 21
  eO_2                -4.127729e-02 1 1  ON 22
  eO_3                 1.870619e-01 1 1  ON 23
  eO_4                 2.613799e-01 1 1  ON 24
  eO_5                 2.856692e-01 1 1  ON 25
  eO_6                 2.498747e-01 1 1  ON 26
  eO_7                 1.252765e-01 1 1  ON 27
  eO_8                 2.849726e-02 1 1  ON 28
  eO_9                 1.896075e-02 1 1  ON 29
 eH1_0                -2.018803e-01 1 1  ON 30
 eH1_1                -9.762520e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559993e-02 1 1  ON 33
 eH1_4                 1.884948e-02 1 1  ON 34
 eH1_5                 2.620696e-02 1 1  ON 35
 eH1_6                 7.491230e-02 1 1  ON 36
 eH1_7                 1.041054e-01 1 1  ON 37
 eH1_8                 9.703738e-02 1 1  ON 38
 eH1_9                 2.520333e-02 1 1  ON 39
 eH2_0                -2.031283e-01 1 1  ON 40
 eH2_1                -9.994494e-02 1 1  ON 41
 eH2_2                -4.927164e-02 1 1  ON 42
 eH2_3                -1.790904e-02 1 1  ON 43
 eH2_4                 1.638144e-02 1 1  ON 44
 eH2_5                 2.331345e-02 1 1  ON 45
 eH2_6                 7.777018e-02 1 1  ON 46
 eH2_7                 1.127069e-01 1 1  ON 47
 eH2_8                 9.971169e-02 1 1  ON 48
 eH2_9                 2.792583e-02 1 1  ON 49
ci_001                -4.261601e-02 3 1  ON 50
ci_002                -3.174046e-02 3 1  ON 51
ci_003                -1.241195e-02 3 1  ON 52
ci_004                 2.578196e-02 3 1  ON 53
ci_005                 2.603743e-02 3 1  ON 54
ci_006                -2.086928e-02 3 1  ON 55
ci_007                -2.067489e-02 3 1  ON 56
ci_008                -5.063127e-03 3 1  ON 57
ci_009                -1.563116e-02 3 1  ON 58
ci_010                -1.049490e-02 3 1  ON 59
ci_011                -1.040936e-02 3 1  ON 60
ci_012                -1.050564e-02 3 1  ON 61
ci_013                -2.150596e-02 3 1  ON 62
ci_014                 1.374495e-02 3 1  ON 63
ci_015                 1.357465e-02 3 1  ON 64
ci_016                 1.685215e-02 3 1  ON 65
ci_017                 1.606475e-02 3 1  ON 66
ci_018                 1.116320e-02 3 1  ON 67
ci_019                 1.083110e-02 3 1  ON 68
ci_020                 1.815732e-02 3 1  ON 69
ci_021                 1.790905e-02 3 1  ON 70
ci_022                 1.041046e-02 3 1  ON 71
ci_023                 1.092392e-02 3 1  ON 72
ci_024                 7.125026e-03 3 1  ON 73
ci_025                 7.213987e-03 3 1  ON 74
ci_026                 1.196614e-02 3 1  ON 75
ci_027                 1.214370e-02 3 1  ON 76
ci_028                -1.010239e-02 3 1  ON 77
ci_029                -9.846664e-03 3 1  ON 78
ci_030                -4.814152e-03 3 1  ON 79
ci_031                -5.117343e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1266
    reference variance = 0.462947
====================================================
  Execution time = 3.7943e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7208e+01
  VMC Evar = 2.9878e-01
  Total weights = 1.9737e+06
  Execution time = 3.1266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291757620706
                                         uncertainty =       0.001784707525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291757620706
                                         uncertainty =       0.001784707525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381937378
  error estimate for blocks of size 2^( 2) =       0.000396751207
  error estimate for blocks of size 2^( 3) =       0.000409994631
  error estimate for blocks of size 2^( 4) =       0.000420314137
  error estimate for blocks of size 2^( 5) =       0.000426580340
  error estimate for blocks of size 2^( 6) =       0.000430397079
  error estimate for blocks of size 2^( 7) =       0.000433607387

      target function =      -0.914616369645
              le_mean =     -17.207565915499
             les_mean =     296.399105668172
             stat err =       0.000427724736
             autocorr =       1.254135348134
   target nu stat err =       0.000427724736
   target dn stat err =       0.002337085397
      target stat err =       0.003702228967
              std dev =       0.540141019859
             le_variance =       0.291752321334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291757211185
                                         uncertainty =       0.001784695360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291757211185
                                         uncertainty =       0.001784695360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381937112
  error estimate for blocks of size 2^( 2) =       0.000396751087
  error estimate for blocks of size 2^( 3) =       0.000409994643
  error estimate for blocks of size 2^( 4) =       0.000420314214
  error estimate for blocks of size 2^( 5) =       0.000426580479
  error estimate for blocks of size 2^( 6) =       0.000430397239
  error estimate for blocks of size 2^( 7) =       0.000433607560

      target function =      -0.914616847844
              le_mean =     -17.207565916803
             les_mean =     296.399105405167
             stat err =       0.000427724873
             autocorr =       1.254137902736
   target nu stat err =       0.000427724873
   target dn stat err =       0.002337090745
      target stat err =       0.003702240965
              std dev =       0.540140643160
             le_variance =       0.291751914393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291757415834
                                         uncertainty =       0.001784701440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291757415834
                                         uncertainty =       0.001784701440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381937245
  error estimate for blocks of size 2^( 2) =       0.000396751147
  error estimate for blocks of size 2^( 3) =       0.000409994637
  error estimate for blocks of size 2^( 4) =       0.000420314175
  error estimate for blocks of size 2^( 5) =       0.000426580410
  error estimate for blocks of size 2^( 6) =       0.000430397159
  error estimate for blocks of size 2^( 7) =       0.000433607473

      target function =      -0.914616609520
              le_mean =     -17.207565916143
             les_mean =     296.399105535885
             stat err =       0.000427724804
             autocorr =       1.254136625700
   target nu stat err =       0.000427724804
   target dn stat err =       0.002337088057
      target stat err =       0.003702234951
              std dev =       0.540140831406
             le_variance =       0.291752117752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291757595089
                                         uncertainty =       0.001784706764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291757595089
                                         uncertainty =       0.001784706764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381937361
  error estimate for blocks of size 2^( 2) =       0.000396751199
  error estimate for blocks of size 2^( 3) =       0.000409994632
  error estimate for blocks of size 2^( 4) =       0.000420314142
  error estimate for blocks of size 2^( 5) =       0.000426580349
  error estimate for blocks of size 2^( 6) =       0.000430397089
  error estimate for blocks of size 2^( 7) =       0.000433607397

      target function =      -0.914616399710
              le_mean =     -17.207565915578
             les_mean =     296.399105651553
             stat err =       0.000427724744
             autocorr =       1.254135507833
   target nu stat err =       0.000427724744
   target dn stat err =       0.002337085728
      target stat err =       0.003702229713
              std dev =       0.540140996294
             le_variance =       0.291752295878


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914616369645        initial
     2.3283e+02     2.3283e+03             2.8855e-06        -0.914616847844  <--
     9.3132e+02     9.3132e+03             7.2152e-07        -0.914616609520
     3.7253e+03     3.7253e+04             1.8039e-07        -0.914616399710

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 5.3728e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166658e-02 1 1  ON 1
  uu_2                -3.940110e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393156e-02 1 1  ON 7
  uu_8                 7.179278e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810463e-02 1 1  ON 11
  ud_2                -2.402945e-02 1 1  ON 12
  ud_3                -7.733643e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981634e-02 1 1  ON 17
  ud_8                -4.429618e-03 1 1  ON 18
  ud_9                 8.809321e-02 1 1  ON 19
  eO_0                -7.053828e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695822e-02 1 1  ON 32
 eH1_3                -1.559995e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620747e-02 1 1  ON 35
 eH1_6                 7.491230e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994440e-02 1 1  ON 41
 eH2_2                -4.927127e-02 1 1  ON 42
 eH2_3                -1.790886e-02 1 1  ON 43
 eH2_4                 1.638123e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776966e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971218e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174044e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062912e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049593e-02 3 1  ON 59
ci_011                -1.040936e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150626e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685232e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083128e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092371e-02 3 1  ON 72
ci_024                 7.125470e-03 3 1  ON 73
ci_025                 7.214300e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214331e-02 3 1  ON 76
ci_028                -1.010230e-02 3 1  ON 77
ci_029                -9.846034e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117728e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0238e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2143
    reference variance = 0.197518
====================================================
  Execution time = 3.7873e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5427e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9637e-01
  Total weights = 1.973621423e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0949e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288860507816
                                         uncertainty =       0.001710234421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288860507816
                                         uncertainty =       0.001710234421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380015120
  error estimate for blocks of size 2^( 2) =       0.000394816700
  error estimate for blocks of size 2^( 3) =       0.000408318490
  error estimate for blocks of size 2^( 4) =       0.000418156423
  error estimate for blocks of size 2^( 5) =       0.000424209672
  error estimate for blocks of size 2^( 6) =       0.000426184878
  error estimate for blocks of size 2^( 7) =       0.000427776929

      target function =      -0.918401877463
              le_mean =     -17.206383888143
             les_mean =     296.356015253546
             stat err =       0.000424081975
             autocorr =       1.245368498517
   target nu stat err =       0.000424081975
   target dn stat err =       0.002014018310
      target stat err =       0.003229128911
              std dev =       0.537422536085
             le_variance =       0.288822982292


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720638388814e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918412247300       residual = 7.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918412694797       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918412795963       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918412828998       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918412851036       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918412860414       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918412862748       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918412868888       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918412870211       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918412872547       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918412874406       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918412876867       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918412877446       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918412885819       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918412888790       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918412888302       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918412891136       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918412890375       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918412891323       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918412892498       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918412893195       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918412893544       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918412893480       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918412892157       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918412892116       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918412892379       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918412892120       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918412891929       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918412891735       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918412891788       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918412891826       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918412892619       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918412892548       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918412892674       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918412892798       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918412892629       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918412892577       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.8208e+01 is 5.733323e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918412247300       residual = 7.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918412359288       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918412384600       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918412392864       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918412398377       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918412400723       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918412401308       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918412402844       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918412403174       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918412403759       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918412404223       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918412404840       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918412404984       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918412407079       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918412407821       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918412407698       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918412408407       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918412408217       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918412408453       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918412408747       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918412408919       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918412409008       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918412408992       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918412408660       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918412408652       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918412408715       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918412408651       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918412408605       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918412408555       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918412408569       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918412408577       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918412408776       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918412408759       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918412408790       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918412408821       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918412408779       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918412408765       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3283e+02 is 1.433490e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918412247300       residual = 7.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918412275305       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918412281634       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918412283700       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918412285079       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918412285666       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918412285812       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918412286197       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918412286277       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918412286426       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918412286540       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918412286696       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918412286730       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918412287253       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918412287442       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918412287407       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918412287587       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918412287527       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918412287586       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918412287665       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918412287713       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918412287738       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918412287732       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918412287649       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918412287652       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918412287667       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918412287655       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918412287637       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918412287627       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918412287624       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918412287628       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918412287680       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918412287672       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918412287679       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918412287690       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918412287678       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918412287676       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.3132e+02 is 3.583825e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.012809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8885e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.087053e-01 1 1  ON 0
  uu_1                 5.166686e-02 1 1  ON 1
  uu_2                -3.940094e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393195e-02 1 1  ON 7
  uu_8                 7.179134e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.080992e-01 1 1  ON 10
  ud_1                 7.810394e-02 1 1  ON 11
  ud_2                -2.402978e-02 1 1  ON 12
  ud_3                -7.733654e-02 1 1  ON 13
  ud_4                -1.141467e-01 1 1  ON 14
  ud_5                -1.343871e-01 1 1  ON 15
  ud_6                -1.304655e-01 1 1  ON 16
  ud_7                -8.981546e-02 1 1  ON 17
  ud_8                -4.430099e-03 1 1  ON 18
  ud_9                 8.809299e-02 1 1  ON 19
  eO_0                -7.053825e-01 1 1  ON 20
  eO_1                -4.211843e-01 1 1  ON 21
  eO_2                -4.127836e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613786e-01 1 1  ON 24
  eO_5                 2.856667e-01 1 1  ON 25
  eO_6                 2.498753e-01 1 1  ON 26
  eO_7                 1.252786e-01 1 1  ON 27
  eO_8                 2.849753e-02 1 1  ON 28
  eO_9                 1.896085e-02 1 1  ON 29
 eH1_0                -2.018814e-01 1 1  ON 30
 eH1_1                -9.762587e-02 1 1  ON 31
 eH1_2                -4.695788e-02 1 1  ON 32
 eH1_3                -1.559979e-02 1 1  ON 33
 eH1_4                 1.884983e-02 1 1  ON 34
 eH1_5                 2.620659e-02 1 1  ON 35
 eH1_6                 7.491243e-02 1 1  ON 36
 eH1_7                 1.041053e-01 1 1  ON 37
 eH1_8                 9.703837e-02 1 1  ON 38
 eH1_9                 2.520353e-02 1 1  ON 39
 eH2_0                -2.031284e-01 1 1  ON 40
 eH2_1                -9.994396e-02 1 1  ON 41
 eH2_2                -4.927080e-02 1 1  ON 42
 eH2_3                -1.790833e-02 1 1  ON 43
 eH2_4                 1.638110e-02 1 1  ON 44
 eH2_5                 2.331181e-02 1 1  ON 45
 eH2_6                 7.776883e-02 1 1  ON 46
 eH2_7                 1.127065e-01 1 1  ON 47
 eH2_8                 9.971259e-02 1 1  ON 48
 eH2_9                 2.792615e-02 1 1  ON 49
ci_001                -4.261555e-02 3 1  ON 50
ci_002                -3.174037e-02 3 1  ON 51
ci_003                -1.241101e-02 3 1  ON 52
ci_004                 2.578203e-02 3 1  ON 53
ci_005                 2.603750e-02 3 1  ON 54
ci_006                -2.086950e-02 3 1  ON 55
ci_007                -2.067464e-02 3 1  ON 56
ci_008                -5.062611e-03 3 1  ON 57
ci_009                -1.563068e-02 3 1  ON 58
ci_010                -1.049595e-02 3 1  ON 59
ci_011                -1.040926e-02 3 1  ON 60
ci_012                -1.050496e-02 3 1  ON 61
ci_013                -2.150594e-02 3 1  ON 62
ci_014                 1.374378e-02 3 1  ON 63
ci_015                 1.357435e-02 3 1  ON 64
ci_016                 1.685187e-02 3 1  ON 65
ci_017                 1.606477e-02 3 1  ON 66
ci_018                 1.116252e-02 3 1  ON 67
ci_019                 1.083154e-02 3 1  ON 68
ci_020                 1.815704e-02 3 1  ON 69
ci_021                 1.790952e-02 3 1  ON 70
ci_022                 1.041200e-02 3 1  ON 71
ci_023                 1.092342e-02 3 1  ON 72
ci_024                 7.125246e-03 3 1  ON 73
ci_025                 7.213628e-03 3 1  ON 74
ci_026                 1.196599e-02 3 1  ON 75
ci_027                 1.214354e-02 3 1  ON 76
ci_028                -1.010210e-02 3 1  ON 77
ci_029                -9.845906e-03 3 1  ON 78
ci_030                -4.814042e-03 3 1  ON 79
ci_031                -5.117193e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1938
    reference variance = 0.166948
====================================================
  Execution time = 3.7463e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9754e-01
  Total weights = 1.9739e+06
  Execution time = 3.1531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289199901233
                                         uncertainty =       0.001892495144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289199901233
                                         uncertainty =       0.001892495144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380260320
  error estimate for blocks of size 2^( 2) =       0.000395099240
  error estimate for blocks of size 2^( 3) =       0.000408374996
  error estimate for blocks of size 2^( 4) =       0.000418411338
  error estimate for blocks of size 2^( 5) =       0.000424945487
  error estimate for blocks of size 2^( 6) =       0.000428489815
  error estimate for blocks of size 2^( 7) =       0.000430699053

      target function =      -0.916563676576
              le_mean =     -17.206678286605
             les_mean =     296.367318403729
             stat err =       0.000425636423
             autocorr =       1.252897526155
   target nu stat err =       0.000425636423
   target dn stat err =       0.002442837591
      target stat err =       0.003872573055
              std dev =       0.537769301648
             le_variance =       0.289195821795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289199596314
                                         uncertainty =       0.001892466851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289199596314
                                         uncertainty =       0.001892466851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380260122
  error estimate for blocks of size 2^( 2) =       0.000395099422
  error estimate for blocks of size 2^( 3) =       0.000408375534
  error estimate for blocks of size 2^( 4) =       0.000418412125
  error estimate for blocks of size 2^( 5) =       0.000424946428
  error estimate for blocks of size 2^( 6) =       0.000428490814
  error estimate for blocks of size 2^( 7) =       0.000430700206

      target function =      -0.916544243072
              le_mean =     -17.206678278617
             les_mean =     296.367330572646
             stat err =       0.000425637393
             autocorr =       1.252904539704
   target nu stat err =       0.000425637393
   target dn stat err =       0.002447071188
      target stat err =       0.003878889442
              std dev =       0.537769022003
             le_variance =       0.289195521026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289199748468
                                         uncertainty =       0.001892480977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289199748468
                                         uncertainty =       0.001892480977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380260221
  error estimate for blocks of size 2^( 2) =       0.000395099331
  error estimate for blocks of size 2^( 3) =       0.000408375265
  error estimate for blocks of size 2^( 4) =       0.000418411732
  error estimate for blocks of size 2^( 5) =       0.000424945958
  error estimate for blocks of size 2^( 6) =       0.000428490315
  error estimate for blocks of size 2^( 7) =       0.000430699630

      target function =      -0.916554135020
              le_mean =     -17.206678282580
             les_mean =     296.367324374765
             stat err =       0.000425636909
             autocorr =       1.252901036026
   target nu stat err =       0.000425636909
   target dn stat err =       0.002444931189
      target stat err =       0.003875697227
              std dev =       0.537769161543
             le_variance =       0.289195671106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289199882112
                                         uncertainty =       0.001892493372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289199882112
                                         uncertainty =       0.001892493372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380260308
  error estimate for blocks of size 2^( 2) =       0.000395099251
  error estimate for blocks of size 2^( 3) =       0.000408375030
  error estimate for blocks of size 2^( 4) =       0.000418411387
  error estimate for blocks of size 2^( 5) =       0.000424945546
  error estimate for blocks of size 2^( 6) =       0.000428489877
  error estimate for blocks of size 2^( 7) =       0.000430699126

      target function =      -0.916562503077
              le_mean =     -17.206678286099
             les_mean =     296.367319137695
             stat err =       0.000425636484
             autocorr =       1.252897965002
   target nu stat err =       0.000425636484
   target dn stat err =       0.002443096645
      target stat err =       0.003872959690
              std dev =       0.537769284112
             le_variance =       0.289195802934


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916563676576        initial  <--
     5.8208e+01     5.8208e+02             5.7333e-06        -0.916544243072
     2.3283e+02     2.3283e+03             1.4335e-06        -0.916554135020
     9.3132e+02     9.3132e+03             3.5838e-07        -0.916562503077

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 55.2565
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166658e-02 1 1  ON 1
  uu_2                -3.940110e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393156e-02 1 1  ON 7
  uu_8                 7.179278e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810463e-02 1 1  ON 11
  ud_2                -2.402945e-02 1 1  ON 12
  ud_3                -7.733643e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981634e-02 1 1  ON 17
  ud_8                -4.429618e-03 1 1  ON 18
  ud_9                 8.809321e-02 1 1  ON 19
  eO_0                -7.053828e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695822e-02 1 1  ON 32
 eH1_3                -1.559995e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620747e-02 1 1  ON 35
 eH1_6                 7.491230e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994440e-02 1 1  ON 41
 eH2_2                -4.927127e-02 1 1  ON 42
 eH2_3                -1.790886e-02 1 1  ON 43
 eH2_4                 1.638123e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776966e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971218e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174044e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062912e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049593e-02 3 1  ON 59
ci_011                -1.040936e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150626e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685232e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083128e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092371e-02 3 1  ON 72
ci_024                 7.125470e-03 3 1  ON 73
ci_025                 7.214300e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214331e-02 3 1  ON 76
ci_028                -1.010230e-02 3 1  ON 77
ci_029                -9.846034e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117728e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0415e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1859
    reference variance = 0.29779
====================================================
  Execution time = 3.7756e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5420e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9547e-01
  Total weights = 1.973611601e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0778e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287584890582
                                         uncertainty =       0.001580047096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287584890582
                                         uncertainty =       0.001580047096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379154183
  error estimate for blocks of size 2^( 2) =       0.000394191312
  error estimate for blocks of size 2^( 3) =       0.000407708849
  error estimate for blocks of size 2^( 4) =       0.000417330613
  error estimate for blocks of size 2^( 5) =       0.000423371964
  error estimate for blocks of size 2^( 6) =       0.000425792749
  error estimate for blocks of size 2^( 7) =       0.000426151576

      target function =      -0.919799603958
              le_mean =     -17.206669862939
             les_mean =     296.364959186568
             stat err =       0.000423161725
             autocorr =       1.245607042478
   target nu stat err =       0.000423161725
   target dn stat err =       0.002276535970
      target stat err =       0.003642639130
              std dev =       0.536204988031
             le_variance =       0.287515789190


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720666986294e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919813148497       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919813174726       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919813179470       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919813182761       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919813182887       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919813183317       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919813183892       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919813184338       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919813184569       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919813185749       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919813185817       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919813186107       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919813186718       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919813187246       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919813187227       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919813187045       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919813187367       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919813187807       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919813187776       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919813187652       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919813187763       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919813187801       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919813187777       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919813187878       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919813187923       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919813187815       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919813187829       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919813187822       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919813187799       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919813187820       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919813187836       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919813187875       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919813187871       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919813187868       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919813187880       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919813187894       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.8208e+02 is 6.270696e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919813148497       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919813155055       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919813156241       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919813157064       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919813157098       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919813157206       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919813157349       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919813157456       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919813157521       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919813157812       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919813157827       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919813157903       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919813158052       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919813158182       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919813158188       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919813158133       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919813158211       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919813158324       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919813158319       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919813158280       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919813158315       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919813158328       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919813158325       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919813158345       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919813158353       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919813158325       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919813158322       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919813158327       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919813158320       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919813158328       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919813158330       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919813158346       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919813158335       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919813158344       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919813158343       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919813158339       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3283e+03 is 1.567744e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919813148497       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919813150136       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919813150433       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919813150637       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919813150650       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919813150677       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919813150715       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919813150726       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919813150745       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919813150833       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919813150826       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919813150845       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919813150893       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919813150926       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919813150930       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919813150897       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919813150944       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919813150926       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919813150938       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919813150953       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919813150929       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919813150933       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919813150942       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919813150944       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919813150943       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919813150918       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919813150936       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919813150938       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919813150920       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919813150947       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919813150952       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919813150950       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919813150940       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919813150966       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919813150982       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919813150991       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.3132e+03 is 3.919402e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.061620 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8590e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940107e-02 1 1  ON 2
  uu_3                -9.291195e-02 1 1  ON 3
  uu_4                -1.239442e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393158e-02 1 1  ON 7
  uu_8                 7.179262e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.080999e-01 1 1  ON 10
  ud_1                 7.810459e-02 1 1  ON 11
  ud_2                -2.402950e-02 1 1  ON 12
  ud_3                -7.733648e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981618e-02 1 1  ON 17
  ud_8                -4.429662e-03 1 1  ON 18
  ud_9                 8.809317e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127812e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856677e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252775e-01 1 1  ON 27
  eO_8                 2.849737e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762573e-02 1 1  ON 31
 eH1_2                -4.695816e-02 1 1  ON 32
 eH1_3                -1.559993e-02 1 1  ON 33
 eH1_4                 1.884973e-02 1 1  ON 34
 eH1_5                 2.620732e-02 1 1  ON 35
 eH1_6                 7.491235e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703788e-02 1 1  ON 38
 eH1_9                 2.520342e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994435e-02 1 1  ON 41
 eH2_2                -4.927123e-02 1 1  ON 42
 eH2_3                -1.790882e-02 1 1  ON 43
 eH2_4                 1.638124e-02 1 1  ON 44
 eH2_5                 2.331244e-02 1 1  ON 45
 eH2_6                 7.776962e-02 1 1  ON 46
 eH2_7                 1.127067e-01 1 1  ON 47
 eH2_8                 9.971221e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261556e-02 3 1  ON 50
ci_002                -3.174042e-02 3 1  ON 51
ci_003                -1.241138e-02 3 1  ON 52
ci_004                 2.578202e-02 3 1  ON 53
ci_005                 2.603717e-02 3 1  ON 54
ci_006                -2.086968e-02 3 1  ON 55
ci_007                -2.067471e-02 3 1  ON 56
ci_008                -5.062904e-03 3 1  ON 57
ci_009                -1.563056e-02 3 1  ON 58
ci_010                -1.049591e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050525e-02 3 1  ON 61
ci_013                -2.150624e-02 3 1  ON 62
ci_014                 1.374390e-02 3 1  ON 63
ci_015                 1.357454e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606459e-02 3 1  ON 66
ci_018                 1.116270e-02 3 1  ON 67
ci_019                 1.083128e-02 3 1  ON 68
ci_020                 1.815740e-02 3 1  ON 69
ci_021                 1.790951e-02 3 1  ON 70
ci_022                 1.041179e-02 3 1  ON 71
ci_023                 1.092372e-02 3 1  ON 72
ci_024                 7.125437e-03 3 1  ON 73
ci_025                 7.214268e-03 3 1  ON 74
ci_026                 1.196638e-02 3 1  ON 75
ci_027                 1.214329e-02 3 1  ON 76
ci_028                -1.010230e-02 3 1  ON 77
ci_029                -9.846024e-03 3 1  ON 78
ci_030                -4.814048e-03 3 1  ON 79
ci_031                -5.117744e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1823
    reference variance = 0.257917
====================================================
  Execution time = 3.7606e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0379e-01
  Total weights = 1.9738e+06
  Execution time = 3.1533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292422997687
                                         uncertainty =       0.001974319733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292422997687
                                         uncertainty =       0.001974319733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382355306
  error estimate for blocks of size 2^( 2) =       0.000397395321
  error estimate for blocks of size 2^( 3) =       0.000410424667
  error estimate for blocks of size 2^( 4) =       0.000420752942
  error estimate for blocks of size 2^( 5) =       0.000426266680
  error estimate for blocks of size 2^( 6) =       0.000429388440
  error estimate for blocks of size 2^( 7) =       0.000432579634

      target function =      -0.906890960803
              le_mean =     -17.206590028196
             les_mean =     296.370534089304
             stat err =       0.000427246924
             autocorr =       1.248600906252
   target nu stat err =       0.000427246924
   target dn stat err =       0.004672357047
      target stat err =       0.007159154409
              std dev =       0.540732059730
             le_variance =       0.292391160420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292422961481
                                         uncertainty =       0.001974320816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292422961481
                                         uncertainty =       0.001974320816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382355283
  error estimate for blocks of size 2^( 2) =       0.000397395325
  error estimate for blocks of size 2^( 3) =       0.000410424702
  error estimate for blocks of size 2^( 4) =       0.000420753003
  error estimate for blocks of size 2^( 5) =       0.000426266755
  error estimate for blocks of size 2^( 6) =       0.000429388526
  error estimate for blocks of size 2^( 7) =       0.000432579728

      target function =      -0.906890523911
              le_mean =     -17.206590026530
             les_mean =     296.370534314675
             stat err =       0.000427247003
             autocorr =       1.248601523133
   target nu stat err =       0.000427247003
   target dn stat err =       0.004672610334
      target stat err =       0.007159531775
              std dev =       0.540732026235
             le_variance =       0.292391124196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292422979581
                                         uncertainty =       0.001974320274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292422979581
                                         uncertainty =       0.001974320274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382355294
  error estimate for blocks of size 2^( 2) =       0.000397395323
  error estimate for blocks of size 2^( 3) =       0.000410424685
  error estimate for blocks of size 2^( 4) =       0.000420752972
  error estimate for blocks of size 2^( 5) =       0.000426266717
  error estimate for blocks of size 2^( 6) =       0.000429388483
  error estimate for blocks of size 2^( 7) =       0.000432579681

      target function =      -0.906890742397
              le_mean =     -17.206590027363
             les_mean =     296.370534201955
             stat err =       0.000427246963
             autocorr =       1.248601214719
   target nu stat err =       0.000427246963
   target dn stat err =       0.004672483695
      target stat err =       0.007159343099
              std dev =       0.540732042980
             le_variance =       0.292391142305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292422995423
                                         uncertainty =       0.001974319800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292422995423
                                         uncertainty =       0.001974319800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382355305
  error estimate for blocks of size 2^( 2) =       0.000397395321
  error estimate for blocks of size 2^( 3) =       0.000410424669
  error estimate for blocks of size 2^( 4) =       0.000420752945
  error estimate for blocks of size 2^( 5) =       0.000426266684
  error estimate for blocks of size 2^( 6) =       0.000429388446
  error estimate for blocks of size 2^( 7) =       0.000432579640

      target function =      -0.906890933508
              le_mean =     -17.206590028092
             les_mean =     296.370534103381
             stat err =       0.000427246929
             autocorr =       1.248600944806
   target nu stat err =       0.000427246929
   target dn stat err =       0.004672372877
      target stat err =       0.007159177995
              std dev =       0.540732057636
             le_variance =       0.292391158156


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.906890960803        initial  <--
     5.8208e+02     5.8208e+03             6.2707e-07        -0.906890523911
     2.3283e+03     2.3283e+04             1.5677e-07        -0.906890742397
     9.3132e+03     9.3132e+04             3.9194e-08        -0.906890933508

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.4801
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166658e-02 1 1  ON 1
  uu_2                -3.940110e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393156e-02 1 1  ON 7
  uu_8                 7.179278e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810463e-02 1 1  ON 11
  ud_2                -2.402945e-02 1 1  ON 12
  ud_3                -7.733643e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981634e-02 1 1  ON 17
  ud_8                -4.429618e-03 1 1  ON 18
  ud_9                 8.809321e-02 1 1  ON 19
  eO_0                -7.053828e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695822e-02 1 1  ON 32
 eH1_3                -1.559995e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620747e-02 1 1  ON 35
 eH1_6                 7.491230e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994440e-02 1 1  ON 41
 eH2_2                -4.927127e-02 1 1  ON 42
 eH2_3                -1.790886e-02 1 1  ON 43
 eH2_4                 1.638123e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776966e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971218e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174044e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062912e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049593e-02 3 1  ON 59
ci_011                -1.040936e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150626e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685232e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083128e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092371e-02 3 1  ON 72
ci_024                 7.125470e-03 3 1  ON 73
ci_025                 7.214300e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214331e-02 3 1  ON 76
ci_028                -1.010230e-02 3 1  ON 77
ci_029                -9.846034e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117728e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0208e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1429
    reference variance = 0.385995
====================================================
  Execution time = 3.7981e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5419e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 2.9840e-01
  Total weights = 1.973753110e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0700e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290657813668
                                         uncertainty =       0.001946121916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290657813668
                                         uncertainty =       0.001946121916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381225809
  error estimate for blocks of size 2^( 2) =       0.000396015062
  error estimate for blocks of size 2^( 3) =       0.000409472245
  error estimate for blocks of size 2^( 4) =       0.000419341251
  error estimate for blocks of size 2^( 5) =       0.000424769106
  error estimate for blocks of size 2^( 6) =       0.000427497072
  error estimate for blocks of size 2^( 7) =       0.000432125877

      target function =      -0.915192820834
              le_mean =     -17.207704540181
             les_mean =     296.403497622967
             stat err =       0.000425933327
             autocorr =       1.248299094445
   target nu stat err =       0.000425933327
   target dn stat err =       0.002961913830
      target stat err =       0.004664396367
              std dev =       0.539134709034
             le_variance =       0.290666234486


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720770454018e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915215781595       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915215786370       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915215787184       residual = 4.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915215787567       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915215787708       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915215787696       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915215787797       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915215787813       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915215787861       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915215787910       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915215787932       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915215787952       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915215787973       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915215787998       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915215788043       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915215788088       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915215788093       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915215788088       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915215788095       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915215788118       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915215788109       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915215788105       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915215788090       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915215788102       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915215788082       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915215788107       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915215788129       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915215788099       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915215788114       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915215788120       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915215788108       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915215788111       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915215788135       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915215788103       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915215788116       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915215788124       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915215788130       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.8208e+03 is 8.142097e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915215781595       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915215782789       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915215782992       residual = 4.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915215783083       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915215783093       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915215783103       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915215783109       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915215783165       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915215783144       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915215783290       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915215783171       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915215783194       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915215783211       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915215783217       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915215783213       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915215783172       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915215783199       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915215783308       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915215783256       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915215783231       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915215783203       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915215783247       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915215783277       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915215783263       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915215783220       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915215783218       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915215783305       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915215783203       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915215783202       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915215783333       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915215783223       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915215783201       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915215783210       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915215783217       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915215783203       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915215783233       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915215783203       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3283e+04 is 2.035526e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915215781595       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915215781894       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915215781944       residual = 4.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915215781969       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915215782016       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915215782066       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915215782144       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915215782006       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915215781993       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915215781936       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915215781871       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915215782121       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915215781878       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915215781923       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915215782221       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915215781910       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915215781956       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915215781815       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915215782112       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915215781929       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915215781753       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915215781723       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915215781978       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915215781853       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915215782280       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915215781872       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915215782114       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915215782254       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915215781637       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915215781901       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915215781908       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915215781827       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915215782126       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915215781743       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915215781917       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915215781841       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915215781929       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.3132e+04 is 5.088817e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.114479 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8743e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166658e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179276e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402945e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981633e-02 1 1  ON 17
  ud_8                -4.429622e-03 1 1  ON 18
  ud_9                 8.809321e-02 1 1  ON 19
  eO_0                -7.053828e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559995e-02 1 1  ON 33
 eH1_4                 1.884979e-02 1 1  ON 34
 eH1_5                 2.620747e-02 1 1  ON 35
 eH1_6                 7.491230e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927127e-02 1 1  ON 42
 eH2_3                -1.790886e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776967e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971218e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174044e-02 3 1  ON 51
ci_003                -1.241141e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062911e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049593e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685232e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083128e-02 3 1  ON 68
ci_020                 1.815737e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125468e-03 3 1  ON 73
ci_025                 7.214298e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010230e-02 3 1  ON 77
ci_029                -9.846033e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117725e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2284
    reference variance = 0.324653
====================================================
  Execution time = 3.7727e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9579e-01
  Total weights = 1.9738e+06
  Execution time = 3.1436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289035321322
                                         uncertainty =       0.001788534192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289035321322
                                         uncertainty =       0.001788534192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380121873
  error estimate for blocks of size 2^( 2) =       0.000395002371
  error estimate for blocks of size 2^( 3) =       0.000408467564
  error estimate for blocks of size 2^( 4) =       0.000418729679
  error estimate for blocks of size 2^( 5) =       0.000424639192
  error estimate for blocks of size 2^( 6) =       0.000427000897
  error estimate for blocks of size 2^( 7) =       0.000430501079

      target function =      -0.919291499863
              le_mean =     -17.206936371954
             les_mean =     296.374454062903
             stat err =       0.000425217712
             autocorr =       1.251344736363
   target nu stat err =       0.000425217712
   target dn stat err =       0.002068418631
      target stat err =       0.003322140628
              std dev =       0.537573508021
             le_variance =       0.288985276526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289035314991
                                         uncertainty =       0.001788534155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289035314991
                                         uncertainty =       0.001788534155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380121869
  error estimate for blocks of size 2^( 2) =       0.000395002372
  error estimate for blocks of size 2^( 3) =       0.000408467570
  error estimate for blocks of size 2^( 4) =       0.000418729688
  error estimate for blocks of size 2^( 5) =       0.000424639203
  error estimate for blocks of size 2^( 6) =       0.000427000908
  error estimate for blocks of size 2^( 7) =       0.000430501092

      target function =      -0.919291277201
              le_mean =     -17.206936371783
             les_mean =     296.374454198950
             stat err =       0.000425217723
             autocorr =       1.251344827513
   target nu stat err =       0.000425217723
   target dn stat err =       0.002068433599
      target stat err =       0.003322161957
              std dev =       0.537573502132
             le_variance =       0.288985270194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289035318156
                                         uncertainty =       0.001788534174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289035318156
                                         uncertainty =       0.001788534174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380121871
  error estimate for blocks of size 2^( 2) =       0.000395002371
  error estimate for blocks of size 2^( 3) =       0.000408467567
  error estimate for blocks of size 2^( 4) =       0.000418729683
  error estimate for blocks of size 2^( 5) =       0.000424639197
  error estimate for blocks of size 2^( 6) =       0.000427000902
  error estimate for blocks of size 2^( 7) =       0.000430501085

      target function =      -0.919291388565
              le_mean =     -17.206936371868
             les_mean =     296.374454130906
             stat err =       0.000425217717
             autocorr =       1.251344781934
   target nu stat err =       0.000425217717
   target dn stat err =       0.002068426112
      target stat err =       0.003322151288
              std dev =       0.537573505076
             le_variance =       0.288985273360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289035320926
                                         uncertainty =       0.001788534190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289035320926
                                         uncertainty =       0.001788534190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380121873
  error estimate for blocks of size 2^( 2) =       0.000395002371
  error estimate for blocks of size 2^( 3) =       0.000408467565
  error estimate for blocks of size 2^( 4) =       0.000418729679
  error estimate for blocks of size 2^( 5) =       0.000424639193
  error estimate for blocks of size 2^( 6) =       0.000427000897
  error estimate for blocks of size 2^( 7) =       0.000430501080

      target function =      -0.919291485954
              le_mean =     -17.206936371944
             les_mean =     296.374454071401
             stat err =       0.000425217712
             autocorr =       1.251344742052
   target nu stat err =       0.000425217712
   target dn stat err =       0.002068419565
      target stat err =       0.003322141960
              std dev =       0.537573507653
             le_variance =       0.288985276130


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919291499863        initial  <--
     5.8208e+03     5.8208e+04             8.1421e-08        -0.919291277201
     2.3283e+04     2.3283e+05             2.0355e-08        -0.919291388565
     9.3132e+04     9.3132e+05             5.0888e-09        -0.919291485954

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.5028
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166658e-02 1 1  ON 1
  uu_2                -3.940110e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393156e-02 1 1  ON 7
  uu_8                 7.179278e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810463e-02 1 1  ON 11
  ud_2                -2.402945e-02 1 1  ON 12
  ud_3                -7.733643e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981634e-02 1 1  ON 17
  ud_8                -4.429618e-03 1 1  ON 18
  ud_9                 8.809321e-02 1 1  ON 19
  eO_0                -7.053828e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695822e-02 1 1  ON 32
 eH1_3                -1.559995e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620747e-02 1 1  ON 35
 eH1_6                 7.491230e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994440e-02 1 1  ON 41
 eH2_2                -4.927127e-02 1 1  ON 42
 eH2_3                -1.790886e-02 1 1  ON 43
 eH2_4                 1.638123e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776966e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971218e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174044e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062912e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049593e-02 3 1  ON 59
ci_011                -1.040936e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150626e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685232e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083128e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092371e-02 3 1  ON 72
ci_024                 7.125470e-03 3 1  ON 73
ci_025                 7.214300e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214331e-02 3 1  ON 76
ci_028                -1.010230e-02 3 1  ON 77
ci_029                -9.846034e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117728e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0225e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1657
    reference variance = 0.393339
====================================================
  Execution time = 3.7887e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5395e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0081e-01
  Total weights = 1.973722266e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0762e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291627320017
                                         uncertainty =       0.002340008306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291627320017
                                         uncertainty =       0.002340008306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381830846
  error estimate for blocks of size 2^( 2) =       0.000395964185
  error estimate for blocks of size 2^( 3) =       0.000409138626
  error estimate for blocks of size 2^( 4) =       0.000418386194
  error estimate for blocks of size 2^( 5) =       0.000424349079
  error estimate for blocks of size 2^( 6) =       0.000427307214
  error estimate for blocks of size 2^( 7) =       0.000428462361

      target function =      -0.911462742248
              le_mean =     -17.207247381385
             les_mean =     296.390176006435
             stat err =       0.000424626212
             autocorr =       1.236720556012
   target nu stat err =       0.000424626212
   target dn stat err =       0.003464849482
      target stat err =       0.005390011434
              std dev =       0.539990360946
             le_variance =       0.291589589914


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720724738139e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911493440959       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911493441780       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911493441901       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911493441945       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911493441961       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911493441951       residual = 9.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911493441860       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911493442105       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911493441942       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911493441981       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911493441814       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911493441976       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911493441958       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911493441930       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911493442125       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911493442016       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911493442098       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911493441884       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911493442066       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911493442047       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911493442033       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911493441901       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911493441940       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911493441883       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911493442217       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911493441966       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911493441908       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911493442098       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911493442092       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911493442036       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911493441951       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911493442172       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911493441862       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911493442036       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911493442216       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911493441733       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.8208e+04 is 8.148332e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911493440959       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911493441164       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911493441195       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911493441206       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911493441763       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911493441176       residual = 9.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911493441345       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911493441638       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911493441357       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911493441092       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911493441595       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911493441703       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911493441206       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911493441407       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911493440928       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911493441034       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911493441163       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911493441235       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911493441414       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911493441423       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911493440660       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911493440855       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911493441229       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911493441936       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911493441589       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911493440683       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911493441192       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911493441461       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911493439580       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911493441149       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911493441250       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911493442107       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911493441158       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911493440882       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911493440547       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911493441278       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3283e+05 is 2.037083e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911493440959       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911493441010       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911493441018       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911493441021       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911493441039       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911493440159       residual = 9.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911493442597       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911493439911       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911493441002       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911493441056       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911493439777       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911493441684       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911493442687       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911493442152       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911493439867       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911493442359       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911493441689       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911493441234       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911493439884       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911493439858       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911493440973       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911493440245       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911493439546       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911493440075       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911493439955       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911493441554       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911493443664       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911493443286       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911493443279       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911493438747       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911493439534       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911493443689       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911493440349       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911493437980       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911493441122       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911493438171       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.3132e+05 is 5.092712e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.163515 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8705e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166658e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393156e-02 1 1  ON 7
  uu_8                 7.179277e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810463e-02 1 1  ON 11
  ud_2                -2.402945e-02 1 1  ON 12
  ud_3                -7.733643e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981634e-02 1 1  ON 17
  ud_8                -4.429618e-03 1 1  ON 18
  ud_9                 8.809321e-02 1 1  ON 19
  eO_0                -7.053828e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695822e-02 1 1  ON 32
 eH1_3                -1.559995e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620747e-02 1 1  ON 35
 eH1_6                 7.491230e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927127e-02 1 1  ON 42
 eH2_3                -1.790886e-02 1 1  ON 43
 eH2_4                 1.638123e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776966e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971218e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174044e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062911e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049593e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150626e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685232e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083128e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092371e-02 3 1  ON 72
ci_024                 7.125470e-03 3 1  ON 73
ci_025                 7.214300e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214331e-02 3 1  ON 76
ci_028                -1.010230e-02 3 1  ON 77
ci_029                -9.846034e-03 3 1  ON 78
ci_030                -4.814048e-03 3 1  ON 79
ci_031                -5.117727e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2051
    reference variance = 0.219666
====================================================
  Execution time = 3.8792e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9440e-01
  Total weights = 1.9738e+06
  Execution time = 3.1538e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287703468608
                                         uncertainty =       0.002039423896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287703468608
                                         uncertainty =       0.002039423896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379284079
  error estimate for blocks of size 2^( 2) =       0.000393745938
  error estimate for blocks of size 2^( 3) =       0.000407597591
  error estimate for blocks of size 2^( 4) =       0.000417283100
  error estimate for blocks of size 2^( 5) =       0.000422539208
  error estimate for blocks of size 2^( 6) =       0.000426085273
  error estimate for blocks of size 2^( 7) =       0.000428769226

      target function =      -0.921479022635
              le_mean =     -17.206082160144
             les_mean =     296.343667214322
             stat err =       0.000423669202
             autocorr =       1.247741335071
   target nu stat err =       0.000423669202
   target dn stat err =       0.002531504344
      target stat err =       0.004045653756
              std dev =       0.536388689153
             le_variance =       0.287712825851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287703467805
                                         uncertainty =       0.002039423846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287703467805
                                         uncertainty =       0.002039423846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379284079
  error estimate for blocks of size 2^( 2) =       0.000393745938
  error estimate for blocks of size 2^( 3) =       0.000407597591
  error estimate for blocks of size 2^( 4) =       0.000417283101
  error estimate for blocks of size 2^( 5) =       0.000422539209
  error estimate for blocks of size 2^( 6) =       0.000426085274
  error estimate for blocks of size 2^( 7) =       0.000428769227

      target function =      -0.921479026107
              le_mean =     -17.206082160148
             les_mean =     296.343667212235
             stat err =       0.000423669203
             autocorr =       1.247741341642
   target nu stat err =       0.000423669203
   target dn stat err =       0.002531504290
      target stat err =       0.004045653702
              std dev =       0.536388688401
             le_variance =       0.287712825045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287703468207
                                         uncertainty =       0.002039423871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287703468207
                                         uncertainty =       0.002039423871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379284079
  error estimate for blocks of size 2^( 2) =       0.000393745938
  error estimate for blocks of size 2^( 3) =       0.000407597591
  error estimate for blocks of size 2^( 4) =       0.000417283101
  error estimate for blocks of size 2^( 5) =       0.000422539208
  error estimate for blocks of size 2^( 6) =       0.000426085274
  error estimate for blocks of size 2^( 7) =       0.000428769226

      target function =      -0.921479024371
              le_mean =     -17.206082160146
             les_mean =     296.343667213279
             stat err =       0.000423669202
             autocorr =       1.247741338355
   target nu stat err =       0.000423669202
   target dn stat err =       0.002531504317
      target stat err =       0.004045653729
              std dev =       0.536388688777
             le_variance =       0.287712825448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287703468558
                                         uncertainty =       0.002039423892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287703468558
                                         uncertainty =       0.002039423892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379284079
  error estimate for blocks of size 2^( 2) =       0.000393745938
  error estimate for blocks of size 2^( 3) =       0.000407597591
  error estimate for blocks of size 2^( 4) =       0.000417283101
  error estimate for blocks of size 2^( 5) =       0.000422539208
  error estimate for blocks of size 2^( 6) =       0.000426085273
  error estimate for blocks of size 2^( 7) =       0.000428769226

      target function =      -0.921479022852
              le_mean =     -17.206082160144
             les_mean =     296.343667214192
             stat err =       0.000423669202
             autocorr =       1.247741335467
   target nu stat err =       0.000423669202
   target dn stat err =       0.002531504341
      target stat err =       0.004045653752
              std dev =       0.536388689105
             le_variance =       0.287712825800


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921479022635        initial
     5.8208e+04     5.8208e+05             8.1483e-09        -0.921479026107  <--
     2.3283e+05     2.3283e+06             2.0371e-09        -0.921479024371
     9.3132e+05     9.3132e+06             5.0927e-10        -0.921479022852

*****************************************************************************
Applying the update for shift_i =   5.8208e+04     and shift_s =   5.8208e+05
*****************************************************************************

  Execution time = 5.4669e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166658e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393156e-02 1 1  ON 7
  uu_8                 7.179277e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810463e-02 1 1  ON 11
  ud_2                -2.402945e-02 1 1  ON 12
  ud_3                -7.733643e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981633e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809321e-02 1 1  ON 19
  eO_0                -7.053828e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695822e-02 1 1  ON 32
 eH1_3                -1.559995e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620747e-02 1 1  ON 35
 eH1_6                 7.491230e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927127e-02 1 1  ON 42
 eH2_3                -1.790886e-02 1 1  ON 43
 eH2_4                 1.638123e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776966e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971218e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174044e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062910e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049593e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150626e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685232e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083128e-02 3 1  ON 68
ci_020                 1.815737e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092371e-02 3 1  ON 72
ci_024                 7.125470e-03 3 1  ON 73
ci_025                 7.214299e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214331e-02 3 1  ON 76
ci_028                -1.010231e-02 3 1  ON 77
ci_029                -9.846034e-03 3 1  ON 78
ci_030                -4.814050e-03 3 1  ON 79
ci_031                -5.117726e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0338e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1555
    reference variance = 0.19968
====================================================
  Execution time = 3.7697e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5419e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0024e-01
  Total weights = 1.973883704e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0612e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291578782755
                                         uncertainty =       0.002153816014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291578782755
                                         uncertainty =       0.002153816014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381824774
  error estimate for blocks of size 2^( 2) =       0.000396972374
  error estimate for blocks of size 2^( 3) =       0.000410697005
  error estimate for blocks of size 2^( 4) =       0.000420523385
  error estimate for blocks of size 2^( 5) =       0.000427279545
  error estimate for blocks of size 2^( 6) =       0.000429242697
  error estimate for blocks of size 2^( 7) =       0.000432219044

      target function =      -0.912367284028
              le_mean =     -17.207100588022
             les_mean =     296.384545912743
             stat err =       0.000427316168
             autocorr =       1.252478968921
   target nu stat err =       0.000427316168
   target dn stat err =       0.002972802781
      target stat err =       0.004647766715
              std dev =       0.539981774398
             le_variance =       0.291580316682


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720710058802e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912390050260       residual = 5.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912390051938       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912390052489       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912390052655       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912390052700       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912390052731       residual = 9.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912390052754       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912390052790       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912390052768       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912390052796       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912390052834       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912390052807       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912390052808       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912390052840       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912390052819       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912390052826       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912390052842       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912390052901       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912390052849       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912390052904       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912390052876       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912390052904       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912390052953       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912390052903       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912390052928       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912390052882       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912390052900       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912390052890       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912390052885       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912390052843       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912390052896       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912390052899       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912390052912       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912390052892       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912390052884       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912390052832       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912390052838       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4552e+04 is 3.448737e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912390050260       residual = 5.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912390050679       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912390050817       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912390050858       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912390050779       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912390050692       residual = 9.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912390050888       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912390050888       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912390050819       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912390050892       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912390050894       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912390050817       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912390050681       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912390050908       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912390050873       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912390050804       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912390051028       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912390050826       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912390050944       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912390050847       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912390050773       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912390050871       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912390050803       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912390050948       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912390050976       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912390050659       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912390050906       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912390050829       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912390050854       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912390050749       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912390050740       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912390051000       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912390050877       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912390050748       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912390050473       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912390051388       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912390050765       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.8208e+04 is 8.621848e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912390050260       residual = 5.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912390050365       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912390050399       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912390050221       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912390050412       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912390050414       residual = 9.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912390050887       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912390050417       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912390050554       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912390050479       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912390049848       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912390050146       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912390050979       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912390051141       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912390050764       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912390051173       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912390050638       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912390050613       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912390050122       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912390049836       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912390050542       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912390050355       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912390050065       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912390050760       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912390049943       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912390050756       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912390050585       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912390049219       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912390049468       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912390050783       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912390050343       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912390050784       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912390050165       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912390050376       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912390050681       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912390050306       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912390050562       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3283e+05 is 2.155462e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.216263 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8369e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166658e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393156e-02 1 1  ON 7
  uu_8                 7.179276e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402945e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981633e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809321e-02 1 1  ON 19
  eO_0                -7.053828e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559995e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620747e-02 1 1  ON 35
 eH1_6                 7.491230e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927127e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638123e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776966e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971218e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062909e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049593e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150626e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685232e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125471e-03 3 1  ON 73
ci_025                 7.214300e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214331e-02 3 1  ON 76
ci_028                -1.010230e-02 3 1  ON 77
ci_029                -9.846034e-03 3 1  ON 78
ci_030                -4.814049e-03 3 1  ON 79
ci_031                -5.117726e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1866
    reference variance = 0.218376
====================================================
  Execution time = 3.7749e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9595e-01
  Total weights = 1.9739e+06
  Execution time = 3.1360e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288371933661
                                         uncertainty =       0.002046973023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288371933661
                                         uncertainty =       0.002046973023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379834846
  error estimate for blocks of size 2^( 2) =       0.000394901636
  error estimate for blocks of size 2^( 3) =       0.000408934949
  error estimate for blocks of size 2^( 4) =       0.000418885548
  error estimate for blocks of size 2^( 5) =       0.000424672246
  error estimate for blocks of size 2^( 6) =       0.000428079211
  error estimate for blocks of size 2^( 7) =       0.000430210158

      target function =      -0.919031461737
              le_mean =     -17.207188026487
             les_mean =     296.383273613270
             stat err =       0.000425461791
             autocorr =       1.254675789984
   target nu stat err =       0.000425461791
   target dn stat err =       0.002620342638
      target stat err =       0.004170382732
              std dev =       0.537167591030
             le_variance =       0.288549020853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288371932996
                                         uncertainty =       0.002046972960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288371932996
                                         uncertainty =       0.002046972960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379834846
  error estimate for blocks of size 2^( 2) =       0.000394901637
  error estimate for blocks of size 2^( 3) =       0.000408934953
  error estimate for blocks of size 2^( 4) =       0.000418885553
  error estimate for blocks of size 2^( 5) =       0.000424672252
  error estimate for blocks of size 2^( 6) =       0.000428079217
  error estimate for blocks of size 2^( 7) =       0.000430210165

      target function =      -0.919031493412
              le_mean =     -17.207188026381
             les_mean =     296.383273589447
             stat err =       0.000425461797
             autocorr =       1.254675830332
   target nu stat err =       0.000425461797
   target dn stat err =       0.002620338308
      target stat err =       0.004170376333
              std dev =       0.537167590402
             le_variance =       0.288549020178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288371933329
                                         uncertainty =       0.002046972992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288371933329
                                         uncertainty =       0.002046972992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379834846
  error estimate for blocks of size 2^( 2) =       0.000394901636
  error estimate for blocks of size 2^( 3) =       0.000408934951
  error estimate for blocks of size 2^( 4) =       0.000418885551
  error estimate for blocks of size 2^( 5) =       0.000424672249
  error estimate for blocks of size 2^( 6) =       0.000428079214
  error estimate for blocks of size 2^( 7) =       0.000430210162

      target function =      -0.919031477576
              le_mean =     -17.207188026434
             les_mean =     296.383273601358
             stat err =       0.000425461794
             autocorr =       1.254675810157
   target nu stat err =       0.000425461794
   target dn stat err =       0.002620340473
      target stat err =       0.004170379532
              std dev =       0.537167590716
             le_variance =       0.288549020515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288371933620
                                         uncertainty =       0.002046973019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288371933620
                                         uncertainty =       0.002046973019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379834846
  error estimate for blocks of size 2^( 2) =       0.000394901636
  error estimate for blocks of size 2^( 3) =       0.000408934949
  error estimate for blocks of size 2^( 4) =       0.000418885548
  error estimate for blocks of size 2^( 5) =       0.000424672247
  error estimate for blocks of size 2^( 6) =       0.000428079211
  error estimate for blocks of size 2^( 7) =       0.000430210158

      target function =      -0.919031463717
              le_mean =     -17.207188026480
             les_mean =     296.383273611781
             stat err =       0.000425461791
             autocorr =       1.254675792500
   target nu stat err =       0.000425461791
   target dn stat err =       0.002620342367
      target stat err =       0.004170382332
              std dev =       0.537167590991
             le_variance =       0.288549020811


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919031461737        initial
     1.4552e+04     1.4552e+05             3.4487e-08        -0.919031493412  <--
     5.8208e+04     5.8208e+05             8.6218e-09        -0.919031477576
     2.3283e+05     2.3283e+06             2.1555e-09        -0.919031463717

*****************************************************************************
Applying the update for shift_i =   1.4552e+04     and shift_s =   1.4552e+05
*****************************************************************************

  Execution time = 5.3531e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0191e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1526
    reference variance = 0.190057
====================================================
  Execution time = 3.7963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5418e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9866e-01
  Total weights = 1.973682310e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0850e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289946480184
                                         uncertainty =       0.001963758809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289946480184
                                         uncertainty =       0.001963758809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380716628
  error estimate for blocks of size 2^( 2) =       0.000395601304
  error estimate for blocks of size 2^( 3) =       0.000409477087
  error estimate for blocks of size 2^( 4) =       0.000419427582
  error estimate for blocks of size 2^( 5) =       0.000425336458
  error estimate for blocks of size 2^( 6) =       0.000427953857
  error estimate for blocks of size 2^( 7) =       0.000430518952

      target function =      -0.914817811746
              le_mean =     -17.206924050099
             les_mean =     296.376893614623
             stat err =       0.000425809212
             autocorr =       1.250911012617
   target nu stat err =       0.000425809212
   target dn stat err =       0.002663260636
      target stat err =       0.004196494031
              std dev =       0.538414618688
             le_variance =       0.289890301617


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720692405010e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914836074119       residual = 6.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914836081732       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914836083054       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914836083565       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914836083772       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914836083779       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914836083950       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914836084035       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914836084221       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914836084397       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914836084403       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914836084411       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914836084547       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914836084603       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914836084552       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914836084597       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914836084582       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914836084567       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914836084554       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914836084622       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914836084644       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914836084663       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914836084685       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914836084687       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914836084696       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914836084692       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914836084695       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914836084692       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914836084677       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914836084706       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914836084700       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914836084703       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914836084715       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914836084716       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914836084710       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914836084718       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914836084715       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914836084729       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914836084731       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.6380e+03 is 1.338291e-07

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914836074119       residual = 6.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914836076022       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914836076353       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914836076481       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914836076547       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914836076527       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914836076570       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914836076592       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914836076631       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914836076674       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914836076709       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914836076705       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914836076726       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914836076751       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914836076734       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914836076745       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914836076712       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914836076707       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914836076708       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914836076740       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914836076755       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914836076728       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914836076753       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914836076776       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914836076807       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914836076722       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914836076728       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914836076771       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914836076773       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914836076732       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914836076703       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914836076838       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914836076884       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914836076740       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914836076810       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914836076710       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914836076786       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914836076725       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914836076756       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4552e+04 is 3.345732e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914836074119       residual = 6.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914836074595       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914836074678       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914836074710       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914836074769       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914836074815       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914836074722       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914836074800       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914836074735       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914836074611       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914836074862       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914836074745       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914836074761       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914836074693       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914836074800       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914836074855       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914836074674       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914836074707       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914836074893       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914836074846       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914836074853       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914836074801       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914836074619       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914836074830       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914836074829       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914836074805       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914836074806       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914836074797       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914836074842       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914836074869       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914836074850       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914836074574       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914836074672       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914836074691       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914836074753       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914836074740       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914836074342       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914836074839       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914836074928       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.8208e+04 is 8.364335e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.278036 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8882e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940108e-02 1 1  ON 2
  uu_3                -9.291198e-02 1 1  ON 3
  uu_4                -1.239442e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393159e-02 1 1  ON 7
  uu_8                 7.179270e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.080999e-01 1 1  ON 10
  ud_1                 7.810461e-02 1 1  ON 11
  ud_2                -2.402947e-02 1 1  ON 12
  ud_3                -7.733645e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981628e-02 1 1  ON 17
  ud_8                -4.429636e-03 1 1  ON 18
  ud_9                 8.809319e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127809e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018814e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695820e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884979e-02 1 1  ON 34
 eH1_5                 2.620745e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703785e-02 1 1  ON 38
 eH1_9                 2.520341e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638123e-02 1 1  ON 44
 eH2_5                 2.331248e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971220e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261562e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241141e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086966e-02 3 1  ON 55
ci_007                -2.067471e-02 3 1  ON 56
ci_008                -5.062905e-03 3 1  ON 57
ci_009                -1.563056e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050526e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357452e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116270e-02 3 1  ON 67
ci_019                 1.083128e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125474e-03 3 1  ON 73
ci_025                 7.214299e-03 3 1  ON 74
ci_026                 1.196641e-02 3 1  ON 75
ci_027                 1.214329e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846025e-03 3 1  ON 78
ci_030                -4.814042e-03 3 1  ON 79
ci_031                -5.117719e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2057
    reference variance = 0.419506
====================================================
  Execution time = 3.7692e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0066e-01
  Total weights = 1.9738e+06
  Execution time = 3.1617e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292550654474
                                         uncertainty =       0.002356562588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292550654474
                                         uncertainty =       0.002356562588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382466250
  error estimate for blocks of size 2^( 2) =       0.000397368675
  error estimate for blocks of size 2^( 3) =       0.000411092556
  error estimate for blocks of size 2^( 4) =       0.000421179344
  error estimate for blocks of size 2^( 5) =       0.000427451834
  error estimate for blocks of size 2^( 6) =       0.000431766958
  error estimate for blocks of size 2^( 7) =       0.000431818519

      target function =      -0.911706727305
              le_mean =     -17.206950772807
             les_mean =     296.379814550058
             stat err =       0.000428054164
             autocorr =       1.252596562701
   target nu stat err =       0.000428054164
   target dn stat err =       0.003550709417
      target stat err =       0.005521894733
              std dev =       0.540888958260
             le_variance =       0.292560865167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292550640065
                                         uncertainty =       0.002356560899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292550640065
                                         uncertainty =       0.002356560899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382466241
  error estimate for blocks of size 2^( 2) =       0.000397368673
  error estimate for blocks of size 2^( 3) =       0.000411092563
  error estimate for blocks of size 2^( 4) =       0.000421179355
  error estimate for blocks of size 2^( 5) =       0.000427451849
  error estimate for blocks of size 2^( 6) =       0.000431766974
  error estimate for blocks of size 2^( 7) =       0.000431818535

      target function =      -0.911706723306
              le_mean =     -17.206950773075
             les_mean =     296.379814561936
             stat err =       0.000428054178
             autocorr =       1.252596709445
   target nu stat err =       0.000428054178
   target dn stat err =       0.003550705165
      target stat err =       0.005521888191
              std dev =       0.540888944943
             le_variance =       0.292560850761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292550647269
                                         uncertainty =       0.002356561743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292550647269
                                         uncertainty =       0.002356561743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382466246
  error estimate for blocks of size 2^( 2) =       0.000397368674
  error estimate for blocks of size 2^( 3) =       0.000411092559
  error estimate for blocks of size 2^( 4) =       0.000421179349
  error estimate for blocks of size 2^( 5) =       0.000427451842
  error estimate for blocks of size 2^( 6) =       0.000431766966
  error estimate for blocks of size 2^( 7) =       0.000431818527

      target function =      -0.911706725309
              le_mean =     -17.206950772941
             les_mean =     296.379814555994
             stat err =       0.000428054171
             autocorr =       1.252596636070
   target nu stat err =       0.000428054171
   target dn stat err =       0.003550707291
      target stat err =       0.005521891462
              std dev =       0.540888951601
             le_variance =       0.292560857964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292550653573
                                         uncertainty =       0.002356562482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292550653573
                                         uncertainty =       0.002356562482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382466250
  error estimate for blocks of size 2^( 2) =       0.000397368675
  error estimate for blocks of size 2^( 3) =       0.000411092557
  error estimate for blocks of size 2^( 4) =       0.000421179344
  error estimate for blocks of size 2^( 5) =       0.000427451835
  error estimate for blocks of size 2^( 6) =       0.000431766959
  error estimate for blocks of size 2^( 7) =       0.000431818520

      target function =      -0.911706727056
              le_mean =     -17.206950772824
             les_mean =     296.379814550799
             stat err =       0.000428054165
             autocorr =       1.252596571864
   target nu stat err =       0.000428054165
   target dn stat err =       0.003550709152
      target stat err =       0.005521894324
              std dev =       0.540888957427
             le_variance =       0.292560864267


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911706727305        initial  <--
     3.6380e+03     3.6380e+04             1.3383e-07        -0.911706723306
     1.4552e+04     1.4552e+05             3.3457e-08        -0.911706725309
     5.8208e+04     5.8208e+05             8.3643e-09        -0.911706727056

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.5718
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0246e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.212
    reference variance = 0.204642
====================================================
  Execution time = 3.7948e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5433e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0138e-01
  Total weights = 1.973810547e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0738e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291826645856
                                         uncertainty =       0.002392336544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291826645856
                                         uncertainty =       0.002392336544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382011677
  error estimate for blocks of size 2^( 2) =       0.000396774047
  error estimate for blocks of size 2^( 3) =       0.000410478036
  error estimate for blocks of size 2^( 4) =       0.000420682188
  error estimate for blocks of size 2^( 5) =       0.000427300506
  error estimate for blocks of size 2^( 6) =       0.000431470553
  error estimate for blocks of size 2^( 7) =       0.000431895342

      target function =      -0.910629370253
              le_mean =     -17.206043463318
             les_mean =     296.349311366063
             stat err =       0.000427837147
             autocorr =       1.254306583379
   target nu stat err =       0.000427837147
   target dn stat err =       0.003286136768
      target stat err =       0.005097168527
              std dev =       0.540246095187
             le_variance =       0.291865843365


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720604346332e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910656930924       residual = 7.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910656931939       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910656932123       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910656932182       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910656932257       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910656932198       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910656932215       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910656932227       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910656932264       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910656932236       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910656932276       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910656932245       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910656932147       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910656932171       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910656932326       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910656932256       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910656932345       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910656932059       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910656932403       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910656932223       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910656932421       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910656932338       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910656932381       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910656932299       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910656932295       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910656932597       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910656932367       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910656932359       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910656932087       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910656932313       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910656932149       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910656932466       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910656932233       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910656932281       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910656932260       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910656932131       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.6380e+04 is 1.419810e-08

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910656930924       residual = 7.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910656931178       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910656931223       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910656931236       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910656931237       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910656931242       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910656930956       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910656931250       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910656931251       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910656931252       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910656931253       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910656931242       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910656931242       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910656931029       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910656930908       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910656931260       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910656931235       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910656931445       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910656931315       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910656931348       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910656931424       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910656931243       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910656931469       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910656930634       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910656931205       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910656932193       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910656932577       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910656931056       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910656931475       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910656930158       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910656932404       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910656930136       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910656931069       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910656930666       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910656931544       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910656931129       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4552e+05 is 3.549526e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910656930924       residual = 7.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910656930987       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910656930999       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910656931002       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910656931002       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910656931003       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910656932063       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910656932540       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910656930970       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910656931997       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910656930159       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910656930596       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910656931007       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910656930859       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910656930766       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910656931016       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910656930468       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910656931015       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910656931304       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910656931186       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910656930425       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910656932504       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910656930624       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910656929332       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910656931737       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910656929861       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910656931180       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910656930013       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910656928195       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910656930670       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910656931640       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910656931427       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910656929041       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910656929098       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910656929259       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910656929346       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.8208e+05 is 8.873819e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.327481 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8743e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291198e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884979e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050526e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196641e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846031e-03 3 1  ON 78
ci_030                -4.814048e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1674
    reference variance = 0.241723
====================================================
  Execution time = 3.8790e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9704e-01
  Total weights = 1.9738e+06
  Execution time = 3.1401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289086641079
                                         uncertainty =       0.001658326563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289086641079
                                         uncertainty =       0.001658326563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380153894
  error estimate for blocks of size 2^( 2) =       0.000395070625
  error estimate for blocks of size 2^( 3) =       0.000408755047
  error estimate for blocks of size 2^( 4) =       0.000418757889
  error estimate for blocks of size 2^( 5) =       0.000425144583
  error estimate for blocks of size 2^( 6) =       0.000427996672
  error estimate for blocks of size 2^( 7) =       0.000431483632

      target function =      -0.917340341184
              le_mean =     -17.206881117196
             les_mean =     296.373798214059
             stat err =       0.000425845694
             autocorr =       1.254832139777
   target nu stat err =       0.000425845694
   target dn stat err =       0.002395729840
      target stat err =       0.003808348294
              std dev =       0.537618792776
             le_variance =       0.289033966346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289086640623
                                         uncertainty =       0.001658326492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289086640623
                                         uncertainty =       0.001658326492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380153894
  error estimate for blocks of size 2^( 2) =       0.000395070626
  error estimate for blocks of size 2^( 3) =       0.000408755048
  error estimate for blocks of size 2^( 4) =       0.000418757891
  error estimate for blocks of size 2^( 5) =       0.000425144585
  error estimate for blocks of size 2^( 6) =       0.000427996674
  error estimate for blocks of size 2^( 7) =       0.000431483634

      target function =      -0.917340337211
              le_mean =     -17.206881117162
             les_mean =     296.373798215431
             stat err =       0.000425845696
             autocorr =       1.254832150862
   target nu stat err =       0.000425845696
   target dn stat err =       0.002395729866
      target stat err =       0.003808348300
              std dev =       0.537618792351
             le_variance =       0.289033965889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289086640851
                                         uncertainty =       0.001658326527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289086640851
                                         uncertainty =       0.001658326527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380153894
  error estimate for blocks of size 2^( 2) =       0.000395070626
  error estimate for blocks of size 2^( 3) =       0.000408755048
  error estimate for blocks of size 2^( 4) =       0.000418757890
  error estimate for blocks of size 2^( 5) =       0.000425144584
  error estimate for blocks of size 2^( 6) =       0.000427996673
  error estimate for blocks of size 2^( 7) =       0.000431483633

      target function =      -0.917340339198
              le_mean =     -17.206881117179
             les_mean =     296.373798214745
             stat err =       0.000425845695
             autocorr =       1.254832145320
   target nu stat err =       0.000425845695
   target dn stat err =       0.002395729853
      target stat err =       0.003808348297
              std dev =       0.537618792564
             le_variance =       0.289033966117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289086641051
                                         uncertainty =       0.001658326559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289086641051
                                         uncertainty =       0.001658326559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380153894
  error estimate for blocks of size 2^( 2) =       0.000395070625
  error estimate for blocks of size 2^( 3) =       0.000408755047
  error estimate for blocks of size 2^( 4) =       0.000418757889
  error estimate for blocks of size 2^( 5) =       0.000425144583
  error estimate for blocks of size 2^( 6) =       0.000427996672
  error estimate for blocks of size 2^( 7) =       0.000431483632

      target function =      -0.917340340936
              le_mean =     -17.206881117194
             les_mean =     296.373798214145
             stat err =       0.000425845694
             autocorr =       1.254832140468
   target nu stat err =       0.000425845694
   target dn stat err =       0.002395729842
      target stat err =       0.003808348294
              std dev =       0.537618792749
             le_variance =       0.289033966317


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917340341184        initial  <--
     3.6380e+04     3.6380e+05             1.4198e-08        -0.917340337211
     1.4552e+05     1.4552e+06             3.5495e-09        -0.917340339198
     5.8208e+05     5.8208e+06             8.8738e-10        -0.917340340936

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.6592
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0341e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2098
    reference variance = 0.242004
====================================================
  Execution time = 3.7908e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5421e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9908e-01
  Total weights = 1.973756535e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0965e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290145753768
                                         uncertainty =       0.002237846469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290145753768
                                         uncertainty =       0.002237846469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380853306
  error estimate for blocks of size 2^( 2) =       0.000395235928
  error estimate for blocks of size 2^( 3) =       0.000408700523
  error estimate for blocks of size 2^( 4) =       0.000417826571
  error estimate for blocks of size 2^( 5) =       0.000423132368
  error estimate for blocks of size 2^( 6) =       0.000426463478
  error estimate for blocks of size 2^( 7) =       0.000428472997

      target function =      -0.914153125740
              le_mean =     -17.207180817384
             les_mean =     296.386151345849
             stat err =       0.000423973854
             autocorr =       1.239260733305
   target nu stat err =       0.000423973854
   target dn stat err =       0.002996130313
      target stat err =       0.004701322079
              std dev =       0.538607910762
             le_variance =       0.290098481535


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720718081738e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914176299841       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914176299991       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914176300008       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914176300014       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914176299992       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914176300018       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914176299865       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914176300468       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914176300186       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914176300587       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914176299314       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914176299193       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914176300182       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914176299962       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914176300553       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914176299726       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914176298266       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914176299731       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914176300335       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914176300174       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914176299865       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914176297962       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914176298494       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914176299464       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914176298991       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914176302289       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914176300485       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914176300070       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914176297018       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914176297501       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914176299255       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914176300169       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914176299802       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914176299467       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914176300565       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914176301676       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.6380e+05 is 1.362320e-09

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914176299841       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914176299879       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914176299883       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914176299925       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914176301219       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914176303047       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914176300166       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914176298179       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914176296796       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914176300696       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914176301527       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914176298412       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914176301315       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914176304190       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914176295856       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914176296442       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914176294127       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914176298710       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914176299619       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914176303605       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914176302608       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914176298446       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914176291174       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914176298006       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914176302531       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914176296546       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914176297845       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914176304025       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914176303189       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914176296476       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914176300736       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914176295374       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914176303907       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914176293338       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914176303626       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914176300812       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4552e+06 is 3.405803e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914176299841       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914176299851       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914176299852       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914176299997       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914176299887       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914176301071       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914176311778       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914176310563       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914176308499       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914176306316       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914176297371       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914176301772       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914176303514       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914176306666       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914176301381       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914176304165       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914176308769       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914176306901       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914176312089       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914176296197       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914176296974       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914176293171       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914176302701       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914176293246       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914176286968       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914176293935       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914176290901       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914176307823       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914176298521       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914176317423       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914176310858       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914176280538       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914176299206       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914176281322       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914176287635       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914176322353       residual = 8.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.8208e+06 is 8.514477e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.376962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8929e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2315
    reference variance = 0.157502
====================================================
  Execution time = 3.7647e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9561e-01
  Total weights = 1.9736e+06
  Execution time = 3.1360e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289852122696
                                         uncertainty =       0.001916297441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289852122696
                                         uncertainty =       0.001916297441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380697873
  error estimate for blocks of size 2^( 2) =       0.000395462741
  error estimate for blocks of size 2^( 3) =       0.000408774372
  error estimate for blocks of size 2^( 4) =       0.000418963958
  error estimate for blocks of size 2^( 5) =       0.000425276058
  error estimate for blocks of size 2^( 6) =       0.000429893899
  error estimate for blocks of size 2^( 7) =       0.000431905701

      target function =      -0.919585481933
              le_mean =     -17.206431341986
             les_mean =     296.356888742427
             stat err =       0.000426509904
             autocorr =       1.255154937579
   target nu stat err =       0.000426509904
   target dn stat err =       0.002380891082
      target stat err =       0.003800874939
              std dev =       0.538388095569
             le_variance =       0.289861741451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289852122630
                                         uncertainty =       0.001916297417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289852122630
                                         uncertainty =       0.001916297417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380697873
  error estimate for blocks of size 2^( 2) =       0.000395462741
  error estimate for blocks of size 2^( 3) =       0.000408774372
  error estimate for blocks of size 2^( 4) =       0.000418963958
  error estimate for blocks of size 2^( 5) =       0.000425276058
  error estimate for blocks of size 2^( 6) =       0.000429893899
  error estimate for blocks of size 2^( 7) =       0.000431905701

      target function =      -0.919585481787
              le_mean =     -17.206431341991
             les_mean =     296.356888742711
             stat err =       0.000426509904
             autocorr =       1.255154939138
   target nu stat err =       0.000426509904
   target dn stat err =       0.002380891070
      target stat err =       0.003800874919
              std dev =       0.538388095507
             le_variance =       0.289861741384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289852122663
                                         uncertainty =       0.001916297429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289852122663
                                         uncertainty =       0.001916297429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380697873
  error estimate for blocks of size 2^( 2) =       0.000395462741
  error estimate for blocks of size 2^( 3) =       0.000408774372
  error estimate for blocks of size 2^( 4) =       0.000418963958
  error estimate for blocks of size 2^( 5) =       0.000425276058
  error estimate for blocks of size 2^( 6) =       0.000429893899
  error estimate for blocks of size 2^( 7) =       0.000431905701

      target function =      -0.919585481860
              le_mean =     -17.206431341988
             les_mean =     296.356888742569
             stat err =       0.000426509904
             autocorr =       1.255154938362
   target nu stat err =       0.000426509904
   target dn stat err =       0.002380891076
      target stat err =       0.003800874929
              std dev =       0.538388095538
             le_variance =       0.289861741417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289852122692
                                         uncertainty =       0.001916297439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289852122692
                                         uncertainty =       0.001916297439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380697873
  error estimate for blocks of size 2^( 2) =       0.000395462741
  error estimate for blocks of size 2^( 3) =       0.000408774372
  error estimate for blocks of size 2^( 4) =       0.000418963958
  error estimate for blocks of size 2^( 5) =       0.000425276058
  error estimate for blocks of size 2^( 6) =       0.000429893899
  error estimate for blocks of size 2^( 7) =       0.000431905701

      target function =      -0.919585481923
              le_mean =     -17.206431341986
             les_mean =     296.356888742444
             stat err =       0.000426509904
             autocorr =       1.255154937678
   target nu stat err =       0.000426509904
   target dn stat err =       0.002380891082
      target stat err =       0.003800874938
              std dev =       0.538388095565
             le_variance =       0.289861741447


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919585481933        initial  <--
     3.6380e+05     3.6380e+06             1.3623e-09        -0.919585481787
     1.4552e+06     1.4552e+07             3.4058e-10        -0.919585481860
     5.8208e+06     5.8208e+07             8.5145e-11        -0.919585481923

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.4728
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0241e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.278
    reference variance = 0.357091
====================================================
  Execution time = 3.7934e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5420e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9951e-01
  Total weights = 1.973681418e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1055e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291941707239
                                         uncertainty =       0.001818800919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291941707239
                                         uncertainty =       0.001818800919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382049181
  error estimate for blocks of size 2^( 2) =       0.000396458399
  error estimate for blocks of size 2^( 3) =       0.000410367135
  error estimate for blocks of size 2^( 4) =       0.000419980678
  error estimate for blocks of size 2^( 5) =       0.000426190382
  error estimate for blocks of size 2^( 6) =       0.000430267776
  error estimate for blocks of size 2^( 7) =       0.000433182920

      target function =      -0.913492754687
              le_mean =     -17.207058073298
             les_mean =     296.382361276081
             stat err =       0.000427405439
             autocorr =       1.251530800818
   target nu stat err =       0.000427405439
   target dn stat err =       0.002366885077
      target stat err =       0.003734973100
              std dev =       0.540299133751
             le_variance =       0.291923153932


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720705807330e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913506849906       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913506849914       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913506849916       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913506849811       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913506852221       residual = 8.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913506846842       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913506840744       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913506849966       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913506849266       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913506848508       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913506849685       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913506848887       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913506843196       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913506846326       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913506851235       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913506857765       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913506852181       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913506845371       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913506850095       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913506854677       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913506850537       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913506847036       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913506862092       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913506848525       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913506859611       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913506837658       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913506851321       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913506868601       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913506855527       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913506830429       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913506839269       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913506844723       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913506833862       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913506848830       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913506839208       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.6380e+06 is 9.810935e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913506849906       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913506849908       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913506849909       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913506849909       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913506847654       residual = 8.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913506844614       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913506849909       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913506843088       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913506849909       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913506872776       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913506865477       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913506844701       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913506849909       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913506865249       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913506836720       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913506815403       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913506887169       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913506862485       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913506890226       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913506851363       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913506869931       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913506833052       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913506851724       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913506854670       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913506853339       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913506846297       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913506837937       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913506845900       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913506805183       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913506845298       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913506795892       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913506840288       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913506856217       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913506802854       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913506811687       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4552e+07 is 2.452765e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913506849906       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913506849907       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913506849907       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913506849906       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913506849907       residual = 8.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913506759564       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913506842279       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913506766860       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913506785149       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913506789370       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913506770354       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913506616712       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913506696791       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913506739562       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913506736459       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913506881925       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913506762865       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913506849907       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913506794503       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913506947587       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913506784216       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913506780840       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913506782712       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913506792903       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913506817441       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913506818232       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913506685918       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913506871409       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913506885390       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913506699441       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913506749461       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913507152097       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913506813680       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913506864337       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913506890990       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.8208e+07 is 6.132173e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.422929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9042e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1609
    reference variance = 0.222954
====================================================
  Execution time = 3.7567e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9462e-01
  Total weights = 1.9739e+06
  Execution time = 3.1572e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286774035212
                                         uncertainty =       0.001491809864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286774035212
                                         uncertainty =       0.001491809864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378675641
  error estimate for blocks of size 2^( 2) =       0.000393771247
  error estimate for blocks of size 2^( 3) =       0.000408157535
  error estimate for blocks of size 2^( 4) =       0.000417958442
  error estimate for blocks of size 2^( 5) =       0.000424278500
  error estimate for blocks of size 2^( 6) =       0.000426220601
  error estimate for blocks of size 2^( 7) =       0.000428711500

      target function =      -0.921132036707
              le_mean =     -17.206786039957
             les_mean =     296.368103928150
             stat err =       0.000424292261
             autocorr =       1.255438614830
   target nu stat err =       0.000424292261
   target dn stat err =       0.002775320470
      target stat err =       0.004426062958
              std dev =       0.535528226672
             le_variance =       0.286790481562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286774035219
                                         uncertainty =       0.001491809864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286774035219
                                         uncertainty =       0.001491809864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378675641
  error estimate for blocks of size 2^( 2) =       0.000393771247
  error estimate for blocks of size 2^( 3) =       0.000408157535
  error estimate for blocks of size 2^( 4) =       0.000417958442
  error estimate for blocks of size 2^( 5) =       0.000424278500
  error estimate for blocks of size 2^( 6) =       0.000426220601
  error estimate for blocks of size 2^( 7) =       0.000428711500

      target function =      -0.921132036632
              le_mean =     -17.206786039957
             les_mean =     296.368103928190
             stat err =       0.000424292261
             autocorr =       1.255438614941
   target nu stat err =       0.000424292261
   target dn stat err =       0.002775320517
      target stat err =       0.004426063030
              std dev =       0.535528226678
             le_variance =       0.286790481569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286774035215
                                         uncertainty =       0.001491809864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286774035215
                                         uncertainty =       0.001491809864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378675641
  error estimate for blocks of size 2^( 2) =       0.000393771247
  error estimate for blocks of size 2^( 3) =       0.000408157535
  error estimate for blocks of size 2^( 4) =       0.000417958442
  error estimate for blocks of size 2^( 5) =       0.000424278500
  error estimate for blocks of size 2^( 6) =       0.000426220601
  error estimate for blocks of size 2^( 7) =       0.000428711500

      target function =      -0.921132036670
              le_mean =     -17.206786039957
             les_mean =     296.368103928170
             stat err =       0.000424292261
             autocorr =       1.255438614890
   target nu stat err =       0.000424292261
   target dn stat err =       0.002775320494
      target stat err =       0.004426062994
              std dev =       0.535528226675
             le_variance =       0.286790481565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286774035213
                                         uncertainty =       0.001491809864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286774035213
                                         uncertainty =       0.001491809864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378675641
  error estimate for blocks of size 2^( 2) =       0.000393771247
  error estimate for blocks of size 2^( 3) =       0.000408157535
  error estimate for blocks of size 2^( 4) =       0.000417958442
  error estimate for blocks of size 2^( 5) =       0.000424278500
  error estimate for blocks of size 2^( 6) =       0.000426220601
  error estimate for blocks of size 2^( 7) =       0.000428711500

      target function =      -0.921132036702
              le_mean =     -17.206786039957
             les_mean =     296.368103928153
             stat err =       0.000424292261
             autocorr =       1.255438614834
   target nu stat err =       0.000424292261
   target dn stat err =       0.002775320473
      target stat err =       0.004426062962
              std dev =       0.535528226672
             le_variance =       0.286790481563


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921132036707        initial  <--
     3.6380e+06     3.6380e+07             9.8109e-11        -0.921132036632
     1.4552e+07     1.4552e+08             2.4528e-11        -0.921132036670
     5.8208e+07     5.8208e+08             6.1322e-12        -0.921132036702

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.4563
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0250e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2761
    reference variance = 0.225801
====================================================
  Execution time = 3.8154e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5424e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0107e-01
  Total weights = 1.973879769e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0930e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290325408854
                                         uncertainty =       0.001631013431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290325408854
                                         uncertainty =       0.001631013431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381022072
  error estimate for blocks of size 2^( 2) =       0.000395589112
  error estimate for blocks of size 2^( 3) =       0.000409738597
  error estimate for blocks of size 2^( 4) =       0.000419619690
  error estimate for blocks of size 2^( 5) =       0.000425463975
  error estimate for blocks of size 2^( 6) =       0.000429063824
  error estimate for blocks of size 2^( 7) =       0.000431758114

      target function =      -0.911086767837
              le_mean =     -17.206142339216
             les_mean =     296.352400129486
             stat err =       0.000426476401
             autocorr =       1.252823060965
   target nu stat err =       0.000426476401
   target dn stat err =       0.004395165472
      target stat err =       0.006795164917
              std dev =       0.538846582160
             le_variance =       0.290355639105


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720614233922e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911136337468       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911136337470       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911136337470       residual = 9.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911136346269       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911136339837       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911136250721       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911136356496       residual = 9.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911136345943       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911136290794       residual = 9.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911136320300       residual = 6.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911136342882       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911136355544       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911136408414       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911136321907       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911136380749       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911136297506       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911136346953       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911136347667       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911136347953       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911136346180       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911136258145       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911136408626       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911136202479       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911136322632       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911136370605       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911136237536       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911136446488       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911136271716       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911136309008       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911136246493       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911136273591       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911136383413       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911136256918       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911136341768       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911136316267       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911136250773       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911136291898       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911136337381       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911136307393       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.911136384379       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.911136258823       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.6380e+07 is 2.827521e-11

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911136337468       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911136337469       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911136337469       residual = 9.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911136216670       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911136337415       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911136362312       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911136401716       residual = 9.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911136733509       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911136186752       residual = 9.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911136451410       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911136360883       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911136203212       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911136381667       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911136838183       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911136621707       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911136480637       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911136502141       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911135586211       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911136574605       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911136970094       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911136139574       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911136382277       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911135145380       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911136050845       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911136456383       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911137124123       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911136225259       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911136616421       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911136335003       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911136127427       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911136411343       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911136225940       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911136209825       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911136170093       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911136405014       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911136308738       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911136138824       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911136698949       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911136976091       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.911136728143       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.911136948288       residual = 7.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4552e+08 is 7.068712e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911136337468       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911136337468       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911136337468       residual = 9.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911136337469       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911136337337       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911136370552       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911136586494       residual = 9.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911135347319       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911135977792       residual = 9.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911136048566       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911135928139       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911136342287       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911138133679       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911135459223       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911135542364       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911136420939       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911136460165       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911136317491       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911134925546       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911135896214       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911135667002       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911134995415       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911136134246       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911136522578       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911135319531       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911135189878       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911137483754       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911136932717       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911134671938       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911136234122       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911135607021       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911136130282       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911136656852       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911134147509       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911137339273       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911132953854       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911136325103       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911138372346       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911134740798       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.911135594683       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.911135929271       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.8208e+08 is 1.767613e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.493834 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9163e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.1543
    reference variance = 0.185908
====================================================
  Execution time = 3.9263e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9902e-01
  Total weights = 1.9738e+06
  Execution time = 3.1586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290316961390
                                         uncertainty =       0.001794576617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290316961390
                                         uncertainty =       0.001794576617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380962607
  error estimate for blocks of size 2^( 2) =       0.000395668428
  error estimate for blocks of size 2^( 3) =       0.000409200698
  error estimate for blocks of size 2^( 4) =       0.000418816044
  error estimate for blocks of size 2^( 5) =       0.000425217033
  error estimate for blocks of size 2^( 6) =       0.000429186347
  error estimate for blocks of size 2^( 7) =       0.000430711133

      target function =      -0.914263647033
              le_mean =     -17.206577872443
             les_mean =     296.365344108823
             stat err =       0.000425982639
             autocorr =       1.250314016707
   target nu stat err =       0.000425982639
   target dn stat err =       0.002535441248
      target stat err =       0.003993918031
              std dev =       0.538762485409
             le_variance =       0.290265015684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290316961389
                                         uncertainty =       0.001794576617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290316961389
                                         uncertainty =       0.001794576617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380962607
  error estimate for blocks of size 2^( 2) =       0.000395668428
  error estimate for blocks of size 2^( 3) =       0.000409200698
  error estimate for blocks of size 2^( 4) =       0.000418816044
  error estimate for blocks of size 2^( 5) =       0.000425217033
  error estimate for blocks of size 2^( 6) =       0.000429186347
  error estimate for blocks of size 2^( 7) =       0.000430711133

      target function =      -0.914263647048
              le_mean =     -17.206577872443
             les_mean =     296.365344108812
             stat err =       0.000425982639
             autocorr =       1.250314016714
   target nu stat err =       0.000425982639
   target dn stat err =       0.002535441246
      target stat err =       0.003993918029
              std dev =       0.538762485408
             le_variance =       0.290265015683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290316961389
                                         uncertainty =       0.001794576617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290316961389
                                         uncertainty =       0.001794576617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380962607
  error estimate for blocks of size 2^( 2) =       0.000395668428
  error estimate for blocks of size 2^( 3) =       0.000409200698
  error estimate for blocks of size 2^( 4) =       0.000418816044
  error estimate for blocks of size 2^( 5) =       0.000425217033
  error estimate for blocks of size 2^( 6) =       0.000429186347
  error estimate for blocks of size 2^( 7) =       0.000430711133

      target function =      -0.914263647040
              le_mean =     -17.206577872443
             les_mean =     296.365344108818
             stat err =       0.000425982639
             autocorr =       1.250314016705
   target nu stat err =       0.000425982639
   target dn stat err =       0.002535441247
      target stat err =       0.003993918030
              std dev =       0.538762485408
             le_variance =       0.290265015683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290316961390
                                         uncertainty =       0.001794576617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290316961390
                                         uncertainty =       0.001794576617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380962607
  error estimate for blocks of size 2^( 2) =       0.000395668428
  error estimate for blocks of size 2^( 3) =       0.000409200698
  error estimate for blocks of size 2^( 4) =       0.000418816044
  error estimate for blocks of size 2^( 5) =       0.000425217033
  error estimate for blocks of size 2^( 6) =       0.000429186347
  error estimate for blocks of size 2^( 7) =       0.000430711133

      target function =      -0.914263647034
              le_mean =     -17.206577872443
             les_mean =     296.365344108823
             stat err =       0.000425982639
             autocorr =       1.250314016700
   target nu stat err =       0.000425982639
   target dn stat err =       0.002535441248
      target stat err =       0.003993918031
              std dev =       0.538762485409
             le_variance =       0.290265015684


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914263647033        initial
     3.6380e+07     3.6380e+08             2.8275e-11        -0.914263647048  <--
     1.4552e+08     1.4552e+09             7.0687e-12        -0.914263647040
     5.8208e+08     5.8208e+09             1.7676e-12        -0.914263647034

*****************************************************************************
Applying the update for shift_i =   3.6380e+07     and shift_s =   3.6380e+08
*****************************************************************************

  Execution time = 5.5144e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0431e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.3
    reference variance = 0.699362
====================================================
  Execution time = 3.8033e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5412e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 3.1601e-01
  Total weights = 1.973813405e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0872e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306624235339
                                         uncertainty =       0.017915727750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306624235339
                                         uncertainty =       0.017915727750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391573123
  error estimate for blocks of size 2^( 2) =       0.000405730260
  error estimate for blocks of size 2^( 3) =       0.000418731923
  error estimate for blocks of size 2^( 4) =       0.000428582560
  error estimate for blocks of size 2^( 5) =       0.000434775883
  error estimate for blocks of size 2^( 6) =       0.000438730589
  error estimate for blocks of size 2^( 7) =       0.000440646854

      target function =      -0.887711357735
              le_mean =     -17.207612170635
             les_mean =     296.417924928217
             stat err =       0.000435683972
             autocorr =       1.237990798209
   target nu stat err =       0.000435683972
   target dn stat err =       0.019531796189
      target stat err =       0.028621146201
              std dev =       0.553768020875
             le_variance =       0.306659020944


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720761217063e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.888627493896       residual = 2.49e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.888627494138       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.888627494142       residual = 7.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.888627494144       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.888627493868       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.888627499985       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.888627490874       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.888627485052       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.888627490554       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.888627505470       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.888627487677       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.888627508128       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.888627497736       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.888627493171       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.888627467193       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.888627507763       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.888627489135       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.888627523527       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.888627458782       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.888627484555       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.888627490660       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.888627506419       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.888627490565       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.888627479400       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.888627511006       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.888627496069       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.888627503819       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.888627501297       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.888627474890       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.888627495206       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.888627498334       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.888627533076       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.888627464651       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.888627539333       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.888627509872       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.888627494057       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.888627491202       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.0949e+06 is 9.575505e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.888627493896       residual = 2.49e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.888627493957       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.888627493958       residual = 7.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.888627493956       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.888627493964       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.888627515858       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.888627485959       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.888627515039       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.888627523141       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.888627528275       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.888627518429       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.888627471898       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.888627472632       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.888627478195       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.888627544296       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.888627519576       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.888627516966       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.888627425577       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.888627414223       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.888627454454       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.888627498157       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.888627518835       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.888627472252       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.888627654903       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.888627418963       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.888627642965       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.888627496340       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.888627421049       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.888627479623       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.888627435426       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.888627727089       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.888627413374       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.888627587977       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.888627467914       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.888627442091       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.888627567982       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.888627552600       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.6380e+07 is 2.393877e-11

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.888627493896       residual = 2.49e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.888627493912       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.888627493912       residual = 7.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.888627493912       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.888627493942       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.888627495728       residual = 9.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.888627417827       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.888627218872       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.888627678770       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.888627434685       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.888627419214       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.888627672157       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.888627624641       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.888627241934       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.888627516608       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.888627437701       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.888627325055       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.888627265036       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.888627580767       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.888627732347       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.888627595693       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.888627622637       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.888627586069       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.888627168467       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.888627525462       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.888627097743       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.888627731498       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.888627052611       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.888627292019       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.888626729509       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.888627569176       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.888627310248       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.888627420280       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.888627341035       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.888627130659       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.888627081513       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.888627751135       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4552e+08 is 5.984687e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.547842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8967e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.1569
    reference variance = 0.167789
====================================================
  Execution time = 3.7303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0030e-01
  Total weights = 1.9739e+06
  Execution time = 3.1488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292358116565
                                         uncertainty =       0.003477204913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292358116565
                                         uncertainty =       0.003477204913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382291645
  error estimate for blocks of size 2^( 2) =       0.000397040687
  error estimate for blocks of size 2^( 3) =       0.000410860340
  error estimate for blocks of size 2^( 4) =       0.000421692796
  error estimate for blocks of size 2^( 5) =       0.000428008561
  error estimate for blocks of size 2^( 6) =       0.000432116250
  error estimate for blocks of size 2^( 7) =       0.000435449596

      target function =      -0.912225566459
              le_mean =     -17.207188181241
             les_mean =     296.387625286801
             stat err =       0.000429316801
             autocorr =       1.261148292721
   target nu stat err =       0.000429316801
   target dn stat err =       0.004904368285
      target stat err =       0.007608198742
              std dev =       0.540642028989
             le_variance =       0.292293803510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292358116562
                                         uncertainty =       0.003477204911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292358116562
                                         uncertainty =       0.003477204911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382291645
  error estimate for blocks of size 2^( 2) =       0.000397040687
  error estimate for blocks of size 2^( 3) =       0.000410860340
  error estimate for blocks of size 2^( 4) =       0.000421692796
  error estimate for blocks of size 2^( 5) =       0.000428008561
  error estimate for blocks of size 2^( 6) =       0.000432116250
  error estimate for blocks of size 2^( 7) =       0.000435449596

      target function =      -0.912225566450
              le_mean =     -17.207188181241
             les_mean =     296.387625286811
             stat err =       0.000429316801
             autocorr =       1.261148292843
   target nu stat err =       0.000429316801
   target dn stat err =       0.004904368283
      target stat err =       0.007608198739
              std dev =       0.540642028986
             le_variance =       0.292293803506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292358116564
                                         uncertainty =       0.003477204912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292358116564
                                         uncertainty =       0.003477204912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382291645
  error estimate for blocks of size 2^( 2) =       0.000397040687
  error estimate for blocks of size 2^( 3) =       0.000410860340
  error estimate for blocks of size 2^( 4) =       0.000421692796
  error estimate for blocks of size 2^( 5) =       0.000428008561
  error estimate for blocks of size 2^( 6) =       0.000432116250
  error estimate for blocks of size 2^( 7) =       0.000435449596

      target function =      -0.912225566454
              le_mean =     -17.207188181241
             les_mean =     296.387625286806
             stat err =       0.000429316801
             autocorr =       1.261148292781
   target nu stat err =       0.000429316801
   target dn stat err =       0.004904368284
      target stat err =       0.007608198741
              std dev =       0.540642028988
             le_variance =       0.292293803508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292358116565
                                         uncertainty =       0.003477204913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292358116565
                                         uncertainty =       0.003477204913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382291645
  error estimate for blocks of size 2^( 2) =       0.000397040687
  error estimate for blocks of size 2^( 3) =       0.000410860340
  error estimate for blocks of size 2^( 4) =       0.000421692796
  error estimate for blocks of size 2^( 5) =       0.000428008561
  error estimate for blocks of size 2^( 6) =       0.000432116250
  error estimate for blocks of size 2^( 7) =       0.000435449596

      target function =      -0.912225566458
              le_mean =     -17.207188181241
             les_mean =     296.387625286802
             stat err =       0.000429316801
             autocorr =       1.261148292734
   target nu stat err =       0.000429316801
   target dn stat err =       0.004904368285
      target stat err =       0.007608198742
              std dev =       0.540642028989
             le_variance =       0.292293803509


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912225566459        initial  <--
     9.0949e+06     9.0949e+07             9.5755e-11        -0.912225566450
     3.6380e+07     3.6380e+08             2.3939e-11        -0.912225566454
     1.4552e+08     1.4552e+09             5.9847e-12        -0.912225566458

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.1394
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0211e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1729
    reference variance = 0.221941
====================================================
  Execution time = 3.7751e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5411e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0006e-01
  Total weights = 1.973907579e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0843e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292154989951
                                         uncertainty =       0.002230591120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292154989951
                                         uncertainty =       0.002230591120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382148841
  error estimate for blocks of size 2^( 2) =       0.000397132051
  error estimate for blocks of size 2^( 3) =       0.000410943062
  error estimate for blocks of size 2^( 4) =       0.000420688303
  error estimate for blocks of size 2^( 5) =       0.000427008322
  error estimate for blocks of size 2^( 6) =       0.000429600866
  error estimate for blocks of size 2^( 7) =       0.000430948308

      target function =      -0.912630441672
              le_mean =     -17.207119410501
             les_mean =     296.385017720801
             stat err =       0.000427061450
             autocorr =       1.248865436987
   target nu stat err =       0.000427061450
   target dn stat err =       0.003453234798
      target stat err =       0.005385189923
              std dev =       0.540440074012
             le_variance =       0.292075473598


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720711941050e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+07, overlap shift 9.0949e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912661361972       residual = 6.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912661361972       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912661361972       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912661350746       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912661400992       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912661098431       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912661428306       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912661380552       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912661326891       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912661109379       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912661363029       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912661006735       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912661404186       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912661474446       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912661298570       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912661509988       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912661251325       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912661180475       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912661365781       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912661265607       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912661307979       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912661207159       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912661119070       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912661072641       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912661294211       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912661545504       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912661535825       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912661238772       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912661064113       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912661237799       residual = 9.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912661220611       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912661316155       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912661340864       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912661392881       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912661189929       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912661000394       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912661429380       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912661188652       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.0949e+07 is 4.658598e-12

solving harmonic davidson linear method for identity shift 3.6380e+08, overlap shift 3.6380e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912661361972       residual = 6.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912661361972       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912661361972       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912661361972       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912661361972       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912661360607       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912661651104       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912661182258       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912661181687       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912661738780       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912661197990       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912661135739       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912661558786       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912660735708       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912661762513       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912660515539       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912661708406       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912661419877       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912661916340       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912660540635       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912660402537       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912661183648       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912661468956       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912661841154       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912661855286       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912662697259       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912661706016       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912661384369       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912661245281       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912660959066       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912662188918       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912661439523       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912661177342       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912660971945       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912660696101       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912661559931       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912661111592       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912660940708       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.6380e+08 is 1.164406e-12

solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912661361972       residual = 6.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912661361972       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912661361972       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912661361972       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912661362102       residual = 7.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912661362389       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912662588673       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912662173686       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912659174699       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912662587460       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912660842431       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912662914750       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912662275870       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912659996060       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912661249348       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912660392674       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912660555876       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912660468897       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912657641977       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912674416901       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912661143771       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912657312824       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912659161389       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912661929613       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912660990428       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912659734022       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912661288982       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912661293442       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912659638107       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912656129867       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912660964768       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912661310712       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912660836733       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912664469390       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912665096909       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912662024643       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912658135948       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912661721510       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4552e+09 is 2.909043e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.605726 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8660e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2269
    reference variance = 0.259723
====================================================
  Execution time = 3.7661e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9536e-01
  Total weights = 1.9738e+06
  Execution time = 3.1418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288585061424
                                         uncertainty =       0.001646345015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288585061424
                                         uncertainty =       0.001646345015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379797429
  error estimate for blocks of size 2^( 2) =       0.000394705059
  error estimate for blocks of size 2^( 3) =       0.000408768687
  error estimate for blocks of size 2^( 4) =       0.000419327072
  error estimate for blocks of size 2^( 5) =       0.000426008717
  error estimate for blocks of size 2^( 6) =       0.000429812543
  error estimate for blocks of size 2^( 7) =       0.000431074090

      target function =      -0.919966351053
              le_mean =     -17.206770858149
             les_mean =     296.368323306938
             stat err =       0.000426555605
             autocorr =       1.261383846547
   target nu stat err =       0.000426555605
   target dn stat err =       0.002802611803
      target stat err =       0.004457776257
              std dev =       0.537114675605
             le_variance =       0.288492174751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288585061424
                                         uncertainty =       0.001646345016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288585061424
                                         uncertainty =       0.001646345016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379797429
  error estimate for blocks of size 2^( 2) =       0.000394705059
  error estimate for blocks of size 2^( 3) =       0.000408768687
  error estimate for blocks of size 2^( 4) =       0.000419327072
  error estimate for blocks of size 2^( 5) =       0.000426008717
  error estimate for blocks of size 2^( 6) =       0.000429812543
  error estimate for blocks of size 2^( 7) =       0.000431074090

      target function =      -0.919966351047
              le_mean =     -17.206770858149
             les_mean =     296.368323306941
             stat err =       0.000426555605
             autocorr =       1.261383846551
   target nu stat err =       0.000426555605
   target dn stat err =       0.002802611804
      target stat err =       0.004457776257
              std dev =       0.537114675605
             le_variance =       0.288492174751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288585061424
                                         uncertainty =       0.001646345015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288585061424
                                         uncertainty =       0.001646345015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379797429
  error estimate for blocks of size 2^( 2) =       0.000394705059
  error estimate for blocks of size 2^( 3) =       0.000408768687
  error estimate for blocks of size 2^( 4) =       0.000419327072
  error estimate for blocks of size 2^( 5) =       0.000426008717
  error estimate for blocks of size 2^( 6) =       0.000429812543
  error estimate for blocks of size 2^( 7) =       0.000431074090

      target function =      -0.919966351050
              le_mean =     -17.206770858149
             les_mean =     296.368323306939
             stat err =       0.000426555605
             autocorr =       1.261383846546
   target nu stat err =       0.000426555605
   target dn stat err =       0.002802611803
      target stat err =       0.004457776257
              std dev =       0.537114675605
             le_variance =       0.288492174751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288585061424
                                         uncertainty =       0.001646345015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288585061424
                                         uncertainty =       0.001646345015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379797429
  error estimate for blocks of size 2^( 2) =       0.000394705059
  error estimate for blocks of size 2^( 3) =       0.000408768687
  error estimate for blocks of size 2^( 4) =       0.000419327072
  error estimate for blocks of size 2^( 5) =       0.000426008717
  error estimate for blocks of size 2^( 6) =       0.000429812543
  error estimate for blocks of size 2^( 7) =       0.000431074090

      target function =      -0.919966351052
              le_mean =     -17.206770858149
             les_mean =     296.368323306938
             stat err =       0.000426555605
             autocorr =       1.261383846552
   target nu stat err =       0.000426555605
   target dn stat err =       0.002802611803
      target stat err =       0.004457776257
              std dev =       0.537114675605
             le_variance =       0.288492174751


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919966351053        initial  <--
     9.0949e+07     9.0949e+08             4.6586e-12        -0.919966351047
     3.6380e+08     3.6380e+09             1.1644e-12        -0.919966351050
     1.4552e+09     1.4552e+10             2.9090e-13        -0.919966351052

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.4852
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0215e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2063
    reference variance = 0.226
====================================================
  Execution time = 3.7794e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5424e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9992e-01
  Total weights = 1.973665062e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0740e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291912359706
                                         uncertainty =       0.002261888844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291912359706
                                         uncertainty =       0.002261888844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381995793
  error estimate for blocks of size 2^( 2) =       0.000396744157
  error estimate for blocks of size 2^( 3) =       0.000410198399
  error estimate for blocks of size 2^( 4) =       0.000420110975
  error estimate for blocks of size 2^( 5) =       0.000425599857
  error estimate for blocks of size 2^( 6) =       0.000428344904
  error estimate for blocks of size 2^( 7) =       0.000429081617

      target function =      -0.912861377696
              le_mean =     -17.206734643080
             les_mean =     296.371639257049
             stat err =       0.000425784338
             autocorr =       1.242402181112
   target nu stat err =       0.000425784338
   target dn stat err =       0.002939572436
      target stat err =       0.004598464887
              std dev =       0.540223631276
             le_variance =       0.291841571789


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720673464308e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+08, overlap shift 9.0949e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912883488791       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912883488791       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912883488791       residual = 7.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912883488791       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912883488791       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912883488791       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912883488791       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912883488791       residual = 9.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912883488791       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912884456986       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912883488791       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912883488791       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912883488791       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912883488791       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912882421974       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912884572388       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912883488791       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912882103875       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912883488791       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912882109999       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912886422158       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912882012439       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912882985131       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912879413173       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912882994239       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912884780783       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912885685353       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912884614314       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912885821570       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912881135293       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912878349385       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912886398032       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912887255933       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912882363747       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912885082676       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912883510046       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912885481357       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912882191795       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912882406513       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.0949e+08 is 4.715507e-13

solving harmonic davidson linear method for identity shift 3.6380e+09, overlap shift 3.6380e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912883488791       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912883488791       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912883488791       residual = 7.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912883839108       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912883488791       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912883488791       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912883488791       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912879817916       residual = 9.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912890572032       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912883488791       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912885743270       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912888667481       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912883488791       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912883488791       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912885497686       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912879350662       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912883488791       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912892517753       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912885938535       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912881213700       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912894459774       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912889960919       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912881062731       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912872601640       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912872004565       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912872694549       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912870754026       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912880043962       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912883982936       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912869848950       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912897080411       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912898544132       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912865986048       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912877352309       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912896511697       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912875140065       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912883877042       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912883542658       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912878178753       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912875785182       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.912888514053       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.912872255665       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.912874573942       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.912882499925       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.912892084651       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.912859816017       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.912931028599       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.912899476120       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.912903671908       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.912828788862       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.912901172349       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.912859110829       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.912888780656       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.912884576201       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.912912012627       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.912837872455       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.912930581269       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.912908532284       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.912930612126       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.912800373068       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.912811969129       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.912942006190       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.912984934264       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.912462312046       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.912804406038       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.913276045274       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.913048814479       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.912496810180       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.914792051693       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.912830853578       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.913021870732       residual = 8.37e-05           smallest_sin_value = 9.98e-01
davidson iteration   71 stopping due to small subspace S singular value of 9.48e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.6380e+09 is 1.175492e-13

solving harmonic davidson linear method for identity shift 1.4552e+10, overlap shift 1.4552e+11 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912883488791       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912883488791       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912883488791       residual = 7.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912883488791       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912883488791       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912883488791       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912883488791       residual = 9.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912880152660       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912895925537       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912883488791       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912883488791       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912883488791       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912883488791       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912883488791       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912909777497       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912886203946       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912826008575       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912905178073       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912886820097       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912892207193       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912901753880       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912910857612       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912895204513       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912907857206       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912827206199       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912874653458       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912876921700       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912892072062       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912942833077       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912882156014       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912874304693       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912814851806       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912917814399       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912841119340       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912849175618       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912953259737       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912843718272       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912881485988       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912852063595       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.913003840093       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.912911528627       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.912896660176       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.912846963878       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.912852359594       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.912977840082       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.912696769639       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.912747172963       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.912915918989       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.912401780851       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.913060328890       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.912795735467       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.912792872193       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.912971850968       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.912857821113       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.912743267673       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.913112445515       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.913104051640       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.912639665829       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.912805006468       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.913336329992       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.913167727648       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.912479295589       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.915014199672       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.912400131749       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.914494671988       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.915534178535       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.913239831788       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.927193646171       residual = 2.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.915127470990       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.909840885831       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.910543977907       residual = 3.53e-03           smallest_sin_value = 9.95e-01
davidson iteration   71 stopping due to small subspace S singular value of 8.19e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4552e+10 is 2.885257e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.885756 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8822e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.1381
    reference variance = 0.260524
====================================================
  Execution time = 3.8902e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0031e-01
  Total weights = 1.9738e+06
  Execution time = 3.1568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289982727414
                                         uncertainty =       0.002077045081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289982727414
                                         uncertainty =       0.002077045081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380788173
  error estimate for blocks of size 2^( 2) =       0.000395784623
  error estimate for blocks of size 2^( 3) =       0.000409851593
  error estimate for blocks of size 2^( 4) =       0.000420463916
  error estimate for blocks of size 2^( 5) =       0.000425236875
  error estimate for blocks of size 2^( 6) =       0.000427605311
  error estimate for blocks of size 2^( 7) =       0.000428954003

      target function =      -0.912258971308
              le_mean =     -17.206583365489
             les_mean =     296.366820541159
             stat err =       0.000425565026
             autocorr =       1.249007246724
   target nu stat err =       0.000425565026
   target dn stat err =       0.003443640050
      target stat err =       0.005360492567
              std dev =       0.538515798171
             le_variance =       0.289999264880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289982727414
                                         uncertainty =       0.002077045081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289982727414
                                         uncertainty =       0.002077045081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380788173
  error estimate for blocks of size 2^( 2) =       0.000395784623
  error estimate for blocks of size 2^( 3) =       0.000409851593
  error estimate for blocks of size 2^( 4) =       0.000420463916
  error estimate for blocks of size 2^( 5) =       0.000425236875
  error estimate for blocks of size 2^( 6) =       0.000427605311
  error estimate for blocks of size 2^( 7) =       0.000428954003

      target function =      -0.912258971309
              le_mean =     -17.206583365489
             les_mean =     296.366820541158
             stat err =       0.000425565026
             autocorr =       1.249007246721
   target nu stat err =       0.000425565026
   target dn stat err =       0.003443640050
      target stat err =       0.005360492567
              std dev =       0.538515798171
             le_variance =       0.289999264880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289982727414
                                         uncertainty =       0.002077045081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289982727414
                                         uncertainty =       0.002077045081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380788173
  error estimate for blocks of size 2^( 2) =       0.000395784623
  error estimate for blocks of size 2^( 3) =       0.000409851593
  error estimate for blocks of size 2^( 4) =       0.000420463916
  error estimate for blocks of size 2^( 5) =       0.000425236875
  error estimate for blocks of size 2^( 6) =       0.000427605311
  error estimate for blocks of size 2^( 7) =       0.000428954003

      target function =      -0.912258971309
              le_mean =     -17.206583365489
             les_mean =     296.366820541158
             stat err =       0.000425565026
             autocorr =       1.249007246723
   target nu stat err =       0.000425565026
   target dn stat err =       0.003443640050
      target stat err =       0.005360492567
              std dev =       0.538515798171
             le_variance =       0.289999264880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289982727414
                                         uncertainty =       0.002077045081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289982727414
                                         uncertainty =       0.002077045081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380788173
  error estimate for blocks of size 2^( 2) =       0.000395784623
  error estimate for blocks of size 2^( 3) =       0.000409851593
  error estimate for blocks of size 2^( 4) =       0.000420463916
  error estimate for blocks of size 2^( 5) =       0.000425236875
  error estimate for blocks of size 2^( 6) =       0.000427605311
  error estimate for blocks of size 2^( 7) =       0.000428954003

      target function =      -0.912258971308
              le_mean =     -17.206583365489
             les_mean =     296.366820541159
             stat err =       0.000425565026
             autocorr =       1.249007246721
   target nu stat err =       0.000425565026
   target dn stat err =       0.003443640050
      target stat err =       0.005360492567
              std dev =       0.538515798171
             le_variance =       0.289999264880


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912258971308        initial
     9.0949e+08     9.0949e+09             4.7155e-13        -0.912258971309  <--
     3.6380e+09     3.6380e+10             1.1755e-13        -0.912258971309
     1.4552e+10     1.4552e+11             2.8853e-14        -0.912258971308

*****************************************************************************
Applying the update for shift_i =   9.0949e+08     and shift_s =   9.0949e+09
*****************************************************************************

  Execution time = 5.4737e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0356e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2013
    reference variance = 0.374224
====================================================
  Execution time = 3.7821e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5416e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0028e-01
  Total weights = 1.973368423e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0701e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292075492683
                                         uncertainty =       0.002256446134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292075492683
                                         uncertainty =       0.002256446134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382129059
  error estimate for blocks of size 2^( 2) =       0.000396852807
  error estimate for blocks of size 2^( 3) =       0.000410404147
  error estimate for blocks of size 2^( 4) =       0.000420383561
  error estimate for blocks of size 2^( 5) =       0.000426962559
  error estimate for blocks of size 2^( 6) =       0.000429554378
  error estimate for blocks of size 2^( 7) =       0.000431050130

      target function =      -0.912310856384
              le_mean =     -17.207035676558
             les_mean =     296.382352188436
             stat err =       0.000426987657
             autocorr =       1.248563147285
   target nu stat err =       0.000426987657
   target dn stat err =       0.002715753636
      target stat err =       0.004254927338
              std dev =       0.540412098128
             le_variance =       0.292045235804


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720703567656e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+08, overlap shift 2.2737e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912329855428       residual = 9.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912329855429       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912329855429       residual = 5.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912329804176       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912329854353       residual = 9.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912329813480       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912330017271       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912330037630       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912329740352       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912329025137       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912329375215       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912329766534       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912329998584       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912329840189       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912330243231       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912329987458       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912329261119       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912329581240       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912328966492       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912330562412       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912330437399       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912329902838       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912329861047       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912330265508       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912329014973       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912330150112       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912330251461       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912329706397       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912329421237       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912329954797       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912329754826       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912329315726       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912328859350       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912329555933       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912329786084       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912329691470       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912329249128       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912329807245       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2737e+08 is 1.867046e-12

solving harmonic davidson linear method for identity shift 9.0949e+08, overlap shift 9.0949e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912329855428       residual = 9.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912329855428       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912329855428       residual = 5.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912329855429       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912329855419       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912329872259       residual = 8.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912330387162       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912333173482       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912331568812       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912331142325       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912330229694       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912330683975       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912329010095       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912329603239       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912329810324       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912328887813       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912331621870       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912329874896       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912331219305       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912329608858       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912329946057       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912329681156       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912329604294       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912330226961       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912331180657       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912329282358       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912328851716       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912331867009       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912327887183       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912330762062       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912333739947       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912325952978       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912326981181       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912328008059       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912325442590       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912329158246       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912330762203       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912327281234       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912327923720       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.0949e+08 is 4.661613e-13

solving harmonic davidson linear method for identity shift 3.6380e+09, overlap shift 3.6380e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912329855428       residual = 9.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912329855428       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912329855428       residual = 5.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912329855428       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912329855305       residual = 9.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912330231095       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912326860036       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912332616715       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912325151261       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912321198856       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912327421290       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912329462251       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912337466371       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912333801565       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912328342764       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912349289056       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912324486985       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912339980609       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912326425112       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912316839884       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912325882389       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912328023424       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912318115951       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912327785046       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912326922487       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912338705359       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912331896041       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912326183185       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912329077284       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912314170927       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912335771788       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912334860337       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912320602281       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912336664156       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912331905312       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912338291005       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912325531118       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912311742785       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912315998968       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912324504310       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.912318200261       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.912328682115       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.6380e+09 is 1.160367e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.951209 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8595e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.236
    reference variance = 0.518646
====================================================
  Execution time = 3.7797e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9596e-01
  Total weights = 1.9737e+06
  Execution time = 3.1552e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288367781028
                                         uncertainty =       0.001632389774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288367781028
                                         uncertainty =       0.001632389774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379703451
  error estimate for blocks of size 2^( 2) =       0.000394815366
  error estimate for blocks of size 2^( 3) =       0.000408205256
  error estimate for blocks of size 2^( 4) =       0.000417790124
  error estimate for blocks of size 2^( 5) =       0.000423674469
  error estimate for blocks of size 2^( 6) =       0.000427675391
  error estimate for blocks of size 2^( 7) =       0.000430271788

      target function =      -0.919020573797
              le_mean =     -17.207395568205
             les_mean =     296.390425205551
             stat err =       0.000424852943
             autocorr =       1.251953428336
   target nu stat err =       0.000424852943
   target dn stat err =       0.002056194022
      target stat err =       0.003304221802
              std dev =       0.536981769811
             le_variance =       0.288349421110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288367781028
                                         uncertainty =       0.001632389774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288367781028
                                         uncertainty =       0.001632389774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379703451
  error estimate for blocks of size 2^( 2) =       0.000394815366
  error estimate for blocks of size 2^( 3) =       0.000408205256
  error estimate for blocks of size 2^( 4) =       0.000417790124
  error estimate for blocks of size 2^( 5) =       0.000423674469
  error estimate for blocks of size 2^( 6) =       0.000427675391
  error estimate for blocks of size 2^( 7) =       0.000430271788

      target function =      -0.919020573799
              le_mean =     -17.207395568205
             les_mean =     296.390425205550
             stat err =       0.000424852943
             autocorr =       1.251953428341
   target nu stat err =       0.000424852943
   target dn stat err =       0.002056194022
      target stat err =       0.003304221802
              std dev =       0.536981769811
             le_variance =       0.288349421110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288367781028
                                         uncertainty =       0.001632389774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288367781028
                                         uncertainty =       0.001632389774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379703451
  error estimate for blocks of size 2^( 2) =       0.000394815366
  error estimate for blocks of size 2^( 3) =       0.000408205256
  error estimate for blocks of size 2^( 4) =       0.000417790124
  error estimate for blocks of size 2^( 5) =       0.000423674469
  error estimate for blocks of size 2^( 6) =       0.000427675391
  error estimate for blocks of size 2^( 7) =       0.000430271788

      target function =      -0.919020573798
              le_mean =     -17.207395568205
             les_mean =     296.390425205551
             stat err =       0.000424852943
             autocorr =       1.251953428337
   target nu stat err =       0.000424852943
   target dn stat err =       0.002056194022
      target stat err =       0.003304221802
              std dev =       0.536981769811
             le_variance =       0.288349421110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288367781028
                                         uncertainty =       0.001632389774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288367781028
                                         uncertainty =       0.001632389774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379703451
  error estimate for blocks of size 2^( 2) =       0.000394815366
  error estimate for blocks of size 2^( 3) =       0.000408205256
  error estimate for blocks of size 2^( 4) =       0.000417790124
  error estimate for blocks of size 2^( 5) =       0.000423674469
  error estimate for blocks of size 2^( 6) =       0.000427675391
  error estimate for blocks of size 2^( 7) =       0.000430271788

      target function =      -0.919020573798
              le_mean =     -17.207395568205
             les_mean =     296.390425205551
             stat err =       0.000424852943
             autocorr =       1.251953428335
   target nu stat err =       0.000424852943
   target dn stat err =       0.002056194022
      target stat err =       0.003304221802
              std dev =       0.536981769811
             le_variance =       0.288349421109


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919020573797        initial
     2.2737e+08     2.2737e+09             1.8670e-12        -0.919020573799  <--
     9.0949e+08     9.0949e+09             4.6616e-13        -0.919020573798
     3.6380e+09     3.6380e+10             1.1604e-13        -0.919020573798

*****************************************************************************
Applying the update for shift_i =   2.2737e+08     and shift_s =   2.2737e+09
*****************************************************************************

  Execution time = 5.3710e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0231e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.1914
    reference variance = 0.171402
====================================================
  Execution time = 3.8190e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5406e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9976e-01
  Total weights = 1.973621309e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0844e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291812051227
                                         uncertainty =       0.001848601002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291812051227
                                         uncertainty =       0.001848601002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381919720
  error estimate for blocks of size 2^( 2) =       0.000396663223
  error estimate for blocks of size 2^( 3) =       0.000410488489
  error estimate for blocks of size 2^( 4) =       0.000419505672
  error estimate for blocks of size 2^( 5) =       0.000425934865
  error estimate for blocks of size 2^( 6) =       0.000427912519
  error estimate for blocks of size 2^( 7) =       0.000429766154

      target function =      -0.913099007229
              le_mean =     -17.207258903459
             les_mean =     296.389522016764
             stat err =       0.000425779802
             autocorr =       1.242870684645
   target nu stat err =       0.000425779802
   target dn stat err =       0.002553337558
      target stat err =       0.004016127157
              std dev =       0.540116048271
             le_variance =       0.291725345600


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720725890346e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+07, overlap shift 5.6843e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913115705559       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913115705560       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913115705560       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913115705560       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913115706241       residual = 9.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913115672219       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913115716866       residual = 9.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913115596784       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913115913741       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913115786599       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913115578340       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913115677053       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913115697012       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913115749142       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913115746816       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913115613279       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913115671382       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913115684723       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913115618788       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913115661029       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913115652021       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913115668312       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913115544423       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913115756985       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913115648974       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913115802707       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913115712612       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913115752262       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913115754472       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913115703331       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913115804354       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913115732325       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913115667942       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913115754348       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913115638283       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913115827885       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.6843e+07 is 8.448497e-12

solving harmonic davidson linear method for identity shift 2.2737e+08, overlap shift 2.2737e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913115705559       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913115705559       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913115705559       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913115651107       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913115705559       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913115469225       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913115533367       residual = 9.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913115963833       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913115335923       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913115498225       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913116174358       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913115357546       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913115884358       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913115880728       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913116451687       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913116350528       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913115635487       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913115284390       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913115272363       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913115502445       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913114681494       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913115953590       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913115664591       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913115154825       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913116554422       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913116762855       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913115707673       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913115409480       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913116302581       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913115640382       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913115613662       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913115686165       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913115163851       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913115805662       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913115473727       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913117108285       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913116751974       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913115363131       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2737e+08 is 2.133589e-12

solving harmonic davidson linear method for identity shift 9.0949e+08, overlap shift 9.0949e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913115705559       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913115705559       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913115705559       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913115705559       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913116012743       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913115900071       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913114059704       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913115393895       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913115437264       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913114169744       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913116345825       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913113589935       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913117600929       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913113272844       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913115204527       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913116508711       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913118722474       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913115552345       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913116744010       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913118217616       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913115931630       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913114463239       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913115760152       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913113196682       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913108218710       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913115731335       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913114864510       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913117735078       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913115221087       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913111659345       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913113960952       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913116114499       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913113089221       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913111941292       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913112664290       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913112719578       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913115896917       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913116741350       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.0949e+08 is 5.337224e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.006102 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9096e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2219
    reference variance = 0.626782
====================================================
  Execution time = 3.7953e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9546e-01
  Total weights = 1.9739e+06
  Execution time = 3.2212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288243750245
                                         uncertainty =       0.001945021475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288243750245
                                         uncertainty =       0.001945021475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379640970
  error estimate for blocks of size 2^( 2) =       0.000394554900
  error estimate for blocks of size 2^( 3) =       0.000408697265
  error estimate for blocks of size 2^( 4) =       0.000419409596
  error estimate for blocks of size 2^( 5) =       0.000426283285
  error estimate for blocks of size 2^( 6) =       0.000429834519
  error estimate for blocks of size 2^( 7) =       0.000430956271

      target function =      -0.919824759675
              le_mean =     -17.206383768351
             les_mean =     296.355098890401
             stat err =       0.000426620918
             autocorr =       1.262810377957
   target nu stat err =       0.000426620918
   target dn stat err =       0.002423877844
      target stat err =       0.003868686202
              std dev =       0.536893409019
             le_variance =       0.288254532648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288243750244
                                         uncertainty =       0.001945021475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288243750244
                                         uncertainty =       0.001945021475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379640970
  error estimate for blocks of size 2^( 2) =       0.000394554900
  error estimate for blocks of size 2^( 3) =       0.000408697265
  error estimate for blocks of size 2^( 4) =       0.000419409596
  error estimate for blocks of size 2^( 5) =       0.000426283285
  error estimate for blocks of size 2^( 6) =       0.000429834519
  error estimate for blocks of size 2^( 7) =       0.000430956271

      target function =      -0.919824759672
              le_mean =     -17.206383768351
             les_mean =     296.355098890404
             stat err =       0.000426620918
             autocorr =       1.262810377981
   target nu stat err =       0.000426620918
   target dn stat err =       0.002423877844
      target stat err =       0.003868686202
              std dev =       0.536893409018
             le_variance =       0.288254532647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288243750245
                                         uncertainty =       0.001945021475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288243750245
                                         uncertainty =       0.001945021475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379640970
  error estimate for blocks of size 2^( 2) =       0.000394554900
  error estimate for blocks of size 2^( 3) =       0.000408697265
  error estimate for blocks of size 2^( 4) =       0.000419409596
  error estimate for blocks of size 2^( 5) =       0.000426283285
  error estimate for blocks of size 2^( 6) =       0.000429834519
  error estimate for blocks of size 2^( 7) =       0.000430956271

      target function =      -0.919824759674
              le_mean =     -17.206383768351
             les_mean =     296.355098890402
             stat err =       0.000426620918
             autocorr =       1.262810377975
   target nu stat err =       0.000426620918
   target dn stat err =       0.002423877844
      target stat err =       0.003868686202
              std dev =       0.536893409018
             le_variance =       0.288254532647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288243750245
                                         uncertainty =       0.001945021475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288243750245
                                         uncertainty =       0.001945021475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379640970
  error estimate for blocks of size 2^( 2) =       0.000394554900
  error estimate for blocks of size 2^( 3) =       0.000408697265
  error estimate for blocks of size 2^( 4) =       0.000419409596
  error estimate for blocks of size 2^( 5) =       0.000426283285
  error estimate for blocks of size 2^( 6) =       0.000429834519
  error estimate for blocks of size 2^( 7) =       0.000430956271

      target function =      -0.919824759675
              le_mean =     -17.206383768351
             les_mean =     296.355098890401
             stat err =       0.000426620918
             autocorr =       1.262810377968
   target nu stat err =       0.000426620918
   target dn stat err =       0.002423877844
      target stat err =       0.003868686202
              std dev =       0.536893409019
             le_variance =       0.288254532648


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919824759675        initial  <--
     5.6843e+07     5.6843e+08             8.4485e-12        -0.919824759672
     2.2737e+08     2.2737e+09             2.1336e-12        -0.919824759674
     9.0949e+08     9.0949e+09             5.3372e-13        -0.919824759675

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.2159
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0332e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1861
    reference variance = 0.217891
====================================================
  Execution time = 3.8494e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5406e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0216e-01
  Total weights = 1.973822629e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0990e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292159831995
                                         uncertainty =       0.002490805815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292159831995
                                         uncertainty =       0.002490805815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382159841
  error estimate for blocks of size 2^( 2) =       0.000397148884
  error estimate for blocks of size 2^( 3) =       0.000410803777
  error estimate for blocks of size 2^( 4) =       0.000420488983
  error estimate for blocks of size 2^( 5) =       0.000426215924
  error estimate for blocks of size 2^( 6) =       0.000429514078
  error estimate for blocks of size 2^( 7) =       0.000429077911

      target function =      -0.909399693968
              le_mean =     -17.206263008203
             les_mean =     296.357649963898
             stat err =       0.000426324224
             autocorr =       1.244485742579
   target nu stat err =       0.000426324224
   target dn stat err =       0.004378617283
      target stat err =       0.006746438060
              std dev =       0.540455630212
             le_variance =       0.292092288228


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720626300820e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+08, overlap shift 5.6843e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909448729469       residual = 8.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909448729469       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909448729469       residual = 5.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909448729469       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909448728653       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909448903358       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909447902195       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909448074707       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909449160364       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909449841025       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909448944944       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909448598011       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909448928849       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909449280394       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909449263102       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.909449227444       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909448805786       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909449210163       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909447425262       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909448087597       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909448376563       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909448688478       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909449243574       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909447694597       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909448020497       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909449400053       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909447566285       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909449590083       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909449216772       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909451953874       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909445121399       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909448159945       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909447717503       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909447602344       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909450107155       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909448309650       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.6843e+08 is 7.862639e-13

solving harmonic davidson linear method for identity shift 2.2737e+09, overlap shift 2.2737e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909448729469       residual = 8.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909448729469       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909448729469       residual = 5.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909448729469       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909448729469       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909447692528       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909450762903       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909447031606       residual = 7.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909445745703       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909446144963       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909446830305       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909444939609       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909452709164       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909447987767       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909449567366       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.909447272791       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909446214935       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909446802631       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909444471375       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909448111733       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909442473763       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909454705113       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909449491464       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909445974508       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909446198194       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909449025210       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909448176528       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909450668391       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909456130644       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909448732378       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909441891162       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909451231639       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909449511691       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909446438017       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909440488350       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909446423864       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2737e+09 is 1.963167e-13

solving harmonic davidson linear method for identity shift 9.0949e+09, overlap shift 9.0949e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909448729469       residual = 8.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909448729469       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909448729469       residual = 5.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909448729469       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909448729362       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909448744697       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909450756529       residual = 7.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909451406363       residual = 7.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909458449638       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909455267508       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909490633350       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909448401584       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909459749034       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909467112039       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909444581726       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.909471826431       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909457667292       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909422130958       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909438220791       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909326741987       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909455277658       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909442059512       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909439492351       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909449470929       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909458076557       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909473308214       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909474601959       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909414347039       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909463755743       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909382748435       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909466944079       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909441285432       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909468624812       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909465505376       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909460532862       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909415237305       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909491366009       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.909382302051       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.909495093285       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.909456380552       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.909293938917       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.909430392801       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.909417908673       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.909433344109       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.909326260624       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.909509406486       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.909422782101       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.909534506279       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.909295345111       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.909370170168       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.909461121155       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.909570309985       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.909349634098       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.909173223314       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.909191642069       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.909432438798       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.909792499524       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.909447970064       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.909523076031       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.909501909516       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.909504856062       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.909572852441       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.910000560676       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.907392514320       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.909243581148       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.909618815511       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.909717452740       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.909725734731       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.908990741874       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.909930669193       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.906997457983       residual = 8.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   71 stopping due to small subspace S singular value of 9.70e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.0949e+09 is 4.885057e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.165850 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1808e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2179
    reference variance = 0.164096
====================================================
  Execution time = 3.8033e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9761e-01
  Total weights = 1.9738e+06
  Execution time = 3.2414e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288131977380
                                         uncertainty =       0.002032518416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288131977380
                                         uncertainty =       0.002032518416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379518551
  error estimate for blocks of size 2^( 2) =       0.000394374304
  error estimate for blocks of size 2^( 3) =       0.000407967661
  error estimate for blocks of size 2^( 4) =       0.000417479011
  error estimate for blocks of size 2^( 5) =       0.000422926936
  error estimate for blocks of size 2^( 6) =       0.000425721047
  error estimate for blocks of size 2^( 7) =       0.000427245037

      target function =      -0.916438706893
              le_mean =     -17.206579705562
             les_mean =     296.363997214274
             stat err =       0.000423343008
             autocorr =       1.244281842894
   target nu stat err =       0.000423343008
   target dn stat err =       0.003439094593
      target stat err =       0.005401730817
              std dev =       0.536720281991
             le_variance =       0.288068661100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288131977380
                                         uncertainty =       0.002032518416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288131977380
                                         uncertainty =       0.002032518416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379518551
  error estimate for blocks of size 2^( 2) =       0.000394374304
  error estimate for blocks of size 2^( 3) =       0.000407967661
  error estimate for blocks of size 2^( 4) =       0.000417479011
  error estimate for blocks of size 2^( 5) =       0.000422926936
  error estimate for blocks of size 2^( 6) =       0.000425721047
  error estimate for blocks of size 2^( 7) =       0.000427245037

      target function =      -0.916438706894
              le_mean =     -17.206579705562
             les_mean =     296.363997214273
             stat err =       0.000423343008
             autocorr =       1.244281842903
   target nu stat err =       0.000423343008
   target dn stat err =       0.003439094593
      target stat err =       0.005401730817
              std dev =       0.536720281991
             le_variance =       0.288068661100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288131977380
                                         uncertainty =       0.002032518416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288131977380
                                         uncertainty =       0.002032518416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379518551
  error estimate for blocks of size 2^( 2) =       0.000394374304
  error estimate for blocks of size 2^( 3) =       0.000407967661
  error estimate for blocks of size 2^( 4) =       0.000417479011
  error estimate for blocks of size 2^( 5) =       0.000422926936
  error estimate for blocks of size 2^( 6) =       0.000425721047
  error estimate for blocks of size 2^( 7) =       0.000427245037

      target function =      -0.916438706894
              le_mean =     -17.206579705562
             les_mean =     296.363997214273
             stat err =       0.000423343008
             autocorr =       1.244281842905
   target nu stat err =       0.000423343008
   target dn stat err =       0.003439094593
      target stat err =       0.005401730817
              std dev =       0.536720281991
             le_variance =       0.288068661100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288131977380
                                         uncertainty =       0.002032518416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288131977380
                                         uncertainty =       0.002032518416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379518551
  error estimate for blocks of size 2^( 2) =       0.000394374304
  error estimate for blocks of size 2^( 3) =       0.000407967661
  error estimate for blocks of size 2^( 4) =       0.000417479011
  error estimate for blocks of size 2^( 5) =       0.000422926936
  error estimate for blocks of size 2^( 6) =       0.000425721047
  error estimate for blocks of size 2^( 7) =       0.000427245037

      target function =      -0.916438706893
              le_mean =     -17.206579705562
             les_mean =     296.363997214274
             stat err =       0.000423343008
             autocorr =       1.244281842903
   target nu stat err =       0.000423343008
   target dn stat err =       0.003439094593
      target stat err =       0.005401730817
              std dev =       0.536720281991
             le_variance =       0.288068661100


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916438706893        initial
     5.6843e+08     5.6843e+09             7.8626e-13        -0.916438706894  <--
     2.2737e+09     2.2737e+10             1.9632e-13        -0.916438706894
     9.0949e+09     9.0949e+10             4.8851e-14        -0.916438706893

*****************************************************************************
Applying the update for shift_i =   5.6843e+08     and shift_s =   5.6843e+09
*****************************************************************************

  Execution time = 5.4376e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0619e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2388
    reference variance = 0.237389
====================================================
  Execution time = 3.8127e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5414e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 2.9711e-01
  Total weights = 1.973817531e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0814e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290728280610
                                         uncertainty =       0.001700371657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290728280610
                                         uncertainty =       0.001700371657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381267430
  error estimate for blocks of size 2^( 2) =       0.000396266210
  error estimate for blocks of size 2^( 3) =       0.000409744836
  error estimate for blocks of size 2^( 4) =       0.000419201929
  error estimate for blocks of size 2^( 5) =       0.000423854478
  error estimate for blocks of size 2^( 6) =       0.000427088866
  error estimate for blocks of size 2^( 7) =       0.000428291356

      target function =      -0.917227671308
              le_mean =     -17.207593950345
             les_mean =     296.398395195542
             stat err =       0.000424609157
             autocorr =       1.240278733076
   target nu stat err =       0.000424609157
   target dn stat err =       0.002142067224
      target stat err =       0.003423785920
              std dev =       0.539193570950
             le_variance =       0.290729706953


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720759395035e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+08, overlap shift 1.4211e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917239473462       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917239473462       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917239473462       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917239465582       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917239473462       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917239473462       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917239374656       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917239415559       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917239240756       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917239599102       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917239473462       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917239521480       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917239968659       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917239394935       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917239553010       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917239036241       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917239816412       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917238979806       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917239320544       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917239447214       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917239656793       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917239074135       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917239594536       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917238892656       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917239382862       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917239695666       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917239388788       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917239408327       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917239341044       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917239344450       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917239685419       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917239185539       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917239854278       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917239559743       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917239435137       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917239751000       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917239406002       residual = 8.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4211e+08 is 3.216728e-12

solving harmonic davidson linear method for identity shift 5.6843e+08, overlap shift 5.6843e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917239473462       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917239473462       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917239473462       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917239417929       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917239854554       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917239473462       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917240628515       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917239473462       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917239479653       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917240107736       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917239757366       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917241103814       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917239963695       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917239404054       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917239416282       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917239473462       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917239824909       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917238789710       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917239091405       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917238814475       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917236703678       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917239174828       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917238324263       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917237961988       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917238791221       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917240307837       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917239017009       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917236695587       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917239443382       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917240600087       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917238009012       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917235489149       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917243542759       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917238133331       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917238479687       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917238225708       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917239951939       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.6843e+08 is 8.048867e-13

solving harmonic davidson linear method for identity shift 2.2737e+09, overlap shift 2.2737e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917239473462       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917239473462       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917239473462       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917239473462       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917237881984       residual = 9.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917238796549       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917239473462       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917239473462       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917237833273       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917247037441       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917243440820       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917240725700       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917236915956       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917235300045       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917234020083       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917239178764       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917243063709       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917236019276       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917238510573       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917238038119       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917236874939       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917227375016       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917229481931       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917247544075       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917245129530       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917230576665       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917245544532       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917218154253       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917232983367       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917237852743       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917236321605       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917240358091       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917244318830       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917242951478       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917241370672       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917238868575       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917237183318       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917229368246       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917234661229       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917234946367       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.917239077400       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2737e+09 is 2.022626e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.225085 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9007e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.235
    reference variance = 0.239544
====================================================
  Execution time = 3.7628e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0121e-01
  Total weights = 1.9739e+06
  Execution time = 3.1891e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291981277867
                                         uncertainty =       0.001558660330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291981277867
                                         uncertainty =       0.001558660330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382044282
  error estimate for blocks of size 2^( 2) =       0.000397100327
  error estimate for blocks of size 2^( 3) =       0.000411215265
  error estimate for blocks of size 2^( 4) =       0.000420313219
  error estimate for blocks of size 2^( 5) =       0.000426117869
  error estimate for blocks of size 2^( 6) =       0.000430712225
  error estimate for blocks of size 2^( 7) =       0.000433361263

      target function =      -0.910886054850
              le_mean =     -17.206698046270
             les_mean =     296.371664306512
             stat err =       0.000427626144
             autocorr =       1.252855808424
   target nu stat err =       0.000427626144
   target dn stat err =       0.002675588953
      target stat err =       0.004178498420
              std dev =       0.540292204567
             le_variance =       0.291915666316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291981277866
                                         uncertainty =       0.001558660330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291981277866
                                         uncertainty =       0.001558660330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382044282
  error estimate for blocks of size 2^( 2) =       0.000397100327
  error estimate for blocks of size 2^( 3) =       0.000411215265
  error estimate for blocks of size 2^( 4) =       0.000420313219
  error estimate for blocks of size 2^( 5) =       0.000426117869
  error estimate for blocks of size 2^( 6) =       0.000430712225
  error estimate for blocks of size 2^( 7) =       0.000433361263

      target function =      -0.910886054851
              le_mean =     -17.206698046270
             les_mean =     296.371664306512
             stat err =       0.000427626144
             autocorr =       1.252855808427
   target nu stat err =       0.000427626144
   target dn stat err =       0.002675588953
      target stat err =       0.004178498420
              std dev =       0.540292204566
             le_variance =       0.291915666315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291981277866
                                         uncertainty =       0.001558660330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291981277866
                                         uncertainty =       0.001558660330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382044282
  error estimate for blocks of size 2^( 2) =       0.000397100327
  error estimate for blocks of size 2^( 3) =       0.000411215265
  error estimate for blocks of size 2^( 4) =       0.000420313219
  error estimate for blocks of size 2^( 5) =       0.000426117869
  error estimate for blocks of size 2^( 6) =       0.000430712225
  error estimate for blocks of size 2^( 7) =       0.000433361263

      target function =      -0.910886054851
              le_mean =     -17.206698046270
             les_mean =     296.371664306512
             stat err =       0.000427626144
             autocorr =       1.252855808426
   target nu stat err =       0.000427626144
   target dn stat err =       0.002675588953
      target stat err =       0.004178498420
              std dev =       0.540292204566
             le_variance =       0.291915666315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291981277866
                                         uncertainty =       0.001558660330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291981277866
                                         uncertainty =       0.001558660330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382044282
  error estimate for blocks of size 2^( 2) =       0.000397100327
  error estimate for blocks of size 2^( 3) =       0.000411215265
  error estimate for blocks of size 2^( 4) =       0.000420313219
  error estimate for blocks of size 2^( 5) =       0.000426117869
  error estimate for blocks of size 2^( 6) =       0.000430712225
  error estimate for blocks of size 2^( 7) =       0.000433361263

      target function =      -0.910886054850
              le_mean =     -17.206698046270
             les_mean =     296.371664306512
             stat err =       0.000427626144
             autocorr =       1.252855808423
   target nu stat err =       0.000427626144
   target dn stat err =       0.002675588953
      target stat err =       0.004178498420
              std dev =       0.540292204567
             le_variance =       0.291915666315


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910886054850        initial
     1.4211e+08     1.4211e+09             3.2167e-12        -0.910886054851  <--
     5.6843e+08     5.6843e+09             8.0489e-13        -0.910886054851
     2.2737e+09     2.2737e+10             2.0226e-13        -0.910886054850

*****************************************************************************
Applying the update for shift_i =   1.4211e+08     and shift_s =   1.4211e+09
*****************************************************************************

  Execution time = 5.3999e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0301e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2002
    reference variance = 0.322642
====================================================
  Execution time = 3.8362e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5406e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0099e-01
  Total weights = 1.973460722e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0855e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293466958620
                                         uncertainty =       0.002636881505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293466958620
                                         uncertainty =       0.002636881505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383062983
  error estimate for blocks of size 2^( 2) =       0.000397706643
  error estimate for blocks of size 2^( 3) =       0.000410953044
  error estimate for blocks of size 2^( 4) =       0.000420752102
  error estimate for blocks of size 2^( 5) =       0.000426553185
  error estimate for blocks of size 2^( 6) =       0.000427844229
  error estimate for blocks of size 2^( 7) =       0.000428574390

      target function =      -0.911208479288
              le_mean =     -17.206833528360
             les_mean =     296.376109154850
             stat err =       0.000425930977
             autocorr =       1.236340451520
   target nu stat err =       0.000425930977
   target dn stat err =       0.003247949691
      target stat err =       0.005052402271
              std dev =       0.541732866000
             le_variance =       0.293474498104


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720683352836e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911235196024       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911235196026       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911235196026       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911235175110       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911235193596       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911235196026       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911235165283       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911235253077       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911235130596       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911235173903       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911235175814       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911235213582       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911235229892       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911235094416       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911235280159       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911235221251       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911235257996       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911235044798       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911235253354       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911235118286       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911234956233       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911235180139       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911235153946       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911235098138       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911235201259       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911235178569       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911235252835       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911235179972       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911235287002       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911235118300       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911235218063       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911235137214       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911235099357       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911235105091       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911235104749       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911235082830       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.5527e+07 is 1.335792e-11

solving harmonic davidson linear method for identity shift 1.4211e+08, overlap shift 1.4211e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911235196024       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911235196024       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911235196024       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911235196025       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911235194809       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911235278989       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911235187324       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911235237359       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911235187879       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911234982532       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911235326647       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911235204233       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911234985389       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911234875863       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911235326414       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911235225054       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911234946809       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911235174039       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911235249111       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911235207754       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911235503951       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911234956444       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911235258249       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911235271128       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911235144643       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911235644190       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911235199157       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911235494392       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911235316990       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911235221432       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911235273205       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911235431598       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911234844046       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911235692139       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911235031183       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911235388962       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4211e+08 is 3.339639e-12

solving harmonic davidson linear method for identity shift 5.6843e+08, overlap shift 5.6843e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911235196024       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911235196024       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911235196024       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911235196023       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911235195926       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911234977045       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911234852217       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911234235370       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911234909877       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911233822516       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911235327603       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911235823513       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911234560576       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911235832222       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911235928773       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911234462421       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911234763213       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911234737211       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911235657819       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911235062564       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911236839772       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911234235660       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911233772207       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911234474749       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911235238575       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911235062290       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911234363478       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911233940481       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911236119339       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911237634938       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911234771731       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911232703820       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911236841024       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911233399200       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911234314550       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911234956639       residual = 8.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.6843e+08 is 8.350397e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.274885 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9274e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.1968
    reference variance = 0.378673
====================================================
  Execution time = 3.8157e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9738e-01
  Total weights = 1.9739e+06
  Execution time = 3.1463e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291630251655
                                         uncertainty =       0.001711049716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291630251655
                                         uncertainty =       0.001711049716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381830645
  error estimate for blocks of size 2^( 2) =       0.000396670868
  error estimate for blocks of size 2^( 3) =       0.000410150991
  error estimate for blocks of size 2^( 4) =       0.000420208901
  error estimate for blocks of size 2^( 5) =       0.000424869195
  error estimate for blocks of size 2^( 6) =       0.000427579822
  error estimate for blocks of size 2^( 7) =       0.000430533267

      target function =      -0.916825976922
              le_mean =     -17.206315894209
             les_mean =     296.354685320424
             stat err =       0.000425797796
             autocorr =       1.243555740222
   target nu stat err =       0.000425797796
   target dn stat err =       0.002155058942
      target stat err =       0.003432956930
              std dev =       0.539990076851
             le_variance =       0.291589283097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291630251654
                                         uncertainty =       0.001711049716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291630251654
                                         uncertainty =       0.001711049716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381830645
  error estimate for blocks of size 2^( 2) =       0.000396670868
  error estimate for blocks of size 2^( 3) =       0.000410150991
  error estimate for blocks of size 2^( 4) =       0.000420208901
  error estimate for blocks of size 2^( 5) =       0.000424869195
  error estimate for blocks of size 2^( 6) =       0.000427579822
  error estimate for blocks of size 2^( 7) =       0.000430533267

      target function =      -0.916825976925
              le_mean =     -17.206315894209
             les_mean =     296.354685320421
             stat err =       0.000425797796
             autocorr =       1.243555740232
   target nu stat err =       0.000425797796
   target dn stat err =       0.002155058942
      target stat err =       0.003432956930
              std dev =       0.539990076850
             le_variance =       0.291589283097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291630251654
                                         uncertainty =       0.001711049716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291630251654
                                         uncertainty =       0.001711049716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381830645
  error estimate for blocks of size 2^( 2) =       0.000396670868
  error estimate for blocks of size 2^( 3) =       0.000410150991
  error estimate for blocks of size 2^( 4) =       0.000420208901
  error estimate for blocks of size 2^( 5) =       0.000424869195
  error estimate for blocks of size 2^( 6) =       0.000427579822
  error estimate for blocks of size 2^( 7) =       0.000430533267

      target function =      -0.916825976924
              le_mean =     -17.206315894209
             les_mean =     296.354685320423
             stat err =       0.000425797796
             autocorr =       1.243555740226
   target nu stat err =       0.000425797796
   target dn stat err =       0.002155058942
      target stat err =       0.003432956930
              std dev =       0.539990076851
             le_variance =       0.291589283097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291630251655
                                         uncertainty =       0.001711049716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291630251655
                                         uncertainty =       0.001711049716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381830645
  error estimate for blocks of size 2^( 2) =       0.000396670868
  error estimate for blocks of size 2^( 3) =       0.000410150991
  error estimate for blocks of size 2^( 4) =       0.000420208901
  error estimate for blocks of size 2^( 5) =       0.000424869195
  error estimate for blocks of size 2^( 6) =       0.000427579822
  error estimate for blocks of size 2^( 7) =       0.000430533267

      target function =      -0.916825976922
              le_mean =     -17.206315894209
             les_mean =     296.354685320424
             stat err =       0.000425797796
             autocorr =       1.243555740222
   target nu stat err =       0.000425797796
   target dn stat err =       0.002155058942
      target stat err =       0.003432956930
              std dev =       0.539990076851
             le_variance =       0.291589283097


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916825976922        initial
     3.5527e+07     3.5527e+08             1.3358e-11        -0.916825976925  <--
     1.4211e+08     1.4211e+09             3.3396e-12        -0.916825976924
     5.6843e+08     5.6843e+09             8.3504e-13        -0.916825976922

*****************************************************************************
Applying the update for shift_i =   3.5527e+07     and shift_s =   3.5527e+08
*****************************************************************************

  Execution time = 5.3994e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0328e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2588
    reference variance = 0.356327
====================================================
  Execution time = 3.9450e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5413e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9835e-01
  Total weights = 1.973857634e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0907e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291673732752
                                         uncertainty =       0.002527351629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291673732752
                                         uncertainty =       0.002527351629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381908348
  error estimate for blocks of size 2^( 2) =       0.000396942415
  error estimate for blocks of size 2^( 3) =       0.000410767644
  error estimate for blocks of size 2^( 4) =       0.000420746117
  error estimate for blocks of size 2^( 5) =       0.000425779109
  error estimate for blocks of size 2^( 6) =       0.000429396627
  error estimate for blocks of size 2^( 7) =       0.000428619801

      target function =      -0.915285761945
              le_mean =     -17.207486379315
             les_mean =     296.395936446417
             stat err =       0.000426135413
             autocorr =       1.245021784847
   target nu stat err =       0.000426135413
   target dn stat err =       0.002644054263
      target stat err =       0.004175780435
              std dev =       0.540099965691
             le_variance =       0.291707972939


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720748637931e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+06, overlap shift 8.8818e+07 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915303708193       residual = 8.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915303708197       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915303708198       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915303708198       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915303708352       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915303702054       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915303698629       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915303704108       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915303729204       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915303705613       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915303715470       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915303710768       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915303693644       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915303711139       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915303700959       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915303717288       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915303718078       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915303705508       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915303718436       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915303727066       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915303715254       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915303708570       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915303707757       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915303713863       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915303715071       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915303709317       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915303693408       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915303698189       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915303680777       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915303683090       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915303713945       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915303737138       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915303694906       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915303724042       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915303710338       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915303690448       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.8818e+06 is 3.739518e-11

solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915303708193       residual = 8.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915303708194       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915303708194       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915303708194       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915303707887       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915303688063       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915303737993       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915303716927       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915303698962       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915303681046       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915303655532       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915303550197       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915303670557       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915303744908       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915303771608       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915303769113       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915303721866       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915303733623       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915303716579       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915303671057       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915303746437       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915303809803       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915303713993       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915303710104       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915303721385       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915303805227       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915303662450       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915303714690       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915303624045       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915303635079       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915303638371       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915303584271       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915303712450       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915303655090       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915303696464       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915303679526       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.5527e+07 is 9.349055e-12

solving harmonic davidson linear method for identity shift 1.4211e+08, overlap shift 1.4211e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915303708193       residual = 8.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915303708193       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915303708193       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915303708193       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915303708193       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915303682739       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915303768229       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915303770436       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915303474174       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915304143960       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915303737919       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915303923616       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915303864762       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915303788830       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915303470430       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915304010844       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915303840505       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915303462464       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915303798193       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915304075452       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915303681743       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915303628062       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915303399806       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915303399522       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915303645987       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915304147862       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915303671306       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915303965390       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915303867596       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915303559710       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915304189663       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915304111394       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915303464687       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915302954749       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915303930565       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915303556094       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4211e+08 is 2.337392e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.324494 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0414e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2226
    reference variance = 0.312562
====================================================
  Execution time = 3.7802e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9521e-01
  Total weights = 1.9740e+06
  Execution time = 3.1420e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287613759872
                                         uncertainty =       0.001793084222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287613759872
                                         uncertainty =       0.001793084222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379197781
  error estimate for blocks of size 2^( 2) =       0.000393956176
  error estimate for blocks of size 2^( 3) =       0.000407513804
  error estimate for blocks of size 2^( 4) =       0.000418066140
  error estimate for blocks of size 2^( 5) =       0.000423077980
  error estimate for blocks of size 2^( 6) =       0.000425748119
  error estimate for blocks of size 2^( 7) =       0.000426031736

      target function =      -0.920205872673
              le_mean =     -17.207039550122
             les_mean =     296.377419141519
             stat err =       0.000423230994
             autocorr =       1.245728366934
   target nu stat err =       0.000423230994
   target dn stat err =       0.002330338565
      target stat err =       0.003731199665
              std dev =       0.536266644527
             le_variance =       0.287581914032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287613759871
                                         uncertainty =       0.001793084222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287613759871
                                         uncertainty =       0.001793084222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379197781
  error estimate for blocks of size 2^( 2) =       0.000393956176
  error estimate for blocks of size 2^( 3) =       0.000407513804
  error estimate for blocks of size 2^( 4) =       0.000418066140
  error estimate for blocks of size 2^( 5) =       0.000423077980
  error estimate for blocks of size 2^( 6) =       0.000425748119
  error estimate for blocks of size 2^( 7) =       0.000426031736

      target function =      -0.920205872672
              le_mean =     -17.207039550122
             les_mean =     296.377419141529
             stat err =       0.000423230994
             autocorr =       1.245728366996
   target nu stat err =       0.000423230994
   target dn stat err =       0.002330338566
      target stat err =       0.003731199666
              std dev =       0.536266644525
             le_variance =       0.287581914030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287613759871
                                         uncertainty =       0.001793084222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287613759871
                                         uncertainty =       0.001793084222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379197781
  error estimate for blocks of size 2^( 2) =       0.000393956176
  error estimate for blocks of size 2^( 3) =       0.000407513804
  error estimate for blocks of size 2^( 4) =       0.000418066140
  error estimate for blocks of size 2^( 5) =       0.000423077980
  error estimate for blocks of size 2^( 6) =       0.000425748119
  error estimate for blocks of size 2^( 7) =       0.000426031736

      target function =      -0.920205872672
              le_mean =     -17.207039550122
             les_mean =     296.377419141524
             stat err =       0.000423230994
             autocorr =       1.245728366959
   target nu stat err =       0.000423230994
   target dn stat err =       0.002330338565
      target stat err =       0.003731199665
              std dev =       0.536266644526
             le_variance =       0.287581914031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287613759872
                                         uncertainty =       0.001793084222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287613759872
                                         uncertainty =       0.001793084222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379197781
  error estimate for blocks of size 2^( 2) =       0.000393956176
  error estimate for blocks of size 2^( 3) =       0.000407513804
  error estimate for blocks of size 2^( 4) =       0.000418066140
  error estimate for blocks of size 2^( 5) =       0.000423077980
  error estimate for blocks of size 2^( 6) =       0.000425748119
  error estimate for blocks of size 2^( 7) =       0.000426031736

      target function =      -0.920205872673
              le_mean =     -17.207039550122
             les_mean =     296.377419141519
             stat err =       0.000423230994
             autocorr =       1.245728366941
   target nu stat err =       0.000423230994
   target dn stat err =       0.002330338565
      target stat err =       0.003731199665
              std dev =       0.536266644527
             le_variance =       0.287581914032


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920205872673        initial  <--
     8.8818e+06     8.8818e+07             3.7395e-11        -0.920205872672
     3.5527e+07     3.5527e+08             9.3491e-12        -0.920205872672
     1.4211e+08     1.4211e+09             2.3374e-12        -0.920205872673

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.6045
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0402e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2441
    reference variance = 0.162971
====================================================
  Execution time = 3.8116e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5428e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9766e-01
  Total weights = 1.973675079e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0799e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290580371231
                                         uncertainty =       0.002504611438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290580371231
                                         uncertainty =       0.002504611438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381187272
  error estimate for blocks of size 2^( 2) =       0.000395957995
  error estimate for blocks of size 2^( 3) =       0.000409678114
  error estimate for blocks of size 2^( 4) =       0.000419728526
  error estimate for blocks of size 2^( 5) =       0.000425228658
  error estimate for blocks of size 2^( 6) =       0.000428737432
  error estimate for blocks of size 2^( 7) =       0.000431367476

      target function =      -0.916356364315
              le_mean =     -17.207091959543
             les_mean =     296.381675518196
             stat err =       0.000426265523
             autocorr =       1.250499823105
   target nu stat err =       0.000426265523
   target dn stat err =       0.003127779826
      target stat err =       0.004926344299
              std dev =       0.539080209254
             le_variance =       0.290607472009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720709195954e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+07, overlap shift 8.8818e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916382107871       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916382107871       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916382107871       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916382107871       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916382107482       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916382015512       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916382032263       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916382089894       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916382214256       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916382131717       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916382019196       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916382120146       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916382034000       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916382061299       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916382518874       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916382242030       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916382153140       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916381855094       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916382092763       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916382092988       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916381947785       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916382121256       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916382064078       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916382316565       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916382022513       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916381862314       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916382274683       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916382216952       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916381836065       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916382211875       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916382284357       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916381921046       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916381890966       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916382239169       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916381846505       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916382334063       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916382017858       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916382023757       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.8818e+07 is 1.326211e-11

solving harmonic davidson linear method for identity shift 3.5527e+08, overlap shift 3.5527e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916382107871       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916382107871       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916382107871       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916382107871       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916382107878       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916382107662       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916382561306       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916381658224       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916381320069       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916381925171       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916382112975       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916381981074       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916382150563       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916381631548       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916381159609       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916382288569       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916382264871       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916381731335       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916379971884       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916382714033       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916382216910       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916382124320       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916380775748       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916380822496       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916383095910       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916382023673       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916382885922       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916382091699       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916382210659       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916381359045       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916382128706       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916381682286       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916382022129       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916382824100       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916382129599       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916380779948       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916381859447       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916381877074       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.5527e+08 is 3.315142e-12

solving harmonic davidson linear method for identity shift 1.4211e+09, overlap shift 1.4211e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916382107871       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916382107871       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916382107871       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916381812676       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916382107871       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916382100335       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916381690667       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916383453308       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916384555761       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916383605741       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916380844957       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916379777413       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916381803474       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916384621646       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916384515739       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916381606006       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916382984031       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916384525331       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916381746313       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916384168274       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916379729138       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916378714090       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916381284033       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916384568067       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916384508345       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916385398657       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916382040293       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916380064161       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916384766478       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916380273123       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916380131329       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916382057987       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916385083451       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916380886512       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916382715514       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916383816342       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916380501462       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916383071472       residual = 8.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4211e+09 is 8.291778e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.381720 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8984e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1702
    reference variance = 0.320701
====================================================
  Execution time = 3.7304e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9592e-01
  Total weights = 1.9737e+06
  Execution time = 3.1438e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288322859321
                                         uncertainty =       0.002148096532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288322859321
                                         uncertainty =       0.002148096532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379708708
  error estimate for blocks of size 2^( 2) =       0.000394416958
  error estimate for blocks of size 2^( 3) =       0.000407879743
  error estimate for blocks of size 2^( 4) =       0.000417939290
  error estimate for blocks of size 2^( 5) =       0.000424320404
  error estimate for blocks of size 2^( 6) =       0.000426995901
  error estimate for blocks of size 2^( 7) =       0.000429644387

      target function =      -0.919087450174
              le_mean =     -17.206410079752
             les_mean =     296.356466566618
             stat err =       0.000424724996
             autocorr =       1.251164828613
   target nu stat err =       0.000424724996
   target dn stat err =       0.003312483287
      target stat err =       0.005234969908
              std dev =       0.536989204166
             le_variance =       0.288357405391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288322859321
                                         uncertainty =       0.002148096532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288322859321
                                         uncertainty =       0.002148096532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379708708
  error estimate for blocks of size 2^( 2) =       0.000394416958
  error estimate for blocks of size 2^( 3) =       0.000407879743
  error estimate for blocks of size 2^( 4) =       0.000417939290
  error estimate for blocks of size 2^( 5) =       0.000424320404
  error estimate for blocks of size 2^( 6) =       0.000426995901
  error estimate for blocks of size 2^( 7) =       0.000429644387

      target function =      -0.919087450198
              le_mean =     -17.206410079752
             les_mean =     296.356466566603
             stat err =       0.000424724996
             autocorr =       1.251164828620
   target nu stat err =       0.000424724996
   target dn stat err =       0.003312483286
      target stat err =       0.005234969908
              std dev =       0.536989204166
             le_variance =       0.288357405391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288322859321
                                         uncertainty =       0.002148096532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288322859321
                                         uncertainty =       0.002148096532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379708708
  error estimate for blocks of size 2^( 2) =       0.000394416958
  error estimate for blocks of size 2^( 3) =       0.000407879743
  error estimate for blocks of size 2^( 4) =       0.000417939290
  error estimate for blocks of size 2^( 5) =       0.000424320404
  error estimate for blocks of size 2^( 6) =       0.000426995901
  error estimate for blocks of size 2^( 7) =       0.000429644387

      target function =      -0.919087450186
              le_mean =     -17.206410079752
             les_mean =     296.356466566610
             stat err =       0.000424724996
             autocorr =       1.251164828624
   target nu stat err =       0.000424724996
   target dn stat err =       0.003312483286
      target stat err =       0.005234969908
              std dev =       0.536989204166
             le_variance =       0.288357405391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288322859321
                                         uncertainty =       0.002148096532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288322859321
                                         uncertainty =       0.002148096532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379708708
  error estimate for blocks of size 2^( 2) =       0.000394416958
  error estimate for blocks of size 2^( 3) =       0.000407879743
  error estimate for blocks of size 2^( 4) =       0.000417939290
  error estimate for blocks of size 2^( 5) =       0.000424320404
  error estimate for blocks of size 2^( 6) =       0.000426995901
  error estimate for blocks of size 2^( 7) =       0.000429644387

      target function =      -0.919087450176
              le_mean =     -17.206410079752
             les_mean =     296.356466566617
             stat err =       0.000424724996
             autocorr =       1.251164828617
   target nu stat err =       0.000424724996
   target dn stat err =       0.003312483287
      target stat err =       0.005234969908
              std dev =       0.536989204166
             le_variance =       0.288357405391


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919087450174        initial
     8.8818e+07     8.8818e+08             1.3262e-11        -0.919087450198  <--
     3.5527e+08     3.5527e+09             3.3151e-12        -0.919087450186
     1.4211e+09     1.4211e+10             8.2918e-13        -0.919087450176

*****************************************************************************
Applying the update for shift_i =   8.8818e+07     and shift_s =   8.8818e+08
*****************************************************************************

  Execution time = 5.3104e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0209e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.1397
    reference variance = 0.201001
====================================================
  Execution time = 3.7681e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5414e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9713e-01
  Total weights = 1.973561082e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0946e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289510890750
                                         uncertainty =       0.001785781196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289510890750
                                         uncertainty =       0.001785781196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380441701
  error estimate for blocks of size 2^( 2) =       0.000395443582
  error estimate for blocks of size 2^( 3) =       0.000409577797
  error estimate for blocks of size 2^( 4) =       0.000418951296
  error estimate for blocks of size 2^( 5) =       0.000424720146
  error estimate for blocks of size 2^( 6) =       0.000427103684
  error estimate for blocks of size 2^( 7) =       0.000429921469

      target function =      -0.917207196069
              le_mean =     -17.206893493117
             les_mean =     296.374310391966
             stat err =       0.000425174149
             autocorr =       1.248985716185
   target nu stat err =       0.000425174149
   target dn stat err =       0.002254912953
      target stat err =       0.003591667790
              std dev =       0.538025813449
             le_variance =       0.289471775938


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720689349312e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+07, overlap shift 2.2204e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917220250685       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917220250686       residual = 9.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917220250686       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917220250686       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917220250717       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917220249465       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917220225613       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917220238575       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917220243386       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917220254915       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917220296339       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917220251185       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917220281116       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917220212586       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917220209766       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917220283621       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917220194717       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917220304644       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917220284610       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917220217971       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917220268306       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917220275702       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917220222802       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917220244301       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917220291280       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917220240733       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917220209702       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917220246537       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917220257251       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917220254010       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917220288067       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917220251359       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917220239954       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917220251837       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917220269167       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2204e+07 is 1.709548e-11

solving harmonic davidson linear method for identity shift 8.8818e+07, overlap shift 8.8818e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917220250685       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917220250685       residual = 9.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917220250685       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917220250686       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917220250685       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917220251384       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917220095454       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917219942879       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917220085594       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917220179505       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917219835759       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917220320819       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917220451991       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917220489374       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917220261453       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917220237254       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917220534815       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917220159471       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917220003076       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917219988392       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917220073361       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917220228845       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917220065508       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917219806607       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917220625462       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917220277990       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917219906351       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917220514199       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917220321338       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917220252690       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917220331848       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917220236876       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917220764883       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917220305144       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917220568588       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.8818e+07 is 4.273585e-12

solving harmonic davidson linear method for identity shift 3.5527e+08, overlap shift 3.5527e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917220250685       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917220250685       residual = 9.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917220250685       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917220156213       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917220105002       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917219987289       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917220910992       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917220250685       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917219926138       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917220514493       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917220768631       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917220566243       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917219774016       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917220049249       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917220679849       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917219798260       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917219603734       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917220693797       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917220776467       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917219555008       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917220774213       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917219450160       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917221413843       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917222263746       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917219268587       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917220888795       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917221420821       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917221088723       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917221438930       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917220352426       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917220206857       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917219433803       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917220175936       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917221526009       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917219854584       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.5527e+08 is 1.068252e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.427947 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8680e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2259
    reference variance = 0.139007
====================================================
  Execution time = 3.7310e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9510e-01
  Total weights = 1.9739e+06
  Execution time = 3.1342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288085656734
                                         uncertainty =       0.001386884475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288085656734
                                         uncertainty =       0.001386884475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379516172
  error estimate for blocks of size 2^( 2) =       0.000394266519
  error estimate for blocks of size 2^( 3) =       0.000408103950
  error estimate for blocks of size 2^( 4) =       0.000417862040
  error estimate for blocks of size 2^( 5) =       0.000424526304
  error estimate for blocks of size 2^( 6) =       0.000428620274
  error estimate for blocks of size 2^( 7) =       0.000428652609

      target function =      -0.920385817688
              le_mean =     -17.206864408948
             les_mean =     296.371280197076
             stat err =       0.000424915307
             autocorr =       1.253557267614
   target nu stat err =       0.000424915307
   target dn stat err =       0.002137293444
      target stat err =       0.003434993153
              std dev =       0.536716916960
             le_variance =       0.288065048951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288085656734
                                         uncertainty =       0.001386884475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288085656734
                                         uncertainty =       0.001386884475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379516172
  error estimate for blocks of size 2^( 2) =       0.000394266519
  error estimate for blocks of size 2^( 3) =       0.000408103950
  error estimate for blocks of size 2^( 4) =       0.000417862040
  error estimate for blocks of size 2^( 5) =       0.000424526304
  error estimate for blocks of size 2^( 6) =       0.000428620274
  error estimate for blocks of size 2^( 7) =       0.000428652609

      target function =      -0.920385817682
              le_mean =     -17.206864408948
             les_mean =     296.371280197080
             stat err =       0.000424915307
             autocorr =       1.253557267623
   target nu stat err =       0.000424915307
   target dn stat err =       0.002137293445
      target stat err =       0.003434993155
              std dev =       0.536716916961
             le_variance =       0.288065048952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288085656734
                                         uncertainty =       0.001386884475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288085656734
                                         uncertainty =       0.001386884475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379516172
  error estimate for blocks of size 2^( 2) =       0.000394266519
  error estimate for blocks of size 2^( 3) =       0.000408103950
  error estimate for blocks of size 2^( 4) =       0.000417862040
  error estimate for blocks of size 2^( 5) =       0.000424526304
  error estimate for blocks of size 2^( 6) =       0.000428620274
  error estimate for blocks of size 2^( 7) =       0.000428652609

      target function =      -0.920385817685
              le_mean =     -17.206864408948
             les_mean =     296.371280197078
             stat err =       0.000424915307
             autocorr =       1.253557267618
   target nu stat err =       0.000424915307
   target dn stat err =       0.002137293445
      target stat err =       0.003434993154
              std dev =       0.536716916961
             le_variance =       0.288065048952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288085656734
                                         uncertainty =       0.001386884475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288085656734
                                         uncertainty =       0.001386884475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379516172
  error estimate for blocks of size 2^( 2) =       0.000394266519
  error estimate for blocks of size 2^( 3) =       0.000408103950
  error estimate for blocks of size 2^( 4) =       0.000417862040
  error estimate for blocks of size 2^( 5) =       0.000424526304
  error estimate for blocks of size 2^( 6) =       0.000428620274
  error estimate for blocks of size 2^( 7) =       0.000428652609

      target function =      -0.920385817688
              le_mean =     -17.206864408948
             les_mean =     296.371280197076
             stat err =       0.000424915307
             autocorr =       1.253557267616
   target nu stat err =       0.000424915307
   target dn stat err =       0.002137293444
      target stat err =       0.003434993153
              std dev =       0.536716916960
             le_variance =       0.288065048951


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920385817688        initial  <--
     2.2204e+07     2.2204e+08             1.7095e-11        -0.920385817682
     8.8818e+07     8.8818e+08             4.2736e-12        -0.920385817685
     3.5527e+08     3.5527e+09             1.0683e-12        -0.920385817688

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.1143
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0180e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2987
    reference variance = 0.358872
====================================================
  Execution time = 3.9036e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5399e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0283e-01
  Total weights = 1.973839169e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0877e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292967168863
                                         uncertainty =       0.002019302046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292967168863
                                         uncertainty =       0.002019302046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382719654
  error estimate for blocks of size 2^( 2) =       0.000397144597
  error estimate for blocks of size 2^( 3) =       0.000409931207
  error estimate for blocks of size 2^( 4) =       0.000419921115
  error estimate for blocks of size 2^( 5) =       0.000425553234
  error estimate for blocks of size 2^( 6) =       0.000428864449
  error estimate for blocks of size 2^( 7) =       0.000430428663

      target function =      -0.908391891424
              le_mean =     -17.206580488022
             les_mean =     296.369242361554
             stat err =       0.000426191865
             autocorr =       1.240077364479
   target nu stat err =       0.000426191865
   target dn stat err =       0.003175632552
      target stat err =       0.004909788810
              std dev =       0.541247325891
             le_variance =       0.292948667784


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720658048802e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+08, overlap shift 2.2204e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908417540885       residual = 8.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908417540885       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908417540885       residual = 7.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908417560254       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908417541299       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908417336010       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908417747712       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908417617851       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908417219778       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908417717940       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908416956027       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908417594852       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908417420369       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908417887779       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908417385677       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908417798218       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908417800366       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908416954138       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908418045654       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908417416889       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908417474865       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908417411394       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908417220125       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908417238519       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908417711539       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908417199056       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908417547509       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908417880283       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908417082468       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908418177689       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908418597953       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908418465469       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908418351773       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908417607850       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908416895105       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.908416546935       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.908417198499       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.908417143413       residual = 7.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2204e+08 is 1.867433e-12

solving harmonic davidson linear method for identity shift 8.8818e+08, overlap shift 8.8818e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908417540885       residual = 8.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908417540885       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908417540885       residual = 7.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908417540885       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908417540885       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908417403479       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908417888125       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908419300134       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908417490140       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908418970624       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908415320044       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908414457950       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908417352316       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908416300596       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908419281562       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908417693007       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908417948225       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908417811492       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908417176791       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908417428981       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908419940406       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908419600683       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908417166452       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908416917933       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908415967796       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908417383733       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908420620778       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908418851497       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908419829703       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908417098440       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908415989945       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908417966295       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908416530884       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908415252331       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908419213396       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.908414139972       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.908411670905       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.908417930925       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.8818e+08 is 4.666639e-13

solving harmonic davidson linear method for identity shift 3.5527e+09, overlap shift 3.5527e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908417540885       residual = 8.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908417540885       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908417540885       residual = 7.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908418270156       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908417540893       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908417528470       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908423235727       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908419420741       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908422543623       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908408612472       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908410435521       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908425680090       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908421963885       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908417131652       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908422019156       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908418537232       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908414834400       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908426821697       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908420383670       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908415453002       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908425713562       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908426530522       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908403279775       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908411375041       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908413375969       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908422337472       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908419743192       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908409709513       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908405188940       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908416102996       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908421447075       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908418322274       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908419563238       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908430967615       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908407201880       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.908412470896       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.908410984788       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.908410789138       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.908402082046       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.908395933518       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.908429169912       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.908431693048       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.908426547891       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.908444476115       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.908446040597       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.908404649094       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.908401062021       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.908469198171       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.908399848162       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.908412305991       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.908442222186       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.908436248414       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.908360041721       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.908426678971       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.908374671549       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.908475004680       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.908529113319       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.908439120189       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.908322061182       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.908288464245       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.908262497364       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.908222683423       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.908322957579       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.908234841343       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.908376718285       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.908525904364       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.908700273713       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.907930569910       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.908852255436       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.909154552286       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.910212539960       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.905935287786       residual = 1.43e-03           smallest_sin_value = 9.97e-01
davidson iteration   72 stopping due to small subspace S singular value of 9.15e-01
davidson solver did not converge after         72 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.5527e+09 is 1.162688e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.598919 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0092e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.1519
    reference variance = 0.343306
====================================================
  Execution time = 3.7290e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9838e-01
  Total weights = 1.9739e+06
  Execution time = 3.1514e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290140978522
                                         uncertainty =       0.001912341238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290140978522
                                         uncertainty =       0.001912341238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380839778
  error estimate for blocks of size 2^( 2) =       0.000395513584
  error estimate for blocks of size 2^( 3) =       0.000409297781
  error estimate for blocks of size 2^( 4) =       0.000419018301
  error estimate for blocks of size 2^( 5) =       0.000424938007
  error estimate for blocks of size 2^( 6) =       0.000427560705
  error estimate for blocks of size 2^( 7) =       0.000429409363

      target function =      -0.915261782276
              le_mean =     -17.206786272427
             les_mean =     296.371870267852
             stat err =       0.000425231594
             autocorr =       1.246712868820
   target nu stat err =       0.000425231594
   target dn stat err =       0.002419256399
      target stat err =       0.003826438770
              std dev =       0.538588779420
             le_variance =       0.290077873317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290140978522
                                         uncertainty =       0.001912341238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290140978522
                                         uncertainty =       0.001912341238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380839778
  error estimate for blocks of size 2^( 2) =       0.000395513584
  error estimate for blocks of size 2^( 3) =       0.000409297781
  error estimate for blocks of size 2^( 4) =       0.000419018301
  error estimate for blocks of size 2^( 5) =       0.000424938007
  error estimate for blocks of size 2^( 6) =       0.000427560705
  error estimate for blocks of size 2^( 7) =       0.000429409363

      target function =      -0.915261782277
              le_mean =     -17.206786272427
             les_mean =     296.371870267851
             stat err =       0.000425231594
             autocorr =       1.246712868825
   target nu stat err =       0.000425231594
   target dn stat err =       0.002419256399
      target stat err =       0.003826438770
              std dev =       0.538588779420
             le_variance =       0.290077873317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290140978522
                                         uncertainty =       0.001912341238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290140978522
                                         uncertainty =       0.001912341238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380839778
  error estimate for blocks of size 2^( 2) =       0.000395513584
  error estimate for blocks of size 2^( 3) =       0.000409297781
  error estimate for blocks of size 2^( 4) =       0.000419018301
  error estimate for blocks of size 2^( 5) =       0.000424938007
  error estimate for blocks of size 2^( 6) =       0.000427560705
  error estimate for blocks of size 2^( 7) =       0.000429409363

      target function =      -0.915261782277
              le_mean =     -17.206786272427
             les_mean =     296.371870267852
             stat err =       0.000425231594
             autocorr =       1.246712868824
   target nu stat err =       0.000425231594
   target dn stat err =       0.002419256399
      target stat err =       0.003826438770
              std dev =       0.538588779420
             le_variance =       0.290077873317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290140978522
                                         uncertainty =       0.001912341238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290140978522
                                         uncertainty =       0.001912341238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380839778
  error estimate for blocks of size 2^( 2) =       0.000395513584
  error estimate for blocks of size 2^( 3) =       0.000409297781
  error estimate for blocks of size 2^( 4) =       0.000419018301
  error estimate for blocks of size 2^( 5) =       0.000424938007
  error estimate for blocks of size 2^( 6) =       0.000427560705
  error estimate for blocks of size 2^( 7) =       0.000429409363

      target function =      -0.915261782276
              le_mean =     -17.206786272427
             les_mean =     296.371870267852
             stat err =       0.000425231594
             autocorr =       1.246712868821
   target nu stat err =       0.000425231594
   target dn stat err =       0.002419256399
      target stat err =       0.003826438770
              std dev =       0.538588779420
             le_variance =       0.290077873317


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915261782276        initial
     2.2204e+08     2.2204e+09             1.8674e-12        -0.915261782277  <--
     8.8818e+08     8.8818e+09             4.6666e-13        -0.915261782277
     3.5527e+09     3.5527e+10             1.1627e-13        -0.915261782276

*****************************************************************************
Applying the update for shift_i =   2.2204e+08     and shift_s =   2.2204e+09
*****************************************************************************

  Execution time = 5.3126e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0322e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.112
    reference variance = 0.343049
====================================================
  Execution time = 3.8113e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5425e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0073e-01
  Total weights = 1.973941459e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0816e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293168698082
                                         uncertainty =       0.002168137790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293168698082
                                         uncertainty =       0.002168137790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382844936
  error estimate for blocks of size 2^( 2) =       0.000397025653
  error estimate for blocks of size 2^( 3) =       0.000410844971
  error estimate for blocks of size 2^( 4) =       0.000420881556
  error estimate for blocks of size 2^( 5) =       0.000425779977
  error estimate for blocks of size 2^( 6) =       0.000430000128
  error estimate for blocks of size 2^( 7) =       0.000431603521

      target function =      -0.911611804288
              le_mean =     -17.206436831264
             les_mean =     296.362200155768
             stat err =       0.000427066295
             autocorr =       1.244356387900
   target nu stat err =       0.000427066295
   target dn stat err =       0.003467183896
      target stat err =       0.005387774665
              std dev =       0.541424500764
             le_variance =       0.293140490027


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720643683126e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+07, overlap shift 5.5511e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911642617666       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911642617667       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911642617667       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911642617668       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911642617668       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911642714617       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911642617668       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911642617668       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911642512117       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911642617668       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911642617668       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911642617668       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911642878993       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911642620490       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911642617668       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911642617668       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911642617668       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911642616324       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911642617668       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911642699869       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911642601850       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911642218730       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911642631121       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911642411181       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911642871910       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911642753421       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911642403267       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911642856293       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911642569729       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911642390680       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911642462634       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911642441063       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911642512617       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911642492424       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911642603595       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911642691406       residual = 9.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.5511e+07 is 9.727741e-12

solving harmonic davidson linear method for identity shift 2.2204e+08, overlap shift 2.2204e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911642617666       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911642617667       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911642617667       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911642617667       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911642617667       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911642593208       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911642692659       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911642192077       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911642675792       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911643505829       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911642815437       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911641915696       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911642635967       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911642328084       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911641883435       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911642539036       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911642783119       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911642096467       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911641979382       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911642430254       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911643113846       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911642181969       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911642756906       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911642918802       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911643151428       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911642963500       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911642941083       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911643037707       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911642388233       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911642337151       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911643731466       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911642962181       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911642886069       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911643131574       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911642157185       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911642776963       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911641898192       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911641787126       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911642605246       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2204e+08 is 2.452637e-12

solving harmonic davidson linear method for identity shift 8.8818e+08, overlap shift 8.8818e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911642617666       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911642617666       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911642617666       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911642759573       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911642851075       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911642693050       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911642617666       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911644657325       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911643094104       residual = 8.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911643566939       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911642617666       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911639386608       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911641880325       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911641962033       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911641132784       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911643417600       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911642873212       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911644671032       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911640409953       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911643011127       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911640588734       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911643725742       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911640573287       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911638920466       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911640797887       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911644647168       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911642780261       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911643291516       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911644016413       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911647864066       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911641588467       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911641304557       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911638458650       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911639755547       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911643811018       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911643956442       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911647382887       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911642168816       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911641809206       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.8818e+08 is 6.138133e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.656896 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8995e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2493
    reference variance = 0.184611
====================================================
  Execution time = 3.7347e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7208e+01
  VMC Evar = 2.9543e-01
  Total weights = 1.9735e+06
  Execution time = 3.1494e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288157062948
                                         uncertainty =       0.001804814707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288157062948
                                         uncertainty =       0.001804814707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379601314
  error estimate for blocks of size 2^( 2) =       0.000394846525
  error estimate for blocks of size 2^( 3) =       0.000408245393
  error estimate for blocks of size 2^( 4) =       0.000417808989
  error estimate for blocks of size 2^( 5) =       0.000422255693
  error estimate for blocks of size 2^( 6) =       0.000424862565
  error estimate for blocks of size 2^( 7) =       0.000427449549

      target function =      -0.919834949930
              le_mean =     -17.208420547017
             les_mean =     296.425170608892
             stat err =       0.000423094199
             autocorr =       1.242277809538
   target nu stat err =       0.000423094199
   target dn stat err =       0.002069017214
      target stat err =       0.003335286309
              std dev =       0.536837326292
             le_variance =       0.288194314900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288157062948
                                         uncertainty =       0.001804814707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288157062948
                                         uncertainty =       0.001804814707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379601314
  error estimate for blocks of size 2^( 2) =       0.000394846525
  error estimate for blocks of size 2^( 3) =       0.000408245393
  error estimate for blocks of size 2^( 4) =       0.000417808989
  error estimate for blocks of size 2^( 5) =       0.000422255693
  error estimate for blocks of size 2^( 6) =       0.000424862565
  error estimate for blocks of size 2^( 7) =       0.000427449549

      target function =      -0.919834949929
              le_mean =     -17.208420547017
             les_mean =     296.425170608892
             stat err =       0.000423094199
             autocorr =       1.242277809542
   target nu stat err =       0.000423094199
   target dn stat err =       0.002069017215
      target stat err =       0.003335286309
              std dev =       0.536837326292
             le_variance =       0.288194314900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288157062948
                                         uncertainty =       0.001804814707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288157062948
                                         uncertainty =       0.001804814707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379601314
  error estimate for blocks of size 2^( 2) =       0.000394846525
  error estimate for blocks of size 2^( 3) =       0.000408245393
  error estimate for blocks of size 2^( 4) =       0.000417808989
  error estimate for blocks of size 2^( 5) =       0.000422255693
  error estimate for blocks of size 2^( 6) =       0.000424862565
  error estimate for blocks of size 2^( 7) =       0.000427449549

      target function =      -0.919834949930
              le_mean =     -17.208420547017
             les_mean =     296.425170608892
             stat err =       0.000423094199
             autocorr =       1.242277809541
   target nu stat err =       0.000423094199
   target dn stat err =       0.002069017214
      target stat err =       0.003335286309
              std dev =       0.536837326292
             le_variance =       0.288194314900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288157062948
                                         uncertainty =       0.001804814707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288157062948
                                         uncertainty =       0.001804814707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379601314
  error estimate for blocks of size 2^( 2) =       0.000394846525
  error estimate for blocks of size 2^( 3) =       0.000408245393
  error estimate for blocks of size 2^( 4) =       0.000417808989
  error estimate for blocks of size 2^( 5) =       0.000422255693
  error estimate for blocks of size 2^( 6) =       0.000424862565
  error estimate for blocks of size 2^( 7) =       0.000427449549

      target function =      -0.919834949930
              le_mean =     -17.208420547017
             les_mean =     296.425170608892
             stat err =       0.000423094199
             autocorr =       1.242277809538
   target nu stat err =       0.000423094199
   target dn stat err =       0.002069017214
      target stat err =       0.003335286309
              std dev =       0.536837326292
             le_variance =       0.288194314900


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919834949930        initial  <--
     5.5511e+07     5.5511e+08             9.7277e-12        -0.919834949929
     2.2204e+08     2.2204e+09             2.4526e-12        -0.919834949930
     8.8818e+08     8.8818e+09             6.1381e-13        -0.919834949930

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.1858
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0219e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.262
    reference variance = 0.292747
====================================================
  Execution time = 3.8047e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5411e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9885e-01
  Total weights = 1.973508755e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0566e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291559890330
                                         uncertainty =       0.002107865846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291559890330
                                         uncertainty =       0.002107865846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381792119
  error estimate for blocks of size 2^( 2) =       0.000396367831
  error estimate for blocks of size 2^( 3) =       0.000410066354
  error estimate for blocks of size 2^( 4) =       0.000420205442
  error estimate for blocks of size 2^( 5) =       0.000426786787
  error estimate for blocks of size 2^( 6) =       0.000429914665
  error estimate for blocks of size 2^( 7) =       0.000432750428

      target function =      -0.914536239281
              le_mean =     -17.206363948401
             les_mean =     296.357809016505
             stat err =       0.000427414330
             autocorr =       1.253268832997
   target nu stat err =       0.000427414330
   target dn stat err =       0.002580551573
      target stat err =       0.004063884157
              std dev =       0.539935592672
             le_variance =       0.291530444234


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720636394840e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+08, overlap shift 5.5511e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914553317236       residual = 6.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914553317236       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914553317236       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914553317236       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914553317236       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914553246650       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914553305265       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914553324148       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914553284318       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914554387178       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914553419795       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914551833352       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914554996811       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914554315078       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914553217330       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914552863531       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914554693490       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914553862487       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914554298218       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914552818764       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914553764985       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914552663711       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914553520207       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914554694274       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914550302167       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914554774932       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914555431442       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914553400160       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914552795659       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914553797145       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914555390520       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914550575420       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914551474639       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914552193795       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914553896873       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914553183280       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914551692631       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914552734415       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914550560664       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.5511e+08 is 9.959277e-13

solving harmonic davidson linear method for identity shift 2.2204e+09, overlap shift 2.2204e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914553317236       residual = 6.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914553317236       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914553317236       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914552384420       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914554040461       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914553126889       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914553342212       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914557771821       residual = 7.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914551755388       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914557722152       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914553593694       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914556895171       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914555511626       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914552241467       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914554310479       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914556525856       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914553069494       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914546852362       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914556324499       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914551872023       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914556760337       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914553275021       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914558417144       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914554865421       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914547102300       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914547366757       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914548156729       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914539250012       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914547603238       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914548498872       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914550922051       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914560439770       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914552446419       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914552720836       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914546730345       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914550977941       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914541978517       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914550951408       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2204e+09 is 2.482499e-13

solving harmonic davidson linear method for identity shift 8.8818e+09, overlap shift 8.8818e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914553317236       residual = 6.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914553317236       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914553317236       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914553317236       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914553317328       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914546961629       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914554826172       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914550798563       residual = 7.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914582854695       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914553652394       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914567650769       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914541354056       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914523631149       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914543874917       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914547881829       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914553778938       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914534164820       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914556165934       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914534220184       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914511019909       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914546172742       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914525931583       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914548504639       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914570322968       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914567400902       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914509085374       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914572234569       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914556739189       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914550558160       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914554083249       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914553207995       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914593290741       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914566798618       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914559752656       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914532230410       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914553055400       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914562140355       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914602964798       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914542294413       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914566230425       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914533179727       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.914599413942       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.914536163164       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.914503495629       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.914602019642       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.914507857341       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.914581474039       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.914589330449       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.914554180384       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.914578492836       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.914442355164       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.914385738003       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.914581594179       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.914634188468       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.914496580463       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.914411453805       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.914727576794       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.915061600507       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.913912012334       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.914547542352       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.914488492264       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.914510625892       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.914777740416       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.914673164106       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.915708418385       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.914198295633       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.915438691639       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.912668814957       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.913953777249       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.913913263524       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.914455755677       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.914843830097       residual = 3.40e-04           smallest_sin_value = 9.96e-01
davidson iteration   72 stopping due to small subspace S singular value of 8.55e-01
davidson solver did not converge after         72 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.8818e+09 is 6.253199e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.832116 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8795e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2644
    reference variance = 0.28937
====================================================
  Execution time = 3.7464e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9702e-01
  Total weights = 1.9740e+06
  Execution time = 3.1411e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288984217662
                                         uncertainty =       0.001749894564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288984217662
                                         uncertainty =       0.001749894564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380108269
  error estimate for blocks of size 2^( 2) =       0.000394730033
  error estimate for blocks of size 2^( 3) =       0.000408104333
  error estimate for blocks of size 2^( 4) =       0.000417668271
  error estimate for blocks of size 2^( 5) =       0.000423785675
  error estimate for blocks of size 2^( 6) =       0.000425944591
  error estimate for blocks of size 2^( 7) =       0.000427343716

      target function =      -0.917390574633
              le_mean =     -17.206212519126
             les_mean =     296.350765126729
             stat err =       0.000423685563
             autocorr =       1.242432197095
   target nu stat err =       0.000423685563
   target dn stat err =       0.002358268528
      target stat err =       0.003746018009
              std dev =       0.537554268953
             le_variance =       0.288964592069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288984217662
                                         uncertainty =       0.001749894564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288984217662
                                         uncertainty =       0.001749894564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380108269
  error estimate for blocks of size 2^( 2) =       0.000394730033
  error estimate for blocks of size 2^( 3) =       0.000408104333
  error estimate for blocks of size 2^( 4) =       0.000417668271
  error estimate for blocks of size 2^( 5) =       0.000423785675
  error estimate for blocks of size 2^( 6) =       0.000425944591
  error estimate for blocks of size 2^( 7) =       0.000427343716

      target function =      -0.917390574636
              le_mean =     -17.206212519126
             les_mean =     296.350765126727
             stat err =       0.000423685563
             autocorr =       1.242432197095
   target nu stat err =       0.000423685563
   target dn stat err =       0.002358268527
      target stat err =       0.003746018008
              std dev =       0.537554268953
             le_variance =       0.288964592069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288984217662
                                         uncertainty =       0.001749894564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288984217662
                                         uncertainty =       0.001749894564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380108269
  error estimate for blocks of size 2^( 2) =       0.000394730033
  error estimate for blocks of size 2^( 3) =       0.000408104333
  error estimate for blocks of size 2^( 4) =       0.000417668271
  error estimate for blocks of size 2^( 5) =       0.000423785675
  error estimate for blocks of size 2^( 6) =       0.000425944591
  error estimate for blocks of size 2^( 7) =       0.000427343716

      target function =      -0.917390574635
              le_mean =     -17.206212519126
             les_mean =     296.350765126728
             stat err =       0.000423685563
             autocorr =       1.242432197087
   target nu stat err =       0.000423685563
   target dn stat err =       0.002358268527
      target stat err =       0.003746018009
              std dev =       0.537554268953
             le_variance =       0.288964592069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288984217662
                                         uncertainty =       0.001749894564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288984217662
                                         uncertainty =       0.001749894564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380108269
  error estimate for blocks of size 2^( 2) =       0.000394730033
  error estimate for blocks of size 2^( 3) =       0.000408104333
  error estimate for blocks of size 2^( 4) =       0.000417668271
  error estimate for blocks of size 2^( 5) =       0.000423785675
  error estimate for blocks of size 2^( 6) =       0.000425944591
  error estimate for blocks of size 2^( 7) =       0.000427343716

      target function =      -0.917390574634
              le_mean =     -17.206212519126
             les_mean =     296.350765126729
             stat err =       0.000423685563
             autocorr =       1.242432197092
   target nu stat err =       0.000423685563
   target dn stat err =       0.002358268527
      target stat err =       0.003746018009
              std dev =       0.537554268952
             le_variance =       0.288964592069


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917390574633        initial
     5.5511e+08     5.5511e+09             9.9593e-13        -0.917390574636  <--
     2.2204e+09     2.2204e+10             2.4825e-13        -0.917390574635
     8.8818e+09     8.8818e+10             6.2532e-14        -0.917390574634

*****************************************************************************
Applying the update for shift_i =   5.5511e+08     and shift_s =   5.5511e+09
*****************************************************************************

  Execution time = 5.3311e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0211e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.256
    reference variance = 0.176752
====================================================
  Execution time = 4.1041e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5403e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9933e-01
  Total weights = 1.973717452e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0436e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291099340158
                                         uncertainty =       0.001946890693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291099340158
                                         uncertainty =       0.001946890693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381468440
  error estimate for blocks of size 2^( 2) =       0.000396711401
  error estimate for blocks of size 2^( 3) =       0.000410333244
  error estimate for blocks of size 2^( 4) =       0.000420035792
  error estimate for blocks of size 2^( 5) =       0.000425430075
  error estimate for blocks of size 2^( 6) =       0.000427032828
  error estimate for blocks of size 2^( 7) =       0.000429726830

      target function =      -0.913780193280
              le_mean =     -17.206812601102
             les_mean =     296.373726753175
             stat err =       0.000425556382
             autocorr =       1.244505981793
   target nu stat err =       0.000425556382
   target dn stat err =       0.002914313937
      target stat err =       0.004569595380
              std dev =       0.539477841347
             le_variance =       0.291036341304


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720681260110e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+08, overlap shift 1.3878e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913802314391       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913802314391       residual = 9.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913802314391       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913802314391       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913802295871       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913802325165       residual = 9.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913802505471       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913802144589       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913802668743       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913802201816       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913802316213       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913802263029       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913802725971       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913802155273       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913802573659       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913802243654       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913802694227       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913802567126       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913802355710       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913802263475       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913801981927       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913802079689       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913802420769       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913802326630       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913802385768       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913802152605       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913802262192       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913802289977       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913802206318       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913802533227       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913802459225       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913802315019       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913802054395       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913802150121       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913802025985       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913802276756       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913801979033       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913802335518       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3878e+08 is 3.301390e-12

solving harmonic davidson linear method for identity shift 5.5511e+08, overlap shift 5.5511e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913802314391       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913802314391       residual = 9.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913802314391       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913802406049       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913802314391       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913802314391       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913802463694       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913801865982       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913802937467       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913802574311       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913802921519       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913803823683       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913804291911       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913802910217       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913801346935       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913801858436       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913801056355       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913801226402       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913801402796       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913801581584       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913802990204       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913800238671       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913803475971       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913802730839       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913801773307       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913801470663       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913800104916       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913801327773       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913804956145       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913802554781       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913801566558       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913801464284       residual = 9.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913801686489       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913801048947       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913803505601       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913800678347       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913802714796       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913803273411       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.5511e+08 is 8.252914e-13

solving harmonic davidson linear method for identity shift 2.2204e+09, overlap shift 2.2204e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913802314391       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913802314391       residual = 9.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913802314391       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913802314391       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913802315431       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913801544337       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913802314391       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913797286769       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913799926873       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913799692185       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913810107409       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913800263123       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913802218339       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913805878526       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913800265819       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913800559283       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913801534935       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913797885790       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913799099454       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913798964750       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913806003065       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913800159754       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913806385299       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913809412559       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913807583015       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913800013224       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913803038049       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913797684742       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913803788594       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913802464213       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913802442596       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913801848142       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913807921814       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913802668875       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913805108393       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913792719906       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913794231275       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913797199795       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913801791100       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2204e+09 is 2.066849e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.891205 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1543e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2953
    reference variance = 0.275715
====================================================
  Execution time = 3.7352e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9688e-01
  Total weights = 1.9737e+06
  Execution time = 3.1404e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290889846016
                                         uncertainty =       0.001861068007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290889846016
                                         uncertainty =       0.001861068007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381372300
  error estimate for blocks of size 2^( 2) =       0.000396454452
  error estimate for blocks of size 2^( 3) =       0.000409866596
  error estimate for blocks of size 2^( 4) =       0.000419752986
  error estimate for blocks of size 2^( 5) =       0.000426037085
  error estimate for blocks of size 2^( 6) =       0.000428830847
  error estimate for blocks of size 2^( 7) =       0.000430306868

      target function =      -0.917591959753
              le_mean =     -17.206795275364
             les_mean =     296.370685698109
             stat err =       0.000426231947
             autocorr =       1.249089920504
   target nu stat err =       0.000426231947
   target dn stat err =       0.002167070716
      target stat err =       0.003460114603
              std dev =       0.539341878393
             le_variance =       0.290889661788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290889846016
                                         uncertainty =       0.001861068007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290889846016
                                         uncertainty =       0.001861068007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381372300
  error estimate for blocks of size 2^( 2) =       0.000396454452
  error estimate for blocks of size 2^( 3) =       0.000409866596
  error estimate for blocks of size 2^( 4) =       0.000419752986
  error estimate for blocks of size 2^( 5) =       0.000426037085
  error estimate for blocks of size 2^( 6) =       0.000428830847
  error estimate for blocks of size 2^( 7) =       0.000430306868

      target function =      -0.917591959752
              le_mean =     -17.206795275364
             les_mean =     296.370685698109
             stat err =       0.000426231947
             autocorr =       1.249089920504
   target nu stat err =       0.000426231947
   target dn stat err =       0.002167070716
      target stat err =       0.003460114603
              std dev =       0.539341878393
             le_variance =       0.290889661788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290889846016
                                         uncertainty =       0.001861068007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290889846016
                                         uncertainty =       0.001861068007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381372300
  error estimate for blocks of size 2^( 2) =       0.000396454452
  error estimate for blocks of size 2^( 3) =       0.000409866596
  error estimate for blocks of size 2^( 4) =       0.000419752986
  error estimate for blocks of size 2^( 5) =       0.000426037085
  error estimate for blocks of size 2^( 6) =       0.000428830847
  error estimate for blocks of size 2^( 7) =       0.000430306868

      target function =      -0.917591959752
              le_mean =     -17.206795275364
             les_mean =     296.370685698109
             stat err =       0.000426231947
             autocorr =       1.249089920506
   target nu stat err =       0.000426231947
   target dn stat err =       0.002167070716
      target stat err =       0.003460114603
              std dev =       0.539341878393
             le_variance =       0.290889661788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290889846016
                                         uncertainty =       0.001861068007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290889846016
                                         uncertainty =       0.001861068007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381372300
  error estimate for blocks of size 2^( 2) =       0.000396454452
  error estimate for blocks of size 2^( 3) =       0.000409866596
  error estimate for blocks of size 2^( 4) =       0.000419752986
  error estimate for blocks of size 2^( 5) =       0.000426037085
  error estimate for blocks of size 2^( 6) =       0.000428830847
  error estimate for blocks of size 2^( 7) =       0.000430306868

      target function =      -0.917591959753
              le_mean =     -17.206795275364
             les_mean =     296.370685698109
             stat err =       0.000426231947
             autocorr =       1.249089920503
   target nu stat err =       0.000426231947
   target dn stat err =       0.002167070716
      target stat err =       0.003460114603
              std dev =       0.539341878393
             le_variance =       0.290889661788


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917591959753        initial  <--
     1.3878e+08     1.3878e+09             3.3014e-12        -0.917591959752
     5.5511e+08     5.5511e+09             8.2529e-13        -0.917591959752
     2.2204e+09     2.2204e+10             2.0668e-13        -0.917591959753

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.1438
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0469e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2024
    reference variance = 0.304433
====================================================
  Execution time = 3.7721e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5428e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0561e-01
  Total weights = 1.973736835e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0669e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295209508974
                                         uncertainty =       0.003216476329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295209508974
                                         uncertainty =       0.003216476329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384195925
  error estimate for blocks of size 2^( 2) =       0.000399139195
  error estimate for blocks of size 2^( 3) =       0.000412793514
  error estimate for blocks of size 2^( 4) =       0.000422689970
  error estimate for blocks of size 2^( 5) =       0.000428194402
  error estimate for blocks of size 2^( 6) =       0.000430105722
  error estimate for blocks of size 2^( 7) =       0.000433410069

      target function =      -0.904098233031
              le_mean =     -17.207006833999
             les_mean =     296.386694403129
             stat err =       0.000428600041
             autocorr =       1.244511482902
   target nu stat err =       0.000428600041
   target dn stat err =       0.005255494518
      target stat err =       0.008001404506
              std dev =       0.543335087481
             le_variance =       0.295213017288


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720700683400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+09, overlap shift 1.3878e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904167679896       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904167679896       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904167679897       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904167679897       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904168037597       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904167679897       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904167873787       residual = 9.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904168805822       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904164668117       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904169059557       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904168328490       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904167503012       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.904169943595       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904167246840       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904166490408       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904166636149       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904170758423       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.904166945298       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904170051152       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.904166182830       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.904164391516       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904169529405       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904163067839       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904169512665       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.904162879506       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.904166439799       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.904161299697       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.904161267754       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.904164189594       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.904170909469       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.904160923203       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.904167728107       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.904160222614       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.904169501213       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.904175539639       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.904167913325       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.904169823895       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.904164789833       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.904163889256       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3878e+09 is 3.962424e-13

solving harmonic davidson linear method for identity shift 5.5511e+09, overlap shift 5.5511e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904167679896       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904167679896       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904167679896       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904167679897       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904169964984       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904166450417       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904169684783       residual = 9.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904167732793       residual = 9.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904152737290       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904163890813       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904162791919       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904165722744       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.904147825033       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904168536525       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904174589066       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904157422930       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904152302105       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.904188397618       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904166332619       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.904170733915       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.904121942432       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904172300185       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904167876011       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904178630388       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.904173667195       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.904183993701       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.904168880942       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.904192382191       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.904163298459       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.904187460265       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.904187838807       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.904162730036       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.904171456655       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.904151111521       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.904178603757       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.904166728493       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.904141363611       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.904169470767       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.904171999501       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.904156591764       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.904153569797       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.904188590483       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.904165108268       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.904174504339       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.904164818189       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.904177062521       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.904166179693       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.904174054138       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.904020886383       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.904171438660       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.904180503501       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.904235293099       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.904077974200       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.903985341756       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.904064604930       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.904090817986       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.904284083941       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.904070161632       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.904314747771       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.904177718282       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.904088064260       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.903992030427       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.904059633758       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.903605466217       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.903904835146       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.903928620314       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.905355905284       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.904336625406       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.904078729111       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.904210947516       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.905703612610       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.906698644190       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.904101418405       residual = 1.30e-04           smallest_sin_value = 9.99e-01
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.903756161293       residual = 3.39e-04           smallest_sin_value = 9.94e-01
davidson iteration   74 stopping due to small subspace S singular value of 7.45e-01
davidson solver did not converge after         74 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.5511e+09 is 9.884032e-14

solving harmonic davidson linear method for identity shift 2.2204e+10, overlap shift 2.2204e+11 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904167679896       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904167679896       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904167679896       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904167679896       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904167679896       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904166325887       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904222666036       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904126905066       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904174371619       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904142134092       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904150777079       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904169241774       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.904116843453       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904116544157       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904190820996       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904114941849       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904148499366       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.904213638808       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904259158659       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.904152463109       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.904199711108       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904151746770       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904165510205       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904174536559       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.904141202139       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.904154780663       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.904191801415       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.904070919327       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.904253564103       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.904184594347       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.904166477810       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.904254094580       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.904227265254       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.904123174741       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.904159674592       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.904161849057       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.904126634053       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.904149813280       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.904176464389       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.904354863417       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.904427408001       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.904103115713       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.904212150989       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.903924463050       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.904070080629       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.904259238819       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.904258599377       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.904023434113       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.904156590168       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.904154143124       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.904383618045       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.904373978432       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.904164974165       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.904355930621       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.904216878315       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.904653490574       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.903507337074       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.904184353952       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.905150810304       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.904037355191       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.904582745522       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.902941872178       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.904562094254       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.905253663118       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.900332519274       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.912752352311       residual = 6.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.899002250589       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.903633075084       residual = 5.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.908690011002       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.899027411226       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.895593724610       residual = 7.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.906427262979       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   72 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         72 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2204e+10 is 2.426213e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.183682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8690e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.1633
    reference variance = 0.264848
====================================================
  Execution time = 3.7630e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9921e-01
  Total weights = 1.9738e+06
  Execution time = 3.1416e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291121246294
                                         uncertainty =       0.001797317787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291121246294
                                         uncertainty =       0.001797317787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381526133
  error estimate for blocks of size 2^( 2) =       0.000396256779
  error estimate for blocks of size 2^( 3) =       0.000410102518
  error estimate for blocks of size 2^( 4) =       0.000419402478
  error estimate for blocks of size 2^( 5) =       0.000424892481
  error estimate for blocks of size 2^( 6) =       0.000428095174
  error estimate for blocks of size 2^( 7) =       0.000429629585

      target function =      -0.913972268308
              le_mean =     -17.206769207074
             les_mean =     296.372116438619
             stat err =       0.000425504929
             autocorr =       1.243828801342
   target nu stat err =       0.000425504929
   target dn stat err =       0.002201226018
      target stat err =       0.003484783578
              std dev =       0.539559432308
             le_variance =       0.291124380993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291121246294
                                         uncertainty =       0.001797317787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291121246294
                                         uncertainty =       0.001797317787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381526133
  error estimate for blocks of size 2^( 2) =       0.000396256779
  error estimate for blocks of size 2^( 3) =       0.000410102518
  error estimate for blocks of size 2^( 4) =       0.000419402478
  error estimate for blocks of size 2^( 5) =       0.000424892481
  error estimate for blocks of size 2^( 6) =       0.000428095174
  error estimate for blocks of size 2^( 7) =       0.000429629585

      target function =      -0.913972268308
              le_mean =     -17.206769207074
             les_mean =     296.372116438619
             stat err =       0.000425504929
             autocorr =       1.243828801346
   target nu stat err =       0.000425504929
   target dn stat err =       0.002201226018
      target stat err =       0.003484783578
              std dev =       0.539559432308
             le_variance =       0.291124380993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291121246294
                                         uncertainty =       0.001797317787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291121246294
                                         uncertainty =       0.001797317787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381526133
  error estimate for blocks of size 2^( 2) =       0.000396256779
  error estimate for blocks of size 2^( 3) =       0.000410102518
  error estimate for blocks of size 2^( 4) =       0.000419402478
  error estimate for blocks of size 2^( 5) =       0.000424892481
  error estimate for blocks of size 2^( 6) =       0.000428095174
  error estimate for blocks of size 2^( 7) =       0.000429629585

      target function =      -0.913972268308
              le_mean =     -17.206769207074
             les_mean =     296.372116438619
             stat err =       0.000425504929
             autocorr =       1.243828801351
   target nu stat err =       0.000425504929
   target dn stat err =       0.002201226018
      target stat err =       0.003484783578
              std dev =       0.539559432308
             le_variance =       0.291124380993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291121246294
                                         uncertainty =       0.001797317787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291121246294
                                         uncertainty =       0.001797317787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381526133
  error estimate for blocks of size 2^( 2) =       0.000396256779
  error estimate for blocks of size 2^( 3) =       0.000410102518
  error estimate for blocks of size 2^( 4) =       0.000419402478
  error estimate for blocks of size 2^( 5) =       0.000424892481
  error estimate for blocks of size 2^( 6) =       0.000428095174
  error estimate for blocks of size 2^( 7) =       0.000429629585

      target function =      -0.913972268308
              le_mean =     -17.206769207074
             les_mean =     296.372116438619
             stat err =       0.000425504929
             autocorr =       1.243828801350
   target nu stat err =       0.000425504929
   target dn stat err =       0.002201226018
      target stat err =       0.003484783578
              std dev =       0.539559432308
             le_variance =       0.291124380993


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913972268308        initial
     1.3878e+09     1.3878e+10             3.9624e-13        -0.913972268308  <--
     5.5511e+09     5.5511e+10             9.8840e-14        -0.913972268308
     2.2204e+10     2.2204e+11             2.4262e-14        -0.913972268308

*****************************************************************************
Applying the update for shift_i =   1.3878e+09     and shift_s =   1.3878e+10
*****************************************************************************

  Execution time = 5.3483e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0218e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2444
    reference variance = 0.282061
====================================================
  Execution time = 3.7938e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5434e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9609e-01
  Total weights = 1.973693056e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0865e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289322012057
                                         uncertainty =       0.001477331907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289322012057
                                         uncertainty =       0.001477331907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380321738
  error estimate for blocks of size 2^( 2) =       0.000395141482
  error estimate for blocks of size 2^( 3) =       0.000408668674
  error estimate for blocks of size 2^( 4) =       0.000418290648
  error estimate for blocks of size 2^( 5) =       0.000424520695
  error estimate for blocks of size 2^( 6) =       0.000426662491
  error estimate for blocks of size 2^( 7) =       0.000427936758

      target function =      -0.918831609422
              le_mean =     -17.207119009732
             les_mean =     296.381032080687
             stat err =       0.000424352648
             autocorr =       1.244948926767
   target nu stat err =       0.000424352648
   target dn stat err =       0.001920008552
      target stat err =       0.003093229996
              std dev =       0.537856160305
             le_variance =       0.289289249178


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720711900973e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+08, overlap shift 3.4694e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918840991800       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918840991800       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918840991800       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918840991800       residual = 8.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918841210819       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918840991800       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918840797083       residual = 6.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918840552348       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918841548838       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918840949224       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918841558732       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918841054602       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918839948710       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918840994649       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918841314333       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918841348644       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918840929733       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918840991800       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918841595087       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918841074416       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918840744497       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918840179601       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918839996048       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918840544136       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918841258078       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918839897652       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918840573114       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918840501237       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918841750455       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918840831327       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918841388962       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918840177376       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918840684839       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918839901823       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918840097375       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918839219325       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.4694e+08 is 1.201080e-12

solving harmonic davidson linear method for identity shift 1.3878e+09, overlap shift 1.3878e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918840991800       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918840991800       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918840991800       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918840991800       residual = 8.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918842007329       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918840991800       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918842934279       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918842017414       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918843401995       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918840410906       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918845673682       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918840338845       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918846257634       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918839977005       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918843575242       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918838715182       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918842523951       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918839739476       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918843481323       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918837601912       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918838845079       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918835007784       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918838020226       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918839685732       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918839705551       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918841791728       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918842344783       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918839194870       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918842620115       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918840705163       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918838202164       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918842635967       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918849128530       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918834744796       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918842296883       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918839528417       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3878e+09 is 2.999316e-13

solving harmonic davidson linear method for identity shift 5.5511e+09, overlap shift 5.5511e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918840991800       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918840991800       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918840991800       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918840991800       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918840991800       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918840991800       residual = 7.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918840991800       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918834575271       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918831887512       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918822303541       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918838316409       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918840991800       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918831788749       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918840991800       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918840991800       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918847974519       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918861274736       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918838675157       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918853228605       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918843666027       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918822070324       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918838603506       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918829836130       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918847489035       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918838341843       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918856834346       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918840848987       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918820681404       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918831805939       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918802419954       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918847759229       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918880855097       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918830883236       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918828237599       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918834285004       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918849835091       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918845402849       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918858351130       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.918809295547       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.918864078828       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.918812606553       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.918826565519       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.918871406285       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.918826247009       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.918857766089       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.918814351212       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.918886619506       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.918839112631       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.918783605123       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.918823409962       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.918791336605       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.918985916016       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.918730772276       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.918602967467       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.918692112497       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.918596464423       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.919030146014       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.919024457895       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.919068387397       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.918939207847       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.919490143684       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.919148760413       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.917977865605       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.918671616090       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.918650209448       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.918893139898       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.919342305832       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.917627631762       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.919363518529       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.920465064882       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.918460456662       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   71 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.5511e+09 is 7.404536e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.345658 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8972e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1457
    reference variance = 0.287896
====================================================
  Execution time = 3.7410e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9792e-01
  Total weights = 1.9738e+06
  Execution time = 3.1490e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288169780123
                                         uncertainty =       0.001751357090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288169780123
                                         uncertainty =       0.001751357090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379593584
  error estimate for blocks of size 2^( 2) =       0.000394508701
  error estimate for blocks of size 2^( 3) =       0.000408031047
  error estimate for blocks of size 2^( 4) =       0.000416856145
  error estimate for blocks of size 2^( 5) =       0.000422510866
  error estimate for blocks of size 2^( 6) =       0.000425428380
  error estimate for blocks of size 2^( 7) =       0.000427508222

      target function =      -0.915949984918
              le_mean =     -17.206848229942
             les_mean =     296.373543715474
             stat err =       0.000423075903
             autocorr =       1.242220966647
   target nu stat err =       0.000423075903
   target dn stat err =       0.003849304840
      target stat err =       0.006031830931
              std dev =       0.536826394035
             le_variance =       0.288182577333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288169780123
                                         uncertainty =       0.001751357090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288169780123
                                         uncertainty =       0.001751357090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379593584
  error estimate for blocks of size 2^( 2) =       0.000394508701
  error estimate for blocks of size 2^( 3) =       0.000408031047
  error estimate for blocks of size 2^( 4) =       0.000416856145
  error estimate for blocks of size 2^( 5) =       0.000422510866
  error estimate for blocks of size 2^( 6) =       0.000425428380
  error estimate for blocks of size 2^( 7) =       0.000427508222

      target function =      -0.915949984919
              le_mean =     -17.206848229942
             les_mean =     296.373543715473
             stat err =       0.000423075903
             autocorr =       1.242220966640
   target nu stat err =       0.000423075903
   target dn stat err =       0.003849304840
      target stat err =       0.006031830930
              std dev =       0.536826394035
             le_variance =       0.288182577333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288169780123
                                         uncertainty =       0.001751357090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288169780123
                                         uncertainty =       0.001751357090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379593584
  error estimate for blocks of size 2^( 2) =       0.000394508701
  error estimate for blocks of size 2^( 3) =       0.000408031047
  error estimate for blocks of size 2^( 4) =       0.000416856145
  error estimate for blocks of size 2^( 5) =       0.000422510866
  error estimate for blocks of size 2^( 6) =       0.000425428380
  error estimate for blocks of size 2^( 7) =       0.000427508222

      target function =      -0.915949984919
              le_mean =     -17.206848229942
             les_mean =     296.373543715474
             stat err =       0.000423075903
             autocorr =       1.242220966639
   target nu stat err =       0.000423075903
   target dn stat err =       0.003849304840
      target stat err =       0.006031830930
              std dev =       0.536826394035
             le_variance =       0.288182577333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288169780123
                                         uncertainty =       0.001751357090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288169780123
                                         uncertainty =       0.001751357090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379593584
  error estimate for blocks of size 2^( 2) =       0.000394508701
  error estimate for blocks of size 2^( 3) =       0.000408031047
  error estimate for blocks of size 2^( 4) =       0.000416856145
  error estimate for blocks of size 2^( 5) =       0.000422510866
  error estimate for blocks of size 2^( 6) =       0.000425428380
  error estimate for blocks of size 2^( 7) =       0.000427508222

      target function =      -0.915949984918
              le_mean =     -17.206848229942
             les_mean =     296.373543715474
             stat err =       0.000423075903
             autocorr =       1.242220966647
   target nu stat err =       0.000423075903
   target dn stat err =       0.003849304840
      target stat err =       0.006031830931
              std dev =       0.536826394035
             le_variance =       0.288182577333


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915949984918        initial
     3.4694e+08     3.4694e+09             1.2011e-12        -0.915949984919  <--
     1.3878e+09     1.3878e+10             2.9993e-13        -0.915949984919
     5.5511e+09     5.5511e+10             7.4045e-14        -0.915949984918

*****************************************************************************
Applying the update for shift_i =   3.4694e+08     and shift_s =   3.4694e+09
*****************************************************************************

  Execution time = 5.3209e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0219e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.1763
    reference variance = 0.306598
====================================================
  Execution time = 3.9020e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5431e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0059e-01
  Total weights = 1.973713215e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0655e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292290561715
                                         uncertainty =       0.002053945862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292290561715
                                         uncertainty =       0.002053945862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382273408
  error estimate for blocks of size 2^( 2) =       0.000396937389
  error estimate for blocks of size 2^( 3) =       0.000410313504
  error estimate for blocks of size 2^( 4) =       0.000420174237
  error estimate for blocks of size 2^( 5) =       0.000425594539
  error estimate for blocks of size 2^( 6) =       0.000428770295
  error estimate for blocks of size 2^( 7) =       0.000432094082

      target function =      -0.911829430463
              le_mean =     -17.206785140320
             les_mean =     296.374049767503
             stat err =       0.000426658288
             autocorr =       1.245696360002
   target nu stat err =       0.000426658288
   target dn stat err =       0.002380171476
      target stat err =       0.003739608483
              std dev =       0.540616238756
             le_variance =       0.292265917607


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720678514032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+07, overlap shift 8.6736e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911843886769       residual = 5.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911843886769       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911843886769       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911843886769       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911843886769       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911843963899       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911843886769       residual = 9.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911843737450       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911843886769       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911843886769       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911844256867       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911843886769       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911844035054       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911844075653       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911843712546       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911843933199       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911843958621       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911843930531       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911843735984       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911843915694       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911843630894       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911843998840       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911843622341       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911843799288       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911844276724       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911844128203       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911844187104       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911844129540       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911843805046       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911843894633       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911843613519       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911843424044       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911844143655       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911844003820       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911843923331       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911843916336       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+07 is 6.063917e-12

solving harmonic davidson linear method for identity shift 3.4694e+08, overlap shift 3.4694e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911843886769       residual = 5.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911843886769       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911843886769       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911843888742       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911844226181       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911844126626       residual = 9.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911843337694       residual = 9.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911843886769       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911843530289       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911844625984       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911844362315       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911844236444       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911843886769       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911844058168       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911842716346       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911843886769       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911843916232       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911844317437       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911844481588       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911844147174       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911845541468       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911843706215       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911845362877       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911844913990       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911842623955       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911844446299       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911844398365       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911842318889       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911842414177       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911843441248       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911842085897       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911844964841       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911843982178       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911844025227       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911843580449       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911844942441       residual = 9.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.4694e+08 is 1.515949e-12

solving harmonic davidson linear method for identity shift 1.3878e+09, overlap shift 1.3878e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911843886769       residual = 5.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911843886769       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911843886769       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911843886769       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911843886769       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911843886769       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911842865408       residual = 9.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911843886769       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911843886769       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911842193523       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911843172350       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911841192075       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911841981893       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911841101301       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911841905535       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911845231628       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911846573067       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911849719676       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911843573262       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911843886769       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911843498759       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911845720925       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911839276458       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911844416492       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911846235437       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911848856191       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911851059544       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911839741685       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911842880738       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911842813132       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911843738177       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911838667025       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911840327160       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911841623432       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911844539435       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911846869804       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911842176605       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911846024991       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3878e+09 is 3.794789e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.397829 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9735e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2625
    reference variance = 0.234283
====================================================
  Execution time = 3.7592e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0218e-01
  Total weights = 1.9737e+06
  Execution time = 3.1465e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294425474334
                                         uncertainty =       0.003552074723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294425474334
                                         uncertainty =       0.003552074723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383647289
  error estimate for blocks of size 2^( 2) =       0.000398391295
  error estimate for blocks of size 2^( 3) =       0.000411950502
  error estimate for blocks of size 2^( 4) =       0.000421273888
  error estimate for blocks of size 2^( 5) =       0.000427553528
  error estimate for blocks of size 2^( 6) =       0.000430916212
  error estimate for blocks of size 2^( 7) =       0.000433580612

      target function =      -0.909361786275
              le_mean =     -17.207116995699
             les_mean =     296.387055005309
             stat err =       0.000428331060
             autocorr =       1.246507419099
   target nu stat err =       0.000428331060
   target dn stat err =       0.003689688198
      target stat err =       0.005706988174
              std dev =       0.542559199968
             le_variance =       0.294370485470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294425474333
                                         uncertainty =       0.003552074723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294425474333
                                         uncertainty =       0.003552074723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383647289
  error estimate for blocks of size 2^( 2) =       0.000398391295
  error estimate for blocks of size 2^( 3) =       0.000411950502
  error estimate for blocks of size 2^( 4) =       0.000421273888
  error estimate for blocks of size 2^( 5) =       0.000427553528
  error estimate for blocks of size 2^( 6) =       0.000430916212
  error estimate for blocks of size 2^( 7) =       0.000433580612

      target function =      -0.909361786276
              le_mean =     -17.207116995699
             les_mean =     296.387055005308
             stat err =       0.000428331060
             autocorr =       1.246507419101
   target nu stat err =       0.000428331060
   target dn stat err =       0.003689688198
      target stat err =       0.005706988173
              std dev =       0.542559199968
             le_variance =       0.294370485470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294425474334
                                         uncertainty =       0.003552074723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294425474334
                                         uncertainty =       0.003552074723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383647289
  error estimate for blocks of size 2^( 2) =       0.000398391295
  error estimate for blocks of size 2^( 3) =       0.000411950502
  error estimate for blocks of size 2^( 4) =       0.000421273888
  error estimate for blocks of size 2^( 5) =       0.000427553528
  error estimate for blocks of size 2^( 6) =       0.000430916212
  error estimate for blocks of size 2^( 7) =       0.000433580612

      target function =      -0.909361786275
              le_mean =     -17.207116995699
             les_mean =     296.387055005308
             stat err =       0.000428331060
             autocorr =       1.246507419101
   target nu stat err =       0.000428331060
   target dn stat err =       0.003689688198
      target stat err =       0.005706988174
              std dev =       0.542559199968
             le_variance =       0.294370485470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294425474334
                                         uncertainty =       0.003552074723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294425474334
                                         uncertainty =       0.003552074723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383647289
  error estimate for blocks of size 2^( 2) =       0.000398391295
  error estimate for blocks of size 2^( 3) =       0.000411950502
  error estimate for blocks of size 2^( 4) =       0.000421273888
  error estimate for blocks of size 2^( 5) =       0.000427553528
  error estimate for blocks of size 2^( 6) =       0.000430916212
  error estimate for blocks of size 2^( 7) =       0.000433580612

      target function =      -0.909361786275
              le_mean =     -17.207116995699
             les_mean =     296.387055005309
             stat err =       0.000428331060
             autocorr =       1.246507419093
   target nu stat err =       0.000428331060
   target dn stat err =       0.003689688198
      target stat err =       0.005706988174
              std dev =       0.542559199968
             le_variance =       0.294370485470


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909361786275        initial
     8.6736e+07     8.6736e+08             6.0639e-12        -0.909361786276  <--
     3.4694e+08     3.4694e+09             1.5159e-12        -0.909361786275
     1.3878e+09     1.3878e+10             3.7948e-13        -0.909361786275

*****************************************************************************
Applying the update for shift_i =   8.6736e+07     and shift_s =   8.6736e+08
*****************************************************************************

  Execution time = 5.3463e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0320e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2346
    reference variance = 0.222219
====================================================
  Execution time = 3.7623e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5430e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9933e-01
  Total weights = 1.973541649e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0788e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287791507538
                                         uncertainty =       0.001511582828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287791507538
                                         uncertainty =       0.001511582828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379343713
  error estimate for blocks of size 2^( 2) =       0.000394190834
  error estimate for blocks of size 2^( 3) =       0.000407704022
  error estimate for blocks of size 2^( 4) =       0.000417161738
  error estimate for blocks of size 2^( 5) =       0.000423646610
  error estimate for blocks of size 2^( 6) =       0.000428818985
  error estimate for blocks of size 2^( 7) =       0.000431260355

      target function =      -0.913691105233
              le_mean =     -17.207372109177
             les_mean =     296.392981880217
             stat err =       0.000425221922
             autocorr =       1.256508731751
   target nu stat err =       0.000425221922
   target dn stat err =       0.006096725321
      target stat err =       0.009476016494
              std dev =       0.536473023837
             le_variance =       0.287803305305


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720737210918e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+07, overlap shift 2.1684e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913788006197       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913788006200       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913788006200       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913788006201       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913787995309       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913787993821       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913788045581       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913788001250       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913788032601       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913787982251       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913788018484       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913788010521       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913787996219       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913788028479       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913788018855       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913788059206       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913788051633       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913788036172       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913788022230       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913787939768       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913788040492       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913787964168       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913787982328       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913788003934       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913788015799       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913788061739       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913788031000       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913788020711       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913787924584       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913788001929       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913787937963       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913788010910       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913787899514       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913787981110       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913787960807       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913787948891       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913788005830       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913787962000       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913787952763       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+07 is 3.172400e-11

solving harmonic davidson linear method for identity shift 8.6736e+07, overlap shift 8.6736e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913788006197       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913788006197       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913788006198       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913788006198       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913788031845       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913788008432       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913787928800       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913787853215       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913788116269       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913787886443       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913788068528       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913788062029       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913788034650       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913787862524       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913787952998       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913787996893       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913788105035       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913788084600       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913788034039       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913787719378       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913787705389       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913788121338       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913788268336       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913787710950       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913787730332       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913788225151       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913787806155       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913787981202       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913788065923       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913788210152       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913787983665       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913787814140       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913787985813       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913788270731       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913787571425       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913788096704       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913787778225       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913787671589       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913787667445       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+07 is 7.931047e-12

solving harmonic davidson linear method for identity shift 3.4694e+08, overlap shift 3.4694e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913788006197       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913788006197       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913788006197       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913788006197       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913788006197       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913787973243       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913788391858       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913788406117       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913788468063       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913788088496       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913787401080       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913788728614       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913787372996       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913787678993       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913788284322       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913787608005       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913787946367       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913787850866       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913788027145       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913788435821       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913787365096       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913787947427       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913786890584       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913788993757       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913787216501       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913788060495       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913788244373       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913786210915       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913788412001       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913787763659       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913788469560       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913788517589       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913786751737       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913787128411       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913789424231       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913789456523       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913787875166       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913789739787       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913788526850       residual = 6.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.4694e+08 is 1.982769e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.459742 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8480e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.1765
    reference variance = 0.201774
====================================================
  Execution time = 3.7361e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0167e-01
  Total weights = 1.9736e+06
  Execution time = 3.1549e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292066495336
                                         uncertainty =       0.001882310737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292066495336
                                         uncertainty =       0.001882310737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382134541
  error estimate for blocks of size 2^( 2) =       0.000396790277
  error estimate for blocks of size 2^( 3) =       0.000410493118
  error estimate for blocks of size 2^( 4) =       0.000420008382
  error estimate for blocks of size 2^( 5) =       0.000425909504
  error estimate for blocks of size 2^( 6) =       0.000427683257
  error estimate for blocks of size 2^( 7) =       0.000431307510

      target function =      -0.910156663563
              le_mean =     -17.207134519118
             les_mean =     296.387151922847
             stat err =       0.000426227163
             autocorr =       1.244083863776
   target nu stat err =       0.000426227163
   target dn stat err =       0.002544467722
      target stat err =       0.003976508554
              std dev =       0.540419850495
             le_variance =       0.292053614809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292066495335
                                         uncertainty =       0.001882310737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292066495335
                                         uncertainty =       0.001882310737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382134541
  error estimate for blocks of size 2^( 2) =       0.000396790277
  error estimate for blocks of size 2^( 3) =       0.000410493118
  error estimate for blocks of size 2^( 4) =       0.000420008382
  error estimate for blocks of size 2^( 5) =       0.000425909504
  error estimate for blocks of size 2^( 6) =       0.000427683257
  error estimate for blocks of size 2^( 7) =       0.000431307510

      target function =      -0.910156663667
              le_mean =     -17.207134519118
             les_mean =     296.387151922783
             stat err =       0.000426227163
             autocorr =       1.244083863806
   target nu stat err =       0.000426227163
   target dn stat err =       0.002544467719
      target stat err =       0.003976508550
              std dev =       0.540419850494
             le_variance =       0.292053614808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292066495336
                                         uncertainty =       0.001882310737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292066495336
                                         uncertainty =       0.001882310737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382134541
  error estimate for blocks of size 2^( 2) =       0.000396790277
  error estimate for blocks of size 2^( 3) =       0.000410493118
  error estimate for blocks of size 2^( 4) =       0.000420008382
  error estimate for blocks of size 2^( 5) =       0.000425909504
  error estimate for blocks of size 2^( 6) =       0.000427683257
  error estimate for blocks of size 2^( 7) =       0.000431307510

      target function =      -0.910156663615
              le_mean =     -17.207134519118
             les_mean =     296.387151922815
             stat err =       0.000426227163
             autocorr =       1.244083863787
   target nu stat err =       0.000426227163
   target dn stat err =       0.002544467721
      target stat err =       0.003976508552
              std dev =       0.540419850495
             le_variance =       0.292053614809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292066495336
                                         uncertainty =       0.001882310737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292066495336
                                         uncertainty =       0.001882310737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382134541
  error estimate for blocks of size 2^( 2) =       0.000396790277
  error estimate for blocks of size 2^( 3) =       0.000410493118
  error estimate for blocks of size 2^( 4) =       0.000420008382
  error estimate for blocks of size 2^( 5) =       0.000425909504
  error estimate for blocks of size 2^( 6) =       0.000427683257
  error estimate for blocks of size 2^( 7) =       0.000431307510

      target function =      -0.910156663569
              le_mean =     -17.207134519118
             les_mean =     296.387151922843
             stat err =       0.000426227163
             autocorr =       1.244083863778
   target nu stat err =       0.000426227163
   target dn stat err =       0.002544467722
      target stat err =       0.003976508554
              std dev =       0.540419850495
             le_variance =       0.292053614809


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910156663563        initial
     2.1684e+07     2.1684e+08             3.1724e-11        -0.910156663667  <--
     8.6736e+07     8.6736e+08             7.9310e-12        -0.910156663615
     3.4694e+08     3.4694e+09             1.9828e-12        -0.910156663569

*****************************************************************************
Applying the update for shift_i =   2.1684e+07     and shift_s =   2.1684e+08
*****************************************************************************

  Execution time = 5.3195e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0168e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.1834
    reference variance = 0.215693
====================================================
  Execution time = 3.7775e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5415e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0011e-01
  Total weights = 1.973579097e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0706e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293312761701
                                         uncertainty =       0.002960981091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293312761701
                                         uncertainty =       0.002960981091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382938501
  error estimate for blocks of size 2^( 2) =       0.000397488104
  error estimate for blocks of size 2^( 3) =       0.000410908659
  error estimate for blocks of size 2^( 4) =       0.000420899599
  error estimate for blocks of size 2^( 5) =       0.000427295142
  error estimate for blocks of size 2^( 6) =       0.000431630890
  error estimate for blocks of size 2^( 7) =       0.000434071655

      target function =      -0.912559401217
              le_mean =     -17.206792495450
             les_mean =     296.373822288774
             stat err =       0.000428474321
             autocorr =       1.251963114536
   target nu stat err =       0.000428474321
   target dn stat err =       0.003188826037
      target stat err =       0.004977125849
              std dev =       0.541556821211
             le_variance =       0.293283790600


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720679249545e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+06, overlap shift 5.4210e+07 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912585214004       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912585214012       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912585214014       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912585214014       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912585213888       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912585219738       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912585195801       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912585218507       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912585213412       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912585217132       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912585221924       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912585204848       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912585217391       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912585219810       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912585223819       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912585214857       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912585218667       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912585231649       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912585211786       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912585223298       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912585222998       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912585195191       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912585232794       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912585226869       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912585196351       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912585204923       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912585196981       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912585190298       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912585215102       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912585201972       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912585214979       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912585206446       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912585221200       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912585188448       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912585199969       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912585226202       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912585205261       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+06 is 1.152078e-10

solving harmonic davidson linear method for identity shift 2.1684e+07, overlap shift 2.1684e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912585214004       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912585214006       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912585214007       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912585214007       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912585214007       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912585216917       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912585202655       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912585210174       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912585217530       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912585195509       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912585182161       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912585179238       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912585253550       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912585240899       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912585201921       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912585199215       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912585204458       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912585222932       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912585217582       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912585229888       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912585162216       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912585212488       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912585180672       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912585184942       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912585206453       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912585268586       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912585177202       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912585218991       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912585223598       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912585220378       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912585226765       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912585217123       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912585218703       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912585247981       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912585226140       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912585229900       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912585192457       residual = 7.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+07 is 2.880170e-11

solving harmonic davidson linear method for identity shift 8.6736e+07, overlap shift 8.6736e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912585214004       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912585214005       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912585214005       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912585172893       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912585217346       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912585214005       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912585244003       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912585295839       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912584984352       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912585282096       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912585204587       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912585175129       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912585101023       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912585180703       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912585159405       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912585237649       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912585346428       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912585085036       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912585321010       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912585292111       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912585372727       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912585228339       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912585473185       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912585125314       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912585508514       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912585407888       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912584886848       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912584745735       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912585256830       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912585099227       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912584970861       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912585325975       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912585353500       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912585187310       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912585299594       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912585057468       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912585179178       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+07 is 7.200179e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.513167 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8541e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2761
    reference variance = 0.358165
====================================================
  Execution time = 3.7873e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0096e-01
  Total weights = 1.9739e+06
  Execution time = 3.1540e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292614360405
                                         uncertainty =       0.002207735291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292614360405
                                         uncertainty =       0.002207735291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382505117
  error estimate for blocks of size 2^( 2) =       0.000397282027
  error estimate for blocks of size 2^( 3) =       0.000411220367
  error estimate for blocks of size 2^( 4) =       0.000421293571
  error estimate for blocks of size 2^( 5) =       0.000426854219
  error estimate for blocks of size 2^( 6) =       0.000429491288
  error estimate for blocks of size 2^( 7) =       0.000431028597

      target function =      -0.911254544637
              le_mean =     -17.206974251789
             les_mean =     296.380922612471
             stat err =       0.000427166919
             autocorr =       1.247155842224
   target nu stat err =       0.000427166919
   target dn stat err =       0.002926474341
      target stat err =       0.004564970126
              std dev =       0.540943924123
             le_variance =       0.292620329046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292614360404
                                         uncertainty =       0.002207735292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292614360404
                                         uncertainty =       0.002207735292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382505117
  error estimate for blocks of size 2^( 2) =       0.000397282027
  error estimate for blocks of size 2^( 3) =       0.000411220367
  error estimate for blocks of size 2^( 4) =       0.000421293571
  error estimate for blocks of size 2^( 5) =       0.000426854219
  error estimate for blocks of size 2^( 6) =       0.000429491288
  error estimate for blocks of size 2^( 7) =       0.000431028597

      target function =      -0.911254544399
              le_mean =     -17.206974251789
             les_mean =     296.380922612623
             stat err =       0.000427166919
             autocorr =       1.247155842344
   target nu stat err =       0.000427166919
   target dn stat err =       0.002926474357
      target stat err =       0.004564970149
              std dev =       0.540943924122
             le_variance =       0.292620329045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292614360405
                                         uncertainty =       0.002207735291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292614360405
                                         uncertainty =       0.002207735291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382505117
  error estimate for blocks of size 2^( 2) =       0.000397282027
  error estimate for blocks of size 2^( 3) =       0.000411220367
  error estimate for blocks of size 2^( 4) =       0.000421293571
  error estimate for blocks of size 2^( 5) =       0.000426854219
  error estimate for blocks of size 2^( 6) =       0.000429491288
  error estimate for blocks of size 2^( 7) =       0.000431028597

      target function =      -0.911254544518
              le_mean =     -17.206974251789
             les_mean =     296.380922612547
             stat err =       0.000427166919
             autocorr =       1.247155842280
   target nu stat err =       0.000427166919
   target dn stat err =       0.002926474349
      target stat err =       0.004564970137
              std dev =       0.540943924123
             le_variance =       0.292620329045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292614360405
                                         uncertainty =       0.002207735291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292614360405
                                         uncertainty =       0.002207735291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382505117
  error estimate for blocks of size 2^( 2) =       0.000397282027
  error estimate for blocks of size 2^( 3) =       0.000411220367
  error estimate for blocks of size 2^( 4) =       0.000421293571
  error estimate for blocks of size 2^( 5) =       0.000426854219
  error estimate for blocks of size 2^( 6) =       0.000429491288
  error estimate for blocks of size 2^( 7) =       0.000431028597

      target function =      -0.911254544622
              le_mean =     -17.206974251789
             les_mean =     296.380922612480
             stat err =       0.000427166919
             autocorr =       1.247155842227
   target nu stat err =       0.000427166919
   target dn stat err =       0.002926474342
      target stat err =       0.004564970127
              std dev =       0.540943924123
             le_variance =       0.292620329046


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911254544637        initial  <--
     5.4210e+06     5.4210e+07             1.1521e-10        -0.911254544399
     2.1684e+07     2.1684e+08             2.8802e-11        -0.911254544518
     8.6736e+07     8.6736e+08             7.2002e-12        -0.911254544622

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7252
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0227e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.1974
    reference variance = 0.364603
====================================================
  Execution time = 3.9173e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5418e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9405e-01
  Total weights = 1.973751166e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1033e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287796480914
                                         uncertainty =       0.001531223657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287796480914
                                         uncertainty =       0.001531223657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379381622
  error estimate for blocks of size 2^( 2) =       0.000393873537
  error estimate for blocks of size 2^( 3) =       0.000407168232
  error estimate for blocks of size 2^( 4) =       0.000417705293
  error estimate for blocks of size 2^( 5) =       0.000424567594
  error estimate for blocks of size 2^( 6) =       0.000426743587
  error estimate for blocks of size 2^( 7) =       0.000430806197

      target function =      -0.922030705869
              le_mean =     -17.206675164682
             les_mean =     296.363725072439
             stat err =       0.000424955668
             autocorr =       1.254684905855
   target nu stat err =       0.000424955668
   target dn stat err =       0.001933516561
      target stat err =       0.003132599688
              std dev =       0.536526635335
             le_variance =       0.287860830424


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720667516468e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+07, overlap shift 5.4210e+08 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922040220250       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922040220250       residual = 8.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922040220250       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922040220250       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922040219965       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922040193098       residual = 6.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922040281873       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922040143812       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922040135628       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922040272100       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922040191074       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922040195149       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922040084574       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922040189513       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922040139059       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922040208433       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922040139072       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922040265591       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922040240965       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922040222919       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922040092811       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922040234229       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922040165263       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922040186312       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922040268613       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.922040265676       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.922040229406       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.922040086156       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.922040176921       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.922040110636       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.922040217550       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.922040323353       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.922040191957       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.922040294359       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.922040132592       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+07 is 9.531501e-12

solving harmonic davidson linear method for identity shift 2.1684e+08, overlap shift 2.1684e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922040220250       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922040220250       residual = 8.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922040220250       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922040220250       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922040220250       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922040220255       residual = 6.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922040341392       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922040409742       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922039837308       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922040527863       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922040326281       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922040386915       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922040206390       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922040487310       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922040507715       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922039524967       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922040507727       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922040997782       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922040055452       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922039135913       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922040248801       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922039446503       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922040011388       residual = 9.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922039900699       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922040553429       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.922041002627       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.922040282765       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.922039688225       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.922040561803       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.922040096570       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.922040252793       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.922040022077       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.922039544451       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.922040434086       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.922040501069       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+08 is 2.382701e-12

solving harmonic davidson linear method for identity shift 8.6736e+08, overlap shift 8.6736e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922040220250       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922040220250       residual = 8.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922040220250       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922040220254       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922040220813       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922039437707       residual = 6.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922038658172       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922039371884       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922039313350       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922039945469       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922039937722       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922038849037       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922040188592       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922040609670       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922039974765       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922041398028       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922038552695       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922041485218       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922040227700       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922037400058       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922039387909       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922038335623       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922039464643       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922041586726       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922039824160       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.922040468175       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.922039675049       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.922037768852       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.922042002108       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.922039475066       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.922040080882       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.922041150777       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.922039331915       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.922042128522       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.922039370891       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+08 is 5.960070e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.559259 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0259e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.1693
    reference variance = 0.285689
====================================================
  Execution time = 3.7263e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0354e-01
  Total weights = 1.9739e+06
  Execution time = 3.1214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296174440226
                                         uncertainty =       0.003230793889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296174440226
                                         uncertainty =       0.003230793889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384769479
  error estimate for blocks of size 2^( 2) =       0.000399527481
  error estimate for blocks of size 2^( 3) =       0.000413208880
  error estimate for blocks of size 2^( 4) =       0.000423999646
  error estimate for blocks of size 2^( 5) =       0.000430047726
  error estimate for blocks of size 2^( 6) =       0.000434601403
  error estimate for blocks of size 2^( 7) =       0.000436741833

      target function =      -0.907249048104
              le_mean =     -17.207279323975
             les_mean =     296.393997724252
             stat err =       0.000431347652
             autocorr =       1.256763754052
   target nu stat err =       0.000431347652
   target dn stat err =       0.005027624300
      target stat err =       0.007714861793
              std dev =       0.544146215057
             le_variance =       0.296095103361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296174440225
                                         uncertainty =       0.003230793889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296174440225
                                         uncertainty =       0.003230793889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384769479
  error estimate for blocks of size 2^( 2) =       0.000399527481
  error estimate for blocks of size 2^( 3) =       0.000413208880
  error estimate for blocks of size 2^( 4) =       0.000423999646
  error estimate for blocks of size 2^( 5) =       0.000430047726
  error estimate for blocks of size 2^( 6) =       0.000434601403
  error estimate for blocks of size 2^( 7) =       0.000436741833

      target function =      -0.907249048103
              le_mean =     -17.207279323975
             les_mean =     296.393997724253
             stat err =       0.000431347652
             autocorr =       1.256763754055
   target nu stat err =       0.000431347652
   target dn stat err =       0.005027624300
      target stat err =       0.007714861793
              std dev =       0.544146215056
             le_variance =       0.296095103360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296174440226
                                         uncertainty =       0.003230793889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296174440226
                                         uncertainty =       0.003230793889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384769479
  error estimate for blocks of size 2^( 2) =       0.000399527481
  error estimate for blocks of size 2^( 3) =       0.000413208880
  error estimate for blocks of size 2^( 4) =       0.000423999646
  error estimate for blocks of size 2^( 5) =       0.000430047726
  error estimate for blocks of size 2^( 6) =       0.000434601403
  error estimate for blocks of size 2^( 7) =       0.000436741833

      target function =      -0.907249048104
              le_mean =     -17.207279323975
             les_mean =     296.393997724252
             stat err =       0.000431347652
             autocorr =       1.256763754057
   target nu stat err =       0.000431347652
   target dn stat err =       0.005027624300
      target stat err =       0.007714861793
              std dev =       0.544146215057
             le_variance =       0.296095103360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296174440226
                                         uncertainty =       0.003230793889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296174440226
                                         uncertainty =       0.003230793889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384769479
  error estimate for blocks of size 2^( 2) =       0.000399527481
  error estimate for blocks of size 2^( 3) =       0.000413208880
  error estimate for blocks of size 2^( 4) =       0.000423999646
  error estimate for blocks of size 2^( 5) =       0.000430047726
  error estimate for blocks of size 2^( 6) =       0.000434601403
  error estimate for blocks of size 2^( 7) =       0.000436741833

      target function =      -0.907249048104
              le_mean =     -17.207279323975
             les_mean =     296.393997724252
             stat err =       0.000431347652
             autocorr =       1.256763754056
   target nu stat err =       0.000431347652
   target dn stat err =       0.005027624300
      target stat err =       0.007714861793
              std dev =       0.544146215057
             le_variance =       0.296095103361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907249048104        initial  <--
     5.4210e+07     5.4210e+08             9.5315e-12        -0.907249048103
     2.1684e+08     2.1684e+09             2.3827e-12        -0.907249048104
     8.6736e+08     8.6736e+09             5.9601e-13        -0.907249048104

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.0189
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0328e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2059
    reference variance = 0.341169
====================================================
  Execution time = 3.7788e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5416e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0059e-01
  Total weights = 1.973635774e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0817e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288828377430
                                         uncertainty =       0.001693372660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288828377430
                                         uncertainty =       0.001693372660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380025724
  error estimate for blocks of size 2^( 2) =       0.000394904421
  error estimate for blocks of size 2^( 3) =       0.000408462852
  error estimate for blocks of size 2^( 4) =       0.000418791871
  error estimate for blocks of size 2^( 5) =       0.000424916199
  error estimate for blocks of size 2^( 6) =       0.000428144875
  error estimate for blocks of size 2^( 7) =       0.000431589721

      target function =      -0.911782873569
              le_mean =     -17.207472276057
             les_mean =     296.397696919258
             stat err =       0.000425860666
             autocorr =       1.255767008173
   target nu stat err =       0.000425860666
   target dn stat err =       0.004005931816
      target stat err =       0.006225031609
              std dev =       0.537437532779
             le_variance =       0.288839101640


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720747227606e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+08, overlap shift 5.4210e+09 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911824207595       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911824207595       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911824207595       residual = 8.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911824207595       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911824207595       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911824207595       residual = 8.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911824773000       residual = 7.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911823001890       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911824207595       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911824605481       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911823956208       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911824207595       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911822813052       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911824852089       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911824966588       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911823238061       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911823307838       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911824077721       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911823851923       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911822057009       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911824535437       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911823775055       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911824634250       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911823647514       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911821057416       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911826080595       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911823520323       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911825578753       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911825773592       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911827907319       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911824662185       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911825820466       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911823236410       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911822689780       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911824607764       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911824415933       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911825402591       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911824655954       residual = 6.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+08 is 9.567424e-13

solving harmonic davidson linear method for identity shift 2.1684e+09, overlap shift 2.1684e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911824207595       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911824207595       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911824207595       residual = 8.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911824613606       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911824207595       residual = 9.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911824207595       residual = 8.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911822283171       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911817262562       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911824207595       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911824207595       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911820703882       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911827201533       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911818476085       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911822418202       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911821454331       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911823765810       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911827279920       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911824032417       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911828623578       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911826749883       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911826553102       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911827320458       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911820418445       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911823672304       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911826813898       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911824142003       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911824129029       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911817070938       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911824009217       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911824082499       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911828087188       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911823024686       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911824497291       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911820353615       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911828034524       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911833620353       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911822330734       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911822635477       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911825006739       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+09 is 2.397027e-13

solving harmonic davidson linear method for identity shift 8.6736e+09, overlap shift 8.6736e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911824207595       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911824207595       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911824207595       residual = 8.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911824580377       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911824240135       residual = 9.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911823487542       residual = 8.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911824390282       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911833549373       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911821646968       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911841088145       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911824207595       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911803202854       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911821015482       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911853899381       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911830016182       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911821120108       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911841060616       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911834639128       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911845680841       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911819497107       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911848797528       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911835705177       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911826744814       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911831035713       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911816817997       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911825037876       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911808294569       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911794572609       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911840971624       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911811690736       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911844628681       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911799652578       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911817218340       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911843248374       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911792585977       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911778587147       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911814515378       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911903759438       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911844161090       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.911791824867       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.911781824812       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.911878281172       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.911921345192       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.911826136173       residual = 9.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.911852597027       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.911768834166       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.911855399415       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.911924084773       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.911825037307       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.911910547039       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.911818857861       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.912048976402       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.911788383572       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.911922034452       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.911891585052       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.911823735312       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.911700817727       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.911716069969       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.911772355965       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.911989840312       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.911812132072       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.911392571036       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.910578885336       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.912589309324       residual = 8.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.911969297724       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.911079560521       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.910465241464       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.910175639493       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.911899257217       residual = 9.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.910283386024       residual = 7.31e-04           smallest_sin_value = 9.99e-01
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.911257368752       residual = 1.83e-04           smallest_sin_value = 9.98e-01
davidson iteration   71 stopping due to small subspace S singular value of 7.66e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+09 is 5.971409e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.727204 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8779e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2019
    reference variance = 0.238719
====================================================
  Execution time = 3.8313e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0082e-01
  Total weights = 1.9737e+06
  Execution time = 3.1347e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290405303481
                                         uncertainty =       0.001654305385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290405303481
                                         uncertainty =       0.001654305385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381045404
  error estimate for blocks of size 2^( 2) =       0.000395579149
  error estimate for blocks of size 2^( 3) =       0.000409703351
  error estimate for blocks of size 2^( 4) =       0.000419224436
  error estimate for blocks of size 2^( 5) =       0.000425443760
  error estimate for blocks of size 2^( 6) =       0.000428222080
  error estimate for blocks of size 2^( 7) =       0.000431280236

      target function =      -0.911453029029
              le_mean =     -17.206645763154
             les_mean =     296.369477561646
             stat err =       0.000426042628
             autocorr =       1.250122736093
   target nu stat err =       0.000426042628
   target dn stat err =       0.004374796120
      target stat err =       0.006775671940
              std dev =       0.538879578704
             le_variance =       0.290391200345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290405303481
                                         uncertainty =       0.001654305385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290405303481
                                         uncertainty =       0.001654305385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381045404
  error estimate for blocks of size 2^( 2) =       0.000395579149
  error estimate for blocks of size 2^( 3) =       0.000409703351
  error estimate for blocks of size 2^( 4) =       0.000419224436
  error estimate for blocks of size 2^( 5) =       0.000425443760
  error estimate for blocks of size 2^( 6) =       0.000428222080
  error estimate for blocks of size 2^( 7) =       0.000431280236

      target function =      -0.911453029028
              le_mean =     -17.206645763154
             les_mean =     296.369477561646
             stat err =       0.000426042628
             autocorr =       1.250122736104
   target nu stat err =       0.000426042628
   target dn stat err =       0.004374796121
      target stat err =       0.006775671940
              std dev =       0.538879578704
             le_variance =       0.290391200344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290405303481
                                         uncertainty =       0.001654305385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290405303481
                                         uncertainty =       0.001654305385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381045404
  error estimate for blocks of size 2^( 2) =       0.000395579149
  error estimate for blocks of size 2^( 3) =       0.000409703351
  error estimate for blocks of size 2^( 4) =       0.000419224436
  error estimate for blocks of size 2^( 5) =       0.000425443760
  error estimate for blocks of size 2^( 6) =       0.000428222080
  error estimate for blocks of size 2^( 7) =       0.000431280236

      target function =      -0.911453029029
              le_mean =     -17.206645763154
             les_mean =     296.369477561646
             stat err =       0.000426042628
             autocorr =       1.250122736095
   target nu stat err =       0.000426042628
   target dn stat err =       0.004374796120
      target stat err =       0.006775671940
              std dev =       0.538879578704
             le_variance =       0.290391200344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290405303481
                                         uncertainty =       0.001654305385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290405303481
                                         uncertainty =       0.001654305385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381045404
  error estimate for blocks of size 2^( 2) =       0.000395579149
  error estimate for blocks of size 2^( 3) =       0.000409703351
  error estimate for blocks of size 2^( 4) =       0.000419224436
  error estimate for blocks of size 2^( 5) =       0.000425443760
  error estimate for blocks of size 2^( 6) =       0.000428222080
  error estimate for blocks of size 2^( 7) =       0.000431280236

      target function =      -0.911453029029
              le_mean =     -17.206645763154
             les_mean =     296.369477561646
             stat err =       0.000426042628
             autocorr =       1.250122736094
   target nu stat err =       0.000426042628
   target dn stat err =       0.004374796120
      target stat err =       0.006775671940
              std dev =       0.538879578704
             le_variance =       0.290391200345


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911453029029        initial  <--
     5.4210e+08     5.4210e+09             9.5674e-13        -0.911453029028
     2.1684e+09     2.1684e+10             2.3970e-13        -0.911453029029
     8.6736e+09     8.6736e+10             5.9714e-14        -0.911453029029

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0658
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0285e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2247
    reference variance = 0.566283
====================================================
  Execution time = 3.7650e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5422e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.6415e-01
  Total weights = 1.973481472e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0762e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301893302552
                                         uncertainty =       0.011396229241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301893302552
                                         uncertainty =       0.011396229241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388542626
  error estimate for blocks of size 2^( 2) =       0.000403360662
  error estimate for blocks of size 2^( 3) =       0.000416174266
  error estimate for blocks of size 2^( 4) =       0.000426367565
  error estimate for blocks of size 2^( 5) =       0.000431590319
  error estimate for blocks of size 2^( 6) =       0.000434157618
  error estimate for blocks of size 2^( 7) =       0.000434963057

      target function =      -0.815856445950
              le_mean =     -17.206555845627
             les_mean =     296.429710737028
             stat err =       0.000431769640
             autocorr =       1.234885979079
   target nu stat err =       0.000431769640
   target dn stat err =       0.063043984176
      target stat err =       0.078497467468
              std dev =       0.549482251711
             le_variance =       0.301930744946


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720655584563e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+09, overlap shift 5.4210e+10 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.823413075795       residual = 9.92e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.823413075795       residual = 4.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.823413075795       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.823413075793       residual = 5.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.823411983163       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.823413811702       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.823411809375       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.823415671518       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.823411461680       residual = 8.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.823410871005       residual = 7.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.823415737496       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.823411327307       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.823413061259       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.823408970657       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.823417099167       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.823415422305       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.823409948907       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.823402004874       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.823419506290       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.823422732223       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.823412869171       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.823410994238       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.823397216873       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.823418043133       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.823419522742       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.823415187910       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.823412686904       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.823417747926       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.823415601595       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.823431202484       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.823410612727       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.823427126495       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.823403994818       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.823416451053       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.823383286672       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.823400896347       residual = 8.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.823419898188       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.823398036415       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.823406589996       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.823404175987       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.823411634216       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.823408785971       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.823414809835       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.823398869873       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.823432848339       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.823391111230       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.823382300816       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.823404074199       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.823402910810       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.823404850031       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.823441182773       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.823445329474       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.823389633231       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.823414560738       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.823400209672       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.823373215467       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.823323250457       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.823360503145       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.823309031495       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.823487558100       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.823360569393       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.823294550462       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.823254521340       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.823401536152       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.822889021273       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.823249534998       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.823543163102       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.823517597358       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.823402804850       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.824393490150       residual = 8.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.821505291292       residual = 3.76e-04           smallest_sin_value = 9.98e-01
davidson iteration   71 stopping due to small subspace S singular value of 8.88e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+09 is 4.603352e-13

solving harmonic davidson linear method for identity shift 2.1684e+10, overlap shift 2.1684e+11 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.823413075795       residual = 9.92e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.823413075795       residual = 4.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.823413075795       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.823413075795       residual = 5.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.823413075638       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.823414724432       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.823429094947       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.823395366839       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.823441628503       residual = 8.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.823388648350       residual = 7.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.823386914005       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.823407016911       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.823418884732       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.823410572937       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.823454975724       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.823412864030       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.823411264586       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.823433831300       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.823300203654       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.823474475205       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.823379225683       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.823388709219       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.823504676476       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.823345512063       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.823453122099       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.823379016656       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.823456459006       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.823415999504       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.823433672943       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.823460130892       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.823417291350       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.823468018188       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.823394607053       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.823426940513       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.823476184349       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.823382741167       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.823345994071       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.823454611353       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.823399456983       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.823307484753       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.823305553761       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.823369898688       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.823369897048       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.823382629307       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.823290849281       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.823391652662       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.823300552667       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.823367783587       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.823041982446       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.823274402995       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.823414869565       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.823631049239       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.823403024424       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.823535492909       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.823185299693       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.823255787740       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.823178314663       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.822965004545       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.823169247900       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.822393224468       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.824021923267       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.823480998281       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.823401367075       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.823544745373       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.821985206079       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.818566873804       residual = 4.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.824380424289       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.823115893342       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.819453824305       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.825572838907       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.824766806698       residual = 2.39e-03           smallest_sin_value = 9.96e-01
davidson iteration   71 stopping due to small subspace S singular value of 7.58e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+10 is 1.150259e-13

solving harmonic davidson linear method for identity shift 8.6736e+10, overlap shift 8.6736e+11 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.823413075795       residual = 9.92e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.823413075795       residual = 4.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.823413075795       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.823413075795       residual = 5.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.823413061240       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.823413093999       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.823302484040       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.823122024920       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.823458775711       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.823393948643       residual = 7.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.823390798316       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.823329050032       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.823486583440       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.823491109118       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.823312018496       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.823204764762       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.823262409442       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.823627537427       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.823367236128       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.823118512774       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.823335764581       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.823454809607       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.823411902157       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.823191981005       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.823452761343       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.823215255512       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.823467292895       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.823159934431       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.823457872886       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.823495379914       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.823142685169       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.823285538672       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.823277056067       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.823261732959       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.823291364983       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.823247867341       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.823398488844       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.823488523003       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.824339733376       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.822919419313       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.823262126833       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.823383496388       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.823193432099       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.823148955957       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.823102007518       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.822853986294       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.824014856696       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.823672772131       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.821643833339       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.823785274243       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.822785728483       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.823352398376       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.823357784822       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.822236035301       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.827273877010       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.823237576373       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.825370115884       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.823559388743       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.825824675054       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.823278201623       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.825187883514       residual = 5.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.820020549414       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.839992431533       residual = 3.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.816309407575       residual = 5.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.825155302584       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.820279375960       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.829823837920       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.844317216108       residual = 5.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.822219420580       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.823187913897       residual = 4.32e-02           smallest_sin_value = 9.99e-01
davidson iteration   70 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         70 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+10 is 2.871742e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.095620 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8787e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2256
    reference variance = 0.245284
====================================================
  Execution time = 3.7358e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0171e-01
  Total weights = 1.9737e+06
  Execution time = 3.1511e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293679650293
                                         uncertainty =       0.002251645507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293679650293
                                         uncertainty =       0.002251645507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383156879
  error estimate for blocks of size 2^( 2) =       0.000397908773
  error estimate for blocks of size 2^( 3) =       0.000411188276
  error estimate for blocks of size 2^( 4) =       0.000420473134
  error estimate for blocks of size 2^( 5) =       0.000426263137
  error estimate for blocks of size 2^( 6) =       0.000430226624
  error estimate for blocks of size 2^( 7) =       0.000431337773

      target function =      -0.910130646484
              le_mean =     -17.206002116315
             les_mean =     296.348215680033
             stat err =       0.000427075167
             autocorr =       1.242382667212
   target nu stat err =       0.000427075167
   target dn stat err =       0.003174870808
      target stat err =       0.004922183938
              std dev =       0.541865655457
             le_variance =       0.293618388564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293679650293
                                         uncertainty =       0.002251645507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293679650293
                                         uncertainty =       0.002251645507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383156879
  error estimate for blocks of size 2^( 2) =       0.000397908773
  error estimate for blocks of size 2^( 3) =       0.000411188276
  error estimate for blocks of size 2^( 4) =       0.000420473134
  error estimate for blocks of size 2^( 5) =       0.000426263137
  error estimate for blocks of size 2^( 6) =       0.000430226624
  error estimate for blocks of size 2^( 7) =       0.000431337773

      target function =      -0.910130646484
              le_mean =     -17.206002116315
             les_mean =     296.348215680033
             stat err =       0.000427075167
             autocorr =       1.242382667204
   target nu stat err =       0.000427075167
   target dn stat err =       0.003174870808
      target stat err =       0.004922183938
              std dev =       0.541865655457
             le_variance =       0.293618388564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293679650293
                                         uncertainty =       0.002251645507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293679650293
                                         uncertainty =       0.002251645507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383156879
  error estimate for blocks of size 2^( 2) =       0.000397908773
  error estimate for blocks of size 2^( 3) =       0.000411188276
  error estimate for blocks of size 2^( 4) =       0.000420473134
  error estimate for blocks of size 2^( 5) =       0.000426263137
  error estimate for blocks of size 2^( 6) =       0.000430226624
  error estimate for blocks of size 2^( 7) =       0.000431337773

      target function =      -0.910130646484
              le_mean =     -17.206002116315
             les_mean =     296.348215680033
             stat err =       0.000427075167
             autocorr =       1.242382667211
   target nu stat err =       0.000427075167
   target dn stat err =       0.003174870808
      target stat err =       0.004922183938
              std dev =       0.541865655457
             le_variance =       0.293618388564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293679650293
                                         uncertainty =       0.002251645507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293679650293
                                         uncertainty =       0.002251645507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383156879
  error estimate for blocks of size 2^( 2) =       0.000397908773
  error estimate for blocks of size 2^( 3) =       0.000411188276
  error estimate for blocks of size 2^( 4) =       0.000420473134
  error estimate for blocks of size 2^( 5) =       0.000426263137
  error estimate for blocks of size 2^( 6) =       0.000430226624
  error estimate for blocks of size 2^( 7) =       0.000431337773

      target function =      -0.910130646484
              le_mean =     -17.206002116315
             les_mean =     296.348215680033
             stat err =       0.000427075167
             autocorr =       1.242382667209
   target nu stat err =       0.000427075167
   target dn stat err =       0.003174870808
      target stat err =       0.004922183938
              std dev =       0.541865655457
             le_variance =       0.293618388564


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910130646484        initial  <--
     5.4210e+09     5.4210e+10             4.6034e-13        -0.910130646484
     2.1684e+10     2.1684e+11             1.1503e-13        -0.910130646484
     8.6736e+10     8.6736e+11             2.8717e-14        -0.910130646484

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 55.8493
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0464e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.148
    reference variance = 0.325067
====================================================
  Execution time = 3.8172e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5442e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9895e-01
  Total weights = 1.973725853e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0827e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290349382647
                                         uncertainty =       0.002482777221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290349382647
                                         uncertainty =       0.002482777221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381005178
  error estimate for blocks of size 2^( 2) =       0.000395767197
  error estimate for blocks of size 2^( 3) =       0.000409701852
  error estimate for blocks of size 2^( 4) =       0.000419523445
  error estimate for blocks of size 2^( 5) =       0.000426306053
  error estimate for blocks of size 2^( 6) =       0.000428691201
  error estimate for blocks of size 2^( 7) =       0.000429611653

      target function =      -0.914388035250
              le_mean =     -17.205755623210
             les_mean =     296.336973205316
             stat err =       0.000426033088
             autocorr =       1.250330730583
   target nu stat err =       0.000426033088
   target dn stat err =       0.003197254164
      target stat err =       0.004999600366
              std dev =       0.538822689399
             le_variance =       0.290329890611


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720575562321e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+10, overlap shift 5.4210e+11 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914414277209       residual = 8.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914414277209       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914414277209       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914414277209       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914414277209       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914414280674       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914391834136       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914504882842       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914431047116       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914494970631       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914378868840       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914374553224       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914356180765       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914402865789       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914431415677       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914468878488       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914583477689       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914478509736       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914248809311       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914237597006       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914406101255       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914491781976       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914425921071       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914597282530       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914318961570       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914277583593       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914449967182       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914471714390       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914355702138       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914525048598       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914425330129       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914539425707       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914398845953       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914301838349       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914380868070       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914447181382       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914900975330       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913688018792       residual = 6.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914085530441       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914521190585       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914393251895       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.914365150504       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.913998007556       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.913815529625       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.914685854470       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.914775345833       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.914717021841       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.913762378085       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.913900510703       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.913887306014       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.914746122307       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.913699020434       residual = 8.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.915074171565       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.913755906625       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.913436331785       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.916045263828       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.913828018178       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.915238131626       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.910941757989       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.916058304993       residual = 9.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.914764121358       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.915399269848       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.912287408581       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.933139706095       residual = 3.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.904620543893       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.913447330615       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.913631580263       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.910800532508       residual = 3.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.899770620003       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.889217064504       residual = 9.31e-02           smallest_sin_value = 9.96e-01
davidson iteration   70 stopping due to small subspace S singular value of 8.75e-01
davidson solver did not converge after         70 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+10 is 8.655294e-15

solving harmonic davidson linear method for identity shift 2.1684e+11, overlap shift 2.1684e+12 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914414277209       residual = 8.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914414277209       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914414277209       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914414277209       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914414277209       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914414143992       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914413998573       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914465503386       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914844280861       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914364158385       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914530019310       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913924286391       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913973291551       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914373376911       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914002289053       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914020585823       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914389081000       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914196378156       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914206374250       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914436752632       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914401490533       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914640521083       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915282542785       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914743800375       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914258568156       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913809715419       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914511107132       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913916801420       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914055819046       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913533517910       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914828741806       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914317648334       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914518009344       residual = 7.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913586683914       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912885444984       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913180532255       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915322344911       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915969473626       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912136031111       residual = 5.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914065207465       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.913875354253       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.916938674066       residual = 6.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.912260541994       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.914288007291       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.913588949961       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.917053432042       residual = 8.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.916415500297       residual = 8.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.917965266034       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.913330013417       residual = 4.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.911054357246       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.906389650633       residual = 6.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.911032523780       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.915171363702       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.916303055754       residual = 6.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.909370584519       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.915448663805       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.914090551481       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.936087171954       residual = 6.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.923045256445       residual = 2.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.915104689789       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.904976998463       residual = 9.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.920421282095       residual = 8.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.908805485004       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.932655745602       residual = 5.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.921924772425       residual = 9.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.889046553531       residual = 1.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -1.032357810050       residual = 1.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.932436445652       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.919532097398       residual = 2.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.903264485357       residual = 2.90e-02           smallest_sin_value = 9.99e-01
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.886230935091       residual = 2.10e-01           smallest_sin_value = 9.99e-01
davidson iteration   71 stopping due to small subspace S singular value of 9.18e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+11 is 2.460298e-15

solving harmonic davidson linear method for identity shift 8.6736e+11, overlap shift 8.6736e+12 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914414277209       residual = 8.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914414277209       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914414277209       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914414277209       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914414277209       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914414277189       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914356222518       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914746562220       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915716037719       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916040325093       residual = 6.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913115252242       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914695185755       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914167399954       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912458159987       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915190360388       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915326449541       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915522619159       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914598115382       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917582545417       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918099488385       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915558112437       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917025711319       residual = 9.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912043177570       residual = 5.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916404938017       residual = 5.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913829309269       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911431359173       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912361752434       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918490094283       residual = 3.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.904060122991       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916021231028       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914851346015       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915026820174       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.906682304183       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913719409398       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.907374999348       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.923261008182       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913308118045       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.926171052377       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919534634402       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.895096464094       residual = 3.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.922780629274       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.920197147689       residual = 6.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.898775579142       residual = 2.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.920696135302       residual = 9.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.892209391732       residual = 5.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.923853762952       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.918534009901       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.909526230045       residual = 6.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.899714729102       residual = 3.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.915210548912       residual = 4.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.886623491165       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.881142006277       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.923850867883       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.922214905096       residual = 8.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.904909537720       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.933031124412       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.921413210781       residual = 7.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.959562296253       residual = 2.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.864288879891       residual = 3.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.862163390549       residual = 4.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.945549509988       residual = 1.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.871623164196       residual = 3.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.874812042919       residual = 1.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.848391881578       residual = 6.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.905609395735       residual = 1.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.898913500139       residual = 7.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.976679411474       residual = 2.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.903632139476       residual = 1.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.531115825426       residual = 3.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.791580844459       residual = 1.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.620896155922       residual = 1.05e+01           smallest_sin_value = 9.99e-01
davidson iteration   71:   krylov dim =  72   tar_fn =      -1.247740221144       residual = 2.36e+01           smallest_sin_value = 9.95e-01
davidson iteration   72 stopping due to small subspace S singular value of 8.76e-01
davidson solver did not converge after         72 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+11 is 2.357609e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.481647 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9393e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2838
    reference variance = 0.473738
====================================================
  Execution time = 3.7489e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0319e-01
  Total weights = 1.9739e+06
  Execution time = 3.1513e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292974540352
                                         uncertainty =       0.002894431939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292974540352
                                         uncertainty =       0.002894431939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382796157
  error estimate for blocks of size 2^( 2) =       0.000397729704
  error estimate for blocks of size 2^( 3) =       0.000411253920
  error estimate for blocks of size 2^( 4) =       0.000421530212
  error estimate for blocks of size 2^( 5) =       0.000427634990
  error estimate for blocks of size 2^( 6) =       0.000430054365
  error estimate for blocks of size 2^( 7) =       0.000430811561

      target function =      -0.907752549953
              le_mean =     -17.207078494416
             les_mean =     296.386742158531
             stat err =       0.000427507782
             autocorr =       1.247248274453
   target nu stat err =       0.000427507782
   target dn stat err =       0.006079611694
      target stat err =       0.009322692779
              std dev =       0.541355516657
             le_variance =       0.293065795415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292974540351
                                         uncertainty =       0.002894431939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292974540351
                                         uncertainty =       0.002894431939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382796157
  error estimate for blocks of size 2^( 2) =       0.000397729704
  error estimate for blocks of size 2^( 3) =       0.000411253920
  error estimate for blocks of size 2^( 4) =       0.000421530212
  error estimate for blocks of size 2^( 5) =       0.000427634990
  error estimate for blocks of size 2^( 6) =       0.000430054365
  error estimate for blocks of size 2^( 7) =       0.000430811561

      target function =      -0.907752549953
              le_mean =     -17.207078494416
             les_mean =     296.386742158531
             stat err =       0.000427507782
             autocorr =       1.247248274452
   target nu stat err =       0.000427507782
   target dn stat err =       0.006079611694
      target stat err =       0.009322692779
              std dev =       0.541355516657
             le_variance =       0.293065795415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292974540351
                                         uncertainty =       0.002894431939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292974540351
                                         uncertainty =       0.002894431939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382796157
  error estimate for blocks of size 2^( 2) =       0.000397729704
  error estimate for blocks of size 2^( 3) =       0.000411253920
  error estimate for blocks of size 2^( 4) =       0.000421530212
  error estimate for blocks of size 2^( 5) =       0.000427634990
  error estimate for blocks of size 2^( 6) =       0.000430054365
  error estimate for blocks of size 2^( 7) =       0.000430811561

      target function =      -0.907752549953
              le_mean =     -17.207078494416
             les_mean =     296.386742158531
             stat err =       0.000427507782
             autocorr =       1.247248274452
   target nu stat err =       0.000427507782
   target dn stat err =       0.006079611694
      target stat err =       0.009322692779
              std dev =       0.541355516657
             le_variance =       0.293065795415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292974540351
                                         uncertainty =       0.002894431939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292974540351
                                         uncertainty =       0.002894431939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382796157
  error estimate for blocks of size 2^( 2) =       0.000397729704
  error estimate for blocks of size 2^( 3) =       0.000411253920
  error estimate for blocks of size 2^( 4) =       0.000421530212
  error estimate for blocks of size 2^( 5) =       0.000427634990
  error estimate for blocks of size 2^( 6) =       0.000430054365
  error estimate for blocks of size 2^( 7) =       0.000430811561

      target function =      -0.907752549953
              le_mean =     -17.207078494416
             les_mean =     296.386742158531
             stat err =       0.000427507782
             autocorr =       1.247248274451
   target nu stat err =       0.000427507782
   target dn stat err =       0.006079611694
      target stat err =       0.009322692779
              std dev =       0.541355516657
             le_variance =       0.293065795415


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907752549953        initial
     5.4210e+10     5.4210e+11             8.6553e-15        -0.907752549953
     2.1684e+11     2.1684e+12             2.4603e-15        -0.907752549953
     8.6736e+11     8.6736e+12             2.3576e-16        -0.907752549953  <--

*****************************************************************************
Applying the update for shift_i =   8.6736e+11     and shift_s =   8.6736e+12
*****************************************************************************

  Execution time = 5.3313e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0271e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2108
    reference variance = 0.165508
====================================================
  Execution time = 3.7646e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5428e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0601e-01
  Total weights = 1.973874845e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1076e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292822597670
                                         uncertainty =       0.001960675863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292822597670
                                         uncertainty =       0.001960675863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382605213
  error estimate for blocks of size 2^( 2) =       0.000397413508
  error estimate for blocks of size 2^( 3) =       0.000410805119
  error estimate for blocks of size 2^( 4) =       0.000420582487
  error estimate for blocks of size 2^( 5) =       0.000425377626
  error estimate for blocks of size 2^( 6) =       0.000427553415
  error estimate for blocks of size 2^( 7) =       0.000427842445

      target function =      -0.903521468616
              le_mean =     -17.206304948374
             les_mean =     296.362938595673
             stat err =       0.000425338993
             autocorr =       1.235858162477
   target nu stat err =       0.000425338993
   target dn stat err =       0.005352731835
      target stat err =       0.008126872086
              std dev =       0.541085481931
             le_variance =       0.292773498756


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720630494837e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+11, overlap shift 2.1684e+12 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903593462946       residual = 7.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903593462946       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903593462946       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903586420318       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903796483238       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903593413446       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903689690779       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903476080627       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903624979586       residual = 7.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903414402869       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.903448246772       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904583859382       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.903436187297       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.903695082357       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.903569002523       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.903667547261       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.903054649991       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.902380248521       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.903646384609       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.900966840036       residual = 6.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.901743754894       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.901628486430       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904270716783       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.902733655593       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.904029283083       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.903577579051       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.903734019576       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.903905089145       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.902870228612       residual = 9.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.901333856399       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.904254086340       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.902146339879       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.904930035514       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.902596741653       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.905469921917       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.906105668965       residual = 5.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.903618571875       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.904469190938       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.905017030696       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.902811782366       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.905049894281       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.900839686075       residual = 7.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.903276410896       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.903856326388       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.903977833327       residual = 7.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.900999391635       residual = 7.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.900547797627       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.905911430661       residual = 9.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.907570640061       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.903503293062       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.900105690947       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.894615880917       residual = 8.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.906530647805       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.902522041797       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.900595300321       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.906217060700       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.874000869287       residual = 9.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.873585738428       residual = 9.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.921883853227       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.907296866104       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.935851451212       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.913773128846       residual = 4.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.889870011657       residual = 4.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.915340125029       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.899133263945       residual = 6.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.907607302403       residual = 6.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.926296171994       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.900221523298       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.890959681753       residual = 7.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.917563744093       residual = 2.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.904222587872       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   71 stopping due to small subspace S singular value of 9.41e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+11 is 1.104970e-15

solving harmonic davidson linear method for identity shift 8.6736e+11, overlap shift 8.6736e+12 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903593462946       residual = 7.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903593462946       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903593462946       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903593462946       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903793360189       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903135123523       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903372543201       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904456369035       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902154482230       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906131053231       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902977315455       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902840658134       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905321601101       residual = 6.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.903028804643       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.903474348206       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.903235387805       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.903009767173       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.905138844703       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.900049061312       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.901706045227       residual = 6.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.901402118053       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.901719709765       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908137869758       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905571802223       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.904970362207       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.903653400962       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.901994671708       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908498453756       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.902123213955       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.901162099359       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912534489973       residual = 8.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907314983203       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.902042948353       residual = 6.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.900317706321       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.903443074706       residual = 9.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915467773497       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.904519771312       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.901972619737       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.905245863785       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.897976624443       residual = 6.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914973343564       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.900795040369       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.895289491316       residual = 9.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.907145113172       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.914755012674       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.895957179948       residual = 7.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.928336080796       residual = 6.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.911342475411       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.896118468334       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.925009283275       residual = 4.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.952148294272       residual = 2.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.892740421258       residual = 2.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.949030502200       residual = 2.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.876982645723       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.962898937534       residual = 3.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.901285727150       residual = 3.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.820936422585       residual = 6.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.882023007561       residual = 7.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.864277430025       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.842180852339       residual = 3.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.879900808937       residual = 2.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.916141714572       residual = 5.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.022291854499       residual = 1.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.031800122058       residual = 1.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.938541506536       residual = 2.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.922506035264       residual = 4.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.855989775397       residual = 5.11e-01           smallest_sin_value = 9.99e-01
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.915908879523       residual = 5.57e-01           smallest_sin_value = 9.99e-01
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.210376184959       residual = 8.73e+00           smallest_sin_value = 9.92e-01
davidson iteration   69 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         69 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+11 is 2.031748e-16

solving harmonic davidson linear method for identity shift 3.4694e+12, overlap shift 3.4694e+13 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903593462946       residual = 7.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903593462946       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903593462946       residual = 6.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903604312593       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903593462946       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900081101472       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902219837632       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905760597249       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901127415871       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900976178683       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905710295781       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902042015167       residual = 5.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908774730109       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908249951903       residual = 3.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.902876868790       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906308945647       residual = 4.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906156271442       residual = 7.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.902168974987       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912873279612       residual = 9.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905882081884       residual = 7.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905663961037       residual = 6.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909768789366       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909552143682       residual = 7.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.923806548886       residual = 4.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.882662287157       residual = 5.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.896582532361       residual = 7.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913101784983       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.897698328847       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.894839225202       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.890103390170       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951385640002       residual = 2.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.881202401337       residual = 6.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.923260897894       residual = 5.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916922322238       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.906307953138       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.927246612637       residual = 9.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.900618098339       residual = 6.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.924107593208       residual = 6.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.908824831178       residual = 3.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937602168213       residual = 1.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.849760890938       residual = 3.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939391995455       residual = 3.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.861832254966       residual = 5.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.784346667770       residual = 1.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.934817057618       residual = 1.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -1.061431071687       residual = 2.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.772237045809       residual = 2.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.867059194051       residual = 7.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.829311388760       residual = 7.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.943973659483       residual = 6.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.894789218488       residual = 4.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.933204718904       residual = 3.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.877993780783       residual = 5.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.895575072564       residual = 7.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.856494550125       residual = 8.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.948903731689       residual = 3.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.935314481887       residual = 4.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.932385141907       residual = 9.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.976202456922       residual = 3.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.912238872406       residual = 1.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -1.010768838749       residual = 3.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.944128894225       residual = 2.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.089409220119       residual = 4.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.004740837166       residual = 1.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.186795256980       residual = 1.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -1.166748337448       residual = 5.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.375025500670       residual = 3.17e+01           smallest_sin_value = 9.99e-01
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.900097960345       residual = 1.18e+01           smallest_sin_value = 9.98e-01
davidson iteration   68 stopping due to small subspace S singular value of 9.64e-01
davidson solver did not converge after         68 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.4694e+12 is 4.404336e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.843391 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9091e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2245
    reference variance = 0.338599
====================================================
  Execution time = 3.7741e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9442e-01
  Total weights = 1.9737e+06
  Execution time = 3.1488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287558160041
                                         uncertainty =       0.001473649537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287558160041
                                         uncertainty =       0.001473649537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379121283
  error estimate for blocks of size 2^( 2) =       0.000394126759
  error estimate for blocks of size 2^( 3) =       0.000407694961
  error estimate for blocks of size 2^( 4) =       0.000417344574
  error estimate for blocks of size 2^( 5) =       0.000423528498
  error estimate for blocks of size 2^( 6) =       0.000427186849
  error estimate for blocks of size 2^( 7) =       0.000427806445

      target function =      -0.921455718117
              le_mean =     -17.206854137002
             les_mean =     296.370247891330
             stat err =       0.000423966591
             autocorr =       1.250566932725
   target nu stat err =       0.000423966591
   target dn stat err =       0.001942517216
      target stat err =       0.003143235141
              std dev =       0.536158459715
             le_variance =       0.287465893924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287558160041
                                         uncertainty =       0.001473649537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287558160041
                                         uncertainty =       0.001473649537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379121283
  error estimate for blocks of size 2^( 2) =       0.000394126759
  error estimate for blocks of size 2^( 3) =       0.000407694961
  error estimate for blocks of size 2^( 4) =       0.000417344574
  error estimate for blocks of size 2^( 5) =       0.000423528498
  error estimate for blocks of size 2^( 6) =       0.000427186849
  error estimate for blocks of size 2^( 7) =       0.000427806445

      target function =      -0.921455718117
              le_mean =     -17.206854137002
             les_mean =     296.370247891330
             stat err =       0.000423966591
             autocorr =       1.250566932730
   target nu stat err =       0.000423966591
   target dn stat err =       0.001942517216
      target stat err =       0.003143235141
              std dev =       0.536158459715
             le_variance =       0.287465893924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287558160041
                                         uncertainty =       0.001473649537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287558160041
                                         uncertainty =       0.001473649537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379121283
  error estimate for blocks of size 2^( 2) =       0.000394126759
  error estimate for blocks of size 2^( 3) =       0.000407694961
  error estimate for blocks of size 2^( 4) =       0.000417344574
  error estimate for blocks of size 2^( 5) =       0.000423528498
  error estimate for blocks of size 2^( 6) =       0.000427186849
  error estimate for blocks of size 2^( 7) =       0.000427806445

      target function =      -0.921455718117
              le_mean =     -17.206854137002
             les_mean =     296.370247891330
             stat err =       0.000423966591
             autocorr =       1.250566932720
   target nu stat err =       0.000423966591
   target dn stat err =       0.001942517216
      target stat err =       0.003143235141
              std dev =       0.536158459715
             le_variance =       0.287465893924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287558160041
                                         uncertainty =       0.001473649537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287558160041
                                         uncertainty =       0.001473649537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379121283
  error estimate for blocks of size 2^( 2) =       0.000394126759
  error estimate for blocks of size 2^( 3) =       0.000407694961
  error estimate for blocks of size 2^( 4) =       0.000417344574
  error estimate for blocks of size 2^( 5) =       0.000423528498
  error estimate for blocks of size 2^( 6) =       0.000427186849
  error estimate for blocks of size 2^( 7) =       0.000427806445

      target function =      -0.921455718117
              le_mean =     -17.206854137002
             les_mean =     296.370247891330
             stat err =       0.000423966591
             autocorr =       1.250566932727
   target nu stat err =       0.000423966591
   target dn stat err =       0.001942517216
      target stat err =       0.003143235141
              std dev =       0.536158459715
             le_variance =       0.287465893924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921455718117        initial  <--
     2.1684e+11     2.1684e+12             1.1050e-15        -0.921455718117
     8.6736e+11     8.6736e+12             2.0317e-16        -0.921455718117
     3.4694e+12     3.4694e+13             4.4043e-17        -0.921455718117

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.5744
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0267e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2497
    reference variance = 0.165387
====================================================
  Execution time = 3.7861e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5429e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9678e-01
  Total weights = 1.973638840e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0854e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289296822124
                                         uncertainty =       0.001776234278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289296822124
                                         uncertainty =       0.001776234278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380342593
  error estimate for blocks of size 2^( 2) =       0.000395753002
  error estimate for blocks of size 2^( 3) =       0.000409716273
  error estimate for blocks of size 2^( 4) =       0.000419430500
  error estimate for blocks of size 2^( 5) =       0.000426386356
  error estimate for blocks of size 2^( 6) =       0.000429262231
  error estimate for blocks of size 2^( 7) =       0.000430504412

      target function =      -0.917739517040
              le_mean =     -17.206868679569
             les_mean =     296.373114655551
             stat err =       0.000426395875
             autocorr =       1.256828625855
   target nu stat err =       0.000426395875
   target dn stat err =       0.002399184601
      target stat err =       0.003816991207
              std dev =       0.537885652692
             le_variance =       0.289320975372


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720686867957e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+12, overlap shift 2.1684e+13 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917754289162       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917754289162       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917754289162       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917627534138       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917754289162       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919142656617       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917783659098       residual = 8.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916566979107       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917215229215       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919017902373       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920543321217       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919960280069       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913509520539       residual = 7.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917286497814       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922430096780       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918667248938       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916139473844       residual = 6.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922254216615       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914065185486       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923644991910       residual = 3.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917211148498       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929348130311       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908915103844       residual = 8.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.926698025359       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906007384682       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.930752273957       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.899285715942       residual = 3.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.930745464307       residual = 2.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917740164817       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.924062491946       residual = 6.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910633112303       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.904852907606       residual = 2.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916995045502       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.880591483822       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912121868760       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.921484560827       residual = 4.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.944662980699       residual = 7.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.954525356215       residual = 1.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.903459194863       residual = 8.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.930000577381       residual = 5.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.976297029950       residual = 3.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.904816313603       residual = 6.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.937378301504       residual = 8.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.829668303613       residual = 8.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.936098450472       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.845361492943       residual = 5.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -1.092445181648       residual = 2.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -1.009845547869       residual = 8.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.027711217068       residual = 1.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.828026962988       residual = 9.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.079765616065       residual = 6.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.811270193615       residual = 5.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.867583093766       residual = 6.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.601484675228       residual = 9.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.721779939845       residual = 5.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.628832629469       residual = 7.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.707492675045       residual = 7.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.555434699455       residual = 1.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.867913124504       residual = 9.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -1.288805722323       residual = 1.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -1.080074105421       residual = 3.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.516330342478       residual = 2.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.793419596370       residual = 7.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.032115454508       residual = 2.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.720012958703       residual = 1.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.987151704996       residual = 2.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.687018232107       residual = 1.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.442588403621       residual = 3.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.895266043373       residual = 1.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.866132007301       residual = 4.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.060553533498       residual = 3.20e+01           smallest_sin_value = 9.97e-01
davidson iteration   71 stopping due to small subspace S singular value of 8.24e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+12 is 7.140918e-17

solving harmonic davidson linear method for identity shift 8.6736e+12, overlap shift 8.6736e+13 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917754289162       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917754289162       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.97e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.4694e+13, overlap shift 3.4694e+14 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917754289162       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917754289162       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.97e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.4694e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.978171 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8857e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.1927
    reference variance = 0.229831
====================================================
  Execution time = 3.8522e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9964e-01
  Total weights = 1.9737e+06
  Execution time = 3.1379e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291270359074
                                         uncertainty =       0.001864121672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291270359074
                                         uncertainty =       0.001864121672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381624647
  error estimate for blocks of size 2^( 2) =       0.000396618061
  error estimate for blocks of size 2^( 3) =       0.000410666905
  error estimate for blocks of size 2^( 4) =       0.000421047456
  error estimate for blocks of size 2^( 5) =       0.000426723150
  error estimate for blocks of size 2^( 6) =       0.000429176972
  error estimate for blocks of size 2^( 7) =       0.000431632594

      target function =      -0.913313781229
              le_mean =     -17.206160709625
             les_mean =     296.351609343015
             stat err =       0.000427145043
             autocorr =       1.252788940770
   target nu stat err =       0.000427145043
   target dn stat err =       0.002441587130
      target stat err =       0.003840532771
              std dev =       0.539698750942
             le_variance =       0.291274741768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291270359074
                                         uncertainty =       0.001864121672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291270359074
                                         uncertainty =       0.001864121672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381624647
  error estimate for blocks of size 2^( 2) =       0.000396618061
  error estimate for blocks of size 2^( 3) =       0.000410666905
  error estimate for blocks of size 2^( 4) =       0.000421047456
  error estimate for blocks of size 2^( 5) =       0.000426723150
  error estimate for blocks of size 2^( 6) =       0.000429176972
  error estimate for blocks of size 2^( 7) =       0.000431632594

      target function =      -0.913313781229
              le_mean =     -17.206160709625
             les_mean =     296.351609343015
             stat err =       0.000427145043
             autocorr =       1.252788940774
   target nu stat err =       0.000427145043
   target dn stat err =       0.002441587130
      target stat err =       0.003840532771
              std dev =       0.539698750942
             le_variance =       0.291274741768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291270359074
                                         uncertainty =       0.001864121672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291270359074
                                         uncertainty =       0.001864121672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381624647
  error estimate for blocks of size 2^( 2) =       0.000396618061
  error estimate for blocks of size 2^( 3) =       0.000410666905
  error estimate for blocks of size 2^( 4) =       0.000421047456
  error estimate for blocks of size 2^( 5) =       0.000426723150
  error estimate for blocks of size 2^( 6) =       0.000429176972
  error estimate for blocks of size 2^( 7) =       0.000431632594

      target function =      -0.913313781229
              le_mean =     -17.206160709625
             les_mean =     296.351609343015
             stat err =       0.000427145043
             autocorr =       1.252788940772
   target nu stat err =       0.000427145043
   target dn stat err =       0.002441587130
      target stat err =       0.003840532771
              std dev =       0.539698750942
             le_variance =       0.291274741768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291270359074
                                         uncertainty =       0.001864121672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291270359074
                                         uncertainty =       0.001864121672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381624647
  error estimate for blocks of size 2^( 2) =       0.000396618061
  error estimate for blocks of size 2^( 3) =       0.000410666905
  error estimate for blocks of size 2^( 4) =       0.000421047456
  error estimate for blocks of size 2^( 5) =       0.000426723150
  error estimate for blocks of size 2^( 6) =       0.000429176972
  error estimate for blocks of size 2^( 7) =       0.000431632594

      target function =      -0.913313781229
              le_mean =     -17.206160709625
             les_mean =     296.351609343015
             stat err =       0.000427145043
             autocorr =       1.252788940772
   target nu stat err =       0.000427145043
   target dn stat err =       0.002441587130
      target stat err =       0.003840532771
              std dev =       0.539698750942
             le_variance =       0.291274741768


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913313781229        initial  <--
     2.1684e+12     2.1684e+13             7.1409e-17        -0.913313781229
     8.6736e+12     8.6736e+13             0.0000e+00        -0.913313781229
     3.4694e+13     3.4694e+14             0.0000e+00        -0.913313781229

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.2894
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0315e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2688
    reference variance = 0.228727
====================================================
  Execution time = 3.8019e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5430e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0154e-01
  Total weights = 1.973625496e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0951e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292938090110
                                         uncertainty =       0.001915473411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292938090110
                                         uncertainty =       0.001915473411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382653011
  error estimate for blocks of size 2^( 2) =       0.000397453006
  error estimate for blocks of size 2^( 3) =       0.000410991070
  error estimate for blocks of size 2^( 4) =       0.000420694842
  error estimate for blocks of size 2^( 5) =       0.000425734698
  error estimate for blocks of size 2^( 6) =       0.000429815173
  error estimate for blocks of size 2^( 7) =       0.000429700925

      target function =      -0.910363086773
              le_mean =     -17.206981467908
             les_mean =     296.381750248747
             stat err =       0.000426486409
             autocorr =       1.242224589801
   target nu stat err =       0.000426486409
   target dn stat err =       0.002922656800
      target stat err =       0.004550238279
              std dev =       0.541153078215
             le_variance =       0.292846654061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720698146791e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+13, overlap shift 2.1684e+14 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910384672698       residual = 5.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910384672698       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910384672698       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910384672699       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922590579926       residual = 3.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914203270132       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910381417933       residual = 4.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884157562011       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902394172462       residual = 2.00e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905107259900       residual = 2.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939272011411       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929714868231       residual = 1.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.868720928493       residual = 1.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -1.093844997910       residual = 3.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914029925623       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932744251797       residual = 1.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.867697658745       residual = 5.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.963086338423       residual = 5.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.835556945997       residual = 8.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.815612572690       residual = 1.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.904142657523       residual = 2.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.671610398157       residual = 7.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.763878555978       residual = 3.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941001734406       residual = 4.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.842401156603       residual = 1.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.034648132635       residual = 2.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.979253712145       residual = 1.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939893035165       residual = 8.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.488054960227       residual = 1.87e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.780783274198       residual = 2.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.244152367786       residual = 1.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.581873480534       residual = 1.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947077997739       residual = 5.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.098433109638       residual = 6.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.527096972192       residual = 3.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.553566234163       residual = 2.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.030868928682       residual = 4.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.284312014378       residual = 4.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.477538359692       residual = 2.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -2.709346947918       residual = 3.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.076381549598       residual = 7.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.882020250529       residual = 2.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.845631851688       residual = 4.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.761081089122       residual = 9.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =       1.031570196590       residual = 5.02e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =       0.037657706032       residual = 9.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.310437466381       residual = 3.94e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -2.101327729039       residual = 1.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =       0.172169250533       residual = 1.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.471835623227       residual = 6.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.079353209257       residual = 7.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -2.390079968291       residual = 2.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -2.729749704140       residual = 3.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -3.925158806527       residual = 1.22e+03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =       0.417425924931       residual = 5.15e+02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -1.929043220040       residual = 2.72e+02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =       0.492976158375       residual = 9.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -1.974459744965       residual = 2.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -1.021311998129       residual = 5.60e+02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -2.459040928147       residual = 2.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =       1.921141463114       residual = 1.82e+03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.604415592571       residual = 5.60e+02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -4.084665542539       residual = 1.67e+03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =       3.936966019275       residual = 3.01e+03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -3.667022367745       residual = 1.69e+03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -1.589904231671       residual = 4.99e+02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -8.798961178469       residual = 6.70e+03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.675831166686       residual = 1.65e+03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =       0.582885240332       residual = 9.48e+02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.582459532101       residual = 1.97e+03           smallest_sin_value = 9.99e-01
davidson iteration   70 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         70 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+13 is 7.534319e-18

solving harmonic davidson linear method for identity shift 8.6736e+13, overlap shift 8.6736e+14 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910384672698       residual = 5.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910384672698       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910384672698       residual = 3.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928023506691       residual = 2.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910384672705       residual = 8.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.878678121489       residual = 8.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913947583972       residual = 1.27e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.825714073870       residual = 3.53e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.844622677065       residual = 4.85e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942881229841       residual = 2.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.840295272321       residual = 5.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951587052617       residual = 6.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.798531865360       residual = 1.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936472226685       residual = 9.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742107351296       residual = 8.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.751219582393       residual = 3.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -1.006793716888       residual = 4.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.734451557706       residual = 4.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.773104201503       residual = 2.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.850774416184       residual = 7.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.074640628826       residual = 7.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.606389658335       residual = 9.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.085288986432       residual = 6.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.849481481909       residual = 4.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.966162768801       residual = 1.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.262708353966       residual = 1.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.344906735872       residual = 1.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.425915509849       residual = 2.80e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.322703685655       residual = 4.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.049200339623       residual = 1.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.214838915749       residual = 1.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.104633372578       residual = 2.57e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.213583497766       residual = 1.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.420412295106       residual = 3.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.939705100669       residual = 1.01e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.684137190217       residual = 2.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.123792409347       residual = 2.44e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       2.131173636916       residual = 8.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -4.587895059925       residual = 1.47e+03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       1.321197677119       residual = 8.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -4.112784022867       residual = 1.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -3.299937999069       residual = 4.82e+02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -3.825097585740       residual = 7.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -2.472201202972       residual = 2.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =       0.790774916107       residual = 8.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -1.299110301572       residual = 6.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -3.101556650687       residual = 1.18e+03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =       2.669380557945       residual = 4.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =       1.961022209286       residual = 8.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -2.326219313237       residual = 4.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =       1.675125503907       residual = 6.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -2.112374473504       residual = 3.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -1.776712906622       residual = 5.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =       2.421169293754       residual = 1.09e+03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =       2.773692571317       residual = 1.98e+03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =       4.501020264783       residual = 3.32e+03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =       2.108200529589       residual = 9.98e+02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -4.819078366300       residual = 6.47e+03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -1.328928888591       residual = 2.60e+03           smallest_sin_value = 1.00e+00
davidson iteration   59 stopping due to too large eigenvalue change
davidson solver did not converge after         59 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+13 is 1.299204e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.4694e+14, overlap shift 3.4694e+15 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910384672698       residual = 5.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910384672698       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910384672698       residual = 1.95e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910384672699       residual = 3.53e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -1.010894653541       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.891759419751       residual = 6.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910580063813       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747008168171       residual = 2.48e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.787677319253       residual = 1.44e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932724145725       residual = 1.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.167832536810       residual = 5.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.395322219370       residual = 3.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.390060235597       residual = 6.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -1.107993600104       residual = 8.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =       0.898525021844       residual = 3.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.840583941810       residual = 3.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -1.574249657698       residual = 1.02e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.289837027011       residual = 1.93e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923616965453       residual = 6.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.659197952634       residual = 8.99e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.814954676804       residual = 1.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.588463406839       residual = 9.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =       0.508570251876       residual = 2.32e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.545172682136       residual = 8.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.863632683297       residual = 5.90e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -2.263271765105       residual = 2.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -2.147525904827       residual = 2.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.707003411316       residual = 8.74e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.608872880754       residual = 1.79e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.713329677752       residual = 4.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -2.819536829227       residual = 5.61e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.510952031441       residual = 1.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.730645780381       residual = 6.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -2.143256048506       residual = 4.07e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       0.616311933667       residual = 3.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.969474700536       residual = 3.89e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -3.008533962970       residual = 5.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       0.009563795578       residual = 4.97e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.019795391852       residual = 2.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -2.506610111250       residual = 5.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.686606238759       residual = 3.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -2.465863209954       residual = 1.48e+03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =       3.038167032177       residual = 1.64e+03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -3.530584354763       residual = 1.36e+03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -3.153541033435       residual = 6.19e+03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =       0.425708122100       residual = 1.63e+03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =       5.856251805952       residual = 3.92e+03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =       5.012930504387       residual = 5.26e+03           smallest_sin_value = 1.00e+00
davidson iteration   48 stopping due to too large eigenvalue change
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.4694e+14 is 3.248010e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               6.227633 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9227e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.287
    reference variance = 0.250014
====================================================
  Execution time = 3.7702e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7208e+01
  VMC Evar = 3.0038e-01
  Total weights = 1.9739e+06
  Execution time = 3.1647e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291621289029
                                         uncertainty =       0.001882124145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291621289029
                                         uncertainty =       0.001882124145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381844756
  error estimate for blocks of size 2^( 2) =       0.000396745698
  error estimate for blocks of size 2^( 3) =       0.000410571511
  error estimate for blocks of size 2^( 4) =       0.000420736178
  error estimate for blocks of size 2^( 5) =       0.000427335064
  error estimate for blocks of size 2^( 6) =       0.000430816594
  error estimate for blocks of size 2^( 7) =       0.000434285684

      target function =      -0.912122734638
              le_mean =     -17.207566105261
             les_mean =     296.400709819808
             stat err =       0.000428293380
             autocorr =       1.258082328947
   target nu stat err =       0.000428293380
   target dn stat err =       0.003543684405
      target stat err =       0.005522500231
              std dev =       0.540010032455
             le_variance =       0.291610835153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291621289029
                                         uncertainty =       0.001882124145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291621289029
                                         uncertainty =       0.001882124145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381844756
  error estimate for blocks of size 2^( 2) =       0.000396745698
  error estimate for blocks of size 2^( 3) =       0.000410571511
  error estimate for blocks of size 2^( 4) =       0.000420736178
  error estimate for blocks of size 2^( 5) =       0.000427335064
  error estimate for blocks of size 2^( 6) =       0.000430816594
  error estimate for blocks of size 2^( 7) =       0.000434285684

      target function =      -0.912122734638
              le_mean =     -17.207566105261
             les_mean =     296.400709819808
             stat err =       0.000428293380
             autocorr =       1.258082328947
   target nu stat err =       0.000428293380
   target dn stat err =       0.003543684405
      target stat err =       0.005522500231
              std dev =       0.540010032455
             le_variance =       0.291610835153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291621289029
                                         uncertainty =       0.001882124145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291621289029
                                         uncertainty =       0.001882124145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381844756
  error estimate for blocks of size 2^( 2) =       0.000396745698
  error estimate for blocks of size 2^( 3) =       0.000410571511
  error estimate for blocks of size 2^( 4) =       0.000420736178
  error estimate for blocks of size 2^( 5) =       0.000427335064
  error estimate for blocks of size 2^( 6) =       0.000430816594
  error estimate for blocks of size 2^( 7) =       0.000434285684

      target function =      -0.912122734638
              le_mean =     -17.207566105261
             les_mean =     296.400709819808
             stat err =       0.000428293380
             autocorr =       1.258082328947
   target nu stat err =       0.000428293380
   target dn stat err =       0.003543684405
      target stat err =       0.005522500231
              std dev =       0.540010032455
             le_variance =       0.291610835153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291621289029
                                         uncertainty =       0.001882124145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291621289029
                                         uncertainty =       0.001882124145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381844756
  error estimate for blocks of size 2^( 2) =       0.000396745698
  error estimate for blocks of size 2^( 3) =       0.000410571511
  error estimate for blocks of size 2^( 4) =       0.000420736178
  error estimate for blocks of size 2^( 5) =       0.000427335064
  error estimate for blocks of size 2^( 6) =       0.000430816594
  error estimate for blocks of size 2^( 7) =       0.000434285684

      target function =      -0.912122734638
              le_mean =     -17.207566105261
             les_mean =     296.400709819808
             stat err =       0.000428293380
             autocorr =       1.258082328944
   target nu stat err =       0.000428293380
   target dn stat err =       0.003543684405
      target stat err =       0.005522500231
              std dev =       0.540010032456
             le_variance =       0.291610835153


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912122734638        initial
     2.1684e+13     2.1684e+14             7.5343e-18        -0.912122734638  <--
     8.6736e+13     8.6736e+14             1.2992e-18        -0.912122734638
     3.4694e+14     3.4694e+15             3.2480e-19        -0.912122734638

*****************************************************************************
Applying the update for shift_i =   2.1684e+13     and shift_s =   2.1684e+14
*****************************************************************************

  Execution time = 5.3606e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0284e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.1314
    reference variance = 0.170299
====================================================
  Execution time = 3.7642e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5432e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0156e-01
  Total weights = 1.973714356e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0819e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290479165491
                                         uncertainty =       0.001853329335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290479165491
                                         uncertainty =       0.001853329335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381100568
  error estimate for blocks of size 2^( 2) =       0.000396017231
  error estimate for blocks of size 2^( 3) =       0.000409586334
  error estimate for blocks of size 2^( 4) =       0.000419594744
  error estimate for blocks of size 2^( 5) =       0.000425383051
  error estimate for blocks of size 2^( 6) =       0.000427751160
  error estimate for blocks of size 2^( 7) =       0.000430233415

      target function =      -0.910337827608
              le_mean =     -17.206767337237
             les_mean =     296.374400700595
             stat err =       0.000425740593
             autocorr =       1.247989494875
   target nu stat err =       0.000425740593
   target dn stat err =       0.003042299457
      target stat err =       0.004729611727
              std dev =       0.538957591255
             le_variance =       0.290475285171


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720676733724e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+12, overlap shift 5.4210e+13 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910361290017       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910361290017       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910361290017       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910353500464       residual = 6.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910361290017       residual = 9.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901096494517       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910851195430       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913040776778       residual = 9.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914702543430       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934367632359       residual = 8.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.898434349544       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913442618567       residual = 4.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.902967167422       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911678596112       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905986973034       residual = 6.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925811351665       residual = 4.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917681208006       residual = 6.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948130719583       residual = 1.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.902784372991       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.900418506102       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908747260358       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911310040744       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.884205182774       residual = 8.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909395766247       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908599282976       residual = 4.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.865819580634       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.959163850651       residual = 4.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.894019410750       residual = 8.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.903034701878       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919809533182       residual = 4.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.887358408365       residual = 9.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.924170437110       residual = 7.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.901295305836       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.869310095081       residual = 2.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.887661405915       residual = 9.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913841975898       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914215949824       residual = 2.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.833503040789       residual = 8.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.928479694830       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.891345693914       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.837365861549       residual = 7.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.744859825872       residual = 3.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.877504057546       residual = 1.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.013182292411       residual = 1.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.750209056471       residual = 2.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.972736260977       residual = 4.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.788124200288       residual = 2.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.848476929261       residual = 2.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.084222013502       residual = 3.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.879002819100       residual = 4.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.751361253732       residual = 2.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.748997798546       residual = 3.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.951599040162       residual = 8.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.936304972693       residual = 2.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -1.139850374556       residual = 8.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -1.470161564576       residual = 4.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -1.196098988022       residual = 1.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -1.015422037082       residual = 8.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.648781649033       residual = 1.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.915758196774       residual = 2.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.735769214242       residual = 1.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.463819768079       residual = 4.54e+01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =       0.158674479636       residual = 1.32e+02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.339105211734       residual = 2.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.790630099638       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.302091792462       residual = 3.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -1.464610990718       residual = 5.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -3.739737661741       residual = 9.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -2.799957755136       residual = 4.54e+02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =       0.021485151937       residual = 2.14e+02           smallest_sin_value = 9.99e-01
davidson iteration   70:   krylov dim =  71   tar_fn =       1.634349706485       residual = 2.09e+03           smallest_sin_value = 9.95e-01
davidson iteration   71 stopping due to small subspace S singular value of 9.06e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+12 is 5.755901e-17

solving harmonic davidson linear method for identity shift 2.1684e+13, overlap shift 2.1684e+14 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910361290017       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910361290017       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.32e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 8.6736e+13, overlap shift 8.6736e+14 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910361290017       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910361290017       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.48e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               6.363231 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8604e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.1876
    reference variance = 0.188112
====================================================
  Execution time = 3.7503e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9916e-01
  Total weights = 1.9737e+06
  Execution time = 3.1349e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290221491790
                                         uncertainty =       0.001851324661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290221491790
                                         uncertainty =       0.001851324661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380928309
  error estimate for blocks of size 2^( 2) =       0.000395981240
  error estimate for blocks of size 2^( 3) =       0.000409688612
  error estimate for blocks of size 2^( 4) =       0.000419806521
  error estimate for blocks of size 2^( 5) =       0.000426069330
  error estimate for blocks of size 2^( 6) =       0.000427085218
  error estimate for blocks of size 2^( 7) =       0.000428989658

      target function =      -0.914038573556
              le_mean =     -17.207123875789
             les_mean =     296.384267149513
             stat err =       0.000425487682
             autocorr =       1.247634816089
   target nu stat err =       0.000425487682
   target dn stat err =       0.002922917772
      target stat err =       0.004587940807
              std dev =       0.538713980536
             le_variance =       0.290212752825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290221491790
                                         uncertainty =       0.001851324661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290221491790
                                         uncertainty =       0.001851324661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380928309
  error estimate for blocks of size 2^( 2) =       0.000395981240
  error estimate for blocks of size 2^( 3) =       0.000409688612
  error estimate for blocks of size 2^( 4) =       0.000419806521
  error estimate for blocks of size 2^( 5) =       0.000426069330
  error estimate for blocks of size 2^( 6) =       0.000427085218
  error estimate for blocks of size 2^( 7) =       0.000428989658

      target function =      -0.914038573556
              le_mean =     -17.207123875789
             les_mean =     296.384267149513
             stat err =       0.000425487682
             autocorr =       1.247634816089
   target nu stat err =       0.000425487682
   target dn stat err =       0.002922917772
      target stat err =       0.004587940807
              std dev =       0.538713980536
             le_variance =       0.290212752825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290221491790
                                         uncertainty =       0.001851324661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290221491790
                                         uncertainty =       0.001851324661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380928309
  error estimate for blocks of size 2^( 2) =       0.000395981240
  error estimate for blocks of size 2^( 3) =       0.000409688612
  error estimate for blocks of size 2^( 4) =       0.000419806521
  error estimate for blocks of size 2^( 5) =       0.000426069330
  error estimate for blocks of size 2^( 6) =       0.000427085218
  error estimate for blocks of size 2^( 7) =       0.000428989658

      target function =      -0.914038573556
              le_mean =     -17.207123875789
             les_mean =     296.384267149513
             stat err =       0.000425487682
             autocorr =       1.247634816089
   target nu stat err =       0.000425487682
   target dn stat err =       0.002922917772
      target stat err =       0.004587940807
              std dev =       0.538713980536
             le_variance =       0.290212752825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290221491790
                                         uncertainty =       0.001851324661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290221491790
                                         uncertainty =       0.001851324661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380928309
  error estimate for blocks of size 2^( 2) =       0.000395981240
  error estimate for blocks of size 2^( 3) =       0.000409688612
  error estimate for blocks of size 2^( 4) =       0.000419806521
  error estimate for blocks of size 2^( 5) =       0.000426069330
  error estimate for blocks of size 2^( 6) =       0.000427085218
  error estimate for blocks of size 2^( 7) =       0.000428989658

      target function =      -0.914038573556
              le_mean =     -17.207123875789
             les_mean =     296.384267149513
             stat err =       0.000425487682
             autocorr =       1.247634816089
   target nu stat err =       0.000425487682
   target dn stat err =       0.002922917772
      target stat err =       0.004587940807
              std dev =       0.538713980536
             le_variance =       0.290212752825


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914038573556        initial
     5.4210e+12     5.4210e+13             5.7559e-17        -0.914038573556  <--
     2.1684e+13     2.1684e+14             0.0000e+00        -0.914038573556
     8.6736e+13     8.6736e+14             0.0000e+00        -0.914038573556

*****************************************************************************
Applying the update for shift_i =   5.4210e+12     and shift_s =   5.4210e+13
*****************************************************************************

  Execution time = 5.3373e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0198e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2096
    reference variance = 0.334176
====================================================
  Execution time = 3.7839e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5408e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9403e-01
  Total weights = 1.973646247e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0904e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288184167580
                                         uncertainty =       0.001788114128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288184167580
                                         uncertainty =       0.001788114128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379546903
  error estimate for blocks of size 2^( 2) =       0.000394178708
  error estimate for blocks of size 2^( 3) =       0.000407411817
  error estimate for blocks of size 2^( 4) =       0.000417392056
  error estimate for blocks of size 2^( 5) =       0.000423280281
  error estimate for blocks of size 2^( 6) =       0.000426674242
  error estimate for blocks of size 2^( 7) =       0.000428451047

      target function =      -0.922070514783
              le_mean =     -17.206222320235
             les_mean =     296.348116886595
             stat err =       0.000423949407
             autocorr =       1.247662604001
   target nu stat err =       0.000423949407
   target dn stat err =       0.002170178770
      target stat err =       0.003493499396
              std dev =       0.536760378424
             le_variance =       0.288111703845


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720622232023e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922082526157       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922082526157       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922082526157       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922082526157       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922642550311       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922082526157       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922227062333       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921129402879       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920436854435       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919669527917       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924607195778       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918815935530       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921015254253       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922241201213       residual = 6.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923428402687       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925248647111       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926377882757       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920846114232       residual = 5.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.926145653067       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927360731694       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.924243445938       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.923905517532       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.928793381263       residual = 7.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931372680241       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916589315183       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919759627222       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.923527271810       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919160430598       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916292216768       residual = 9.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919411471559       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.925212868880       residual = 4.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938561591903       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913446992831       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931097360342       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.905497746291       residual = 3.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.942275080818       residual = 4.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.904314226087       residual = 4.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.928750935772       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937881016267       residual = 3.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936895907117       residual = 3.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.905425436021       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.930987868584       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.914420867960       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.887047803972       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.972827023896       residual = 3.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.952961118122       residual = 2.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -1.009354782057       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.913117548633       residual = 3.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.914702653186       residual = 5.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.919687838232       residual = 3.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.905529716127       residual = 5.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.919309979372       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.875681308078       residual = 6.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.049648633512       residual = 2.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.889996819009       residual = 2.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.665196676774       residual = 7.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.901078441856       residual = 4.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.992591806848       residual = 1.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.920272927767       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.901735661868       residual = 2.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.885487274422       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.932683099553       residual = 6.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.974338693515       residual = 5.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.855837147680       residual = 8.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.008590117715       residual = 1.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.991728054378       residual = 1.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.876636639345       residual = 2.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.158177485081       residual = 8.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.135198066619       residual = 5.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.952901098815       residual = 5.31e+00           smallest_sin_value = 9.99e-01
davidson iteration   70 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after         70 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+12 is 7.365290e-17

solving harmonic davidson linear method for identity shift 5.4210e+12, overlap shift 5.4210e+13 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922082526157       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922082526157       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922082526157       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922082526157       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922082526157       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923822248513       residual = 9.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929559655934       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920584199171       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922953230463       residual = 8.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938460658895       residual = 3.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927349735197       residual = 2.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924933107654       residual = 9.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921082819433       residual = 3.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919967678853       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916621485586       residual = 5.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924992840794       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913691922980       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912756146464       residual = 2.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933356606330       residual = 3.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905223234371       residual = 2.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932350399657       residual = 5.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919785191135       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930879797827       residual = 4.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931784045366       residual = 3.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911480143983       residual = 3.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.904274279321       residual = 5.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.898709162858       residual = 5.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936020197537       residual = 8.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910790535260       residual = 4.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.891032592154       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.860351912909       residual = 4.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.897248010820       residual = 7.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920839278254       residual = 2.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912664238156       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.991791536158       residual = 7.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.878574331555       residual = 2.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.964015654502       residual = 2.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938594755988       residual = 8.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.926530942380       residual = 2.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.950998259588       residual = 1.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.818189858458       residual = 1.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.138457094308       residual = 6.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.071530441562       residual = 2.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.860015325309       residual = 5.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -1.147044996828       residual = 5.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -1.123526313005       residual = 4.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.791336912448       residual = 2.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.650967119748       residual = 9.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.934853044341       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.529230234245       residual = 1.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.085674841342       residual = 3.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -1.077975940351       residual = 3.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.547949241695       residual = 2.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.086677914704       residual = 4.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -1.569461729030       residual = 5.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.552040414150       residual = 2.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.104639510425       residual = 7.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.988965204087       residual = 1.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =       0.309025970808       residual = 1.70e+02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -1.220804336353       residual = 3.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -1.374376273318       residual = 2.44e+01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.817925216562       residual = 1.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.118479762960       residual = 5.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.690962248485       residual = 8.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.116836427560       residual = 1.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.713891009522       residual = 1.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.363912748031       residual = 1.37e+02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.651295409208       residual = 8.99e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.311902579780       residual = 7.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.542829471141       residual = 7.64e+01           smallest_sin_value = 9.98e-01
davidson iteration   70 stopping due to small subspace S singular value of 9.77e-01
davidson solver did not converge after         70 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+12 is 1.816107e-17

solving harmonic davidson linear method for identity shift 2.1684e+13, overlap shift 2.1684e+14 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922082526157       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922082526157       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.02e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               6.616449 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9004e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2376
    reference variance = 0.252187
====================================================
  Execution time = 3.9339e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9707e-01
  Total weights = 1.9739e+06
  Execution time = 3.1574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289006633050
                                         uncertainty =       0.001932824430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289006633050
                                         uncertainty =       0.001932824430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380135015
  error estimate for blocks of size 2^( 2) =       0.000394814479
  error estimate for blocks of size 2^( 3) =       0.000408279983
  error estimate for blocks of size 2^( 4) =       0.000418446769
  error estimate for blocks of size 2^( 5) =       0.000423502993
  error estimate for blocks of size 2^( 6) =       0.000426601721
  error estimate for blocks of size 2^( 7) =       0.000428902639

      target function =      -0.917299543138
              le_mean =     -17.205989450008
             les_mean =     296.343146786387
             stat err =       0.000424363530
             autocorr =       1.246236186458
   target nu stat err =       0.000424363530
   target dn stat err =       0.002661428796
      target stat err =       0.004208423376
              std dev =       0.537592093337
             le_variance =       0.289005258819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289006633050
                                         uncertainty =       0.001932824430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289006633050
                                         uncertainty =       0.001932824430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380135015
  error estimate for blocks of size 2^( 2) =       0.000394814479
  error estimate for blocks of size 2^( 3) =       0.000408279983
  error estimate for blocks of size 2^( 4) =       0.000418446769
  error estimate for blocks of size 2^( 5) =       0.000423502993
  error estimate for blocks of size 2^( 6) =       0.000426601721
  error estimate for blocks of size 2^( 7) =       0.000428902639

      target function =      -0.917299543138
              le_mean =     -17.205989450008
             les_mean =     296.343146786387
             stat err =       0.000424363530
             autocorr =       1.246236186461
   target nu stat err =       0.000424363530
   target dn stat err =       0.002661428796
      target stat err =       0.004208423376
              std dev =       0.537592093337
             le_variance =       0.289005258819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289006633050
                                         uncertainty =       0.001932824430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289006633050
                                         uncertainty =       0.001932824430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380135015
  error estimate for blocks of size 2^( 2) =       0.000394814479
  error estimate for blocks of size 2^( 3) =       0.000408279983
  error estimate for blocks of size 2^( 4) =       0.000418446769
  error estimate for blocks of size 2^( 5) =       0.000423502993
  error estimate for blocks of size 2^( 6) =       0.000426601721
  error estimate for blocks of size 2^( 7) =       0.000428902639

      target function =      -0.917299543138
              le_mean =     -17.205989450008
             les_mean =     296.343146786387
             stat err =       0.000424363530
             autocorr =       1.246236186460
   target nu stat err =       0.000424363530
   target dn stat err =       0.002661428796
      target stat err =       0.004208423376
              std dev =       0.537592093337
             le_variance =       0.289005258819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289006633050
                                         uncertainty =       0.001932824430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289006633050
                                         uncertainty =       0.001932824430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380135015
  error estimate for blocks of size 2^( 2) =       0.000394814479
  error estimate for blocks of size 2^( 3) =       0.000408279983
  error estimate for blocks of size 2^( 4) =       0.000418446769
  error estimate for blocks of size 2^( 5) =       0.000423502993
  error estimate for blocks of size 2^( 6) =       0.000426601721
  error estimate for blocks of size 2^( 7) =       0.000428902639

      target function =      -0.917299543138
              le_mean =     -17.205989450008
             les_mean =     296.343146786387
             stat err =       0.000424363530
             autocorr =       1.246236186458
   target nu stat err =       0.000424363530
   target dn stat err =       0.002661428796
      target stat err =       0.004208423376
              std dev =       0.537592093337
             le_variance =       0.289005258819


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917299543138        initial
     1.3553e+12     1.3553e+13             7.3653e-17        -0.917299543138  <--
     5.4210e+12     5.4210e+13             1.8161e-17        -0.917299543138
     2.1684e+13     2.1684e+14             0.0000e+00        -0.917299543138

*****************************************************************************
Applying the update for shift_i =   1.3553e+12     and shift_s =   1.3553e+13
*****************************************************************************

  Execution time = 5.5205e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0422e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1893
    reference variance = 0.203687
====================================================
  Execution time = 3.7740e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5425e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0246e-01
  Total weights = 1.973708326e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0834e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292523029671
                                         uncertainty =       0.002448578778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292523029671
                                         uncertainty =       0.002448578778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382389405
  error estimate for blocks of size 2^( 2) =       0.000397446937
  error estimate for blocks of size 2^( 3) =       0.000410922563
  error estimate for blocks of size 2^( 4) =       0.000420845710
  error estimate for blocks of size 2^( 5) =       0.000427436700
  error estimate for blocks of size 2^( 6) =       0.000429749320
  error estimate for blocks of size 2^( 7) =       0.000430958631

      target function =      -0.908917563088
              le_mean =     -17.207250058772
             les_mean =     296.391916180397
             stat err =       0.000427247590
             autocorr =       1.248382129686
   target nu stat err =       0.000427247590
   target dn stat err =       0.004052159743
      target stat err =       0.006254354337
              std dev =       0.540780282040
             le_variance =       0.292443313443


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720725005877e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+11, overlap shift 3.3881e+12 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908959465874       residual = 3.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908959465874       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908959465874       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908959465874       residual = 5.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908959465874       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908959465874       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908959465874       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908707142314       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908959465874       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908959465874       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908959465874       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908959465874       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908959465874       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908959465874       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909509903759       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910219181098       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908670110459       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908964316097       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910340920001       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908093526083       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909709128045       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906007957182       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908106164203       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909153825417       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909062777099       residual = 7.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910143317972       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.906181136115       residual = 7.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910660435539       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.905507716589       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.907274218823       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.907156077879       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907219783350       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910677114440       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908407371199       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908768559745       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916546138126       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.910061362196       residual = 5.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.904508090674       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.909615238424       residual = 6.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912956420867       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.913122906340       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.910443477682       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.905554466228       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.910934414929       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.908558715435       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.909316555264       residual = 4.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.906634338722       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.907209852685       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.916238161743       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.909010207171       residual = 8.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.904601611525       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.911970670718       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.920631764232       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.897196921100       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.907062575423       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.910066420345       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.905889197290       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.893639618857       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.913440999975       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.907662247669       residual = 8.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.906255781990       residual = 9.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.902385724989       residual = 7.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.898927966870       residual = 4.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.888367201395       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.915660871477       residual = 5.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.939104264483       residual = 1.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.910747646096       residual = 1.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.830401896979       residual = 1.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.921117640661       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.923817479784       residual = 5.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.776722591539       residual = 2.22e+00           smallest_sin_value = 9.99e-01
davidson iteration   71 stopping due to small subspace S singular value of 9.63e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.3881e+11 is 1.543574e-15

solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908959465874       residual = 3.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908959465874       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908959465874       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908959465874       residual = 5.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908959465874       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908959465874       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908959465874       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908959465874       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908959465874       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908959465874       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908959465874       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908799213291       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912593017086       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907361826119       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908431464912       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910303185919       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910753067582       residual = 5.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909271094431       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906930052052       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.907997983640       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909181631458       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904319680031       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915168940740       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918884347943       residual = 8.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907848485867       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906093946699       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915476234706       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912645342757       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910639477318       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.905429932941       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911894132681       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.927654976436       residual = 3.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911914939339       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918560320698       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.905946319972       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910462333458       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909168601730       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917042113278       residual = 8.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913581107002       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.927766097259       residual = 4.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.925125830658       residual = 2.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.891378654095       residual = 3.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.882371675912       residual = 6.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.931525198149       residual = 4.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.875461922311       residual = 1.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.908466535589       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.929352799301       residual = 4.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.948557108471       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.852674829737       residual = 3.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.925807085496       residual = 6.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.908412726198       residual = 5.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.877584868748       residual = 1.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.870610056047       residual = 2.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.882496214847       residual = 1.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.901744957924       residual = 4.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.868705666048       residual = 2.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.896464249355       residual = 7.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.901401906736       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.864496081879       residual = 2.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.927960112736       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.917737913986       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.872854595158       residual = 4.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.932217167002       residual = 5.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.718866276951       residual = 3.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.164015203693       residual = 7.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.772367470096       residual = 2.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.265046823449       residual = 6.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.851148954238       residual = 5.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.213028983617       residual = 1.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.259376126948       residual = 1.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.051932009955       residual = 1.34e+01           smallest_sin_value = 9.99e-01
davidson iteration   71 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+12 is 3.200661e-16

solving harmonic davidson linear method for identity shift 5.4210e+12, overlap shift 5.4210e+13 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908959465874       residual = 3.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908959465874       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908959465874       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908959465874       residual = 5.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908959465874       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908959465874       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908959465874       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908959465874       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908959465874       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908959465874       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908959465874       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921229133653       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908959465874       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909820799758       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.901161468760       residual = 7.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.903596439632       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908833203222       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.902442742334       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911646104480       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.903903199915       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.899858130639       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.892288419558       residual = 4.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.889611257358       residual = 4.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905563302335       residual = 7.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931880253920       residual = 5.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908727776342       residual = 4.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.907603871712       residual = 7.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909849499658       residual = 6.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914489559700       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.923052090524       residual = 3.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910830507681       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912870912782       residual = 4.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.860932594407       residual = 3.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.898374279479       residual = 4.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.977412857719       residual = 4.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941630053751       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.966929466971       residual = 4.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.877522348454       residual = 1.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.856461345608       residual = 2.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.702592400825       residual = 8.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.875907939165       residual = 2.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.095028308069       residual = 3.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.882230333407       residual = 2.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.986475231330       residual = 1.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.974335438510       residual = 6.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.982012667586       residual = 6.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.829445298449       residual = 1.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -1.063924727995       residual = 4.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.093783468339       residual = 3.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.558998858469       residual = 1.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.290039756851       residual = 1.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -1.234116120561       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.249219139288       residual = 4.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.714310891484       residual = 4.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.795359665343       residual = 2.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -1.028150825146       residual = 3.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.859716146754       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -1.200117962901       residual = 1.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.929171237117       residual = 4.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -1.005084399253       residual = 4.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.787005896636       residual = 8.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.413292661057       residual = 4.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.873491354760       residual = 1.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.670285003780       residual = 2.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.849158307097       residual = 3.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =       0.314980751989       residual = 6.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -1.466632115509       residual = 1.54e+02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.226509738760       residual = 1.44e+02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -2.215907919107       residual = 2.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.245056624344       residual = 4.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.091516896903       residual = 4.07e+02           smallest_sin_value = 9.99e-01
davidson iteration   71 stopping due to small subspace S singular value of 9.77e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+12 is 8.572046e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.006822 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8972e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.2437
    reference variance = 0.394016
====================================================
  Execution time = 3.7542e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0344e-01
  Total weights = 1.9740e+06
  Execution time = 3.1515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289070106071
                                         uncertainty =       0.001510269801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289070106071
                                         uncertainty =       0.001510269801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380183428
  error estimate for blocks of size 2^( 2) =       0.000395476927
  error estimate for blocks of size 2^( 3) =       0.000409304906
  error estimate for blocks of size 2^( 4) =       0.000420116718
  error estimate for blocks of size 2^( 5) =       0.000426016894
  error estimate for blocks of size 2^( 6) =       0.000429593674
  error estimate for blocks of size 2^( 7) =       0.000431548231

      target function =      -0.907275209578
              le_mean =     -17.207372054628
             les_mean =     296.397091299700
             stat err =       0.000426818879
             autocorr =       1.260378187722
   target nu stat err =       0.000426818879
   target dn stat err =       0.008486942324
      target stat err =       0.012989922795
              std dev =       0.537660559504
             le_variance =       0.289078877246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289070106071
                                         uncertainty =       0.001510269801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289070106071
                                         uncertainty =       0.001510269801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380183428
  error estimate for blocks of size 2^( 2) =       0.000395476927
  error estimate for blocks of size 2^( 3) =       0.000409304906
  error estimate for blocks of size 2^( 4) =       0.000420116718
  error estimate for blocks of size 2^( 5) =       0.000426016894
  error estimate for blocks of size 2^( 6) =       0.000429593674
  error estimate for blocks of size 2^( 7) =       0.000431548231

      target function =      -0.907275209578
              le_mean =     -17.207372054628
             les_mean =     296.397091299700
             stat err =       0.000426818879
             autocorr =       1.260378187723
   target nu stat err =       0.000426818879
   target dn stat err =       0.008486942325
      target stat err =       0.012989922795
              std dev =       0.537660559504
             le_variance =       0.289078877246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289070106071
                                         uncertainty =       0.001510269801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289070106071
                                         uncertainty =       0.001510269801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380183428
  error estimate for blocks of size 2^( 2) =       0.000395476927
  error estimate for blocks of size 2^( 3) =       0.000409304906
  error estimate for blocks of size 2^( 4) =       0.000420116718
  error estimate for blocks of size 2^( 5) =       0.000426016894
  error estimate for blocks of size 2^( 6) =       0.000429593674
  error estimate for blocks of size 2^( 7) =       0.000431548231

      target function =      -0.907275209578
              le_mean =     -17.207372054628
             les_mean =     296.397091299700
             stat err =       0.000426818879
             autocorr =       1.260378187721
   target nu stat err =       0.000426818879
   target dn stat err =       0.008486942325
      target stat err =       0.012989922795
              std dev =       0.537660559504
             le_variance =       0.289078877246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289070106071
                                         uncertainty =       0.001510269801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289070106071
                                         uncertainty =       0.001510269801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380183428
  error estimate for blocks of size 2^( 2) =       0.000395476927
  error estimate for blocks of size 2^( 3) =       0.000409304906
  error estimate for blocks of size 2^( 4) =       0.000420116718
  error estimate for blocks of size 2^( 5) =       0.000426016894
  error estimate for blocks of size 2^( 6) =       0.000429593674
  error estimate for blocks of size 2^( 7) =       0.000431548231

      target function =      -0.907275209578
              le_mean =     -17.207372054628
             les_mean =     296.397091299700
             stat err =       0.000426818879
             autocorr =       1.260378187721
   target nu stat err =       0.000426818879
   target dn stat err =       0.008486942324
      target stat err =       0.012989922795
              std dev =       0.537660559504
             le_variance =       0.289078877246


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907275209578        initial
     3.3881e+11     3.3881e+12             1.5436e-15        -0.907275209578
     1.3553e+12     1.3553e+13             3.2007e-16        -0.907275209578
     5.4210e+12     5.4210e+13             8.5720e-17        -0.907275209578  <--

*****************************************************************************
Applying the update for shift_i =   5.4210e+12     and shift_s =   5.4210e+13
*****************************************************************************

  Execution time = 5.3390e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0237e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.1464
    reference variance = 0.1997
====================================================
  Execution time = 3.7663e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5417e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0731e-01
  Total weights = 1.973670980e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0841e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293662027084
                                         uncertainty =       0.003049102629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293662027084
                                         uncertainty =       0.003049102629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383139927
  error estimate for blocks of size 2^( 2) =       0.000398048936
  error estimate for blocks of size 2^( 3) =       0.000411692466
  error estimate for blocks of size 2^( 4) =       0.000422295004
  error estimate for blocks of size 2^( 5) =       0.000428151446
  error estimate for blocks of size 2^( 6) =       0.000431003635
  error estimate for blocks of size 2^( 7) =       0.000434063356

      target function =      -0.901445363198
              le_mean =     -17.207020469763
             les_mean =     296.388867110997
             stat err =       0.000428878360
             autocorr =       1.253006841460
   target nu stat err =       0.000428878360
   target dn stat err =       0.007605678628
      target stat err =       0.011488793326
              std dev =       0.541841681691
             le_variance =       0.293592408018


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720702046976e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901591217899       residual = 3.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901591217899       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901591217899       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901748126546       residual = 9.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901591217790       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902346576202       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901115190663       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901657805434       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901769810403       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902335129740       residual = 8.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.903949213085       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.897481781045       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.900478062306       residual = 6.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.902092571881       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.901392755279       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.902233572545       residual = 7.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.899948822918       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.900181953729       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.901684346713       residual = 8.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.902843999355       residual = 9.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.900458325212       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.898787751541       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916461319997       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917293492506       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.892332478677       residual = 8.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906244054794       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.900787874441       residual = 9.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.901156115442       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.901948562133       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.900394114985       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.896923289438       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.900420587924       residual = 5.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908791654040       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.902273988435       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.886709585965       residual = 3.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.907241970558       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.899458815966       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.892473891202       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917478154073       residual = 4.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.913269192842       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.907031631883       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.922483751595       residual = 4.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.893488496894       residual = 2.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.886052210733       residual = 3.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.908689164803       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.907612100477       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.904121227630       residual = 3.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.891128203412       residual = 5.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.869142429614       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.917204013515       residual = 3.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.900769255813       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.880869276400       residual = 7.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.875766978910       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.898804882759       residual = 8.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.902388468061       residual = 9.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.908411773899       residual = 1.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.901998894355       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.932330864503       residual = 2.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.857095570776       residual = 6.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.889042241522       residual = 3.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.860073450289       residual = 4.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.872680410572       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.025009425724       residual = 2.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.935140465644       residual = 2.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.818693229352       residual = 9.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.945040012504       residual = 5.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.870743144139       residual = 1.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.844248404497       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.013323761277       residual = 3.15e+00           smallest_sin_value = 9.99e-01
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.556644601472       residual = 1.64e+01           smallest_sin_value = 9.98e-01
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.159908689039       residual = 8.87e+00           smallest_sin_value = 9.98e-01
davidson iteration   71 stopping due to small subspace S singular value of 9.12e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+12 is 2.693178e-16

solving harmonic davidson linear method for identity shift 5.4210e+12, overlap shift 5.4210e+13 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901591217899       residual = 3.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901591217899       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901591217899       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901318674902       residual = 7.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897823461496       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901447275426       residual = 7.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902513263185       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.895081490182       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906139300885       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898046715472       residual = 8.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922016913248       residual = 6.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.901208814446       residual = 7.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.897370346834       residual = 3.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905112410284       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   14 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         14 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+12 is 4.798519e-17

solving harmonic davidson linear method for identity shift 2.1684e+13, overlap shift 2.1684e+14 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901591217899       residual = 3.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901591217899       residual = 3.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.34e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.144306 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8649e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2037
    reference variance = 0.258256
====================================================
  Execution time = 3.7543e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9554e-01
  Total weights = 1.9740e+06
  Execution time = 3.1443e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289265827488
                                         uncertainty =       0.001997860010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289265827488
                                         uncertainty =       0.001997860010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380321575
  error estimate for blocks of size 2^( 2) =       0.000395324264
  error estimate for blocks of size 2^( 3) =       0.000409461784
  error estimate for blocks of size 2^( 4) =       0.000419530789
  error estimate for blocks of size 2^( 5) =       0.000424982855
  error estimate for blocks of size 2^( 6) =       0.000429205543
  error estimate for blocks of size 2^( 7) =       0.000430887221

      target function =      -0.919684131521
              le_mean =     -17.207271579852
             les_mean =     296.385734076259
             stat err =       0.000426151602
             autocorr =       1.255527776249
   target nu stat err =       0.000426151602
   target dn stat err =       0.002384814633
      target stat err =       0.003813532667
              std dev =       0.537855929129
             le_variance =       0.289289000499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289265827488
                                         uncertainty =       0.001997860010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289265827488
                                         uncertainty =       0.001997860010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380321575
  error estimate for blocks of size 2^( 2) =       0.000395324264
  error estimate for blocks of size 2^( 3) =       0.000409461784
  error estimate for blocks of size 2^( 4) =       0.000419530789
  error estimate for blocks of size 2^( 5) =       0.000424982855
  error estimate for blocks of size 2^( 6) =       0.000429205543
  error estimate for blocks of size 2^( 7) =       0.000430887221

      target function =      -0.919684131521
              le_mean =     -17.207271579852
             les_mean =     296.385734076259
             stat err =       0.000426151602
             autocorr =       1.255527776251
   target nu stat err =       0.000426151602
   target dn stat err =       0.002384814633
      target stat err =       0.003813532667
              std dev =       0.537855929129
             le_variance =       0.289289000499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289265827488
                                         uncertainty =       0.001997860010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289265827488
                                         uncertainty =       0.001997860010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380321575
  error estimate for blocks of size 2^( 2) =       0.000395324264
  error estimate for blocks of size 2^( 3) =       0.000409461784
  error estimate for blocks of size 2^( 4) =       0.000419530789
  error estimate for blocks of size 2^( 5) =       0.000424982855
  error estimate for blocks of size 2^( 6) =       0.000429205543
  error estimate for blocks of size 2^( 7) =       0.000430887221

      target function =      -0.919684131521
              le_mean =     -17.207271579852
             les_mean =     296.385734076259
             stat err =       0.000426151602
             autocorr =       1.255527776249
   target nu stat err =       0.000426151602
   target dn stat err =       0.002384814633
      target stat err =       0.003813532667
              std dev =       0.537855929129
             le_variance =       0.289289000499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289265827488
                                         uncertainty =       0.001997860010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289265827488
                                         uncertainty =       0.001997860010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380321575
  error estimate for blocks of size 2^( 2) =       0.000395324264
  error estimate for blocks of size 2^( 3) =       0.000409461784
  error estimate for blocks of size 2^( 4) =       0.000419530789
  error estimate for blocks of size 2^( 5) =       0.000424982855
  error estimate for blocks of size 2^( 6) =       0.000429205543
  error estimate for blocks of size 2^( 7) =       0.000430887221

      target function =      -0.919684131521
              le_mean =     -17.207271579852
             les_mean =     296.385734076259
             stat err =       0.000426151602
             autocorr =       1.255527776251
   target nu stat err =       0.000426151602
   target dn stat err =       0.002384814633
      target stat err =       0.003813532667
              std dev =       0.537855929129
             le_variance =       0.289289000499


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919684131521        initial  <--
     1.3553e+12     1.3553e+13             2.6932e-16        -0.919684131521
     5.4210e+12     5.4210e+13             4.7985e-17        -0.919684131521
     2.1684e+13     2.1684e+14             0.0000e+00        -0.919684131521

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.3954
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0205e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2506
    reference variance = 0.29027
====================================================
  Execution time = 3.7890e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5423e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9886e-01
  Total weights = 1.973824599e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0769e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291807793832
                                         uncertainty =       0.003138016023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291807793832
                                         uncertainty =       0.003138016023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381989321
  error estimate for blocks of size 2^( 2) =       0.000396771273
  error estimate for blocks of size 2^( 3) =       0.000410705087
  error estimate for blocks of size 2^( 4) =       0.000421133501
  error estimate for blocks of size 2^( 5) =       0.000427828834
  error estimate for blocks of size 2^( 6) =       0.000432432632
  error estimate for blocks of size 2^( 7) =       0.000434386047

      target function =      -0.914485539762
              le_mean =     -17.207000626521
             les_mean =     296.379733136713
             stat err =       0.000428945253
             autocorr =       1.260959938892
   target nu stat err =       0.000428945253
   target dn stat err =       0.003490942651
      target stat err =       0.005464119461
              std dev =       0.540214478381
             le_variance =       0.291831682652


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720700062652e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+13, overlap shift 1.3553e+14 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914517380818       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914517380818       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.4210e+13, overlap shift 5.4210e+14 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914517380818       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914517380818       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.1684e+14, overlap shift 2.1684e+15 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914517380818       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914517380818       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.145415 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8668e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2057
    reference variance = 0.198934
====================================================
  Execution time = 3.9201e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9887e-01
  Total weights = 1.9738e+06
  Execution time = 3.1649e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288960219776
                                         uncertainty =       0.001739372223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288960219776
                                         uncertainty =       0.001739372223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380070491
  error estimate for blocks of size 2^( 2) =       0.000394672883
  error estimate for blocks of size 2^( 3) =       0.000408276299
  error estimate for blocks of size 2^( 4) =       0.000418082460
  error estimate for blocks of size 2^( 5) =       0.000423840433
  error estimate for blocks of size 2^( 6) =       0.000426743452
  error estimate for blocks of size 2^( 7) =       0.000428900243

      target function =      -0.914479486257
              le_mean =     -17.206934383422
             les_mean =     296.377465126801
             stat err =       0.000424391647
             autocorr =       1.246824566896
   target nu stat err =       0.000424391647
   target dn stat err =       0.002869921417
      target stat err =       0.004509237977
              std dev =       0.537500843358
             le_variance =       0.288907156611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288960219776
                                         uncertainty =       0.001739372223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288960219776
                                         uncertainty =       0.001739372223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380070491
  error estimate for blocks of size 2^( 2) =       0.000394672883
  error estimate for blocks of size 2^( 3) =       0.000408276299
  error estimate for blocks of size 2^( 4) =       0.000418082460
  error estimate for blocks of size 2^( 5) =       0.000423840433
  error estimate for blocks of size 2^( 6) =       0.000426743452
  error estimate for blocks of size 2^( 7) =       0.000428900243

      target function =      -0.914479486257
              le_mean =     -17.206934383422
             les_mean =     296.377465126801
             stat err =       0.000424391647
             autocorr =       1.246824566896
   target nu stat err =       0.000424391647
   target dn stat err =       0.002869921417
      target stat err =       0.004509237977
              std dev =       0.537500843358
             le_variance =       0.288907156611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288960219776
                                         uncertainty =       0.001739372223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288960219776
                                         uncertainty =       0.001739372223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380070491
  error estimate for blocks of size 2^( 2) =       0.000394672883
  error estimate for blocks of size 2^( 3) =       0.000408276299
  error estimate for blocks of size 2^( 4) =       0.000418082460
  error estimate for blocks of size 2^( 5) =       0.000423840433
  error estimate for blocks of size 2^( 6) =       0.000426743452
  error estimate for blocks of size 2^( 7) =       0.000428900243

      target function =      -0.914479486257
              le_mean =     -17.206934383422
             les_mean =     296.377465126801
             stat err =       0.000424391647
             autocorr =       1.246824566896
   target nu stat err =       0.000424391647
   target dn stat err =       0.002869921417
      target stat err =       0.004509237977
              std dev =       0.537500843358
             le_variance =       0.288907156611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288960219776
                                         uncertainty =       0.001739372223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288960219776
                                         uncertainty =       0.001739372223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380070491
  error estimate for blocks of size 2^( 2) =       0.000394672883
  error estimate for blocks of size 2^( 3) =       0.000408276299
  error estimate for blocks of size 2^( 4) =       0.000418082460
  error estimate for blocks of size 2^( 5) =       0.000423840433
  error estimate for blocks of size 2^( 6) =       0.000426743452
  error estimate for blocks of size 2^( 7) =       0.000428900243

      target function =      -0.914479486257
              le_mean =     -17.206934383422
             les_mean =     296.377465126801
             stat err =       0.000424391647
             autocorr =       1.246824566896
   target nu stat err =       0.000424391647
   target dn stat err =       0.002869921417
      target stat err =       0.004509237977
              std dev =       0.537500843358
             le_variance =       0.288907156611


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914479486257        initial  <--
     1.3553e+13     1.3553e+14             0.0000e+00        -0.914479486257
     5.4210e+13     5.4210e+14             0.0000e+00        -0.914479486257
     2.1684e+14     2.1684e+15             0.0000e+00        -0.914479486257

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 55.0182
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0369e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.1566
    reference variance = 0.279195
====================================================
  Execution time = 3.7786e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5435e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9803e-01
  Total weights = 1.973921067e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0837e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291008107224
                                         uncertainty =       0.001790559593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291008107224
                                         uncertainty =       0.001790559593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381423292
  error estimate for blocks of size 2^( 2) =       0.000396434285
  error estimate for blocks of size 2^( 3) =       0.000409621905
  error estimate for blocks of size 2^( 4) =       0.000419815941
  error estimate for blocks of size 2^( 5) =       0.000426670251
  error estimate for blocks of size 2^( 6) =       0.000431001906
  error estimate for blocks of size 2^( 7) =       0.000434015004

      target function =      -0.915794494722
              le_mean =     -17.207032763246
             les_mean =     296.380008773108
             stat err =       0.000427875776
             autocorr =       1.258406571019
   target nu stat err =       0.000427875776
   target dn stat err =       0.002179525961
      target stat err =       0.003467921100
              std dev =       0.539413993248
             le_variance =       0.290967456112


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720703276325e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+14, overlap shift 1.3553e+15 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915806617362       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915806617362       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.4210e+14, overlap shift 5.4210e+15 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915806617362       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915806617362       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.65e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.1684e+15, overlap shift 2.1684e+16 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915806617362       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915806617362       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.146534 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8632e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2134
    reference variance = 0.186761
====================================================
  Execution time = 3.7685e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9608e-01
  Total weights = 1.9736e+06
  Execution time = 3.1561e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287901272132
                                         uncertainty =       0.001679768813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287901272132
                                         uncertainty =       0.001679768813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379352418
  error estimate for blocks of size 2^( 2) =       0.000394552074
  error estimate for blocks of size 2^( 3) =       0.000408562580
  error estimate for blocks of size 2^( 4) =       0.000418919628
  error estimate for blocks of size 2^( 5) =       0.000424517281
  error estimate for blocks of size 2^( 6) =       0.000428356479
  error estimate for blocks of size 2^( 7) =       0.000431548881

      target function =      -0.918850383388
              le_mean =     -17.206747621502
             les_mean =     296.368240546543
             stat err =       0.000425835567
             autocorr =       1.260080098476
   target nu stat err =       0.000425835567
   target dn stat err =       0.002261502868
      target stat err =       0.003613643987
              std dev =       0.536485333973
             le_variance =       0.287816513568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287901272132
                                         uncertainty =       0.001679768813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287901272132
                                         uncertainty =       0.001679768813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379352418
  error estimate for blocks of size 2^( 2) =       0.000394552074
  error estimate for blocks of size 2^( 3) =       0.000408562580
  error estimate for blocks of size 2^( 4) =       0.000418919628
  error estimate for blocks of size 2^( 5) =       0.000424517281
  error estimate for blocks of size 2^( 6) =       0.000428356479
  error estimate for blocks of size 2^( 7) =       0.000431548881

      target function =      -0.918850383388
              le_mean =     -17.206747621502
             les_mean =     296.368240546543
             stat err =       0.000425835567
             autocorr =       1.260080098476
   target nu stat err =       0.000425835567
   target dn stat err =       0.002261502868
      target stat err =       0.003613643987
              std dev =       0.536485333973
             le_variance =       0.287816513568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287901272132
                                         uncertainty =       0.001679768813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287901272132
                                         uncertainty =       0.001679768813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379352418
  error estimate for blocks of size 2^( 2) =       0.000394552074
  error estimate for blocks of size 2^( 3) =       0.000408562580
  error estimate for blocks of size 2^( 4) =       0.000418919628
  error estimate for blocks of size 2^( 5) =       0.000424517281
  error estimate for blocks of size 2^( 6) =       0.000428356479
  error estimate for blocks of size 2^( 7) =       0.000431548881

      target function =      -0.918850383388
              le_mean =     -17.206747621502
             les_mean =     296.368240546543
             stat err =       0.000425835567
             autocorr =       1.260080098476
   target nu stat err =       0.000425835567
   target dn stat err =       0.002261502868
      target stat err =       0.003613643987
              std dev =       0.536485333973
             le_variance =       0.287816513568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287901272132
                                         uncertainty =       0.001679768813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287901272132
                                         uncertainty =       0.001679768813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379352418
  error estimate for blocks of size 2^( 2) =       0.000394552074
  error estimate for blocks of size 2^( 3) =       0.000408562580
  error estimate for blocks of size 2^( 4) =       0.000418919628
  error estimate for blocks of size 2^( 5) =       0.000424517281
  error estimate for blocks of size 2^( 6) =       0.000428356479
  error estimate for blocks of size 2^( 7) =       0.000431548881

      target function =      -0.918850383388
              le_mean =     -17.206747621502
             les_mean =     296.368240546543
             stat err =       0.000425835567
             autocorr =       1.260080098476
   target nu stat err =       0.000425835567
   target dn stat err =       0.002261502868
      target stat err =       0.003613643987
              std dev =       0.536485333973
             le_variance =       0.287816513568


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918850383388        initial  <--
     1.3553e+14     1.3553e+15             0.0000e+00        -0.918850383388
     5.4210e+14     5.4210e+15             0.0000e+00        -0.918850383388
     2.1684e+15     2.1684e+16             0.0000e+00        -0.918850383388

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.5449
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0218e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.3321
    reference variance = 0.846316
====================================================
  Execution time = 3.7811e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5404e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 2.9818e-01
  Total weights = 1.974067413e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0809e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290170328728
                                         uncertainty =       0.002168099330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290170328728
                                         uncertainty =       0.002168099330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380973492
  error estimate for blocks of size 2^( 2) =       0.000396004123
  error estimate for blocks of size 2^( 3) =       0.000409455889
  error estimate for blocks of size 2^( 4) =       0.000419279275
  error estimate for blocks of size 2^( 5) =       0.000425304338
  error estimate for blocks of size 2^( 6) =       0.000427442620
  error estimate for blocks of size 2^( 7) =       0.000428335700

      target function =      -0.915556770191
              le_mean =     -17.207501889512
             les_mean =     296.396296304137
             stat err =       0.000425090484
             autocorr =       1.245011168972
   target nu stat err =       0.000425090484
   target dn stat err =       0.002578167073
      target stat err =       0.004077066342
              std dev =       0.538777879436
             le_variance =       0.290281603370


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720750188951e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+15, overlap shift 1.3553e+16 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915573951537       residual = 9.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915573951537       residual = 9.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.4210e+15, overlap shift 5.4210e+16 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915573951537       residual = 9.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915573951537       residual = 9.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.69e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.1684e+16, overlap shift 2.1684e+17 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915573951537       residual = 9.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915573951537       residual = 9.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.147744 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8629e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2338
    reference variance = 0.28859
====================================================
  Execution time = 3.7471e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9519e-01
  Total weights = 1.9739e+06
  Execution time = 3.1476e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287941480794
                                         uncertainty =       0.001372852532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287941480794
                                         uncertainty =       0.001372852532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379384520
  error estimate for blocks of size 2^( 2) =       0.000394249425
  error estimate for blocks of size 2^( 3) =       0.000408377828
  error estimate for blocks of size 2^( 4) =       0.000418508799
  error estimate for blocks of size 2^( 5) =       0.000424417077
  error estimate for blocks of size 2^( 6) =       0.000427270452
  error estimate for blocks of size 2^( 7) =       0.000427321646

      target function =      -0.920247151820
              le_mean =     -17.206892431273
             les_mean =     296.372334128160
             stat err =       0.000424379494
             autocorr =       1.251265784513
   target nu stat err =       0.000424379494
   target dn stat err =       0.001927219358
      target stat err =       0.003112227528
              std dev =       0.536530732864
             le_variance =       0.287865227308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287941480794
                                         uncertainty =       0.001372852532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287941480794
                                         uncertainty =       0.001372852532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379384520
  error estimate for blocks of size 2^( 2) =       0.000394249425
  error estimate for blocks of size 2^( 3) =       0.000408377828
  error estimate for blocks of size 2^( 4) =       0.000418508799
  error estimate for blocks of size 2^( 5) =       0.000424417077
  error estimate for blocks of size 2^( 6) =       0.000427270452
  error estimate for blocks of size 2^( 7) =       0.000427321646

      target function =      -0.920247151820
              le_mean =     -17.206892431273
             les_mean =     296.372334128160
             stat err =       0.000424379494
             autocorr =       1.251265784513
   target nu stat err =       0.000424379494
   target dn stat err =       0.001927219358
      target stat err =       0.003112227528
              std dev =       0.536530732864
             le_variance =       0.287865227308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287941480794
                                         uncertainty =       0.001372852532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287941480794
                                         uncertainty =       0.001372852532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379384520
  error estimate for blocks of size 2^( 2) =       0.000394249425
  error estimate for blocks of size 2^( 3) =       0.000408377828
  error estimate for blocks of size 2^( 4) =       0.000418508799
  error estimate for blocks of size 2^( 5) =       0.000424417077
  error estimate for blocks of size 2^( 6) =       0.000427270452
  error estimate for blocks of size 2^( 7) =       0.000427321646

      target function =      -0.920247151820
              le_mean =     -17.206892431273
             les_mean =     296.372334128160
             stat err =       0.000424379494
             autocorr =       1.251265784513
   target nu stat err =       0.000424379494
   target dn stat err =       0.001927219358
      target stat err =       0.003112227528
              std dev =       0.536530732864
             le_variance =       0.287865227308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287941480794
                                         uncertainty =       0.001372852532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287941480794
                                         uncertainty =       0.001372852532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379384520
  error estimate for blocks of size 2^( 2) =       0.000394249425
  error estimate for blocks of size 2^( 3) =       0.000408377828
  error estimate for blocks of size 2^( 4) =       0.000418508799
  error estimate for blocks of size 2^( 5) =       0.000424417077
  error estimate for blocks of size 2^( 6) =       0.000427270452
  error estimate for blocks of size 2^( 7) =       0.000427321646

      target function =      -0.920247151820
              le_mean =     -17.206892431273
             les_mean =     296.372334128160
             stat err =       0.000424379494
             autocorr =       1.251265784513
   target nu stat err =       0.000424379494
   target dn stat err =       0.001927219358
      target stat err =       0.003112227528
              std dev =       0.536530732864
             le_variance =       0.287865227308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920247151820        initial  <--
     1.3553e+15     1.3553e+16             0.0000e+00        -0.920247151820
     5.4210e+15     5.4210e+16             0.0000e+00        -0.920247151820
     2.1684e+16     2.1684e+17             0.0000e+00        -0.920247151820

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.3348
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0197e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.1751
    reference variance = 0.315299
====================================================
  Execution time = 3.7566e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5425e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0164e-01
  Total weights = 1.973805301e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0942e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291511674423
                                         uncertainty =       0.002041349967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291511674423
                                         uncertainty =       0.002041349967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381880529
  error estimate for blocks of size 2^( 2) =       0.000396517516
  error estimate for blocks of size 2^( 3) =       0.000410054693
  error estimate for blocks of size 2^( 4) =       0.000420856601
  error estimate for blocks of size 2^( 5) =       0.000427687934
  error estimate for blocks of size 2^( 6) =       0.000430122966
  error estimate for blocks of size 2^( 7) =       0.000431335459

      target function =      -0.910211705352
              le_mean =     -17.206978998055
             les_mean =     296.381762956928
             stat err =       0.000427500740
             autocorr =       1.253195162253
   target nu stat err =       0.000427500740
   target dn stat err =       0.003000244541
      target stat err =       0.004666761524
              std dev =       0.540060623840
             le_variance =       0.291665477422


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720697899806e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+16, overlap shift 1.3553e+17 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910234571189       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910234571189       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.47e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.4210e+16, overlap shift 5.4210e+17 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910234571189       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910234571189       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+17, overlap shift 2.1684e+18 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910234571189       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910234571189       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.148940 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8516e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.191
    reference variance = 0.241184
====================================================
  Execution time = 4.9107e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0097e-01
  Total weights = 1.9737e+06
  Execution time = 3.1286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293083992553
                                         uncertainty =       0.002460114304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293083992553
                                         uncertainty =       0.002460114304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382808262
  error estimate for blocks of size 2^( 2) =       0.000397566360
  error estimate for blocks of size 2^( 3) =       0.000410887078
  error estimate for blocks of size 2^( 4) =       0.000420013860
  error estimate for blocks of size 2^( 5) =       0.000426226474
  error estimate for blocks of size 2^( 6) =       0.000428454571
  error estimate for blocks of size 2^( 7) =       0.000429468407

      target function =      -0.911237329918
              le_mean =     -17.206668619298
             les_mean =     296.370419605258
             stat err =       0.000426040828
             autocorr =       1.238624979336
   target nu stat err =       0.000426040828
   target dn stat err =       0.003129264167
      target stat err =       0.004870428155
              std dev =       0.541372636351
             le_variance =       0.293084331389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293083992553
                                         uncertainty =       0.002460114304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293083992553
                                         uncertainty =       0.002460114304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382808262
  error estimate for blocks of size 2^( 2) =       0.000397566360
  error estimate for blocks of size 2^( 3) =       0.000410887078
  error estimate for blocks of size 2^( 4) =       0.000420013860
  error estimate for blocks of size 2^( 5) =       0.000426226474
  error estimate for blocks of size 2^( 6) =       0.000428454571
  error estimate for blocks of size 2^( 7) =       0.000429468407

      target function =      -0.911237329918
              le_mean =     -17.206668619298
             les_mean =     296.370419605258
             stat err =       0.000426040828
             autocorr =       1.238624979336
   target nu stat err =       0.000426040828
   target dn stat err =       0.003129264167
      target stat err =       0.004870428155
              std dev =       0.541372636351
             le_variance =       0.293084331389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293083992553
                                         uncertainty =       0.002460114304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293083992553
                                         uncertainty =       0.002460114304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382808262
  error estimate for blocks of size 2^( 2) =       0.000397566360
  error estimate for blocks of size 2^( 3) =       0.000410887078
  error estimate for blocks of size 2^( 4) =       0.000420013860
  error estimate for blocks of size 2^( 5) =       0.000426226474
  error estimate for blocks of size 2^( 6) =       0.000428454571
  error estimate for blocks of size 2^( 7) =       0.000429468407

      target function =      -0.911237329918
              le_mean =     -17.206668619298
             les_mean =     296.370419605258
             stat err =       0.000426040828
             autocorr =       1.238624979336
   target nu stat err =       0.000426040828
   target dn stat err =       0.003129264167
      target stat err =       0.004870428155
              std dev =       0.541372636351
             le_variance =       0.293084331389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293083992553
                                         uncertainty =       0.002460114304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293083992553
                                         uncertainty =       0.002460114304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382808262
  error estimate for blocks of size 2^( 2) =       0.000397566360
  error estimate for blocks of size 2^( 3) =       0.000410887078
  error estimate for blocks of size 2^( 4) =       0.000420013860
  error estimate for blocks of size 2^( 5) =       0.000426226474
  error estimate for blocks of size 2^( 6) =       0.000428454571
  error estimate for blocks of size 2^( 7) =       0.000429468407

      target function =      -0.911237329918
              le_mean =     -17.206668619298
             les_mean =     296.370419605258
             stat err =       0.000426040828
             autocorr =       1.238624979336
   target nu stat err =       0.000426040828
   target dn stat err =       0.003129264167
      target stat err =       0.004870428155
              std dev =       0.541372636351
             le_variance =       0.293084331389


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911237329918        initial  <--
     1.3553e+16     1.3553e+17             0.0000e+00        -0.911237329918
     5.4210e+16     5.4210e+17             0.0000e+00        -0.911237329918
     2.1684e+17     2.1684e+18             0.0000e+00        -0.911237329918

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.8753
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1340e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2317
    reference variance = 0.366212
====================================================
  Execution time = 3.7580e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5417e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9719e-01
  Total weights = 1.973543881e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0952e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289458212908
                                         uncertainty =       0.001543913018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289458212908
                                         uncertainty =       0.001543913018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380433622
  error estimate for blocks of size 2^( 2) =       0.000395546538
  error estimate for blocks of size 2^( 3) =       0.000408969278
  error estimate for blocks of size 2^( 4) =       0.000418770018
  error estimate for blocks of size 2^( 5) =       0.000424148785
  error estimate for blocks of size 2^( 6) =       0.000426874666
  error estimate for blocks of size 2^( 7) =       0.000428074416

      target function =      -0.917099185402
              le_mean =     -17.207073766282
             les_mean =     296.380581457499
             stat err =       0.000424466971
             autocorr =       1.244887256957
   target nu stat err =       0.000424466971
   target dn stat err =       0.002236437772
      target stat err =       0.003563563015
              std dev =       0.538014387336
             le_variance =       0.289459480980


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720707376628e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+17, overlap shift 1.3553e+18 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917112082691       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917112082691       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917112082691       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -1.861189396124       residual = 1.04e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       1.655157645121       residual = 5.84e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+17 is 1.153709e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+17, overlap shift 5.4210e+18 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917112082691       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917112082691       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917112082691       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+17 is 2.884271e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+18, overlap shift 2.1684e+19 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917112082691       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917112082691       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917112082691       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+18 is 7.210679e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.150555 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8541e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.1872
    reference variance = 0.171983
====================================================
  Execution time = 3.7153e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9895e-01
  Total weights = 1.9738e+06
  Execution time = 3.1527e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290523095378
                                         uncertainty =       0.002322095606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290523095378
                                         uncertainty =       0.002322095606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381130471
  error estimate for blocks of size 2^( 2) =       0.000396085601
  error estimate for blocks of size 2^( 3) =       0.000409686327
  error estimate for blocks of size 2^( 4) =       0.000419470126
  error estimate for blocks of size 2^( 5) =       0.000425312293
  error estimate for blocks of size 2^( 6) =       0.000429603247
  error estimate for blocks of size 2^( 7) =       0.000431535093

      target function =      -0.914358209863
              le_mean =     -17.206838328126
             les_mean =     296.374235417280
             stat err =       0.000426480190
             autocorr =       1.252132773837
   target nu stat err =       0.000426480190
   target dn stat err =       0.003242422726
      target stat err =       0.005078734087
              std dev =       0.538999880683
             le_variance =       0.290520871377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290523095378
                                         uncertainty =       0.002322095606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290523095378
                                         uncertainty =       0.002322095606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381130471
  error estimate for blocks of size 2^( 2) =       0.000396085601
  error estimate for blocks of size 2^( 3) =       0.000409686327
  error estimate for blocks of size 2^( 4) =       0.000419470126
  error estimate for blocks of size 2^( 5) =       0.000425312293
  error estimate for blocks of size 2^( 6) =       0.000429603247
  error estimate for blocks of size 2^( 7) =       0.000431535093

      target function =      -0.914358209863
              le_mean =     -17.206838328126
             les_mean =     296.374235417280
             stat err =       0.000426480190
             autocorr =       1.252132773837
   target nu stat err =       0.000426480190
   target dn stat err =       0.003242422726
      target stat err =       0.005078734087
              std dev =       0.538999880683
             le_variance =       0.290520871377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290523095378
                                         uncertainty =       0.002322095606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290523095378
                                         uncertainty =       0.002322095606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381130471
  error estimate for blocks of size 2^( 2) =       0.000396085601
  error estimate for blocks of size 2^( 3) =       0.000409686327
  error estimate for blocks of size 2^( 4) =       0.000419470126
  error estimate for blocks of size 2^( 5) =       0.000425312293
  error estimate for blocks of size 2^( 6) =       0.000429603247
  error estimate for blocks of size 2^( 7) =       0.000431535093

      target function =      -0.914358209863
              le_mean =     -17.206838328126
             les_mean =     296.374235417280
             stat err =       0.000426480190
             autocorr =       1.252132773837
   target nu stat err =       0.000426480190
   target dn stat err =       0.003242422726
      target stat err =       0.005078734087
              std dev =       0.538999880683
             le_variance =       0.290520871377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290523095378
                                         uncertainty =       0.002322095606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290523095378
                                         uncertainty =       0.002322095606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381130471
  error estimate for blocks of size 2^( 2) =       0.000396085601
  error estimate for blocks of size 2^( 3) =       0.000409686327
  error estimate for blocks of size 2^( 4) =       0.000419470126
  error estimate for blocks of size 2^( 5) =       0.000425312293
  error estimate for blocks of size 2^( 6) =       0.000429603247
  error estimate for blocks of size 2^( 7) =       0.000431535093

      target function =      -0.914358209863
              le_mean =     -17.206838328126
             les_mean =     296.374235417280
             stat err =       0.000426480190
             autocorr =       1.252132773837
   target nu stat err =       0.000426480190
   target dn stat err =       0.003242422726
      target stat err =       0.005078734087
              std dev =       0.538999880683
             le_variance =       0.290520871377


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914358209863        initial  <--
     1.3553e+17     1.3553e+18             1.1537e-21        -0.914358209863
     5.4210e+17     5.4210e+18             2.8843e-22        -0.914358209863
     2.1684e+18     2.1684e+19             7.2107e-23        -0.914358209863

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.0201
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0157e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.1612
    reference variance = 0.323001
====================================================
  Execution time = 3.7825e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5434e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0450e-01
  Total weights = 1.973925444e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0666e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292823775702
                                         uncertainty =       0.003788721098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292823775702
                                         uncertainty =       0.003788721098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382633064
  error estimate for blocks of size 2^( 2) =       0.000397610299
  error estimate for blocks of size 2^( 3) =       0.000411422584
  error estimate for blocks of size 2^( 4) =       0.000421665314
  error estimate for blocks of size 2^( 5) =       0.000426774154
  error estimate for blocks of size 2^( 6) =       0.000430478135
  error estimate for blocks of size 2^( 7) =       0.000430951056

      target function =      -0.905727045190
              le_mean =     -17.206270494392
             les_mean =     296.360244118968
             stat err =       0.000427467164
             autocorr =       1.248074555279
   target nu stat err =       0.000427467164
   target dn stat err =       0.007804811550
      target stat err =       0.011883923803
              std dev =       0.541124868919
             le_variance =       0.292816123763


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720627049439e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+18, overlap shift 1.3553e+19 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905882688248       residual = 4.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905882688248       residual = 4.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+18, overlap shift 5.4210e+19 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905882688248       residual = 4.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905882688248       residual = 4.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+19, overlap shift 2.1684e+20 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905882688248       residual = 4.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905882688248       residual = 4.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.151708 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8500e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.1642
    reference variance = 0.211342
====================================================
  Execution time = 3.7655e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9898e-01
  Total weights = 1.9737e+06
  Execution time = 3.1564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290889797525
                                         uncertainty =       0.001542581070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290889797525
                                         uncertainty =       0.001542581070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381369944
  error estimate for blocks of size 2^( 2) =       0.000396230234
  error estimate for blocks of size 2^( 3) =       0.000410189018
  error estimate for blocks of size 2^( 4) =       0.000420327888
  error estimate for blocks of size 2^( 5) =       0.000426624660
  error estimate for blocks of size 2^( 6) =       0.000428913280
  error estimate for blocks of size 2^( 7) =       0.000429925835

      target function =      -0.914319935742
              le_mean =     -17.206906789952
             les_mean =     296.376622489029
             stat err =       0.000426447916
             autocorr =       1.250371497628
   target nu stat err =       0.000426447916
   target dn stat err =       0.002470547121
      target stat err =       0.003898067324
              std dev =       0.539338547421
             le_variance =       0.290886068734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290889797525
                                         uncertainty =       0.001542581070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290889797525
                                         uncertainty =       0.001542581070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381369944
  error estimate for blocks of size 2^( 2) =       0.000396230234
  error estimate for blocks of size 2^( 3) =       0.000410189018
  error estimate for blocks of size 2^( 4) =       0.000420327888
  error estimate for blocks of size 2^( 5) =       0.000426624660
  error estimate for blocks of size 2^( 6) =       0.000428913280
  error estimate for blocks of size 2^( 7) =       0.000429925835

      target function =      -0.914319935742
              le_mean =     -17.206906789952
             les_mean =     296.376622489029
             stat err =       0.000426447916
             autocorr =       1.250371497628
   target nu stat err =       0.000426447916
   target dn stat err =       0.002470547121
      target stat err =       0.003898067324
              std dev =       0.539338547421
             le_variance =       0.290886068734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290889797525
                                         uncertainty =       0.001542581070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290889797525
                                         uncertainty =       0.001542581070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381369944
  error estimate for blocks of size 2^( 2) =       0.000396230234
  error estimate for blocks of size 2^( 3) =       0.000410189018
  error estimate for blocks of size 2^( 4) =       0.000420327888
  error estimate for blocks of size 2^( 5) =       0.000426624660
  error estimate for blocks of size 2^( 6) =       0.000428913280
  error estimate for blocks of size 2^( 7) =       0.000429925835

      target function =      -0.914319935742
              le_mean =     -17.206906789952
             les_mean =     296.376622489029
             stat err =       0.000426447916
             autocorr =       1.250371497628
   target nu stat err =       0.000426447916
   target dn stat err =       0.002470547121
      target stat err =       0.003898067324
              std dev =       0.539338547421
             le_variance =       0.290886068734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290889797525
                                         uncertainty =       0.001542581070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290889797525
                                         uncertainty =       0.001542581070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381369944
  error estimate for blocks of size 2^( 2) =       0.000396230234
  error estimate for blocks of size 2^( 3) =       0.000410189018
  error estimate for blocks of size 2^( 4) =       0.000420327888
  error estimate for blocks of size 2^( 5) =       0.000426624660
  error estimate for blocks of size 2^( 6) =       0.000428913280
  error estimate for blocks of size 2^( 7) =       0.000429925835

      target function =      -0.914319935742
              le_mean =     -17.206906789952
             les_mean =     296.376622489029
             stat err =       0.000426447916
             autocorr =       1.250371497628
   target nu stat err =       0.000426447916
   target dn stat err =       0.002470547121
      target stat err =       0.003898067324
              std dev =       0.539338547421
             le_variance =       0.290886068734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914319935742        initial  <--
     1.3553e+18     1.3553e+19             0.0000e+00        -0.914319935742
     5.4210e+18     5.4210e+19             0.0000e+00        -0.914319935742
     2.1684e+19     2.1684e+20             0.0000e+00        -0.914319935742

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.4885
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0200e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2058
    reference variance = 0.253613
====================================================
  Execution time = 3.7795e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5438e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9800e-01
  Total weights = 1.973896263e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0933e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290215758969
                                         uncertainty =       0.001888294250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290215758969
                                         uncertainty =       0.001888294250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380869363
  error estimate for blocks of size 2^( 2) =       0.000395680147
  error estimate for blocks of size 2^( 3) =       0.000409384699
  error estimate for blocks of size 2^( 4) =       0.000419831845
  error estimate for blocks of size 2^( 5) =       0.000425489458
  error estimate for blocks of size 2^( 6) =       0.000428874577
  error estimate for blocks of size 2^( 7) =       0.000429111186

      target function =      -0.915855962214
              le_mean =     -17.206718346971
             les_mean =     296.369152940769
             stat err =       0.000425826767
             autocorr =       1.250011002734
   target nu stat err =       0.000425826767
   target dn stat err =       0.002226251310
      target stat err =       0.003536724656
              std dev =       0.538630618086
             le_variance =       0.290122942740


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720671834697e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+19, overlap shift 1.3553e+20 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915868541582       residual = 6.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915868541582       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915868541582       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915868541582       residual = 7.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915866734667       residual = 6.39e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915868541582       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+19 is 7.933056e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+19, overlap shift 5.4210e+20 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915868541582       residual = 6.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915868541582       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915868541582       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915868541582       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915868541422       residual = 1.73e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915868542381       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915771483289       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+19 is 1.983386e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+20, overlap shift 2.1684e+21 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915868541582       residual = 6.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915868541582       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915868541582       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915868541582       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915868547861       residual = 1.45e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915868541575       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+20 is 4.958298e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.154269 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9117e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.1798
    reference variance = 0.247885
====================================================
  Execution time = 3.7572e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7208e+01
  VMC Evar = 2.9661e-01
  Total weights = 1.9738e+06
  Execution time = 3.1455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288709433296
                                         uncertainty =       0.001933468839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288709433296
                                         uncertainty =       0.001933468839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379940569
  error estimate for blocks of size 2^( 2) =       0.000394967055
  error estimate for blocks of size 2^( 3) =       0.000408926107
  error estimate for blocks of size 2^( 4) =       0.000418114922
  error estimate for blocks of size 2^( 5) =       0.000424272927
  error estimate for blocks of size 2^( 6) =       0.000426136581
  error estimate for blocks of size 2^( 7) =       0.000427862946

      target function =      -0.917993559205
              le_mean =     -17.207514657550
             les_mean =     296.395175405420
             stat err =       0.000424096844
             autocorr =       1.245944631489
   target nu stat err =       0.000424096844
   target dn stat err =       0.002423161351
      target stat err =       0.003859750805
              std dev =       0.537317105642
             le_variance =       0.288709672016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288709433296
                                         uncertainty =       0.001933468839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288709433296
                                         uncertainty =       0.001933468839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379940569
  error estimate for blocks of size 2^( 2) =       0.000394967055
  error estimate for blocks of size 2^( 3) =       0.000408926107
  error estimate for blocks of size 2^( 4) =       0.000418114922
  error estimate for blocks of size 2^( 5) =       0.000424272927
  error estimate for blocks of size 2^( 6) =       0.000426136581
  error estimate for blocks of size 2^( 7) =       0.000427862946

      target function =      -0.917993559205
              le_mean =     -17.207514657550
             les_mean =     296.395175405420
             stat err =       0.000424096844
             autocorr =       1.245944631489
   target nu stat err =       0.000424096844
   target dn stat err =       0.002423161351
      target stat err =       0.003859750805
              std dev =       0.537317105642
             le_variance =       0.288709672016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288709433296
                                         uncertainty =       0.001933468839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288709433296
                                         uncertainty =       0.001933468839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379940569
  error estimate for blocks of size 2^( 2) =       0.000394967055
  error estimate for blocks of size 2^( 3) =       0.000408926107
  error estimate for blocks of size 2^( 4) =       0.000418114922
  error estimate for blocks of size 2^( 5) =       0.000424272927
  error estimate for blocks of size 2^( 6) =       0.000426136581
  error estimate for blocks of size 2^( 7) =       0.000427862946

      target function =      -0.917993559205
              le_mean =     -17.207514657550
             les_mean =     296.395175405420
             stat err =       0.000424096844
             autocorr =       1.245944631489
   target nu stat err =       0.000424096844
   target dn stat err =       0.002423161351
      target stat err =       0.003859750805
              std dev =       0.537317105642
             le_variance =       0.288709672016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288709433296
                                         uncertainty =       0.001933468839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288709433296
                                         uncertainty =       0.001933468839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379940569
  error estimate for blocks of size 2^( 2) =       0.000394967055
  error estimate for blocks of size 2^( 3) =       0.000408926107
  error estimate for blocks of size 2^( 4) =       0.000418114922
  error estimate for blocks of size 2^( 5) =       0.000424272927
  error estimate for blocks of size 2^( 6) =       0.000426136581
  error estimate for blocks of size 2^( 7) =       0.000427862946

      target function =      -0.917993559205
              le_mean =     -17.207514657550
             les_mean =     296.395175405420
             stat err =       0.000424096844
             autocorr =       1.245944631489
   target nu stat err =       0.000424096844
   target dn stat err =       0.002423161351
      target stat err =       0.003859750805
              std dev =       0.537317105642
             le_variance =       0.288709672016


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917993559205        initial  <--
     1.3553e+19     1.3553e+20             7.9331e-24        -0.917993559205
     5.4210e+19     5.4210e+20             1.9834e-24        -0.917993559205
     2.1684e+20     2.1684e+21             4.9583e-25        -0.917993559205

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.3653
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0249e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2355
    reference variance = 0.235558
====================================================
  Execution time = 3.7927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5434e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9944e-01
  Total weights = 1.973687687e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0746e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291601173362
                                         uncertainty =       0.002104402106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291601173362
                                         uncertainty =       0.002104402106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381894490
  error estimate for blocks of size 2^( 2) =       0.000396882401
  error estimate for blocks of size 2^( 3) =       0.000410783180
  error estimate for blocks of size 2^( 4) =       0.000420177273
  error estimate for blocks of size 2^( 5) =       0.000425384762
  error estimate for blocks of size 2^( 6) =       0.000427486438
  error estimate for blocks of size 2^( 7) =       0.000429613071

      target function =      -0.913625855212
              le_mean =     -17.206429919857
             les_mean =     296.360666187181
             stat err =       0.000425665386
             autocorr =       1.242366944084
   target nu stat err =       0.000425665386
   target dn stat err =       0.002614287296
      target stat err =       0.004107255303
              std dev =       0.540080366946
             le_variance =       0.291686802760


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720642991986e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+20, overlap shift 1.3553e+21 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913643187161       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913643187161       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913643187161       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+20 is 1.506757e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+20, overlap shift 5.4210e+21 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913643187161       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913643187161       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913643187161       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+20 is 3.766892e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+21, overlap shift 2.1684e+22 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913643187161       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913643187161       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913643187161       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+21 is 9.417231e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.155694 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8682e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2666
    reference variance = 0.196266
====================================================
  Execution time = 3.7495e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0214e-01
  Total weights = 1.9737e+06
  Execution time = 3.1519e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291033178613
                                         uncertainty =       0.001580743134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291033178613
                                         uncertainty =       0.001580743134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381480358
  error estimate for blocks of size 2^( 2) =       0.000396013957
  error estimate for blocks of size 2^( 3) =       0.000409732318
  error estimate for blocks of size 2^( 4) =       0.000419037543
  error estimate for blocks of size 2^( 5) =       0.000425112872
  error estimate for blocks of size 2^( 6) =       0.000427803398
  error estimate for blocks of size 2^( 7) =       0.000428827697

      target function =      -0.909443410922
              le_mean =     -17.206959214968
             les_mean =     296.381583198510
             stat err =       0.000425195377
             autocorr =       1.242317794424
   target nu stat err =       0.000425195377
   target dn stat err =       0.002981946831
      target stat err =       0.004630473768
              std dev =       0.539494695816
             le_variance =       0.291054526814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291033178613
                                         uncertainty =       0.001580743134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291033178613
                                         uncertainty =       0.001580743134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381480358
  error estimate for blocks of size 2^( 2) =       0.000396013957
  error estimate for blocks of size 2^( 3) =       0.000409732318
  error estimate for blocks of size 2^( 4) =       0.000419037543
  error estimate for blocks of size 2^( 5) =       0.000425112872
  error estimate for blocks of size 2^( 6) =       0.000427803398
  error estimate for blocks of size 2^( 7) =       0.000428827697

      target function =      -0.909443410922
              le_mean =     -17.206959214968
             les_mean =     296.381583198510
             stat err =       0.000425195377
             autocorr =       1.242317794424
   target nu stat err =       0.000425195377
   target dn stat err =       0.002981946831
      target stat err =       0.004630473768
              std dev =       0.539494695816
             le_variance =       0.291054526814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291033178613
                                         uncertainty =       0.001580743134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291033178613
                                         uncertainty =       0.001580743134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381480358
  error estimate for blocks of size 2^( 2) =       0.000396013957
  error estimate for blocks of size 2^( 3) =       0.000409732318
  error estimate for blocks of size 2^( 4) =       0.000419037543
  error estimate for blocks of size 2^( 5) =       0.000425112872
  error estimate for blocks of size 2^( 6) =       0.000427803398
  error estimate for blocks of size 2^( 7) =       0.000428827697

      target function =      -0.909443410922
              le_mean =     -17.206959214968
             les_mean =     296.381583198510
             stat err =       0.000425195377
             autocorr =       1.242317794424
   target nu stat err =       0.000425195377
   target dn stat err =       0.002981946831
      target stat err =       0.004630473768
              std dev =       0.539494695816
             le_variance =       0.291054526814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291033178613
                                         uncertainty =       0.001580743134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291033178613
                                         uncertainty =       0.001580743134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381480358
  error estimate for blocks of size 2^( 2) =       0.000396013957
  error estimate for blocks of size 2^( 3) =       0.000409732318
  error estimate for blocks of size 2^( 4) =       0.000419037543
  error estimate for blocks of size 2^( 5) =       0.000425112872
  error estimate for blocks of size 2^( 6) =       0.000427803398
  error estimate for blocks of size 2^( 7) =       0.000428827697

      target function =      -0.909443410922
              le_mean =     -17.206959214968
             les_mean =     296.381583198510
             stat err =       0.000425195377
             autocorr =       1.242317794424
   target nu stat err =       0.000425195377
   target dn stat err =       0.002981946831
      target stat err =       0.004630473768
              std dev =       0.539494695816
             le_variance =       0.291054526814


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909443410922        initial  <--
     1.3553e+20     1.3553e+21             1.5068e-24        -0.909443410922
     5.4210e+20     5.4210e+21             3.7669e-25        -0.909443410922
     2.1684e+21     2.1684e+22             9.4172e-26        -0.909443410922

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.3830
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0207e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2682
    reference variance = 0.472153
====================================================
  Execution time = 3.8028e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5425e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9925e-01
  Total weights = 1.973771584e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0925e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291568698571
                                         uncertainty =       0.002054564613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291568698571
                                         uncertainty =       0.002054564613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381814320
  error estimate for blocks of size 2^( 2) =       0.000396353403
  error estimate for blocks of size 2^( 3) =       0.000410043569
  error estimate for blocks of size 2^( 4) =       0.000419701307
  error estimate for blocks of size 2^( 5) =       0.000425334622
  error estimate for blocks of size 2^( 6) =       0.000428574191
  error estimate for blocks of size 2^( 7) =       0.000432061850

      target function =      -0.913913456084
              le_mean =     -17.206590652152
             les_mean =     296.366009975885
             stat err =       0.000426417992
             autocorr =       1.247287634997
   target nu stat err =       0.000426417992
   target dn stat err =       0.002503729697
      target stat err =       0.003942862644
              std dev =       0.539966989735
             le_variance =       0.291564350004


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720659065215e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+21, overlap shift 1.3553e+22 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913929559384       residual = 8.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913929559384       residual = 8.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+21, overlap shift 5.4210e+22 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913929559384       residual = 8.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913929559384       residual = 8.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+22, overlap shift 2.1684e+23 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913929559384       residual = 8.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913929559384       residual = 8.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.156848 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8962e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2314
    reference variance = 0.139233
====================================================
  Execution time = 3.7468e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9719e-01
  Total weights = 1.9736e+06
  Execution time = 3.1475e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289696794414
                                         uncertainty =       0.001814754573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289696794414
                                         uncertainty =       0.001814754573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380566650
  error estimate for blocks of size 2^( 2) =       0.000395749059
  error estimate for blocks of size 2^( 3) =       0.000409361391
  error estimate for blocks of size 2^( 4) =       0.000419062322
  error estimate for blocks of size 2^( 5) =       0.000424699922
  error estimate for blocks of size 2^( 6) =       0.000427723996
  error estimate for blocks of size 2^( 7) =       0.000429824605

      target function =      -0.917097413054
              le_mean =     -17.207192958830
             les_mean =     296.384680290214
             stat err =       0.000425327711
             autocorr =       1.249067485372
   target nu stat err =       0.000425327711
   target dn stat err =       0.002581333902
      target stat err =       0.004093174369
              std dev =       0.538202518054
             le_variance =       0.289661950440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289696794414
                                         uncertainty =       0.001814754573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289696794414
                                         uncertainty =       0.001814754573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380566650
  error estimate for blocks of size 2^( 2) =       0.000395749059
  error estimate for blocks of size 2^( 3) =       0.000409361391
  error estimate for blocks of size 2^( 4) =       0.000419062322
  error estimate for blocks of size 2^( 5) =       0.000424699922
  error estimate for blocks of size 2^( 6) =       0.000427723996
  error estimate for blocks of size 2^( 7) =       0.000429824605

      target function =      -0.917097413054
              le_mean =     -17.207192958830
             les_mean =     296.384680290214
             stat err =       0.000425327711
             autocorr =       1.249067485372
   target nu stat err =       0.000425327711
   target dn stat err =       0.002581333902
      target stat err =       0.004093174369
              std dev =       0.538202518054
             le_variance =       0.289661950440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289696794414
                                         uncertainty =       0.001814754573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289696794414
                                         uncertainty =       0.001814754573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380566650
  error estimate for blocks of size 2^( 2) =       0.000395749059
  error estimate for blocks of size 2^( 3) =       0.000409361391
  error estimate for blocks of size 2^( 4) =       0.000419062322
  error estimate for blocks of size 2^( 5) =       0.000424699922
  error estimate for blocks of size 2^( 6) =       0.000427723996
  error estimate for blocks of size 2^( 7) =       0.000429824605

      target function =      -0.917097413054
              le_mean =     -17.207192958830
             les_mean =     296.384680290214
             stat err =       0.000425327711
             autocorr =       1.249067485372
   target nu stat err =       0.000425327711
   target dn stat err =       0.002581333902
      target stat err =       0.004093174369
              std dev =       0.538202518054
             le_variance =       0.289661950440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289696794414
                                         uncertainty =       0.001814754573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289696794414
                                         uncertainty =       0.001814754573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380566650
  error estimate for blocks of size 2^( 2) =       0.000395749059
  error estimate for blocks of size 2^( 3) =       0.000409361391
  error estimate for blocks of size 2^( 4) =       0.000419062322
  error estimate for blocks of size 2^( 5) =       0.000424699922
  error estimate for blocks of size 2^( 6) =       0.000427723996
  error estimate for blocks of size 2^( 7) =       0.000429824605

      target function =      -0.917097413054
              le_mean =     -17.207192958830
             les_mean =     296.384680290214
             stat err =       0.000425327711
             autocorr =       1.249067485372
   target nu stat err =       0.000425327711
   target dn stat err =       0.002581333902
      target stat err =       0.004093174369
              std dev =       0.538202518054
             le_variance =       0.289661950440


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917097413054        initial  <--
     1.3553e+21     1.3553e+22             0.0000e+00        -0.917097413054
     5.4210e+21     5.4210e+22             0.0000e+00        -0.917097413054
     2.1684e+22     2.1684e+23             0.0000e+00        -0.917097413054

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.2922
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0226e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.1217
    reference variance = 0.327788
====================================================
  Execution time = 3.8263e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5419e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 3.0198e-01
  Total weights = 1.973910277e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1087e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294640447335
                                         uncertainty =       0.002031623698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294640447335
                                         uncertainty =       0.002031623698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383831336
  error estimate for blocks of size 2^( 2) =       0.000398353830
  error estimate for blocks of size 2^( 3) =       0.000411897358
  error estimate for blocks of size 2^( 4) =       0.000421660148
  error estimate for blocks of size 2^( 5) =       0.000426539436
  error estimate for blocks of size 2^( 6) =       0.000430088985
  error estimate for blocks of size 2^( 7) =       0.000431134318

      target function =      -0.909657580996
              le_mean =     -17.207916833240
             les_mean =     296.414381700175
             stat err =       0.000427355722
             autocorr =       1.239647450184
   target nu stat err =       0.000427355722
   target dn stat err =       0.002674583421
      target stat err =       0.004175238941
              std dev =       0.542819480782
             le_variance =       0.294652988717


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720791683324e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+22, overlap shift 1.3553e+23 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909675762039       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909675762039       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+22, overlap shift 5.4210e+23 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909675762039       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909675762039       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+23, overlap shift 2.1684e+24 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909675762039       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909675762039       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.158037 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9358e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2434
    reference variance = 0.210922
====================================================
  Execution time = 3.8064e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9872e-01
  Total weights = 1.9736e+06
  Execution time = 3.1287e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289548389969
                                         uncertainty =       0.001589795578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289548389969
                                         uncertainty =       0.001589795578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380526814
  error estimate for blocks of size 2^( 2) =       0.000395531040
  error estimate for blocks of size 2^( 3) =       0.000409362196
  error estimate for blocks of size 2^( 4) =       0.000419548353
  error estimate for blocks of size 2^( 5) =       0.000426304366
  error estimate for blocks of size 2^( 6) =       0.000430244084
  error estimate for blocks of size 2^( 7) =       0.000433143963

      target function =      -0.914705108200
              le_mean =     -17.207076121874
             les_mean =     296.382190385232
             stat err =       0.000427310191
             autocorr =       1.261002568645
   target nu stat err =       0.000427310191
   target dn stat err =       0.003338673364
      target stat err =       0.005232923797
              std dev =       0.538146181512
             le_variance =       0.289601312676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289548389969
                                         uncertainty =       0.001589795578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289548389969
                                         uncertainty =       0.001589795578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380526814
  error estimate for blocks of size 2^( 2) =       0.000395531040
  error estimate for blocks of size 2^( 3) =       0.000409362196
  error estimate for blocks of size 2^( 4) =       0.000419548353
  error estimate for blocks of size 2^( 5) =       0.000426304366
  error estimate for blocks of size 2^( 6) =       0.000430244084
  error estimate for blocks of size 2^( 7) =       0.000433143963

      target function =      -0.914705108200
              le_mean =     -17.207076121874
             les_mean =     296.382190385232
             stat err =       0.000427310191
             autocorr =       1.261002568645
   target nu stat err =       0.000427310191
   target dn stat err =       0.003338673364
      target stat err =       0.005232923797
              std dev =       0.538146181512
             le_variance =       0.289601312676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289548389969
                                         uncertainty =       0.001589795578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289548389969
                                         uncertainty =       0.001589795578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380526814
  error estimate for blocks of size 2^( 2) =       0.000395531040
  error estimate for blocks of size 2^( 3) =       0.000409362196
  error estimate for blocks of size 2^( 4) =       0.000419548353
  error estimate for blocks of size 2^( 5) =       0.000426304366
  error estimate for blocks of size 2^( 6) =       0.000430244084
  error estimate for blocks of size 2^( 7) =       0.000433143963

      target function =      -0.914705108200
              le_mean =     -17.207076121874
             les_mean =     296.382190385232
             stat err =       0.000427310191
             autocorr =       1.261002568645
   target nu stat err =       0.000427310191
   target dn stat err =       0.003338673364
      target stat err =       0.005232923797
              std dev =       0.538146181512
             le_variance =       0.289601312676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289548389969
                                         uncertainty =       0.001589795578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289548389969
                                         uncertainty =       0.001589795578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380526814
  error estimate for blocks of size 2^( 2) =       0.000395531040
  error estimate for blocks of size 2^( 3) =       0.000409362196
  error estimate for blocks of size 2^( 4) =       0.000419548353
  error estimate for blocks of size 2^( 5) =       0.000426304366
  error estimate for blocks of size 2^( 6) =       0.000430244084
  error estimate for blocks of size 2^( 7) =       0.000433143963

      target function =      -0.914705108200
              le_mean =     -17.207076121874
             les_mean =     296.382190385232
             stat err =       0.000427310191
             autocorr =       1.261002568645
   target nu stat err =       0.000427310191
   target dn stat err =       0.003338673364
      target stat err =       0.005232923797
              std dev =       0.538146181512
             le_variance =       0.289601312676


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914705108200        initial  <--
     1.3553e+22     1.3553e+23             0.0000e+00        -0.914705108200
     5.4210e+22     5.4210e+23             0.0000e+00        -0.914705108200
     2.1684e+23     2.1684e+24             0.0000e+00        -0.914705108200

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7998
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0316e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.1446
    reference variance = 0.226939
====================================================
  Execution time = 3.7935e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5417e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9636e-01
  Total weights = 1.973956242e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1011e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289430044712
                                         uncertainty =       0.002179674719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289430044712
                                         uncertainty =       0.002179674719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380368885
  error estimate for blocks of size 2^( 2) =       0.000395333404
  error estimate for blocks of size 2^( 3) =       0.000409228166
  error estimate for blocks of size 2^( 4) =       0.000419178824
  error estimate for blocks of size 2^( 5) =       0.000424527633
  error estimate for blocks of size 2^( 6) =       0.000426543544
  error estimate for blocks of size 2^( 7) =       0.000427534769

      target function =      -0.918404219351
              le_mean =     -17.207076142493
             les_mean =     296.379824557258
             stat err =       0.000424446193
             autocorr =       1.245189117576
   target nu stat err =       0.000424446193
   target dn stat err =       0.002670512597
      target stat err =       0.004240950267
              std dev =       0.537922836347
             le_variance =       0.289360977864


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720707614249e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+23, overlap shift 1.3553e+24 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918422556710       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918422556710       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+23, overlap shift 5.4210e+24 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918422556710       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918422556710       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+24, overlap shift 2.1684e+25 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918422556710       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918422556710       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.159176 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8955e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2007
    reference variance = 0.246095
====================================================
  Execution time = 3.7886e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9615e-01
  Total weights = 1.9735e+06
  Execution time = 3.1469e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288204930742
                                         uncertainty =       0.001790701503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288204930742
                                         uncertainty =       0.001790701503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379574917
  error estimate for blocks of size 2^( 2) =       0.000394659761
  error estimate for blocks of size 2^( 3) =       0.000408851980
  error estimate for blocks of size 2^( 4) =       0.000419070958
  error estimate for blocks of size 2^( 5) =       0.000425785063
  error estimate for blocks of size 2^( 6) =       0.000428342338
  error estimate for blocks of size 2^( 7) =       0.000429643745

      target function =      -0.918740728319
              le_mean =     -17.206368668725
             les_mean =     296.355272808178
             stat err =       0.000425710526
             autocorr =       1.257864224946
   target nu stat err =       0.000425710526
   target dn stat err =       0.002296161331
      target stat err =       0.003663337146
              std dev =       0.536799995716
             le_variance =       0.288154235401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288204930742
                                         uncertainty =       0.001790701503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288204930742
                                         uncertainty =       0.001790701503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379574917
  error estimate for blocks of size 2^( 2) =       0.000394659761
  error estimate for blocks of size 2^( 3) =       0.000408851980
  error estimate for blocks of size 2^( 4) =       0.000419070958
  error estimate for blocks of size 2^( 5) =       0.000425785063
  error estimate for blocks of size 2^( 6) =       0.000428342338
  error estimate for blocks of size 2^( 7) =       0.000429643745

      target function =      -0.918740728319
              le_mean =     -17.206368668725
             les_mean =     296.355272808178
             stat err =       0.000425710526
             autocorr =       1.257864224946
   target nu stat err =       0.000425710526
   target dn stat err =       0.002296161331
      target stat err =       0.003663337146
              std dev =       0.536799995716
             le_variance =       0.288154235401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288204930742
                                         uncertainty =       0.001790701503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288204930742
                                         uncertainty =       0.001790701503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379574917
  error estimate for blocks of size 2^( 2) =       0.000394659761
  error estimate for blocks of size 2^( 3) =       0.000408851980
  error estimate for blocks of size 2^( 4) =       0.000419070958
  error estimate for blocks of size 2^( 5) =       0.000425785063
  error estimate for blocks of size 2^( 6) =       0.000428342338
  error estimate for blocks of size 2^( 7) =       0.000429643745

      target function =      -0.918740728319
              le_mean =     -17.206368668725
             les_mean =     296.355272808178
             stat err =       0.000425710526
             autocorr =       1.257864224946
   target nu stat err =       0.000425710526
   target dn stat err =       0.002296161331
      target stat err =       0.003663337146
              std dev =       0.536799995716
             le_variance =       0.288154235401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288204930742
                                         uncertainty =       0.001790701503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288204930742
                                         uncertainty =       0.001790701503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379574917
  error estimate for blocks of size 2^( 2) =       0.000394659761
  error estimate for blocks of size 2^( 3) =       0.000408851980
  error estimate for blocks of size 2^( 4) =       0.000419070958
  error estimate for blocks of size 2^( 5) =       0.000425785063
  error estimate for blocks of size 2^( 6) =       0.000428342338
  error estimate for blocks of size 2^( 7) =       0.000429643745

      target function =      -0.918740728319
              le_mean =     -17.206368668725
             les_mean =     296.355272808178
             stat err =       0.000425710526
             autocorr =       1.257864224946
   target nu stat err =       0.000425710526
   target dn stat err =       0.002296161331
      target stat err =       0.003663337146
              std dev =       0.536799995716
             le_variance =       0.288154235401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918740728319        initial  <--
     1.3553e+23     1.3553e+24             0.0000e+00        -0.918740728319
     5.4210e+23     5.4210e+24             0.0000e+00        -0.918740728319
     2.1684e+24     2.1684e+25             0.0000e+00        -0.918740728319

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7554
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0272e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.212
    reference variance = 0.334858
====================================================
  Execution time = 3.7866e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5434e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9695e-01
  Total weights = 1.974050139e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0552e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290658184999
                                         uncertainty =       0.001802231872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290658184999
                                         uncertainty =       0.001802231872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381216799
  error estimate for blocks of size 2^( 2) =       0.000395969979
  error estimate for blocks of size 2^( 3) =       0.000408921687
  error estimate for blocks of size 2^( 4) =       0.000418509715
  error estimate for blocks of size 2^( 5) =       0.000423815529
  error estimate for blocks of size 2^( 6) =       0.000427695600
  error estimate for blocks of size 2^( 7) =       0.000429312016

      target function =      -0.917491156651
              le_mean =     -17.206515478282
             les_mean =     296.361124591057
             stat err =       0.000424833215
             autocorr =       1.241917846882
   target nu stat err =       0.000424833215
   target dn stat err =       0.002157604816
      target stat err =       0.003442639623
              std dev =       0.539121966750
             le_variance =       0.290652495032


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720651547828e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+24, overlap shift 1.3553e+25 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917503080579       residual = 6.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917503080579       residual = 6.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+24, overlap shift 5.4210e+25 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917503080579       residual = 6.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917503080579       residual = 6.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+25, overlap shift 2.1684e+26 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917503080579       residual = 6.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917503080579       residual = 6.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.160316 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8427e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2051
    reference variance = 0.350751
====================================================
  Execution time = 3.7134e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9704e-01
  Total weights = 1.9736e+06
  Execution time = 3.1545e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289618110271
                                         uncertainty =       0.001638958771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289618110271
                                         uncertainty =       0.001638958771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380500167
  error estimate for blocks of size 2^( 2) =       0.000395391229
  error estimate for blocks of size 2^( 3) =       0.000408847590
  error estimate for blocks of size 2^( 4) =       0.000419297855
  error estimate for blocks of size 2^( 5) =       0.000425464853
  error estimate for blocks of size 2^( 6) =       0.000429803750
  error estimate for blocks of size 2^( 7) =       0.000430010452

      target function =      -0.917342870970
              le_mean =     -17.207133148175
             les_mean =     296.382469095526
             stat err =       0.000426144227
             autocorr =       1.254306045940
   target nu stat err =       0.000426144227
   target dn stat err =       0.002121195777
      target stat err =       0.003390410302
              std dev =       0.538108496847
             le_variance =       0.289560754379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289618110271
                                         uncertainty =       0.001638958771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289618110271
                                         uncertainty =       0.001638958771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380500167
  error estimate for blocks of size 2^( 2) =       0.000395391229
  error estimate for blocks of size 2^( 3) =       0.000408847590
  error estimate for blocks of size 2^( 4) =       0.000419297855
  error estimate for blocks of size 2^( 5) =       0.000425464853
  error estimate for blocks of size 2^( 6) =       0.000429803750
  error estimate for blocks of size 2^( 7) =       0.000430010452

      target function =      -0.917342870970
              le_mean =     -17.207133148175
             les_mean =     296.382469095526
             stat err =       0.000426144227
             autocorr =       1.254306045939
   target nu stat err =       0.000426144227
   target dn stat err =       0.002121195777
      target stat err =       0.003390410302
              std dev =       0.538108496847
             le_variance =       0.289560754379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289618110271
                                         uncertainty =       0.001638958771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289618110271
                                         uncertainty =       0.001638958771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380500167
  error estimate for blocks of size 2^( 2) =       0.000395391229
  error estimate for blocks of size 2^( 3) =       0.000408847590
  error estimate for blocks of size 2^( 4) =       0.000419297855
  error estimate for blocks of size 2^( 5) =       0.000425464853
  error estimate for blocks of size 2^( 6) =       0.000429803750
  error estimate for blocks of size 2^( 7) =       0.000430010452

      target function =      -0.917342870970
              le_mean =     -17.207133148175
             les_mean =     296.382469095526
             stat err =       0.000426144227
             autocorr =       1.254306045939
   target nu stat err =       0.000426144227
   target dn stat err =       0.002121195777
      target stat err =       0.003390410302
              std dev =       0.538108496847
             le_variance =       0.289560754379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289618110271
                                         uncertainty =       0.001638958771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289618110271
                                         uncertainty =       0.001638958771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380500167
  error estimate for blocks of size 2^( 2) =       0.000395391229
  error estimate for blocks of size 2^( 3) =       0.000408847590
  error estimate for blocks of size 2^( 4) =       0.000419297855
  error estimate for blocks of size 2^( 5) =       0.000425464853
  error estimate for blocks of size 2^( 6) =       0.000429803750
  error estimate for blocks of size 2^( 7) =       0.000430010452

      target function =      -0.917342870970
              le_mean =     -17.207133148175
             les_mean =     296.382469095526
             stat err =       0.000426144227
             autocorr =       1.254306045939
   target nu stat err =       0.000426144227
   target dn stat err =       0.002121195777
      target stat err =       0.003390410302
              std dev =       0.538108496847
             le_variance =       0.289560754379


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917342870970        initial  <--
     1.3553e+24     1.3553e+25             0.0000e+00        -0.917342870970
     5.4210e+24     5.4210e+25             0.0000e+00        -0.917342870970
     2.1684e+25     2.1684e+26             0.0000e+00        -0.917342870970

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.9949
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0143e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2124
    reference variance = 0.455612
====================================================
  Execution time = 3.8930e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5427e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9493e-01
  Total weights = 1.973874750e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0632e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286922560224
                                         uncertainty =       0.001536159793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286922560224
                                         uncertainty =       0.001536159793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378777709
  error estimate for blocks of size 2^( 2) =       0.000393641556
  error estimate for blocks of size 2^( 3) =       0.000407594030
  error estimate for blocks of size 2^( 4) =       0.000417666356
  error estimate for blocks of size 2^( 5) =       0.000423504427
  error estimate for blocks of size 2^( 6) =       0.000424953886
  error estimate for blocks of size 2^( 7) =       0.000426047512

      target function =      -0.920656461394
              le_mean =     -17.206471895631
             les_mean =     296.357603001550
             stat err =       0.000423043045
             autocorr =       1.247384359429
   target nu stat err =       0.000423043045
   target dn stat err =       0.002166944732
      target stat err =       0.003479343817
              std dev =       0.535672572935
             le_variance =       0.286945105395


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720647189563e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+25, overlap shift 1.3553e+26 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920668581941       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920668581941       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+25, overlap shift 5.4210e+26 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920668581941       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920668581941       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+26, overlap shift 2.1684e+27 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920668581941       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920668581941       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.161502 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9570e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.202
    reference variance = 0.487334
====================================================
  Execution time = 3.7239e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9387e-01
  Total weights = 1.9737e+06
  Execution time = 3.1396e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286504400343
                                         uncertainty =       0.001799035905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286504400343
                                         uncertainty =       0.001799035905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378546777
  error estimate for blocks of size 2^( 2) =       0.000393487403
  error estimate for blocks of size 2^( 3) =       0.000406942404
  error estimate for blocks of size 2^( 4) =       0.000416135593
  error estimate for blocks of size 2^( 5) =       0.000421253001
  error estimate for blocks of size 2^( 6) =       0.000422872372
  error estimate for blocks of size 2^( 7) =       0.000425432035

      target function =      -0.922314119527
              le_mean =     -17.206968895395
             les_mean =     296.373650880795
             stat err =       0.000421423250
             autocorr =       1.239361151768
   target nu stat err =       0.000421423250
   target dn stat err =       0.002089685205
      target stat err =       0.003375071094
              std dev =       0.535345985609
             le_variance =       0.286595324308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286504400343
                                         uncertainty =       0.001799035905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286504400343
                                         uncertainty =       0.001799035905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378546777
  error estimate for blocks of size 2^( 2) =       0.000393487403
  error estimate for blocks of size 2^( 3) =       0.000406942404
  error estimate for blocks of size 2^( 4) =       0.000416135593
  error estimate for blocks of size 2^( 5) =       0.000421253001
  error estimate for blocks of size 2^( 6) =       0.000422872372
  error estimate for blocks of size 2^( 7) =       0.000425432035

      target function =      -0.922314119527
              le_mean =     -17.206968895395
             les_mean =     296.373650880795
             stat err =       0.000421423250
             autocorr =       1.239361151768
   target nu stat err =       0.000421423250
   target dn stat err =       0.002089685205
      target stat err =       0.003375071094
              std dev =       0.535345985609
             le_variance =       0.286595324308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286504400343
                                         uncertainty =       0.001799035905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286504400343
                                         uncertainty =       0.001799035905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378546777
  error estimate for blocks of size 2^( 2) =       0.000393487403
  error estimate for blocks of size 2^( 3) =       0.000406942404
  error estimate for blocks of size 2^( 4) =       0.000416135593
  error estimate for blocks of size 2^( 5) =       0.000421253001
  error estimate for blocks of size 2^( 6) =       0.000422872372
  error estimate for blocks of size 2^( 7) =       0.000425432035

      target function =      -0.922314119527
              le_mean =     -17.206968895395
             les_mean =     296.373650880795
             stat err =       0.000421423250
             autocorr =       1.239361151768
   target nu stat err =       0.000421423250
   target dn stat err =       0.002089685205
      target stat err =       0.003375071094
              std dev =       0.535345985609
             le_variance =       0.286595324308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286504400343
                                         uncertainty =       0.001799035905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286504400343
                                         uncertainty =       0.001799035905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378546777
  error estimate for blocks of size 2^( 2) =       0.000393487403
  error estimate for blocks of size 2^( 3) =       0.000406942404
  error estimate for blocks of size 2^( 4) =       0.000416135593
  error estimate for blocks of size 2^( 5) =       0.000421253001
  error estimate for blocks of size 2^( 6) =       0.000422872372
  error estimate for blocks of size 2^( 7) =       0.000425432035

      target function =      -0.922314119527
              le_mean =     -17.206968895395
             les_mean =     296.373650880795
             stat err =       0.000421423250
             autocorr =       1.239361151768
   target nu stat err =       0.000421423250
   target dn stat err =       0.002089685205
      target stat err =       0.003375071094
              std dev =       0.535345985609
             le_variance =       0.286595324308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922314119527        initial  <--
     1.3553e+25     1.3553e+26             0.0000e+00        -0.922314119527
     5.4210e+25     5.4210e+26             0.0000e+00        -0.922314119527
     2.1684e+26     2.1684e+27             0.0000e+00        -0.922314119527

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.0431
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0262e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2368
    reference variance = 0.229686
====================================================
  Execution time = 3.7859e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5431e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0891e-01
  Total weights = 1.973737033e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0838e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295322232509
                                         uncertainty =       0.004639414527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295322232509
                                         uncertainty =       0.004639414527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384215092
  error estimate for blocks of size 2^( 2) =       0.000398966706
  error estimate for blocks of size 2^( 3) =       0.000412096303
  error estimate for blocks of size 2^( 4) =       0.000422529265
  error estimate for blocks of size 2^( 5) =       0.000428123426
  error estimate for blocks of size 2^( 6) =       0.000431054834
  error estimate for blocks of size 2^( 7) =       0.000431928316

      target function =      -0.898983525357
              le_mean =     -17.206533510471
             les_mean =     296.373708366500
             stat err =       0.000428408960
             autocorr =       1.243278010538
   target nu stat err =       0.000428408960
   target dn stat err =       0.009575080611
      target stat err =       0.014362829683
              std dev =       0.543362193347
             le_variance =       0.295242473158


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720653351047e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+26, overlap shift 1.3553e+27 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899210619109       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899210619109       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899210619114       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+26 is 9.930760e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+26, overlap shift 5.4210e+27 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899210619109       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899210619109       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899210619100       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+26 is 2.482690e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+27, overlap shift 2.1684e+28 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899210619109       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899210619109       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899210619100       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+27 is 6.206725e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.163003 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8706e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.1642
    reference variance = 0.337787
====================================================
  Execution time = 3.7625e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9275e-01
  Total weights = 1.9739e+06
  Execution time = 3.1355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287496821459
                                         uncertainty =       0.001694749356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287496821459
                                         uncertainty =       0.001694749356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379139564
  error estimate for blocks of size 2^( 2) =       0.000394316425
  error estimate for blocks of size 2^( 3) =       0.000407890267
  error estimate for blocks of size 2^( 4) =       0.000417787602
  error estimate for blocks of size 2^( 5) =       0.000423539975
  error estimate for blocks of size 2^( 6) =       0.000427168817
  error estimate for blocks of size 2^( 7) =       0.000429931415

      target function =      -0.924097473748
              le_mean =     -17.206635229247
             les_mean =     296.361043539441
             stat err =       0.000424606952
             autocorr =       1.254226549147
   target nu stat err =       0.000424606952
   target dn stat err =       0.001734525161
      target stat err =       0.002840378170
              std dev =       0.536184313106
             le_variance =       0.287493617621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287496821459
                                         uncertainty =       0.001694749356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287496821459
                                         uncertainty =       0.001694749356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379139564
  error estimate for blocks of size 2^( 2) =       0.000394316425
  error estimate for blocks of size 2^( 3) =       0.000407890267
  error estimate for blocks of size 2^( 4) =       0.000417787602
  error estimate for blocks of size 2^( 5) =       0.000423539975
  error estimate for blocks of size 2^( 6) =       0.000427168817
  error estimate for blocks of size 2^( 7) =       0.000429931415

      target function =      -0.924097473748
              le_mean =     -17.206635229247
             les_mean =     296.361043539441
             stat err =       0.000424606952
             autocorr =       1.254226549147
   target nu stat err =       0.000424606952
   target dn stat err =       0.001734525161
      target stat err =       0.002840378170
              std dev =       0.536184313106
             le_variance =       0.287493617621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287496821459
                                         uncertainty =       0.001694749356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287496821459
                                         uncertainty =       0.001694749356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379139564
  error estimate for blocks of size 2^( 2) =       0.000394316425
  error estimate for blocks of size 2^( 3) =       0.000407890267
  error estimate for blocks of size 2^( 4) =       0.000417787602
  error estimate for blocks of size 2^( 5) =       0.000423539975
  error estimate for blocks of size 2^( 6) =       0.000427168817
  error estimate for blocks of size 2^( 7) =       0.000429931415

      target function =      -0.924097473748
              le_mean =     -17.206635229247
             les_mean =     296.361043539441
             stat err =       0.000424606952
             autocorr =       1.254226549147
   target nu stat err =       0.000424606952
   target dn stat err =       0.001734525161
      target stat err =       0.002840378170
              std dev =       0.536184313106
             le_variance =       0.287493617621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287496821459
                                         uncertainty =       0.001694749356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287496821459
                                         uncertainty =       0.001694749356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379139564
  error estimate for blocks of size 2^( 2) =       0.000394316425
  error estimate for blocks of size 2^( 3) =       0.000407890267
  error estimate for blocks of size 2^( 4) =       0.000417787602
  error estimate for blocks of size 2^( 5) =       0.000423539975
  error estimate for blocks of size 2^( 6) =       0.000427168817
  error estimate for blocks of size 2^( 7) =       0.000429931415

      target function =      -0.924097473748
              le_mean =     -17.206635229247
             les_mean =     296.361043539441
             stat err =       0.000424606952
             autocorr =       1.254226549147
   target nu stat err =       0.000424606952
   target dn stat err =       0.001734525161
      target stat err =       0.002840378170
              std dev =       0.536184313106
             le_variance =       0.287493617621


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924097473748        initial  <--
     1.3553e+26     1.3553e+27             9.9308e-31        -0.924097473748
     5.4210e+26     5.4210e+27             2.4827e-31        -0.924097473748
     2.1684e+27     2.1684e+28             6.2067e-32        -0.924097473748

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.4350
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0215e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.1863
    reference variance = 0.22296
====================================================
  Execution time = 3.7909e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5428e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0354e-01
  Total weights = 1.973867004e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0779e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292113531880
                                         uncertainty =       0.002091622330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292113531880
                                         uncertainty =       0.002091622330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382134839
  error estimate for blocks of size 2^( 2) =       0.000397087758
  error estimate for blocks of size 2^( 3) =       0.000410606777
  error estimate for blocks of size 2^( 4) =       0.000420769838
  error estimate for blocks of size 2^( 5) =       0.000426360043
  error estimate for blocks of size 2^( 6) =       0.000429664025
  error estimate for blocks of size 2^( 7) =       0.000431842485

      target function =      -0.907250120437
              le_mean =     -17.207352011584
             les_mean =     296.396504171529
             stat err =       0.000427159098
             autocorr =       1.249528175420
   target nu stat err =       0.000427159098
   target dn stat err =       0.004574990531
      target stat err =       0.007026906922
              std dev =       0.540420271921
             le_variance =       0.292054070304


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720735201158e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+27, overlap shift 1.3553e+28 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907303769965       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907303769965       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907303769965       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+27 is 7.630779e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+27, overlap shift 5.4210e+28 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907303769965       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907303769965       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907303769965       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+27 is 1.907695e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+28, overlap shift 2.1684e+29 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907303769965       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907303769965       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908016717832       residual = 3.23e+12           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+28 is 4.769237e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.164464 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8697e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2024
    reference variance = 0.224018
====================================================
  Execution time = 3.7609e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9921e-01
  Total weights = 1.9740e+06
  Execution time = 3.1395e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290948457110
                                         uncertainty =       0.001941991357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290948457110
                                         uncertainty =       0.001941991357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381359848
  error estimate for blocks of size 2^( 2) =       0.000395951426
  error estimate for blocks of size 2^( 3) =       0.000409809753
  error estimate for blocks of size 2^( 4) =       0.000419881951
  error estimate for blocks of size 2^( 5) =       0.000425450606
  error estimate for blocks of size 2^( 6) =       0.000428901027
  error estimate for blocks of size 2^( 7) =       0.000429764353

      target function =      -0.913973098876
              le_mean =     -17.206443940621
             les_mean =     296.360922260109
             stat err =       0.000425999484
             autocorr =       1.247809289384
   target nu stat err =       0.000425999484
   target dn stat err =       0.002810705372
      target stat err =       0.004410192938
              std dev =       0.539324269613
             le_variance =       0.290870667794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290948457110
                                         uncertainty =       0.001941991357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290948457110
                                         uncertainty =       0.001941991357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381359848
  error estimate for blocks of size 2^( 2) =       0.000395951426
  error estimate for blocks of size 2^( 3) =       0.000409809753
  error estimate for blocks of size 2^( 4) =       0.000419881951
  error estimate for blocks of size 2^( 5) =       0.000425450606
  error estimate for blocks of size 2^( 6) =       0.000428901027
  error estimate for blocks of size 2^( 7) =       0.000429764353

      target function =      -0.913973098876
              le_mean =     -17.206443940621
             les_mean =     296.360922260109
             stat err =       0.000425999484
             autocorr =       1.247809289385
   target nu stat err =       0.000425999484
   target dn stat err =       0.002810705372
      target stat err =       0.004410192938
              std dev =       0.539324269613
             le_variance =       0.290870667794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290948457110
                                         uncertainty =       0.001941991357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290948457110
                                         uncertainty =       0.001941991357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381359848
  error estimate for blocks of size 2^( 2) =       0.000395951426
  error estimate for blocks of size 2^( 3) =       0.000409809753
  error estimate for blocks of size 2^( 4) =       0.000419881951
  error estimate for blocks of size 2^( 5) =       0.000425450606
  error estimate for blocks of size 2^( 6) =       0.000428901027
  error estimate for blocks of size 2^( 7) =       0.000429764353

      target function =      -0.913973098876
              le_mean =     -17.206443940621
             les_mean =     296.360922260109
             stat err =       0.000425999484
             autocorr =       1.247809289385
   target nu stat err =       0.000425999484
   target dn stat err =       0.002810705372
      target stat err =       0.004410192938
              std dev =       0.539324269613
             le_variance =       0.290870667794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290948457110
                                         uncertainty =       0.001941991357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290948457110
                                         uncertainty =       0.001941991357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381359848
  error estimate for blocks of size 2^( 2) =       0.000395951426
  error estimate for blocks of size 2^( 3) =       0.000409809753
  error estimate for blocks of size 2^( 4) =       0.000419881951
  error estimate for blocks of size 2^( 5) =       0.000425450606
  error estimate for blocks of size 2^( 6) =       0.000428901027
  error estimate for blocks of size 2^( 7) =       0.000429764353

      target function =      -0.913973098876
              le_mean =     -17.206443940621
             les_mean =     296.360922260109
             stat err =       0.000425999484
             autocorr =       1.247809289385
   target nu stat err =       0.000425999484
   target dn stat err =       0.002810705372
      target stat err =       0.004410192938
              std dev =       0.539324269613
             le_variance =       0.290870667794


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913973098876        initial  <--
     1.3553e+27     1.3553e+28             7.6308e-32        -0.913973098876
     5.4210e+27     5.4210e+28             1.9077e-32        -0.913973098876
     2.1684e+28     2.1684e+29             4.7692e-33        -0.913973098876

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.3813
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0208e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.1396
    reference variance = 0.336013
====================================================
  Execution time = 3.9207e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5416e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 3.0199e-01
  Total weights = 1.973860363e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0920e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293340981120
                                         uncertainty =       0.002425148862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293340981120
                                         uncertainty =       0.002425148862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382976430
  error estimate for blocks of size 2^( 2) =       0.000397825603
  error estimate for blocks of size 2^( 3) =       0.000411225855
  error estimate for blocks of size 2^( 4) =       0.000422077262
  error estimate for blocks of size 2^( 5) =       0.000428702683
  error estimate for blocks of size 2^( 6) =       0.000431168154
  error estimate for blocks of size 2^( 7) =       0.000431171406

      target function =      -0.909627850286
              le_mean =     -17.207529978625
             les_mean =     296.401082258424
             stat err =       0.000428279877
             autocorr =       1.250579327531
   target nu stat err =       0.000428279877
   target dn stat err =       0.003916733624
      target stat err =       0.006060879853
              std dev =       0.541610460977
             le_variance =       0.293341891440


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720752997862e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+28, overlap shift 1.3553e+29 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909667125545       residual = 7.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909667125545       residual = 7.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+28, overlap shift 5.4210e+29 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909667125545       residual = 7.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909667125545       residual = 7.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+29, overlap shift 2.1684e+30 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909667125545       residual = 7.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909667125545       residual = 7.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.165637 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0135e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2021
    reference variance = 0.222438
====================================================
  Execution time = 3.7281e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0562e-01
  Total weights = 1.9740e+06
  Execution time = 3.1445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295679019885
                                         uncertainty =       0.002377691609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295679019885
                                         uncertainty =       0.002377691609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384476158
  error estimate for blocks of size 2^( 2) =       0.000399394497
  error estimate for blocks of size 2^( 3) =       0.000412747882
  error estimate for blocks of size 2^( 4) =       0.000423000424
  error estimate for blocks of size 2^( 5) =       0.000430048021
  error estimate for blocks of size 2^( 6) =       0.000431432589
  error estimate for blocks of size 2^( 7) =       0.000431292013

      target function =      -0.904136753459
              le_mean =     -17.206821687239
             les_mean =     296.380330779282
             stat err =       0.000428943262
             autocorr =       1.244689060526
   target nu stat err =       0.000428943262
   target dn stat err =       0.003256571553
      target stat err =       0.004988628662
              std dev =       0.543731396976
             le_variance =       0.295643832057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295679019885
                                         uncertainty =       0.002377691609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295679019885
                                         uncertainty =       0.002377691609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384476158
  error estimate for blocks of size 2^( 2) =       0.000399394497
  error estimate for blocks of size 2^( 3) =       0.000412747882
  error estimate for blocks of size 2^( 4) =       0.000423000424
  error estimate for blocks of size 2^( 5) =       0.000430048021
  error estimate for blocks of size 2^( 6) =       0.000431432589
  error estimate for blocks of size 2^( 7) =       0.000431292013

      target function =      -0.904136753459
              le_mean =     -17.206821687239
             les_mean =     296.380330779282
             stat err =       0.000428943262
             autocorr =       1.244689060519
   target nu stat err =       0.000428943262
   target dn stat err =       0.003256571553
      target stat err =       0.004988628662
              std dev =       0.543731396976
             le_variance =       0.295643832057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295679019885
                                         uncertainty =       0.002377691609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295679019885
                                         uncertainty =       0.002377691609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384476158
  error estimate for blocks of size 2^( 2) =       0.000399394497
  error estimate for blocks of size 2^( 3) =       0.000412747882
  error estimate for blocks of size 2^( 4) =       0.000423000424
  error estimate for blocks of size 2^( 5) =       0.000430048021
  error estimate for blocks of size 2^( 6) =       0.000431432589
  error estimate for blocks of size 2^( 7) =       0.000431292013

      target function =      -0.904136753459
              le_mean =     -17.206821687239
             les_mean =     296.380330779282
             stat err =       0.000428943262
             autocorr =       1.244689060519
   target nu stat err =       0.000428943262
   target dn stat err =       0.003256571553
      target stat err =       0.004988628662
              std dev =       0.543731396976
             le_variance =       0.295643832057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295679019885
                                         uncertainty =       0.002377691609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295679019885
                                         uncertainty =       0.002377691609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384476158
  error estimate for blocks of size 2^( 2) =       0.000399394497
  error estimate for blocks of size 2^( 3) =       0.000412747882
  error estimate for blocks of size 2^( 4) =       0.000423000424
  error estimate for blocks of size 2^( 5) =       0.000430048021
  error estimate for blocks of size 2^( 6) =       0.000431432589
  error estimate for blocks of size 2^( 7) =       0.000431292013

      target function =      -0.904136753459
              le_mean =     -17.206821687239
             les_mean =     296.380330779282
             stat err =       0.000428943262
             autocorr =       1.244689060519
   target nu stat err =       0.000428943262
   target dn stat err =       0.003256571553
      target stat err =       0.004988628662
              std dev =       0.543731396976
             le_variance =       0.295643832057


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904136753459        initial  <--
     1.3553e+28     1.3553e+29             0.0000e+00        -0.904136753459
     5.4210e+28     5.4210e+29             0.0000e+00        -0.904136753459
     2.1684e+29     2.1684e+30             0.0000e+00        -0.904136753459

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.0936
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0323e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2159
    reference variance = 0.35462
====================================================
  Execution time = 3.8107e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5427e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 2.9670e-01
  Total weights = 1.973722182e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0816e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290677180462
                                         uncertainty =       0.001814924072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290677180462
                                         uncertainty =       0.001814924072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381218204
  error estimate for blocks of size 2^( 2) =       0.000395874128
  error estimate for blocks of size 2^( 3) =       0.000409231496
  error estimate for blocks of size 2^( 4) =       0.000419184736
  error estimate for blocks of size 2^( 5) =       0.000425493504
  error estimate for blocks of size 2^( 6) =       0.000429449092
  error estimate for blocks of size 2^( 7) =       0.000430993392

      target function =      -0.917864356272
              le_mean =     -17.207533942318
             les_mean =     296.395923666255
             stat err =       0.000426280181
             autocorr =       1.250382884713
   target nu stat err =       0.000426280181
   target dn stat err =       0.002115870244
      target stat err =       0.003388616102
              std dev =       0.539123954851
             le_variance =       0.290654638695


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720753394232e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+29, overlap shift 1.3553e+30 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917875913274       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917875913274       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917875913437       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+29 is 6.506440e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+29, overlap shift 5.4210e+30 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917875913274       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917875913274       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917875912972       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+29 is 1.626610e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+30, overlap shift 2.1684e+31 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917875913274       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917875913274       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917875913903       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+30 is 4.066525e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.167096 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8931e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.1783
    reference variance = 0.171415
====================================================
  Execution time = 3.7413e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9843e-01
  Total weights = 1.9740e+06
  Execution time = 3.1637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290902589771
                                         uncertainty =       0.002176886949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290902589771
                                         uncertainty =       0.002176886949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381361393
  error estimate for blocks of size 2^( 2) =       0.000396262811
  error estimate for blocks of size 2^( 3) =       0.000409650810
  error estimate for blocks of size 2^( 4) =       0.000419888692
  error estimate for blocks of size 2^( 5) =       0.000426203390
  error estimate for blocks of size 2^( 6) =       0.000430368843
  error estimate for blocks of size 2^( 7) =       0.000432240520

      target function =      -0.915167544595
              le_mean =     -17.207263710016
             les_mean =     296.388354552928
             stat err =       0.000427175361
             autocorr =       1.254697230097
   target nu stat err =       0.000427175361
   target dn stat err =       0.002426918732
      target stat err =       0.003841373545
              std dev =       0.539326454581
             le_variance =       0.290873024611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290902589771
                                         uncertainty =       0.002176886949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290902589771
                                         uncertainty =       0.002176886949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381361393
  error estimate for blocks of size 2^( 2) =       0.000396262811
  error estimate for blocks of size 2^( 3) =       0.000409650810
  error estimate for blocks of size 2^( 4) =       0.000419888692
  error estimate for blocks of size 2^( 5) =       0.000426203390
  error estimate for blocks of size 2^( 6) =       0.000430368843
  error estimate for blocks of size 2^( 7) =       0.000432240520

      target function =      -0.915167544595
              le_mean =     -17.207263710016
             les_mean =     296.388354552928
             stat err =       0.000427175361
             autocorr =       1.254697230096
   target nu stat err =       0.000427175361
   target dn stat err =       0.002426918732
      target stat err =       0.003841373545
              std dev =       0.539326454581
             le_variance =       0.290873024611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290902589771
                                         uncertainty =       0.002176886949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290902589771
                                         uncertainty =       0.002176886949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381361393
  error estimate for blocks of size 2^( 2) =       0.000396262811
  error estimate for blocks of size 2^( 3) =       0.000409650810
  error estimate for blocks of size 2^( 4) =       0.000419888692
  error estimate for blocks of size 2^( 5) =       0.000426203390
  error estimate for blocks of size 2^( 6) =       0.000430368843
  error estimate for blocks of size 2^( 7) =       0.000432240520

      target function =      -0.915167544595
              le_mean =     -17.207263710016
             les_mean =     296.388354552928
             stat err =       0.000427175361
             autocorr =       1.254697230096
   target nu stat err =       0.000427175361
   target dn stat err =       0.002426918732
      target stat err =       0.003841373545
              std dev =       0.539326454581
             le_variance =       0.290873024611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290902589771
                                         uncertainty =       0.002176886949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290902589771
                                         uncertainty =       0.002176886949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381361393
  error estimate for blocks of size 2^( 2) =       0.000396262811
  error estimate for blocks of size 2^( 3) =       0.000409650810
  error estimate for blocks of size 2^( 4) =       0.000419888692
  error estimate for blocks of size 2^( 5) =       0.000426203390
  error estimate for blocks of size 2^( 6) =       0.000430368843
  error estimate for blocks of size 2^( 7) =       0.000432240520

      target function =      -0.915167544595
              le_mean =     -17.207263710016
             les_mean =     296.388354552928
             stat err =       0.000427175361
             autocorr =       1.254697230096
   target nu stat err =       0.000427175361
   target dn stat err =       0.002426918732
      target stat err =       0.003841373545
              std dev =       0.539326454581
             le_variance =       0.290873024611


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915167544595        initial  <--
     1.3553e+29     1.3553e+30             6.5064e-34        -0.915167544595
     5.4210e+29     5.4210e+30             1.6266e-34        -0.915167544595
     2.1684e+30     2.1684e+31             4.0665e-35        -0.915167544595

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.3141
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0225e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2022
    reference variance = 0.225881
====================================================
  Execution time = 3.7889e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5400e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9748e-01
  Total weights = 1.973687153e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0876e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290437407994
                                         uncertainty =       0.001861620739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290437407994
                                         uncertainty =       0.001861620739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381074686
  error estimate for blocks of size 2^( 2) =       0.000396067746
  error estimate for blocks of size 2^( 3) =       0.000409855334
  error estimate for blocks of size 2^( 4) =       0.000419856397
  error estimate for blocks of size 2^( 5) =       0.000426136431
  error estimate for blocks of size 2^( 6) =       0.000429656923
  error estimate for blocks of size 2^( 7) =       0.000429313357

      target function =      -0.916654278334
              le_mean =     -17.207148464468
             les_mean =     296.383436505133
             stat err =       0.000426240777
             autocorr =       1.251093561668
   target nu stat err =       0.000426240777
   target dn stat err =       0.002246530189
      target stat err =       0.003576689825
              std dev =       0.538920988837
             le_variance =       0.290435832210


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720714846447e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+30, overlap shift 1.3553e+31 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916667075735       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916667075735       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+30, overlap shift 5.4210e+31 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916667075735       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916667075735       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+31, overlap shift 2.1684e+32 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916667075735       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916667075735       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.168247 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8773e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2337
    reference variance = 0.239775
====================================================
  Execution time = 3.7481e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0133e-01
  Total weights = 1.9738e+06
  Execution time = 3.1490e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291987158062
                                         uncertainty =       0.002337386387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291987158062
                                         uncertainty =       0.002337386387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382132492
  error estimate for blocks of size 2^( 2) =       0.000396980713
  error estimate for blocks of size 2^( 3) =       0.000410523201
  error estimate for blocks of size 2^( 4) =       0.000420969973
  error estimate for blocks of size 2^( 5) =       0.000427922161
  error estimate for blocks of size 2^( 6) =       0.000430501686
  error estimate for blocks of size 2^( 7) =       0.000431377777

      target function =      -0.910661855515
              le_mean =     -17.207025162053
             les_mean =     296.383048398966
             stat err =       0.000427692899
             autocorr =       1.252668471482
   target nu stat err =       0.000427692899
   target dn stat err =       0.003838316560
      target stat err =       0.005948987402
              std dev =       0.540416952823
             le_variance =       0.292050482899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291987158062
                                         uncertainty =       0.002337386387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291987158062
                                         uncertainty =       0.002337386387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382132492
  error estimate for blocks of size 2^( 2) =       0.000396980713
  error estimate for blocks of size 2^( 3) =       0.000410523201
  error estimate for blocks of size 2^( 4) =       0.000420969973
  error estimate for blocks of size 2^( 5) =       0.000427922161
  error estimate for blocks of size 2^( 6) =       0.000430501686
  error estimate for blocks of size 2^( 7) =       0.000431377777

      target function =      -0.910661855515
              le_mean =     -17.207025162053
             les_mean =     296.383048398966
             stat err =       0.000427692899
             autocorr =       1.252668471482
   target nu stat err =       0.000427692899
   target dn stat err =       0.003838316560
      target stat err =       0.005948987402
              std dev =       0.540416952823
             le_variance =       0.292050482899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291987158062
                                         uncertainty =       0.002337386387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291987158062
                                         uncertainty =       0.002337386387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382132492
  error estimate for blocks of size 2^( 2) =       0.000396980713
  error estimate for blocks of size 2^( 3) =       0.000410523201
  error estimate for blocks of size 2^( 4) =       0.000420969973
  error estimate for blocks of size 2^( 5) =       0.000427922161
  error estimate for blocks of size 2^( 6) =       0.000430501686
  error estimate for blocks of size 2^( 7) =       0.000431377777

      target function =      -0.910661855515
              le_mean =     -17.207025162053
             les_mean =     296.383048398966
             stat err =       0.000427692899
             autocorr =       1.252668471482
   target nu stat err =       0.000427692899
   target dn stat err =       0.003838316560
      target stat err =       0.005948987402
              std dev =       0.540416952823
             le_variance =       0.292050482899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291987158062
                                         uncertainty =       0.002337386387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291987158062
                                         uncertainty =       0.002337386387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382132492
  error estimate for blocks of size 2^( 2) =       0.000396980713
  error estimate for blocks of size 2^( 3) =       0.000410523201
  error estimate for blocks of size 2^( 4) =       0.000420969973
  error estimate for blocks of size 2^( 5) =       0.000427922161
  error estimate for blocks of size 2^( 6) =       0.000430501686
  error estimate for blocks of size 2^( 7) =       0.000431377777

      target function =      -0.910661855515
              le_mean =     -17.207025162053
             les_mean =     296.383048398966
             stat err =       0.000427692899
             autocorr =       1.252668471482
   target nu stat err =       0.000427692899
   target dn stat err =       0.003838316560
      target stat err =       0.005948987402
              std dev =       0.540416952823
             le_variance =       0.292050482899


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910661855515        initial  <--
     1.3553e+30     1.3553e+31             0.0000e+00        -0.910661855515
     5.4210e+30     5.4210e+31             0.0000e+00        -0.910661855515
     2.1684e+31     2.1684e+32             0.0000e+00        -0.910661855515

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.3416
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0212e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.3212
    reference variance = 0.90011
====================================================
  Execution time = 3.9064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5428e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0385e-01
  Total weights = 1.973614729e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0908e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292296752467
                                         uncertainty =       0.001924238439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292296752467
                                         uncertainty =       0.001924238439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382339984
  error estimate for blocks of size 2^( 2) =       0.000397078001
  error estimate for blocks of size 2^( 3) =       0.000411101158
  error estimate for blocks of size 2^( 4) =       0.000421871279
  error estimate for blocks of size 2^( 5) =       0.000427597071
  error estimate for blocks of size 2^( 6) =       0.000431947727
  error estimate for blocks of size 2^( 7) =       0.000433816708

      target function =      -0.906786907447
              le_mean =     -17.206996876448
             les_mean =     296.384587442437
             stat err =       0.000428808196
             autocorr =       1.257843819475
   target nu stat err =       0.000428808196
   target dn stat err =       0.005027937181
      target stat err =       0.007703071489
              std dev =       0.540710391089
             le_variance =       0.292367727031


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720699687645e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+31, overlap shift 1.3553e+32 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906851426590       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906851426590       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+31, overlap shift 5.4210e+32 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906851426590       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906851426590       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+32, overlap shift 2.1684e+33 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906851426590       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906851426590       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.169423 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9981e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1706
    reference variance = 0.212245
====================================================
  Execution time = 3.7369e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9430e-01
  Total weights = 1.9739e+06
  Execution time = 3.1581e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287350712672
                                         uncertainty =       0.001656510294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287350712672
                                         uncertainty =       0.001656510294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379114395
  error estimate for blocks of size 2^( 2) =       0.000393753997
  error estimate for blocks of size 2^( 3) =       0.000407520123
  error estimate for blocks of size 2^( 4) =       0.000418430933
  error estimate for blocks of size 2^( 5) =       0.000424414472
  error estimate for blocks of size 2^( 6) =       0.000428014037
  error estimate for blocks of size 2^( 7) =       0.000429470609

      target function =      -0.921628173035
              le_mean =     -17.207470242743
             les_mean =     296.391335436342
             stat err =       0.000425082513
             autocorr =       1.257204505107
   target nu stat err =       0.000425082513
   target dn stat err =       0.002153315022
      target stat err =       0.003472700940
              std dev =       0.536148718964
             le_variance =       0.287455448846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287350712672
                                         uncertainty =       0.001656510294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287350712672
                                         uncertainty =       0.001656510294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379114395
  error estimate for blocks of size 2^( 2) =       0.000393753997
  error estimate for blocks of size 2^( 3) =       0.000407520123
  error estimate for blocks of size 2^( 4) =       0.000418430933
  error estimate for blocks of size 2^( 5) =       0.000424414472
  error estimate for blocks of size 2^( 6) =       0.000428014037
  error estimate for blocks of size 2^( 7) =       0.000429470609

      target function =      -0.921628173035
              le_mean =     -17.207470242743
             les_mean =     296.391335436342
             stat err =       0.000425082513
             autocorr =       1.257204505103
   target nu stat err =       0.000425082513
   target dn stat err =       0.002153315022
      target stat err =       0.003472700940
              std dev =       0.536148718964
             le_variance =       0.287455448846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287350712672
                                         uncertainty =       0.001656510294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287350712672
                                         uncertainty =       0.001656510294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379114395
  error estimate for blocks of size 2^( 2) =       0.000393753997
  error estimate for blocks of size 2^( 3) =       0.000407520123
  error estimate for blocks of size 2^( 4) =       0.000418430933
  error estimate for blocks of size 2^( 5) =       0.000424414472
  error estimate for blocks of size 2^( 6) =       0.000428014037
  error estimate for blocks of size 2^( 7) =       0.000429470609

      target function =      -0.921628173035
              le_mean =     -17.207470242743
             les_mean =     296.391335436342
             stat err =       0.000425082513
             autocorr =       1.257204505103
   target nu stat err =       0.000425082513
   target dn stat err =       0.002153315022
      target stat err =       0.003472700940
              std dev =       0.536148718964
             le_variance =       0.287455448846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287350712672
                                         uncertainty =       0.001656510294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287350712672
                                         uncertainty =       0.001656510294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379114395
  error estimate for blocks of size 2^( 2) =       0.000393753997
  error estimate for blocks of size 2^( 3) =       0.000407520123
  error estimate for blocks of size 2^( 4) =       0.000418430933
  error estimate for blocks of size 2^( 5) =       0.000424414472
  error estimate for blocks of size 2^( 6) =       0.000428014037
  error estimate for blocks of size 2^( 7) =       0.000429470609

      target function =      -0.921628173035
              le_mean =     -17.207470242743
             les_mean =     296.391335436342
             stat err =       0.000425082513
             autocorr =       1.257204505103
   target nu stat err =       0.000425082513
   target dn stat err =       0.002153315022
      target stat err =       0.003472700940
              std dev =       0.536148718964
             le_variance =       0.287455448846


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921628173035        initial  <--
     1.3553e+31     1.3553e+32             0.0000e+00        -0.921628173035
     5.4210e+31     5.4210e+32             0.0000e+00        -0.921628173035
     2.1684e+32     2.1684e+33             0.0000e+00        -0.921628173035

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.2466
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0323e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2335
    reference variance = 0.347506
====================================================
  Execution time = 3.7929e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5409e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0290e-01
  Total weights = 1.973811237e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0678e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293064954560
                                         uncertainty =       0.002694580036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293064954560
                                         uncertainty =       0.002694580036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382732261
  error estimate for blocks of size 2^( 2) =       0.000397683224
  error estimate for blocks of size 2^( 3) =       0.000411135683
  error estimate for blocks of size 2^( 4) =       0.000420491297
  error estimate for blocks of size 2^( 5) =       0.000426222022
  error estimate for blocks of size 2^( 6) =       0.000430886864
  error estimate for blocks of size 2^( 7) =       0.000432473124

      target function =      -0.908263773331
              le_mean =     -17.206894378066
             les_mean =     296.380118402976
             stat err =       0.000427518327
             autocorr =       1.247726303136
   target nu stat err =       0.000427518327
   target dn stat err =       0.003433525394
      target stat err =       0.005302239978
              std dev =       0.541265154696
             le_variance =       0.292967967689


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720689437807e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+32, overlap shift 1.3553e+33 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908293713114       residual = 9.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908293713114       residual = 9.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+32, overlap shift 5.4210e+33 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908293713114       residual = 9.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908293713114       residual = 9.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+33, overlap shift 2.1684e+34 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908293713114       residual = 9.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908293713114       residual = 9.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.170592 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8616e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2223
    reference variance = 0.25666
====================================================
  Execution time = 3.7644e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9953e-01
  Total weights = 1.9738e+06
  Execution time = 3.1645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292024244601
                                         uncertainty =       0.001554853470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292024244601
                                         uncertainty =       0.001554853470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382174009
  error estimate for blocks of size 2^( 2) =       0.000397053529
  error estimate for blocks of size 2^( 3) =       0.000410735853
  error estimate for blocks of size 2^( 4) =       0.000421422698
  error estimate for blocks of size 2^( 5) =       0.000428090243
  error estimate for blocks of size 2^( 6) =       0.000430481849
  error estimate for blocks of size 2^( 7) =       0.000431186325

      target function =      -0.913484611665
              le_mean =     -17.206453563202
             les_mean =     296.361574207530
             stat err =       0.000427795279
             autocorr =       1.252995984286
   target nu stat err =       0.000427795279
   target dn stat err =       0.002180227623
      target stat err =       0.003448161151
              std dev =       0.540475666017
             le_variance =       0.292113945557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292024244601
                                         uncertainty =       0.001554853470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292024244601
                                         uncertainty =       0.001554853470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382174009
  error estimate for blocks of size 2^( 2) =       0.000397053529
  error estimate for blocks of size 2^( 3) =       0.000410735853
  error estimate for blocks of size 2^( 4) =       0.000421422698
  error estimate for blocks of size 2^( 5) =       0.000428090243
  error estimate for blocks of size 2^( 6) =       0.000430481849
  error estimate for blocks of size 2^( 7) =       0.000431186325

      target function =      -0.913484611665
              le_mean =     -17.206453563202
             les_mean =     296.361574207530
             stat err =       0.000427795279
             autocorr =       1.252995984286
   target nu stat err =       0.000427795279
   target dn stat err =       0.002180227623
      target stat err =       0.003448161151
              std dev =       0.540475666017
             le_variance =       0.292113945557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292024244601
                                         uncertainty =       0.001554853470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292024244601
                                         uncertainty =       0.001554853470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382174009
  error estimate for blocks of size 2^( 2) =       0.000397053529
  error estimate for blocks of size 2^( 3) =       0.000410735853
  error estimate for blocks of size 2^( 4) =       0.000421422698
  error estimate for blocks of size 2^( 5) =       0.000428090243
  error estimate for blocks of size 2^( 6) =       0.000430481849
  error estimate for blocks of size 2^( 7) =       0.000431186325

      target function =      -0.913484611665
              le_mean =     -17.206453563202
             les_mean =     296.361574207530
             stat err =       0.000427795279
             autocorr =       1.252995984286
   target nu stat err =       0.000427795279
   target dn stat err =       0.002180227623
      target stat err =       0.003448161151
              std dev =       0.540475666017
             le_variance =       0.292113945557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292024244601
                                         uncertainty =       0.001554853470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292024244601
                                         uncertainty =       0.001554853470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382174009
  error estimate for blocks of size 2^( 2) =       0.000397053529
  error estimate for blocks of size 2^( 3) =       0.000410735853
  error estimate for blocks of size 2^( 4) =       0.000421422698
  error estimate for blocks of size 2^( 5) =       0.000428090243
  error estimate for blocks of size 2^( 6) =       0.000430481849
  error estimate for blocks of size 2^( 7) =       0.000431186325

      target function =      -0.913484611665
              le_mean =     -17.206453563202
             les_mean =     296.361574207530
             stat err =       0.000427795279
             autocorr =       1.252995984286
   target nu stat err =       0.000427795279
   target dn stat err =       0.002180227623
      target stat err =       0.003448161151
              std dev =       0.540475666017
             le_variance =       0.292113945557


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913484611665        initial  <--
     1.3553e+32     1.3553e+33             0.0000e+00        -0.913484611665
     5.4210e+32     5.4210e+33             0.0000e+00        -0.913484611665
     2.1684e+33     2.1684e+34             0.0000e+00        -0.913484611665

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.5496
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0217e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.1522
    reference variance = 0.191503
====================================================
  Execution time = 3.7714e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5423e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9996e-01
  Total weights = 1.973785002e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0771e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292053969988
                                         uncertainty =       0.002486322738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292053969988
                                         uncertainty =       0.002486322738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382132989
  error estimate for blocks of size 2^( 2) =       0.000396896319
  error estimate for blocks of size 2^( 3) =       0.000410257522
  error estimate for blocks of size 2^( 4) =       0.000419719354
  error estimate for blocks of size 2^( 5) =       0.000426207615
  error estimate for blocks of size 2^( 6) =       0.000431184970
  error estimate for blocks of size 2^( 7) =       0.000432540559

      target function =      -0.912779921755
              le_mean =     -17.207498177553
             les_mean =     296.397950040468
             stat err =       0.000427413124
             autocorr =       1.251026891736
   target nu stat err =       0.000427413124
   target dn stat err =       0.003390650588
      target stat err =       0.005294880729
              std dev =       0.540417655338
             le_variance =       0.292051242201


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720749817755e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+33, overlap shift 1.3553e+34 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912809770206       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912809770206       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+33, overlap shift 5.4210e+34 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912809770206       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912809770206       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+34, overlap shift 2.1684e+35 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912809770206       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912809770206       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.171739 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8494e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2374
    reference variance = 0.259996
====================================================
  Execution time = 3.7401e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0226e-01
  Total weights = 1.9738e+06
  Execution time = 3.1256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292021594430
                                         uncertainty =       0.002035543421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292021594430
                                         uncertainty =       0.002035543421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382135897
  error estimate for blocks of size 2^( 2) =       0.000396865369
  error estimate for blocks of size 2^( 3) =       0.000410763891
  error estimate for blocks of size 2^( 4) =       0.000420779467
  error estimate for blocks of size 2^( 5) =       0.000426526191
  error estimate for blocks of size 2^( 6) =       0.000430579038
  error estimate for blocks of size 2^( 7) =       0.000431174045

      target function =      -0.909266603370
              le_mean =     -17.206654776133
             les_mean =     296.371229951546
             stat err =       0.000427264685
             autocorr =       1.250139057765
   target nu stat err =       0.000427264685
   target dn stat err =       0.002774541866
      target stat err =       0.004312893866
              std dev =       0.540421768386
             le_variance =       0.292055687746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292021594430
                                         uncertainty =       0.002035543421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292021594430
                                         uncertainty =       0.002035543421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382135897
  error estimate for blocks of size 2^( 2) =       0.000396865369
  error estimate for blocks of size 2^( 3) =       0.000410763891
  error estimate for blocks of size 2^( 4) =       0.000420779467
  error estimate for blocks of size 2^( 5) =       0.000426526191
  error estimate for blocks of size 2^( 6) =       0.000430579038
  error estimate for blocks of size 2^( 7) =       0.000431174045

      target function =      -0.909266603370
              le_mean =     -17.206654776133
             les_mean =     296.371229951546
             stat err =       0.000427264685
             autocorr =       1.250139057765
   target nu stat err =       0.000427264685
   target dn stat err =       0.002774541866
      target stat err =       0.004312893866
              std dev =       0.540421768386
             le_variance =       0.292055687746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292021594430
                                         uncertainty =       0.002035543421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292021594430
                                         uncertainty =       0.002035543421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382135897
  error estimate for blocks of size 2^( 2) =       0.000396865369
  error estimate for blocks of size 2^( 3) =       0.000410763891
  error estimate for blocks of size 2^( 4) =       0.000420779467
  error estimate for blocks of size 2^( 5) =       0.000426526191
  error estimate for blocks of size 2^( 6) =       0.000430579038
  error estimate for blocks of size 2^( 7) =       0.000431174045

      target function =      -0.909266603370
              le_mean =     -17.206654776133
             les_mean =     296.371229951546
             stat err =       0.000427264685
             autocorr =       1.250139057765
   target nu stat err =       0.000427264685
   target dn stat err =       0.002774541866
      target stat err =       0.004312893866
              std dev =       0.540421768386
             le_variance =       0.292055687746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292021594430
                                         uncertainty =       0.002035543421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292021594430
                                         uncertainty =       0.002035543421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382135897
  error estimate for blocks of size 2^( 2) =       0.000396865369
  error estimate for blocks of size 2^( 3) =       0.000410763891
  error estimate for blocks of size 2^( 4) =       0.000420779467
  error estimate for blocks of size 2^( 5) =       0.000426526191
  error estimate for blocks of size 2^( 6) =       0.000430579038
  error estimate for blocks of size 2^( 7) =       0.000431174045

      target function =      -0.909266603370
              le_mean =     -17.206654776133
             les_mean =     296.371229951546
             stat err =       0.000427264685
             autocorr =       1.250139057765
   target nu stat err =       0.000427264685
   target dn stat err =       0.002774541866
      target stat err =       0.004312893866
              std dev =       0.540421768386
             le_variance =       0.292055687746


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909266603370        initial  <--
     1.3553e+33     1.3553e+34             0.0000e+00        -0.909266603370
     5.4210e+33     5.4210e+34             0.0000e+00        -0.909266603370
     2.1684e+34     2.1684e+35             0.0000e+00        -0.909266603370

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.1750
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0167e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.1592
    reference variance = 0.361202
====================================================
  Execution time = 3.9336e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5432e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0123e-01
  Total weights = 1.973674540e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0661e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293235103783
                                         uncertainty =       0.001942564293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293235103783
                                         uncertainty =       0.001942564293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382902499
  error estimate for blocks of size 2^( 2) =       0.000397960274
  error estimate for blocks of size 2^( 3) =       0.000411162982
  error estimate for blocks of size 2^( 4) =       0.000421463615
  error estimate for blocks of size 2^( 5) =       0.000427202891
  error estimate for blocks of size 2^( 6) =       0.000430062461
  error estimate for blocks of size 2^( 7) =       0.000431713894

      target function =      -0.910844323709
              le_mean =     -17.206916627830
             les_mean =     296.379211859191
             stat err =       0.000427610715
             autocorr =       1.247155933773
   target nu stat err =       0.000427610715
   target dn stat err =       0.002401436953
      target stat err =       0.003765011810
              std dev =       0.541505907279
             le_variance =       0.293228647618


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720691662783e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+34, overlap shift 1.3553e+35 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910858802852       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910858802852       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910858802852       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910858154297       residual = 2.91e+03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+34 is 8.079943e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+34, overlap shift 5.4210e+35 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910858802852       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910858802852       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910858802852       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910858802852       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910858802851       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910858792402       residual = 8.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.816315126023       residual = 8.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+34 is 2.548171e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+35, overlap shift 2.1684e+36 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910858802852       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910858802852       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910858802852       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910858802851       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910858154297       residual = 2.89e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910858801726       residual = 8.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+35 is 6.586017e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.174121 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0007e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.1849
    reference variance = 0.310478
====================================================
  Execution time = 3.7074e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9818e-01
  Total weights = 1.9737e+06
  Execution time = 3.1367e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291464283613
                                         uncertainty =       0.002204088968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291464283613
                                         uncertainty =       0.002204088968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381737054
  error estimate for blocks of size 2^( 2) =       0.000396343243
  error estimate for blocks of size 2^( 3) =       0.000409737271
  error estimate for blocks of size 2^( 4) =       0.000419892160
  error estimate for blocks of size 2^( 5) =       0.000425625828
  error estimate for blocks of size 2^( 6) =       0.000428174710
  error estimate for blocks of size 2^( 7) =       0.000429030657

      target function =      -0.915574469311
              le_mean =     -17.206619838708
             les_mean =     296.365941330468
             stat err =       0.000425680839
             autocorr =       1.243482182892
   target nu stat err =       0.000425680839
   target dn stat err =       0.002707440721
      target stat err =       0.004268573973
              std dev =       0.539857719708
             le_variance =       0.291446357529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291464283613
                                         uncertainty =       0.002204088968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291464283613
                                         uncertainty =       0.002204088968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381737054
  error estimate for blocks of size 2^( 2) =       0.000396343243
  error estimate for blocks of size 2^( 3) =       0.000409737271
  error estimate for blocks of size 2^( 4) =       0.000419892160
  error estimate for blocks of size 2^( 5) =       0.000425625828
  error estimate for blocks of size 2^( 6) =       0.000428174710
  error estimate for blocks of size 2^( 7) =       0.000429030657

      target function =      -0.915574469311
              le_mean =     -17.206619838708
             les_mean =     296.365941330468
             stat err =       0.000425680839
             autocorr =       1.243482182892
   target nu stat err =       0.000425680839
   target dn stat err =       0.002707440721
      target stat err =       0.004268573973
              std dev =       0.539857719708
             le_variance =       0.291446357529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291464283613
                                         uncertainty =       0.002204088968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291464283613
                                         uncertainty =       0.002204088968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381737054
  error estimate for blocks of size 2^( 2) =       0.000396343243
  error estimate for blocks of size 2^( 3) =       0.000409737271
  error estimate for blocks of size 2^( 4) =       0.000419892160
  error estimate for blocks of size 2^( 5) =       0.000425625828
  error estimate for blocks of size 2^( 6) =       0.000428174710
  error estimate for blocks of size 2^( 7) =       0.000429030657

      target function =      -0.915574469311
              le_mean =     -17.206619838708
             les_mean =     296.365941330468
             stat err =       0.000425680839
             autocorr =       1.243482182892
   target nu stat err =       0.000425680839
   target dn stat err =       0.002707440721
      target stat err =       0.004268573973
              std dev =       0.539857719708
             le_variance =       0.291446357529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291464283613
                                         uncertainty =       0.002204088968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291464283613
                                         uncertainty =       0.002204088968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381737054
  error estimate for blocks of size 2^( 2) =       0.000396343243
  error estimate for blocks of size 2^( 3) =       0.000409737271
  error estimate for blocks of size 2^( 4) =       0.000419892160
  error estimate for blocks of size 2^( 5) =       0.000425625828
  error estimate for blocks of size 2^( 6) =       0.000428174710
  error estimate for blocks of size 2^( 7) =       0.000429030657

      target function =      -0.915574469311
              le_mean =     -17.206619838708
             les_mean =     296.365941330468
             stat err =       0.000425680839
             autocorr =       1.243482182892
   target nu stat err =       0.000425680839
   target dn stat err =       0.002707440721
      target stat err =       0.004268573973
              std dev =       0.539857719708
             le_variance =       0.291446357529


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915574469311        initial  <--
     1.3553e+34     1.3553e+35             8.0799e-39        -0.915574469311
     5.4210e+34     5.4210e+35             2.5482e-39        -0.915574469311
     2.1684e+35     2.1684e+36             6.5860e-40        -0.915574469311

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.8598
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0287e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2851
    reference variance = 0.168577
====================================================
  Execution time = 3.7832e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5415e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9850e-01
  Total weights = 1.973348828e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0813e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291861107927
                                         uncertainty =       0.002684746003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291861107927
                                         uncertainty =       0.002684746003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381966339
  error estimate for blocks of size 2^( 2) =       0.000397029887
  error estimate for blocks of size 2^( 3) =       0.000410484571
  error estimate for blocks of size 2^( 4) =       0.000419768731
  error estimate for blocks of size 2^( 5) =       0.000425279458
  error estimate for blocks of size 2^( 6) =       0.000429692924
  error estimate for blocks of size 2^( 7) =       0.000431862437

      target function =      -0.915060724345
              le_mean =     -17.206475925614
             les_mean =     296.361318659541
             stat err =       0.000426650888
             autocorr =       1.247656752989
   target nu stat err =       0.000426650888
   target dn stat err =       0.002987719155
      target stat err =       0.004692200115
              std dev =       0.540181977560
             le_variance =       0.291796568881


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720647592561e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+35, overlap shift 1.3553e+36 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915084078317       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915084078317       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915083885193       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+35 is 7.661188e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+35, overlap shift 5.4210e+36 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915084078317       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915084078317       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915083885193       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+35 is 1.915297e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+36, overlap shift 2.1684e+37 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915084078317       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915084078317       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915084838867       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+36 is 4.788243e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.175533 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8653e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.1746
    reference variance = 0.191858
====================================================
  Execution time = 3.7366e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9810e-01
  Total weights = 1.9740e+06
  Execution time = 3.1396e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291119229052
                                         uncertainty =       0.001597670949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291119229052
                                         uncertainty =       0.001597670949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381516839
  error estimate for blocks of size 2^( 2) =       0.000396258508
  error estimate for blocks of size 2^( 3) =       0.000409637529
  error estimate for blocks of size 2^( 4) =       0.000420076176
  error estimate for blocks of size 2^( 5) =       0.000427001331
  error estimate for blocks of size 2^( 6) =       0.000432284040
  error estimate for blocks of size 2^( 7) =       0.000431980436

      target function =      -0.915691672599
              le_mean =     -17.206621382574
             les_mean =     296.365924117418
             stat err =       0.000427835496
             autocorr =       1.257552728369
   target nu stat err =       0.000427835496
   target dn stat err =       0.002071712038
      target stat err =       0.003300835917
              std dev =       0.539546288424
             le_variance =       0.291110197352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291119229052
                                         uncertainty =       0.001597670949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291119229052
                                         uncertainty =       0.001597670949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381516839
  error estimate for blocks of size 2^( 2) =       0.000396258508
  error estimate for blocks of size 2^( 3) =       0.000409637529
  error estimate for blocks of size 2^( 4) =       0.000420076176
  error estimate for blocks of size 2^( 5) =       0.000427001331
  error estimate for blocks of size 2^( 6) =       0.000432284040
  error estimate for blocks of size 2^( 7) =       0.000431980436

      target function =      -0.915691672599
              le_mean =     -17.206621382574
             les_mean =     296.365924117418
             stat err =       0.000427835496
             autocorr =       1.257552728367
   target nu stat err =       0.000427835496
   target dn stat err =       0.002071712038
      target stat err =       0.003300835917
              std dev =       0.539546288424
             le_variance =       0.291110197352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291119229052
                                         uncertainty =       0.001597670949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291119229052
                                         uncertainty =       0.001597670949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381516839
  error estimate for blocks of size 2^( 2) =       0.000396258508
  error estimate for blocks of size 2^( 3) =       0.000409637529
  error estimate for blocks of size 2^( 4) =       0.000420076176
  error estimate for blocks of size 2^( 5) =       0.000427001331
  error estimate for blocks of size 2^( 6) =       0.000432284040
  error estimate for blocks of size 2^( 7) =       0.000431980436

      target function =      -0.915691672599
              le_mean =     -17.206621382574
             les_mean =     296.365924117418
             stat err =       0.000427835496
             autocorr =       1.257552728367
   target nu stat err =       0.000427835496
   target dn stat err =       0.002071712038
      target stat err =       0.003300835917
              std dev =       0.539546288424
             le_variance =       0.291110197352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291119229052
                                         uncertainty =       0.001597670949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291119229052
                                         uncertainty =       0.001597670949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381516839
  error estimate for blocks of size 2^( 2) =       0.000396258508
  error estimate for blocks of size 2^( 3) =       0.000409637529
  error estimate for blocks of size 2^( 4) =       0.000420076176
  error estimate for blocks of size 2^( 5) =       0.000427001331
  error estimate for blocks of size 2^( 6) =       0.000432284040
  error estimate for blocks of size 2^( 7) =       0.000431980436

      target function =      -0.915691672599
              le_mean =     -17.206621382574
             les_mean =     296.365924117418
             stat err =       0.000427835496
             autocorr =       1.257552728367
   target nu stat err =       0.000427835496
   target dn stat err =       0.002071712038
      target stat err =       0.003300835917
              std dev =       0.539546288424
             le_variance =       0.291110197352


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915691672599        initial  <--
     1.3553e+35     1.3553e+36             7.6612e-40        -0.915691672599
     5.4210e+35     5.4210e+36             1.9153e-40        -0.915691672599
     2.1684e+36     2.1684e+37             4.7882e-41        -0.915691672599

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.1646
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0182e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2325
    reference variance = 0.156876
====================================================
  Execution time = 3.7745e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5409e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9677e-01
  Total weights = 1.973578024e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0843e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289294808110
                                         uncertainty =       0.001805260315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289294808110
                                         uncertainty =       0.001805260315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380380150
  error estimate for blocks of size 2^( 2) =       0.000394932748
  error estimate for blocks of size 2^( 3) =       0.000408913407
  error estimate for blocks of size 2^( 4) =       0.000418591632
  error estimate for blocks of size 2^( 5) =       0.000425815535
  error estimate for blocks of size 2^( 6) =       0.000427518744
  error estimate for blocks of size 2^( 7) =       0.000426531680

      target function =      -0.917759683919
              le_mean =     -17.206711631408
             les_mean =     296.367699264294
             stat err =       0.000424614398
             autocorr =       1.246102427651
   target nu stat err =       0.000424614398
   target dn stat err =       0.002349030541
      target stat err =       0.003738595230
              std dev =       0.537938766780
             le_variance =       0.289378116805


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720671163141e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+36, overlap shift 1.3553e+37 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917773848710       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917773848710       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917773848710       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+36 is 4.543705e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+36, overlap shift 5.4210e+37 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917773848710       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917773848710       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917773848710       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+36 is 1.135926e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+37, overlap shift 2.1684e+38 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917773848710       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917773848710       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917773848710       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+37 is 2.839815e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.177009 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8598e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2701
    reference variance = 0.14255
====================================================
  Execution time = 3.7303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0395e-01
  Total weights = 1.9739e+06
  Execution time = 3.1622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290323548744
                                         uncertainty =       0.002059414868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290323548744
                                         uncertainty =       0.002059414868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381012940
  error estimate for blocks of size 2^( 2) =       0.000395874002
  error estimate for blocks of size 2^( 3) =       0.000408873604
  error estimate for blocks of size 2^( 4) =       0.000418590379
  error estimate for blocks of size 2^( 5) =       0.000424833117
  error estimate for blocks of size 2^( 6) =       0.000427624241
  error estimate for blocks of size 2^( 7) =       0.000428502101

      target function =      -0.906583899561
              le_mean =     -17.207068206853
             les_mean =     296.387142728374
             stat err =       0.000424887459
             autocorr =       1.243564673546
   target nu stat err =       0.000424887459
   target dn stat err =       0.006602562739
      target stat err =       0.010093716677
              std dev =       0.538833666505
             le_variance =       0.290341720159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290323548744
                                         uncertainty =       0.002059414868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290323548744
                                         uncertainty =       0.002059414868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381012940
  error estimate for blocks of size 2^( 2) =       0.000395874002
  error estimate for blocks of size 2^( 3) =       0.000408873604
  error estimate for blocks of size 2^( 4) =       0.000418590379
  error estimate for blocks of size 2^( 5) =       0.000424833117
  error estimate for blocks of size 2^( 6) =       0.000427624241
  error estimate for blocks of size 2^( 7) =       0.000428502101

      target function =      -0.906583899561
              le_mean =     -17.207068206853
             les_mean =     296.387142728374
             stat err =       0.000424887459
             autocorr =       1.243564673546
   target nu stat err =       0.000424887459
   target dn stat err =       0.006602562739
      target stat err =       0.010093716677
              std dev =       0.538833666505
             le_variance =       0.290341720159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290323548744
                                         uncertainty =       0.002059414868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290323548744
                                         uncertainty =       0.002059414868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381012940
  error estimate for blocks of size 2^( 2) =       0.000395874002
  error estimate for blocks of size 2^( 3) =       0.000408873604
  error estimate for blocks of size 2^( 4) =       0.000418590379
  error estimate for blocks of size 2^( 5) =       0.000424833117
  error estimate for blocks of size 2^( 6) =       0.000427624241
  error estimate for blocks of size 2^( 7) =       0.000428502101

      target function =      -0.906583899561
              le_mean =     -17.207068206853
             les_mean =     296.387142728374
             stat err =       0.000424887459
             autocorr =       1.243564673546
   target nu stat err =       0.000424887459
   target dn stat err =       0.006602562739
      target stat err =       0.010093716677
              std dev =       0.538833666505
             le_variance =       0.290341720159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290323548744
                                         uncertainty =       0.002059414868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290323548744
                                         uncertainty =       0.002059414868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381012940
  error estimate for blocks of size 2^( 2) =       0.000395874002
  error estimate for blocks of size 2^( 3) =       0.000408873604
  error estimate for blocks of size 2^( 4) =       0.000418590379
  error estimate for blocks of size 2^( 5) =       0.000424833117
  error estimate for blocks of size 2^( 6) =       0.000427624241
  error estimate for blocks of size 2^( 7) =       0.000428502101

      target function =      -0.906583899561
              le_mean =     -17.207068206853
             les_mean =     296.387142728374
             stat err =       0.000424887459
             autocorr =       1.243564673546
   target nu stat err =       0.000424887459
   target dn stat err =       0.006602562739
      target stat err =       0.010093716677
              std dev =       0.538833666505
             le_variance =       0.290341720159


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.906583899561        initial  <--
     1.3553e+36     1.3553e+37             4.5437e-41        -0.906583899561
     5.4210e+36     5.4210e+37             1.1359e-41        -0.906583899561
     2.1684e+37     2.1684e+38             2.8398e-42        -0.906583899561

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.2314
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0584e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.1904
    reference variance = 0.249288
====================================================
  Execution time = 3.8133e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5417e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9620e-01
  Total weights = 1.973742646e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0877e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289450740327
                                         uncertainty =       0.001825039444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289450740327
                                         uncertainty =       0.001825039444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380389800
  error estimate for blocks of size 2^( 2) =       0.000395086361
  error estimate for blocks of size 2^( 3) =       0.000408462664
  error estimate for blocks of size 2^( 4) =       0.000418867409
  error estimate for blocks of size 2^( 5) =       0.000425197362
  error estimate for blocks of size 2^( 6) =       0.000427112719
  error estimate for blocks of size 2^( 7) =       0.000429352758

      target function =      -0.918649958310
              le_mean =     -17.207316648309
             les_mean =     296.387945679983
             stat err =       0.000425132562
             autocorr =       1.249082182083
   target nu stat err =       0.000425132562
   target dn stat err =       0.002193068016
      target stat err =       0.003510721224
              std dev =       0.537952414513
             le_variance =       0.289392800280


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720731664831e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+37, overlap shift 1.3553e+38 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918662293658       residual = 6.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918662293658       residual = 9.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918663024902       residual = 6.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+37 is 1.024235e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+37, overlap shift 5.4210e+38 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918662293658       residual = 6.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918662293658       residual = 9.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918663024902       residual = 6.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+37 is 2.560587e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+38, overlap shift 2.1684e+39 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918662293658       residual = 6.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918662293658       residual = 9.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918662293658       residual = 6.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+38 is 6.401467e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.178451 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9019e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.1668
    reference variance = 0.174812
====================================================
  Execution time = 3.8098e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9760e-01
  Total weights = 1.9739e+06
  Execution time = 3.1553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291689506981
                                         uncertainty =       0.002241676938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291689506981
                                         uncertainty =       0.002241676938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381893981
  error estimate for blocks of size 2^( 2) =       0.000396757135
  error estimate for blocks of size 2^( 3) =       0.000410518522
  error estimate for blocks of size 2^( 4) =       0.000420086220
  error estimate for blocks of size 2^( 5) =       0.000425698397
  error estimate for blocks of size 2^( 6) =       0.000428102511
  error estimate for blocks of size 2^( 7) =       0.000430938655

      target function =      -0.916463811318
              le_mean =     -17.207006689405
             les_mean =     296.378679028768
             stat err =       0.000426206446
             autocorr =       1.245530594362
   target nu stat err =       0.000426206446
   target dn stat err =       0.002548474323
      target stat err =       0.004036084984
              std dev =       0.540079647472
             le_variance =       0.291686025613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291689506981
                                         uncertainty =       0.002241676938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291689506981
                                         uncertainty =       0.002241676938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381893981
  error estimate for blocks of size 2^( 2) =       0.000396757135
  error estimate for blocks of size 2^( 3) =       0.000410518522
  error estimate for blocks of size 2^( 4) =       0.000420086220
  error estimate for blocks of size 2^( 5) =       0.000425698397
  error estimate for blocks of size 2^( 6) =       0.000428102511
  error estimate for blocks of size 2^( 7) =       0.000430938655

      target function =      -0.916463811318
              le_mean =     -17.207006689405
             les_mean =     296.378679028768
             stat err =       0.000426206446
             autocorr =       1.245530594362
   target nu stat err =       0.000426206446
   target dn stat err =       0.002548474323
      target stat err =       0.004036084984
              std dev =       0.540079647472
             le_variance =       0.291686025613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291689506981
                                         uncertainty =       0.002241676938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291689506981
                                         uncertainty =       0.002241676938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381893981
  error estimate for blocks of size 2^( 2) =       0.000396757135
  error estimate for blocks of size 2^( 3) =       0.000410518522
  error estimate for blocks of size 2^( 4) =       0.000420086220
  error estimate for blocks of size 2^( 5) =       0.000425698397
  error estimate for blocks of size 2^( 6) =       0.000428102511
  error estimate for blocks of size 2^( 7) =       0.000430938655

      target function =      -0.916463811318
              le_mean =     -17.207006689405
             les_mean =     296.378679028768
             stat err =       0.000426206446
             autocorr =       1.245530594362
   target nu stat err =       0.000426206446
   target dn stat err =       0.002548474323
      target stat err =       0.004036084984
              std dev =       0.540079647472
             le_variance =       0.291686025613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291689506981
                                         uncertainty =       0.002241676938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291689506981
                                         uncertainty =       0.002241676938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381893981
  error estimate for blocks of size 2^( 2) =       0.000396757135
  error estimate for blocks of size 2^( 3) =       0.000410518522
  error estimate for blocks of size 2^( 4) =       0.000420086220
  error estimate for blocks of size 2^( 5) =       0.000425698397
  error estimate for blocks of size 2^( 6) =       0.000428102511
  error estimate for blocks of size 2^( 7) =       0.000430938655

      target function =      -0.916463811318
              le_mean =     -17.207006689405
             les_mean =     296.378679028768
             stat err =       0.000426206446
             autocorr =       1.245530594362
   target nu stat err =       0.000426206446
   target dn stat err =       0.002548474323
      target stat err =       0.004036084984
              std dev =       0.540079647472
             le_variance =       0.291686025613


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916463811318        initial  <--
     1.3553e+37     1.3553e+38             1.0242e-41        -0.916463811318
     5.4210e+37     5.4210e+38             2.5606e-42        -0.916463811318
     2.1684e+38     2.1684e+39             6.4015e-43        -0.916463811318

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0207
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0305e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2052
    reference variance = 0.258386
====================================================
  Execution time = 3.7868e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5395e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9729e-01
  Total weights = 1.974007019e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0767e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287792971574
                                         uncertainty =       0.001799648642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287792971574
                                         uncertainty =       0.001799648642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379338158
  error estimate for blocks of size 2^( 2) =       0.000394649586
  error estimate for blocks of size 2^( 3) =       0.000408121276
  error estimate for blocks of size 2^( 4) =       0.000417467832
  error estimate for blocks of size 2^( 5) =       0.000422752698
  error estimate for blocks of size 2^( 6) =       0.000426458067
  error estimate for blocks of size 2^( 7) =       0.000428845345

      target function =      -0.916956483323
              le_mean =     -17.206288441778
             les_mean =     296.353653026967
             stat err =       0.000423880985
             autocorr =       1.248632998578
   target nu stat err =       0.000423880985
   target dn stat err =       0.002648408214
      target stat err =       0.004187529967
              std dev =       0.536465168042
             le_variance =       0.287794876522


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720628844178e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+38, overlap shift 1.3553e+39 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916974713377       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916974713377       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.4210e+38, overlap shift 5.4210e+39 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916974713377       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916974713377       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.1684e+39, overlap shift 2.1684e+40 and omega -1.7746e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916974713377       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916974713377       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.179619 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8643e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.1825
    reference variance = 0.172292
====================================================
  Execution time = 3.7640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9862e-01
  Total weights = 1.9738e+06
  Execution time = 3.1584e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290428197343
                                         uncertainty =       0.001677092698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290428197343
                                         uncertainty =       0.001677092698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381040727
  error estimate for blocks of size 2^( 2) =       0.000395873294
  error estimate for blocks of size 2^( 3) =       0.000409668765
  error estimate for blocks of size 2^( 4) =       0.000420028015
  error estimate for blocks of size 2^( 5) =       0.000426177806
  error estimate for blocks of size 2^( 6) =       0.000428709634
  error estimate for blocks of size 2^( 7) =       0.000429572043

      target function =      -0.914885110284
              le_mean =     -17.206982477588
             les_mean =     296.378861527229
             stat err =       0.000426121874
             autocorr =       1.250618541009
   target nu stat err =       0.000426121874
   target dn stat err =       0.002511731400
      target stat err =       0.003966104031
              std dev =       0.538872964156
             le_variance =       0.290384071498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290428197343
                                         uncertainty =       0.001677092698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290428197343
                                         uncertainty =       0.001677092698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381040727
  error estimate for blocks of size 2^( 2) =       0.000395873294
  error estimate for blocks of size 2^( 3) =       0.000409668765
  error estimate for blocks of size 2^( 4) =       0.000420028015
  error estimate for blocks of size 2^( 5) =       0.000426177806
  error estimate for blocks of size 2^( 6) =       0.000428709634
  error estimate for blocks of size 2^( 7) =       0.000429572043

      target function =      -0.914885110284
              le_mean =     -17.206982477588
             les_mean =     296.378861527229
             stat err =       0.000426121874
             autocorr =       1.250618541009
   target nu stat err =       0.000426121874
   target dn stat err =       0.002511731400
      target stat err =       0.003966104031
              std dev =       0.538872964156
             le_variance =       0.290384071498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290428197343
                                         uncertainty =       0.001677092698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290428197343
                                         uncertainty =       0.001677092698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381040727
  error estimate for blocks of size 2^( 2) =       0.000395873294
  error estimate for blocks of size 2^( 3) =       0.000409668765
  error estimate for blocks of size 2^( 4) =       0.000420028015
  error estimate for blocks of size 2^( 5) =       0.000426177806
  error estimate for blocks of size 2^( 6) =       0.000428709634
  error estimate for blocks of size 2^( 7) =       0.000429572043

      target function =      -0.914885110284
              le_mean =     -17.206982477588
             les_mean =     296.378861527229
             stat err =       0.000426121874
             autocorr =       1.250618541009
   target nu stat err =       0.000426121874
   target dn stat err =       0.002511731400
      target stat err =       0.003966104031
              std dev =       0.538872964156
             le_variance =       0.290384071498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290428197343
                                         uncertainty =       0.001677092698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290428197343
                                         uncertainty =       0.001677092698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381040727
  error estimate for blocks of size 2^( 2) =       0.000395873294
  error estimate for blocks of size 2^( 3) =       0.000409668765
  error estimate for blocks of size 2^( 4) =       0.000420028015
  error estimate for blocks of size 2^( 5) =       0.000426177806
  error estimate for blocks of size 2^( 6) =       0.000428709634
  error estimate for blocks of size 2^( 7) =       0.000429572043

      target function =      -0.914885110284
              le_mean =     -17.206982477588
             les_mean =     296.378861527229
             stat err =       0.000426121874
             autocorr =       1.250618541009
   target nu stat err =       0.000426121874
   target dn stat err =       0.002511731400
      target stat err =       0.003966104031
              std dev =       0.538872964156
             le_variance =       0.290384071498


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914885110284        initial  <--
     1.3553e+38     1.3553e+39             0.0000e+00        -0.914885110284
     5.4210e+38     5.4210e+39             0.0000e+00        -0.914885110284
     2.1684e+39     2.1684e+40             0.0000e+00        -0.914885110284

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.5245
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.087048e-01 1 1  ON 0
  uu_1                 5.166659e-02 1 1  ON 1
  uu_2                -3.940109e-02 1 1  ON 2
  uu_3                -9.291199e-02 1 1  ON 3
  uu_4                -1.239443e-01 1 1  ON 4
  uu_5                -1.319981e-01 1 1  ON 5
  uu_6                -1.137854e-01 1 1  ON 6
  uu_7                -5.393157e-02 1 1  ON 7
  uu_8                 7.179273e-02 1 1  ON 8
  uu_9                 1.240341e-01 1 1  ON 9
  ud_0                 3.081000e-01 1 1  ON 10
  ud_1                 7.810462e-02 1 1  ON 11
  ud_2                -2.402946e-02 1 1  ON 12
  ud_3                -7.733644e-02 1 1  ON 13
  ud_4                -1.141469e-01 1 1  ON 14
  ud_5                -1.343876e-01 1 1  ON 15
  ud_6                -1.304657e-01 1 1  ON 16
  ud_7                -8.981631e-02 1 1  ON 17
  ud_8                -4.429621e-03 1 1  ON 18
  ud_9                 8.809320e-02 1 1  ON 19
  eO_0                -7.053827e-01 1 1  ON 20
  eO_1                -4.211844e-01 1 1  ON 21
  eO_2                -4.127810e-02 1 1  ON 22
  eO_3                 1.870602e-01 1 1  ON 23
  eO_4                 2.613791e-01 1 1  ON 24
  eO_5                 2.856679e-01 1 1  ON 25
  eO_6                 2.498752e-01 1 1  ON 26
  eO_7                 1.252774e-01 1 1  ON 27
  eO_8                 2.849736e-02 1 1  ON 28
  eO_9                 1.896086e-02 1 1  ON 29
 eH1_0                -2.018813e-01 1 1  ON 30
 eH1_1                -9.762575e-02 1 1  ON 31
 eH1_2                -4.695821e-02 1 1  ON 32
 eH1_3                -1.559994e-02 1 1  ON 33
 eH1_4                 1.884980e-02 1 1  ON 34
 eH1_5                 2.620746e-02 1 1  ON 35
 eH1_6                 7.491231e-02 1 1  ON 36
 eH1_7                 1.041056e-01 1 1  ON 37
 eH1_8                 9.703784e-02 1 1  ON 38
 eH1_9                 2.520340e-02 1 1  ON 39
 eH2_0                -2.031282e-01 1 1  ON 40
 eH2_1                -9.994439e-02 1 1  ON 41
 eH2_2                -4.927126e-02 1 1  ON 42
 eH2_3                -1.790885e-02 1 1  ON 43
 eH2_4                 1.638122e-02 1 1  ON 44
 eH2_5                 2.331249e-02 1 1  ON 45
 eH2_6                 7.776965e-02 1 1  ON 46
 eH2_7                 1.127068e-01 1 1  ON 47
 eH2_8                 9.971219e-02 1 1  ON 48
 eH2_9                 2.792592e-02 1 1  ON 49
ci_001                -4.261563e-02 3 1  ON 50
ci_002                -3.174043e-02 3 1  ON 51
ci_003                -1.241142e-02 3 1  ON 52
ci_004                 2.578206e-02 3 1  ON 53
ci_005                 2.603718e-02 3 1  ON 54
ci_006                -2.086967e-02 3 1  ON 55
ci_007                -2.067472e-02 3 1  ON 56
ci_008                -5.062906e-03 3 1  ON 57
ci_009                -1.563057e-02 3 1  ON 58
ci_010                -1.049592e-02 3 1  ON 59
ci_011                -1.040935e-02 3 1  ON 60
ci_012                -1.050527e-02 3 1  ON 61
ci_013                -2.150625e-02 3 1  ON 62
ci_014                 1.374391e-02 3 1  ON 63
ci_015                 1.357453e-02 3 1  ON 64
ci_016                 1.685231e-02 3 1  ON 65
ci_017                 1.606458e-02 3 1  ON 66
ci_018                 1.116271e-02 3 1  ON 67
ci_019                 1.083129e-02 3 1  ON 68
ci_020                 1.815738e-02 3 1  ON 69
ci_021                 1.790948e-02 3 1  ON 70
ci_022                 1.041180e-02 3 1  ON 71
ci_023                 1.092370e-02 3 1  ON 72
ci_024                 7.125475e-03 3 1  ON 73
ci_025                 7.214301e-03 3 1  ON 74
ci_026                 1.196642e-02 3 1  ON 75
ci_027                 1.214330e-02 3 1  ON 76
ci_028                -1.010229e-02 3 1  ON 77
ci_029                -9.846032e-03 3 1  ON 78
ci_030                -4.814047e-03 3 1  ON 79
ci_031                -5.117723e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0217e+02 secs
  Total Execution time = 1.0299e+04 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
