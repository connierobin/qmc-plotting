Rank =    0  Free Memory = 89168 MB
Rank =    1  Free Memory = 89168 MB
Rank =    2  Free Memory = 89168 MB
Rank =    3  Free Memory = 89168 MB
Rank =    4  Free Memory = 89168 MB
Rank =    5  Free Memory = 89167 MB
Rank =    6  Free Memory = 89167 MB
Rank =    7  Free Memory = 89167 MB
Rank =    8  Free Memory = 89167 MB
Rank =    9  Free Memory = 89167 MB
Rank =   10  Free Memory = 89167 MB
Rank =   11  Free Memory = 89166 MB
Rank =   12  Free Memory = 89166 MB
Rank =   13  Free Memory = 89166 MB
Rank =   14  Free Memory = 89166 MB
Rank =   15  Free Memory = 89152 MB
Rank =   16  Free Memory = 89151 MB
Rank =   17  Free Memory = 89151 MB
Rank =   18  Free Memory = 89151 MB
Rank =   19  Free Memory = 89151 MB
Rank =   20  Free Memory = 89151 MB
Rank =   21  Free Memory = 89151 MB
Rank =   22  Free Memory = 89151 MB
Rank =   23  Free Memory = 89151 MB
Rank =   24  Free Memory = 89151 MB
Rank =   25  Free Memory = 89151 MB
Rank =   26  Free Memory = 89151 MB
Rank =   27  Free Memory = 89151 MB
Rank =   28  Free Memory = 89151 MB
Rank =   29  Free Memory = 89151 MB
Rank =   30  Free Memory = 89151 MB
Rank =   31  Free Memory = 89151 MB
Rank =   32  Free Memory = 62310 MB
Rank =   33  Free Memory = 62310 MB
Rank =   34  Free Memory = 62310 MB
Rank =   35  Free Memory = 62310 MB
Rank =   36  Free Memory = 62310 MB
Rank =   37  Free Memory = 62310 MB
Rank =   38  Free Memory = 62310 MB
Rank =   39  Free Memory = 62310 MB
Rank =   40  Free Memory = 62310 MB
Rank =   41  Free Memory = 62310 MB
Rank =   42  Free Memory = 62310 MB
Rank =   43  Free Memory = 62310 MB
Rank =   44  Free Memory = 62310 MB
Rank =   45  Free Memory = 62310 MB
Rank =   46  Free Memory = 62310 MB
Rank =   47  Free Memory = 62310 MB
Rank =   48  Free Memory = 62310 MB
Rank =   49  Free Memory = 62310 MB
Rank =   50  Free Memory = 62310 MB
Rank =   51  Free Memory = 62310 MB
Rank =   52  Free Memory = 62310 MB
Rank =   53  Free Memory = 62310 MB
Rank =   54  Free Memory = 62310 MB
Rank =   55  Free Memory = 62310 MB
Rank =   56  Free Memory = 62310 MB
Rank =   57  Free Memory = 62310 MB
Rank =   58  Free Memory = 62310 MB
Rank =   59  Free Memory = 62310 MB
Rank =   60  Free Memory = 62310 MB
Rank =   61  Free Memory = 62310 MB
Rank =   62  Free Memory = 62310 MB
Rank =   63  Free Memory = 62310 MB
Rank =   64  Free Memory = 89996 MB
Rank =   65  Free Memory = 89996 MB
Rank =   66  Free Memory = 89996 MB
Rank =   67  Free Memory = 89996 MB
Rank =   68  Free Memory = 89996 MB
Rank =   69  Free Memory = 89996 MB
Rank =   70  Free Memory = 89996 MB
Rank =   71  Free Memory = 89996 MB
Rank =   72  Free Memory = 89996 MB
Rank =   73  Free Memory = 89996 MB
Rank =   74  Free Memory = 89996 MB
Rank =   75  Free Memory = 89996 MB
Rank =   76  Free Memory = 89996 MB
Rank =   77  Free Memory = 89996 MB
Rank =   78  Free Memory = 89996 MB
Rank =   79  Free Memory = 89996 MB
Rank =   80  Free Memory = 89996 MB
Rank =   81  Free Memory = 89996 MB
Rank =   82  Free Memory = 89996 MB
Rank =   83  Free Memory = 89996 MB
Rank =   84  Free Memory = 89996 MB
Rank =   85  Free Memory = 89996 MB
Rank =   86  Free Memory = 89996 MB
Rank =   87  Free Memory = 89996 MB
Rank =   88  Free Memory = 89996 MB
Rank =   89  Free Memory = 89996 MB
Rank =   90  Free Memory = 89996 MB
Rank =   91  Free Memory = 89996 MB
Rank =   92  Free Memory = 89996 MB
Rank =   93  Free Memory = 89996 MB
Rank =   94  Free Memory = 89996 MB
Rank =   95  Free Memory = 89996 MB
Rank =   96  Free Memory = 74798 MB
Rank =   97  Free Memory = 74798 MB
Rank =   98  Free Memory = 74798 MB
Rank =   99  Free Memory = 74798 MB
Rank =  100  Free Memory = 74798 MB
Rank =  101  Free Memory = 74798 MB
Rank =  102  Free Memory = 74798 MB
Rank =  103  Free Memory = 74798 MB
Rank =  104  Free Memory = 74798 MB
Rank =  105  Free Memory = 74798 MB
Rank =  106  Free Memory = 74798 MB
Rank =  107  Free Memory = 74798 MB
Rank =  108  Free Memory = 74798 MB
Rank =  109  Free Memory = 74798 MB
Rank =  110  Free Memory = 74798 MB
Rank =  111  Free Memory = 74798 MB
Rank =  112  Free Memory = 74798 MB
Rank =  113  Free Memory = 74798 MB
Rank =  114  Free Memory = 74798 MB
Rank =  115  Free Memory = 74798 MB
Rank =  116  Free Memory = 74798 MB
Rank =  117  Free Memory = 74798 MB
Rank =  118  Free Memory = 74798 MB
Rank =  119  Free Memory = 74798 MB
Rank =  120  Free Memory = 74798 MB
Rank =  121  Free Memory = 74798 MB
Rank =  122  Free Memory = 74798 MB
Rank =  123  Free Memory = 74798 MB
Rank =  124  Free Memory = 74798 MB
Rank =  125  Free Memory = 74798 MB
Rank =  126  Free Memory = 74798 MB
Rank =  127  Free Memory = 74798 MB
  Input file(s): opt_form_pi2pistar_tett_run002f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_pi2pistar_tett_run002f.xml

  Project = FORM
  date    = 2023-03-13 00:20:36 PDT
  host    = n0065.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 708

  Range of prime numbers to use as seeds over processors and threads = 5387-6451


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.552564e-01    1         1  ON     0
     uu_1                 9.297147e-02    1         1  ON     1
     uu_2                -7.920283e-03    1         1  ON     2
     uu_3                -6.923398e-02    1         1  ON     3
     uu_4                -1.052604e-01    1         1  ON     4
     uu_5                -1.267169e-01    1         1  ON     5
     uu_6                -1.374582e-01    1         1  ON     6
     uu_7                -1.336277e-01    1         1  ON     7
     uu_8                -1.132616e-01    1         1  ON     8
     uu_9                -6.856224e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.731544e-01    1         1  ON     0
     ud_1                 1.324656e-01    1         1  ON     1
     ud_2                 1.338636e-02    1         1  ON     2
     ud_3                -4.969112e-02    1         1  ON     3
     ud_4                -8.583432e-02    1         1  ON     4
     ud_5                -1.074506e-01    1         1  ON     5
     ud_6                -1.175900e-01    1         1  ON     6
     ud_7                -1.128472e-01    1         1  ON     7
     ud_8                -9.300090e-02    1         1  ON     8
     ud_9                -5.426882e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -4.979348e-01    1         1  ON     0
     eC_1                -3.532771e-01    1         1  ON     1
     eC_2                -1.036266e-01    1         1  ON     2
     eC_3                 6.840188e-02    1         1  ON     3
     eC_4                 1.507106e-01    1         1  ON     4
     eC_5                 2.326891e-01    1         1  ON     5
     eC_6                 2.311927e-01    1         1  ON     6
     eC_7                 1.913392e-01    1         1  ON     7
     eC_8                 7.350101e-02    1         1  ON     8
     eC_9                 5.800106e-03    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -8.991038e-01    1         1  ON     0
     eO_1                -5.913999e-01    1         1  ON     1
     eO_2                -1.810805e-01    1         1  ON     2
     eO_3                 8.172786e-02    1         1  ON     3
     eO_4                 2.361583e-01    1         1  ON     4
     eO_5                 3.379148e-01    1         1  ON     5
     eO_6                 3.342742e-01    1         1  ON     6
     eO_7                 2.985276e-01    1         1  ON     7
     eO_8                 2.076720e-01    1         1  ON     8
     eO_9                 1.093498e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.333662e-01    1         1  ON     0
     eH1_1                -3.149677e-02    1         1  ON     1
     eH1_2                -1.524321e-02    1         1  ON     2
     eH1_3                -2.543347e-02    1         1  ON     3
     eH1_4                 3.820769e-03    1         1  ON     4
     eH1_5                 1.895374e-02    1         1  ON     5
     eH1_6                 3.983370e-02    1         1  ON     6
     eH1_7                 4.319402e-02    1         1  ON     7
     eH1_8                 3.913136e-02    1         1  ON     8
     eH1_9                 4.724031e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.451078e-01    1         1  ON     0
     eH2_1                -4.404086e-02    1         1  ON     1
     eH2_2                -2.577917e-02    1         1  ON     2
     eH2_3                -3.487602e-02    1         1  ON     3
     eH2_4                -6.873053e-03    1         1  ON     4
     eH2_5                 8.664227e-03    1         1  ON     5
     eH2_6                 3.559350e-02    1         1  ON     6
     eH2_7                 4.803406e-02    1         1  ON     7
     eH2_8                 6.894748e-02    1         1  ON     8
     eH2_9                 6.265784e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 140 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.008174e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 28 unique up determinants.
Found 28 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.6619e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  4.0107225728e-02 -5.0659535091e-01 -4.8356690577e-01
    u -2.0203417087e-01 -1.2691590666e+00 -2.1169263951e+00
    u  2.9913287695e-01 -2.3710879234e-01  2.0101719070e+00
    u  4.8474243406e-02 -5.3051852953e-01  9.5378285444e-01
    u -5.5511775119e-01 -9.8683271286e-02  1.4043240644e+00
    u  6.9646297924e-01  2.5004217823e+00 -2.4744046405e+00
    d -1.1004432466e+00 -7.1118992563e-01 -1.4300801983e+00
    d -3.6824818327e-02  7.5687344105e-01 -1.6708867165e+00
    d -9.4375526199e-01  1.5348935511e-01  1.1974289766e+00
    d -8.9321447322e-02 -6.9596903295e-02  1.4810785623e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.4859
    reference variance = 0.498416
====================================================
  Execution time = 4.6259e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9773e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5512e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497800246008
                                         uncertainty =       0.003887334547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497800246008
                                         uncertainty =       0.003887334547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498866331
  error estimate for blocks of size 2^( 2) =       0.000525378376
  error estimate for blocks of size 2^( 3) =       0.000550215903
  error estimate for blocks of size 2^( 4) =       0.000568530109
  error estimate for blocks of size 2^( 5) =       0.000580724665
  error estimate for blocks of size 2^( 6) =       0.000586966580
  error estimate for blocks of size 2^( 7) =       0.000591236071

      target function =      -0.708616834668
              le_mean =     -22.426247965967
             les_mean =     503.434332815270
             stat err =       0.000581864356
             autocorr =       1.360426614882
   target nu stat err =       0.000581864356
   target dn stat err =       0.004096778292
      target stat err =       0.003020357318
              std dev =       0.705503531584
             le_variance =       0.497735233078


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.242624796597e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708628709453       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708637450464       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708640533264       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708645472472       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708647414812       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708649445664       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708651473002       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708653926397       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708656730998       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708657371517       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.708657345866       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.708659097055       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.708660177089       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.708661222210       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.708661694092       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.708662299871       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.708663376699       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.708665334659       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.708667306666       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.708667701051       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.708667958803       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.708668693843       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.708668717061       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.708668895893       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.708669074539       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.708668956993       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.708669058471       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.708669051020       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.708669104086       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.708669031061       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.708669043655       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.708669022555       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.708669048397       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 2.769071e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708628709453       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708631223151       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708632098875       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708633511647       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708634162200       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708634694312       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708635275794       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708635939748       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708636752933       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708636831853       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.708636945686       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.708637390481       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.708637637226       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.708637858309       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.708638057678       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.708638218877       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.708638508192       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.708639026501       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.708639493131       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.708639563218       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.708639616294       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.708639782529       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.708639782086       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.708639823133       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.708639852602       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.708639824667       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.708639846515       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.708639840927       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.708639853584       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.708639838383       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.708639840911       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.708639834735       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 7.346138e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708628709453       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708629362412       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708629589078       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708629955048       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708630131726       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708630265011       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708630421210       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708630589577       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708630795980       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708630810346       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.708630842197       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.708630939451       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.708630991384       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.708631050883       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.708631129511       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.708631168767       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.708631242604       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.708631373910       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.708631488174       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.708631503689       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.708631516258       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.708631556546       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.708631556073       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.708631566056       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.708631572492       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.708631565608       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.708631570834       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.708631569294       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.708631572368       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.708631568749       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.708631569367       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.708631567796       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 1.866631e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165082 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1942e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
uu_0  2.555530e-01                 1 1 ON  0
uu_1  9.313213e-02                 1 1 ON  1
uu_2  -7.816272e-03                1 1 ON  2
uu_3  -6.917034e-02                1 1 ON  3
uu_4  -1.052443e-01                1 1 ON  4
uu_5  -1.267550e-01                1 1 ON  5
uu_6  -1.374760e-01                1 1 ON  6
uu_7  -1.337585e-01                1 1 ON  7
uu_8  -1.133798e-01                1 1 ON  8
uu_9  -6.878309e-02                1 1 ON  9
ud_0  3.732670e-01                 1 1 ON  10
ud_1  1.325623e-01                 1 1 ON  11
ud_2  1.342360e-02                 1 1 ON  12
ud_3  -4.972674e-02                1 1 ON  13
ud_4  -8.587035e-02                1 1 ON  14
ud_5  -1.074365e-01                1 1 ON  15
ud_6  -1.175741e-01                1 1 ON  16
ud_7  -1.128843e-01                1 1 ON  17
ud_8  -9.301298e-02                1 1 ON  18
ud_9  -5.443683e-02                1 1 ON  19
eC_0  -4.984301e-01                1 1 ON  20
eC_1  -3.535511e-01                1 1 ON  21
eC_2  -1.036793e-01                1 1 ON  22
eC_3  6.851747e-02                 1 1 ON  23
eC_4  1.507349e-01                 1 1 ON  24
eC_5  2.326805e-01                 1 1 ON  25
eC_6  2.313474e-01                 1 1 ON  26
eC_7  1.917156e-01                 1 1 ON  27
eC_8  7.364867e-02                 1 1 ON  28
eC_9  5.824693e-03                 1 1 ON  29
eO_0  -8.998384e-01                1 1 ON  30
eO_1  -5.919427e-01                1 1 ON  31
eO_2  -1.814984e-01                1 1 ON  32
eO_3  8.165393e-02                 1 1 ON  33
eO_4  2.361360e-01                 1 1 ON  34
eO_5  3.378623e-01                 1 1 ON  35
eO_6  3.346194e-01                 1 1 ON  36
eO_7  2.990515e-01                 1 1 ON  37
eO_8  2.083516e-01                 1 1 ON  38
eO_9  1.096302e-01                 1 1 ON  39
eH1_0 -1.333618e-01                1 1 ON  40
eH1_1 -3.159783e-02                1 1 ON  41
eH1_2 -1.528226e-02                1 1 ON  42
eH1_3 -2.546047e-02                1 1 ON  43
eH1_4 3.741077e-03                 1 1 ON  44
eH1_5 1.884592e-02                 1 1 ON  45
eH1_6 3.992678e-02                 1 1 ON  46
eH1_7 4.317794e-02                 1 1 ON  47
eH1_8 3.919737e-02                 1 1 ON  48
eH1_9 4.740230e-02                 1 1 ON  49
eH2_0 -1.451261e-01                1 1 ON  50
eH2_1 -4.398471e-02                1 1 ON  51
eH2_2 -2.567446e-02                1 1 ON  52
eH2_3 -3.480799e-02                1 1 ON  53
eH2_4 -6.786106e-03                1 1 ON  54
eH2_5 8.738977e-03                 1 1 ON  55
eH2_6 3.562605e-02                 1 1 ON  56
eH2_7 4.784263e-02                 1 1 ON  57
eH2_8 6.858898e-02                 1 1 ON  58
eH2_9 6.272195e-02                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.4083
    reference variance = 0.235073
====================================================
  Execution time = 4.6819e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9910e-01
  Total weights = 2.0000e+06
  Execution time = 3.8328e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499062212725
                                         uncertainty =       0.003743688829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499062212725
                                         uncertainty =       0.003743688829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499507946
  error estimate for blocks of size 2^( 2) =       0.000525629277
  error estimate for blocks of size 2^( 3) =       0.000549830651
  error estimate for blocks of size 2^( 4) =       0.000568409538
  error estimate for blocks of size 2^( 5) =       0.000580541349
  error estimate for blocks of size 2^( 6) =       0.000587724058
  error estimate for blocks of size 2^( 7) =       0.000589323586

      target function =      -0.707689846921
              le_mean =     -22.426504743348
             les_mean =     503.447131129762
             stat err =       0.000581499633
             autocorr =       1.355233371752
   target nu stat err =       0.000581499633
   target dn stat err =       0.003669340569
      target stat err =       0.002712052245
              std dev =       0.706410911494
             le_variance =       0.499016375878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499356117509
                                         uncertainty =       0.003751588860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499356117509
                                         uncertainty =       0.003751588860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499654847
  error estimate for blocks of size 2^( 2) =       0.000525721879
  error estimate for blocks of size 2^( 3) =       0.000549872271
  error estimate for blocks of size 2^( 4) =       0.000568414880
  error estimate for blocks of size 2^( 5) =       0.000580526268
  error estimate for blocks of size 2^( 6) =       0.000587715829
  error estimate for blocks of size 2^( 7) =       0.000589310301

      target function =      -0.707478205870
              le_mean =     -22.426501686731
             les_mean =     503.447287587254
             stat err =       0.000581491819
             autocorr =       1.354400201069
   target nu stat err =       0.000581491819
   target dn stat err =       0.003676009921
      target stat err =       0.002715146855
              std dev =       0.706618660935
             le_variance =       0.499309931982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499226177107
                                         uncertainty =       0.003748077219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499226177107
                                         uncertainty =       0.003748077219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499589900
  error estimate for blocks of size 2^( 2) =       0.000525680553
  error estimate for blocks of size 2^( 3) =       0.000549853252
  error estimate for blocks of size 2^( 4) =       0.000568411870
  error estimate for blocks of size 2^( 5) =       0.000580532174
  error estimate for blocks of size 2^( 6) =       0.000587718600
  error estimate for blocks of size 2^( 7) =       0.000589315572

      target function =      -0.707571774501
              le_mean =     -22.426502610297
             les_mean =     503.447199216549
             stat err =       0.000581494554
             autocorr =       1.354765111602
   target nu stat err =       0.000581494554
   target dn stat err =       0.003673045682
      target stat err =       0.002713766455
              std dev =       0.706526812298
             le_variance =       0.499180136496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499083110020
                                         uncertainty =       0.003744253028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499083110020
                                         uncertainty =       0.003744253028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499518391
  error estimate for blocks of size 2^( 2) =       0.000525635744
  error estimate for blocks of size 2^( 3) =       0.000549833406
  error estimate for blocks of size 2^( 4) =       0.000568409672
  error estimate for blocks of size 2^( 5) =       0.000580539991
  error estimate for blocks of size 2^( 6) =       0.000587723172
  error estimate for blocks of size 2^( 7) =       0.000589322376

      target function =      -0.707674797912
              le_mean =     -22.426504406416
             les_mean =     503.447136888063
             stat err =       0.000581498803
             autocorr =       1.355172825081
   target nu stat err =       0.000581498803
   target dn stat err =       0.003669816876
      target stat err =       0.002712273385
              std dev =       0.706425683682
             le_variance =       0.499037246565


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707689846921        initial  <--
     2.5000e-01     2.5000e+00             2.7691e-03        -0.707478205870
     1.0000e+00     1.0000e+01             7.3461e-04        -0.707571774501
     4.0000e+00     4.0000e+01             1.8666e-04        -0.707674797912

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.9883
  </log>
  <optVariables href="FORM.s000.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2794e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2447e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.3567
    reference variance = 0.415185
====================================================
  Execution time = 4.5326e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9694e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5093e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497011494781
                                         uncertainty =       0.003371591665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497011494781
                                         uncertainty =       0.003371591665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498468394
  error estimate for blocks of size 2^( 2) =       0.000524851262
  error estimate for blocks of size 2^( 3) =       0.000549359879
  error estimate for blocks of size 2^( 4) =       0.000568497984
  error estimate for blocks of size 2^( 5) =       0.000580500165
  error estimate for blocks of size 2^( 6) =       0.000587137936
  error estimate for blocks of size 2^( 7) =       0.000590159095

      target function =      -0.709190145080
              le_mean =     -22.426572245620
             les_mean =     503.448083918986
             stat err =       0.000581573795
             autocorr =       1.361239070315
   target nu stat err =       0.000581573795
   target dn stat err =       0.003365220235
      target stat err =       0.002509029105
              std dev =       0.704940763064
             le_variance =       0.496941479430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242657224562e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709198022624       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709198927083       residual = 4.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709199654053       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709199868935       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709200027676       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709200106745       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709200407719       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709200427340       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709200521405       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709200639886       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709200718927       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.709200841774       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.709200948860       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.709201033614       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.709201063043       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.709201276043       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.709201346525       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.709201382252       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.709201445043       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.709201520444       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.709201525785       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.709201548981       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.709201590510       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.709201581410       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.709201594578       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.709201602875       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.709201611447       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.709201607955       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.709201610651       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.709201612288       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.709201609535       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 2.972836e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709198022624       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709198252023       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709198435976       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709198490825       residual = 8.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709198530376       residual = 8.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709198551710       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709198628963       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709198631504       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709198657190       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709198685190       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709198705618       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.709198736488       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.709198762807       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.709198785061       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.709198792304       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.709198845960       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.709198863229       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.709198872268       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.709198887667       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.709198906203       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.709198907453       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.709198913198       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.709198923448       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.709198921125       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.709198924354       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.709198926413       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.709198928450       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.709198927615       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.709198928301       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.709198928703       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.709198927990       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 7.429936e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709198022624       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709198080183       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709198126311       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709198140096       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709198149972       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709198155409       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709198174819       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709198175333       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709198182005       residual = 7.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709198188787       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709198193941       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.709198201670       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.709198208224       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.709198213849       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.709198215653       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.709198229092       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.709198233387       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.709198235654       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.709198239484       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.709198244098       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.709198244405       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.709198245838       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.709198248393       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.709198247809       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.709198248612       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.709198249126       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.709198249628       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.709198249422       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.709198249594       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.709198249694       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.709198249515       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+01 is 1.857349e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199196 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0458e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.552755e-01 1 1  ON 0
 uu_1                 9.298624e-02 1 1  ON 1
 uu_2                -7.908868e-03 1 1  ON 2
 uu_3                -6.922592e-02 1 1  ON 3
 uu_4                -1.052572e-01 1 1  ON 4
 uu_5                -1.267197e-01 1 1  ON 5
 uu_6                -1.374604e-01 1 1  ON 6
 uu_7                -1.336420e-01 1 1  ON 7
 uu_8                -1.132757e-01 1 1  ON 8
 uu_9                -6.857891e-02 1 1  ON 9
 ud_0                 3.731532e-01 1 1  ON 10
 ud_1                 1.324608e-01 1 1  ON 11
 ud_2                 1.337848e-02 1 1  ON 12
 ud_3                -4.970256e-02 1 1  ON 13
 ud_4                -8.584544e-02 1 1  ON 14
 ud_5                -1.074598e-01 1 1  ON 15
 ud_6                -1.175937e-01 1 1  ON 16
 ud_7                -1.128486e-01 1 1  ON 17
 ud_8                -9.299284e-02 1 1  ON 18
 ud_9                -5.425149e-02 1 1  ON 19
 eC_0                -4.979755e-01 1 1  ON 20
 eC_1                -3.532998e-01 1 1  ON 21
 eC_2                -1.036421e-01 1 1  ON 22
 eC_3                 6.839136e-02 1 1  ON 23
 eC_4                 1.506961e-01 1 1  ON 24
 eC_5                 2.326749e-01 1 1  ON 25
 eC_6                 2.312111e-01 1 1  ON 26
 eC_7                 1.914135e-01 1 1  ON 27
 eC_8                 7.352633e-02 1 1  ON 28
 eC_9                 5.801273e-03 1 1  ON 29
 eO_0                -8.991505e-01 1 1  ON 30
 eO_1                -5.914346e-01 1 1  ON 31
 eO_2                -1.811111e-01 1 1  ON 32
 eO_3                 8.170987e-02 1 1  ON 33
 eO_4                 2.361619e-01 1 1  ON 34
 eO_5                 3.379167e-01 1 1  ON 35
 eO_6                 3.342977e-01 1 1  ON 36
 eO_7                 2.985553e-01 1 1  ON 37
 eO_8                 2.077050e-01 1 1  ON 38
 eO_9                 1.093793e-01 1 1  ON 39
eH1_0                -1.333849e-01 1 1  ON 40
eH1_1                -3.151207e-02 1 1  ON 41
eH1_2                -1.525468e-02 1 1  ON 42
eH1_3                -2.543932e-02 1 1  ON 43
eH1_4                 3.816910e-03 1 1  ON 44
eH1_5                 1.894831e-02 1 1  ON 45
eH1_6                 3.983828e-02 1 1  ON 46
eH1_7                 4.319930e-02 1 1  ON 47
eH1_8                 3.916414e-02 1 1  ON 48
eH1_9                 4.725461e-02 1 1  ON 49
eH2_0                -1.451262e-01 1 1  ON 50
eH2_1                -4.405121e-02 1 1  ON 51
eH2_2                -2.579045e-02 1 1  ON 52
eH2_3                -3.488951e-02 1 1  ON 53
eH2_4                -6.872565e-03 1 1  ON 54
eH2_5                 8.672690e-03 1 1  ON 55
eH2_6                 3.559354e-02 1 1  ON 56
eH2_7                 4.802063e-02 1 1  ON 57
eH2_8                 6.894654e-02 1 1  ON 58
eH2_9                 6.270751e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.4385
    reference variance = 0.371017
====================================================
  Execution time = 4.4883e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0085e-01
  Total weights = 2.0000e+06
  Execution time = 3.8281e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500906029428
                                         uncertainty =       0.004097141571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500906029428
                                         uncertainty =       0.004097141571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500420384
  error estimate for blocks of size 2^( 2) =       0.000526881064
  error estimate for blocks of size 2^( 3) =       0.000552123272
  error estimate for blocks of size 2^( 4) =       0.000571645836
  error estimate for blocks of size 2^( 5) =       0.000582763675
  error estimate for blocks of size 2^( 6) =       0.000591185989
  error estimate for blocks of size 2^( 7) =       0.000595463479

      target function =      -0.706386226208
              le_mean =     -22.425801087844
             les_mean =     503.417395303320
             stat err =       0.000585264745
             autocorr =       1.367838247298
   target nu stat err =       0.000585264745
   target dn stat err =       0.004250968912
      target stat err =       0.003109065227
              std dev =       0.707701294475
             le_variance =       0.500841122201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500926029153
                                         uncertainty =       0.004097839720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500926029153
                                         uncertainty =       0.004097839720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500430363
  error estimate for blocks of size 2^( 2) =       0.000526887344
  error estimate for blocks of size 2^( 3) =       0.000552125603
  error estimate for blocks of size 2^( 4) =       0.000571644503
  error estimate for blocks of size 2^( 5) =       0.000582759900
  error estimate for blocks of size 2^( 6) =       0.000591180207
  error estimate for blocks of size 2^( 7) =       0.000595455552

      target function =      -0.706371879839
              le_mean =     -22.425801334690
             les_mean =     503.417426348262
             stat err =       0.000585260041
             autocorr =       1.367761713097
   target nu stat err =       0.000585260041
   target dn stat err =       0.004251640404
      target stat err =       0.003109414582
              std dev =       0.707715405885
             le_variance =       0.500861095727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500916121520
                                         uncertainty =       0.004097497022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500916121520
                                         uncertainty =       0.004097497022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500425420
  error estimate for blocks of size 2^( 2) =       0.000526884227
  error estimate for blocks of size 2^( 3) =       0.000552124438
  error estimate for blocks of size 2^( 4) =       0.000571645153
  error estimate for blocks of size 2^( 5) =       0.000582761763
  error estimate for blocks of size 2^( 6) =       0.000591183068
  error estimate for blocks of size 2^( 7) =       0.000595459477

      target function =      -0.706378986869
              le_mean =     -22.425801208938
             les_mean =     503.417410813425
             stat err =       0.000585262365
             autocorr =       1.367799599128
   target nu stat err =       0.000585262365
   target dn stat err =       0.004251310478
      target stat err =       0.003109243422
              std dev =       0.707708415261
             le_variance =       0.500851201031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500907292582
                                         uncertainty =       0.004097186204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500907292582
                                         uncertainty =       0.004097186204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500421015
  error estimate for blocks of size 2^( 2) =       0.000526881459
  error estimate for blocks of size 2^( 3) =       0.000552123417
  error estimate for blocks of size 2^( 4) =       0.000571645749
  error estimate for blocks of size 2^( 5) =       0.000582763434
  error estimate for blocks of size 2^( 6) =       0.000591185622
  error estimate for blocks of size 2^( 7) =       0.000595462976

      target function =      -0.706385320115
              le_mean =     -22.425801102523
             les_mean =     503.417397223209
             stat err =       0.000585264445
             autocorr =       1.367833402742
   target nu stat err =       0.000585264445
   target dn stat err =       0.004251011791
      target stat err =       0.003109087619
              std dev =       0.707702185733
             le_variance =       0.500842383692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706386226208        initial  <--
     2.5000e+00     2.5000e+01             2.9728e-04        -0.706371879839
     1.0000e+01     1.0000e+02             7.4299e-05        -0.706378986869
     4.0000e+01     4.0000e+02             1.8573e-05        -0.706385320115

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0477
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2451e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2422e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.4199
    reference variance = 0.407476
====================================================
  Execution time = 4.5538e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0225e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5824e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502203816414
                                         uncertainty =       0.007303276440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502203816414
                                         uncertainty =       0.007303276440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501124641
  error estimate for blocks of size 2^( 2) =       0.000527167961
  error estimate for blocks of size 2^( 3) =       0.000552747404
  error estimate for blocks of size 2^( 4) =       0.000572299786
  error estimate for blocks of size 2^( 5) =       0.000582977680
  error estimate for blocks of size 2^( 6) =       0.000590250958
  error estimate for blocks of size 2^( 7) =       0.000591599739

      target function =      -0.705329638281
              le_mean =     -22.426515365311
             les_mean =     503.450842990536
             stat err =       0.000584282041
             autocorr =       1.359419699231
   target nu stat err =       0.000584282041
   target dn stat err =       0.007833919822
      target stat err =       0.005644231621
              std dev =       0.708697263373
             le_variance =       0.502251811112


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242651536531e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705373220276       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705373307212       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705373430576       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705373519605       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705373541833       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705373553588       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705373568368       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705373574572       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705373587873       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705373592748       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.705373612650       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.705373618822       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.705373629147       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.705373641880       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.705373651601       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.705373663017       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.705373673888       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.705373683551       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.705373689203       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.705373691630       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.705373693310       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.705373695805       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.705373697098       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.705373698648       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.705373700846       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.705373701790       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.705373701655       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.705373702357       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.705373701958       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.705373701622       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.705373701657       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.705373701990       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 2.387551e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705373220276       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705373242043       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705373272928       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705373295224       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705373300785       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705373303731       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705373307432       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705373308983       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705373312312       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705373313530       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.705373318509       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.705373320042       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.705373322634       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.705373325822       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.705373328253       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.705373331110       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.705373333829       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.705373336243       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.705373337654       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.705373338259       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.705373338678       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.705373339301       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.705373339624       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.705373340010       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.705373340559       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.705373340795       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.705373340760       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.705373340935       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.705373340835       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.705373340752       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.705373340760       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.705373340844       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+02 is 5.970222e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705373220276       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705373225720       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705373233444       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705373239020       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705373240411       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705373241147       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705373242074       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705373242461       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705373243293       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705373243599       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.705373244843       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.705373245226       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.705373245874       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.705373246672       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.705373247279       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.705373247994       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.705373248674       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.705373249277       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.705373249630       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.705373249781       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.705373249886       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.705373250041       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.705373250122       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.705373250218       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.705373250357       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.705373250413       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.705373250406       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.705373250450       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.705373250425       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.705373250404       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.705373250407       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.705373250421       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+02 is 1.492640e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.235172 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1403e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.552585e-01 1 1  ON 0
 uu_1                 9.297350e-02 1 1  ON 1
 uu_2                -7.918636e-03 1 1  ON 2
 uu_3                -6.923287e-02 1 1  ON 3
 uu_4                -1.052595e-01 1 1  ON 4
 uu_5                -1.267164e-01 1 1  ON 5
 uu_6                -1.374585e-01 1 1  ON 6
 uu_7                -1.336295e-01 1 1  ON 7
 uu_8                -1.132631e-01 1 1  ON 8
 uu_9                -6.856395e-02 1 1  ON 9
 ud_0                 3.731540e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338637e-02 1 1  ON 12
 ud_3                -4.969117e-02 1 1  ON 13
 ud_4                -8.583455e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175897e-01 1 1  ON 16
 ud_7                -1.128473e-01 1 1  ON 17
 ud_8                -9.300086e-02 1 1  ON 18
 ud_9                -5.426936e-02 1 1  ON 19
 eC_0                -4.979388e-01 1 1  ON 20
 eC_1                -3.532794e-01 1 1  ON 21
 eC_2                -1.036269e-01 1 1  ON 22
 eC_3                 6.840137e-02 1 1  ON 23
 eC_4                 1.507092e-01 1 1  ON 24
 eC_5                 2.326883e-01 1 1  ON 25
 eC_6                 2.311943e-01 1 1  ON 26
 eC_7                 1.913446e-01 1 1  ON 27
 eC_8                 7.350295e-02 1 1  ON 28
 eC_9                 5.800613e-03 1 1  ON 29
 eO_0                -8.991067e-01 1 1  ON 30
 eO_1                -5.914042e-01 1 1  ON 31
 eO_2                -1.810853e-01 1 1  ON 32
 eO_3                 8.172520e-02 1 1  ON 33
 eO_4                 2.361574e-01 1 1  ON 34
 eO_5                 3.379142e-01 1 1  ON 35
 eO_6                 3.342768e-01 1 1  ON 36
 eO_7                 2.985335e-01 1 1  ON 37
 eO_8                 2.076767e-01 1 1  ON 38
 eO_9                 1.093521e-01 1 1  ON 39
eH1_0                -1.333679e-01 1 1  ON 40
eH1_1                -3.149884e-02 1 1  ON 41
eH1_2                -1.524457e-02 1 1  ON 42
eH1_3                -2.543365e-02 1 1  ON 43
eH1_4                 3.818848e-03 1 1  ON 44
eH1_5                 1.895409e-02 1 1  ON 45
eH1_6                 3.983579e-02 1 1  ON 46
eH1_7                 4.319417e-02 1 1  ON 47
eH1_8                 3.913336e-02 1 1  ON 48
eH1_9                 4.724207e-02 1 1  ON 49
eH2_0                -1.451065e-01 1 1  ON 50
eH2_1                -4.404032e-02 1 1  ON 51
eH2_2                -2.577879e-02 1 1  ON 52
eH2_3                -3.487623e-02 1 1  ON 53
eH2_4                -6.874378e-03 1 1  ON 54
eH2_5                 8.664647e-03 1 1  ON 55
eH2_6                 3.559292e-02 1 1  ON 56
eH2_7                 4.803180e-02 1 1  ON 57
eH2_8                 6.894670e-02 1 1  ON 58
eH2_9                 6.265948e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.4726
    reference variance = 0.505782
====================================================
  Execution time = 4.6541e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0982e-01
  Total weights = 2.0000e+06
  Execution time = 3.8207e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509867850179
                                         uncertainty =       0.005732384917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509867850179
                                         uncertainty =       0.005732384917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504886237
  error estimate for blocks of size 2^( 2) =       0.000531159867
  error estimate for blocks of size 2^( 3) =       0.000556259482
  error estimate for blocks of size 2^( 4) =       0.000575420163
  error estimate for blocks of size 2^( 5) =       0.000586814470
  error estimate for blocks of size 2^( 6) =       0.000593430091
  error estimate for blocks of size 2^( 7) =       0.000595472063

      target function =      -0.699990994208
              le_mean =     -22.425643252478
             les_mean =     503.419295257994
             stat err =       0.000587784197
             autocorr =       1.355341528843
   target nu stat err =       0.000587784197
   target dn stat err =       0.005944551447
      target stat err =       0.004231206687
              std dev =       0.714016964422
             le_variance =       0.509820225483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509868736779
                                         uncertainty =       0.005732347354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509868736779
                                         uncertainty =       0.005732347354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504886677
  error estimate for blocks of size 2^( 2) =       0.000531160393
  error estimate for blocks of size 2^( 3) =       0.000556260057
  error estimate for blocks of size 2^( 4) =       0.000575420755
  error estimate for blocks of size 2^( 5) =       0.000586815154
  error estimate for blocks of size 2^( 6) =       0.000593430806
  error estimate for blocks of size 2^( 7) =       0.000595472894

      target function =      -0.699990368840
              le_mean =     -22.425643240287
             les_mean =     503.419295599529
             stat err =       0.000587784902
             autocorr =       1.355342421441
   target nu stat err =       0.000587784902
   target dn stat err =       0.005944509528
      target stat err =       0.004231169970
              std dev =       0.714017586497
             le_variance =       0.509821113827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509868293699
                                         uncertainty =       0.005732366105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509868293699
                                         uncertainty =       0.005732366105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504886457
  error estimate for blocks of size 2^( 2) =       0.000531160130
  error estimate for blocks of size 2^( 3) =       0.000556259769
  error estimate for blocks of size 2^( 4) =       0.000575420460
  error estimate for blocks of size 2^( 5) =       0.000586814812
  error estimate for blocks of size 2^( 6) =       0.000593430449
  error estimate for blocks of size 2^( 7) =       0.000595472479

      target function =      -0.699990681370
              le_mean =     -22.425643246312
             les_mean =     503.419295425822
             stat err =       0.000587784550
             autocorr =       1.355341976249
   target nu stat err =       0.000587784550
   target dn stat err =       0.005944530455
      target stat err =       0.004231188304
              std dev =       0.714017275614
             le_variance =       0.509820669876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509867905606
                                         uncertainty =       0.005732382565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509867905606
                                         uncertainty =       0.005732382565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504886265
  error estimate for blocks of size 2^( 2) =       0.000531159900
  error estimate for blocks of size 2^( 3) =       0.000556259518
  error estimate for blocks of size 2^( 4) =       0.000575420200
  error estimate for blocks of size 2^( 5) =       0.000586814513
  error estimate for blocks of size 2^( 6) =       0.000593430136
  error estimate for blocks of size 2^( 7) =       0.000595472115

      target function =      -0.699990955113
              le_mean =     -22.425643251700
             les_mean =     503.419295278637
             stat err =       0.000587784241
             autocorr =       1.355341584790
   target nu stat err =       0.000587784241
   target dn stat err =       0.005944548822
      target stat err =       0.004231204389
              std dev =       0.714017003312
             le_variance =       0.509820281019


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.699990994208        initial  <--
     2.5000e+01     2.5000e+02             2.3876e-05        -0.699990368840
     1.0000e+02     1.0000e+03             5.9702e-06        -0.699990681370
     4.0000e+02     4.0000e+03             1.4926e-06        -0.699990955113

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.7113
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2712e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2430e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.4728
    reference variance = 0.320288
====================================================
  Execution time = 4.7070e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9940e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5183e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499438311852
                                         uncertainty =       0.002724246191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499438311852
                                         uncertainty =       0.002724246191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499700638
  error estimate for blocks of size 2^( 2) =       0.000525779942
  error estimate for blocks of size 2^( 3) =       0.000550361020
  error estimate for blocks of size 2^( 4) =       0.000569498039
  error estimate for blocks of size 2^( 5) =       0.000581742175
  error estimate for blocks of size 2^( 6) =       0.000590812223
  error estimate for blocks of size 2^( 7) =       0.000594696761

      target function =      -0.707414492020
              le_mean =     -22.426512318367
             les_mean =     503.447855971285
             stat err =       0.000584187300
             autocorr =       1.366735309708
   target nu stat err =       0.000584187300
   target dn stat err =       0.003208248345
      target stat err =       0.002387530821
              std dev =       0.706683419303
             le_variance =       0.499401455118


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242651231837e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707421588417       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707421603183       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707421609651       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707421614859       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707421618080       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707421620624       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707421620825       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707421622655       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707421624431       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707421625995       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707421625967       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.707421627109       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.707421628989       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.707421629784       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.707421631589       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.707421632918       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.707421633824       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.707421634015       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.707421634764       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.707421635190       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.707421635510       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.707421635862       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.707421636035       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.707421636014       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.707421636377       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.707421636398       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.707421636264       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.707421636300       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.707421636339       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.707421636370       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.707421636344       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.707421636348       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+02 is 2.245799e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707421588417       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707421592109       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707421593726       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707421595029       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707421595834       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707421596470       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707421596521       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707421596977       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707421597422       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707421597812       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707421597805       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.707421598092       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.707421598561       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.707421598761       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.707421599209       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.707421599548       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.707421599769       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.707421599818       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.707421600004       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.707421600112       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.707421600193       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.707421600281       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.707421600324       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.707421600317       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.707421600410       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.707421600412       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.707421600379       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.707421600388       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.707421600399       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.707421600406       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.707421600396       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.707421600403       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+03 is 5.614761e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707421588417       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707421589340       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707421589744       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707421590070       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707421590277       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707421590424       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707421590443       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707421590557       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707421590674       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707421590772       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707421590764       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.707421590835       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.707421590952       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.707421591007       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.707421591111       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.707421591193       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.707421591260       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.707421591262       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.707421591312       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.707421591340       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.707421591358       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.707421591385       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.707421591387       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.707421591388       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.707421591411       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.707421591414       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.707421591397       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.707421591399       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.707421591420       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.707421591411       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.707421591402       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.707421591387       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+03 is 1.403707e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271137 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2295e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.552565e-01 1 1  ON 0
 uu_1                 9.297161e-02 1 1  ON 1
 uu_2                -7.920207e-03 1 1  ON 2
 uu_3                -6.923393e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336278e-01 1 1  ON 7
 uu_8                -1.132618e-01 1 1  ON 8
 uu_9                -6.856237e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324657e-01 1 1  ON 11
 ud_2                 1.338630e-02 1 1  ON 12
 ud_3                -4.969124e-02 1 1  ON 13
 ud_4                -8.583447e-02 1 1  ON 14
 ud_5                -1.074507e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300091e-02 1 1  ON 18
 ud_9                -5.426874e-02 1 1  ON 19
 eC_0                -4.979353e-01 1 1  ON 20
 eC_1                -3.532774e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840191e-02 1 1  ON 23
 eC_4                 1.507105e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311928e-01 1 1  ON 26
 eC_7                 1.913396e-01 1 1  ON 27
 eC_8                 7.350131e-02 1 1  ON 28
 eC_9                 5.800115e-03 1 1  ON 29
 eO_0                -8.991044e-01 1 1  ON 30
 eO_1                -5.914004e-01 1 1  ON 31
 eO_2                -1.810809e-01 1 1  ON 32
 eO_3                 8.172781e-02 1 1  ON 33
 eO_4                 2.361582e-01 1 1  ON 34
 eO_5                 3.379147e-01 1 1  ON 35
 eO_6                 3.342745e-01 1 1  ON 36
 eO_7                 2.985279e-01 1 1  ON 37
 eO_8                 2.076725e-01 1 1  ON 38
 eO_9                 1.093501e-01 1 1  ON 39
eH1_0                -1.333664e-01 1 1  ON 40
eH1_1                -3.149703e-02 1 1  ON 41
eH1_2                -1.524337e-02 1 1  ON 42
eH1_3                -2.543348e-02 1 1  ON 43
eH1_4                 3.820677e-03 1 1  ON 44
eH1_5                 1.895379e-02 1 1  ON 45
eH1_6                 3.983395e-02 1 1  ON 46
eH1_7                 4.319422e-02 1 1  ON 47
eH1_8                 3.913149e-02 1 1  ON 48
eH1_9                 4.724037e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404087e-02 1 1  ON 51
eH2_2                -2.577910e-02 1 1  ON 52
eH2_3                -3.487598e-02 1 1  ON 53
eH2_4                -6.873083e-03 1 1  ON 54
eH2_5                 8.664381e-03 1 1  ON 55
eH2_6                 3.559347e-02 1 1  ON 56
eH2_7                 4.803388e-02 1 1  ON 57
eH2_8                 6.894720e-02 1 1  ON 58
eH2_9                 6.265803e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.4644
    reference variance = 0.495385
====================================================
  Execution time = 4.4441e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9886e-01
  Total weights = 2.0000e+06
  Execution time = 3.8293e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498695814471
                                         uncertainty =       0.002955280316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498695814471
                                         uncertainty =       0.002955280316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499428222
  error estimate for blocks of size 2^( 2) =       0.000525332687
  error estimate for blocks of size 2^( 3) =       0.000550400395
  error estimate for blocks of size 2^( 4) =       0.000569729003
  error estimate for blocks of size 2^( 5) =       0.000581473854
  error estimate for blocks of size 2^( 6) =       0.000586673082
  error estimate for blocks of size 2^( 7) =       0.000589041553

      target function =      -0.707798337433
              le_mean =     -22.426999435127
             les_mean =     503.469160511635
             stat err =       0.000581729373
             autocorr =       1.356737489447
   target nu stat err =       0.000581729373
   target dn stat err =       0.003223003657
      target stat err =       0.002401417851
              std dev =       0.706298164986
             le_variance =       0.498857097863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498695984716
                                         uncertainty =       0.002955280633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498695984716
                                         uncertainty =       0.002955280633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499428307
  error estimate for blocks of size 2^( 2) =       0.000525332714
  error estimate for blocks of size 2^( 3) =       0.000550400361
  error estimate for blocks of size 2^( 4) =       0.000569728916
  error estimate for blocks of size 2^( 5) =       0.000581473740
  error estimate for blocks of size 2^( 6) =       0.000586672938
  error estimate for blocks of size 2^( 7) =       0.000589041407

      target function =      -0.707798214335
              le_mean =     -22.426999435452
             les_mean =     503.469160696672
             stat err =       0.000581729250
             autocorr =       1.356736454287
   target nu stat err =       0.000581729250
   target dn stat err =       0.003223004669
      target stat err =       0.002401417719
              std dev =       0.706298285678
             le_variance =       0.498857268352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498695899600
                                         uncertainty =       0.002955280474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498695899600
                                         uncertainty =       0.002955280474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499428265
  error estimate for blocks of size 2^( 2) =       0.000525332700
  error estimate for blocks of size 2^( 3) =       0.000550400378
  error estimate for blocks of size 2^( 4) =       0.000569728960
  error estimate for blocks of size 2^( 5) =       0.000581473797
  error estimate for blocks of size 2^( 6) =       0.000586673010
  error estimate for blocks of size 2^( 7) =       0.000589041480

      target function =      -0.707798275880
              le_mean =     -22.426999435289
             les_mean =     503.469160604129
             stat err =       0.000581729312
             autocorr =       1.356736971806
   target nu stat err =       0.000581729312
   target dn stat err =       0.003223004163
      target stat err =       0.002401417785
              std dev =       0.706298225337
             le_variance =       0.498857183114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498695825112
                                         uncertainty =       0.002955280335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498695825112
                                         uncertainty =       0.002955280335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499428227
  error estimate for blocks of size 2^( 2) =       0.000525332689
  error estimate for blocks of size 2^( 3) =       0.000550400393
  error estimate for blocks of size 2^( 4) =       0.000569728997
  error estimate for blocks of size 2^( 5) =       0.000581473847
  error estimate for blocks of size 2^( 6) =       0.000586673073
  error estimate for blocks of size 2^( 7) =       0.000589041544

      target function =      -0.707798329739
              le_mean =     -22.426999435147
             les_mean =     503.469160523193
             stat err =       0.000581729365
             autocorr =       1.356737424740
   target nu stat err =       0.000581729365
   target dn stat err =       0.003223003720
      target stat err =       0.002401417843
              std dev =       0.706298172530
             le_variance =       0.498857108519


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707798337433        initial  <--
     2.5000e+02     2.5000e+03             2.2458e-06        -0.707798214335
     1.0000e+03     1.0000e+04             5.6148e-07        -0.707798275880
     4.0000e+03     4.0000e+04             1.4037e-07        -0.707798329739

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.6252
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2593e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2440e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.4823
    reference variance = 0.49084
====================================================
  Execution time = 4.5636e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0215e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5400e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502090045791
                                         uncertainty =       0.004309876931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502090045791
                                         uncertainty =       0.004309876931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501074620
  error estimate for blocks of size 2^( 2) =       0.000527079288
  error estimate for blocks of size 2^( 3) =       0.000551791728
  error estimate for blocks of size 2^( 4) =       0.000570321154
  error estimate for blocks of size 2^( 5) =       0.000581587227
  error estimate for blocks of size 2^( 6) =       0.000587435952
  error estimate for blocks of size 2^( 7) =       0.000587839153

      target function =      -0.705421288046
              le_mean =     -22.426917560574
             les_mean =     503.468782568109
             stat err =       0.000581795872
             autocorr =       1.348144543483
   target nu stat err =       0.000581795872
   target dn stat err =       0.004678051087
      target stat err =       0.003406198003
              std dev =       0.708626523909
             le_variance =       0.502151550387


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242691756057e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705436652470       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705436654787       residual = 6.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705436655381       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705436656126       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705436656590       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705436656868       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705436657090       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705436657228       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705436657464       residual = 9.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705436657600       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.705436657875       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.705436657900       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.705436657940       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.705436658164       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.705436658206       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.705436658199       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.705436658305       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.705436658408       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.705436658462       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.705436658485       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.705436658504       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.705436658516       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.705436658552       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.705436658607       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.705436658624       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.705436658622       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.705436658633       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.705436658629       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.705436658635       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.705436658640       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.705436658636       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+03 is 2.800676e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705436652470       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705436653050       residual = 6.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705436653198       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705436653384       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705436653500       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705436653577       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705436653619       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705436653654       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705436653706       residual = 9.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705436653744       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.705436653815       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.705436653838       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.705436653846       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.705436653891       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.705436653910       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.705436653905       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.705436653933       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.705436653957       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.705436653977       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.705436653956       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.705436653952       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.705436653961       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.705436653961       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.705436653994       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.705436653966       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.705436654003       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.705436654025       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.705436654022       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.705436654023       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.705436653992       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.705436653982       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+04 is 7.001711e-08

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705436652470       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705436652615       residual = 6.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705436652652       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705436652699       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705436652646       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705436652729       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705436652804       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705436652760       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705436652847       residual = 9.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705436652771       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.705436652835       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.705436652711       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.705436652783       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.705436652796       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.705436652857       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.705436652868       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.705436652808       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.705436652777       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.705436652770       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.705436652866       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.705436653011       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.705436652990       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.705436652769       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.705436652909       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.705436652823       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.705436652837       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.705436652825       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.705436652893       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.705436652838       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.705436652877       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.705436652932       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+04 is 1.750429e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.303278 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1073e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297148e-02 1 1  ON 1
 uu_2                -7.920278e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856225e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338635e-02 1 1  ON 12
 ud_3                -4.969113e-02 1 1  ON 13
 ud_4                -8.583433e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175899e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300089e-02 1 1  ON 18
 ud_9                -5.426881e-02 1 1  ON 19
 eC_0                -4.979349e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840187e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913393e-01 1 1  ON 27
 eC_8                 7.350104e-02 1 1  ON 28
 eC_9                 5.800107e-03 1 1  ON 29
 eO_0                -8.991039e-01 1 1  ON 30
 eO_1                -5.914000e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172784e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076721e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820781e-03 1 1  ON 44
eH1_5                 1.895375e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319399e-02 1 1  ON 47
eH1_8                 3.913134e-02 1 1  ON 48
eH1_9                 4.724033e-02 1 1  ON 49
eH2_0                -1.451079e-01 1 1  ON 50
eH2_1                -4.404088e-02 1 1  ON 51
eH2_2                -2.577918e-02 1 1  ON 52
eH2_3                -3.487601e-02 1 1  ON 53
eH2_4                -6.873035e-03 1 1  ON 54
eH2_5                 8.664259e-03 1 1  ON 55
eH2_6                 3.559351e-02 1 1  ON 56
eH2_7                 4.803403e-02 1 1  ON 57
eH2_8                 6.894746e-02 1 1  ON 58
eH2_9                 6.265785e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.3153
    reference variance = 0.333624
====================================================
  Execution time = 4.4849e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9815e-01
  Total weights = 2.0000e+06
  Execution time = 3.8269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498093503608
                                         uncertainty =       0.003578653233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498093503608
                                         uncertainty =       0.003578653233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499076149
  error estimate for blocks of size 2^( 2) =       0.000525148496
  error estimate for blocks of size 2^( 3) =       0.000550017941
  error estimate for blocks of size 2^( 4) =       0.000569134520
  error estimate for blocks of size 2^( 5) =       0.000582128890
  error estimate for blocks of size 2^( 6) =       0.000590100601
  error estimate for blocks of size 2^( 7) =       0.000593506200

      target function =      -0.708324937429
              le_mean =     -22.425550492642
             les_mean =     503.403468653004
             stat err =       0.000583717553
             autocorr =       1.367955205885
   target nu stat err =       0.000583717553
   target dn stat err =       0.004163679765
      target stat err =       0.003062603205
              std dev =       0.705800257891
             le_variance =       0.498154004039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498093536306
                                         uncertainty =       0.003578652529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498093536306
                                         uncertainty =       0.003578652529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499076165
  error estimate for blocks of size 2^( 2) =       0.000525148509
  error estimate for blocks of size 2^( 3) =       0.000550017949
  error estimate for blocks of size 2^( 4) =       0.000569134524
  error estimate for blocks of size 2^( 5) =       0.000582128891
  error estimate for blocks of size 2^( 6) =       0.000590100599
  error estimate for blocks of size 2^( 7) =       0.000593506197

      target function =      -0.708324913856
              le_mean =     -22.425550492643
             les_mean =     503.403468685715
             stat err =       0.000583717553
             autocorr =       1.367955114969
   target nu stat err =       0.000583717553
   target dn stat err =       0.004163678947
      target stat err =       0.003062602425
              std dev =       0.705800281040
             le_variance =       0.498154036716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498093519958
                                         uncertainty =       0.003578652881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498093519958
                                         uncertainty =       0.003578652881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499076157
  error estimate for blocks of size 2^( 2) =       0.000525148502
  error estimate for blocks of size 2^( 3) =       0.000550017945
  error estimate for blocks of size 2^( 4) =       0.000569134522
  error estimate for blocks of size 2^( 5) =       0.000582128891
  error estimate for blocks of size 2^( 6) =       0.000590100600
  error estimate for blocks of size 2^( 7) =       0.000593506199

      target function =      -0.708324925642
              le_mean =     -22.425550492643
             les_mean =     503.403468669359
             stat err =       0.000583717553
             autocorr =       1.367955160431
   target nu stat err =       0.000583717553
   target dn stat err =       0.004163679356
      target stat err =       0.003062602815
              std dev =       0.705800269465
             le_variance =       0.498154020377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498093505652
                                         uncertainty =       0.003578653189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498093505652
                                         uncertainty =       0.003578653189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499076150
  error estimate for blocks of size 2^( 2) =       0.000525148497
  error estimate for blocks of size 2^( 3) =       0.000550017942
  error estimate for blocks of size 2^( 4) =       0.000569134520
  error estimate for blocks of size 2^( 5) =       0.000582128890
  error estimate for blocks of size 2^( 6) =       0.000590100601
  error estimate for blocks of size 2^( 7) =       0.000593506200

      target function =      -0.708324935955
              le_mean =     -22.425550492642
             les_mean =     503.403468655049
             stat err =       0.000583717553
             autocorr =       1.367955200206
   target nu stat err =       0.000583717553
   target dn stat err =       0.004163679714
      target stat err =       0.003062603156
              std dev =       0.705800259338
             le_variance =       0.498154006081


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.708324937429        initial  <--
     2.5000e+03     2.5000e+04             2.8007e-07        -0.708324913856
     1.0000e+04     1.0000e+05             7.0017e-08        -0.708324925642
     4.0000e+04     4.0000e+05             1.7504e-08        -0.708324935955

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0789
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2516e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2432e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.4232
    reference variance = 0.330412
====================================================
  Execution time = 4.6940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9823e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5269e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498282137679
                                         uncertainty =       0.003911020645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498282137679
                                         uncertainty =       0.003911020645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499113646
  error estimate for blocks of size 2^( 2) =       0.000525031425
  error estimate for blocks of size 2^( 3) =       0.000549902915
  error estimate for blocks of size 2^( 4) =       0.000569060747
  error estimate for blocks of size 2^( 5) =       0.000580895062
  error estimate for blocks of size 2^( 6) =       0.000589140538
  error estimate for blocks of size 2^( 7) =       0.000593426651

      target function =      -0.708260232678
              le_mean =     -22.426340320399
             les_mean =     503.438968780597
             stat err =       0.000583130749
             autocorr =       1.365001090478
   target nu stat err =       0.000583130749
   target dn stat err =       0.003844822053
      target stat err =       0.002839845784
              std dev =       0.705853287412
             le_variance =       0.498228863350


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242634032040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708270537566       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708270537754       residual = 6.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708270537845       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708270537895       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708270537904       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708270537987       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708270537966       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708270537960       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708270538001       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708270538034       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.708270538020       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.708270538019       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.708270538020       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.708270538075       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.708270538115       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.708270538099       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.708270538106       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.708270538113       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.708270538165       residual = 7.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.708270538104       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.708270538139       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.708270538111       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.708270538142       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.708270538091       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.708270538090       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.708270538167       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.708270538090       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.708270538159       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.708270538145       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.708270538101       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.708270538158       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+04 is 1.778784e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708270537566       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708270537613       residual = 6.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708270537636       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708270537648       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708270537640       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708270537571       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708270537701       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708270537600       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708270537416       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708270537525       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.708270538032       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.708270537660       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.708270537344       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.708270537655       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.708270537715       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.708270537719       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.708270537692       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.708270537839       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.708270537683       residual = 7.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.708270537703       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.708270537784       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.708270537843       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.708270537569       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.708270537817       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.708270537626       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.708270537613       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.708270537483       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.708270537608       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.708270537623       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.708270537520       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.708270537517       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+05 is 4.446961e-09

solving harmonic davidson linear method for identity shift 4.0000e+05, overlap shift 4.0000e+06 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708270537566       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708270537578       residual = 6.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708270537584       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708270537587       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708270537445       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708270537317       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708270537303       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708270537096       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708270537895       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708270537349       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.708270537178       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.708270537279       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.708270537601       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.708270537540       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.708270537494       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.708270537420       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.708270538028       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.708270537174       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.708270537832       residual = 7.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.708270537641       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.708270538207       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.708270537884       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.708270539542       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.708270537196       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.708270536651       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.708270538088       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.708270539571       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.708270538714       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.708270538542       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.708270536233       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.708270537604       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+05 is 1.111740e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.335565 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2248e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920280e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300089e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913137e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577918e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873052e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.2419
    reference variance = 2.30995
====================================================
  Execution time = 4.6471e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0128e-01
  Total weights = 2.0000e+06
  Execution time = 3.8063e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501083888532
                                         uncertainty =       0.003588543019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501083888532
                                         uncertainty =       0.003588543019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500639879
  error estimate for blocks of size 2^( 2) =       0.000526682732
  error estimate for blocks of size 2^( 3) =       0.000550904430
  error estimate for blocks of size 2^( 4) =       0.000569541748
  error estimate for blocks of size 2^( 5) =       0.000582074213
  error estimate for blocks of size 2^( 6) =       0.000586120011
  error estimate for blocks of size 2^( 7) =       0.000590401159

      target function =      -0.706061741575
              le_mean =     -22.426442041726
             les_mean =     503.446582976774
             stat err =       0.000582034283
             autocorr =       1.351593986358
   target nu stat err =       0.000582034283
   target dn stat err =       0.003688903548
      target stat err =       0.002713464928
              std dev =       0.708011706495
             le_variance =       0.501280576534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501083891379
                                         uncertainty =       0.003588543041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501083891379
                                         uncertainty =       0.003588543041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500639880
  error estimate for blocks of size 2^( 2) =       0.000526682733
  error estimate for blocks of size 2^( 3) =       0.000550904431
  error estimate for blocks of size 2^( 4) =       0.000569541748
  error estimate for blocks of size 2^( 5) =       0.000582074213
  error estimate for blocks of size 2^( 6) =       0.000586120012
  error estimate for blocks of size 2^( 7) =       0.000590401159

      target function =      -0.706061739521
              le_mean =     -22.426442041757
             les_mean =     503.446582981048
             stat err =       0.000582034283
             autocorr =       1.351593979689
   target nu stat err =       0.000582034283
   target dn stat err =       0.003688903570
      target stat err =       0.002713464928
              std dev =       0.708011708515
             le_variance =       0.501280579394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501083889956
                                         uncertainty =       0.003588543030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501083889956
                                         uncertainty =       0.003588543030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500639880
  error estimate for blocks of size 2^( 2) =       0.000526682732
  error estimate for blocks of size 2^( 3) =       0.000550904431
  error estimate for blocks of size 2^( 4) =       0.000569541748
  error estimate for blocks of size 2^( 5) =       0.000582074213
  error estimate for blocks of size 2^( 6) =       0.000586120011
  error estimate for blocks of size 2^( 7) =       0.000590401159

      target function =      -0.706061740548
              le_mean =     -22.426442041741
             les_mean =     503.446582978911
             stat err =       0.000582034283
             autocorr =       1.351593983022
   target nu stat err =       0.000582034283
   target dn stat err =       0.003688903559
      target stat err =       0.002713464928
              std dev =       0.708011707505
             le_variance =       0.501280577964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501083888710
                                         uncertainty =       0.003588543021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501083888710
                                         uncertainty =       0.003588543021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500639879
  error estimate for blocks of size 2^( 2) =       0.000526682732
  error estimate for blocks of size 2^( 3) =       0.000550904430
  error estimate for blocks of size 2^( 4) =       0.000569541748
  error estimate for blocks of size 2^( 5) =       0.000582074213
  error estimate for blocks of size 2^( 6) =       0.000586120011
  error estimate for blocks of size 2^( 7) =       0.000590401159

      target function =      -0.706061741447
              le_mean =     -22.426442041728
             les_mean =     503.446582977041
             stat err =       0.000582034283
             autocorr =       1.351593985937
   target nu stat err =       0.000582034283
   target dn stat err =       0.003688903549
      target stat err =       0.002713464928
              std dev =       0.708011706621
             le_variance =       0.501280576712


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706061741575        initial  <--
     2.5000e+04     2.5000e+05             1.7788e-08        -0.706061739521
     1.0000e+05     1.0000e+06             4.4470e-09        -0.706061740548
     4.0000e+05     4.0000e+06             1.1117e-09        -0.706061741447

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.5433
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2780e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2415e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.3573
    reference variance = 0.547587
====================================================
  Execution time = 4.5495e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.1080e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5110e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510859744992
                                         uncertainty =       0.007271155820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510859744992
                                         uncertainty =       0.007271155820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505372273
  error estimate for blocks of size 2^( 2) =       0.000531304150
  error estimate for blocks of size 2^( 3) =       0.000556124463
  error estimate for blocks of size 2^( 4) =       0.000575705035
  error estimate for blocks of size 2^( 5) =       0.000589005607
  error estimate for blocks of size 2^( 6) =       0.000596180929
  error estimate for blocks of size 2^( 7) =       0.000601650134

      target function =      -0.699256100171
              le_mean =     -22.426732607531
             les_mean =     503.469137462116
             stat err =       0.000590635426
             autocorr =       1.365891378620
   target nu stat err =       0.000590635426
   target dn stat err =       0.007321028622
      target stat err =       0.005191285069
              std dev =       0.714704321948
             le_variance =       0.510802267811


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242673260753e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.699292922928       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699292922962       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.699292922986       residual = 8.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.699292922997       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.699292923007       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.699292923013       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.699292923349       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.699292923017       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.699292923331       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.699292922781       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.699292923179       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.699292922977       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.699292923028       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.699292923029       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.699292922666       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.699292922808       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.699292923551       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.699292923267       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.699292923424       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.699292922254       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.699292923877       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.699292923099       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.699292923324       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.699292922594       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.699292922349       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.699292923418       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.699292922506       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.699292922620       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.699292923682       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.699292922927       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.699292922412       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.699292923138       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.699292922332       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+05 is 3.584995e-09

solving harmonic davidson linear method for identity shift 1.0000e+06, overlap shift 1.0000e+07 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.699292922928       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699292922936       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.699292922942       residual = 8.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.699292922945       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.699292922948       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.699292922949       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.699292922950       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.699292922950       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.699292923773       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.699292921249       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.699292923023       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.699292921754       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.699292922907       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.699292924375       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.699292921523       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.699292921810       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.699292923596       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.699292923586       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.699292923639       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.699292924237       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.699292924369       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.699292924290       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.699292923051       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.699292923683       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.699292920907       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.699292918901       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.699292926287       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.699292922698       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.699292921077       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.699292921470       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.699292928287       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.699292922825       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.699292919644       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+06 is 8.962492e-10

solving harmonic davidson linear method for identity shift 4.0000e+06, overlap shift 4.0000e+07 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.699292922928       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699292922930       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.699292922931       residual = 8.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.699292922932       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.699292922933       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.699292922933       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.699292922933       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.699292927420       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.699292930330       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.699292922934       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.699292930537       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.699292910231       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.699292920667       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.699292922203       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.699292938173       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.699292929263       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.699292926813       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.699292916212       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.699292913687       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.699292922869       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.699292924325       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.699292917468       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.699292914672       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.699292926330       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.699292914474       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.699292920695       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.699292922627       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.699292908608       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.699292918271       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.699292938476       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.699292945273       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.699292939997       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.699292920582       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+06 is 2.240628e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.373248 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0648e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913137e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664228e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.3777
    reference variance = 0.347409
====================================================
  Execution time = 4.4722e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2425e+01
  VMC Evar = 4.9931e-01
  Total weights = 2.0000e+06
  Execution time = 3.8216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499341928770
                                         uncertainty =       0.003382621332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499341928770
                                         uncertainty =       0.003382621332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499655133
  error estimate for blocks of size 2^( 2) =       0.000525820482
  error estimate for blocks of size 2^( 3) =       0.000550970958
  error estimate for blocks of size 2^( 4) =       0.000569965414
  error estimate for blocks of size 2^( 5) =       0.000582724360
  error estimate for blocks of size 2^( 6) =       0.000591378532
  error estimate for blocks of size 2^( 7) =       0.000597581943

      target function =      -0.707509096662
              le_mean =     -22.424701257725
             les_mean =     503.366536752788
             stat err =       0.000585412562
             autocorr =       1.372724447523
   target nu stat err =       0.000585412562
   target dn stat err =       0.003375764749
      target stat err =       0.002499061091
              std dev =       0.706619065850
             le_variance =       0.499310504223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499341929059
                                         uncertainty =       0.003382621333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499341929059
                                         uncertainty =       0.003382621333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499655133
  error estimate for blocks of size 2^( 2) =       0.000525820483
  error estimate for blocks of size 2^( 3) =       0.000550970958
  error estimate for blocks of size 2^( 4) =       0.000569965415
  error estimate for blocks of size 2^( 5) =       0.000582724360
  error estimate for blocks of size 2^( 6) =       0.000591378532
  error estimate for blocks of size 2^( 7) =       0.000597581943

      target function =      -0.707509096455
              le_mean =     -22.424701257734
             les_mean =     503.366536753487
             stat err =       0.000585412562
             autocorr =       1.372724447664
   target nu stat err =       0.000585412562
   target dn stat err =       0.003375764751
      target stat err =       0.002499061091
              std dev =       0.706619066054
             le_variance =       0.499310504511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499341928915
                                         uncertainty =       0.003382621332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499341928915
                                         uncertainty =       0.003382621332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499655133
  error estimate for blocks of size 2^( 2) =       0.000525820482
  error estimate for blocks of size 2^( 3) =       0.000550970958
  error estimate for blocks of size 2^( 4) =       0.000569965415
  error estimate for blocks of size 2^( 5) =       0.000582724360
  error estimate for blocks of size 2^( 6) =       0.000591378532
  error estimate for blocks of size 2^( 7) =       0.000597581943

      target function =      -0.707509096558
              le_mean =     -22.424701257730
             les_mean =     503.366536753137
             stat err =       0.000585412562
             autocorr =       1.372724447592
   target nu stat err =       0.000585412562
   target dn stat err =       0.003375764750
      target stat err =       0.002499061091
              std dev =       0.706619065952
             le_variance =       0.499310504367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499341928788
                                         uncertainty =       0.003382621332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499341928788
                                         uncertainty =       0.003382621332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499655133
  error estimate for blocks of size 2^( 2) =       0.000525820482
  error estimate for blocks of size 2^( 3) =       0.000550970958
  error estimate for blocks of size 2^( 4) =       0.000569965414
  error estimate for blocks of size 2^( 5) =       0.000582724360
  error estimate for blocks of size 2^( 6) =       0.000591378532
  error estimate for blocks of size 2^( 7) =       0.000597581943

      target function =      -0.707509096649
              le_mean =     -22.424701257726
             les_mean =     503.366536752831
             stat err =       0.000585412562
             autocorr =       1.372724447524
   target nu stat err =       0.000585412562
   target dn stat err =       0.003375764749
      target stat err =       0.002499061091
              std dev =       0.706619065863
             le_variance =       0.499310504241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707509096662        initial  <--
     2.5000e+05     2.5000e+06             3.5850e-09        -0.707509096455
     1.0000e+06     1.0000e+07             8.9625e-10        -0.707509096558
     4.0000e+06     4.0000e+07             2.2406e-10        -0.707509096649

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8616
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2452e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2408e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.4023
    reference variance = 0.304483
====================================================
  Execution time = 4.5628e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9610e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5259e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496157752161
                                         uncertainty =       0.003478012665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496157752161
                                         uncertainty =       0.003478012665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498045422
  error estimate for blocks of size 2^( 2) =       0.000524441152
  error estimate for blocks of size 2^( 3) =       0.000549858243
  error estimate for blocks of size 2^( 4) =       0.000569229701
  error estimate for blocks of size 2^( 5) =       0.000581143951
  error estimate for blocks of size 2^( 6) =       0.000588247314
  error estimate for blocks of size 2^( 7) =       0.000595752091

      target function =      -0.709803917588
              le_mean =     -22.426299687757
             les_mean =     503.435015921910
             stat err =       0.000583593264
             autocorr =       1.373038252211
   target nu stat err =       0.000583593264
   target dn stat err =       0.003639981551
      target stat err =       0.002706776525
              std dev =       0.704342590562
             le_variance =       0.496098484879


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242629968776e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709813138051       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709813138053       residual = 8.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709813138054       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709813138054       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709813138411       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709813143174       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709813141140       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709813137407       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709813142158       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709813139785       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709813142481       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.709813132678       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.709813146024       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.709813141786       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.709813140188       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.709813139226       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.709813139797       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.709813139683       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.709813136013       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.709813137522       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.709813146022       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.709813140771       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.709813140250       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.709813140256       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.709813131383       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.709813138117       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.709813129529       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.709813132237       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.709813132588       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.709813138143       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.709813134073       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+06 is 1.949685e-10

solving harmonic davidson linear method for identity shift 1.0000e+07, overlap shift 1.0000e+08 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709813138051       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709813138052       residual = 8.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709813138052       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709813139449       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709813139577       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709813138047       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709813157312       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709813127103       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709813128322       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709813151987       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709813121656       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.709813121326       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.709813133385       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.709813113707       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.709813120715       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.709813146969       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.709813143792       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.709813120089       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.709813145196       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.709813156210       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.709813093624       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.709813155256       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.709813131140       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.709813125094       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.709813163117       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.709813119112       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.709813150056       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.709813117878       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.709813105755       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.709813131620       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.709813171528       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+07 is 4.874215e-11

solving harmonic davidson linear method for identity shift 4.0000e+07, overlap shift 4.0000e+08 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709813138051       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709813138052       residual = 8.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709813138052       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709813138052       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709813138084       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709813117490       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709813148566       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709813121929       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709813154504       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709813119850       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709813122573       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.709813131785       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.709813057836       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.709813048714       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.709813120636       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.709813089112       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.709813209757       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.709813247383       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.709813114624       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.709813157739       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.709813073513       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.709813108951       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.709813216074       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.709813146761       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.709813167157       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.709813066173       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.709813143217       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.709813119315       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.709813189570       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.709813079475       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.709813256648       residual = 8.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+07 is 1.218685e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.405365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0924e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664228e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.4591
    reference variance = 0.851664
====================================================
  Execution time = 4.7035e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9448e-01
  Total weights = 2.0000e+06
  Execution time = 3.8241e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494437282184
                                         uncertainty =       0.004822280804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494437282184
                                         uncertainty =       0.004822280804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497230420
  error estimate for blocks of size 2^( 2) =       0.000523502355
  error estimate for blocks of size 2^( 3) =       0.000549175920
  error estimate for blocks of size 2^( 4) =       0.000568914337
  error estimate for blocks of size 2^( 5) =       0.000580001743
  error estimate for blocks of size 2^( 6) =       0.000584038876
  error estimate for blocks of size 2^( 7) =       0.000585814989

      target function =      -0.710969635828
              le_mean =     -22.426787060895
             les_mean =     503.455253808723
             stat err =       0.000579692486
             autocorr =       1.359189346446
   target nu stat err =       0.000579692486
   target dn stat err =       0.004658280071
      target stat err =       0.003443976829
              std dev =       0.703190003661
             le_variance =       0.494476181249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494437282212
                                         uncertainty =       0.004822280805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494437282212
                                         uncertainty =       0.004822280805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497230420
  error estimate for blocks of size 2^( 2) =       0.000523502355
  error estimate for blocks of size 2^( 3) =       0.000549175920
  error estimate for blocks of size 2^( 4) =       0.000568914337
  error estimate for blocks of size 2^( 5) =       0.000580001743
  error estimate for blocks of size 2^( 6) =       0.000584038876
  error estimate for blocks of size 2^( 7) =       0.000585814989

      target function =      -0.710969635807
              le_mean =     -22.426787060895
             les_mean =     503.455253808755
             stat err =       0.000579692486
             autocorr =       1.359189346333
   target nu stat err =       0.000579692486
   target dn stat err =       0.004658280072
      target stat err =       0.003443976830
              std dev =       0.703190003681
             le_variance =       0.494476181277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494437282198
                                         uncertainty =       0.004822280805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494437282198
                                         uncertainty =       0.004822280805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497230420
  error estimate for blocks of size 2^( 2) =       0.000523502355
  error estimate for blocks of size 2^( 3) =       0.000549175920
  error estimate for blocks of size 2^( 4) =       0.000568914337
  error estimate for blocks of size 2^( 5) =       0.000580001743
  error estimate for blocks of size 2^( 6) =       0.000584038876
  error estimate for blocks of size 2^( 7) =       0.000585814989

      target function =      -0.710969635818
              le_mean =     -22.426787060895
             les_mean =     503.455253808739
             stat err =       0.000579692486
             autocorr =       1.359189346390
   target nu stat err =       0.000579692486
   target dn stat err =       0.004658280072
      target stat err =       0.003443976829
              std dev =       0.703190003671
             le_variance =       0.494476181263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494437282186
                                         uncertainty =       0.004822280804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494437282186
                                         uncertainty =       0.004822280804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497230420
  error estimate for blocks of size 2^( 2) =       0.000523502355
  error estimate for blocks of size 2^( 3) =       0.000549175920
  error estimate for blocks of size 2^( 4) =       0.000568914337
  error estimate for blocks of size 2^( 5) =       0.000580001743
  error estimate for blocks of size 2^( 6) =       0.000584038876
  error estimate for blocks of size 2^( 7) =       0.000585814989

      target function =      -0.710969635827
              le_mean =     -22.426787060895
             les_mean =     503.455253808725
             stat err =       0.000579692486
             autocorr =       1.359189346440
   target nu stat err =       0.000579692486
   target dn stat err =       0.004658280071
      target stat err =       0.003443976829
              std dev =       0.703190003662
             le_variance =       0.494476181251


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.710969635828        initial  <--
     2.5000e+06     2.5000e+07             1.9497e-10        -0.710969635807
     1.0000e+07     1.0000e+08             4.8742e-11        -0.710969635818
     4.0000e+07     4.0000e+08             1.2187e-11        -0.710969635827

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.6157
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2855e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2411e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.4269
    reference variance = 0.428599
====================================================
  Execution time = 4.5657e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0528e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4982e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505309564561
                                         uncertainty =       0.004876587477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505309564561
                                         uncertainty =       0.004876587477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502633191
  error estimate for blocks of size 2^( 2) =       0.000528117695
  error estimate for blocks of size 2^( 3) =       0.000552827859
  error estimate for blocks of size 2^( 4) =       0.000572081699
  error estimate for blocks of size 2^( 5) =       0.000584325425
  error estimate for blocks of size 2^( 6) =       0.000591230314
  error estimate for blocks of size 2^( 7) =       0.000596363715

      target function =      -0.703213383751
              le_mean =     -22.425657767017
             les_mean =     503.415406280423
             stat err =       0.000586000288
             autocorr =       1.359231191668
   target nu stat err =       0.000586000288
   target dn stat err =       0.004823876451
      target stat err =       0.003482008278
              std dev =       0.710830675822
             le_variance =       0.505280249690


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242565776702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.703229669345       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.703229669345       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.703229669345       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.703229669345       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.703229664697       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.703229662070       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.703229669345       residual = 8.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.703229674706       residual = 9.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.703229593714       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.703229642360       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.703229630242       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.703229688828       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.703229664508       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.703229636263       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.703229679510       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.703229590995       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.703229669042       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.703229682093       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.703229656188       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.703229705065       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.703229597036       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.703229651135       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.703229717439       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.703229671105       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.703229613250       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.703229637723       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.703229621583       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.703229686979       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.703229614467       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.703229668353       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.703229714559       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.703229657001       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+07 is 2.789136e-11

solving harmonic davidson linear method for identity shift 1.0000e+08, overlap shift 1.0000e+09 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.703229669345       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.703229669345       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.703229669345       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.703229669345       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.703229634804       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.703229612499       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.703229733814       residual = 8.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.703229591647       residual = 9.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.703229595304       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.703229704514       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.703229541941       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.703229596233       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.703229577814       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.703229743262       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.703229806254       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.703229993624       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.703229792145       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.703229453921       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.703229690523       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.703230095358       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.703229958977       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.703229752832       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.703228916716       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.703230041768       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.703229417481       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.703229596483       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.703229721449       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.703229786841       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.703229396540       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.703229534931       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.703229521052       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.703229748552       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+08 is 6.972106e-12

solving harmonic davidson linear method for identity shift 4.0000e+08, overlap shift 4.0000e+09 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.703229669345       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.703229669345       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.703229669345       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.703229669345       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.703229669362       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.703229628030       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.703229452225       residual = 8.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.703228981712       residual = 9.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.703229043462       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.703228859844       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.703230110494       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.703229854424       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.703230255738       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.703229167605       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.703230048413       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.703229090105       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.703229340922       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.703230030091       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.703228925000       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.703229539479       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.703229529700       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.703231236375       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.703230015197       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.703228053688       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.703228310725       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.703230199273       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.703229816833       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.703228778505       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.703231514490       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.703229505034       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.703229748549       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.703229875735       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+08 is 1.743860e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.440193 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0696e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.3984
    reference variance = 0.578777
====================================================
  Execution time = 4.4492e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0313e-01
  Total weights = 2.0000e+06
  Execution time = 3.8233e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503118535511
                                         uncertainty =       0.004258544193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503118535511
                                         uncertainty =       0.004258544193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501560926
  error estimate for blocks of size 2^( 2) =       0.000527482138
  error estimate for blocks of size 2^( 3) =       0.000552735695
  error estimate for blocks of size 2^( 4) =       0.000572413802
  error estimate for blocks of size 2^( 5) =       0.000584056491
  error estimate for blocks of size 2^( 6) =       0.000591161135
  error estimate for blocks of size 2^( 7) =       0.000598122940

      target function =      -0.704741857150
              le_mean =     -22.426032579859
             les_mean =     503.430063746150
             stat err =       0.000586438592
             autocorr =       1.367091849666
   target nu stat err =       0.000586438592
   target dn stat err =       0.004638189376
      target stat err =       0.003368181702
              std dev =       0.709314263804
             le_variance =       0.503126724835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503118535514
                                         uncertainty =       0.004258544193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503118535514
                                         uncertainty =       0.004258544193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501560926
  error estimate for blocks of size 2^( 2) =       0.000527482138
  error estimate for blocks of size 2^( 3) =       0.000552735695
  error estimate for blocks of size 2^( 4) =       0.000572413802
  error estimate for blocks of size 2^( 5) =       0.000584056491
  error estimate for blocks of size 2^( 6) =       0.000591161135
  error estimate for blocks of size 2^( 7) =       0.000598122940

      target function =      -0.704741857148
              le_mean =     -22.426032579859
             les_mean =     503.430063746153
             stat err =       0.000586438592
             autocorr =       1.367091849657
   target nu stat err =       0.000586438592
   target dn stat err =       0.004638189376
      target stat err =       0.003368181702
              std dev =       0.709314263806
             le_variance =       0.503126724838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503118535512
                                         uncertainty =       0.004258544193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503118535512
                                         uncertainty =       0.004258544193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501560926
  error estimate for blocks of size 2^( 2) =       0.000527482138
  error estimate for blocks of size 2^( 3) =       0.000552735695
  error estimate for blocks of size 2^( 4) =       0.000572413802
  error estimate for blocks of size 2^( 5) =       0.000584056491
  error estimate for blocks of size 2^( 6) =       0.000591161135
  error estimate for blocks of size 2^( 7) =       0.000598122940

      target function =      -0.704741857149
              le_mean =     -22.426032579859
             les_mean =     503.430063746151
             stat err =       0.000586438592
             autocorr =       1.367091849668
   target nu stat err =       0.000586438592
   target dn stat err =       0.004638189376
      target stat err =       0.003368181702
              std dev =       0.709314263804
             le_variance =       0.503126724837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503118535511
                                         uncertainty =       0.004258544193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503118535511
                                         uncertainty =       0.004258544193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501560926
  error estimate for blocks of size 2^( 2) =       0.000527482138
  error estimate for blocks of size 2^( 3) =       0.000552735695
  error estimate for blocks of size 2^( 4) =       0.000572413802
  error estimate for blocks of size 2^( 5) =       0.000584056491
  error estimate for blocks of size 2^( 6) =       0.000591161135
  error estimate for blocks of size 2^( 7) =       0.000598122940

      target function =      -0.704741857150
              le_mean =     -22.426032579859
             les_mean =     503.430063746151
             stat err =       0.000586438592
             autocorr =       1.367091849660
   target nu stat err =       0.000586438592
   target dn stat err =       0.004638189376
      target stat err =       0.003368181702
              std dev =       0.709314263804
             le_variance =       0.503126724836


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.704741857150        initial  <--
     2.5000e+07     2.5000e+08             2.7891e-11        -0.704741857148
     1.0000e+08     1.0000e+09             6.9721e-12        -0.704741857149
     4.0000e+08     4.0000e+09             1.7439e-12        -0.704741857150

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.6433
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2435e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2411e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.37
    reference variance = 0.829891
====================================================
  Execution time = 4.5349e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9899e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5049e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498913304799
                                         uncertainty =       0.005812871706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498913304799
                                         uncertainty =       0.005812871706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499492394
  error estimate for blocks of size 2^( 2) =       0.000525868599
  error estimate for blocks of size 2^( 3) =       0.000551409029
  error estimate for blocks of size 2^( 4) =       0.000571069612
  error estimate for blocks of size 2^( 5) =       0.000581534254
  error estimate for blocks of size 2^( 6) =       0.000590027271
  error estimate for blocks of size 2^( 7) =       0.000597750082

      target function =      -0.707709146523
              le_mean =     -22.425750671516
             les_mean =     503.413278234054
             stat err =       0.000585095305
             autocorr =       1.372130657258
   target nu stat err =       0.000585095305
   target dn stat err =       0.005709297358
      target stat err =       0.004156579863
              std dev =       0.706388917346
             le_variance =       0.498985302549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242575067152e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707734505806       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707734505806       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707734505806       residual = 5.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707734499547       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707734505735       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707734301281       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707735017537       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707735043109       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707734298034       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707734237060       residual = 7.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707734658785       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.707734300571       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.707734488092       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.707733911416       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.707735382257       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.707734287900       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.707734736975       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.707734614934       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.707734349361       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.707734994522       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.707734531975       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.707734006755       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.707733895769       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.707735228221       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.707734280438       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.707734775436       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.707734836841       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.707734571364       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.707734554269       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.707734235981       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.707734552916       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+08 is 2.060553e-12

solving harmonic davidson linear method for identity shift 1.0000e+09, overlap shift 1.0000e+10 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707734505806       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707734505806       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707734505806       residual = 5.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707734334459       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707733482692       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707735209271       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707735217939       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707733491827       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707736564566       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707738205279       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707734108313       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.707731366119       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.707734143713       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.707734179550       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.707731762252       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.707733816804       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.707734483065       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.707735449501       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.707736424093       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.707735097760       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.707733520603       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.707732943014       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.707737342555       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.707733277371       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.707732914088       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.707733739101       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.707735807052       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.707736742068       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.707735934862       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.707733884916       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.707736278844       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.707726765716       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.707732094636       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+09 is 5.101305e-13

solving harmonic davidson linear method for identity shift 4.0000e+09, overlap shift 4.0000e+10 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707734505806       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707734505806       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707734505806       residual = 5.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707734463329       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707730111564       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707735341239       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707725605607       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707738623140       residual = 9.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707721903741       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707727948741       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707728196338       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.707734148768       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.707735438357       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.707728965761       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.707738941383       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.707722139473       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.707733012097       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.707726852397       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.707722898423       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.707735865792       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.707734498530       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.707734226495       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.707741772975       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.707731255146       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.707731780781       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.707747500818       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.707739483277       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.707720238627       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.707718995964       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.707731871104       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.707738521689       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.707730576081       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.707740042749       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.707742839219       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.707736718557       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.707739950749       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.707751690859       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.707725780281       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.707733370635       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.707724343335       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.707738071129       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.707731335668       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.707710612646       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.707749087369       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.707712915652       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.707773144798       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.707813555383       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.707689061508       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.707811505166       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.707682043781       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.707705784653       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.708437759634       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.707214656141       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.706234209131       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.706487198267       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.706793401189       residual = 5.24e-04           smallest_sin_value = 9.99e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.72e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+09 is 1.268161e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.530670 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0494e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.461
    reference variance = 0.617871
====================================================
  Execution time = 4.4488e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0409e-01
  Total weights = 2.0000e+06
  Execution time = 3.8167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504160421604
                                         uncertainty =       0.003929445415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504160421604
                                         uncertainty =       0.003929445415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502040654
  error estimate for blocks of size 2^( 2) =       0.000528021158
  error estimate for blocks of size 2^( 3) =       0.000554133349
  error estimate for blocks of size 2^( 4) =       0.000572739694
  error estimate for blocks of size 2^( 5) =       0.000584737106
  error estimate for blocks of size 2^( 6) =       0.000591871687
  error estimate for blocks of size 2^( 7) =       0.000592666069

      target function =      -0.704047610808
              le_mean =     -22.426530054601
             les_mean =     503.453339674232
             stat err =       0.000585503639
             autocorr =       1.360133145032
   target nu stat err =       0.000585503639
   target dn stat err =       0.003949379583
      target stat err =       0.002881176479
              std dev =       0.709992701634
             le_variance =       0.504089636374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504160421604
                                         uncertainty =       0.003929445415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504160421604
                                         uncertainty =       0.003929445415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502040654
  error estimate for blocks of size 2^( 2) =       0.000528021158
  error estimate for blocks of size 2^( 3) =       0.000554133349
  error estimate for blocks of size 2^( 4) =       0.000572739694
  error estimate for blocks of size 2^( 5) =       0.000584737106
  error estimate for blocks of size 2^( 6) =       0.000591871687
  error estimate for blocks of size 2^( 7) =       0.000592666069

      target function =      -0.704047610808
              le_mean =     -22.426530054601
             les_mean =     503.453339674232
             stat err =       0.000585503639
             autocorr =       1.360133145034
   target nu stat err =       0.000585503639
   target dn stat err =       0.003949379583
      target stat err =       0.002881176479
              std dev =       0.709992701635
             le_variance =       0.504089636375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504160421604
                                         uncertainty =       0.003929445415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504160421604
                                         uncertainty =       0.003929445415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502040654
  error estimate for blocks of size 2^( 2) =       0.000528021158
  error estimate for blocks of size 2^( 3) =       0.000554133349
  error estimate for blocks of size 2^( 4) =       0.000572739694
  error estimate for blocks of size 2^( 5) =       0.000584737106
  error estimate for blocks of size 2^( 6) =       0.000591871687
  error estimate for blocks of size 2^( 7) =       0.000592666069

      target function =      -0.704047610808
              le_mean =     -22.426530054601
             les_mean =     503.453339674232
             stat err =       0.000585503639
             autocorr =       1.360133145029
   target nu stat err =       0.000585503639
   target dn stat err =       0.003949379583
      target stat err =       0.002881176479
              std dev =       0.709992701635
             le_variance =       0.504089636374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504160421604
                                         uncertainty =       0.003929445415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504160421604
                                         uncertainty =       0.003929445415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502040654
  error estimate for blocks of size 2^( 2) =       0.000528021158
  error estimate for blocks of size 2^( 3) =       0.000554133349
  error estimate for blocks of size 2^( 4) =       0.000572739694
  error estimate for blocks of size 2^( 5) =       0.000584737106
  error estimate for blocks of size 2^( 6) =       0.000591871687
  error estimate for blocks of size 2^( 7) =       0.000592666069

      target function =      -0.704047610808
              le_mean =     -22.426530054601
             les_mean =     503.453339674232
             stat err =       0.000585503639
             autocorr =       1.360133145042
   target nu stat err =       0.000585503639
   target dn stat err =       0.003949379583
      target stat err =       0.002881176479
              std dev =       0.709992701634
             le_variance =       0.504089636374


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.704047610808        initial  <--
     2.5000e+08     2.5000e+09             2.0606e-12        -0.704047610808
     1.0000e+09     1.0000e+10             5.1013e-13        -0.704047610808
     4.0000e+09     4.0000e+10             1.2682e-13        -0.704047610808

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.0655
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2657e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2412e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.4771
    reference variance = 0.597385
====================================================
  Execution time = 4.6851e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2425e+01
  VMC Evar = 4.9849e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5337e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498507807041
                                         uncertainty =       0.004375585021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498507807041
                                         uncertainty =       0.004375585021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499245582
  error estimate for blocks of size 2^( 2) =       0.000525595634
  error estimate for blocks of size 2^( 3) =       0.000550990691
  error estimate for blocks of size 2^( 4) =       0.000570594530
  error estimate for blocks of size 2^( 5) =       0.000582207680
  error estimate for blocks of size 2^( 6) =       0.000589575108
  error estimate for blocks of size 2^( 7) =       0.000594230657

      target function =      -0.708082715273
              le_mean =     -22.425455160471
             les_mean =     503.399531208074
             stat err =       0.000584151993
             autocorr =       1.369062468583
   target nu stat err =       0.000584151993
   target dn stat err =       0.004071736638
      target stat err =       0.002995217628
              std dev =       0.706039873544
             le_variance =       0.498492303034


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242545516047e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+09, overlap shift 2.5000e+10 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708094528128       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708094528128       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708094528128       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708094532962       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708094495991       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708094763930       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708093967683       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708096565186       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708091357044       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708096138398       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.708094822727       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.708090627868       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.708096924442       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.708093844966       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.708092003462       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.708099080056       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.708104427482       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.708097768444       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.708095419161       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.708099936621       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.708091088222       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.708101064890       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.708097620817       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.708098932354       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.708089657671       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.708102751943       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.708088528752       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.708094091293       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.708101560173       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.708095269820       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.708044570166       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.708104142866       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.708095356785       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+09 is 1.655364e-13

solving harmonic davidson linear method for identity shift 1.0000e+10, overlap shift 1.0000e+11 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708094528128       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708094528128       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708094528128       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708094528128       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708094528128       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708097723737       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708114047504       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708106689726       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708105969771       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708095973834       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.708112309734       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.708087568257       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.708092527125       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.708104006617       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.708080619771       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.708111559103       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.708079774769       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.708092073488       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.708114804783       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.708087194691       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.708095097903       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.708092345125       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.708077382860       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.708118130689       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.708087579716       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.708070065111       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.708092274021       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.708098414554       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.708146001260       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.708094387165       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.708159640690       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.708050635896       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.707981898465       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.707963403599       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.708045739271       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.708037935382       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.708153730558       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.708117636334       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.708025073687       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.707806990559       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.708048735869       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.707989701845       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.708143407950       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.708033499992       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.708172484274       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.708371349656       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.708045379610       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.707654210037       residual = 9.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.707203180333       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.709476767474       residual = 9.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.711988005910       residual = 7.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.709386363609       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.696676681372       residual = 8.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.698498723145       residual = 4.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.711234632518       residual = 1.06e-02           smallest_sin_value = 9.99e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.19e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+10 is 4.012403e-14

solving harmonic davidson linear method for identity shift 4.0000e+10, overlap shift 4.0000e+11 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708094528128       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708094528128       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708094528128       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708094528128       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708094541165       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708114766709       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708086554110       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708063677925       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708130763573       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708095045387       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.708030755933       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.708125001096       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.708191090380       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.708124124853       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.708006796534       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.708088786183       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.708170720576       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.708176249388       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.707990937561       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.708199968770       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.708033022153       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.708141462689       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.708006563348       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.707981351890       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.707792343256       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.707814848794       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.708223455252       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.708373850416       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.708144420336       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.708308669883       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.708008563233       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.708690329805       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.708408776427       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.707961416521       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.707450802167       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.707193701890       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.707496199691       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.707026540845       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.707613478395       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.708386782002       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.708506596043       residual = 9.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.708080878280       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.708226365898       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.707744042969       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.708082215578       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.707827685070       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.707771151447       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.708219841238       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.706824254021       residual = 7.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.710114272220       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.707664253104       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.714429164762       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.706066828149       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.675738024605       residual = 5.36e-01           smallest_sin_value = 9.97e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.16e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+10 is 9.470680e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.660033 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2323e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.4522
    reference variance = 0.433453
====================================================
  Execution time = 4.4416e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0009e-01
  Total weights = 2.0000e+06
  Execution time = 3.8080e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500208084854
                                         uncertainty =       0.004393719521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500208084854
                                         uncertainty =       0.004393719521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500046819
  error estimate for blocks of size 2^( 2) =       0.000526040674
  error estimate for blocks of size 2^( 3) =       0.000551755951
  error estimate for blocks of size 2^( 4) =       0.000570844983
  error estimate for blocks of size 2^( 5) =       0.000581938910
  error estimate for blocks of size 2^( 6) =       0.000588379077
  error estimate for blocks of size 2^( 7) =       0.000590607423

      target function =      -0.706913641261
              le_mean =     -22.426178738321
             les_mean =     503.433586194501
             stat err =       0.000582942598
             autocorr =       1.359033768524
   target nu stat err =       0.000582942598
   target dn stat err =       0.004673162129
      target stat err =       0.003413509952
              std dev =       0.707172992565
             le_variance =       0.500093641413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500208084854
                                         uncertainty =       0.004393719521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500208084854
                                         uncertainty =       0.004393719521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500046819
  error estimate for blocks of size 2^( 2) =       0.000526040674
  error estimate for blocks of size 2^( 3) =       0.000551755951
  error estimate for blocks of size 2^( 4) =       0.000570844983
  error estimate for blocks of size 2^( 5) =       0.000581938910
  error estimate for blocks of size 2^( 6) =       0.000588379077
  error estimate for blocks of size 2^( 7) =       0.000590607423

      target function =      -0.706913641261
              le_mean =     -22.426178738321
             les_mean =     503.433586194501
             stat err =       0.000582942598
             autocorr =       1.359033768520
   target nu stat err =       0.000582942598
   target dn stat err =       0.004673162129
      target stat err =       0.003413509952
              std dev =       0.707172992565
             le_variance =       0.500093641413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500208084854
                                         uncertainty =       0.004393719521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500208084854
                                         uncertainty =       0.004393719521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500046819
  error estimate for blocks of size 2^( 2) =       0.000526040674
  error estimate for blocks of size 2^( 3) =       0.000551755951
  error estimate for blocks of size 2^( 4) =       0.000570844983
  error estimate for blocks of size 2^( 5) =       0.000581938910
  error estimate for blocks of size 2^( 6) =       0.000588379077
  error estimate for blocks of size 2^( 7) =       0.000590607423

      target function =      -0.706913641261
              le_mean =     -22.426178738321
             les_mean =     503.433586194501
             stat err =       0.000582942598
             autocorr =       1.359033768525
   target nu stat err =       0.000582942598
   target dn stat err =       0.004673162129
      target stat err =       0.003413509952
              std dev =       0.707172992565
             le_variance =       0.500093641413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500208084854
                                         uncertainty =       0.004393719521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500208084854
                                         uncertainty =       0.004393719521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500046819
  error estimate for blocks of size 2^( 2) =       0.000526040674
  error estimate for blocks of size 2^( 3) =       0.000551755951
  error estimate for blocks of size 2^( 4) =       0.000570844983
  error estimate for blocks of size 2^( 5) =       0.000581938910
  error estimate for blocks of size 2^( 6) =       0.000588379077
  error estimate for blocks of size 2^( 7) =       0.000590607423

      target function =      -0.706913641261
              le_mean =     -22.426178738321
             les_mean =     503.433586194501
             stat err =       0.000582942598
             autocorr =       1.359033768524
   target nu stat err =       0.000582942598
   target dn stat err =       0.004673162129
      target stat err =       0.003413509952
              std dev =       0.707172992565
             le_variance =       0.500093641413


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706913641261        initial  <--
     2.5000e+09     2.5000e+10             1.6554e-13        -0.706913641261
     1.0000e+10     1.0000e+11             4.0124e-14        -0.706913641261
     4.0000e+10     4.0000e+11             9.4707e-15        -0.706913641261

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.4888
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2582e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2417e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.4761
    reference variance = 0.378243
====================================================
  Execution time = 4.5216e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9579e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5131e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495730018824
                                         uncertainty =       0.002539625692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495730018824
                                         uncertainty =       0.002539625692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497889755
  error estimate for blocks of size 2^( 2) =       0.000524422871
  error estimate for blocks of size 2^( 3) =       0.000550045717
  error estimate for blocks of size 2^( 4) =       0.000569151770
  error estimate for blocks of size 2^( 5) =       0.000581002687
  error estimate for blocks of size 2^( 6) =       0.000587352851
  error estimate for blocks of size 2^( 7) =       0.000593154518

      target function =      -0.710033963168
              le_mean =     -22.426166226165
             les_mean =     503.428719772561
             stat err =       0.000582665457
             autocorr =       1.369531932000
   target nu stat err =       0.000582665457
   target dn stat err =       0.002937897946
      target stat err =       0.002213572846
              std dev =       0.704122444525
             le_variance =       0.495788416883


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242616622616e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+10, overlap shift 2.5000e+11 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710039964375       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710039964375       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710039964375       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710039964375       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710039964375       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710040057384       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709980296736       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710088226761       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710024896906       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709999119882       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710093947634       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.710021310324       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.710074497644       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.710021135800       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.710022985812       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.710005224619       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.709989918390       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.710024221521       residual = 9.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.710059905277       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.710079803006       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.710000790172       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.710082786341       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.709956982539       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.710122034757       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.710053936846       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.710075255217       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.709952270413       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.709980417495       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.709867389666       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.710127464389       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.709918735030       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.709850038313       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.710377175765       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.710024260166       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.709958479763       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.710060094033       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.710478919458       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.710067937765       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.710421896565       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.709912029402       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.710031731237       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.710308159771       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.709428235462       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.709776401786       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.709958344332       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.709584991112       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.710089549541       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.709566608228       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.709409957311       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.708709438246       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.700702970201       residual = 4.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.710127130514       residual = 6.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.731156460844       residual = 2.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.711561649411       residual = 6.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.714781491323       residual = 3.86e-02           smallest_sin_value = 9.98e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.50e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+10 is 2.864017e-14

solving harmonic davidson linear method for identity shift 1.0000e+11, overlap shift 1.0000e+12 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710039964375       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710039964375       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710039964375       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710039964377       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710027144011       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710087746696       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709958458716       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710030495389       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710109048098       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709987793157       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710206338236       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.709969964071       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.709979370863       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.710158594932       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.710353532095       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.710068181077       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.709690375024       residual = 8.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.710137710628       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.709900994166       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.709735238758       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.710202050747       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.710084749495       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.709890514826       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.710227455687       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.710155831103       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.710076408293       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.708613614530       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.709957540997       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.710062454837       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.710263197019       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.709662512065       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.710395284176       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.710422579480       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.710898820612       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.710335535963       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.709649507175       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.711357177353       residual = 9.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.708926656388       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.710683220186       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.710496829545       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.707884026283       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.708984427232       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.708468320437       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.711211120267       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.708826083821       residual = 7.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.712585974104       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.710648656105       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.710106637044       residual = 6.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.712423791184       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.713671076348       residual = 6.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.708149398464       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.724142018618       residual = 3.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.591503032911       residual = 8.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.705540139680       residual = 3.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.709397848149       residual = 2.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   55 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+11 is 5.911337e-15

solving harmonic davidson linear method for identity shift 4.0000e+11, overlap shift 4.0000e+12 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710039964375       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710039964375       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710039964375       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710039964377       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710039964182       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710039997054       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710096701409       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709297460062       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710348932941       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709020366476       residual = 7.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709566584070       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.709439212158       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.709996795997       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.710037791378       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.709253779016       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.708484512816       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.710307085067       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.706519445803       residual = 6.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.710049102794       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.710275516173       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.711524941109       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.712658345040       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.710962773662       residual = 5.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.709451084357       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.707704970825       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.711725208192       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.707043364260       residual = 4.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.712320873902       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.711488977537       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.708553608186       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.710379588326       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.703122314237       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.713332025090       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.706244385658       residual = 8.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.705085218299       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.710684901571       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.711141104889       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.706126064182       residual = 7.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.700017473632       residual = 5.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.717653969423       residual = 3.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.708705315756       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.708824912522       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.705563947933       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.710301867444       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.714477840526       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.703107190032       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.725302101558       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.708391300074       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.692335562855       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.684464340988       residual = 3.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.668328748800       residual = 2.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.724013999190       residual = 1.09e-01           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.720542759060       residual = 3.70e-01           smallest_sin_value = 9.91e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.670457336917       residual = 2.65e+00           smallest_sin_value = 9.90e-01
davidson iteration   54 stopping due to small subspace S singular value of 8.05e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+11 is 7.306320e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.838587 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0531e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.5001
    reference variance = 0.37894
====================================================
  Execution time = 4.4671e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0005e-01
  Total weights = 2.0000e+06
  Execution time = 3.8323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499992442085
                                         uncertainty =       0.004219423111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499992442085
                                         uncertainty =       0.004219423111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500026079
  error estimate for blocks of size 2^( 2) =       0.000526168290
  error estimate for blocks of size 2^( 3) =       0.000551210440
  error estimate for blocks of size 2^( 4) =       0.000569577415
  error estimate for blocks of size 2^( 5) =       0.000581355371
  error estimate for blocks of size 2^( 6) =       0.000588666982
  error estimate for blocks of size 2^( 7) =       0.000592110053

      target function =      -0.706932359693
              le_mean =     -22.426988015969
             les_mean =     503.469843377231
             stat err =       0.000582927455
             autocorr =       1.359075896104
   target nu stat err =       0.000582927455
   target dn stat err =       0.004033663094
      target stat err =       0.002965161491
              std dev =       0.707143662090
             le_variance =       0.500052158833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499992442085
                                         uncertainty =       0.004219423111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499992442085
                                         uncertainty =       0.004219423111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500026079
  error estimate for blocks of size 2^( 2) =       0.000526168290
  error estimate for blocks of size 2^( 3) =       0.000551210440
  error estimate for blocks of size 2^( 4) =       0.000569577415
  error estimate for blocks of size 2^( 5) =       0.000581355371
  error estimate for blocks of size 2^( 6) =       0.000588666982
  error estimate for blocks of size 2^( 7) =       0.000592110053

      target function =      -0.706932359693
              le_mean =     -22.426988015969
             les_mean =     503.469843377231
             stat err =       0.000582927455
             autocorr =       1.359075896104
   target nu stat err =       0.000582927455
   target dn stat err =       0.004033663094
      target stat err =       0.002965161491
              std dev =       0.707143662090
             le_variance =       0.500052158833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499992442085
                                         uncertainty =       0.004219423110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499992442085
                                         uncertainty =       0.004219423110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500026079
  error estimate for blocks of size 2^( 2) =       0.000526168290
  error estimate for blocks of size 2^( 3) =       0.000551210440
  error estimate for blocks of size 2^( 4) =       0.000569577415
  error estimate for blocks of size 2^( 5) =       0.000581355371
  error estimate for blocks of size 2^( 6) =       0.000588666982
  error estimate for blocks of size 2^( 7) =       0.000592110053

      target function =      -0.706932359693
              le_mean =     -22.426988015969
             les_mean =     503.469843377231
             stat err =       0.000582927455
             autocorr =       1.359075896104
   target nu stat err =       0.000582927455
   target dn stat err =       0.004033663094
      target stat err =       0.002965161491
              std dev =       0.707143662090
             le_variance =       0.500052158833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499992442085
                                         uncertainty =       0.004219423110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499992442085
                                         uncertainty =       0.004219423110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500026079
  error estimate for blocks of size 2^( 2) =       0.000526168290
  error estimate for blocks of size 2^( 3) =       0.000551210440
  error estimate for blocks of size 2^( 4) =       0.000569577415
  error estimate for blocks of size 2^( 5) =       0.000581355371
  error estimate for blocks of size 2^( 6) =       0.000588666982
  error estimate for blocks of size 2^( 7) =       0.000592110053

      target function =      -0.706932359693
              le_mean =     -22.426988015969
             les_mean =     503.469843377231
             stat err =       0.000582927455
             autocorr =       1.359075896104
   target nu stat err =       0.000582927455
   target dn stat err =       0.004033663094
      target stat err =       0.002965161491
              std dev =       0.707143662089
             le_variance =       0.500052158833


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706932359693        initial  <--
     2.5000e+10     2.5000e+11             2.8640e-14        -0.706932359693
     1.0000e+11     1.0000e+12             5.9113e-15        -0.706932359693
     4.0000e+11     4.0000e+12             7.3063e-16        -0.706932359693

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8192
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2436e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2422e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.4717
    reference variance = 0.52372
====================================================
  Execution time = 4.7716e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0077e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5259e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500840937800
                                         uncertainty =       0.003776600736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500840937800
                                         uncertainty =       0.003776600736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500382537
  error estimate for blocks of size 2^( 2) =       0.000526617760
  error estimate for blocks of size 2^( 3) =       0.000550507763
  error estimate for blocks of size 2^( 4) =       0.000569808289
  error estimate for blocks of size 2^( 5) =       0.000581935813
  error estimate for blocks of size 2^( 6) =       0.000588139112
  error estimate for blocks of size 2^( 7) =       0.000591976944

      target function =      -0.706424389449
              le_mean =     -22.426793175739
             les_mean =     503.461817263048
             stat err =       0.000582965040
             autocorr =       1.357315263401
   target nu stat err =       0.000582965040
   target dn stat err =       0.003809742111
      target stat err =       0.002802617711
              std dev =       0.707647769778
             le_variance =       0.500765366071


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242679317574e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+11, overlap shift 2.5000e+12 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706434517709       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706434517709       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706434517709       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706467879015       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706425488696       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.706475578533       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.706386598347       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.706163111234       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.706396766018       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.706423751249       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.706270060846       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.706111708451       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.706587966202       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.707248994651       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.706508750660       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.706660718342       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.706562985127       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.705964560826       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.707603928929       residual = 7.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.706430357065       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.706516443596       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.706121858471       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.707779271996       residual = 9.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.706063765688       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.704704055326       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.706324151488       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.707920172886       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.706789749749       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.707901596203       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.705435748756       residual = 4.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.705713435770       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.703664302793       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.705741678142       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.709370130498       residual = 4.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.711042608504       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.708350528037       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.702317538002       residual = 8.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.704282157570       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.703670096775       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.706663760328       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.705058364473       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.703456793919       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.705209942121       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.708694786112       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.712310472847       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.695444022405       residual = 6.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.697943041201       residual = 3.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.710392135304       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.733120491829       residual = 3.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.683836551601       residual = 3.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.745648313540       residual = 2.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.774922065887       residual = 3.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.824059594491       residual = 8.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.588788414352       residual = 1.18e+01           smallest_sin_value = 9.96e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.56e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+11 is 1.481547e-15

solving harmonic davidson linear method for identity shift 1.0000e+12, overlap shift 1.0000e+13 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706434517709       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706434517709       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706434517709       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706434517709       residual = 9.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706053156146       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.706434114164       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705920837512       residual = 6.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.706911365858       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.706167670482       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705689195206       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.706241215150       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.702498374988       residual = 8.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.705848921281       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.705198354647       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.707114365970       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.702201125716       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.706536914912       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.705274497893       residual = 9.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.704591499425       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.703777630166       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.707784200090       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.705185459356       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.708456487867       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.710671907777       residual = 9.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.708732260647       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.702611175192       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.704409484434       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.710157105225       residual = 7.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.704662033628       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.704955090942       residual = 4.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.703655030274       residual = 4.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.711312872644       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.716250267810       residual = 5.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.720929844781       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.710275333876       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.714342594790       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.703774579016       residual = 7.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.699408978103       residual = 3.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.707126785627       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.696692831945       residual = 7.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.706756690902       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.712742183811       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.709210113972       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.704239558322       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.725477226617       residual = 2.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.741492794498       residual = 6.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.997945179921       residual = 4.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.469754504295       residual = 2.94e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.508013318803       residual = 2.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -1.008640264920       residual = 6.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.628690271410       residual = 3.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =       0.439851009858       residual = 6.85e+02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.677028391931       residual = 3.74e+01           smallest_sin_value = 1.00e+00
davidson iteration   53 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+12 is 8.016777e-17

solving harmonic davidson linear method for identity shift 4.0000e+12, overlap shift 4.0000e+13 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706434517709       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706434517709       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.17e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.953184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3094e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.3595
    reference variance = 0.417733
====================================================
  Execution time = 4.6812e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0667e-01
  Total weights = 2.0000e+06
  Execution time = 3.8330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506797886483
                                         uncertainty =       0.010662409666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506797886483
                                         uncertainty =       0.010662409666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503321604
  error estimate for blocks of size 2^( 2) =       0.000529491506
  error estimate for blocks of size 2^( 3) =       0.000554007643
  error estimate for blocks of size 2^( 4) =       0.000572937835
  error estimate for blocks of size 2^( 5) =       0.000585446960
  error estimate for blocks of size 2^( 6) =       0.000589713803
  error estimate for blocks of size 2^( 7) =       0.000593853106

      target function =      -0.702161224782
              le_mean =     -22.426115037181
             les_mean =     503.437300681342
             stat err =       0.000585487926
             autocorr =       1.353146265204
   target nu stat err =       0.000585487926
   target dn stat err =       0.010202734297
      target stat err =       0.007264923967
              std dev =       0.711804238392
             le_variance =       0.506665273793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506797886483
                                         uncertainty =       0.010662409666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506797886483
                                         uncertainty =       0.010662409666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503321604
  error estimate for blocks of size 2^( 2) =       0.000529491506
  error estimate for blocks of size 2^( 3) =       0.000554007643
  error estimate for blocks of size 2^( 4) =       0.000572937835
  error estimate for blocks of size 2^( 5) =       0.000585446960
  error estimate for blocks of size 2^( 6) =       0.000589713803
  error estimate for blocks of size 2^( 7) =       0.000593853106

      target function =      -0.702161224782
              le_mean =     -22.426115037181
             les_mean =     503.437300681342
             stat err =       0.000585487926
             autocorr =       1.353146265204
   target nu stat err =       0.000585487926
   target dn stat err =       0.010202734297
      target stat err =       0.007264923967
              std dev =       0.711804238392
             le_variance =       0.506665273793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506797886483
                                         uncertainty =       0.010662409666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506797886483
                                         uncertainty =       0.010662409666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503321604
  error estimate for blocks of size 2^( 2) =       0.000529491506
  error estimate for blocks of size 2^( 3) =       0.000554007643
  error estimate for blocks of size 2^( 4) =       0.000572937835
  error estimate for blocks of size 2^( 5) =       0.000585446960
  error estimate for blocks of size 2^( 6) =       0.000589713803
  error estimate for blocks of size 2^( 7) =       0.000593853106

      target function =      -0.702161224782
              le_mean =     -22.426115037181
             les_mean =     503.437300681342
             stat err =       0.000585487926
             autocorr =       1.353146265204
   target nu stat err =       0.000585487926
   target dn stat err =       0.010202734297
      target stat err =       0.007264923967
              std dev =       0.711804238392
             le_variance =       0.506665273793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506797886483
                                         uncertainty =       0.010662409666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506797886483
                                         uncertainty =       0.010662409666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503321604
  error estimate for blocks of size 2^( 2) =       0.000529491506
  error estimate for blocks of size 2^( 3) =       0.000554007643
  error estimate for blocks of size 2^( 4) =       0.000572937835
  error estimate for blocks of size 2^( 5) =       0.000585446960
  error estimate for blocks of size 2^( 6) =       0.000589713803
  error estimate for blocks of size 2^( 7) =       0.000593853106

      target function =      -0.702161224782
              le_mean =     -22.426115037181
             les_mean =     503.437300681342
             stat err =       0.000585487926
             autocorr =       1.353146265204
   target nu stat err =       0.000585487926
   target dn stat err =       0.010202734297
      target stat err =       0.007264923967
              std dev =       0.711804238392
             le_variance =       0.506665273793


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.702161224782        initial  <--
     2.5000e+11     2.5000e+12             1.4815e-15        -0.702161224782
     1.0000e+12     1.0000e+13             8.0168e-17        -0.702161224782
     4.0000e+12     4.0000e+13             0.0000e+00        -0.702161224782

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.0067
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2911e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2422e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.3873
    reference variance = 0.307857
====================================================
  Execution time = 4.5899e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0416e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5101e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504164976551
                                         uncertainty =       0.005297012994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504164976551
                                         uncertainty =       0.005297012994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502077000
  error estimate for blocks of size 2^( 2) =       0.000528163295
  error estimate for blocks of size 2^( 3) =       0.000553512746
  error estimate for blocks of size 2^( 4) =       0.000573298373
  error estimate for blocks of size 2^( 5) =       0.000586520656
  error estimate for blocks of size 2^( 6) =       0.000594371868
  error estimate for blocks of size 2^( 7) =       0.000597706868

      target function =      -0.703979872611
              le_mean =     -22.426811120920
             les_mean =     503.466019428957
             stat err =       0.000587974441
             autocorr =       1.371438200711
   target nu stat err =       0.000587974441
   target dn stat err =       0.005300823797
      target stat err =       0.003831654916
              std dev =       0.710044102587
             le_variance =       0.504162627618


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242681112092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+12, overlap shift 2.5000e+13 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.703999952421       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.703999952421       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.703999952421       residual = 6.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.704708194280       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705667192708       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.703856121434       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.703937707224       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705114099770       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.701291102203       residual = 9.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.701089633285       residual = 6.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709339899849       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.702878322271       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.707579254179       residual = 9.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.700675952703       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.694383742198       residual = 4.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.702487251129       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.704403841911       residual = 8.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.698265622164       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.703571948994       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.699480460514       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.710709186529       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.709592557494       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.713998222217       residual = 5.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.705386392184       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.677828639718       residual = 3.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.714916956277       residual = 6.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.701677969340       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.713675699636       residual = 5.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.688394561503       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.698662124354       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.726203764821       residual = 2.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.698461542841       residual = 2.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.701966045692       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.684837549250       residual = 1.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.716629556213       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.693848806774       residual = 7.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.690661108877       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.713365287770       residual = 5.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.726689557972       residual = 2.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.709045265966       residual = 2.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.665864748470       residual = 7.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.685493524479       residual = 1.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.656797427491       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.671151205957       residual = 6.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.705950927182       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745668210355       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.826342200495       residual = 8.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.730020635912       residual = 4.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.134870772479       residual = 1.02e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.896543478794       residual = 2.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.720510573685       residual = 4.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.526773575217       residual = 2.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =       0.250762519617       residual = 5.11e+02           smallest_sin_value = 9.97e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.62e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+12 is 5.583135e-17

solving harmonic davidson linear method for identity shift 1.0000e+13, overlap shift 1.0000e+14 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.703999952421       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.703999952421       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.703999952421       residual = 5.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.703917007158       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.704373302561       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.701244338958       residual = 6.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.684870180370       residual = 1.69e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.698422330538       residual = 4.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.727536786200       residual = 2.89e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713184745056       residual = 7.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.704263327469       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.709084892735       residual = 2.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.706458489173       residual = 3.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.712782337333       residual = 5.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.720491079768       residual = 2.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.695188859001       residual = 9.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.776021796814       residual = 2.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.679695852184       residual = 3.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.684091077833       residual = 2.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.705800733916       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.685683056000       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.683423114611       residual = 4.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.735837671666       residual = 1.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.641960426379       residual = 2.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.878563289149       residual = 1.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.637447054545       residual = 2.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.640431448884       residual = 2.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.730337347165       residual = 5.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.677613842398       residual = 3.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.766154058114       residual = 2.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.705650905427       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.624867668811       residual = 3.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.729788493018       residual = 7.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.698214954893       residual = 2.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.543690842953       residual = 1.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.665076598013       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.683043053612       residual = 6.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.644846883722       residual = 2.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.535900977107       residual = 1.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.728781189873       residual = 4.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.370120735937       residual = 5.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.682519658278       residual = 3.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.662288324814       residual = 3.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.915134338913       residual = 2.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.632514060001       residual = 4.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -1.043015498478       residual = 6.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.202573260524       residual = 1.41e+02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -1.221223988138       residual = 1.51e+02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -2.015741538300       residual = 9.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.484862433340       residual = 6.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.340384111857       residual = 3.70e+02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -1.236555646075       residual = 4.85e+02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =       2.381712615883       residual = 5.71e+03           smallest_sin_value = 1.00e+00
davidson iteration   53 stopping due to small subspace S singular value of 9.52e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+13 is 1.420674e-17

solving harmonic davidson linear method for identity shift 4.0000e+13, overlap shift 4.0000e+14 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.703999952421       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.703999952421       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.703999952421       residual = 5.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.703999952421       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.703999951568       residual = 4.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.703507227497       residual = 8.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.682560943812       residual = 2.43e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.826562842172       residual = 7.52e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.704866096150       residual = 4.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746001850662       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.708312893657       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748725923864       residual = 2.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.732442065032       residual = 7.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.710099205574       residual = 7.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.672988699718       residual = 9.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.721344525197       residual = 1.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.736124041732       residual = 1.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.756344321021       residual = 3.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.688582389116       residual = 1.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.650371279254       residual = 1.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.627486026394       residual = 2.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.610695082748       residual = 9.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.828143260977       residual = 8.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.465953911007       residual = 2.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.102747756152       residual = 8.66e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.867164129526       residual = 1.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.790965683097       residual = 5.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.629473647964       residual = 3.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.642556382748       residual = 3.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.618978642031       residual = 4.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.578629927371       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.539810187990       residual = 1.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.798503155589       residual = 5.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.050897246511       residual = 5.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.632506800903       residual = 5.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.219664100668       residual = 1.41e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.080210210463       residual = 6.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.744729254937       residual = 3.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.698144705103       residual = 3.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.334322643594       residual = 1.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.090231645639       residual = 8.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.007800411043       residual = 4.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.000556187439       residual = 4.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.159616488838       residual = 1.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =       0.258617122911       residual = 4.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.003322162305       residual = 3.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -1.281805960307       residual = 1.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -3.005437194793       residual = 2.72e+03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -3.359838395504       residual = 5.43e+03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -5.243322439461       residual = 1.15e+04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -3.438972051064       residual = 3.87e+03           smallest_sin_value = 1.00e+00
davidson iteration   51 stopping due to too large eigenvalue change
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+13 is 3.269130e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.113750 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1166e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.385
    reference variance = 0.467648
====================================================
  Execution time = 4.4792e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2425e+01
  VMC Evar = 4.9714e-01
  Total weights = 2.0000e+06
  Execution time = 3.8182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497207817825
                                         uncertainty =       0.004247480099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497207817825
                                         uncertainty =       0.004247480099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498569757
  error estimate for blocks of size 2^( 2) =       0.000524922839
  error estimate for blocks of size 2^( 3) =       0.000550098487
  error estimate for blocks of size 2^( 4) =       0.000569009690
  error estimate for blocks of size 2^( 5) =       0.000581887345
  error estimate for blocks of size 2^( 6) =       0.000587581867
  error estimate for blocks of size 2^( 7) =       0.000593196038

      target function =      -0.709061333402
              le_mean =     -22.424859384115
             les_mean =     503.371461753125
             stat err =       0.000582918735
             autocorr =       1.366986314325
   target nu stat err =       0.000582918735
   target dn stat err =       0.004581361236
      target stat err =       0.003362163875
              std dev =       0.705084111542
             le_variance =       0.497143604349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497207817825
                                         uncertainty =       0.004247480099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497207817825
                                         uncertainty =       0.004247480099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498569757
  error estimate for blocks of size 2^( 2) =       0.000524922839
  error estimate for blocks of size 2^( 3) =       0.000550098487
  error estimate for blocks of size 2^( 4) =       0.000569009690
  error estimate for blocks of size 2^( 5) =       0.000581887345
  error estimate for blocks of size 2^( 6) =       0.000587581867
  error estimate for blocks of size 2^( 7) =       0.000593196038

      target function =      -0.709061333402
              le_mean =     -22.424859384115
             les_mean =     503.371461753125
             stat err =       0.000582918735
             autocorr =       1.366986314325
   target nu stat err =       0.000582918735
   target dn stat err =       0.004581361236
      target stat err =       0.003362163875
              std dev =       0.705084111542
             le_variance =       0.497143604350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497207817825
                                         uncertainty =       0.004247480099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497207817825
                                         uncertainty =       0.004247480099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498569757
  error estimate for blocks of size 2^( 2) =       0.000524922839
  error estimate for blocks of size 2^( 3) =       0.000550098487
  error estimate for blocks of size 2^( 4) =       0.000569009690
  error estimate for blocks of size 2^( 5) =       0.000581887345
  error estimate for blocks of size 2^( 6) =       0.000587581867
  error estimate for blocks of size 2^( 7) =       0.000593196038

      target function =      -0.709061333402
              le_mean =     -22.424859384115
             les_mean =     503.371461753125
             stat err =       0.000582918735
             autocorr =       1.366986314325
   target nu stat err =       0.000582918735
   target dn stat err =       0.004581361236
      target stat err =       0.003362163875
              std dev =       0.705084111542
             le_variance =       0.497143604350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497207817825
                                         uncertainty =       0.004247480099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497207817825
                                         uncertainty =       0.004247480099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498569757
  error estimate for blocks of size 2^( 2) =       0.000524922839
  error estimate for blocks of size 2^( 3) =       0.000550098487
  error estimate for blocks of size 2^( 4) =       0.000569009690
  error estimate for blocks of size 2^( 5) =       0.000581887345
  error estimate for blocks of size 2^( 6) =       0.000587581867
  error estimate for blocks of size 2^( 7) =       0.000593196038

      target function =      -0.709061333402
              le_mean =     -22.424859384115
             les_mean =     503.371461753125
             stat err =       0.000582918735
             autocorr =       1.366986314325
   target nu stat err =       0.000582918735
   target dn stat err =       0.004581361236
      target stat err =       0.003362163875
              std dev =       0.705084111542
             le_variance =       0.497143604349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.709061333402        initial
     2.5000e+12     2.5000e+13             5.5831e-17        -0.709061333402
     1.0000e+13     1.0000e+14             1.4207e-17        -0.709061333402
     4.0000e+13     4.0000e+14             3.2691e-18        -0.709061333402  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+13     and shift_s =   4.0000e+14
*****************************************************************************

  Execution time = 6.3918e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2509e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2419e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.5012
    reference variance = 0.218023
====================================================
  Execution time = 4.5386e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9592e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5114e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495899462948
                                         uncertainty =       0.003069918290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495899462948
                                         uncertainty =       0.003069918290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497955803
  error estimate for blocks of size 2^( 2) =       0.000524218672
  error estimate for blocks of size 2^( 3) =       0.000549568614
  error estimate for blocks of size 2^( 4) =       0.000568862665
  error estimate for blocks of size 2^( 5) =       0.000579768130
  error estimate for blocks of size 2^( 6) =       0.000585584517
  error estimate for blocks of size 2^( 7) =       0.000587507420

      target function =      -0.709941021715
              le_mean =     -22.425909967866
             les_mean =     503.417357601505
             stat err =       0.000580430683
             autocorr =       1.358686090880
   target nu stat err =       0.000580430683
   target dn stat err =       0.003179772322
      target stat err =       0.002381043619
              std dev =       0.704215849472
             le_variance =       0.495919962648


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242590996787e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+13, overlap shift 1.0000e+14 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709948017598       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709948017598       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709948017598       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710949498499       residual = 4.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707678681281       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705216580847       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713591807363       residual = 2.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.719860405665       residual = 9.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.719291983256       residual = 1.86e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710552129332       residual = 1.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.718310397043       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.695802547597       residual = 1.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.702028987938       residual = 7.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.705731187730       residual = 6.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740265624809       residual = 5.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.671012942084       residual = 7.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.652450420024       residual = 1.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.729639230776       residual = 2.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.631023382392       residual = 3.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.816062725538       residual = 5.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.658127353182       residual = 1.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.652691478434       residual = 1.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.699429215927       residual = 1.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.720841294395       residual = 8.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745562095973       residual = 6.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.682639236480       residual = 5.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.680394849095       residual = 4.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.735889919169       residual = 3.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.676373016757       residual = 1.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.649683044078       residual = 1.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.791645463787       residual = 3.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.688619828178       residual = 7.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.694738809206       residual = 2.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.630185217818       residual = 3.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.572617634290       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.824785917357       residual = 9.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.779149928708       residual = 2.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.520244256304       residual = 1.97e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.762195935983       residual = 1.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746646280964       residual = 1.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.717671009693       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.946669736091       residual = 2.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.569101879748       residual = 1.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.617448804107       residual = 8.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.717071599495       residual = 8.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.959670379822       residual = 3.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.793930264641       residual = 5.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.253689001224       residual = 1.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.325949069239       residual = 7.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.295938921076       residual = 8.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =       4.257405257700       residual = 1.27e+04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -4.901156269864       residual = 1.46e+04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -1.217149159080       residual = 2.01e+03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -2.786459447529       residual = 4.25e+03           smallest_sin_value = 9.98e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.70e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+13 is 3.578262e-18

solving harmonic davidson linear method for identity shift 4.0000e+13, overlap shift 4.0000e+14 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709948017598       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709948017598       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709948017598       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709948017598       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709948016972       residual = 3.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.681554266620       residual = 9.54e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711424756382       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.719732800652       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.720622624595       residual = 2.70e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.644028549149       residual = 2.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747356549890       residual = 2.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.657166794486       residual = 2.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.703290773943       residual = 8.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.632002955389       residual = 3.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906477933006       residual = 1.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.627501249739       residual = 4.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.643082664566       residual = 2.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.699556825775       residual = 1.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.907359959937       residual = 2.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.668563814102       residual = 9.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.834280782135       residual = 9.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.410016832100       residual = 5.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.653564314166       residual = 8.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.624370760495       residual = 5.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.685779796437       residual = 2.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.843922416502       residual = 8.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.751963366295       residual = 1.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.434460736462       residual = 3.99e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.275156287924       residual = 9.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       0.335991332048       residual = 5.78e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.637434744314       residual = 3.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.261591011564       residual = 9.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.286996621017       residual = 9.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.821871408799       residual = 1.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.586937527001       residual = 1.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.752610355453       residual = 4.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.416402459145       residual = 4.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.822043798171       residual = 7.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.920108392014       residual = 2.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.396555225515       residual = 2.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.271852927365       residual = 1.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.607703499353       residual = 2.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.111927978772       residual = 1.76e+02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.501740387267       residual = 3.47e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.655685837658       residual = 3.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.706781137771       residual = 1.94e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.744426827188       residual = 4.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =       0.392193984936       residual = 6.41e+02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -2.295693528698       residual = 1.25e+03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =       1.889180067040       residual = 3.17e+03           smallest_sin_value = 9.97e-01
davidson iteration   50:   krylov dim =  51   tar_fn =       8.471274209652       residual = 4.39e+04           smallest_sin_value = 9.92e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+13 is 1.243054e-18

solving harmonic davidson linear method for identity shift 1.6000e+14, overlap shift 1.6000e+15 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709948017598       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709948017598       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709948017598       residual = 3.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.693061936784       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.782986302082       residual = 3.34e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736573682957       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653558230907       residual = 1.62e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.856412472525       residual = 1.13e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.828540532793       residual = 6.11e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655693413260       residual = 1.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923294954285       residual = 3.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.664490601673       residual = 4.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.993157277077       residual = 4.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.796305248997       residual = 1.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.805576531059       residual = 2.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.519803331961       residual = 4.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -1.165806852861       residual = 1.12e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.564192787547       residual = 2.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -1.112290261560       residual = 9.44e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.008706327668       residual = 5.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.517863596929       residual = 3.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.139213332616       residual = 1.07e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.940309344372       residual = 8.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =       0.403759898905       residual = 6.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.737842340383       residual = 1.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.780757128834       residual = 6.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.425740469082       residual = 5.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.938195730190       residual = 7.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =       0.851914622996       residual = 1.30e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.209721363767       residual = 1.48e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       0.300129994105       residual = 5.48e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.412877269980       residual = 5.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.022590010995       residual = 2.67e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.021149927196       residual = 6.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.826146355097       residual = 5.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       1.600419804347       residual = 2.85e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =       1.059486359020       residual = 1.59e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       1.726221027352       residual = 3.50e+03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.458824904272       residual = 5.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.108056501568       residual = 2.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =       0.971793546596       residual = 1.72e+03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.930278847302       residual = 7.98e+02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =       0.719149505083       residual = 1.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =       8.542158988882       residual = 4.99e+04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =       0.328836529953       residual = 2.92e+03           smallest_sin_value = 1.00e+00
davidson iteration   45 stopping due to too large eigenvalue change
davidson solver did not converge after         45 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+14 is 2.236414e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.257182 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0648e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.4528
    reference variance = 0.52893
====================================================
  Execution time = 4.6944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2425e+01
  VMC Evar = 4.9484e-01
  Total weights = 2.0000e+06
  Execution time = 3.8124e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494921805003
                                         uncertainty =       0.003152016152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494921805003
                                         uncertainty =       0.003152016152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497410930
  error estimate for blocks of size 2^( 2) =       0.000523532137
  error estimate for blocks of size 2^( 3) =       0.000548065283
  error estimate for blocks of size 2^( 4) =       0.000567504288
  error estimate for blocks of size 2^( 5) =       0.000579684933
  error estimate for blocks of size 2^( 6) =       0.000585533888
  error estimate for blocks of size 2^( 7) =       0.000590831364

      target function =      -0.710736409550
              le_mean =     -22.425238134353
             les_mean =     503.386140400800
             stat err =       0.000580888618
             autocorr =       1.363813818820
   target nu stat err =       0.000580888618
   target dn stat err =       0.003177098781
      target stat err =       0.002382148383
              std dev =       0.703445282715
             le_variance =       0.494835265774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494921805003
                                         uncertainty =       0.003152016152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494921805003
                                         uncertainty =       0.003152016152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497410930
  error estimate for blocks of size 2^( 2) =       0.000523532137
  error estimate for blocks of size 2^( 3) =       0.000548065283
  error estimate for blocks of size 2^( 4) =       0.000567504288
  error estimate for blocks of size 2^( 5) =       0.000579684933
  error estimate for blocks of size 2^( 6) =       0.000585533888
  error estimate for blocks of size 2^( 7) =       0.000590831364

      target function =      -0.710736409550
              le_mean =     -22.425238134353
             les_mean =     503.386140400800
             stat err =       0.000580888618
             autocorr =       1.363813818818
   target nu stat err =       0.000580888618
   target dn stat err =       0.003177098781
      target stat err =       0.002382148383
              std dev =       0.703445282715
             le_variance =       0.494835265774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494921805003
                                         uncertainty =       0.003152016152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494921805003
                                         uncertainty =       0.003152016152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497410930
  error estimate for blocks of size 2^( 2) =       0.000523532137
  error estimate for blocks of size 2^( 3) =       0.000548065283
  error estimate for blocks of size 2^( 4) =       0.000567504288
  error estimate for blocks of size 2^( 5) =       0.000579684933
  error estimate for blocks of size 2^( 6) =       0.000585533888
  error estimate for blocks of size 2^( 7) =       0.000590831364

      target function =      -0.710736409550
              le_mean =     -22.425238134353
             les_mean =     503.386140400800
             stat err =       0.000580888618
             autocorr =       1.363813818818
   target nu stat err =       0.000580888618
   target dn stat err =       0.003177098781
      target stat err =       0.002382148383
              std dev =       0.703445282715
             le_variance =       0.494835265774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494921805003
                                         uncertainty =       0.003152016152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494921805003
                                         uncertainty =       0.003152016152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497410930
  error estimate for blocks of size 2^( 2) =       0.000523532137
  error estimate for blocks of size 2^( 3) =       0.000548065283
  error estimate for blocks of size 2^( 4) =       0.000567504288
  error estimate for blocks of size 2^( 5) =       0.000579684933
  error estimate for blocks of size 2^( 6) =       0.000585533888
  error estimate for blocks of size 2^( 7) =       0.000590831364

      target function =      -0.710736409550
              le_mean =     -22.425238134353
             les_mean =     503.386140400800
             stat err =       0.000580888618
             autocorr =       1.363813818818
   target nu stat err =       0.000580888618
   target dn stat err =       0.003177098781
      target stat err =       0.002382148383
              std dev =       0.703445282715
             le_variance =       0.494835265774


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.710736409550        initial  <--
     1.0000e+13     1.0000e+14             3.5783e-18        -0.710736409550
     4.0000e+13     4.0000e+14             1.2431e-18        -0.710736409550
     1.6000e+14     1.6000e+15             2.2364e-19        -0.710736409550

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.0398
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2670e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2423e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.515
    reference variance = 0.408509
====================================================
  Execution time = 4.7514e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9667e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5278e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496616639316
                                         uncertainty =       0.003262467833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496616639316
                                         uncertainty =       0.003262467833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498330457
  error estimate for blocks of size 2^( 2) =       0.000524439863
  error estimate for blocks of size 2^( 3) =       0.000549928872
  error estimate for blocks of size 2^( 4) =       0.000569344669
  error estimate for blocks of size 2^( 5) =       0.000580559901
  error estimate for blocks of size 2^( 6) =       0.000586978223
  error estimate for blocks of size 2^( 7) =       0.000590584061

      target function =      -0.709397495180
              le_mean =     -22.425967721047
             les_mean =     503.420694466261
             stat err =       0.000581866713
             autocorr =       1.363365073300
   target nu stat err =       0.000581866713
   target dn stat err =       0.003504493804
      target stat err =       0.002606444099
              std dev =       0.704745691109
             le_variance =       0.496666489137


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242596772105e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+14, overlap shift 1.0000e+15 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709406203795       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709406203795       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 9.36e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 4.0000e+14, overlap shift 4.0000e+15 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709406203795       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709406203795       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 9.36e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.6000e+15, overlap shift 1.6000e+16 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709406203795       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709406203795       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.258249 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2799e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.411
    reference variance = 0.387517
====================================================
  Execution time = 4.5490e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2425e+01
  VMC Evar = 4.9543e-01
  Total weights = 2.0000e+06
  Execution time = 3.8026e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495374555396
                                         uncertainty =       0.002822699327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495374555396
                                         uncertainty =       0.002822699327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497709678
  error estimate for blocks of size 2^( 2) =       0.000524164988
  error estimate for blocks of size 2^( 3) =       0.000549512243
  error estimate for blocks of size 2^( 4) =       0.000568366423
  error estimate for blocks of size 2^( 5) =       0.000580342679
  error estimate for blocks of size 2^( 6) =       0.000588253675
  error estimate for blocks of size 2^( 7) =       0.000592551949

      target function =      -0.710302414700
              le_mean =     -22.425458869367
             les_mean =     503.396635100440
             stat err =       0.000582378681
             autocorr =       1.369174388679
   target nu stat err =       0.000582378681
   target dn stat err =       0.003160963666
      target stat err =       0.002369132107
              std dev =       0.703867776286
             le_variance =       0.495429846494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495374555396
                                         uncertainty =       0.002822699327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495374555396
                                         uncertainty =       0.002822699327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497709678
  error estimate for blocks of size 2^( 2) =       0.000524164988
  error estimate for blocks of size 2^( 3) =       0.000549512243
  error estimate for blocks of size 2^( 4) =       0.000568366423
  error estimate for blocks of size 2^( 5) =       0.000580342679
  error estimate for blocks of size 2^( 6) =       0.000588253675
  error estimate for blocks of size 2^( 7) =       0.000592551949

      target function =      -0.710302414700
              le_mean =     -22.425458869367
             les_mean =     503.396635100440
             stat err =       0.000582378681
             autocorr =       1.369174388679
   target nu stat err =       0.000582378681
   target dn stat err =       0.003160963666
      target stat err =       0.002369132107
              std dev =       0.703867776286
             le_variance =       0.495429846494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495374555396
                                         uncertainty =       0.002822699327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495374555396
                                         uncertainty =       0.002822699327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497709678
  error estimate for blocks of size 2^( 2) =       0.000524164988
  error estimate for blocks of size 2^( 3) =       0.000549512243
  error estimate for blocks of size 2^( 4) =       0.000568366423
  error estimate for blocks of size 2^( 5) =       0.000580342679
  error estimate for blocks of size 2^( 6) =       0.000588253675
  error estimate for blocks of size 2^( 7) =       0.000592551949

      target function =      -0.710302414700
              le_mean =     -22.425458869367
             les_mean =     503.396635100440
             stat err =       0.000582378681
             autocorr =       1.369174388679
   target nu stat err =       0.000582378681
   target dn stat err =       0.003160963666
      target stat err =       0.002369132107
              std dev =       0.703867776286
             le_variance =       0.495429846494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495374555396
                                         uncertainty =       0.002822699327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495374555396
                                         uncertainty =       0.002822699327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497709678
  error estimate for blocks of size 2^( 2) =       0.000524164988
  error estimate for blocks of size 2^( 3) =       0.000549512243
  error estimate for blocks of size 2^( 4) =       0.000568366423
  error estimate for blocks of size 2^( 5) =       0.000580342679
  error estimate for blocks of size 2^( 6) =       0.000588253675
  error estimate for blocks of size 2^( 7) =       0.000592551949

      target function =      -0.710302414700
              le_mean =     -22.425458869367
             les_mean =     503.396635100440
             stat err =       0.000582378681
             autocorr =       1.369174388679
   target nu stat err =       0.000582378681
   target dn stat err =       0.003160963666
      target stat err =       0.002369132107
              std dev =       0.703867776286
             le_variance =       0.495429846494


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.710302414700        initial  <--
     1.0000e+14     1.0000e+15             0.0000e+00        -0.710302414700
     4.0000e+14     4.0000e+15             0.0000e+00        -0.710302414700
     1.6000e+15     1.6000e+16             0.0000e+00        -0.710302414700

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.5387
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2735e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2426e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.3509
    reference variance = 0.296951
====================================================
  Execution time = 4.5018e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.8928e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5293e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489232604092
                                         uncertainty =       0.002421662300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489232604092
                                         uncertainty =       0.002421662300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494612125
  error estimate for blocks of size 2^( 2) =       0.000521292875
  error estimate for blocks of size 2^( 3) =       0.000546704495
  error estimate for blocks of size 2^( 4) =       0.000566091789
  error estimate for blocks of size 2^( 5) =       0.000577362350
  error estimate for blocks of size 2^( 6) =       0.000585203710
  error estimate for blocks of size 2^( 7) =       0.000588521034

      target function =      -0.714789871876
              le_mean =     -22.425947844774
             les_mean =     503.412418800615
             stat err =       0.000579294721
             autocorr =       1.371733118755
   target nu stat err =       0.000579294721
   target dn stat err =       0.002589573781
      target stat err =       0.001994911222
              std dev =       0.699487175520
             le_variance =       0.489282308717


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242594784477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+15, overlap shift 1.0000e+16 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714794442659       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714794442659       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 4.0000e+15, overlap shift 4.0000e+16 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714794442659       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714794442659       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.6000e+16, overlap shift 1.6000e+17 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714794442659       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714794442659       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.259317 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0318e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.4875
    reference variance = 1.34321
====================================================
  Execution time = 4.5003e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.1207e-01
  Total weights = 2.0000e+06
  Execution time = 3.8125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511903831058
                                         uncertainty =       0.009240731238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511903831058
                                         uncertainty =       0.009240731238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505999139
  error estimate for blocks of size 2^( 2) =       0.000531692840
  error estimate for blocks of size 2^( 3) =       0.000556861154
  error estimate for blocks of size 2^( 4) =       0.000574862092
  error estimate for blocks of size 2^( 5) =       0.000586888940
  error estimate for blocks of size 2^( 6) =       0.000593885539
  error estimate for blocks of size 2^( 7) =       0.000599053771

      target function =      -0.698357855486
              le_mean =     -22.426022431059
             les_mean =     503.438552080171
             stat err =       0.000588672585
             autocorr =       1.353468229656
   target nu stat err =       0.000588672585
   target dn stat err =       0.009631354417
      target stat err =       0.006786286542
              std dev =       0.715590845286
             le_variance =       0.512070257858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511903831058
                                         uncertainty =       0.009240731238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511903831058
                                         uncertainty =       0.009240731238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505999139
  error estimate for blocks of size 2^( 2) =       0.000531692840
  error estimate for blocks of size 2^( 3) =       0.000556861154
  error estimate for blocks of size 2^( 4) =       0.000574862092
  error estimate for blocks of size 2^( 5) =       0.000586888940
  error estimate for blocks of size 2^( 6) =       0.000593885539
  error estimate for blocks of size 2^( 7) =       0.000599053771

      target function =      -0.698357855486
              le_mean =     -22.426022431059
             les_mean =     503.438552080171
             stat err =       0.000588672585
             autocorr =       1.353468229656
   target nu stat err =       0.000588672585
   target dn stat err =       0.009631354417
      target stat err =       0.006786286542
              std dev =       0.715590845286
             le_variance =       0.512070257858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511903831058
                                         uncertainty =       0.009240731238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511903831058
                                         uncertainty =       0.009240731238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505999139
  error estimate for blocks of size 2^( 2) =       0.000531692840
  error estimate for blocks of size 2^( 3) =       0.000556861154
  error estimate for blocks of size 2^( 4) =       0.000574862092
  error estimate for blocks of size 2^( 5) =       0.000586888940
  error estimate for blocks of size 2^( 6) =       0.000593885539
  error estimate for blocks of size 2^( 7) =       0.000599053771

      target function =      -0.698357855486
              le_mean =     -22.426022431059
             les_mean =     503.438552080171
             stat err =       0.000588672585
             autocorr =       1.353468229656
   target nu stat err =       0.000588672585
   target dn stat err =       0.009631354417
      target stat err =       0.006786286542
              std dev =       0.715590845286
             le_variance =       0.512070257858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511903831058
                                         uncertainty =       0.009240731238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511903831058
                                         uncertainty =       0.009240731238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505999139
  error estimate for blocks of size 2^( 2) =       0.000531692840
  error estimate for blocks of size 2^( 3) =       0.000556861154
  error estimate for blocks of size 2^( 4) =       0.000574862092
  error estimate for blocks of size 2^( 5) =       0.000586888940
  error estimate for blocks of size 2^( 6) =       0.000593885539
  error estimate for blocks of size 2^( 7) =       0.000599053771

      target function =      -0.698357855486
              le_mean =     -22.426022431059
             les_mean =     503.438552080171
             stat err =       0.000588672585
             autocorr =       1.353468229656
   target nu stat err =       0.000588672585
   target dn stat err =       0.009631354417
      target stat err =       0.006786286542
              std dev =       0.715590845286
             le_variance =       0.512070257858


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.698357855486        initial  <--
     1.0000e+15     1.0000e+16             0.0000e+00        -0.698357855486
     4.0000e+15     4.0000e+16             0.0000e+00        -0.698357855486
     1.6000e+16     1.6000e+17             0.0000e+00        -0.698357855486

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0973
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2442e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2425e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.4191
    reference variance = 0.387154
====================================================
  Execution time = 4.7409e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9981e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5309e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499827549498
                                         uncertainty =       0.003953354003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499827549498
                                         uncertainty =       0.003953354003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499904430
  error estimate for blocks of size 2^( 2) =       0.000526408170
  error estimate for blocks of size 2^( 3) =       0.000551420461
  error estimate for blocks of size 2^( 4) =       0.000570849514
  error estimate for blocks of size 2^( 5) =       0.000583422156
  error estimate for blocks of size 2^( 6) =       0.000591607173
  error estimate for blocks of size 2^( 7) =       0.000593956623

      target function =      -0.707134672477
              le_mean =     -22.425567271544
             les_mean =     503.405876078217
             stat err =       0.000584958866
             autocorr =       1.369230882880
   target nu stat err =       0.000584958866
   target dn stat err =       0.003761233992
      target stat err =       0.002769528022
              std dev =       0.706971624316
             le_variance =       0.499808877589


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242556727154e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+16, overlap shift 1.0000e+17 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707144698738       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707144698738       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.37e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 4.0000e+16, overlap shift 4.0000e+17 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707144698738       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707144698738       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.37e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.6000e+17, overlap shift 1.6000e+18 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707144698738       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707144698738       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.37e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+17 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.260386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2725e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.3815
    reference variance = 0.394496
====================================================
  Execution time = 4.4980e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0149e-01
  Total weights = 2.0000e+06
  Execution time = 3.8159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501450829942
                                         uncertainty =       0.004160010891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501450829942
                                         uncertainty =       0.004160010891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500745264
  error estimate for blocks of size 2^( 2) =       0.000526957947
  error estimate for blocks of size 2^( 3) =       0.000552057886
  error estimate for blocks of size 2^( 4) =       0.000571091380
  error estimate for blocks of size 2^( 5) =       0.000583372721
  error estimate for blocks of size 2^( 6) =       0.000589597688
  error estimate for blocks of size 2^( 7) =       0.000594948552

      target function =      -0.705917448914
              le_mean =     -22.426022624568
             les_mean =     503.427982145655
             stat err =       0.000584752585
             autocorr =       1.363674125487
   target nu stat err =       0.000584752585
   target dn stat err =       0.003866442375
      target stat err =       0.002835717303
              std dev =       0.708160743589
             le_variance =       0.501491638760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501450829942
                                         uncertainty =       0.004160010891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501450829942
                                         uncertainty =       0.004160010891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500745264
  error estimate for blocks of size 2^( 2) =       0.000526957947
  error estimate for blocks of size 2^( 3) =       0.000552057886
  error estimate for blocks of size 2^( 4) =       0.000571091380
  error estimate for blocks of size 2^( 5) =       0.000583372721
  error estimate for blocks of size 2^( 6) =       0.000589597688
  error estimate for blocks of size 2^( 7) =       0.000594948552

      target function =      -0.705917448914
              le_mean =     -22.426022624568
             les_mean =     503.427982145655
             stat err =       0.000584752585
             autocorr =       1.363674125487
   target nu stat err =       0.000584752585
   target dn stat err =       0.003866442375
      target stat err =       0.002835717303
              std dev =       0.708160743589
             le_variance =       0.501491638760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501450829942
                                         uncertainty =       0.004160010891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501450829942
                                         uncertainty =       0.004160010891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500745264
  error estimate for blocks of size 2^( 2) =       0.000526957947
  error estimate for blocks of size 2^( 3) =       0.000552057886
  error estimate for blocks of size 2^( 4) =       0.000571091380
  error estimate for blocks of size 2^( 5) =       0.000583372721
  error estimate for blocks of size 2^( 6) =       0.000589597688
  error estimate for blocks of size 2^( 7) =       0.000594948552

      target function =      -0.705917448914
              le_mean =     -22.426022624568
             les_mean =     503.427982145655
             stat err =       0.000584752585
             autocorr =       1.363674125487
   target nu stat err =       0.000584752585
   target dn stat err =       0.003866442375
      target stat err =       0.002835717303
              std dev =       0.708160743589
             le_variance =       0.501491638760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501450829942
                                         uncertainty =       0.004160010891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501450829942
                                         uncertainty =       0.004160010891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500745264
  error estimate for blocks of size 2^( 2) =       0.000526957947
  error estimate for blocks of size 2^( 3) =       0.000552057886
  error estimate for blocks of size 2^( 4) =       0.000571091380
  error estimate for blocks of size 2^( 5) =       0.000583372721
  error estimate for blocks of size 2^( 6) =       0.000589597688
  error estimate for blocks of size 2^( 7) =       0.000594948552

      target function =      -0.705917448914
              le_mean =     -22.426022624568
             les_mean =     503.427982145655
             stat err =       0.000584752585
             autocorr =       1.363674125487
   target nu stat err =       0.000584752585
   target dn stat err =       0.003866442375
      target stat err =       0.002835717303
              std dev =       0.708160743589
             le_variance =       0.501491638760


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.705917448914        initial  <--
     1.0000e+16     1.0000e+17             0.0000e+00        -0.705917448914
     4.0000e+16     4.0000e+17             0.0000e+00        -0.705917448914
     1.6000e+17     1.6000e+18             0.0000e+00        -0.705917448914

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0924
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2682e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2424e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.419
    reference variance = 0.340744
====================================================
  Execution time = 4.5591e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9571e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5099e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495672080239
                                         uncertainty =       0.003911292937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495672080239
                                         uncertainty =       0.003911292937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497848642
  error estimate for blocks of size 2^( 2) =       0.000524065341
  error estimate for blocks of size 2^( 3) =       0.000549169624
  error estimate for blocks of size 2^( 4) =       0.000568956356
  error estimate for blocks of size 2^( 5) =       0.000581578820
  error estimate for blocks of size 2^( 6) =       0.000587543549
  error estimate for blocks of size 2^( 7) =       0.000588782905

      target function =      -0.710091651588
              le_mean =     -22.425952347992
             les_mean =     503.419045007326
             stat err =       0.000581715407
             autocorr =       1.365294937381
   target nu stat err =       0.000581715407
   target dn stat err =       0.003851187426
      target stat err =       0.002856852187
              std dev =       0.704064301592
             le_variance =       0.495706540777


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242595234799e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+17, overlap shift 1.0000e+18 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710102267874       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710102267874       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710102267874       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710102267874       residual = 8.93e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -4.251127635208       residual = 6.38e+03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+17 is 6.984853e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+17, overlap shift 4.0000e+18 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710102267874       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710102267874       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710102267874       residual = 7.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710102267874       residual = 9.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710102267854       residual = 1.69e-01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+17 is 1.456604e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+18, overlap shift 1.6000e+19 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710102267874       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710102267874       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710102267874       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710102267874       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710102267874       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710102337041       residual = 2.17e+01           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+18 is 6.960571e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.262490 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0697e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.4262
    reference variance = 0.463104
====================================================
  Execution time = 4.4932e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.1250e-01
  Total weights = 2.0000e+06
  Execution time = 3.8107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512437076984
                                         uncertainty =       0.006404767420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512437076984
                                         uncertainty =       0.006404767420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506211122
  error estimate for blocks of size 2^( 2) =       0.000532671093
  error estimate for blocks of size 2^( 3) =       0.000557109998
  error estimate for blocks of size 2^( 4) =       0.000576558063
  error estimate for blocks of size 2^( 5) =       0.000588654260
  error estimate for blocks of size 2^( 6) =       0.000595626965
  error estimate for blocks of size 2^( 7) =       0.000599541241

      target function =      -0.698096050785
              le_mean =     -22.425893720821
             les_mean =     503.433208321158
             stat err =       0.000590095132
             autocorr =       1.358878722316
   target nu stat err =       0.000590095132
   target dn stat err =       0.006473200927
      target stat err =       0.004577731991
              std dev =       0.715890634008
             le_variance =       0.512499399860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512437076984
                                         uncertainty =       0.006404767420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512437076984
                                         uncertainty =       0.006404767420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506211122
  error estimate for blocks of size 2^( 2) =       0.000532671093
  error estimate for blocks of size 2^( 3) =       0.000557109998
  error estimate for blocks of size 2^( 4) =       0.000576558063
  error estimate for blocks of size 2^( 5) =       0.000588654260
  error estimate for blocks of size 2^( 6) =       0.000595626965
  error estimate for blocks of size 2^( 7) =       0.000599541241

      target function =      -0.698096050785
              le_mean =     -22.425893720821
             les_mean =     503.433208321158
             stat err =       0.000590095132
             autocorr =       1.358878722323
   target nu stat err =       0.000590095132
   target dn stat err =       0.006473200927
      target stat err =       0.004577731991
              std dev =       0.715890634008
             le_variance =       0.512499399860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512437076984
                                         uncertainty =       0.006404767420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512437076984
                                         uncertainty =       0.006404767420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506211122
  error estimate for blocks of size 2^( 2) =       0.000532671093
  error estimate for blocks of size 2^( 3) =       0.000557109998
  error estimate for blocks of size 2^( 4) =       0.000576558063
  error estimate for blocks of size 2^( 5) =       0.000588654260
  error estimate for blocks of size 2^( 6) =       0.000595626965
  error estimate for blocks of size 2^( 7) =       0.000599541241

      target function =      -0.698096050785
              le_mean =     -22.425893720821
             les_mean =     503.433208321158
             stat err =       0.000590095132
             autocorr =       1.358878722323
   target nu stat err =       0.000590095132
   target dn stat err =       0.006473200927
      target stat err =       0.004577731991
              std dev =       0.715890634008
             le_variance =       0.512499399860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512437076984
                                         uncertainty =       0.006404767420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512437076984
                                         uncertainty =       0.006404767420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506211122
  error estimate for blocks of size 2^( 2) =       0.000532671093
  error estimate for blocks of size 2^( 3) =       0.000557109998
  error estimate for blocks of size 2^( 4) =       0.000576558063
  error estimate for blocks of size 2^( 5) =       0.000588654260
  error estimate for blocks of size 2^( 6) =       0.000595626965
  error estimate for blocks of size 2^( 7) =       0.000599541241

      target function =      -0.698096050785
              le_mean =     -22.425893720821
             les_mean =     503.433208321158
             stat err =       0.000590095132
             autocorr =       1.358878722323
   target nu stat err =       0.000590095132
   target dn stat err =       0.006473200927
      target stat err =       0.004577731991
              std dev =       0.715890634008
             le_variance =       0.512499399860


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.698096050785        initial  <--
     1.0000e+17     1.0000e+18             6.9849e-22        -0.698096050785
     4.0000e+17     4.0000e+18             1.4566e-22        -0.698096050785
     1.6000e+18     1.6000e+19             6.9606e-23        -0.698096050785

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0253
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2473e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2424e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.4096
    reference variance = 0.535901
====================================================
  Execution time = 4.5561e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0211e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5333e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502176331947
                                         uncertainty =       0.004292987427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502176331947
                                         uncertainty =       0.004292987427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501055526
  error estimate for blocks of size 2^( 2) =       0.000527427005
  error estimate for blocks of size 2^( 3) =       0.000553029135
  error estimate for blocks of size 2^( 4) =       0.000571273867
  error estimate for blocks of size 2^( 5) =       0.000583347435
  error estimate for blocks of size 2^( 6) =       0.000590411745
  error estimate for blocks of size 2^( 7) =       0.000595396159

      target function =      -0.705452705864
              le_mean =     -22.426834880096
             les_mean =     503.465035768744
             stat err =       0.000585107302
             autocorr =       1.363638714733
   target nu stat err =       0.000585107302
   target dn stat err =       0.004316888864
      target stat err =       0.003151999198
              std dev =       0.708599520693
             le_variance =       0.502113280727


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242683488010e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+18, overlap shift 1.0000e+19 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705465842554       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705465842554       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+18, overlap shift 4.0000e+19 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705465842554       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705465842554       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+19, overlap shift 1.6000e+20 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705465842554       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705465842554       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.263602 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0901e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.5758
    reference variance = 0.441469
====================================================
  Execution time = 4.4623e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0003e-01
  Total weights = 2.0000e+06
  Execution time = 4.3160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500083301389
                                         uncertainty =       0.003752296998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500083301389
                                         uncertainty =       0.003752296998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500017162
  error estimate for blocks of size 2^( 2) =       0.000526203340
  error estimate for blocks of size 2^( 3) =       0.000551113656
  error estimate for blocks of size 2^( 4) =       0.000569229066
  error estimate for blocks of size 2^( 5) =       0.000582483998
  error estimate for blocks of size 2^( 6) =       0.000589440526
  error estimate for blocks of size 2^( 7) =       0.000595720010

      target function =      -0.706973076372
              le_mean =     -22.425582241899
             les_mean =     503.406772963736
             stat err =       0.000584218400
             autocorr =       1.365150837233
   target nu stat err =       0.000584218400
   target dn stat err =       0.003703214080
      target stat err =       0.002727466249
              std dev =       0.707131052606
             le_variance =       0.500034325559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500083301389
                                         uncertainty =       0.003752296998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500083301389
                                         uncertainty =       0.003752296998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500017162
  error estimate for blocks of size 2^( 2) =       0.000526203340
  error estimate for blocks of size 2^( 3) =       0.000551113656
  error estimate for blocks of size 2^( 4) =       0.000569229066
  error estimate for blocks of size 2^( 5) =       0.000582483998
  error estimate for blocks of size 2^( 6) =       0.000589440526
  error estimate for blocks of size 2^( 7) =       0.000595720010

      target function =      -0.706973076372
              le_mean =     -22.425582241899
             les_mean =     503.406772963736
             stat err =       0.000584218400
             autocorr =       1.365150837233
   target nu stat err =       0.000584218400
   target dn stat err =       0.003703214080
      target stat err =       0.002727466249
              std dev =       0.707131052606
             le_variance =       0.500034325559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500083301389
                                         uncertainty =       0.003752296998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500083301389
                                         uncertainty =       0.003752296998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500017162
  error estimate for blocks of size 2^( 2) =       0.000526203340
  error estimate for blocks of size 2^( 3) =       0.000551113656
  error estimate for blocks of size 2^( 4) =       0.000569229066
  error estimate for blocks of size 2^( 5) =       0.000582483998
  error estimate for blocks of size 2^( 6) =       0.000589440526
  error estimate for blocks of size 2^( 7) =       0.000595720010

      target function =      -0.706973076372
              le_mean =     -22.425582241899
             les_mean =     503.406772963736
             stat err =       0.000584218400
             autocorr =       1.365150837233
   target nu stat err =       0.000584218400
   target dn stat err =       0.003703214080
      target stat err =       0.002727466249
              std dev =       0.707131052606
             le_variance =       0.500034325559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500083301389
                                         uncertainty =       0.003752296998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500083301389
                                         uncertainty =       0.003752296998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500017162
  error estimate for blocks of size 2^( 2) =       0.000526203340
  error estimate for blocks of size 2^( 3) =       0.000551113656
  error estimate for blocks of size 2^( 4) =       0.000569229066
  error estimate for blocks of size 2^( 5) =       0.000582483998
  error estimate for blocks of size 2^( 6) =       0.000589440526
  error estimate for blocks of size 2^( 7) =       0.000595720010

      target function =      -0.706973076372
              le_mean =     -22.425582241899
             les_mean =     503.406772963736
             stat err =       0.000584218400
             autocorr =       1.365150837233
   target nu stat err =       0.000584218400
   target dn stat err =       0.003703214080
      target stat err =       0.002727466249
              std dev =       0.707131052606
             le_variance =       0.500034325559


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706973076372        initial  <--
     1.0000e+18     1.0000e+19             0.0000e+00        -0.706973076372
     4.0000e+18     4.0000e+19             0.0000e+00        -0.706973076372
     1.6000e+19     1.6000e+20             0.0000e+00        -0.706973076372

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.3518
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2526e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2427e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.5303
    reference variance = 0.491264
====================================================
  Execution time = 4.5287e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9930e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5325e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499313562871
                                         uncertainty =       0.004262560670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499313562871
                                         uncertainty =       0.004262560670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499648526
  error estimate for blocks of size 2^( 2) =       0.000525733589
  error estimate for blocks of size 2^( 3) =       0.000550878007
  error estimate for blocks of size 2^( 4) =       0.000570230162
  error estimate for blocks of size 2^( 5) =       0.000582838707
  error estimate for blocks of size 2^( 6) =       0.000590328977
  error estimate for blocks of size 2^( 7) =       0.000596640142

      target function =      -0.707490825895
              le_mean =     -22.426038734344
             les_mean =     503.426510364474
             stat err =       0.000585009497
             autocorr =       1.370871068702
   target nu stat err =       0.000585009497
   target dn stat err =       0.004471525720
      target stat err =       0.003275740064
              std dev =       0.706609722427
             le_variance =       0.499297299829


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242603873434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+19, overlap shift 1.0000e+20 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707504912582       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707504912582       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+19, overlap shift 4.0000e+20 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707504912582       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707504912582       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+20, overlap shift 1.6000e+21 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707504912582       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707504912582       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.264709 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0619e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.4267
    reference variance = 0.594568
====================================================
  Execution time = 4.5244e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.3095e-01
  Total weights = 2.0000e+06
  Execution time = 3.8251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531042560541
                                         uncertainty =       0.030471139715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531042560541
                                         uncertainty =       0.030471139715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515240390
  error estimate for blocks of size 2^( 2) =       0.000540827103
  error estimate for blocks of size 2^( 3) =       0.000565255376
  error estimate for blocks of size 2^( 4) =       0.000584366849
  error estimate for blocks of size 2^( 5) =       0.000596318985
  error estimate for blocks of size 2^( 6) =       0.000604412688
  error estimate for blocks of size 2^( 7) =       0.000608215635

      target function =      -0.684783317079
              le_mean =     -22.425837884695
             les_mean =     503.449149884719
             stat err =       0.000598328539
             autocorr =       1.348526967342
   target nu stat err =       0.000598328539
   target dn stat err =       0.031228392578
      target stat err =       0.021096514535
              std dev =       0.728659947828
             le_variance =       0.530945319568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531042560541
                                         uncertainty =       0.030471139715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531042560541
                                         uncertainty =       0.030471139715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515240390
  error estimate for blocks of size 2^( 2) =       0.000540827103
  error estimate for blocks of size 2^( 3) =       0.000565255376
  error estimate for blocks of size 2^( 4) =       0.000584366849
  error estimate for blocks of size 2^( 5) =       0.000596318985
  error estimate for blocks of size 2^( 6) =       0.000604412688
  error estimate for blocks of size 2^( 7) =       0.000608215635

      target function =      -0.684783317079
              le_mean =     -22.425837884695
             les_mean =     503.449149884719
             stat err =       0.000598328539
             autocorr =       1.348526967342
   target nu stat err =       0.000598328539
   target dn stat err =       0.031228392578
      target stat err =       0.021096514535
              std dev =       0.728659947828
             le_variance =       0.530945319568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531042560541
                                         uncertainty =       0.030471139715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531042560541
                                         uncertainty =       0.030471139715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515240390
  error estimate for blocks of size 2^( 2) =       0.000540827103
  error estimate for blocks of size 2^( 3) =       0.000565255376
  error estimate for blocks of size 2^( 4) =       0.000584366849
  error estimate for blocks of size 2^( 5) =       0.000596318985
  error estimate for blocks of size 2^( 6) =       0.000604412688
  error estimate for blocks of size 2^( 7) =       0.000608215635

      target function =      -0.684783317079
              le_mean =     -22.425837884695
             les_mean =     503.449149884719
             stat err =       0.000598328539
             autocorr =       1.348526967342
   target nu stat err =       0.000598328539
   target dn stat err =       0.031228392578
      target stat err =       0.021096514535
              std dev =       0.728659947828
             le_variance =       0.530945319568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531042560541
                                         uncertainty =       0.030471139715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531042560541
                                         uncertainty =       0.030471139715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515240390
  error estimate for blocks of size 2^( 2) =       0.000540827103
  error estimate for blocks of size 2^( 3) =       0.000565255376
  error estimate for blocks of size 2^( 4) =       0.000584366849
  error estimate for blocks of size 2^( 5) =       0.000596318985
  error estimate for blocks of size 2^( 6) =       0.000604412688
  error estimate for blocks of size 2^( 7) =       0.000608215635

      target function =      -0.684783317079
              le_mean =     -22.425837884695
             les_mean =     503.449149884719
             stat err =       0.000598328539
             autocorr =       1.348526967342
   target nu stat err =       0.000598328539
   target dn stat err =       0.031228392578
      target stat err =       0.021096514535
              std dev =       0.728659947828
             le_variance =       0.530945319568


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.684783317079        initial  <--
     1.0000e+19     1.0000e+20             0.0000e+00        -0.684783317079
     4.0000e+19     4.0000e+20             0.0000e+00        -0.684783317079
     1.6000e+20     1.6000e+21             0.0000e+00        -0.684783317079

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.4195
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2506e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2430e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.4619
    reference variance = 0.479264
====================================================
  Execution time = 4.4957e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.1082e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5061e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510894296890
                                         uncertainty =       0.011902690536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510894296890
                                         uncertainty =       0.011902690536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505380096
  error estimate for blocks of size 2^( 2) =       0.000531501298
  error estimate for blocks of size 2^( 3) =       0.000556545562
  error estimate for blocks of size 2^( 4) =       0.000575748373
  error estimate for blocks of size 2^( 5) =       0.000588971154
  error estimate for blocks of size 2^( 6) =       0.000594598842
  error estimate for blocks of size 2^( 7) =       0.000598252950

      target function =      -0.699211098671
              le_mean =     -22.425720431676
             les_mean =     503.423754706825
             stat err =       0.000589392830
             autocorr =       1.360108107359
   target nu stat err =       0.000589392830
   target dn stat err =       0.011962459834
      target stat err =       0.008434856321
              std dev =       0.714715385690
             le_variance =       0.510818082542


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242572043168e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+20, overlap shift 1.0000e+21 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.699310755925       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699310755925       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+20, overlap shift 4.0000e+21 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.699310755925       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699310755925       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+21, overlap shift 1.6000e+22 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.699310755925       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699310755925       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.265813 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0025e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.5018
    reference variance = 0.296989
====================================================
  Execution time = 4.4521e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9910e-01
  Total weights = 2.0000e+06
  Execution time = 4.5103e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499177128928
                                         uncertainty =       0.004352226664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499177128928
                                         uncertainty =       0.004352226664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499549424
  error estimate for blocks of size 2^( 2) =       0.000526449848
  error estimate for blocks of size 2^( 3) =       0.000551509032
  error estimate for blocks of size 2^( 4) =       0.000570284269
  error estimate for blocks of size 2^( 5) =       0.000583328179
  error estimate for blocks of size 2^( 6) =       0.000590553579
  error estimate for blocks of size 2^( 7) =       0.000594268955

      target function =      -0.707632239789
              le_mean =     -22.426026126892
             les_mean =     503.425746849247
             stat err =       0.000584608745
             autocorr =       1.369536747947
   target nu stat err =       0.000584608745
   target dn stat err =       0.004718659808
      target stat err =       0.003452183946
              std dev =       0.706469571011
             le_variance =       0.499099254764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499177128928
                                         uncertainty =       0.004352226664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499177128928
                                         uncertainty =       0.004352226664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499549424
  error estimate for blocks of size 2^( 2) =       0.000526449848
  error estimate for blocks of size 2^( 3) =       0.000551509032
  error estimate for blocks of size 2^( 4) =       0.000570284269
  error estimate for blocks of size 2^( 5) =       0.000583328179
  error estimate for blocks of size 2^( 6) =       0.000590553579
  error estimate for blocks of size 2^( 7) =       0.000594268955

      target function =      -0.707632239789
              le_mean =     -22.426026126892
             les_mean =     503.425746849247
             stat err =       0.000584608745
             autocorr =       1.369536747947
   target nu stat err =       0.000584608745
   target dn stat err =       0.004718659808
      target stat err =       0.003452183946
              std dev =       0.706469571011
             le_variance =       0.499099254764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499177128928
                                         uncertainty =       0.004352226664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499177128928
                                         uncertainty =       0.004352226664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499549424
  error estimate for blocks of size 2^( 2) =       0.000526449848
  error estimate for blocks of size 2^( 3) =       0.000551509032
  error estimate for blocks of size 2^( 4) =       0.000570284269
  error estimate for blocks of size 2^( 5) =       0.000583328179
  error estimate for blocks of size 2^( 6) =       0.000590553579
  error estimate for blocks of size 2^( 7) =       0.000594268955

      target function =      -0.707632239789
              le_mean =     -22.426026126892
             les_mean =     503.425746849247
             stat err =       0.000584608745
             autocorr =       1.369536747947
   target nu stat err =       0.000584608745
   target dn stat err =       0.004718659808
      target stat err =       0.003452183946
              std dev =       0.706469571011
             le_variance =       0.499099254764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499177128928
                                         uncertainty =       0.004352226664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499177128928
                                         uncertainty =       0.004352226664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499549424
  error estimate for blocks of size 2^( 2) =       0.000526449848
  error estimate for blocks of size 2^( 3) =       0.000551509032
  error estimate for blocks of size 2^( 4) =       0.000570284269
  error estimate for blocks of size 2^( 5) =       0.000583328179
  error estimate for blocks of size 2^( 6) =       0.000590553579
  error estimate for blocks of size 2^( 7) =       0.000594268955

      target function =      -0.707632239789
              le_mean =     -22.426026126892
             les_mean =     503.425746849247
             stat err =       0.000584608745
             autocorr =       1.369536747947
   target nu stat err =       0.000584608745
   target dn stat err =       0.004718659808
      target stat err =       0.003452183946
              std dev =       0.706469571011
             le_variance =       0.499099254764


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707632239789        initial  <--
     1.0000e+20     1.0000e+21             0.0000e+00        -0.707632239789
     4.0000e+20     4.0000e+21             0.0000e+00        -0.707632239789
     1.6000e+21     1.6000e+22             0.0000e+00        -0.707632239789

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.3731
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2440e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2432e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.4493
    reference variance = 0.67504
====================================================
  Execution time = 4.7366e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0030e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5303e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500265652682
                                         uncertainty =       0.003622369879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500265652682
                                         uncertainty =       0.003622369879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500148326
  error estimate for blocks of size 2^( 2) =       0.000526386598
  error estimate for blocks of size 2^( 3) =       0.000552046145
  error estimate for blocks of size 2^( 4) =       0.000571186684
  error estimate for blocks of size 2^( 5) =       0.000581377748
  error estimate for blocks of size 2^( 6) =       0.000588028227
  error estimate for blocks of size 2^( 7) =       0.000592722185

      target function =      -0.706774399068
              le_mean =     -22.426206617631
             les_mean =     503.435039703444
             stat err =       0.000583328711
             autocorr =       1.360282357788
   target nu stat err =       0.000583328711
   target dn stat err =       0.003517954712
      target stat err =       0.002598355443
              std dev =       0.707316546458
             le_variance =       0.500296696893


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242620661763e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+21, overlap shift 1.0000e+22 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706782645193       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706782645193       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+21, overlap shift 4.0000e+22 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706782645193       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706782645193       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+22, overlap shift 1.6000e+23 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706782645193       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706782645193       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.266912 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2675e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.4391
    reference variance = 1.21456
====================================================
  Execution time = 4.4576e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9910e-01
  Total weights = 2.0000e+06
  Execution time = 3.8269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498895316991
                                         uncertainty =       0.003756161605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498895316991
                                         uncertainty =       0.003756161605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499551848
  error estimate for blocks of size 2^( 2) =       0.000525720609
  error estimate for blocks of size 2^( 3) =       0.000550283727
  error estimate for blocks of size 2^( 4) =       0.000569670836
  error estimate for blocks of size 2^( 5) =       0.000581831974
  error estimate for blocks of size 2^( 6) =       0.000588551205
  error estimate for blocks of size 2^( 7) =       0.000590298508

      target function =      -0.707603485962
              le_mean =     -22.427680676723
             les_mean =     503.499964385944
             stat err =       0.000582588131
             autocorr =       1.360072702955
   target nu stat err =       0.000582588131
   target dn stat err =       0.003922665009
      target stat err =       0.002895067682
              std dev =       0.706472999100
             le_variance =       0.499104098457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498895316991
                                         uncertainty =       0.003756161605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498895316991
                                         uncertainty =       0.003756161605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499551848
  error estimate for blocks of size 2^( 2) =       0.000525720609
  error estimate for blocks of size 2^( 3) =       0.000550283727
  error estimate for blocks of size 2^( 4) =       0.000569670836
  error estimate for blocks of size 2^( 5) =       0.000581831974
  error estimate for blocks of size 2^( 6) =       0.000588551205
  error estimate for blocks of size 2^( 7) =       0.000590298508

      target function =      -0.707603485962
              le_mean =     -22.427680676723
             les_mean =     503.499964385944
             stat err =       0.000582588131
             autocorr =       1.360072702956
   target nu stat err =       0.000582588131
   target dn stat err =       0.003922665009
      target stat err =       0.002895067682
              std dev =       0.706472999100
             le_variance =       0.499104098457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498895316991
                                         uncertainty =       0.003756161605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498895316991
                                         uncertainty =       0.003756161605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499551848
  error estimate for blocks of size 2^( 2) =       0.000525720609
  error estimate for blocks of size 2^( 3) =       0.000550283727
  error estimate for blocks of size 2^( 4) =       0.000569670836
  error estimate for blocks of size 2^( 5) =       0.000581831974
  error estimate for blocks of size 2^( 6) =       0.000588551205
  error estimate for blocks of size 2^( 7) =       0.000590298508

      target function =      -0.707603485962
              le_mean =     -22.427680676723
             les_mean =     503.499964385944
             stat err =       0.000582588131
             autocorr =       1.360072702956
   target nu stat err =       0.000582588131
   target dn stat err =       0.003922665009
      target stat err =       0.002895067682
              std dev =       0.706472999100
             le_variance =       0.499104098457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498895316991
                                         uncertainty =       0.003756161605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498895316991
                                         uncertainty =       0.003756161605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499551848
  error estimate for blocks of size 2^( 2) =       0.000525720609
  error estimate for blocks of size 2^( 3) =       0.000550283727
  error estimate for blocks of size 2^( 4) =       0.000569670836
  error estimate for blocks of size 2^( 5) =       0.000581831974
  error estimate for blocks of size 2^( 6) =       0.000588551205
  error estimate for blocks of size 2^( 7) =       0.000590298508

      target function =      -0.707603485962
              le_mean =     -22.427680676723
             les_mean =     503.499964385944
             stat err =       0.000582588131
             autocorr =       1.360072702956
   target nu stat err =       0.000582588131
   target dn stat err =       0.003922665009
      target stat err =       0.002895067682
              std dev =       0.706472999100
             le_variance =       0.499104098457


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707603485962        initial  <--
     1.0000e+21     1.0000e+22             0.0000e+00        -0.707603485962
     4.0000e+21     4.0000e+22             0.0000e+00        -0.707603485962
     1.6000e+22     1.6000e+23             0.0000e+00        -0.707603485962

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.7602
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2644e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2433e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.5134
    reference variance = 1.45168
====================================================
  Execution time = 4.5618e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.2632e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5116e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526417462812
                                         uncertainty =       0.021240014697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526417462812
                                         uncertainty =       0.021240014697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512991286
  error estimate for blocks of size 2^( 2) =       0.000538939186
  error estimate for blocks of size 2^( 3) =       0.000562955544
  error estimate for blocks of size 2^( 4) =       0.000582348876
  error estimate for blocks of size 2^( 5) =       0.000594322033
  error estimate for blocks of size 2^( 6) =       0.000601140126
  error estimate for blocks of size 2^( 7) =       0.000608218293

      target function =      -0.688216642369
              le_mean =     -22.426701984287
             les_mean =     503.483281748754
             stat err =       0.000596507332
             autocorr =       1.352108663654
   target nu stat err =       0.000596507332
   target dn stat err =       0.021625890219
      target stat err =       0.014773651603
              std dev =       0.725479234636
             le_variance =       0.526320119888


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242670198429e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+22, overlap shift 1.0000e+23 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.688530865581       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.688530865581       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+22, overlap shift 4.0000e+23 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.688530865581       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.688530865581       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+23, overlap shift 1.6000e+24 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.688530865581       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.688530865581       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.268011 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0740e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.4197
    reference variance = 0.358463
====================================================
  Execution time = 4.4444e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0202e-01
  Total weights = 2.0000e+06
  Execution time = 3.8345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502126410851
                                         uncertainty =       0.009280363696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502126410851
                                         uncertainty =       0.009280363696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501010746
  error estimate for blocks of size 2^( 2) =       0.000527232502
  error estimate for blocks of size 2^( 3) =       0.000552531518
  error estimate for blocks of size 2^( 4) =       0.000572018545
  error estimate for blocks of size 2^( 5) =       0.000583824361
  error estimate for blocks of size 2^( 6) =       0.000590159870
  error estimate for blocks of size 2^( 7) =       0.000591900016

      target function =      -0.705479266831
              le_mean =     -22.426109928966
             les_mean =     503.432429831267
             stat err =       0.000584475698
             autocorr =       1.360939545632
   target nu stat err =       0.000584475698
   target dn stat err =       0.009585881009
      target stat err =       0.006892924622
              std dev =       0.708536192583
             le_variance =       0.502023536200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502126410851
                                         uncertainty =       0.009280363696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502126410851
                                         uncertainty =       0.009280363696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501010746
  error estimate for blocks of size 2^( 2) =       0.000527232502
  error estimate for blocks of size 2^( 3) =       0.000552531518
  error estimate for blocks of size 2^( 4) =       0.000572018545
  error estimate for blocks of size 2^( 5) =       0.000583824361
  error estimate for blocks of size 2^( 6) =       0.000590159870
  error estimate for blocks of size 2^( 7) =       0.000591900016

      target function =      -0.705479266831
              le_mean =     -22.426109928966
             les_mean =     503.432429831267
             stat err =       0.000584475698
             autocorr =       1.360939545632
   target nu stat err =       0.000584475698
   target dn stat err =       0.009585881009
      target stat err =       0.006892924622
              std dev =       0.708536192583
             le_variance =       0.502023536200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502126410851
                                         uncertainty =       0.009280363696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502126410851
                                         uncertainty =       0.009280363696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501010746
  error estimate for blocks of size 2^( 2) =       0.000527232502
  error estimate for blocks of size 2^( 3) =       0.000552531518
  error estimate for blocks of size 2^( 4) =       0.000572018545
  error estimate for blocks of size 2^( 5) =       0.000583824361
  error estimate for blocks of size 2^( 6) =       0.000590159870
  error estimate for blocks of size 2^( 7) =       0.000591900016

      target function =      -0.705479266831
              le_mean =     -22.426109928966
             les_mean =     503.432429831267
             stat err =       0.000584475698
             autocorr =       1.360939545632
   target nu stat err =       0.000584475698
   target dn stat err =       0.009585881009
      target stat err =       0.006892924622
              std dev =       0.708536192583
             le_variance =       0.502023536200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502126410851
                                         uncertainty =       0.009280363696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502126410851
                                         uncertainty =       0.009280363696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501010746
  error estimate for blocks of size 2^( 2) =       0.000527232502
  error estimate for blocks of size 2^( 3) =       0.000552531518
  error estimate for blocks of size 2^( 4) =       0.000572018545
  error estimate for blocks of size 2^( 5) =       0.000583824361
  error estimate for blocks of size 2^( 6) =       0.000590159870
  error estimate for blocks of size 2^( 7) =       0.000591900016

      target function =      -0.705479266831
              le_mean =     -22.426109928966
             les_mean =     503.432429831267
             stat err =       0.000584475698
             autocorr =       1.360939545632
   target nu stat err =       0.000584475698
   target dn stat err =       0.009585881009
      target stat err =       0.006892924622
              std dev =       0.708536192583
             le_variance =       0.502023536200


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.705479266831        initial  <--
     1.0000e+22     1.0000e+23             0.0000e+00        -0.705479266831
     4.0000e+22     4.0000e+23             0.0000e+00        -0.705479266831
     1.6000e+23     1.6000e+24             0.0000e+00        -0.705479266831

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.6071
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2435e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.5203
    reference variance = 0.387036
====================================================
  Execution time = 4.6948e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2425e+01
  VMC Evar = 5.0274e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5038e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502809774295
                                         uncertainty =       0.003637202343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502809774295
                                         uncertainty =       0.003637202343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501370654
  error estimate for blocks of size 2^( 2) =       0.000527496317
  error estimate for blocks of size 2^( 3) =       0.000552189893
  error estimate for blocks of size 2^( 4) =       0.000570091336
  error estimate for blocks of size 2^( 5) =       0.000582878690
  error estimate for blocks of size 2^( 6) =       0.000590068454
  error estimate for blocks of size 2^( 7) =       0.000594109235

      target function =      -0.705034955423
              le_mean =     -22.425314947580
             les_mean =     503.397495313048
             stat err =       0.000584286929
             autocorr =       1.358108663983
   target nu stat err =       0.000584286929
   target dn stat err =       0.003670847894
      target stat err =       0.002689293168
              std dev =       0.709045179299
             le_variance =       0.502745066288


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242531494758e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+23, overlap shift 1.0000e+24 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705044351295       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705044351295       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705044351295       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705044440623       residual = 2.91e+06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+23 is 5.562118e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+23, overlap shift 4.0000e+24 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705044351295       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705044351295       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705044351295       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+23 is 1.390529e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+24, overlap shift 1.6000e+25 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705044351295       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705044351295       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705044351295       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705044245754       residual = 2.16e+06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.704982650843       residual = 8.43e+06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+24 is 3.476323e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.269668 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1993e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.48
    reference variance = 0.62012
====================================================
  Execution time = 4.6047e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9507e-01
  Total weights = 2.0000e+06
  Execution time = 3.8216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495164317974
                                         uncertainty =       0.002929340932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495164317974
                                         uncertainty =       0.002929340932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497530261
  error estimate for blocks of size 2^( 2) =       0.000524053442
  error estimate for blocks of size 2^( 3) =       0.000548865601
  error estimate for blocks of size 2^( 4) =       0.000568870090
  error estimate for blocks of size 2^( 5) =       0.000581266033
  error estimate for blocks of size 2^( 6) =       0.000587210532
  error estimate for blocks of size 2^( 7) =       0.000591096031

      target function =      -0.710551781357
              le_mean =     -22.426249330417
             les_mean =     503.431731503037
             stat err =       0.000582110672
             autocorr =       1.368901254553
   target nu stat err =       0.000582110672
   target dn stat err =       0.003122556645
      target stat err =       0.002346360184
              std dev =       0.703614042315
             le_variance =       0.495072720543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495164317974
                                         uncertainty =       0.002929340932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495164317974
                                         uncertainty =       0.002929340932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497530261
  error estimate for blocks of size 2^( 2) =       0.000524053442
  error estimate for blocks of size 2^( 3) =       0.000548865601
  error estimate for blocks of size 2^( 4) =       0.000568870090
  error estimate for blocks of size 2^( 5) =       0.000581266033
  error estimate for blocks of size 2^( 6) =       0.000587210532
  error estimate for blocks of size 2^( 7) =       0.000591096031

      target function =      -0.710551781357
              le_mean =     -22.426249330417
             les_mean =     503.431731503037
             stat err =       0.000582110672
             autocorr =       1.368901254553
   target nu stat err =       0.000582110672
   target dn stat err =       0.003122556645
      target stat err =       0.002346360184
              std dev =       0.703614042315
             le_variance =       0.495072720543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495164317974
                                         uncertainty =       0.002929340932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495164317974
                                         uncertainty =       0.002929340932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497530261
  error estimate for blocks of size 2^( 2) =       0.000524053442
  error estimate for blocks of size 2^( 3) =       0.000548865601
  error estimate for blocks of size 2^( 4) =       0.000568870090
  error estimate for blocks of size 2^( 5) =       0.000581266033
  error estimate for blocks of size 2^( 6) =       0.000587210532
  error estimate for blocks of size 2^( 7) =       0.000591096031

      target function =      -0.710551781357
              le_mean =     -22.426249330417
             les_mean =     503.431731503037
             stat err =       0.000582110672
             autocorr =       1.368901254553
   target nu stat err =       0.000582110672
   target dn stat err =       0.003122556645
      target stat err =       0.002346360184
              std dev =       0.703614042315
             le_variance =       0.495072720543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495164317974
                                         uncertainty =       0.002929340932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495164317974
                                         uncertainty =       0.002929340932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497530261
  error estimate for blocks of size 2^( 2) =       0.000524053442
  error estimate for blocks of size 2^( 3) =       0.000548865601
  error estimate for blocks of size 2^( 4) =       0.000568870090
  error estimate for blocks of size 2^( 5) =       0.000581266033
  error estimate for blocks of size 2^( 6) =       0.000587210532
  error estimate for blocks of size 2^( 7) =       0.000591096031

      target function =      -0.710551781357
              le_mean =     -22.426249330417
             les_mean =     503.431731503037
             stat err =       0.000582110672
             autocorr =       1.368901254553
   target nu stat err =       0.000582110672
   target dn stat err =       0.003122556645
      target stat err =       0.002346360184
              std dev =       0.703614042315
             le_variance =       0.495072720543


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.710551781357        initial  <--
     1.0000e+23     1.0000e+24             5.5621e-28        -0.710551781357
     4.0000e+23     4.0000e+24             1.3905e-28        -0.710551781357
     1.6000e+24     1.6000e+25             3.4763e-29        -0.710551781357

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.1792
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2718e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2437e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.3342
    reference variance = 0.330009
====================================================
  Execution time = 4.5351e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0699e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5019e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506907233648
                                         uncertainty =       0.005843730589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506907233648
                                         uncertainty =       0.005843730589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503481296
  error estimate for blocks of size 2^( 2) =       0.000529526367
  error estimate for blocks of size 2^( 3) =       0.000554106654
  error estimate for blocks of size 2^( 4) =       0.000572878217
  error estimate for blocks of size 2^( 5) =       0.000584839557
  error estimate for blocks of size 2^( 6) =       0.000590909172
  error estimate for blocks of size 2^( 7) =       0.000597370749

      target function =      -0.702000332333
              le_mean =     -22.425715330177
             les_mean =     503.419694647263
             stat err =       0.000586499424
             autocorr =       1.356964533490
   target nu stat err =       0.000586499424
   target dn stat err =       0.004819197632
      target stat err =       0.003467284123
              std dev =       0.712030077044
             le_variance =       0.506986830615


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242571533018e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+24, overlap shift 1.0000e+25 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702016465342       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702016465342       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+24, overlap shift 4.0000e+25 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702016465342       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702016465342       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+25, overlap shift 1.6000e+26 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702016465342       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702016465342       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.270788 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0377e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.3053
    reference variance = 0.543931
====================================================
  Execution time = 4.4888e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9801e-01
  Total weights = 2.0000e+06
  Execution time = 3.8162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497978271670
                                         uncertainty =       0.003973228606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497978271670
                                         uncertainty =       0.003973228606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499004857
  error estimate for blocks of size 2^( 2) =       0.000525505081
  error estimate for blocks of size 2^( 3) =       0.000550914849
  error estimate for blocks of size 2^( 4) =       0.000569969034
  error estimate for blocks of size 2^( 5) =       0.000581889138
  error estimate for blocks of size 2^( 6) =       0.000587239257
  error estimate for blocks of size 2^( 7) =       0.000590088078

      target function =      -0.708408363316
              le_mean =     -22.426840636495
             les_mean =     503.461192381174
             stat err =       0.000582296377
             autocorr =       1.361691194343
   target nu stat err =       0.000582296377
   target dn stat err =       0.003864690346
      target stat err =       0.002856929467
              std dev =       0.705699437034
             le_variance =       0.498011695430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497978271670
                                         uncertainty =       0.003973228606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497978271670
                                         uncertainty =       0.003973228606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499004857
  error estimate for blocks of size 2^( 2) =       0.000525505081
  error estimate for blocks of size 2^( 3) =       0.000550914849
  error estimate for blocks of size 2^( 4) =       0.000569969034
  error estimate for blocks of size 2^( 5) =       0.000581889138
  error estimate for blocks of size 2^( 6) =       0.000587239257
  error estimate for blocks of size 2^( 7) =       0.000590088078

      target function =      -0.708408363316
              le_mean =     -22.426840636495
             les_mean =     503.461192381174
             stat err =       0.000582296377
             autocorr =       1.361691194343
   target nu stat err =       0.000582296377
   target dn stat err =       0.003864690346
      target stat err =       0.002856929467
              std dev =       0.705699437034
             le_variance =       0.498011695430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497978271670
                                         uncertainty =       0.003973228606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497978271670
                                         uncertainty =       0.003973228606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499004857
  error estimate for blocks of size 2^( 2) =       0.000525505081
  error estimate for blocks of size 2^( 3) =       0.000550914849
  error estimate for blocks of size 2^( 4) =       0.000569969034
  error estimate for blocks of size 2^( 5) =       0.000581889138
  error estimate for blocks of size 2^( 6) =       0.000587239257
  error estimate for blocks of size 2^( 7) =       0.000590088078

      target function =      -0.708408363316
              le_mean =     -22.426840636495
             les_mean =     503.461192381174
             stat err =       0.000582296377
             autocorr =       1.361691194343
   target nu stat err =       0.000582296377
   target dn stat err =       0.003864690346
      target stat err =       0.002856929467
              std dev =       0.705699437034
             le_variance =       0.498011695430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497978271670
                                         uncertainty =       0.003973228606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497978271670
                                         uncertainty =       0.003973228606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499004857
  error estimate for blocks of size 2^( 2) =       0.000525505081
  error estimate for blocks of size 2^( 3) =       0.000550914849
  error estimate for blocks of size 2^( 4) =       0.000569969034
  error estimate for blocks of size 2^( 5) =       0.000581889138
  error estimate for blocks of size 2^( 6) =       0.000587239257
  error estimate for blocks of size 2^( 7) =       0.000590088078

      target function =      -0.708408363316
              le_mean =     -22.426840636495
             les_mean =     503.461192381174
             stat err =       0.000582296377
             autocorr =       1.361691194343
   target nu stat err =       0.000582296377
   target dn stat err =       0.003864690346
      target stat err =       0.002856929467
              std dev =       0.705699437034
             le_variance =       0.498011695430


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.708408363316        initial  <--
     1.0000e+24     1.0000e+25             0.0000e+00        -0.708408363316
     4.0000e+24     4.0000e+25             0.0000e+00        -0.708408363316
     1.6000e+25     1.6000e+26             0.0000e+00        -0.708408363316

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0001
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2438e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2432e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.5134
    reference variance = 0.684444
====================================================
  Execution time = 4.6186e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9489e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5146e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494849619716
                                         uncertainty =       0.002466130498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494849619716
                                         uncertainty =       0.002466130498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497438307
  error estimate for blocks of size 2^( 2) =       0.000524145503
  error estimate for blocks of size 2^( 3) =       0.000548964671
  error estimate for blocks of size 2^( 4) =       0.000568035423
  error estimate for blocks of size 2^( 5) =       0.000579433697
  error estimate for blocks of size 2^( 6) =       0.000585968690
  error estimate for blocks of size 2^( 7) =       0.000588806704

      target function =      -0.710688809928
              le_mean =     -22.426007734063
             les_mean =     503.420712378391
             stat err =       0.000580561128
             autocorr =       1.362126543562
   target nu stat err =       0.000580561128
   target dn stat err =       0.002947619669
      target stat err =       0.002223235195
              std dev =       0.703483999537
             le_variance =       0.494889737604


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242600773406e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+25, overlap shift 1.0000e+26 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710694731478       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710694731478       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710694731478       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710694731479       residual = 7.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+25 is 6.239476e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+25, overlap shift 4.0000e+26 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710694731478       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710694731478       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710694731478       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+25 is 1.559869e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+26, overlap shift 1.6000e+27 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710694731478       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710694731478       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710694731478       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710694731478       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+26 is 4.956274e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.272333 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1339e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.4246
    reference variance = 0.845037
====================================================
  Execution time = 4.6196e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0119e-01
  Total weights = 2.0000e+06
  Execution time = 3.8068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501216953401
                                         uncertainty =       0.004575565761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501216953401
                                         uncertainty =       0.004575565761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500595895
  error estimate for blocks of size 2^( 2) =       0.000526749290
  error estimate for blocks of size 2^( 3) =       0.000551871200
  error estimate for blocks of size 2^( 4) =       0.000571185800
  error estimate for blocks of size 2^( 5) =       0.000582181574
  error estimate for blocks of size 2^( 6) =       0.000589956248
  error estimate for blocks of size 2^( 7) =       0.000595057727

      target function =      -0.706131874570
              le_mean =     -22.425890363791
             les_mean =     503.421750858218
             stat err =       0.000584595337
             autocorr =       1.363754280145
   target nu stat err =       0.000584595337
   target dn stat err =       0.004368335793
      target stat err =       0.003189831123
              std dev =       0.707949503875
             le_variance =       0.501192500037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501216953401
                                         uncertainty =       0.004575565761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501216953401
                                         uncertainty =       0.004575565761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500595895
  error estimate for blocks of size 2^( 2) =       0.000526749290
  error estimate for blocks of size 2^( 3) =       0.000551871200
  error estimate for blocks of size 2^( 4) =       0.000571185800
  error estimate for blocks of size 2^( 5) =       0.000582181574
  error estimate for blocks of size 2^( 6) =       0.000589956248
  error estimate for blocks of size 2^( 7) =       0.000595057727

      target function =      -0.706131874570
              le_mean =     -22.425890363791
             les_mean =     503.421750858218
             stat err =       0.000584595337
             autocorr =       1.363754280145
   target nu stat err =       0.000584595337
   target dn stat err =       0.004368335793
      target stat err =       0.003189831123
              std dev =       0.707949503875
             le_variance =       0.501192500037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501216953401
                                         uncertainty =       0.004575565761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501216953401
                                         uncertainty =       0.004575565761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500595895
  error estimate for blocks of size 2^( 2) =       0.000526749290
  error estimate for blocks of size 2^( 3) =       0.000551871200
  error estimate for blocks of size 2^( 4) =       0.000571185800
  error estimate for blocks of size 2^( 5) =       0.000582181574
  error estimate for blocks of size 2^( 6) =       0.000589956248
  error estimate for blocks of size 2^( 7) =       0.000595057727

      target function =      -0.706131874570
              le_mean =     -22.425890363791
             les_mean =     503.421750858218
             stat err =       0.000584595337
             autocorr =       1.363754280145
   target nu stat err =       0.000584595337
   target dn stat err =       0.004368335793
      target stat err =       0.003189831123
              std dev =       0.707949503875
             le_variance =       0.501192500037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501216953401
                                         uncertainty =       0.004575565761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501216953401
                                         uncertainty =       0.004575565761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500595895
  error estimate for blocks of size 2^( 2) =       0.000526749290
  error estimate for blocks of size 2^( 3) =       0.000551871200
  error estimate for blocks of size 2^( 4) =       0.000571185800
  error estimate for blocks of size 2^( 5) =       0.000582181574
  error estimate for blocks of size 2^( 6) =       0.000589956248
  error estimate for blocks of size 2^( 7) =       0.000595057727

      target function =      -0.706131874570
              le_mean =     -22.425890363791
             les_mean =     503.421750858218
             stat err =       0.000584595337
             autocorr =       1.363754280145
   target nu stat err =       0.000584595337
   target dn stat err =       0.004368335793
      target stat err =       0.003189831123
              std dev =       0.707949503875
             le_variance =       0.501192500037


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706131874570        initial  <--
     1.0000e+25     1.0000e+26             6.2395e-30        -0.706131874570
     4.0000e+25     4.0000e+26             1.5599e-30        -0.706131874570
     1.6000e+26     1.6000e+27             4.9563e-31        -0.706131874570

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.2569
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2660e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.48
    reference variance = 0.332746
====================================================
  Execution time = 4.7111e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0001e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5096e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500095592961
                                         uncertainty =       0.004583066830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500095592961
                                         uncertainty =       0.004583066830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500005163
  error estimate for blocks of size 2^( 2) =       0.000526126692
  error estimate for blocks of size 2^( 3) =       0.000551280725
  error estimate for blocks of size 2^( 4) =       0.000570031761
  error estimate for blocks of size 2^( 5) =       0.000583137303
  error estimate for blocks of size 2^( 6) =       0.000588825014
  error estimate for blocks of size 2^( 7) =       0.000591855803

      target function =      -0.706974673509
              le_mean =     -22.426032693174
             les_mean =     503.426952431651
             stat err =       0.000583462470
             autocorr =       1.361685692947
   target nu stat err =       0.000583462470
   target dn stat err =       0.004932605504
      target stat err =       0.003597395139
              std dev =       0.707114082975
             le_variance =       0.500010326341


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242603269317e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+26, overlap shift 1.0000e+27 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706991743320       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706991743320       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706991743320       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+26 is 5.456004e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+26, overlap shift 4.0000e+27 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706991743320       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706991743320       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706991743320       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+26 is 1.364001e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+27, overlap shift 1.6000e+28 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706991743320       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706991743320       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706991743320       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+27 is 3.410002e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.273718 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2213e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.371
    reference variance = 0.33369
====================================================
  Execution time = 4.4379e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0906e-01
  Total weights = 2.0000e+06
  Execution time = 3.8145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508711168669
                                         uncertainty =       0.010270366791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508711168669
                                         uncertainty =       0.010270366791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504507551
  error estimate for blocks of size 2^( 2) =       0.000530425376
  error estimate for blocks of size 2^( 3) =       0.000555031214
  error estimate for blocks of size 2^( 4) =       0.000573869768
  error estimate for blocks of size 2^( 5) =       0.000584738105
  error estimate for blocks of size 2^( 6) =       0.000591105041
  error estimate for blocks of size 2^( 7) =       0.000595990100

      target function =      -0.700444563066
              le_mean =     -22.427052694284
             les_mean =     503.481748036218
             stat err =       0.000586425753
             autocorr =       1.351110058523
   target nu stat err =       0.000586425753
   target dn stat err =       0.010021637806
      target stat err =       0.007111763328
              std dev =       0.713481421302
             le_variance =       0.509055738543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508711168669
                                         uncertainty =       0.010270366791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508711168669
                                         uncertainty =       0.010270366791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504507551
  error estimate for blocks of size 2^( 2) =       0.000530425376
  error estimate for blocks of size 2^( 3) =       0.000555031214
  error estimate for blocks of size 2^( 4) =       0.000573869768
  error estimate for blocks of size 2^( 5) =       0.000584738105
  error estimate for blocks of size 2^( 6) =       0.000591105041
  error estimate for blocks of size 2^( 7) =       0.000595990100

      target function =      -0.700444563066
              le_mean =     -22.427052694284
             les_mean =     503.481748036218
             stat err =       0.000586425753
             autocorr =       1.351110058523
   target nu stat err =       0.000586425753
   target dn stat err =       0.010021637806
      target stat err =       0.007111763328
              std dev =       0.713481421302
             le_variance =       0.509055738543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508711168669
                                         uncertainty =       0.010270366791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508711168669
                                         uncertainty =       0.010270366791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504507551
  error estimate for blocks of size 2^( 2) =       0.000530425376
  error estimate for blocks of size 2^( 3) =       0.000555031214
  error estimate for blocks of size 2^( 4) =       0.000573869768
  error estimate for blocks of size 2^( 5) =       0.000584738105
  error estimate for blocks of size 2^( 6) =       0.000591105041
  error estimate for blocks of size 2^( 7) =       0.000595990100

      target function =      -0.700444563066
              le_mean =     -22.427052694284
             les_mean =     503.481748036218
             stat err =       0.000586425753
             autocorr =       1.351110058523
   target nu stat err =       0.000586425753
   target dn stat err =       0.010021637806
      target stat err =       0.007111763328
              std dev =       0.713481421302
             le_variance =       0.509055738543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508711168669
                                         uncertainty =       0.010270366791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508711168669
                                         uncertainty =       0.010270366791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504507551
  error estimate for blocks of size 2^( 2) =       0.000530425376
  error estimate for blocks of size 2^( 3) =       0.000555031214
  error estimate for blocks of size 2^( 4) =       0.000573869768
  error estimate for blocks of size 2^( 5) =       0.000584738105
  error estimate for blocks of size 2^( 6) =       0.000591105041
  error estimate for blocks of size 2^( 7) =       0.000595990100

      target function =      -0.700444563066
              le_mean =     -22.427052694284
             les_mean =     503.481748036218
             stat err =       0.000586425753
             autocorr =       1.351110058523
   target nu stat err =       0.000586425753
   target dn stat err =       0.010021637806
      target stat err =       0.007111763328
              std dev =       0.713481421302
             le_variance =       0.509055738543


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.700444563066        initial  <--
     1.0000e+26     1.0000e+27             5.4560e-31        -0.700444563066
     4.0000e+26     4.0000e+27             1.3640e-31        -0.700444563066
     1.6000e+27     1.6000e+28             3.4100e-32        -0.700444563066

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.5016
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2572e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2433e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.5891
    reference variance = 0.565996
====================================================
  Execution time = 4.5016e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2425e+01
  VMC Evar = 4.9811e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4918e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498141232259
                                         uncertainty =       0.003367285729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498141232259
                                         uncertainty =       0.003367285729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499055929
  error estimate for blocks of size 2^( 2) =       0.000525112836
  error estimate for blocks of size 2^( 3) =       0.000550174189
  error estimate for blocks of size 2^( 4) =       0.000569502206
  error estimate for blocks of size 2^( 5) =       0.000582242544
  error estimate for blocks of size 2^( 6) =       0.000587587698
  error estimate for blocks of size 2^( 7) =       0.000589460091

      target function =      -0.708359838278
              le_mean =     -22.425426002647
             les_mean =     503.397844792539
             stat err =       0.000582198135
             autocorr =       1.360953163206
   target nu stat err =       0.000582198135
   target dn stat err =       0.003445780342
      target stat err =       0.002555849433
              std dev =       0.705771663796
             le_variance =       0.498113641417


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242542600265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+27, overlap shift 1.0000e+28 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708368075990       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708368075990       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708368075990       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+27 is 6.745550e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+27, overlap shift 4.0000e+28 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708368075990       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708368075990       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708368075990       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+27 is 1.686388e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+28, overlap shift 1.6000e+29 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708368075990       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708368075990       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708368076012       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+28 is 1.998190e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.275083 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9941e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.5812
    reference variance = 0.677641
====================================================
  Execution time = 4.4978e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9999e-01
  Total weights = 2.0000e+06
  Execution time = 3.8315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500091322850
                                         uncertainty =       0.004089365247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500091322850
                                         uncertainty =       0.004089365247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499992770
  error estimate for blocks of size 2^( 2) =       0.000525741736
  error estimate for blocks of size 2^( 3) =       0.000550487648
  error estimate for blocks of size 2^( 4) =       0.000569441738
  error estimate for blocks of size 2^( 5) =       0.000581577103
  error estimate for blocks of size 2^( 6) =       0.000589273369
  error estimate for blocks of size 2^( 7) =       0.000590668604

      target function =      -0.706990132648
              le_mean =     -22.426516974077
             les_mean =     503.448648877887
             stat err =       0.000582740203
             autocorr =       1.358383865429
   target nu stat err =       0.000582740203
   target dn stat err =       0.003888609969
      target stat err =       0.002861358380
              std dev =       0.707096555860
             le_variance =       0.499985539309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500091322850
                                         uncertainty =       0.004089365247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500091322850
                                         uncertainty =       0.004089365247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499992770
  error estimate for blocks of size 2^( 2) =       0.000525741736
  error estimate for blocks of size 2^( 3) =       0.000550487648
  error estimate for blocks of size 2^( 4) =       0.000569441738
  error estimate for blocks of size 2^( 5) =       0.000581577103
  error estimate for blocks of size 2^( 6) =       0.000589273369
  error estimate for blocks of size 2^( 7) =       0.000590668604

      target function =      -0.706990132648
              le_mean =     -22.426516974077
             les_mean =     503.448648877887
             stat err =       0.000582740203
             autocorr =       1.358383865429
   target nu stat err =       0.000582740203
   target dn stat err =       0.003888609969
      target stat err =       0.002861358380
              std dev =       0.707096555860
             le_variance =       0.499985539309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500091322850
                                         uncertainty =       0.004089365247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500091322850
                                         uncertainty =       0.004089365247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499992770
  error estimate for blocks of size 2^( 2) =       0.000525741736
  error estimate for blocks of size 2^( 3) =       0.000550487648
  error estimate for blocks of size 2^( 4) =       0.000569441738
  error estimate for blocks of size 2^( 5) =       0.000581577103
  error estimate for blocks of size 2^( 6) =       0.000589273369
  error estimate for blocks of size 2^( 7) =       0.000590668604

      target function =      -0.706990132648
              le_mean =     -22.426516974077
             les_mean =     503.448648877887
             stat err =       0.000582740203
             autocorr =       1.358383865429
   target nu stat err =       0.000582740203
   target dn stat err =       0.003888609969
      target stat err =       0.002861358380
              std dev =       0.707096555860
             le_variance =       0.499985539309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500091322850
                                         uncertainty =       0.004089365247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500091322850
                                         uncertainty =       0.004089365247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499992770
  error estimate for blocks of size 2^( 2) =       0.000525741736
  error estimate for blocks of size 2^( 3) =       0.000550487648
  error estimate for blocks of size 2^( 4) =       0.000569441738
  error estimate for blocks of size 2^( 5) =       0.000581577103
  error estimate for blocks of size 2^( 6) =       0.000589273369
  error estimate for blocks of size 2^( 7) =       0.000590668604

      target function =      -0.706990132648
              le_mean =     -22.426516974077
             les_mean =     503.448648877887
             stat err =       0.000582740203
             autocorr =       1.358383865429
   target nu stat err =       0.000582740203
   target dn stat err =       0.003888609969
      target stat err =       0.002861358380
              std dev =       0.707096555860
             le_variance =       0.499985539309


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706990132648        initial  <--
     1.0000e+27     1.0000e+28             6.7456e-32        -0.706990132648
     4.0000e+27     4.0000e+28             1.6864e-32        -0.706990132648
     1.6000e+28     1.6000e+29             1.9982e-33        -0.706990132648

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.2024
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2415e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.4978
    reference variance = 0.457776
====================================================
  Execution time = 4.6419e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9902e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5456e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498797825235
                                         uncertainty =       0.003133203871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498797825235
                                         uncertainty =       0.003133203871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499507973
  error estimate for blocks of size 2^( 2) =       0.000525986349
  error estimate for blocks of size 2^( 3) =       0.000551283282
  error estimate for blocks of size 2^( 4) =       0.000570934162
  error estimate for blocks of size 2^( 5) =       0.000583450897
  error estimate for blocks of size 2^( 6) =       0.000591125294
  error estimate for blocks of size 2^( 7) =       0.000594825242

      target function =      -0.707705006795
              le_mean =     -22.425775546830
             les_mean =     503.414425058072
             stat err =       0.000585083899
             autocorr =       1.371991571645
   target nu stat err =       0.000585083899
   target dn stat err =       0.003123660446
      target stat err =       0.002328155288
              std dev =       0.706410950355
             le_variance =       0.499016430781


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242577554683e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+28, overlap shift 1.0000e+29 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707711669708       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707711669708       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+28, overlap shift 4.0000e+29 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707711669708       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707711669708       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+29, overlap shift 1.6000e+30 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707711669708       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707711669708       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.276213 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1883e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.5609
    reference variance = 0.651604
====================================================
  Execution time = 4.4880e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9587e-01
  Total weights = 2.0000e+06
  Execution time = 3.8280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495883571096
                                         uncertainty =       0.003927371358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495883571096
                                         uncertainty =       0.003927371358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497929276
  error estimate for blocks of size 2^( 2) =       0.000524478264
  error estimate for blocks of size 2^( 3) =       0.000549220959
  error estimate for blocks of size 2^( 4) =       0.000569003554
  error estimate for blocks of size 2^( 5) =       0.000581543240
  error estimate for blocks of size 2^( 6) =       0.000588694849
  error estimate for blocks of size 2^( 7) =       0.000592777115

      target function =      -0.709972787665
              le_mean =     -22.426234145283
             les_mean =     503.431844818292
             stat err =       0.000583004690
             autocorr =       1.370909461230
   target nu stat err =       0.000583004690
   target dn stat err =       0.003596570820
      target stat err =       0.002676926219
              std dev =       0.704178334790
             le_variance =       0.495867127188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495883571096
                                         uncertainty =       0.003927371358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495883571096
                                         uncertainty =       0.003927371358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497929276
  error estimate for blocks of size 2^( 2) =       0.000524478264
  error estimate for blocks of size 2^( 3) =       0.000549220959
  error estimate for blocks of size 2^( 4) =       0.000569003554
  error estimate for blocks of size 2^( 5) =       0.000581543240
  error estimate for blocks of size 2^( 6) =       0.000588694849
  error estimate for blocks of size 2^( 7) =       0.000592777115

      target function =      -0.709972787665
              le_mean =     -22.426234145283
             les_mean =     503.431844818292
             stat err =       0.000583004690
             autocorr =       1.370909461230
   target nu stat err =       0.000583004690
   target dn stat err =       0.003596570820
      target stat err =       0.002676926219
              std dev =       0.704178334790
             le_variance =       0.495867127188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495883571096
                                         uncertainty =       0.003927371358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495883571096
                                         uncertainty =       0.003927371358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497929276
  error estimate for blocks of size 2^( 2) =       0.000524478264
  error estimate for blocks of size 2^( 3) =       0.000549220959
  error estimate for blocks of size 2^( 4) =       0.000569003554
  error estimate for blocks of size 2^( 5) =       0.000581543240
  error estimate for blocks of size 2^( 6) =       0.000588694849
  error estimate for blocks of size 2^( 7) =       0.000592777115

      target function =      -0.709972787665
              le_mean =     -22.426234145283
             les_mean =     503.431844818292
             stat err =       0.000583004690
             autocorr =       1.370909461230
   target nu stat err =       0.000583004690
   target dn stat err =       0.003596570820
      target stat err =       0.002676926219
              std dev =       0.704178334790
             le_variance =       0.495867127188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495883571096
                                         uncertainty =       0.003927371358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495883571096
                                         uncertainty =       0.003927371358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497929276
  error estimate for blocks of size 2^( 2) =       0.000524478264
  error estimate for blocks of size 2^( 3) =       0.000549220959
  error estimate for blocks of size 2^( 4) =       0.000569003554
  error estimate for blocks of size 2^( 5) =       0.000581543240
  error estimate for blocks of size 2^( 6) =       0.000588694849
  error estimate for blocks of size 2^( 7) =       0.000592777115

      target function =      -0.709972787665
              le_mean =     -22.426234145283
             les_mean =     503.431844818292
             stat err =       0.000583004690
             autocorr =       1.370909461230
   target nu stat err =       0.000583004690
   target dn stat err =       0.003596570820
      target stat err =       0.002676926219
              std dev =       0.704178334790
             le_variance =       0.495867127188


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.709972787665        initial  <--
     1.0000e+28     1.0000e+29             0.0000e+00        -0.709972787665
     4.0000e+28     4.0000e+29             0.0000e+00        -0.709972787665
     1.6000e+29     1.6000e+30             0.0000e+00        -0.709972787665

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0684
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2596e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2442e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.528
    reference variance = 0.39508
====================================================
  Execution time = 4.5385e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0077e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4962e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500856622541
                                         uncertainty =       0.005981556120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500856622541
                                         uncertainty =       0.005981556120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500385382
  error estimate for blocks of size 2^( 2) =       0.000526695196
  error estimate for blocks of size 2^( 3) =       0.000552028573
  error estimate for blocks of size 2^( 4) =       0.000571852275
  error estimate for blocks of size 2^( 5) =       0.000584022939
  error estimate for blocks of size 2^( 6) =       0.000591373142
  error estimate for blocks of size 2^( 7) =       0.000597219998

      target function =      -0.706421923348
              le_mean =     -22.425970416170
             les_mean =     503.424919916978
             stat err =       0.000586117089
             autocorr =       1.372017149835
   target nu stat err =       0.000586117089
   target dn stat err =       0.005772330771
      target stat err =       0.004187881321
              std dev =       0.707651793212
             le_variance =       0.500771060436


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242597041617e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+29, overlap shift 1.0000e+30 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706446100480       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706446100480       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+29, overlap shift 4.0000e+30 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706446100480       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706446100480       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+30, overlap shift 1.6000e+31 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706446100480       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706446100480       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.277334 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0357e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.4494
    reference variance = 0.536274
====================================================
  Execution time = 4.4850e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.2316e-01
  Total weights = 2.0000e+06
  Execution time = 3.8169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523291595591
                                         uncertainty =       0.020814732299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523291595591
                                         uncertainty =       0.020814732299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511448381
  error estimate for blocks of size 2^( 2) =       0.000537481706
  error estimate for blocks of size 2^( 3) =       0.000561690242
  error estimate for blocks of size 2^( 4) =       0.000580563825
  error estimate for blocks of size 2^( 5) =       0.000592132992
  error estimate for blocks of size 2^( 6) =       0.000597458621
  error estimate for blocks of size 2^( 7) =       0.000600848727

      target function =      -0.690396215104
              le_mean =     -22.426700358505
             les_mean =     503.480047600603
             stat err =       0.000592751041
             autocorr =       1.343201088988
   target nu stat err =       0.000592751041
   target dn stat err =       0.021021270344
      target stat err =       0.014451812251
              std dev =       0.723297236296
             le_variance =       0.523158892034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523291595591
                                         uncertainty =       0.020814732299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523291595591
                                         uncertainty =       0.020814732299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511448381
  error estimate for blocks of size 2^( 2) =       0.000537481706
  error estimate for blocks of size 2^( 3) =       0.000561690242
  error estimate for blocks of size 2^( 4) =       0.000580563825
  error estimate for blocks of size 2^( 5) =       0.000592132992
  error estimate for blocks of size 2^( 6) =       0.000597458621
  error estimate for blocks of size 2^( 7) =       0.000600848727

      target function =      -0.690396215104
              le_mean =     -22.426700358505
             les_mean =     503.480047600603
             stat err =       0.000592751041
             autocorr =       1.343201088988
   target nu stat err =       0.000592751041
   target dn stat err =       0.021021270344
      target stat err =       0.014451812251
              std dev =       0.723297236296
             le_variance =       0.523158892034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523291595591
                                         uncertainty =       0.020814732299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523291595591
                                         uncertainty =       0.020814732299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511448381
  error estimate for blocks of size 2^( 2) =       0.000537481706
  error estimate for blocks of size 2^( 3) =       0.000561690242
  error estimate for blocks of size 2^( 4) =       0.000580563825
  error estimate for blocks of size 2^( 5) =       0.000592132992
  error estimate for blocks of size 2^( 6) =       0.000597458621
  error estimate for blocks of size 2^( 7) =       0.000600848727

      target function =      -0.690396215104
              le_mean =     -22.426700358505
             les_mean =     503.480047600603
             stat err =       0.000592751041
             autocorr =       1.343201088988
   target nu stat err =       0.000592751041
   target dn stat err =       0.021021270344
      target stat err =       0.014451812251
              std dev =       0.723297236296
             le_variance =       0.523158892034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523291595591
                                         uncertainty =       0.020814732299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523291595591
                                         uncertainty =       0.020814732299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511448381
  error estimate for blocks of size 2^( 2) =       0.000537481706
  error estimate for blocks of size 2^( 3) =       0.000561690242
  error estimate for blocks of size 2^( 4) =       0.000580563825
  error estimate for blocks of size 2^( 5) =       0.000592132992
  error estimate for blocks of size 2^( 6) =       0.000597458621
  error estimate for blocks of size 2^( 7) =       0.000600848727

      target function =      -0.690396215104
              le_mean =     -22.426700358505
             les_mean =     503.480047600603
             stat err =       0.000592751041
             autocorr =       1.343201088988
   target nu stat err =       0.000592751041
   target dn stat err =       0.021021270344
      target stat err =       0.014451812251
              std dev =       0.723297236296
             le_variance =       0.523158892034


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.690396215104        initial  <--
     1.0000e+29     1.0000e+30             0.0000e+00        -0.690396215104
     4.0000e+29     4.0000e+30             0.0000e+00        -0.690396215104
     1.6000e+30     1.6000e+31             0.0000e+00        -0.690396215104

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9693
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2433e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2443e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.3608
    reference variance = 0.400566
====================================================
  Execution time = 4.4946e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9549e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5256e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495407511856
                                         uncertainty =       0.003506892951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495407511856
                                         uncertainty =       0.003506892951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497738275
  error estimate for blocks of size 2^( 2) =       0.000523922658
  error estimate for blocks of size 2^( 3) =       0.000547987814
  error estimate for blocks of size 2^( 4) =       0.000566227018
  error estimate for blocks of size 2^( 5) =       0.000578436604
  error estimate for blocks of size 2^( 6) =       0.000586117160
  error estimate for blocks of size 2^( 7) =       0.000589230262

      target function =      -0.710246381556
              le_mean =     -22.426551844257
             les_mean =     503.445714155678
             stat err =       0.000580002761
             autocorr =       1.357869538047
   target nu stat err =       0.000580002761
   target dn stat err =       0.003195748416
      target stat err =       0.002396367489
              std dev =       0.703908218637
             le_variance =       0.495486780265


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242655184426e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+30, overlap shift 1.0000e+31 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710253641715       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710253641715       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+30, overlap shift 4.0000e+31 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710253641715       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710253641715       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+31, overlap shift 1.6000e+32 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710253641715       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710253641715       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.278595 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0209e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.3705
    reference variance = 0.594844
====================================================
  Execution time = 4.5417e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2425e+01
  VMC Evar = 4.9673e-01
  Total weights = 2.0000e+06
  Execution time = 4.1596e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496748099659
                                         uncertainty =       0.006409196065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496748099659
                                         uncertainty =       0.006409196065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498360833
  error estimate for blocks of size 2^( 2) =       0.000524765786
  error estimate for blocks of size 2^( 3) =       0.000549776803
  error estimate for blocks of size 2^( 4) =       0.000568786984
  error estimate for blocks of size 2^( 5) =       0.000582145500
  error estimate for blocks of size 2^( 6) =       0.000587823006
  error estimate for blocks of size 2^( 7) =       0.000588848751

      target function =      -0.709347474532
              le_mean =     -22.424842105949
             les_mean =     503.370270268104
             stat err =       0.000581901060
             autocorr =       1.363359820455
   target nu stat err =       0.000581901060
   target dn stat err =       0.006403285705
      target stat err =       0.004666906946
              std dev =       0.704788648984
             le_variance =       0.496727039737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496748099659
                                         uncertainty =       0.006409196065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496748099659
                                         uncertainty =       0.006409196065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498360833
  error estimate for blocks of size 2^( 2) =       0.000524765786
  error estimate for blocks of size 2^( 3) =       0.000549776803
  error estimate for blocks of size 2^( 4) =       0.000568786984
  error estimate for blocks of size 2^( 5) =       0.000582145500
  error estimate for blocks of size 2^( 6) =       0.000587823006
  error estimate for blocks of size 2^( 7) =       0.000588848751

      target function =      -0.709347474532
              le_mean =     -22.424842105949
             les_mean =     503.370270268104
             stat err =       0.000581901060
             autocorr =       1.363359820457
   target nu stat err =       0.000581901060
   target dn stat err =       0.006403285705
      target stat err =       0.004666906946
              std dev =       0.704788648984
             le_variance =       0.496727039737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496748099659
                                         uncertainty =       0.006409196065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496748099659
                                         uncertainty =       0.006409196065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498360833
  error estimate for blocks of size 2^( 2) =       0.000524765786
  error estimate for blocks of size 2^( 3) =       0.000549776803
  error estimate for blocks of size 2^( 4) =       0.000568786984
  error estimate for blocks of size 2^( 5) =       0.000582145500
  error estimate for blocks of size 2^( 6) =       0.000587823006
  error estimate for blocks of size 2^( 7) =       0.000588848751

      target function =      -0.709347474532
              le_mean =     -22.424842105949
             les_mean =     503.370270268104
             stat err =       0.000581901060
             autocorr =       1.363359820457
   target nu stat err =       0.000581901060
   target dn stat err =       0.006403285705
      target stat err =       0.004666906946
              std dev =       0.704788648984
             le_variance =       0.496727039737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496748099659
                                         uncertainty =       0.006409196065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496748099659
                                         uncertainty =       0.006409196065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498360833
  error estimate for blocks of size 2^( 2) =       0.000524765786
  error estimate for blocks of size 2^( 3) =       0.000549776803
  error estimate for blocks of size 2^( 4) =       0.000568786984
  error estimate for blocks of size 2^( 5) =       0.000582145500
  error estimate for blocks of size 2^( 6) =       0.000587823006
  error estimate for blocks of size 2^( 7) =       0.000588848751

      target function =      -0.709347474532
              le_mean =     -22.424842105949
             les_mean =     503.370270268104
             stat err =       0.000581901060
             autocorr =       1.363359820457
   target nu stat err =       0.000581901060
   target dn stat err =       0.006403285705
      target stat err =       0.004666906946
              std dev =       0.704788648984
             le_variance =       0.496727039737


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.709347474532        initial  <--
     1.0000e+30     1.0000e+31             0.0000e+00        -0.709347474532
     4.0000e+30     4.0000e+31             0.0000e+00        -0.709347474532
     1.6000e+31     1.6000e+32             0.0000e+00        -0.709347474532

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.8668
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2508e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2441e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.3598
    reference variance = 0.398885
====================================================
  Execution time = 4.5164e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9842e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5286e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498456784052
                                         uncertainty =       0.003700116727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498456784052
                                         uncertainty =       0.003700116727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499209755
  error estimate for blocks of size 2^( 2) =       0.000525441537
  error estimate for blocks of size 2^( 3) =       0.000550708226
  error estimate for blocks of size 2^( 4) =       0.000570702759
  error estimate for blocks of size 2^( 5) =       0.000582770007
  error estimate for blocks of size 2^( 6) =       0.000588857848
  error estimate for blocks of size 2^( 7) =       0.000596046869

      target function =      -0.708117679291
              le_mean =     -22.426708734570
             les_mean =     503.455685175686
             stat err =       0.000584594371
             autocorr =       1.371333643903
   target nu stat err =       0.000584594371
   target dn stat err =       0.003400072767
      target stat err =       0.002527340916
              std dev =       0.705989206475
             le_variance =       0.498420759659


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242670873457e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+31, overlap shift 1.0000e+32 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708125735420       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708125735420       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -1.235553854227       residual = 5.93e+14           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708125736564       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+31 is 4.247078e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+31, overlap shift 4.0000e+32 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708125735420       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708125735420       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -4.942215416908       residual = 2.37e+15           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708125736564       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+31 is 2.146338e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+32, overlap shift 1.6000e+33 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708125735420       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708125735420       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+32 is 2.654423e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.280039 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0457e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.4648
    reference variance = 0.319877
====================================================
  Execution time = 4.4568e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2425e+01
  VMC Evar = 5.1017e-01
  Total weights = 2.0000e+06
  Execution time = 3.8174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510204841376
                                         uncertainty =       0.006213202017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510204841376
                                         uncertainty =       0.006213202017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505059254
  error estimate for blocks of size 2^( 2) =       0.000531043044
  error estimate for blocks of size 2^( 3) =       0.000555841780
  error estimate for blocks of size 2^( 4) =       0.000574750164
  error estimate for blocks of size 2^( 5) =       0.000586641216
  error estimate for blocks of size 2^( 6) =       0.000594663470
  error estimate for blocks of size 2^( 7) =       0.000598725224

      target function =      -0.699760344522
              le_mean =     -22.424869460705
             les_mean =     503.384939773664
             stat err =       0.000588695018
             autocorr =       1.358613909075
   target nu stat err =       0.000588695018
   target dn stat err =       0.006501805139
      target stat err =       0.004612412830
              std dev =       0.714261646114
             le_variance =       0.510169699109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510204841376
                                         uncertainty =       0.006213202017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510204841376
                                         uncertainty =       0.006213202017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505059254
  error estimate for blocks of size 2^( 2) =       0.000531043044
  error estimate for blocks of size 2^( 3) =       0.000555841780
  error estimate for blocks of size 2^( 4) =       0.000574750164
  error estimate for blocks of size 2^( 5) =       0.000586641216
  error estimate for blocks of size 2^( 6) =       0.000594663470
  error estimate for blocks of size 2^( 7) =       0.000598725224

      target function =      -0.699760344522
              le_mean =     -22.424869460705
             les_mean =     503.384939773664
             stat err =       0.000588695018
             autocorr =       1.358613909075
   target nu stat err =       0.000588695018
   target dn stat err =       0.006501805139
      target stat err =       0.004612412830
              std dev =       0.714261646114
             le_variance =       0.510169699109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510204841376
                                         uncertainty =       0.006213202017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510204841376
                                         uncertainty =       0.006213202017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505059254
  error estimate for blocks of size 2^( 2) =       0.000531043044
  error estimate for blocks of size 2^( 3) =       0.000555841780
  error estimate for blocks of size 2^( 4) =       0.000574750164
  error estimate for blocks of size 2^( 5) =       0.000586641216
  error estimate for blocks of size 2^( 6) =       0.000594663470
  error estimate for blocks of size 2^( 7) =       0.000598725224

      target function =      -0.699760344522
              le_mean =     -22.424869460705
             les_mean =     503.384939773664
             stat err =       0.000588695018
             autocorr =       1.358613909075
   target nu stat err =       0.000588695018
   target dn stat err =       0.006501805139
      target stat err =       0.004612412830
              std dev =       0.714261646114
             le_variance =       0.510169699109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510204841376
                                         uncertainty =       0.006213202017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510204841376
                                         uncertainty =       0.006213202017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505059254
  error estimate for blocks of size 2^( 2) =       0.000531043044
  error estimate for blocks of size 2^( 3) =       0.000555841780
  error estimate for blocks of size 2^( 4) =       0.000574750164
  error estimate for blocks of size 2^( 5) =       0.000586641216
  error estimate for blocks of size 2^( 6) =       0.000594663470
  error estimate for blocks of size 2^( 7) =       0.000598725224

      target function =      -0.699760344522
              le_mean =     -22.424869460705
             les_mean =     503.384939773664
             stat err =       0.000588695018
             autocorr =       1.358613909075
   target nu stat err =       0.000588695018
   target dn stat err =       0.006501805139
      target stat err =       0.004612412830
              std dev =       0.714261646114
             le_variance =       0.510169699109


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.699760344522        initial  <--
     1.0000e+31     1.0000e+32             4.2471e-36        -0.699760344522
     4.0000e+31     4.0000e+32             2.1463e-36        -0.699760344522
     1.6000e+32     1.6000e+33             2.6544e-37        -0.699760344522

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.6921
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2415e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2440e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.4293
    reference variance = 0.537121
====================================================
  Execution time = 4.4779e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9721e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5069e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497257089068
                                         uncertainty =       0.003862745973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497257089068
                                         uncertainty =       0.003862745973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498601880
  error estimate for blocks of size 2^( 2) =       0.000524963114
  error estimate for blocks of size 2^( 3) =       0.000550194348
  error estimate for blocks of size 2^( 4) =       0.000568894129
  error estimate for blocks of size 2^( 5) =       0.000580455416
  error estimate for blocks of size 2^( 6) =       0.000587415182
  error estimate for blocks of size 2^( 7) =       0.000589815243

      target function =      -0.708995969811
              le_mean =     -22.426470618750
             les_mean =     503.443791834642
             stat err =       0.000581644993
             autocorr =       1.360843438554
   target nu stat err =       0.000581644993
   target dn stat err =       0.003916403973
      target stat err =       0.002896534817
              std dev =       0.705129541005
             le_variance =       0.497207669598


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242647061875e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+32, overlap shift 1.0000e+33 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709006844572       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709006844572       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+32, overlap shift 4.0000e+33 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709006844572       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709006844572       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+33, overlap shift 1.6000e+34 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709006844572       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709006844572       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.281144 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9855e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.4548
    reference variance = 0.797691
====================================================
  Execution time = 4.6231e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.1643e-01
  Total weights = 2.0000e+06
  Execution time = 3.8248e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516472796176
                                         uncertainty =       0.016301500044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516472796176
                                         uncertainty =       0.016301500044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508150287
  error estimate for blocks of size 2^( 2) =       0.000534363768
  error estimate for blocks of size 2^( 3) =       0.000559151243
  error estimate for blocks of size 2^( 4) =       0.000577842182
  error estimate for blocks of size 2^( 5) =       0.000588962681
  error estimate for blocks of size 2^( 6) =       0.000595360858
  error estimate for blocks of size 2^( 7) =       0.000599194709

      target function =      -0.695189232710
              le_mean =     -22.425676964130
             les_mean =     503.427420469130
             stat err =       0.000590340107
             autocorr =       1.349647113188
   target nu stat err =       0.000590340107
   target dn stat err =       0.016709656678
      target stat err =       0.011634063256
              std dev =       0.718633027223
             le_variance =       0.516433427816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516472796176
                                         uncertainty =       0.016301500044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516472796176
                                         uncertainty =       0.016301500044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508150287
  error estimate for blocks of size 2^( 2) =       0.000534363768
  error estimate for blocks of size 2^( 3) =       0.000559151243
  error estimate for blocks of size 2^( 4) =       0.000577842182
  error estimate for blocks of size 2^( 5) =       0.000588962681
  error estimate for blocks of size 2^( 6) =       0.000595360858
  error estimate for blocks of size 2^( 7) =       0.000599194709

      target function =      -0.695189232710
              le_mean =     -22.425676964130
             les_mean =     503.427420469130
             stat err =       0.000590340107
             autocorr =       1.349647113188
   target nu stat err =       0.000590340107
   target dn stat err =       0.016709656678
      target stat err =       0.011634063256
              std dev =       0.718633027223
             le_variance =       0.516433427816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516472796176
                                         uncertainty =       0.016301500044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516472796176
                                         uncertainty =       0.016301500044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508150287
  error estimate for blocks of size 2^( 2) =       0.000534363768
  error estimate for blocks of size 2^( 3) =       0.000559151243
  error estimate for blocks of size 2^( 4) =       0.000577842182
  error estimate for blocks of size 2^( 5) =       0.000588962681
  error estimate for blocks of size 2^( 6) =       0.000595360858
  error estimate for blocks of size 2^( 7) =       0.000599194709

      target function =      -0.695189232710
              le_mean =     -22.425676964130
             les_mean =     503.427420469130
             stat err =       0.000590340107
             autocorr =       1.349647113188
   target nu stat err =       0.000590340107
   target dn stat err =       0.016709656678
      target stat err =       0.011634063256
              std dev =       0.718633027223
             le_variance =       0.516433427816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516472796176
                                         uncertainty =       0.016301500044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516472796176
                                         uncertainty =       0.016301500044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508150287
  error estimate for blocks of size 2^( 2) =       0.000534363768
  error estimate for blocks of size 2^( 3) =       0.000559151243
  error estimate for blocks of size 2^( 4) =       0.000577842182
  error estimate for blocks of size 2^( 5) =       0.000588962681
  error estimate for blocks of size 2^( 6) =       0.000595360858
  error estimate for blocks of size 2^( 7) =       0.000599194709

      target function =      -0.695189232710
              le_mean =     -22.425676964130
             les_mean =     503.427420469130
             stat err =       0.000590340107
             autocorr =       1.349647113188
   target nu stat err =       0.000590340107
   target dn stat err =       0.016709656678
      target stat err =       0.011634063256
              std dev =       0.718633027223
             le_variance =       0.516433427816


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.695189232710        initial  <--
     1.0000e+32     1.0000e+33             0.0000e+00        -0.695189232710
     4.0000e+32     4.0000e+33             0.0000e+00        -0.695189232710
     1.6000e+33     1.6000e+34             0.0000e+00        -0.695189232710

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.3982
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2526e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2440e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.4785
    reference variance = 0.484296
====================================================
  Execution time = 4.7293e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2425e+01
  VMC Evar = 5.5840e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5143e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558428982893
                                         uncertainty =       0.064752281927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558428982893
                                         uncertainty =       0.064752281927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528394638
  error estimate for blocks of size 2^( 2) =       0.000553614522
  error estimate for blocks of size 2^( 3) =       0.000577768309
  error estimate for blocks of size 2^( 4) =       0.000596583854
  error estimate for blocks of size 2^( 5) =       0.000607885211
  error estimate for blocks of size 2^( 6) =       0.000614233748
  error estimate for blocks of size 2^( 7) =       0.000617967274

      target function =      -0.664821483706
              le_mean =     -22.425373299736
             les_mean =     503.455769139723
             stat err =       0.000609167522
             autocorr =       1.329096999975
   target nu stat err =       0.000609167522
   target dn stat err =       0.064945866788
      target stat err =       0.041434863109
              std dev =       0.747262863001
             le_variance =       0.558401786421


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242537329974e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+33, overlap shift 1.0000e+34 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.667390214849       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.667390214849       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+33, overlap shift 4.0000e+34 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.667390214849       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.667390214849       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+34, overlap shift 1.6000e+35 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.667390214849       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.667390214849       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.282252 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2443e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.4279
    reference variance = 0.635913
====================================================
  Execution time = 4.4807e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2425e+01
  VMC Evar = 4.9891e-01
  Total weights = 2.0000e+06
  Execution time = 3.8218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498896139187
                                         uncertainty =       0.003011113418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498896139187
                                         uncertainty =       0.003011113418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499456454
  error estimate for blocks of size 2^( 2) =       0.000525676596
  error estimate for blocks of size 2^( 3) =       0.000551179706
  error estimate for blocks of size 2^( 4) =       0.000570648713
  error estimate for blocks of size 2^( 5) =       0.000583346052
  error estimate for blocks of size 2^( 6) =       0.000591390269
  error estimate for blocks of size 2^( 7) =       0.000593397601

      target function =      -0.707794833812
              le_mean =     -22.424755705452
             les_mean =     503.368581698582
             stat err =       0.000584695659
             autocorr =       1.370454053858
   target nu stat err =       0.000584695659
   target dn stat err =       0.003177174802
      target stat err =       0.002362467150
              std dev =       0.706338091028
             le_variance =       0.498913498837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498896139187
                                         uncertainty =       0.003011113418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498896139187
                                         uncertainty =       0.003011113418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499456454
  error estimate for blocks of size 2^( 2) =       0.000525676596
  error estimate for blocks of size 2^( 3) =       0.000551179706
  error estimate for blocks of size 2^( 4) =       0.000570648713
  error estimate for blocks of size 2^( 5) =       0.000583346052
  error estimate for blocks of size 2^( 6) =       0.000591390269
  error estimate for blocks of size 2^( 7) =       0.000593397601

      target function =      -0.707794833812
              le_mean =     -22.424755705452
             les_mean =     503.368581698582
             stat err =       0.000584695659
             autocorr =       1.370454053858
   target nu stat err =       0.000584695659
   target dn stat err =       0.003177174802
      target stat err =       0.002362467150
              std dev =       0.706338091028
             le_variance =       0.498913498837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498896139187
                                         uncertainty =       0.003011113418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498896139187
                                         uncertainty =       0.003011113418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499456454
  error estimate for blocks of size 2^( 2) =       0.000525676596
  error estimate for blocks of size 2^( 3) =       0.000551179706
  error estimate for blocks of size 2^( 4) =       0.000570648713
  error estimate for blocks of size 2^( 5) =       0.000583346052
  error estimate for blocks of size 2^( 6) =       0.000591390269
  error estimate for blocks of size 2^( 7) =       0.000593397601

      target function =      -0.707794833812
              le_mean =     -22.424755705452
             les_mean =     503.368581698582
             stat err =       0.000584695659
             autocorr =       1.370454053858
   target nu stat err =       0.000584695659
   target dn stat err =       0.003177174802
      target stat err =       0.002362467150
              std dev =       0.706338091028
             le_variance =       0.498913498837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498896139187
                                         uncertainty =       0.003011113418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498896139187
                                         uncertainty =       0.003011113418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499456454
  error estimate for blocks of size 2^( 2) =       0.000525676596
  error estimate for blocks of size 2^( 3) =       0.000551179706
  error estimate for blocks of size 2^( 4) =       0.000570648713
  error estimate for blocks of size 2^( 5) =       0.000583346052
  error estimate for blocks of size 2^( 6) =       0.000591390269
  error estimate for blocks of size 2^( 7) =       0.000593397601

      target function =      -0.707794833812
              le_mean =     -22.424755705452
             les_mean =     503.368581698582
             stat err =       0.000584695659
             autocorr =       1.370454053858
   target nu stat err =       0.000584695659
   target dn stat err =       0.003177174802
      target stat err =       0.002362467150
              std dev =       0.706338091028
             le_variance =       0.498913498837


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707794833812        initial  <--
     1.0000e+33     1.0000e+34             0.0000e+00        -0.707794833812
     4.0000e+33     4.0000e+34             0.0000e+00        -0.707794833812
     1.6000e+34     1.6000e+35             0.0000e+00        -0.707794833812

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9435
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2639e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2440e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.4721
    reference variance = 0.375183
====================================================
  Execution time = 4.4912e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9760e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5149e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497599735457
                                         uncertainty =       0.003001057181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497599735457
                                         uncertainty =       0.003001057181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498798170
  error estimate for blocks of size 2^( 2) =       0.000524696063
  error estimate for blocks of size 2^( 3) =       0.000549524768
  error estimate for blocks of size 2^( 4) =       0.000568528981
  error estimate for blocks of size 2^( 5) =       0.000581714106
  error estimate for blocks of size 2^( 6) =       0.000589572849
  error estimate for blocks of size 2^( 7) =       0.000590630791

      target function =      -0.708722074722
              le_mean =     -22.426072013006
             les_mean =     503.426304913392
             stat err =       0.000582611682
             autocorr =       1.364296210516
   target nu stat err =       0.000582611682
   target dn stat err =       0.003310841311
      target stat err =       0.002466087273
              std dev =       0.705407137525
             le_variance =       0.497599229671


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242607201301e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+34, overlap shift 1.0000e+35 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708729773167       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708729773167       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+34, overlap shift 4.0000e+35 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708729773167       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708729773167       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+35, overlap shift 1.6000e+36 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708729773167       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708729773167       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.283389 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0067e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.4026
    reference variance = 0.494713
====================================================
  Execution time = 4.5090e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0601e-01
  Total weights = 2.0000e+06
  Execution time = 3.8295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505985373403
                                         uncertainty =       0.003708820643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505985373403
                                         uncertainty =       0.003708820643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502997654
  error estimate for blocks of size 2^( 2) =       0.000529453694
  error estimate for blocks of size 2^( 3) =       0.000554189741
  error estimate for blocks of size 2^( 4) =       0.000573005373
  error estimate for blocks of size 2^( 5) =       0.000584884964
  error estimate for blocks of size 2^( 6) =       0.000588594042
  error estimate for blocks of size 2^( 7) =       0.000589224545

      target function =      -0.702681582365
              le_mean =     -22.426300786282
             les_mean =     503.444979983980
             stat err =       0.000583927231
             autocorr =       1.347676135978
   target nu stat err =       0.000583927231
   target dn stat err =       0.004081165463
      target stat err =       0.002960710091
              std dev =       0.711346104358
             le_variance =       0.506013280185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505985373403
                                         uncertainty =       0.003708820643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505985373403
                                         uncertainty =       0.003708820643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502997654
  error estimate for blocks of size 2^( 2) =       0.000529453694
  error estimate for blocks of size 2^( 3) =       0.000554189741
  error estimate for blocks of size 2^( 4) =       0.000573005373
  error estimate for blocks of size 2^( 5) =       0.000584884964
  error estimate for blocks of size 2^( 6) =       0.000588594042
  error estimate for blocks of size 2^( 7) =       0.000589224545

      target function =      -0.702681582365
              le_mean =     -22.426300786282
             les_mean =     503.444979983980
             stat err =       0.000583927231
             autocorr =       1.347676135978
   target nu stat err =       0.000583927231
   target dn stat err =       0.004081165463
      target stat err =       0.002960710091
              std dev =       0.711346104358
             le_variance =       0.506013280185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505985373403
                                         uncertainty =       0.003708820643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505985373403
                                         uncertainty =       0.003708820643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502997654
  error estimate for blocks of size 2^( 2) =       0.000529453694
  error estimate for blocks of size 2^( 3) =       0.000554189741
  error estimate for blocks of size 2^( 4) =       0.000573005373
  error estimate for blocks of size 2^( 5) =       0.000584884964
  error estimate for blocks of size 2^( 6) =       0.000588594042
  error estimate for blocks of size 2^( 7) =       0.000589224545

      target function =      -0.702681582365
              le_mean =     -22.426300786282
             les_mean =     503.444979983980
             stat err =       0.000583927231
             autocorr =       1.347676135978
   target nu stat err =       0.000583927231
   target dn stat err =       0.004081165463
      target stat err =       0.002960710091
              std dev =       0.711346104358
             le_variance =       0.506013280185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505985373403
                                         uncertainty =       0.003708820643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505985373403
                                         uncertainty =       0.003708820643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502997654
  error estimate for blocks of size 2^( 2) =       0.000529453694
  error estimate for blocks of size 2^( 3) =       0.000554189741
  error estimate for blocks of size 2^( 4) =       0.000573005373
  error estimate for blocks of size 2^( 5) =       0.000584884964
  error estimate for blocks of size 2^( 6) =       0.000588594042
  error estimate for blocks of size 2^( 7) =       0.000589224545

      target function =      -0.702681582365
              le_mean =     -22.426300786282
             les_mean =     503.444979983980
             stat err =       0.000583927231
             autocorr =       1.347676135978
   target nu stat err =       0.000583927231
   target dn stat err =       0.004081165463
      target stat err =       0.002960710091
              std dev =       0.711346104358
             le_variance =       0.506013280185


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.702681582365        initial  <--
     1.0000e+34     1.0000e+35             0.0000e+00        -0.702681582365
     4.0000e+34     4.0000e+35             0.0000e+00        -0.702681582365
     1.6000e+35     1.6000e+36             0.0000e+00        -0.702681582365

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.3185
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2439e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2440e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.5507
    reference variance = 0.470268
====================================================
  Execution time = 4.6763e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.1532e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5105e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515373061798
                                         uncertainty =       0.009723362001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515373061798
                                         uncertainty =       0.009723362001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507600476
  error estimate for blocks of size 2^( 2) =       0.000532942187
  error estimate for blocks of size 2^( 3) =       0.000557593531
  error estimate for blocks of size 2^( 4) =       0.000576238223
  error estimate for blocks of size 2^( 5) =       0.000588050044
  error estimate for blocks of size 2^( 6) =       0.000594655492
  error estimate for blocks of size 2^( 7) =       0.000598301567

      target function =      -0.696056479228
              le_mean =     -22.426659465344
             les_mean =     503.470371003140
             stat err =       0.000589311331
             autocorr =       1.347862350947
   target nu stat err =       0.000589311331
   target dn stat err =       0.010315306761
      target stat err =       0.007223785914
              std dev =       0.717855477306
             le_variance =       0.515316486298


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242665946534e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+35, overlap shift 1.0000e+36 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696129704157       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696129704157       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+35, overlap shift 4.0000e+36 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696129704157       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696129704157       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+36, overlap shift 1.6000e+37 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696129704157       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696129704157       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.284498 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1875e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.442
    reference variance = 0.348435
====================================================
  Execution time = 4.6326e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2425e+01
  VMC Evar = 5.0107e-01
  Total weights = 2.0000e+06
  Execution time = 3.8258e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500598773975
                                         uncertainty =       0.004475627428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500598773975
                                         uncertainty =       0.004475627428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500533487
  error estimate for blocks of size 2^( 2) =       0.000526759761
  error estimate for blocks of size 2^( 3) =       0.000551402525
  error estimate for blocks of size 2^( 4) =       0.000570555575
  error estimate for blocks of size 2^( 5) =       0.000582171987
  error estimate for blocks of size 2^( 6) =       0.000587817112
  error estimate for blocks of size 2^( 7) =       0.000589221887

      target function =      -0.706231874304
              le_mean =     -22.425339348377
             les_mean =     503.396912183496
             stat err =       0.000582441640
             autocorr =       1.354062014619
   target nu stat err =       0.000582441640
   target dn stat err =       0.004291279604
      target stat err =       0.003133504011
              std dev =       0.707861246403
             le_variance =       0.501067544159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500598773975
                                         uncertainty =       0.004475627428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500598773975
                                         uncertainty =       0.004475627428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500533487
  error estimate for blocks of size 2^( 2) =       0.000526759761
  error estimate for blocks of size 2^( 3) =       0.000551402525
  error estimate for blocks of size 2^( 4) =       0.000570555575
  error estimate for blocks of size 2^( 5) =       0.000582171987
  error estimate for blocks of size 2^( 6) =       0.000587817112
  error estimate for blocks of size 2^( 7) =       0.000589221887

      target function =      -0.706231874304
              le_mean =     -22.425339348377
             les_mean =     503.396912183496
             stat err =       0.000582441640
             autocorr =       1.354062014619
   target nu stat err =       0.000582441640
   target dn stat err =       0.004291279604
      target stat err =       0.003133504011
              std dev =       0.707861246403
             le_variance =       0.501067544159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500598773975
                                         uncertainty =       0.004475627428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500598773975
                                         uncertainty =       0.004475627428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500533487
  error estimate for blocks of size 2^( 2) =       0.000526759761
  error estimate for blocks of size 2^( 3) =       0.000551402525
  error estimate for blocks of size 2^( 4) =       0.000570555575
  error estimate for blocks of size 2^( 5) =       0.000582171987
  error estimate for blocks of size 2^( 6) =       0.000587817112
  error estimate for blocks of size 2^( 7) =       0.000589221887

      target function =      -0.706231874304
              le_mean =     -22.425339348377
             les_mean =     503.396912183496
             stat err =       0.000582441640
             autocorr =       1.354062014619
   target nu stat err =       0.000582441640
   target dn stat err =       0.004291279604
      target stat err =       0.003133504011
              std dev =       0.707861246403
             le_variance =       0.501067544159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500598773975
                                         uncertainty =       0.004475627428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500598773975
                                         uncertainty =       0.004475627428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500533487
  error estimate for blocks of size 2^( 2) =       0.000526759761
  error estimate for blocks of size 2^( 3) =       0.000551402525
  error estimate for blocks of size 2^( 4) =       0.000570555575
  error estimate for blocks of size 2^( 5) =       0.000582171987
  error estimate for blocks of size 2^( 6) =       0.000587817112
  error estimate for blocks of size 2^( 7) =       0.000589221887

      target function =      -0.706231874304
              le_mean =     -22.425339348377
             les_mean =     503.396912183496
             stat err =       0.000582441640
             autocorr =       1.354062014619
   target nu stat err =       0.000582441640
   target dn stat err =       0.004291279604
      target stat err =       0.003133504011
              std dev =       0.707861246403
             le_variance =       0.501067544159


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706231874304        initial  <--
     1.0000e+35     1.0000e+36             0.0000e+00        -0.706231874304
     4.0000e+35     4.0000e+36             0.0000e+00        -0.706231874304
     1.6000e+36     1.6000e+37             0.0000e+00        -0.706231874304

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.4729
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2735e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2442e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.3824
    reference variance = 0.408963
====================================================
  Execution time = 4.5234e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0123e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5061e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501272560492
                                         uncertainty =       0.004109812692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501272560492
                                         uncertainty =       0.004109812692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500615620
  error estimate for blocks of size 2^( 2) =       0.000526345405
  error estimate for blocks of size 2^( 3) =       0.000551640580
  error estimate for blocks of size 2^( 4) =       0.000570691990
  error estimate for blocks of size 2^( 5) =       0.000582020204
  error estimate for blocks of size 2^( 6) =       0.000589934453
  error estimate for blocks of size 2^( 7) =       0.000592859612

      target function =      -0.706097632961
              le_mean =     -22.426261569758
             les_mean =     503.438439743393
             stat err =       0.000583876565
             autocorr =       1.360295605797
   target nu stat err =       0.000583876565
   target dn stat err =       0.004114487557
      target stat err =       0.003012258421
              std dev =       0.707977399929
             le_variance =       0.501231998810


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242626156976e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+36, overlap shift 1.0000e+37 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706109665049       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706109665049       residual = 8.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706109665049       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706054687500       residual = 3.57e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706054687500       residual = 2.56e+01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+36 is 6.389729e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+36, overlap shift 4.0000e+37 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706109665049       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706109665049       residual = 8.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706109665049       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706054687500       residual = 3.57e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706110000610       residual = 1.16e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.687500000000       residual = 9.82e+06           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+36 is 1.597432e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+37, overlap shift 1.6000e+38 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706109665049       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706109665049       residual = 8.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706109665049       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706054687500       residual = 3.57e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+37 is 3.993580e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.286459 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0302e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.385
    reference variance = 0.466503
====================================================
  Execution time = 4.4524e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0176e-01
  Total weights = 2.0000e+06
  Execution time = 3.8156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501759124292
                                         uncertainty =       0.004650264673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501759124292
                                         uncertainty =       0.004650264673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500878188
  error estimate for blocks of size 2^( 2) =       0.000526508258
  error estimate for blocks of size 2^( 3) =       0.000552318611
  error estimate for blocks of size 2^( 4) =       0.000571175255
  error estimate for blocks of size 2^( 5) =       0.000583788361
  error estimate for blocks of size 2^( 6) =       0.000591957108
  error estimate for blocks of size 2^( 7) =       0.000597101182

      target function =      -0.705724966647
              le_mean =     -22.425848158022
             les_mean =     503.420423274835
             stat err =       0.000586005476
             autocorr =       1.368797204317
   target nu stat err =       0.000586005476
   target dn stat err =       0.004699867745
      target stat err =       0.003419980697
              std dev =       0.708348727012
             le_variance =       0.501757919060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501759124292
                                         uncertainty =       0.004650264673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501759124292
                                         uncertainty =       0.004650264673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500878188
  error estimate for blocks of size 2^( 2) =       0.000526508258
  error estimate for blocks of size 2^( 3) =       0.000552318611
  error estimate for blocks of size 2^( 4) =       0.000571175255
  error estimate for blocks of size 2^( 5) =       0.000583788361
  error estimate for blocks of size 2^( 6) =       0.000591957108
  error estimate for blocks of size 2^( 7) =       0.000597101182

      target function =      -0.705724966647
              le_mean =     -22.425848158022
             les_mean =     503.420423274835
             stat err =       0.000586005476
             autocorr =       1.368797204317
   target nu stat err =       0.000586005476
   target dn stat err =       0.004699867745
      target stat err =       0.003419980697
              std dev =       0.708348727012
             le_variance =       0.501757919060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501759124292
                                         uncertainty =       0.004650264673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501759124292
                                         uncertainty =       0.004650264673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500878188
  error estimate for blocks of size 2^( 2) =       0.000526508258
  error estimate for blocks of size 2^( 3) =       0.000552318611
  error estimate for blocks of size 2^( 4) =       0.000571175255
  error estimate for blocks of size 2^( 5) =       0.000583788361
  error estimate for blocks of size 2^( 6) =       0.000591957108
  error estimate for blocks of size 2^( 7) =       0.000597101182

      target function =      -0.705724966647
              le_mean =     -22.425848158022
             les_mean =     503.420423274835
             stat err =       0.000586005476
             autocorr =       1.368797204317
   target nu stat err =       0.000586005476
   target dn stat err =       0.004699867745
      target stat err =       0.003419980697
              std dev =       0.708348727012
             le_variance =       0.501757919060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501759124292
                                         uncertainty =       0.004650264673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501759124292
                                         uncertainty =       0.004650264673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500878188
  error estimate for blocks of size 2^( 2) =       0.000526508258
  error estimate for blocks of size 2^( 3) =       0.000552318611
  error estimate for blocks of size 2^( 4) =       0.000571175255
  error estimate for blocks of size 2^( 5) =       0.000583788361
  error estimate for blocks of size 2^( 6) =       0.000591957108
  error estimate for blocks of size 2^( 7) =       0.000597101182

      target function =      -0.705724966647
              le_mean =     -22.425848158022
             les_mean =     503.420423274835
             stat err =       0.000586005476
             autocorr =       1.368797204317
   target nu stat err =       0.000586005476
   target dn stat err =       0.004699867745
      target stat err =       0.003419980697
              std dev =       0.708348727012
             le_variance =       0.501757919060


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.705724966647        initial  <--
     1.0000e+36     1.0000e+37             6.3897e-41        -0.705724966647
     4.0000e+36     4.0000e+37             1.5974e-41        -0.705724966647
     1.6000e+37     1.6000e+38             3.9936e-42        -0.705724966647

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.6618
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2397e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2440e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.5984
    reference variance = 0.656833
====================================================
  Execution time = 4.5129e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9263e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5092e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492573066901
                                         uncertainty =       0.002428905672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492573066901
                                         uncertainty =       0.002428905672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496303815
  error estimate for blocks of size 2^( 2) =       0.000522633135
  error estimate for blocks of size 2^( 3) =       0.000547673473
  error estimate for blocks of size 2^( 4) =       0.000566765812
  error estimate for blocks of size 2^( 5) =       0.000578618138
  error estimate for blocks of size 2^( 6) =       0.000583205857
  error estimate for blocks of size 2^( 7) =       0.000587060640

      target function =      -0.712328278650
              le_mean =     -22.426455036174
             les_mean =     503.438520197168
             stat err =       0.000578912612
             autocorr =       1.360601027695
   target nu stat err =       0.000578912612
   target dn stat err =       0.002552496137
      target stat err =       0.001957304178
              std dev =       0.701879586514
             le_variance =       0.492634953966


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242645503617e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+37, overlap shift 1.0000e+38 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712332687775       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712332687775       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+37, overlap shift 4.0000e+38 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712332687775       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712332687775       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+38, overlap shift 1.6000e+39 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712332687775       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712332687775       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.287580 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0227e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.3807
    reference variance = 0.306785
====================================================
  Execution time = 4.6127e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9681e-01
  Total weights = 2.0000e+06
  Execution time = 3.8375e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496773866186
                                         uncertainty =       0.003766232421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496773866186
                                         uncertainty =       0.003766232421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498403607
  error estimate for blocks of size 2^( 2) =       0.000524819801
  error estimate for blocks of size 2^( 3) =       0.000549216156
  error estimate for blocks of size 2^( 4) =       0.000568778269
  error estimate for blocks of size 2^( 5) =       0.000581244317
  error estimate for blocks of size 2^( 6) =       0.000587498000
  error estimate for blocks of size 2^( 7) =       0.000590513441

      target function =      -0.709284211990
              le_mean =     -22.426511810856
             les_mean =     503.445244065525
             stat err =       0.000582008507
             autocorr =       1.363629258292
   target nu stat err =       0.000582008507
   target dn stat err =       0.003449257993
      target stat err =       0.002568757828
              std dev =       0.704849140928
             le_variance =       0.496812311467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496773866186
                                         uncertainty =       0.003766232421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496773866186
                                         uncertainty =       0.003766232421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498403607
  error estimate for blocks of size 2^( 2) =       0.000524819801
  error estimate for blocks of size 2^( 3) =       0.000549216156
  error estimate for blocks of size 2^( 4) =       0.000568778269
  error estimate for blocks of size 2^( 5) =       0.000581244317
  error estimate for blocks of size 2^( 6) =       0.000587498000
  error estimate for blocks of size 2^( 7) =       0.000590513441

      target function =      -0.709284211990
              le_mean =     -22.426511810856
             les_mean =     503.445244065525
             stat err =       0.000582008507
             autocorr =       1.363629258292
   target nu stat err =       0.000582008507
   target dn stat err =       0.003449257993
      target stat err =       0.002568757828
              std dev =       0.704849140928
             le_variance =       0.496812311467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496773866186
                                         uncertainty =       0.003766232421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496773866186
                                         uncertainty =       0.003766232421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498403607
  error estimate for blocks of size 2^( 2) =       0.000524819801
  error estimate for blocks of size 2^( 3) =       0.000549216156
  error estimate for blocks of size 2^( 4) =       0.000568778269
  error estimate for blocks of size 2^( 5) =       0.000581244317
  error estimate for blocks of size 2^( 6) =       0.000587498000
  error estimate for blocks of size 2^( 7) =       0.000590513441

      target function =      -0.709284211990
              le_mean =     -22.426511810856
             les_mean =     503.445244065525
             stat err =       0.000582008507
             autocorr =       1.363629258292
   target nu stat err =       0.000582008507
   target dn stat err =       0.003449257993
      target stat err =       0.002568757828
              std dev =       0.704849140928
             le_variance =       0.496812311467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496773866186
                                         uncertainty =       0.003766232421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496773866186
                                         uncertainty =       0.003766232421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498403607
  error estimate for blocks of size 2^( 2) =       0.000524819801
  error estimate for blocks of size 2^( 3) =       0.000549216156
  error estimate for blocks of size 2^( 4) =       0.000568778269
  error estimate for blocks of size 2^( 5) =       0.000581244317
  error estimate for blocks of size 2^( 6) =       0.000587498000
  error estimate for blocks of size 2^( 7) =       0.000590513441

      target function =      -0.709284211990
              le_mean =     -22.426511810856
             les_mean =     503.445244065525
             stat err =       0.000582008507
             autocorr =       1.363629258292
   target nu stat err =       0.000582008507
   target dn stat err =       0.003449257993
      target stat err =       0.002568757828
              std dev =       0.704849140928
             le_variance =       0.496812311467


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.709284211990        initial  <--
     1.0000e+37     1.0000e+38             0.0000e+00        -0.709284211990
     4.0000e+37     4.0000e+38             0.0000e+00        -0.709284211990
     1.6000e+38     1.6000e+39             0.0000e+00        -0.709284211990

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.3446
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2558e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2441e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.5041
    reference variance = 0.506503
====================================================
  Execution time = 4.7221e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.1149e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5076e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511626381633
                                         uncertainty =       0.005052182612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511626381633
                                         uncertainty =       0.005052182612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505710369
  error estimate for blocks of size 2^( 2) =       0.000531846571
  error estimate for blocks of size 2^( 3) =       0.000556548148
  error estimate for blocks of size 2^( 4) =       0.000574883961
  error estimate for blocks of size 2^( 5) =       0.000587650145
  error estimate for blocks of size 2^( 6) =       0.000593631339
  error estimate for blocks of size 2^( 7) =       0.000597329190

      target function =      -0.698775461683
              le_mean =     -22.427284999232
             les_mean =     503.494598135431
             stat err =       0.000588373659
             autocorr =       1.353638586909
   target nu stat err =       0.000588373659
   target dn stat err =       0.005313528762
      target stat err =       0.003787367761
              std dev =       0.715182462315
             le_variance =       0.511485954403


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242728499923e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+38, overlap shift 1.0000e+39 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.698794818635       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.698794818635       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+38, overlap shift 4.0000e+39 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.698794818635       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.698794818635       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+39, overlap shift 1.6000e+40 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.698794818635       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.698794818635       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.288701 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2304e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.3974
    reference variance = 0.435345
====================================================
  Execution time = 4.4973e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0256e-01
  Total weights = 2.0000e+06
  Execution time = 3.8154e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502626506115
                                         uncertainty =       0.008480941159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502626506115
                                         uncertainty =       0.008480941159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501280564
  error estimate for blocks of size 2^( 2) =       0.000527182629
  error estimate for blocks of size 2^( 3) =       0.000552031446
  error estimate for blocks of size 2^( 4) =       0.000570561727
  error estimate for blocks of size 2^( 5) =       0.000582053613
  error estimate for blocks of size 2^( 6) =       0.000589990249
  error estimate for blocks of size 2^( 7) =       0.000591559244

      target function =      -0.705091539884
              le_mean =     -22.426902618506
             les_mean =     503.468525217085
             stat err =       0.000583541208
             autocorr =       1.355131147803
   target nu stat err =       0.000583541208
   target dn stat err =       0.008244996097
      target stat err =       0.005936509835
              std dev =       0.708917772689
             le_variance =       0.502564408435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502626506115
                                         uncertainty =       0.008480941159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502626506115
                                         uncertainty =       0.008480941159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501280564
  error estimate for blocks of size 2^( 2) =       0.000527182629
  error estimate for blocks of size 2^( 3) =       0.000552031446
  error estimate for blocks of size 2^( 4) =       0.000570561727
  error estimate for blocks of size 2^( 5) =       0.000582053613
  error estimate for blocks of size 2^( 6) =       0.000589990249
  error estimate for blocks of size 2^( 7) =       0.000591559244

      target function =      -0.705091539884
              le_mean =     -22.426902618506
             les_mean =     503.468525217085
             stat err =       0.000583541208
             autocorr =       1.355131147801
   target nu stat err =       0.000583541208
   target dn stat err =       0.008244996097
      target stat err =       0.005936509835
              std dev =       0.708917772689
             le_variance =       0.502564408435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502626506115
                                         uncertainty =       0.008480941159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502626506115
                                         uncertainty =       0.008480941159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501280564
  error estimate for blocks of size 2^( 2) =       0.000527182629
  error estimate for blocks of size 2^( 3) =       0.000552031446
  error estimate for blocks of size 2^( 4) =       0.000570561727
  error estimate for blocks of size 2^( 5) =       0.000582053613
  error estimate for blocks of size 2^( 6) =       0.000589990249
  error estimate for blocks of size 2^( 7) =       0.000591559244

      target function =      -0.705091539884
              le_mean =     -22.426902618506
             les_mean =     503.468525217085
             stat err =       0.000583541208
             autocorr =       1.355131147801
   target nu stat err =       0.000583541208
   target dn stat err =       0.008244996097
      target stat err =       0.005936509835
              std dev =       0.708917772689
             le_variance =       0.502564408435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502626506115
                                         uncertainty =       0.008480941159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502626506115
                                         uncertainty =       0.008480941159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501280564
  error estimate for blocks of size 2^( 2) =       0.000527182629
  error estimate for blocks of size 2^( 3) =       0.000552031446
  error estimate for blocks of size 2^( 4) =       0.000570561727
  error estimate for blocks of size 2^( 5) =       0.000582053613
  error estimate for blocks of size 2^( 6) =       0.000589990249
  error estimate for blocks of size 2^( 7) =       0.000591559244

      target function =      -0.705091539884
              le_mean =     -22.426902618506
             les_mean =     503.468525217085
             stat err =       0.000583541208
             autocorr =       1.355131147801
   target nu stat err =       0.000583541208
   target dn stat err =       0.008244996097
      target stat err =       0.005936509835
              std dev =       0.708917772689
             le_variance =       0.502564408435


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.705091539884        initial  <--
     1.0000e+38     1.0000e+39             0.0000e+00        -0.705091539884
     4.0000e+38     4.0000e+39             0.0000e+00        -0.705091539884
     1.6000e+39     1.6000e+40             0.0000e+00        -0.705091539884

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.1044
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2641e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2442e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.5183
    reference variance = 0.52207
====================================================
  Execution time = 4.4691e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9798e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5089e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497690353918
                                         uncertainty =       0.004213745161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497690353918
                                         uncertainty =       0.004213745161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498988511
  error estimate for blocks of size 2^( 2) =       0.000525461105
  error estimate for blocks of size 2^( 3) =       0.000550313225
  error estimate for blocks of size 2^( 4) =       0.000569390765
  error estimate for blocks of size 2^( 5) =       0.000581321039
  error estimate for blocks of size 2^( 6) =       0.000586677212
  error estimate for blocks of size 2^( 7) =       0.000590937709

      target function =      -0.708447779888
              le_mean =     -22.425634438077
             les_mean =     503.407058769293
             stat err =       0.000582081681
             autocorr =       1.360776408375
   target nu stat err =       0.000582081681
   target dn stat err =       0.004496401021
      target stat err =       0.003299674707
              std dev =       0.705676319570
             le_variance =       0.497979068001


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242563443808e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+39, overlap shift 1.0000e+40 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708462059857       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708462059857       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708462059498       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+39 is 2.926639e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+39, overlap shift 4.0000e+40 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708462059857       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708462059857       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708462059857       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+39 is 7.316598e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+40, overlap shift 1.6000e+41 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708462059857       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708462059857       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708462059498       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+40 is 1.829150e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.290073 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9786e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.42
    reference variance = 0.439249
====================================================
  Execution time = 4.4501e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9337e-01
  Total weights = 2.0000e+06
  Execution time = 3.8206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493448451794
                                         uncertainty =       0.002960362314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493448451794
                                         uncertainty =       0.002960362314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496671551
  error estimate for blocks of size 2^( 2) =       0.000523443644
  error estimate for blocks of size 2^( 3) =       0.000548750169
  error estimate for blocks of size 2^( 4) =       0.000568073755
  error estimate for blocks of size 2^( 5) =       0.000579606469
  error estimate for blocks of size 2^( 6) =       0.000585459196
  error estimate for blocks of size 2^( 7) =       0.000588492896

      target function =      -0.711787281070
              le_mean =     -22.426948272790
             les_mean =     503.461373842389
             stat err =       0.000580408079
             autocorr =       1.365615159427
   target nu stat err =       0.000580408079
   target dn stat err =       0.002975867896
      target stat err =       0.002252733004
              std dev =       0.702399643127
             le_variance =       0.493365258665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493448451794
                                         uncertainty =       0.002960362314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493448451794
                                         uncertainty =       0.002960362314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496671551
  error estimate for blocks of size 2^( 2) =       0.000523443644
  error estimate for blocks of size 2^( 3) =       0.000548750169
  error estimate for blocks of size 2^( 4) =       0.000568073755
  error estimate for blocks of size 2^( 5) =       0.000579606469
  error estimate for blocks of size 2^( 6) =       0.000585459196
  error estimate for blocks of size 2^( 7) =       0.000588492896

      target function =      -0.711787281070
              le_mean =     -22.426948272790
             les_mean =     503.461373842389
             stat err =       0.000580408079
             autocorr =       1.365615159427
   target nu stat err =       0.000580408079
   target dn stat err =       0.002975867896
      target stat err =       0.002252733004
              std dev =       0.702399643127
             le_variance =       0.493365258665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493448451794
                                         uncertainty =       0.002960362314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493448451794
                                         uncertainty =       0.002960362314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496671551
  error estimate for blocks of size 2^( 2) =       0.000523443644
  error estimate for blocks of size 2^( 3) =       0.000548750169
  error estimate for blocks of size 2^( 4) =       0.000568073755
  error estimate for blocks of size 2^( 5) =       0.000579606469
  error estimate for blocks of size 2^( 6) =       0.000585459196
  error estimate for blocks of size 2^( 7) =       0.000588492896

      target function =      -0.711787281070
              le_mean =     -22.426948272790
             les_mean =     503.461373842389
             stat err =       0.000580408079
             autocorr =       1.365615159427
   target nu stat err =       0.000580408079
   target dn stat err =       0.002975867896
      target stat err =       0.002252733004
              std dev =       0.702399643127
             le_variance =       0.493365258665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493448451794
                                         uncertainty =       0.002960362314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493448451794
                                         uncertainty =       0.002960362314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496671551
  error estimate for blocks of size 2^( 2) =       0.000523443644
  error estimate for blocks of size 2^( 3) =       0.000548750169
  error estimate for blocks of size 2^( 4) =       0.000568073755
  error estimate for blocks of size 2^( 5) =       0.000579606469
  error estimate for blocks of size 2^( 6) =       0.000585459196
  error estimate for blocks of size 2^( 7) =       0.000588492896

      target function =      -0.711787281070
              le_mean =     -22.426948272790
             les_mean =     503.461373842389
             stat err =       0.000580408079
             autocorr =       1.365615159427
   target nu stat err =       0.000580408079
   target dn stat err =       0.002975867896
      target stat err =       0.002252733004
              std dev =       0.702399643127
             le_variance =       0.493365258665


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.711787281070        initial  <--
     1.0000e+39     1.0000e+40             2.9266e-44        -0.711787281070
     4.0000e+39     4.0000e+40             7.3166e-45        -0.711787281070
     1.6000e+40     1.6000e+41             1.8291e-45        -0.711787281070

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.9541
  </log>
  <optVariables href="FORM.s040.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2575e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2442e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.314
    reference variance = 0.618829
====================================================
  Execution time = 4.5301e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9658e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5414e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496600714887
                                         uncertainty =       0.004004032715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496600714887
                                         uncertainty =       0.004004032715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498289364
  error estimate for blocks of size 2^( 2) =       0.000524546201
  error estimate for blocks of size 2^( 3) =       0.000549414421
  error estimate for blocks of size 2^( 4) =       0.000568569310
  error estimate for blocks of size 2^( 5) =       0.000580471921
  error estimate for blocks of size 2^( 6) =       0.000588083242
  error estimate for blocks of size 2^( 7) =       0.000592531723

      target function =      -0.709454857798
              le_mean =     -22.425958682571
             les_mean =     503.420207164552
             stat err =       0.000582414049
             autocorr =       1.366156493442
   target nu stat err =       0.000582414049
   target dn stat err =       0.003888385826
      target stat err =       0.002878372417
              std dev =       0.704687576493
             le_variance =       0.496584580463


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242595868257e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+40, overlap shift 1.0000e+41 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709465654109       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709465654109       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+40, overlap shift 4.0000e+41 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709465654109       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709465654109       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+41, overlap shift 1.6000e+42 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709465654109       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709465654109       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.291193 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0722e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.3618
    reference variance = 0.337463
====================================================
  Execution time = 4.4389e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9938e-01
  Total weights = 2.0000e+06
  Execution time = 3.8401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499419937991
                                         uncertainty =       0.002993890175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499419937991
                                         uncertainty =       0.002993890175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499688892
  error estimate for blocks of size 2^( 2) =       0.000525666627
  error estimate for blocks of size 2^( 3) =       0.000550826242
  error estimate for blocks of size 2^( 4) =       0.000570192120
  error estimate for blocks of size 2^( 5) =       0.000583656148
  error estimate for blocks of size 2^( 6) =       0.000589388554
  error estimate for blocks of size 2^( 7) =       0.000596540506

      target function =      -0.707429324607
              le_mean =     -22.426611311613
             les_mean =     503.452272650169
             stat err =       0.000584944332
             autocorr =       1.370344256270
   target nu stat err =       0.000584944332
   target dn stat err =       0.003271423082
      target stat err =       0.002432285268
              std dev =       0.706666808108
             le_variance =       0.499377977682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499419937991
                                         uncertainty =       0.002993890175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499419937991
                                         uncertainty =       0.002993890175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499688892
  error estimate for blocks of size 2^( 2) =       0.000525666627
  error estimate for blocks of size 2^( 3) =       0.000550826242
  error estimate for blocks of size 2^( 4) =       0.000570192120
  error estimate for blocks of size 2^( 5) =       0.000583656148
  error estimate for blocks of size 2^( 6) =       0.000589388554
  error estimate for blocks of size 2^( 7) =       0.000596540506

      target function =      -0.707429324607
              le_mean =     -22.426611311613
             les_mean =     503.452272650169
             stat err =       0.000584944332
             autocorr =       1.370344256270
   target nu stat err =       0.000584944332
   target dn stat err =       0.003271423082
      target stat err =       0.002432285268
              std dev =       0.706666808108
             le_variance =       0.499377977682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499419937991
                                         uncertainty =       0.002993890175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499419937991
                                         uncertainty =       0.002993890175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499688892
  error estimate for blocks of size 2^( 2) =       0.000525666627
  error estimate for blocks of size 2^( 3) =       0.000550826242
  error estimate for blocks of size 2^( 4) =       0.000570192120
  error estimate for blocks of size 2^( 5) =       0.000583656148
  error estimate for blocks of size 2^( 6) =       0.000589388554
  error estimate for blocks of size 2^( 7) =       0.000596540506

      target function =      -0.707429324607
              le_mean =     -22.426611311613
             les_mean =     503.452272650169
             stat err =       0.000584944332
             autocorr =       1.370344256270
   target nu stat err =       0.000584944332
   target dn stat err =       0.003271423082
      target stat err =       0.002432285268
              std dev =       0.706666808108
             le_variance =       0.499377977682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499419937991
                                         uncertainty =       0.002993890175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499419937991
                                         uncertainty =       0.002993890175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499688892
  error estimate for blocks of size 2^( 2) =       0.000525666627
  error estimate for blocks of size 2^( 3) =       0.000550826242
  error estimate for blocks of size 2^( 4) =       0.000570192120
  error estimate for blocks of size 2^( 5) =       0.000583656148
  error estimate for blocks of size 2^( 6) =       0.000589388554
  error estimate for blocks of size 2^( 7) =       0.000596540506

      target function =      -0.707429324607
              le_mean =     -22.426611311613
             les_mean =     503.452272650169
             stat err =       0.000584944332
             autocorr =       1.370344256270
   target nu stat err =       0.000584944332
   target dn stat err =       0.003271423082
      target stat err =       0.002432285268
              std dev =       0.706666808108
             le_variance =       0.499377977682


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707429324607        initial  <--
     1.0000e+40     1.0000e+41             0.0000e+00        -0.707429324607
     4.0000e+40     4.0000e+41             0.0000e+00        -0.707429324607
     1.6000e+41     1.6000e+42             0.0000e+00        -0.707429324607

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.6127
  </log>
  <optVariables href="FORM.s041.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2434e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2440e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.3901
    reference variance = 0.87834
====================================================
  Execution time = 4.5262e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9442e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5207e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494291877747
                                         uncertainty =       0.003448775902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494291877747
                                         uncertainty =       0.003448775902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497201185
  error estimate for blocks of size 2^( 2) =       0.000523569221
  error estimate for blocks of size 2^( 3) =       0.000548649640
  error estimate for blocks of size 2^( 4) =       0.000567818900
  error estimate for blocks of size 2^( 5) =       0.000581078013
  error estimate for blocks of size 2^( 6) =       0.000588132849
  error estimate for blocks of size 2^( 7) =       0.000590303135

      target function =      -0.711030031608
              le_mean =     -22.425710278456
             les_mean =     503.406899283484
             stat err =       0.000581833224
             autocorr =       1.369407567684
   target nu stat err =       0.000581833224
   target dn stat err =       0.003982673512
      target stat err =       0.002956875492
              std dev =       0.703148659549
             le_variance =       0.494418037425


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242571027846e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+41, overlap shift 1.0000e+42 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711041284729       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711041284729       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+41, overlap shift 4.0000e+42 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711041284729       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711041284729       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711041450500       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+41 is 9.699348e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+42, overlap shift 1.6000e+43 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711041284729       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711041284729       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711041450500       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+42 is 2.424837e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.292485 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0476e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.3627
    reference variance = 0.402781
====================================================
  Execution time = 4.4652e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0261e-01
  Total weights = 2.0000e+06
  Execution time = 3.8179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502700738098
                                         uncertainty =       0.004982493208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502700738098
                                         uncertainty =       0.004982493208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501305605
  error estimate for blocks of size 2^( 2) =       0.000526997573
  error estimate for blocks of size 2^( 3) =       0.000552201091
  error estimate for blocks of size 2^( 4) =       0.000571197749
  error estimate for blocks of size 2^( 5) =       0.000582901607
  error estimate for blocks of size 2^( 6) =       0.000592547239
  error estimate for blocks of size 2^( 7) =       0.000597548779

      target function =      -0.705108657625
              le_mean =     -22.425779076303
             les_mean =     503.418181547290
             stat err =       0.000586048844
             autocorr =       1.366666363568
   target nu stat err =       0.000586048844
   target dn stat err =       0.005269028328
      target stat err =       0.003815325964
              std dev =       0.708953185665
             le_variance =       0.502614619465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502700738098
                                         uncertainty =       0.004982493208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502700738098
                                         uncertainty =       0.004982493208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501305605
  error estimate for blocks of size 2^( 2) =       0.000526997573
  error estimate for blocks of size 2^( 3) =       0.000552201091
  error estimate for blocks of size 2^( 4) =       0.000571197749
  error estimate for blocks of size 2^( 5) =       0.000582901607
  error estimate for blocks of size 2^( 6) =       0.000592547239
  error estimate for blocks of size 2^( 7) =       0.000597548779

      target function =      -0.705108657625
              le_mean =     -22.425779076303
             les_mean =     503.418181547290
             stat err =       0.000586048844
             autocorr =       1.366666363569
   target nu stat err =       0.000586048844
   target dn stat err =       0.005269028328
      target stat err =       0.003815325964
              std dev =       0.708953185665
             le_variance =       0.502614619465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502700738098
                                         uncertainty =       0.004982493208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502700738098
                                         uncertainty =       0.004982493208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501305605
  error estimate for blocks of size 2^( 2) =       0.000526997573
  error estimate for blocks of size 2^( 3) =       0.000552201091
  error estimate for blocks of size 2^( 4) =       0.000571197749
  error estimate for blocks of size 2^( 5) =       0.000582901607
  error estimate for blocks of size 2^( 6) =       0.000592547239
  error estimate for blocks of size 2^( 7) =       0.000597548779

      target function =      -0.705108657625
              le_mean =     -22.425779076303
             les_mean =     503.418181547290
             stat err =       0.000586048844
             autocorr =       1.366666363569
   target nu stat err =       0.000586048844
   target dn stat err =       0.005269028328
      target stat err =       0.003815325964
              std dev =       0.708953185665
             le_variance =       0.502614619465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502700738098
                                         uncertainty =       0.004982493208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502700738098
                                         uncertainty =       0.004982493208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501305605
  error estimate for blocks of size 2^( 2) =       0.000526997573
  error estimate for blocks of size 2^( 3) =       0.000552201091
  error estimate for blocks of size 2^( 4) =       0.000571197749
  error estimate for blocks of size 2^( 5) =       0.000582901607
  error estimate for blocks of size 2^( 6) =       0.000592547239
  error estimate for blocks of size 2^( 7) =       0.000597548779

      target function =      -0.705108657625
              le_mean =     -22.425779076303
             les_mean =     503.418181547290
             stat err =       0.000586048844
             autocorr =       1.366666363569
   target nu stat err =       0.000586048844
   target dn stat err =       0.005269028328
      target stat err =       0.003815325964
              std dev =       0.708953185665
             le_variance =       0.502614619465


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.705108657625        initial  <--
     1.0000e+41     1.0000e+42             0.0000e+00        -0.705108657625
     4.0000e+41     4.0000e+42             9.6993e-47        -0.705108657625
     1.6000e+42     1.6000e+43             2.4248e-47        -0.705108657625

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.7653
  </log>
  <optVariables href="FORM.s042.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2425e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2438e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.4641
    reference variance = 0.353382
====================================================
  Execution time = 4.5010e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0140e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5257e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501456420897
                                         uncertainty =       0.003955955961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501456420897
                                         uncertainty =       0.003955955961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500699924
  error estimate for blocks of size 2^( 2) =       0.000526388468
  error estimate for blocks of size 2^( 3) =       0.000551996056
  error estimate for blocks of size 2^( 4) =       0.000571466926
  error estimate for blocks of size 2^( 5) =       0.000584779936
  error estimate for blocks of size 2^( 6) =       0.000591412676
  error estimate for blocks of size 2^( 7) =       0.000595132294

      target function =      -0.705978562748
              le_mean =     -22.426252801356
             les_mean =     503.438215286878
             stat err =       0.000585697958
             autocorr =       1.368334790868
   target nu stat err =       0.000585697958
   target dn stat err =       0.003808402650
      target stat err =       0.002796633664
              std dev =       0.708096622829
             le_variance =       0.501400827262


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242625280136e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+42, overlap shift 1.0000e+43 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705988676663       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705988676663       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+42, overlap shift 4.0000e+43 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705988676663       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705988676663       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+43, overlap shift 1.6000e+44 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705988676663       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705988676663       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.293598 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0273e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.4857
    reference variance = 0.33378
====================================================
  Execution time = 4.6075e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9417e-01
  Total weights = 2.0000e+06
  Execution time = 3.8268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494158918862
                                         uncertainty =       0.003437637286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494158918862
                                         uncertainty =       0.003437637286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497075149
  error estimate for blocks of size 2^( 2) =       0.000523080708
  error estimate for blocks of size 2^( 3) =       0.000548294748
  error estimate for blocks of size 2^( 4) =       0.000566841012
  error estimate for blocks of size 2^( 5) =       0.000577987940
  error estimate for blocks of size 2^( 6) =       0.000588253701
  error estimate for blocks of size 2^( 7) =       0.000592315751

      target function =      -0.711197147254
              le_mean =     -22.427326890212
             les_mean =     503.479158600039
             stat err =       0.000581349601
             autocorr =       1.367825373302
   target nu stat err =       0.000581349601
   target dn stat err =       0.002955095603
      target stat err =       0.002236008327
              std dev =       0.702970416660
             le_variance =       0.494167406699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494158918862
                                         uncertainty =       0.003437637286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494158918862
                                         uncertainty =       0.003437637286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497075149
  error estimate for blocks of size 2^( 2) =       0.000523080708
  error estimate for blocks of size 2^( 3) =       0.000548294748
  error estimate for blocks of size 2^( 4) =       0.000566841012
  error estimate for blocks of size 2^( 5) =       0.000577987940
  error estimate for blocks of size 2^( 6) =       0.000588253701
  error estimate for blocks of size 2^( 7) =       0.000592315751

      target function =      -0.711197147254
              le_mean =     -22.427326890212
             les_mean =     503.479158600039
             stat err =       0.000581349601
             autocorr =       1.367825373302
   target nu stat err =       0.000581349601
   target dn stat err =       0.002955095603
      target stat err =       0.002236008327
              std dev =       0.702970416660
             le_variance =       0.494167406699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494158918862
                                         uncertainty =       0.003437637286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494158918862
                                         uncertainty =       0.003437637286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497075149
  error estimate for blocks of size 2^( 2) =       0.000523080708
  error estimate for blocks of size 2^( 3) =       0.000548294748
  error estimate for blocks of size 2^( 4) =       0.000566841012
  error estimate for blocks of size 2^( 5) =       0.000577987940
  error estimate for blocks of size 2^( 6) =       0.000588253701
  error estimate for blocks of size 2^( 7) =       0.000592315751

      target function =      -0.711197147254
              le_mean =     -22.427326890212
             les_mean =     503.479158600039
             stat err =       0.000581349601
             autocorr =       1.367825373302
   target nu stat err =       0.000581349601
   target dn stat err =       0.002955095603
      target stat err =       0.002236008327
              std dev =       0.702970416660
             le_variance =       0.494167406699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494158918862
                                         uncertainty =       0.003437637286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494158918862
                                         uncertainty =       0.003437637286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497075149
  error estimate for blocks of size 2^( 2) =       0.000523080708
  error estimate for blocks of size 2^( 3) =       0.000548294748
  error estimate for blocks of size 2^( 4) =       0.000566841012
  error estimate for blocks of size 2^( 5) =       0.000577987940
  error estimate for blocks of size 2^( 6) =       0.000588253701
  error estimate for blocks of size 2^( 7) =       0.000592315751

      target function =      -0.711197147254
              le_mean =     -22.427326890212
             les_mean =     503.479158600039
             stat err =       0.000581349601
             autocorr =       1.367825373302
   target nu stat err =       0.000581349601
   target dn stat err =       0.002955095603
      target stat err =       0.002236008327
              std dev =       0.702970416660
             le_variance =       0.494167406699


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.711197147254        initial  <--
     1.0000e+42     1.0000e+43             0.0000e+00        -0.711197147254
     4.0000e+42     4.0000e+43             0.0000e+00        -0.711197147254
     1.6000e+43     1.6000e+44             0.0000e+00        -0.711197147254

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.2571
  </log>
  <optVariables href="FORM.s043.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2554e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.4024
    reference variance = 0.512843
====================================================
  Execution time = 4.5282e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.1070e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5107e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510767519308
                                         uncertainty =       0.007582481823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510767519308
                                         uncertainty =       0.007582481823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505323833
  error estimate for blocks of size 2^( 2) =       0.000531560286
  error estimate for blocks of size 2^( 3) =       0.000556627847
  error estimate for blocks of size 2^( 4) =       0.000575049230
  error estimate for blocks of size 2^( 5) =       0.000586844727
  error estimate for blocks of size 2^( 6) =       0.000592406152
  error estimate for blocks of size 2^( 7) =       0.000598098491

      target function =      -0.699351165466
              le_mean =     -22.425829427747
             les_mean =     503.428529618788
             stat err =       0.000588099650
             autocorr =       1.354447821357
   target nu stat err =       0.000588099650
   target dn stat err =       0.007204883037
      target stat err =       0.005104457584
              std dev =       0.714635817558
             le_variance =       0.510704351737


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242582942775e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+43, overlap shift 1.0000e+44 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.699387735960       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699387735960       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.699387735960       residual = 5.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+43 is 6.738825e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+43, overlap shift 4.0000e+44 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.699387735960       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699387735960       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.699387735960       residual = 5.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+43 is 1.684706e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+44, overlap shift 1.6000e+45 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.699387735960       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699387735960       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.699387735960       residual = 5.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+44 is 4.211766e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.294962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0396e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.4422
    reference variance = 0.361981
====================================================
  Execution time = 4.4854e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9324e-01
  Total weights = 2.0000e+06
  Execution time = 3.8246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493279160449
                                         uncertainty =       0.003060811862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493279160449
                                         uncertainty =       0.003060811862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496608486
  error estimate for blocks of size 2^( 2) =       0.000522760497
  error estimate for blocks of size 2^( 3) =       0.000547904615
  error estimate for blocks of size 2^( 4) =       0.000565958528
  error estimate for blocks of size 2^( 5) =       0.000576867973
  error estimate for blocks of size 2^( 6) =       0.000583600478
  error estimate for blocks of size 2^( 7) =       0.000590111905

      target function =      -0.711882975910
              le_mean =     -22.426432477073
             les_mean =     503.438113379751
             stat err =       0.000579134721
             autocorr =       1.359975023799
   target nu stat err =       0.000579134721
   target dn stat err =       0.003401148266
      target stat err =       0.002551979172
              std dev =       0.702310456744
             le_variance =       0.493239977652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493279160449
                                         uncertainty =       0.003060811862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493279160449
                                         uncertainty =       0.003060811862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496608486
  error estimate for blocks of size 2^( 2) =       0.000522760497
  error estimate for blocks of size 2^( 3) =       0.000547904615
  error estimate for blocks of size 2^( 4) =       0.000565958528
  error estimate for blocks of size 2^( 5) =       0.000576867973
  error estimate for blocks of size 2^( 6) =       0.000583600478
  error estimate for blocks of size 2^( 7) =       0.000590111905

      target function =      -0.711882975910
              le_mean =     -22.426432477073
             les_mean =     503.438113379751
             stat err =       0.000579134721
             autocorr =       1.359975023799
   target nu stat err =       0.000579134721
   target dn stat err =       0.003401148266
      target stat err =       0.002551979172
              std dev =       0.702310456744
             le_variance =       0.493239977652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493279160449
                                         uncertainty =       0.003060811862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493279160449
                                         uncertainty =       0.003060811862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496608486
  error estimate for blocks of size 2^( 2) =       0.000522760497
  error estimate for blocks of size 2^( 3) =       0.000547904615
  error estimate for blocks of size 2^( 4) =       0.000565958528
  error estimate for blocks of size 2^( 5) =       0.000576867973
  error estimate for blocks of size 2^( 6) =       0.000583600478
  error estimate for blocks of size 2^( 7) =       0.000590111905

      target function =      -0.711882975910
              le_mean =     -22.426432477073
             les_mean =     503.438113379751
             stat err =       0.000579134721
             autocorr =       1.359975023799
   target nu stat err =       0.000579134721
   target dn stat err =       0.003401148266
      target stat err =       0.002551979172
              std dev =       0.702310456744
             le_variance =       0.493239977652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493279160449
                                         uncertainty =       0.003060811862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493279160449
                                         uncertainty =       0.003060811862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496608486
  error estimate for blocks of size 2^( 2) =       0.000522760497
  error estimate for blocks of size 2^( 3) =       0.000547904615
  error estimate for blocks of size 2^( 4) =       0.000565958528
  error estimate for blocks of size 2^( 5) =       0.000576867973
  error estimate for blocks of size 2^( 6) =       0.000583600478
  error estimate for blocks of size 2^( 7) =       0.000590111905

      target function =      -0.711882975910
              le_mean =     -22.426432477073
             les_mean =     503.438113379751
             stat err =       0.000579134721
             autocorr =       1.359975023799
   target nu stat err =       0.000579134721
   target dn stat err =       0.003401148266
      target stat err =       0.002551979172
              std dev =       0.702310456744
             le_variance =       0.493239977652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.711882975910        initial  <--
     1.0000e+43     1.0000e+44             6.7388e-48        -0.711882975910
     4.0000e+43     4.0000e+44             1.6847e-48        -0.711882975910
     1.6000e+44     1.6000e+45             4.2118e-49        -0.711882975910

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9967
  </log>
  <optVariables href="FORM.s044.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2440e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.3904
    reference variance = 0.48388
====================================================
  Execution time = 4.5111e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2425e+01
  VMC Evar = 4.9602e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4998e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496157846186
                                         uncertainty =       0.002778864418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496157846186
                                         uncertainty =       0.002778864418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498007561
  error estimate for blocks of size 2^( 2) =       0.000524615260
  error estimate for blocks of size 2^( 3) =       0.000549652638
  error estimate for blocks of size 2^( 4) =       0.000569400361
  error estimate for blocks of size 2^( 5) =       0.000580098084
  error estimate for blocks of size 2^( 6) =       0.000587651515
  error estimate for blocks of size 2^( 7) =       0.000591113423

      target function =      -0.709874884256
              le_mean =     -22.425272591281
             les_mean =     503.388873606010
             stat err =       0.000582065846
             autocorr =       1.366068134235
   target nu stat err =       0.000582065846
   target dn stat err =       0.003124121146
      target stat err =       0.002339831478
              std dev =       0.704289046312
             le_variance =       0.496023060755


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242527259128e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+44, overlap shift 1.0000e+45 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709881606681       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709881606681       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709881606681       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+44 is 7.028748e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+44, overlap shift 4.0000e+45 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709881606681       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709881606681       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709881606681       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+44 is 1.757187e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+45, overlap shift 1.6000e+46 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709881606681       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709881606681       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709881606681       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+45 is 4.392967e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.296300 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0116e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.5025
    reference variance = 0.599473
====================================================
  Execution time = 4.6403e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9901e-01
  Total weights = 2.0000e+06
  Execution time = 3.8147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499065356161
                                         uncertainty =       0.004442078220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499065356161
                                         uncertainty =       0.004442078220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499504074
  error estimate for blocks of size 2^( 2) =       0.000525554151
  error estimate for blocks of size 2^( 3) =       0.000550870632
  error estimate for blocks of size 2^( 4) =       0.000570254794
  error estimate for blocks of size 2^( 5) =       0.000582085261
  error estimate for blocks of size 2^( 6) =       0.000588804005
  error estimate for blocks of size 2^( 7) =       0.000594482733

      target function =      -0.707699013345
              le_mean =     -22.426111238368
             les_mean =     503.429473666245
             stat err =       0.000583906698
             autocorr =       1.366497511722
   target nu stat err =       0.000583906698
   target dn stat err =       0.004207449028
      target stat err =       0.003090758066
              std dev =       0.706405436075
             le_variance =       0.499008640116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499065356161
                                         uncertainty =       0.004442078220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499065356161
                                         uncertainty =       0.004442078220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499504074
  error estimate for blocks of size 2^( 2) =       0.000525554151
  error estimate for blocks of size 2^( 3) =       0.000550870632
  error estimate for blocks of size 2^( 4) =       0.000570254794
  error estimate for blocks of size 2^( 5) =       0.000582085261
  error estimate for blocks of size 2^( 6) =       0.000588804005
  error estimate for blocks of size 2^( 7) =       0.000594482733

      target function =      -0.707699013345
              le_mean =     -22.426111238368
             les_mean =     503.429473666245
             stat err =       0.000583906698
             autocorr =       1.366497511722
   target nu stat err =       0.000583906698
   target dn stat err =       0.004207449028
      target stat err =       0.003090758066
              std dev =       0.706405436075
             le_variance =       0.499008640116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499065356161
                                         uncertainty =       0.004442078220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499065356161
                                         uncertainty =       0.004442078220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499504074
  error estimate for blocks of size 2^( 2) =       0.000525554151
  error estimate for blocks of size 2^( 3) =       0.000550870632
  error estimate for blocks of size 2^( 4) =       0.000570254794
  error estimate for blocks of size 2^( 5) =       0.000582085261
  error estimate for blocks of size 2^( 6) =       0.000588804005
  error estimate for blocks of size 2^( 7) =       0.000594482733

      target function =      -0.707699013345
              le_mean =     -22.426111238368
             les_mean =     503.429473666245
             stat err =       0.000583906698
             autocorr =       1.366497511722
   target nu stat err =       0.000583906698
   target dn stat err =       0.004207449028
      target stat err =       0.003090758066
              std dev =       0.706405436075
             le_variance =       0.499008640116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499065356161
                                         uncertainty =       0.004442078220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499065356161
                                         uncertainty =       0.004442078220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499504074
  error estimate for blocks of size 2^( 2) =       0.000525554151
  error estimate for blocks of size 2^( 3) =       0.000550870632
  error estimate for blocks of size 2^( 4) =       0.000570254794
  error estimate for blocks of size 2^( 5) =       0.000582085261
  error estimate for blocks of size 2^( 6) =       0.000588804005
  error estimate for blocks of size 2^( 7) =       0.000594482733

      target function =      -0.707699013345
              le_mean =     -22.426111238368
             les_mean =     503.429473666245
             stat err =       0.000583906698
             autocorr =       1.366497511722
   target nu stat err =       0.000583906698
   target dn stat err =       0.004207449028
      target stat err =       0.003090758066
              std dev =       0.706405436075
             le_variance =       0.499008640116


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707699013345        initial  <--
     1.0000e+44     1.0000e+45             7.0287e-49        -0.707699013345
     4.0000e+44     4.0000e+45             1.7572e-49        -0.707699013345
     1.6000e+45     1.6000e+46             4.3930e-50        -0.707699013345

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.5020
  </log>
  <optVariables href="FORM.s045.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2562e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.3884
    reference variance = 0.328661
====================================================
  Execution time = 4.6673e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.1170e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5105e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511846313730
                                         uncertainty =       0.008759142404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511846313730
                                         uncertainty =       0.008759142404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505818395
  error estimate for blocks of size 2^( 2) =       0.000531784817
  error estimate for blocks of size 2^( 3) =       0.000556473057
  error estimate for blocks of size 2^( 4) =       0.000575650686
  error estimate for blocks of size 2^( 5) =       0.000588461339
  error estimate for blocks of size 2^( 6) =       0.000593825433
  error estimate for blocks of size 2^( 7) =       0.000596171629

      target function =      -0.698620164223
              le_mean =     -22.426124919890
             les_mean =     503.442783163790
             stat err =       0.000588527272
             autocorr =       1.353767073212
   target nu stat err =       0.000588527272
   target dn stat err =       0.008988482581
      target stat err =       0.006342467589
              std dev =       0.715335234098
             le_variance =       0.511704497142


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242612491989e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+45, overlap shift 1.0000e+46 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.698676010438       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.698676010438       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.687500000000       residual = 8.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.52e+03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 1.48e+08           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+45 is 7.910362e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+45, overlap shift 4.0000e+46 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.698676010438       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.698676010438       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750000000000       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+45 is 1.977591e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+46, overlap shift 1.6000e+47 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.698676010438       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.698676010438       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750000000000       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+46 is 4.943976e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.297837 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1784e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.4849
    reference variance = 0.479202
====================================================
  Execution time = 4.4709e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2425e+01
  VMC Evar = 5.1965e-01
  Total weights = 2.0000e+06
  Execution time = 3.8190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519681878370
                                         uncertainty =       0.023579291650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519681878370
                                         uncertainty =       0.023579291650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509728918
  error estimate for blocks of size 2^( 2) =       0.000535375333
  error estimate for blocks of size 2^( 3) =       0.000559793588
  error estimate for blocks of size 2^( 4) =       0.000578382540
  error estimate for blocks of size 2^( 5) =       0.000591032955
  error estimate for blocks of size 2^( 6) =       0.000597381587
  error estimate for blocks of size 2^( 7) =       0.000602656337

      target function =      -0.692770564221
              le_mean =     -22.425483435652
             les_mean =     503.421954202930
             stat err =       0.000592363355
             autocorr =       1.350510057032
   target nu stat err =       0.000592363355
   target dn stat err =       0.023820322966
      target stat err =       0.016459140833
              std dev =       0.720865549225
             le_variance =       0.519647140060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519681878370
                                         uncertainty =       0.023579291650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519681878370
                                         uncertainty =       0.023579291650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509728918
  error estimate for blocks of size 2^( 2) =       0.000535375333
  error estimate for blocks of size 2^( 3) =       0.000559793588
  error estimate for blocks of size 2^( 4) =       0.000578382540
  error estimate for blocks of size 2^( 5) =       0.000591032955
  error estimate for blocks of size 2^( 6) =       0.000597381587
  error estimate for blocks of size 2^( 7) =       0.000602656337

      target function =      -0.692770564221
              le_mean =     -22.425483435652
             les_mean =     503.421954202930
             stat err =       0.000592363355
             autocorr =       1.350510057027
   target nu stat err =       0.000592363355
   target dn stat err =       0.023820322966
      target stat err =       0.016459140833
              std dev =       0.720865549225
             le_variance =       0.519647140060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519681878370
                                         uncertainty =       0.023579291650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519681878370
                                         uncertainty =       0.023579291650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509728918
  error estimate for blocks of size 2^( 2) =       0.000535375333
  error estimate for blocks of size 2^( 3) =       0.000559793588
  error estimate for blocks of size 2^( 4) =       0.000578382540
  error estimate for blocks of size 2^( 5) =       0.000591032955
  error estimate for blocks of size 2^( 6) =       0.000597381587
  error estimate for blocks of size 2^( 7) =       0.000602656337

      target function =      -0.692770564221
              le_mean =     -22.425483435652
             les_mean =     503.421954202930
             stat err =       0.000592363355
             autocorr =       1.350510057027
   target nu stat err =       0.000592363355
   target dn stat err =       0.023820322966
      target stat err =       0.016459140833
              std dev =       0.720865549225
             le_variance =       0.519647140060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519681878370
                                         uncertainty =       0.023579291650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519681878370
                                         uncertainty =       0.023579291650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509728918
  error estimate for blocks of size 2^( 2) =       0.000535375333
  error estimate for blocks of size 2^( 3) =       0.000559793588
  error estimate for blocks of size 2^( 4) =       0.000578382540
  error estimate for blocks of size 2^( 5) =       0.000591032955
  error estimate for blocks of size 2^( 6) =       0.000597381587
  error estimate for blocks of size 2^( 7) =       0.000602656337

      target function =      -0.692770564221
              le_mean =     -22.425483435652
             les_mean =     503.421954202930
             stat err =       0.000592363355
             autocorr =       1.350510057027
   target nu stat err =       0.000592363355
   target dn stat err =       0.023820322966
      target stat err =       0.016459140833
              std dev =       0.720865549225
             le_variance =       0.519647140060


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.692770564221        initial  <--
     1.0000e+45     1.0000e+46             7.9104e-50        -0.692770564221
     4.0000e+45     4.0000e+46             1.9776e-50        -0.692770564221
     1.6000e+46     1.6000e+47             4.9440e-51        -0.692770564221

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8332
  </log>
  <optVariables href="FORM.s046.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2562e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.4101
    reference variance = 0.610808
====================================================
  Execution time = 4.4806e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0036e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5058e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500414336759
                                         uncertainty =       0.003886294896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500414336759
                                         uncertainty =       0.003886294896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500179542
  error estimate for blocks of size 2^( 2) =       0.000526381480
  error estimate for blocks of size 2^( 3) =       0.000551610107
  error estimate for blocks of size 2^( 4) =       0.000570761762
  error estimate for blocks of size 2^( 5) =       0.000582191561
  error estimate for blocks of size 2^( 6) =       0.000589581189
  error estimate for blocks of size 2^( 7) =       0.000594551068

      target function =      -0.706730215555
              le_mean =     -22.426123020691
             les_mean =     503.431352637265
             stat err =       0.000584271395
             autocorr =       1.364512127331
   target nu stat err =       0.000584271395
   target dn stat err =       0.003582278375
      target stat err =       0.002642985583
              std dev =       0.707360691780
             le_variance =       0.500359148275


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242612302069e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+46, overlap shift 1.0000e+47 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706739271832       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706739271832       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+46 is 2.542911e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+46, overlap shift 4.0000e+47 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706739271832       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706739271832       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+46 is 6.357278e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+47, overlap shift 1.6000e+48 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706739271832       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706739271832       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+47 is 1.589319e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.298934 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9871e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.39
    reference variance = 0.319291
====================================================
  Execution time = 4.4590e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9890e-01
  Total weights = 2.0000e+06
  Execution time = 3.8148e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498919573074
                                         uncertainty =       0.004673675826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498919573074
                                         uncertainty =       0.004673675826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499449104
  error estimate for blocks of size 2^( 2) =       0.000525881641
  error estimate for blocks of size 2^( 3) =       0.000551008963
  error estimate for blocks of size 2^( 4) =       0.000569961512
  error estimate for blocks of size 2^( 5) =       0.000581351106
  error estimate for blocks of size 2^( 6) =       0.000589072058
  error estimate for blocks of size 2^( 7) =       0.000591053402

      target function =      -0.707780709055
              le_mean =     -22.425682950194
             les_mean =     503.410154347908
             stat err =       0.000582859519
             autocorr =       1.361900286561
   target nu stat err =       0.000582859519
   target dn stat err =       0.004883356066
      target stat err =       0.003568577274
              std dev =       0.706327696425
             le_variance =       0.498898814737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498919573074
                                         uncertainty =       0.004673675826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498919573074
                                         uncertainty =       0.004673675826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499449104
  error estimate for blocks of size 2^( 2) =       0.000525881641
  error estimate for blocks of size 2^( 3) =       0.000551008963
  error estimate for blocks of size 2^( 4) =       0.000569961512
  error estimate for blocks of size 2^( 5) =       0.000581351106
  error estimate for blocks of size 2^( 6) =       0.000589072058
  error estimate for blocks of size 2^( 7) =       0.000591053402

      target function =      -0.707780709055
              le_mean =     -22.425682950194
             les_mean =     503.410154347908
             stat err =       0.000582859519
             autocorr =       1.361900286561
   target nu stat err =       0.000582859519
   target dn stat err =       0.004883356066
      target stat err =       0.003568577274
              std dev =       0.706327696425
             le_variance =       0.498898814737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498919573074
                                         uncertainty =       0.004673675826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498919573074
                                         uncertainty =       0.004673675826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499449104
  error estimate for blocks of size 2^( 2) =       0.000525881641
  error estimate for blocks of size 2^( 3) =       0.000551008963
  error estimate for blocks of size 2^( 4) =       0.000569961512
  error estimate for blocks of size 2^( 5) =       0.000581351106
  error estimate for blocks of size 2^( 6) =       0.000589072058
  error estimate for blocks of size 2^( 7) =       0.000591053402

      target function =      -0.707780709055
              le_mean =     -22.425682950194
             les_mean =     503.410154347908
             stat err =       0.000582859519
             autocorr =       1.361900286561
   target nu stat err =       0.000582859519
   target dn stat err =       0.004883356066
      target stat err =       0.003568577274
              std dev =       0.706327696425
             le_variance =       0.498898814737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498919573074
                                         uncertainty =       0.004673675826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498919573074
                                         uncertainty =       0.004673675826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499449104
  error estimate for blocks of size 2^( 2) =       0.000525881641
  error estimate for blocks of size 2^( 3) =       0.000551008963
  error estimate for blocks of size 2^( 4) =       0.000569961512
  error estimate for blocks of size 2^( 5) =       0.000581351106
  error estimate for blocks of size 2^( 6) =       0.000589072058
  error estimate for blocks of size 2^( 7) =       0.000591053402

      target function =      -0.707780709055
              le_mean =     -22.425682950194
             les_mean =     503.410154347908
             stat err =       0.000582859519
             autocorr =       1.361900286561
   target nu stat err =       0.000582859519
   target dn stat err =       0.004883356066
      target stat err =       0.003568577274
              std dev =       0.706327696425
             le_variance =       0.498898814737


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707780709055        initial  <--
     1.0000e+46     1.0000e+47             2.5429e-51        -0.707780709055
     4.0000e+46     4.0000e+47             6.3573e-52        -0.707780709055
     1.6000e+47     1.6000e+48             1.5893e-52        -0.707780709055

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.6993
  </log>
  <optVariables href="FORM.s047.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2358e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2438e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.4142
    reference variance = 0.394481
====================================================
  Execution time = 4.6896e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9650e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5313e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496562716069
                                         uncertainty =       0.002984978754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496562716069
                                         uncertainty =       0.002984978754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498244995
  error estimate for blocks of size 2^( 2) =       0.000524412622
  error estimate for blocks of size 2^( 3) =       0.000548858638
  error estimate for blocks of size 2^( 4) =       0.000567566978
  error estimate for blocks of size 2^( 5) =       0.000580923179
  error estimate for blocks of size 2^( 6) =       0.000586663262
  error estimate for blocks of size 2^( 7) =       0.000589126863

      target function =      -0.709507343353
              le_mean =     -22.427032604648
             les_mean =     503.468287351591
             stat err =       0.000581070071
             autocorr =       1.360100887307
   target nu stat err =       0.000581070071
   target dn stat err =       0.003023575307
      target stat err =       0.002272669545
              std dev =       0.704624829167
             le_variance =       0.496496149879


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242703260465e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+47, overlap shift 1.0000e+48 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709513676859       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709513676859       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+47, overlap shift 4.0000e+48 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709513676859       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709513676859       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+48, overlap shift 1.6000e+49 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709513676859       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709513676859       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.300056 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2215e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.2871
    reference variance = 0.536169
====================================================
  Execution time = 4.6706e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.1268e-01
  Total weights = 2.0000e+06
  Execution time = 3.8046e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512596235753
                                         uncertainty =       0.018539747160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512596235753
                                         uncertainty =       0.018539747160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506300421
  error estimate for blocks of size 2^( 2) =       0.000532498844
  error estimate for blocks of size 2^( 3) =       0.000557453330
  error estimate for blocks of size 2^( 4) =       0.000577040239
  error estimate for blocks of size 2^( 5) =       0.000588241348
  error estimate for blocks of size 2^( 6) =       0.000594737412
  error estimate for blocks of size 2^( 7) =       0.000597853704

      target function =      -0.697732256534
              le_mean =     -22.426565089890
             les_mean =     503.463501706690
             stat err =       0.000589468176
             autocorr =       1.355514445177
   target nu stat err =       0.000589468176
   target dn stat err =       0.018750980657
      target stat err =       0.013165149652
              std dev =       0.716016921557
             le_variance =       0.512680231955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512596235753
                                         uncertainty =       0.018539747160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512596235753
                                         uncertainty =       0.018539747160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506300421
  error estimate for blocks of size 2^( 2) =       0.000532498844
  error estimate for blocks of size 2^( 3) =       0.000557453330
  error estimate for blocks of size 2^( 4) =       0.000577040239
  error estimate for blocks of size 2^( 5) =       0.000588241348
  error estimate for blocks of size 2^( 6) =       0.000594737412
  error estimate for blocks of size 2^( 7) =       0.000597853704

      target function =      -0.697732256534
              le_mean =     -22.426565089890
             les_mean =     503.463501706690
             stat err =       0.000589468176
             autocorr =       1.355514445177
   target nu stat err =       0.000589468176
   target dn stat err =       0.018750980657
      target stat err =       0.013165149652
              std dev =       0.716016921557
             le_variance =       0.512680231955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512596235753
                                         uncertainty =       0.018539747160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512596235753
                                         uncertainty =       0.018539747160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506300421
  error estimate for blocks of size 2^( 2) =       0.000532498844
  error estimate for blocks of size 2^( 3) =       0.000557453330
  error estimate for blocks of size 2^( 4) =       0.000577040239
  error estimate for blocks of size 2^( 5) =       0.000588241348
  error estimate for blocks of size 2^( 6) =       0.000594737412
  error estimate for blocks of size 2^( 7) =       0.000597853704

      target function =      -0.697732256534
              le_mean =     -22.426565089890
             les_mean =     503.463501706690
             stat err =       0.000589468176
             autocorr =       1.355514445177
   target nu stat err =       0.000589468176
   target dn stat err =       0.018750980657
      target stat err =       0.013165149652
              std dev =       0.716016921557
             le_variance =       0.512680231955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512596235753
                                         uncertainty =       0.018539747160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512596235753
                                         uncertainty =       0.018539747160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506300421
  error estimate for blocks of size 2^( 2) =       0.000532498844
  error estimate for blocks of size 2^( 3) =       0.000557453330
  error estimate for blocks of size 2^( 4) =       0.000577040239
  error estimate for blocks of size 2^( 5) =       0.000588241348
  error estimate for blocks of size 2^( 6) =       0.000594737412
  error estimate for blocks of size 2^( 7) =       0.000597853704

      target function =      -0.697732256534
              le_mean =     -22.426565089890
             les_mean =     503.463501706690
             stat err =       0.000589468176
             autocorr =       1.355514445177
   target nu stat err =       0.000589468176
   target dn stat err =       0.018750980657
      target stat err =       0.013165149652
              std dev =       0.716016921557
             le_variance =       0.512680231955


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.697732256534        initial  <--
     1.0000e+47     1.0000e+48             0.0000e+00        -0.697732256534
     4.0000e+47     4.0000e+48             0.0000e+00        -0.697732256534
     1.6000e+48     1.6000e+49             0.0000e+00        -0.697732256534

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.7695
  </log>
  <optVariables href="FORM.s048.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2799e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2436e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.3268
    reference variance = 0.613363
====================================================
  Execution time = 4.5718e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0107e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5134e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501069579051
                                         uncertainty =       0.006018800365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501069579051
                                         uncertainty =       0.006018800365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500534421
  error estimate for blocks of size 2^( 2) =       0.000527048641
  error estimate for blocks of size 2^( 3) =       0.000551862455
  error estimate for blocks of size 2^( 4) =       0.000570516259
  error estimate for blocks of size 2^( 5) =       0.000580871299
  error estimate for blocks of size 2^( 6) =       0.000589612485
  error estimate for blocks of size 2^( 7) =       0.000592723539

      target function =      -0.706208291716
              le_mean =     -22.425753828155
             les_mean =     503.415503923756
             stat err =       0.000583430896
             autocorr =       1.358660500290
   target nu stat err =       0.000583430896
   target dn stat err =       0.006244101260
      target stat err =       0.004519026954
              std dev =       0.707862566670
             le_variance =       0.501069413293


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242575382815e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+48, overlap shift 1.0000e+49 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706235925724       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706235925724       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+48, overlap shift 4.0000e+49 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706235925724       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706235925724       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+49, overlap shift 1.6000e+50 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706235925724       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706235925724       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.301189 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0860e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.354
    reference variance = 0.303389
====================================================
  Execution time = 4.4911e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0837e-01
  Total weights = 2.0000e+06
  Execution time = 3.8272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508373680188
                                         uncertainty =       0.007193514973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508373680188
                                         uncertainty =       0.007193514973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504168728
  error estimate for blocks of size 2^( 2) =       0.000530306880
  error estimate for blocks of size 2^( 3) =       0.000555018584
  error estimate for blocks of size 2^( 4) =       0.000573495009
  error estimate for blocks of size 2^( 5) =       0.000586168460
  error estimate for blocks of size 2^( 6) =       0.000593414693
  error estimate for blocks of size 2^( 7) =       0.000599000729

      target function =      -0.700995352077
              le_mean =     -22.425792043569
             les_mean =     503.424520740311
             stat err =       0.000588019723
             autocorr =       1.360291476978
   target nu stat err =       0.000588019723
   target dn stat err =       0.007353189247
      target stat err =       0.005232212158
              std dev =       0.713002253210
             le_variance =       0.508372213082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508373680188
                                         uncertainty =       0.007193514973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508373680188
                                         uncertainty =       0.007193514973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504168728
  error estimate for blocks of size 2^( 2) =       0.000530306880
  error estimate for blocks of size 2^( 3) =       0.000555018584
  error estimate for blocks of size 2^( 4) =       0.000573495009
  error estimate for blocks of size 2^( 5) =       0.000586168460
  error estimate for blocks of size 2^( 6) =       0.000593414693
  error estimate for blocks of size 2^( 7) =       0.000599000729

      target function =      -0.700995352077
              le_mean =     -22.425792043569
             les_mean =     503.424520740311
             stat err =       0.000588019723
             autocorr =       1.360291476978
   target nu stat err =       0.000588019723
   target dn stat err =       0.007353189247
      target stat err =       0.005232212158
              std dev =       0.713002253210
             le_variance =       0.508372213082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508373680188
                                         uncertainty =       0.007193514973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508373680188
                                         uncertainty =       0.007193514973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504168728
  error estimate for blocks of size 2^( 2) =       0.000530306880
  error estimate for blocks of size 2^( 3) =       0.000555018584
  error estimate for blocks of size 2^( 4) =       0.000573495009
  error estimate for blocks of size 2^( 5) =       0.000586168460
  error estimate for blocks of size 2^( 6) =       0.000593414693
  error estimate for blocks of size 2^( 7) =       0.000599000729

      target function =      -0.700995352077
              le_mean =     -22.425792043569
             les_mean =     503.424520740311
             stat err =       0.000588019723
             autocorr =       1.360291476978
   target nu stat err =       0.000588019723
   target dn stat err =       0.007353189247
      target stat err =       0.005232212158
              std dev =       0.713002253210
             le_variance =       0.508372213082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508373680188
                                         uncertainty =       0.007193514973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508373680188
                                         uncertainty =       0.007193514973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504168728
  error estimate for blocks of size 2^( 2) =       0.000530306880
  error estimate for blocks of size 2^( 3) =       0.000555018584
  error estimate for blocks of size 2^( 4) =       0.000573495009
  error estimate for blocks of size 2^( 5) =       0.000586168460
  error estimate for blocks of size 2^( 6) =       0.000593414693
  error estimate for blocks of size 2^( 7) =       0.000599000729

      target function =      -0.700995352077
              le_mean =     -22.425792043569
             les_mean =     503.424520740311
             stat err =       0.000588019723
             autocorr =       1.360291476978
   target nu stat err =       0.000588019723
   target dn stat err =       0.007353189247
      target stat err =       0.005232212158
              std dev =       0.713002253210
             le_variance =       0.508372213082


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.700995352077        initial  <--
     1.0000e+48     1.0000e+49             0.0000e+00        -0.700995352077
     4.0000e+48     4.0000e+49             0.0000e+00        -0.700995352077
     1.6000e+49     1.6000e+50             0.0000e+00        -0.700995352077

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0718
  </log>
  <optVariables href="FORM.s049.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2494e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.425
    reference variance = 0.35364
====================================================
  Execution time = 4.5015e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2425e+01
  VMC Evar = 4.9611e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5369e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496127629977
                                         uncertainty =       0.003441121148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496127629977
                                         uncertainty =       0.003441121148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498053659
  error estimate for blocks of size 2^( 2) =       0.000524499963
  error estimate for blocks of size 2^( 3) =       0.000549671467
  error estimate for blocks of size 2^( 4) =       0.000568192570
  error estimate for blocks of size 2^( 5) =       0.000581259465
  error estimate for blocks of size 2^( 6) =       0.000588950814
  error estimate for blocks of size 2^( 7) =       0.000592564764

      target function =      -0.709808674531
              le_mean =     -22.425181079822
             les_mean =     503.384861108289
             stat err =       0.000582741903
             autocorr =       1.368989846166
   target nu stat err =       0.000582741903
   target dn stat err =       0.003321360608
      target stat err =       0.002477694045
              std dev =       0.704354238672
             le_variance =       0.496114893536


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242518107982e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+49, overlap shift 1.0000e+50 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709816244611       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709816244611       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+49, overlap shift 4.0000e+50 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709816244611       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709816244611       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+50, overlap shift 1.6000e+51 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709816244611       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709816244611       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.302289 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0393e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.4415
    reference variance = 0.38883
====================================================
  Execution time = 4.6296e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0217e-01
  Total weights = 2.0000e+06
  Execution time = 3.8150e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502228578445
                                         uncertainty =       0.006601448317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502228578445
                                         uncertainty =       0.006601448317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501081805
  error estimate for blocks of size 2^( 2) =       0.000527430571
  error estimate for blocks of size 2^( 3) =       0.000552291786
  error estimate for blocks of size 2^( 4) =       0.000571749343
  error estimate for blocks of size 2^( 5) =       0.000584030959
  error estimate for blocks of size 2^( 6) =       0.000589015066
  error estimate for blocks of size 2^( 7) =       0.000592989172

      target function =      -0.705421501474
              le_mean =     -22.425557645605
             les_mean =     503.407801414904
             stat err =       0.000584446135
             autocorr =       1.360415953941
   target nu stat err =       0.000584446135
   target dn stat err =       0.006685263400
      target stat err =       0.004821109620
              std dev =       0.708636683815
             le_variance =       0.502165949648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502228578445
                                         uncertainty =       0.006601448317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502228578445
                                         uncertainty =       0.006601448317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501081805
  error estimate for blocks of size 2^( 2) =       0.000527430571
  error estimate for blocks of size 2^( 3) =       0.000552291786
  error estimate for blocks of size 2^( 4) =       0.000571749343
  error estimate for blocks of size 2^( 5) =       0.000584030959
  error estimate for blocks of size 2^( 6) =       0.000589015066
  error estimate for blocks of size 2^( 7) =       0.000592989172

      target function =      -0.705421501474
              le_mean =     -22.425557645605
             les_mean =     503.407801414904
             stat err =       0.000584446135
             autocorr =       1.360415953939
   target nu stat err =       0.000584446135
   target dn stat err =       0.006685263400
      target stat err =       0.004821109620
              std dev =       0.708636683815
             le_variance =       0.502165949648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502228578445
                                         uncertainty =       0.006601448317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502228578445
                                         uncertainty =       0.006601448317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501081805
  error estimate for blocks of size 2^( 2) =       0.000527430571
  error estimate for blocks of size 2^( 3) =       0.000552291786
  error estimate for blocks of size 2^( 4) =       0.000571749343
  error estimate for blocks of size 2^( 5) =       0.000584030959
  error estimate for blocks of size 2^( 6) =       0.000589015066
  error estimate for blocks of size 2^( 7) =       0.000592989172

      target function =      -0.705421501474
              le_mean =     -22.425557645605
             les_mean =     503.407801414904
             stat err =       0.000584446135
             autocorr =       1.360415953939
   target nu stat err =       0.000584446135
   target dn stat err =       0.006685263400
      target stat err =       0.004821109620
              std dev =       0.708636683815
             le_variance =       0.502165949648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502228578445
                                         uncertainty =       0.006601448317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502228578445
                                         uncertainty =       0.006601448317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501081805
  error estimate for blocks of size 2^( 2) =       0.000527430571
  error estimate for blocks of size 2^( 3) =       0.000552291786
  error estimate for blocks of size 2^( 4) =       0.000571749343
  error estimate for blocks of size 2^( 5) =       0.000584030959
  error estimate for blocks of size 2^( 6) =       0.000589015066
  error estimate for blocks of size 2^( 7) =       0.000592989172

      target function =      -0.705421501474
              le_mean =     -22.425557645605
             les_mean =     503.407801414904
             stat err =       0.000584446135
             autocorr =       1.360415953939
   target nu stat err =       0.000584446135
   target dn stat err =       0.006685263400
      target stat err =       0.004821109620
              std dev =       0.708636683815
             le_variance =       0.502165949648


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.705421501474        initial  <--
     1.0000e+49     1.0000e+50             0.0000e+00        -0.705421501474
     4.0000e+49     4.0000e+50             0.0000e+00        -0.705421501474
     1.6000e+50     1.6000e+51             0.0000e+00        -0.705421501474

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.6753
  </log>
  <optVariables href="FORM.s050.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2709e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.3885
    reference variance = 0.376247
====================================================
  Execution time = 4.5592e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0362e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5139e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503535583967
                                         uncertainty =       0.006087765702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503535583967
                                         uncertainty =       0.006087765702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501804376
  error estimate for blocks of size 2^( 2) =       0.000527870787
  error estimate for blocks of size 2^( 3) =       0.000552778041
  error estimate for blocks of size 2^( 4) =       0.000571827579
  error estimate for blocks of size 2^( 5) =       0.000584531787
  error estimate for blocks of size 2^( 6) =       0.000590251712
  error estimate for blocks of size 2^( 7) =       0.000594990456

      target function =      -0.704382522240
              le_mean =     -22.425934368293
             les_mean =     503.426147302650
             stat err =       0.000585400383
             autocorr =       1.360934164784
   target nu stat err =       0.000585400383
   target dn stat err =       0.006206437459
      target stat err =       0.004470669318
              std dev =       0.709658554159
             le_variance =       0.503615263490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242593436829e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+50, overlap shift 1.0000e+51 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.704410179238       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.704410179238       residual = 8.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 2.55e+02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+50 is 6.517211e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+50, overlap shift 4.0000e+51 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.704410179238       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.704410179238       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+51, overlap shift 1.6000e+52 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.704410179238       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.704410179238       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.303482 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0738e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.3696
    reference variance = 0.32692
====================================================
  Execution time = 4.4119e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9983e-01
  Total weights = 2.0000e+06
  Execution time = 3.8127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499870930247
                                         uncertainty =       0.003591792938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499870930247
                                         uncertainty =       0.003591792938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499913477
  error estimate for blocks of size 2^( 2) =       0.000526130272
  error estimate for blocks of size 2^( 3) =       0.000550977992
  error estimate for blocks of size 2^( 4) =       0.000569559055
  error estimate for blocks of size 2^( 5) =       0.000581676441
  error estimate for blocks of size 2^( 6) =       0.000589780537
  error estimate for blocks of size 2^( 7) =       0.000593864088

      target function =      -0.707108452994
              le_mean =     -22.426271485236
             les_mean =     503.437479448970
             stat err =       0.000583720030
             autocorr =       1.363388111023
   target nu stat err =       0.000583720030
   target dn stat err =       0.003962619023
      target stat err =       0.002913625401
              std dev =       0.706984419466
             le_variance =       0.499826969367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499870930247
                                         uncertainty =       0.003591792938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499870930247
                                         uncertainty =       0.003591792938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499913477
  error estimate for blocks of size 2^( 2) =       0.000526130272
  error estimate for blocks of size 2^( 3) =       0.000550977992
  error estimate for blocks of size 2^( 4) =       0.000569559055
  error estimate for blocks of size 2^( 5) =       0.000581676441
  error estimate for blocks of size 2^( 6) =       0.000589780537
  error estimate for blocks of size 2^( 7) =       0.000593864088

      target function =      -0.707108452994
              le_mean =     -22.426271485236
             les_mean =     503.437479448970
             stat err =       0.000583720030
             autocorr =       1.363388111023
   target nu stat err =       0.000583720030
   target dn stat err =       0.003962619023
      target stat err =       0.002913625401
              std dev =       0.706984419466
             le_variance =       0.499826969367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499870930247
                                         uncertainty =       0.003591792938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499870930247
                                         uncertainty =       0.003591792938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499913477
  error estimate for blocks of size 2^( 2) =       0.000526130272
  error estimate for blocks of size 2^( 3) =       0.000550977992
  error estimate for blocks of size 2^( 4) =       0.000569559055
  error estimate for blocks of size 2^( 5) =       0.000581676441
  error estimate for blocks of size 2^( 6) =       0.000589780537
  error estimate for blocks of size 2^( 7) =       0.000593864088

      target function =      -0.707108452994
              le_mean =     -22.426271485236
             les_mean =     503.437479448970
             stat err =       0.000583720030
             autocorr =       1.363388111023
   target nu stat err =       0.000583720030
   target dn stat err =       0.003962619023
      target stat err =       0.002913625401
              std dev =       0.706984419466
             le_variance =       0.499826969367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499870930247
                                         uncertainty =       0.003591792938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499870930247
                                         uncertainty =       0.003591792938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499913477
  error estimate for blocks of size 2^( 2) =       0.000526130272
  error estimate for blocks of size 2^( 3) =       0.000550977992
  error estimate for blocks of size 2^( 4) =       0.000569559055
  error estimate for blocks of size 2^( 5) =       0.000581676441
  error estimate for blocks of size 2^( 6) =       0.000589780537
  error estimate for blocks of size 2^( 7) =       0.000593864088

      target function =      -0.707108452994
              le_mean =     -22.426271485236
             les_mean =     503.437479448970
             stat err =       0.000583720030
             autocorr =       1.363388111023
   target nu stat err =       0.000583720030
   target dn stat err =       0.003962619023
      target stat err =       0.002913625401
              std dev =       0.706984419466
             le_variance =       0.499826969367


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707108452994        initial  <--
     1.0000e+50     1.0000e+51             6.5172e-55        -0.707108452994
     4.0000e+50     4.0000e+51             0.0000e+00        -0.707108452994
     1.6000e+51     1.6000e+52             0.0000e+00        -0.707108452994

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.2241
  </log>
  <optVariables href="FORM.s051.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2397e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2433e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.5173
    reference variance = 1.60452
====================================================
  Execution time = 4.5683e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0921e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5034e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509155895126
                                         uncertainty =       0.006723507053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509155895126
                                         uncertainty =       0.006723507053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504583344
  error estimate for blocks of size 2^( 2) =       0.000530171555
  error estimate for blocks of size 2^( 3) =       0.000555017257
  error estimate for blocks of size 2^( 4) =       0.000572789264
  error estimate for blocks of size 2^( 5) =       0.000584055130
  error estimate for blocks of size 2^( 6) =       0.000591407460
  error estimate for blocks of size 2^( 7) =       0.000597269487

      target function =      -0.700409836228
              le_mean =     -22.425770926306
             les_mean =     503.424410086777
             stat err =       0.000586380335
             autocorr =       1.350494977197
   target nu stat err =       0.000586380335
   target dn stat err =       0.006896657885
      target stat err =       0.004903149791
              std dev =       0.713588608548
             le_variance =       0.509208702250


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242577092631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+51, overlap shift 1.0000e+52 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.700443406072       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.700443406072       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+51, overlap shift 4.0000e+52 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.700443406072       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.700443406072       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+52, overlap shift 1.6000e+53 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.700443406072       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.700443406072       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.304610 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0726e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.418
    reference variance = 0.441143
====================================================
  Execution time = 4.4931e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2425e+01
  VMC Evar = 4.9441e-01
  Total weights = 2.0000e+06
  Execution time = 3.8169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494470985883
                                         uncertainty =       0.002638712069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494470985883
                                         uncertainty =       0.002638712069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497196836
  error estimate for blocks of size 2^( 2) =       0.000523599275
  error estimate for blocks of size 2^( 3) =       0.000548423712
  error estimate for blocks of size 2^( 4) =       0.000567556544
  error estimate for blocks of size 2^( 5) =       0.000579424663
  error estimate for blocks of size 2^( 6) =       0.000585241126
  error estimate for blocks of size 2^( 7) =       0.000586907856

      target function =      -0.711054912922
              le_mean =     -22.424586985390
             les_mean =     503.356510606075
             stat err =       0.000579782547
             autocorr =       1.359795384645
   target nu stat err =       0.000579782547
   target dn stat err =       0.002662991466
      target stat err =       0.002022247233
              std dev =       0.703142508989
             le_variance =       0.494409387948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494470985883
                                         uncertainty =       0.002638712069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494470985883
                                         uncertainty =       0.002638712069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497196836
  error estimate for blocks of size 2^( 2) =       0.000523599275
  error estimate for blocks of size 2^( 3) =       0.000548423712
  error estimate for blocks of size 2^( 4) =       0.000567556544
  error estimate for blocks of size 2^( 5) =       0.000579424663
  error estimate for blocks of size 2^( 6) =       0.000585241126
  error estimate for blocks of size 2^( 7) =       0.000586907856

      target function =      -0.711054912922
              le_mean =     -22.424586985390
             les_mean =     503.356510606075
             stat err =       0.000579782547
             autocorr =       1.359795384645
   target nu stat err =       0.000579782547
   target dn stat err =       0.002662991466
      target stat err =       0.002022247233
              std dev =       0.703142508989
             le_variance =       0.494409387948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494470985883
                                         uncertainty =       0.002638712069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494470985883
                                         uncertainty =       0.002638712069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497196836
  error estimate for blocks of size 2^( 2) =       0.000523599275
  error estimate for blocks of size 2^( 3) =       0.000548423712
  error estimate for blocks of size 2^( 4) =       0.000567556544
  error estimate for blocks of size 2^( 5) =       0.000579424663
  error estimate for blocks of size 2^( 6) =       0.000585241126
  error estimate for blocks of size 2^( 7) =       0.000586907856

      target function =      -0.711054912922
              le_mean =     -22.424586985390
             les_mean =     503.356510606075
             stat err =       0.000579782547
             autocorr =       1.359795384645
   target nu stat err =       0.000579782547
   target dn stat err =       0.002662991466
      target stat err =       0.002022247233
              std dev =       0.703142508989
             le_variance =       0.494409387948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494470985883
                                         uncertainty =       0.002638712069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494470985883
                                         uncertainty =       0.002638712069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497196836
  error estimate for blocks of size 2^( 2) =       0.000523599275
  error estimate for blocks of size 2^( 3) =       0.000548423712
  error estimate for blocks of size 2^( 4) =       0.000567556544
  error estimate for blocks of size 2^( 5) =       0.000579424663
  error estimate for blocks of size 2^( 6) =       0.000585241126
  error estimate for blocks of size 2^( 7) =       0.000586907856

      target function =      -0.711054912922
              le_mean =     -22.424586985390
             les_mean =     503.356510606075
             stat err =       0.000579782547
             autocorr =       1.359795384645
   target nu stat err =       0.000579782547
   target dn stat err =       0.002662991466
      target stat err =       0.002022247233
              std dev =       0.703142508989
             le_variance =       0.494409387948


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.711054912922        initial  <--
     1.0000e+51     1.0000e+52             0.0000e+00        -0.711054912922
     4.0000e+51     4.0000e+52             0.0000e+00        -0.711054912922
     1.6000e+52     1.6000e+53             0.0000e+00        -0.711054912922

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.6369
  </log>
  <optVariables href="FORM.s052.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2637e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.402
    reference variance = 0.367464
====================================================
  Execution time = 4.5663e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9761e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5271e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497619711527
                                         uncertainty =       0.002897363038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497619711527
                                         uncertainty =       0.002897363038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498802505
  error estimate for blocks of size 2^( 2) =       0.000525303948
  error estimate for blocks of size 2^( 3) =       0.000550487194
  error estimate for blocks of size 2^( 4) =       0.000569478569
  error estimate for blocks of size 2^( 5) =       0.000583584433
  error estimate for blocks of size 2^( 6) =       0.000590931680
  error estimate for blocks of size 2^( 7) =       0.000593617352

      target function =      -0.708712254899
              le_mean =     -22.426379586292
             les_mean =     503.440108978269
             stat err =       0.000584403008
             autocorr =       1.372674714041
   target nu stat err =       0.000584403008
   target dn stat err =       0.003072111982
      target stat err =       0.002300396917
              std dev =       0.705413267976
             le_variance =       0.497607878637


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242637958629e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+52, overlap shift 1.0000e+53 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708718707078       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708718707078       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+52, overlap shift 4.0000e+53 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708718707078       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708718707078       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+53, overlap shift 1.6000e+54 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708718707078       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708718707078       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.305700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0940e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.4041
    reference variance = 0.320542
====================================================
  Execution time = 4.4893e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0374e-01
  Total weights = 2.0000e+06
  Execution time = 3.8139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503772201368
                                         uncertainty =       0.004506318088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503772201368
                                         uncertainty =       0.004506318088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501867069
  error estimate for blocks of size 2^( 2) =       0.000528080580
  error estimate for blocks of size 2^( 3) =       0.000552790056
  error estimate for blocks of size 2^( 4) =       0.000571926691
  error estimate for blocks of size 2^( 5) =       0.000582386540
  error estimate for blocks of size 2^( 6) =       0.000588729913
  error estimate for blocks of size 2^( 7) =       0.000591004744

      target function =      -0.704303373232
              le_mean =     -22.426043389941
             les_mean =     503.431162985624
             stat err =       0.000583511972
             autocorr =       1.351830195010
   target nu stat err =       0.000583511972
   target dn stat err =       0.004561982915
      target stat err =       0.003310041750
              std dev =       0.709747215535
             le_variance =       0.503741109959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503772201368
                                         uncertainty =       0.004506318088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503772201368
                                         uncertainty =       0.004506318088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501867069
  error estimate for blocks of size 2^( 2) =       0.000528080580
  error estimate for blocks of size 2^( 3) =       0.000552790056
  error estimate for blocks of size 2^( 4) =       0.000571926691
  error estimate for blocks of size 2^( 5) =       0.000582386540
  error estimate for blocks of size 2^( 6) =       0.000588729913
  error estimate for blocks of size 2^( 7) =       0.000591004744

      target function =      -0.704303373232
              le_mean =     -22.426043389941
             les_mean =     503.431162985624
             stat err =       0.000583511972
             autocorr =       1.351830195011
   target nu stat err =       0.000583511972
   target dn stat err =       0.004561982915
      target stat err =       0.003310041750
              std dev =       0.709747215535
             le_variance =       0.503741109959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503772201368
                                         uncertainty =       0.004506318088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503772201368
                                         uncertainty =       0.004506318088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501867069
  error estimate for blocks of size 2^( 2) =       0.000528080580
  error estimate for blocks of size 2^( 3) =       0.000552790056
  error estimate for blocks of size 2^( 4) =       0.000571926691
  error estimate for blocks of size 2^( 5) =       0.000582386540
  error estimate for blocks of size 2^( 6) =       0.000588729913
  error estimate for blocks of size 2^( 7) =       0.000591004744

      target function =      -0.704303373232
              le_mean =     -22.426043389941
             les_mean =     503.431162985624
             stat err =       0.000583511972
             autocorr =       1.351830195011
   target nu stat err =       0.000583511972
   target dn stat err =       0.004561982915
      target stat err =       0.003310041750
              std dev =       0.709747215535
             le_variance =       0.503741109959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503772201368
                                         uncertainty =       0.004506318088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503772201368
                                         uncertainty =       0.004506318088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501867069
  error estimate for blocks of size 2^( 2) =       0.000528080580
  error estimate for blocks of size 2^( 3) =       0.000552790056
  error estimate for blocks of size 2^( 4) =       0.000571926691
  error estimate for blocks of size 2^( 5) =       0.000582386540
  error estimate for blocks of size 2^( 6) =       0.000588729913
  error estimate for blocks of size 2^( 7) =       0.000591004744

      target function =      -0.704303373232
              le_mean =     -22.426043389941
             les_mean =     503.431162985624
             stat err =       0.000583511972
             autocorr =       1.351830195011
   target nu stat err =       0.000583511972
   target dn stat err =       0.004561982915
      target stat err =       0.003310041750
              std dev =       0.709747215535
             le_variance =       0.503741109959


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.704303373232        initial  <--
     1.0000e+52     1.0000e+53             0.0000e+00        -0.704303373232
     4.0000e+52     4.0000e+53             0.0000e+00        -0.704303373232
     1.6000e+53     1.6000e+54             0.0000e+00        -0.704303373232

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9787
  </log>
  <optVariables href="FORM.s053.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2492e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2433e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.4893
    reference variance = 0.569445
====================================================
  Execution time = 4.5050e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.2703e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5038e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527083261509
                                         uncertainty =       0.021937229238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527083261509
                                         uncertainty =       0.021937229238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513335775
  error estimate for blocks of size 2^( 2) =       0.000538580991
  error estimate for blocks of size 2^( 3) =       0.000562382917
  error estimate for blocks of size 2^( 4) =       0.000580134881
  error estimate for blocks of size 2^( 5) =       0.000592025381
  error estimate for blocks of size 2^( 6) =       0.000598921437
  error estimate for blocks of size 2^( 7) =       0.000599323668

      target function =      -0.687715033183
              le_mean =     -22.426650677196
             les_mean =     503.481687568693
             stat err =       0.000592601342
             autocorr =       1.332668699231
   target nu stat err =       0.000592601342
   target dn stat err =       0.022395673302
      target stat err =       0.015275621476
              std dev =       0.725966414677
             le_variance =       0.527027235239


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242665067720e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+53, overlap shift 1.0000e+54 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.688050579693       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.688050579693       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+53, overlap shift 4.0000e+54 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.688050579693       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.688050579693       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+54, overlap shift 1.6000e+55 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.688050579693       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.688050579693       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.306814 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0095e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.446
    reference variance = 0.281346
====================================================
  Execution time = 4.5240e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0084e-01
  Total weights = 2.0000e+06
  Execution time = 3.8257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500958159309
                                         uncertainty =       0.002762416875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500958159309
                                         uncertainty =       0.002762416875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500420556
  error estimate for blocks of size 2^( 2) =       0.000526292319
  error estimate for blocks of size 2^( 3) =       0.000551555009
  error estimate for blocks of size 2^( 4) =       0.000571001859
  error estimate for blocks of size 2^( 5) =       0.000583083482
  error estimate for blocks of size 2^( 6) =       0.000591312099
  error estimate for blocks of size 2^( 7) =       0.000593722942

      target function =      -0.706396607209
              le_mean =     -22.425550859612
             les_mean =     503.406172572969
             stat err =       0.000584780095
             autocorr =       1.365572872602
   target nu stat err =       0.000584780095
   target dn stat err =       0.003122770293
      target stat err =       0.002318389774
              std dev =       0.707701537614
             le_variance =       0.500841466342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500958159309
                                         uncertainty =       0.002762416875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500958159309
                                         uncertainty =       0.002762416875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500420556
  error estimate for blocks of size 2^( 2) =       0.000526292319
  error estimate for blocks of size 2^( 3) =       0.000551555009
  error estimate for blocks of size 2^( 4) =       0.000571001859
  error estimate for blocks of size 2^( 5) =       0.000583083482
  error estimate for blocks of size 2^( 6) =       0.000591312099
  error estimate for blocks of size 2^( 7) =       0.000593722942

      target function =      -0.706396607209
              le_mean =     -22.425550859612
             les_mean =     503.406172572969
             stat err =       0.000584780095
             autocorr =       1.365572872605
   target nu stat err =       0.000584780095
   target dn stat err =       0.003122770293
      target stat err =       0.002318389774
              std dev =       0.707701537614
             le_variance =       0.500841466342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500958159309
                                         uncertainty =       0.002762416875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500958159309
                                         uncertainty =       0.002762416875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500420556
  error estimate for blocks of size 2^( 2) =       0.000526292319
  error estimate for blocks of size 2^( 3) =       0.000551555009
  error estimate for blocks of size 2^( 4) =       0.000571001859
  error estimate for blocks of size 2^( 5) =       0.000583083482
  error estimate for blocks of size 2^( 6) =       0.000591312099
  error estimate for blocks of size 2^( 7) =       0.000593722942

      target function =      -0.706396607209
              le_mean =     -22.425550859612
             les_mean =     503.406172572969
             stat err =       0.000584780095
             autocorr =       1.365572872605
   target nu stat err =       0.000584780095
   target dn stat err =       0.003122770293
      target stat err =       0.002318389774
              std dev =       0.707701537614
             le_variance =       0.500841466342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500958159309
                                         uncertainty =       0.002762416875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500958159309
                                         uncertainty =       0.002762416875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500420556
  error estimate for blocks of size 2^( 2) =       0.000526292319
  error estimate for blocks of size 2^( 3) =       0.000551555009
  error estimate for blocks of size 2^( 4) =       0.000571001859
  error estimate for blocks of size 2^( 5) =       0.000583083482
  error estimate for blocks of size 2^( 6) =       0.000591312099
  error estimate for blocks of size 2^( 7) =       0.000593722942

      target function =      -0.706396607209
              le_mean =     -22.425550859612
             les_mean =     503.406172572969
             stat err =       0.000584780095
             autocorr =       1.365572872605
   target nu stat err =       0.000584780095
   target dn stat err =       0.003122770293
      target stat err =       0.002318389774
              std dev =       0.707701537614
             le_variance =       0.500841466342


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706396607209        initial  <--
     1.0000e+53     1.0000e+54             0.0000e+00        -0.706396607209
     4.0000e+53     4.0000e+54             0.0000e+00        -0.706396607209
     1.6000e+54     1.6000e+55             0.0000e+00        -0.706396607209

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.4140
  </log>
  <optVariables href="FORM.s054.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2451e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.337
    reference variance = 0.494944
====================================================
  Execution time = 4.6351e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.6029e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5306e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560421264807
                                         uncertainty =       0.055380494734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560421264807
                                         uncertainty =       0.055380494734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529287177
  error estimate for blocks of size 2^( 2) =       0.000553848127
  error estimate for blocks of size 2^( 3) =       0.000577372277
  error estimate for blocks of size 2^( 4) =       0.000595590745
  error estimate for blocks of size 2^( 5) =       0.000606936479
  error estimate for blocks of size 2^( 6) =       0.000610886559
  error estimate for blocks of size 2^( 7) =       0.000615507946

      target function =      -0.664257834659
              le_mean =     -22.425920869004
             les_mean =     503.482216374781
             stat err =       0.000607230432
             autocorr =       1.316207350223
   target nu stat err =       0.000607230432
   target dn stat err =       0.055759388904
      target stat err =       0.035506668643
              std dev =       0.748525104523
             le_variance =       0.560289832101


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242592086900e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+54, overlap shift 1.0000e+55 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.666144646167       residual = 8.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.666144646167       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.666144646167       residual = 9.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.42e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 2.35e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+54 is 5.692841e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+54, overlap shift 4.0000e+55 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.666144646167       residual = 8.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.666144646167       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 2.41e+02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+54 is 6.579099e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+55, overlap shift 1.6000e+56 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.666144646167       residual = 8.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.666144646167       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 2.41e+02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+55 is 1.644775e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.308368 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1664e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.4904
    reference variance = 0.465113
====================================================
  Execution time = 4.6758e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0558e-01
  Total weights = 2.0000e+06
  Execution time = 3.8400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505689036717
                                         uncertainty =       0.004198177749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505689036717
                                         uncertainty =       0.004198177749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502781224
  error estimate for blocks of size 2^( 2) =       0.000529030185
  error estimate for blocks of size 2^( 3) =       0.000553197850
  error estimate for blocks of size 2^( 4) =       0.000571794111
  error estimate for blocks of size 2^( 5) =       0.000583821461
  error estimate for blocks of size 2^( 6) =       0.000588884509
  error estimate for blocks of size 2^( 7) =       0.000592134999

      target function =      -0.703003995367
              le_mean =     -22.425686034297
             les_mean =     503.416971774329
             stat err =       0.000584158770
             autocorr =       1.349906537359
   target nu stat err =       0.000584158770
   target dn stat err =       0.004384114769
      target stat err =       0.003172132499
              std dev =       0.711040025761
             le_variance =       0.505577918235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505689036717
                                         uncertainty =       0.004198177749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505689036717
                                         uncertainty =       0.004198177749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502781224
  error estimate for blocks of size 2^( 2) =       0.000529030185
  error estimate for blocks of size 2^( 3) =       0.000553197850
  error estimate for blocks of size 2^( 4) =       0.000571794111
  error estimate for blocks of size 2^( 5) =       0.000583821461
  error estimate for blocks of size 2^( 6) =       0.000588884509
  error estimate for blocks of size 2^( 7) =       0.000592134999

      target function =      -0.703003995367
              le_mean =     -22.425686034297
             les_mean =     503.416971774329
             stat err =       0.000584158770
             autocorr =       1.349906537359
   target nu stat err =       0.000584158770
   target dn stat err =       0.004384114769
      target stat err =       0.003172132499
              std dev =       0.711040025761
             le_variance =       0.505577918235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505689036717
                                         uncertainty =       0.004198177749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505689036717
                                         uncertainty =       0.004198177749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502781224
  error estimate for blocks of size 2^( 2) =       0.000529030185
  error estimate for blocks of size 2^( 3) =       0.000553197850
  error estimate for blocks of size 2^( 4) =       0.000571794111
  error estimate for blocks of size 2^( 5) =       0.000583821461
  error estimate for blocks of size 2^( 6) =       0.000588884509
  error estimate for blocks of size 2^( 7) =       0.000592134999

      target function =      -0.703003995367
              le_mean =     -22.425686034297
             les_mean =     503.416971774329
             stat err =       0.000584158770
             autocorr =       1.349906537359
   target nu stat err =       0.000584158770
   target dn stat err =       0.004384114769
      target stat err =       0.003172132499
              std dev =       0.711040025761
             le_variance =       0.505577918235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505689036717
                                         uncertainty =       0.004198177749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505689036717
                                         uncertainty =       0.004198177749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502781224
  error estimate for blocks of size 2^( 2) =       0.000529030185
  error estimate for blocks of size 2^( 3) =       0.000553197850
  error estimate for blocks of size 2^( 4) =       0.000571794111
  error estimate for blocks of size 2^( 5) =       0.000583821461
  error estimate for blocks of size 2^( 6) =       0.000588884509
  error estimate for blocks of size 2^( 7) =       0.000592134999

      target function =      -0.703003995367
              le_mean =     -22.425686034297
             les_mean =     503.416971774329
             stat err =       0.000584158770
             autocorr =       1.349906537359
   target nu stat err =       0.000584158770
   target dn stat err =       0.004384114769
      target stat err =       0.003172132499
              std dev =       0.711040025761
             le_variance =       0.505577918235


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.703003995367        initial  <--
     1.0000e+54     1.0000e+55             5.6928e-58        -0.703003995367
     4.0000e+54     4.0000e+55             6.5791e-59        -0.703003995367
     1.6000e+55     1.6000e+56             1.6448e-59        -0.703003995367

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.0013
  </log>
  <optVariables href="FORM.s055.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2767e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.4469
    reference variance = 0.640013
====================================================
  Execution time = 4.4946e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9848e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5054e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498481181029
                                         uncertainty =       0.003419195169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498481181029
                                         uncertainty =       0.003419195169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499239374
  error estimate for blocks of size 2^( 2) =       0.000525365018
  error estimate for blocks of size 2^( 3) =       0.000550638367
  error estimate for blocks of size 2^( 4) =       0.000569657682
  error estimate for blocks of size 2^( 5) =       0.000582118752
  error estimate for blocks of size 2^( 6) =       0.000590569658
  error estimate for blocks of size 2^( 7) =       0.000594991569

      target function =      -0.708065580657
              le_mean =     -22.427150892863
             les_mean =     503.475576826127
             stat err =       0.000584334415
             autocorr =       1.369951751764
   target nu stat err =       0.000584334415
   target dn stat err =       0.003676679851
      target stat err =       0.002723201571
              std dev =       0.706031092895
             le_variance =       0.498479904135


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242715089286e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+55, overlap shift 1.0000e+56 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708075242564       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708075242564       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708075242564       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.56e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708075242564       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708075242499       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+55 is 6.247573e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+55, overlap shift 4.0000e+56 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708075242564       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708075242564       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 2.56e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708075242564       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 2.49e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+55 is 1.386785e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+56, overlap shift 1.6000e+57 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708075242564       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708075242564       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 2.56e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708075242564       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 2.49e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+56 is 3.466963e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.310437 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0007e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.4045
    reference variance = 0.392742
====================================================
  Execution time = 4.4638e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.3955e-01
  Total weights = 2.0000e+06
  Execution time = 3.8240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497704950201
                                         uncertainty =       0.002776409646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497704950201
                                         uncertainty =       0.002776409646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000519399487
  error estimate for blocks of size 2^( 2) =       0.000544769389
  error estimate for blocks of size 2^( 3) =       0.000569793797
  error estimate for blocks of size 2^( 4) =       0.000588777318
  error estimate for blocks of size 2^( 5) =       0.000583125671
  error estimate for blocks of size 2^( 6) =       0.000590151098
  error estimate for blocks of size 2^( 7) =       0.000592100738

      target function =      -0.678507849364
              le_mean =     -22.425953147286
             les_mean =     503.462925948322
             stat err =       0.000588538706
             autocorr =       1.283946796222
   target nu stat err =       0.000588538706
   target dn stat err =       0.012882237731
      target stat err =       0.008567639339
              std dev =       0.734541798565
             le_variance =       0.539551653840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497704950201
                                         uncertainty =       0.002776409646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497704950201
                                         uncertainty =       0.002776409646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000519399487
  error estimate for blocks of size 2^( 2) =       0.000544769389
  error estimate for blocks of size 2^( 3) =       0.000569793797
  error estimate for blocks of size 2^( 4) =       0.000588777318
  error estimate for blocks of size 2^( 5) =       0.000583125671
  error estimate for blocks of size 2^( 6) =       0.000590151098
  error estimate for blocks of size 2^( 7) =       0.000592100738

      target function =      -0.678507849364
              le_mean =     -22.425953147286
             les_mean =     503.462925948322
             stat err =       0.000588538706
             autocorr =       1.283946796222
   target nu stat err =       0.000588538706
   target dn stat err =       0.012882237731
      target stat err =       0.008567639339
              std dev =       0.734541798565
             le_variance =       0.539551653840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497704950201
                                         uncertainty =       0.002776409646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497704950201
                                         uncertainty =       0.002776409646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000519399487
  error estimate for blocks of size 2^( 2) =       0.000544769389
  error estimate for blocks of size 2^( 3) =       0.000569793797
  error estimate for blocks of size 2^( 4) =       0.000588777318
  error estimate for blocks of size 2^( 5) =       0.000583125671
  error estimate for blocks of size 2^( 6) =       0.000590151098
  error estimate for blocks of size 2^( 7) =       0.000592100738

      target function =      -0.678507849364
              le_mean =     -22.425953147286
             les_mean =     503.462925948322
             stat err =       0.000588538706
             autocorr =       1.283946796222
   target nu stat err =       0.000588538706
   target dn stat err =       0.012882237731
      target stat err =       0.008567639339
              std dev =       0.734541798565
             le_variance =       0.539551653840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497704950201
                                         uncertainty =       0.002776409646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497704950201
                                         uncertainty =       0.002776409646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000519399487
  error estimate for blocks of size 2^( 2) =       0.000544769389
  error estimate for blocks of size 2^( 3) =       0.000569793797
  error estimate for blocks of size 2^( 4) =       0.000588777318
  error estimate for blocks of size 2^( 5) =       0.000583125671
  error estimate for blocks of size 2^( 6) =       0.000590151098
  error estimate for blocks of size 2^( 7) =       0.000592100738

      target function =      -0.678507849364
              le_mean =     -22.425953147286
             les_mean =     503.462925948322
             stat err =       0.000588538706
             autocorr =       1.283946796222
   target nu stat err =       0.000588538706
   target dn stat err =       0.012882237731
      target stat err =       0.008567639339
              std dev =       0.734541798565
             le_variance =       0.539551653840


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.678507849364        initial  <--
     1.0000e+55     1.0000e+56             6.2476e-60        -0.678507849364
     4.0000e+55     4.0000e+56             1.3868e-60        -0.678507849364
     1.6000e+56     1.6000e+57             3.4670e-61        -0.678507849364

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.7899
  </log>
  <optVariables href="FORM.s056.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2380e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.3851
    reference variance = 0.354155
====================================================
  Execution time = 4.4865e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9997e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5174e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499912116003
                                         uncertainty =       0.004108863269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499912116003
                                         uncertainty =       0.004108863269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499983567
  error estimate for blocks of size 2^( 2) =       0.000526241215
  error estimate for blocks of size 2^( 3) =       0.000550203337
  error estimate for blocks of size 2^( 4) =       0.000570436555
  error estimate for blocks of size 2^( 5) =       0.000583277443
  error estimate for blocks of size 2^( 6) =       0.000591847221
  error estimate for blocks of size 2^( 7) =       0.000593830955

      target function =      -0.707012699407
              le_mean =     -22.425828062648
             les_mean =     503.417731179113
             stat err =       0.000584848043
             autocorr =       1.368278876278
   target nu stat err =       0.000584848043
   target dn stat err =       0.004398931077
      target stat err =       0.003219041073
              std dev =       0.707083540794
             le_variance =       0.499967133662


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242582806265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+56, overlap shift 1.0000e+57 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707026411689       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707026411689       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+56, overlap shift 4.0000e+57 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707026411689       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707026411689       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+57, overlap shift 1.6000e+58 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707026411689       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707026411689       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+57 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.311543 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0046e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.3897
    reference variance = 0.397297
====================================================
  Execution time = 4.6697e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2425e+01
  VMC Evar = 4.9945e-01
  Total weights = 2.0000e+06
  Execution time = 3.8303e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499421097255
                                         uncertainty =       0.003832411629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499421097255
                                         uncertainty =       0.003832411629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499727264
  error estimate for blocks of size 2^( 2) =       0.000526159958
  error estimate for blocks of size 2^( 3) =       0.000551052631
  error estimate for blocks of size 2^( 4) =       0.000569739069
  error estimate for blocks of size 2^( 5) =       0.000581566618
  error estimate for blocks of size 2^( 6) =       0.000587227933
  error estimate for blocks of size 2^( 7) =       0.000591305857

      target function =      -0.707405587392
              le_mean =     -22.424537335463
             les_mean =     503.359329135687
             stat err =       0.000582459869
             autocorr =       1.358519665103
   target nu stat err =       0.000582459869
   target dn stat err =       0.003793568247
      target stat err =       0.002789662254
              std dev =       0.706721073566
             le_variance =       0.499454675822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499421097255
                                         uncertainty =       0.003832411629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499421097255
                                         uncertainty =       0.003832411629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499727264
  error estimate for blocks of size 2^( 2) =       0.000526159958
  error estimate for blocks of size 2^( 3) =       0.000551052631
  error estimate for blocks of size 2^( 4) =       0.000569739069
  error estimate for blocks of size 2^( 5) =       0.000581566618
  error estimate for blocks of size 2^( 6) =       0.000587227933
  error estimate for blocks of size 2^( 7) =       0.000591305857

      target function =      -0.707405587392
              le_mean =     -22.424537335463
             les_mean =     503.359329135687
             stat err =       0.000582459869
             autocorr =       1.358519665103
   target nu stat err =       0.000582459869
   target dn stat err =       0.003793568247
      target stat err =       0.002789662254
              std dev =       0.706721073566
             le_variance =       0.499454675822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499421097255
                                         uncertainty =       0.003832411629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499421097255
                                         uncertainty =       0.003832411629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499727264
  error estimate for blocks of size 2^( 2) =       0.000526159958
  error estimate for blocks of size 2^( 3) =       0.000551052631
  error estimate for blocks of size 2^( 4) =       0.000569739069
  error estimate for blocks of size 2^( 5) =       0.000581566618
  error estimate for blocks of size 2^( 6) =       0.000587227933
  error estimate for blocks of size 2^( 7) =       0.000591305857

      target function =      -0.707405587392
              le_mean =     -22.424537335463
             les_mean =     503.359329135687
             stat err =       0.000582459869
             autocorr =       1.358519665103
   target nu stat err =       0.000582459869
   target dn stat err =       0.003793568247
      target stat err =       0.002789662254
              std dev =       0.706721073566
             le_variance =       0.499454675822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499421097255
                                         uncertainty =       0.003832411629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499421097255
                                         uncertainty =       0.003832411629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499727264
  error estimate for blocks of size 2^( 2) =       0.000526159958
  error estimate for blocks of size 2^( 3) =       0.000551052631
  error estimate for blocks of size 2^( 4) =       0.000569739069
  error estimate for blocks of size 2^( 5) =       0.000581566618
  error estimate for blocks of size 2^( 6) =       0.000587227933
  error estimate for blocks of size 2^( 7) =       0.000591305857

      target function =      -0.707405587392
              le_mean =     -22.424537335463
             les_mean =     503.359329135687
             stat err =       0.000582459869
             autocorr =       1.358519665103
   target nu stat err =       0.000582459869
   target dn stat err =       0.003793568247
      target stat err =       0.002789662254
              std dev =       0.706721073566
             le_variance =       0.499454675822


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707405587392        initial  <--
     1.0000e+56     1.0000e+57             0.0000e+00        -0.707405587392
     4.0000e+56     4.0000e+57             0.0000e+00        -0.707405587392
     1.6000e+57     1.6000e+58             0.0000e+00        -0.707405587392

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.8993
  </log>
  <optVariables href="FORM.s057.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2595e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2433e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.4906
    reference variance = 1.20903
====================================================
  Execution time = 4.7259e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0114e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5294e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501101049857
                                         uncertainty =       0.004882290549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501101049857
                                         uncertainty =       0.004882290549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500568128
  error estimate for blocks of size 2^( 2) =       0.000527234903
  error estimate for blocks of size 2^( 3) =       0.000552146802
  error estimate for blocks of size 2^( 4) =       0.000570715661
  error estimate for blocks of size 2^( 5) =       0.000581689880
  error estimate for blocks of size 2^( 6) =       0.000587958992
  error estimate for blocks of size 2^( 7) =       0.000591136010

      target function =      -0.706163198627
              le_mean =     -22.426073776180
             les_mean =     503.429921665783
             stat err =       0.000582875136
             autocorr =       1.355890665725
   target nu stat err =       0.000582875136
   target dn stat err =       0.005078502466
      target stat err =       0.003692689348
              std dev =       0.707910235626
             le_variance =       0.501136901704


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242607377618e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+57, overlap shift 1.0000e+58 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706181516200       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706181516200       residual = 5.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706181516200       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706181516200       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706181516197       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.706180052049       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 3.36e+14           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+57 is 1.670569e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+57, overlap shift 4.0000e+58 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706181516200       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706181516200       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+58, overlap shift 1.6000e+59 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706181516200       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706181516200       residual = 5.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706181516200       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706181516200       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706181516197       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.706180052049       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 3.36e+14           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+58 is 1.044105e-62

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.313740 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2560e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.4042
    reference variance = 0.350129
====================================================
  Execution time = 4.4680e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.1265e-01
  Total weights = 2.0000e+06
  Execution time = 3.8264e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512673848727
                                         uncertainty =       0.008988226077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512673848727
                                         uncertainty =       0.008988226077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506286934
  error estimate for blocks of size 2^( 2) =       0.000532201689
  error estimate for blocks of size 2^( 3) =       0.000556416533
  error estimate for blocks of size 2^( 4) =       0.000575909182
  error estimate for blocks of size 2^( 5) =       0.000586993452
  error estimate for blocks of size 2^( 6) =       0.000597594296
  error estimate for blocks of size 2^( 7) =       0.000602169352

      target function =      -0.697950484275
              le_mean =     -22.426265039559
             les_mean =     503.450016287533
             stat err =       0.000590666571
             autocorr =       1.361104110095
   target nu stat err =       0.000590666571
   target dn stat err =       0.008947540037
      target stat err =       0.006303255154
              std dev =       0.715997848689
             le_variance =       0.512652919327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512673848727
                                         uncertainty =       0.008988226077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512673848727
                                         uncertainty =       0.008988226077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506286934
  error estimate for blocks of size 2^( 2) =       0.000532201689
  error estimate for blocks of size 2^( 3) =       0.000556416533
  error estimate for blocks of size 2^( 4) =       0.000575909182
  error estimate for blocks of size 2^( 5) =       0.000586993452
  error estimate for blocks of size 2^( 6) =       0.000597594296
  error estimate for blocks of size 2^( 7) =       0.000602169352

      target function =      -0.697950484275
              le_mean =     -22.426265039559
             les_mean =     503.450016287533
             stat err =       0.000590666571
             autocorr =       1.361104110090
   target nu stat err =       0.000590666571
   target dn stat err =       0.008947540037
      target stat err =       0.006303255154
              std dev =       0.715997848689
             le_variance =       0.512652919327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512673848727
                                         uncertainty =       0.008988226077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512673848727
                                         uncertainty =       0.008988226077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506286934
  error estimate for blocks of size 2^( 2) =       0.000532201689
  error estimate for blocks of size 2^( 3) =       0.000556416533
  error estimate for blocks of size 2^( 4) =       0.000575909182
  error estimate for blocks of size 2^( 5) =       0.000586993452
  error estimate for blocks of size 2^( 6) =       0.000597594296
  error estimate for blocks of size 2^( 7) =       0.000602169352

      target function =      -0.697950484275
              le_mean =     -22.426265039559
             les_mean =     503.450016287533
             stat err =       0.000590666571
             autocorr =       1.361104110090
   target nu stat err =       0.000590666571
   target dn stat err =       0.008947540037
      target stat err =       0.006303255154
              std dev =       0.715997848689
             le_variance =       0.512652919327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512673848727
                                         uncertainty =       0.008988226077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512673848727
                                         uncertainty =       0.008988226077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506286934
  error estimate for blocks of size 2^( 2) =       0.000532201689
  error estimate for blocks of size 2^( 3) =       0.000556416533
  error estimate for blocks of size 2^( 4) =       0.000575909182
  error estimate for blocks of size 2^( 5) =       0.000586993452
  error estimate for blocks of size 2^( 6) =       0.000597594296
  error estimate for blocks of size 2^( 7) =       0.000602169352

      target function =      -0.697950484275
              le_mean =     -22.426265039559
             les_mean =     503.450016287533
             stat err =       0.000590666571
             autocorr =       1.361104110090
   target nu stat err =       0.000590666571
   target dn stat err =       0.008947540037
      target stat err =       0.006303255154
              std dev =       0.715997848689
             le_variance =       0.512652919327


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.697950484275        initial  <--
     1.0000e+57     1.0000e+58             1.6706e-61        -0.697950484275
     4.0000e+57     4.0000e+58             0.0000e+00        -0.697950484275
     1.6000e+58     1.6000e+59             1.0441e-62        -0.697950484275

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8534
  </log>
  <optVariables href="FORM.s058.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2642e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2433e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.3798
    reference variance = 0.514529
====================================================
  Execution time = 4.5194e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0031e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5015e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500152678967
                                         uncertainty =       0.003785554767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500152678967
                                         uncertainty =       0.003785554767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500154299
  error estimate for blocks of size 2^( 2) =       0.000525907429
  error estimate for blocks of size 2^( 3) =       0.000550914442
  error estimate for blocks of size 2^( 4) =       0.000570414478
  error estimate for blocks of size 2^( 5) =       0.000583270984
  error estimate for blocks of size 2^( 6) =       0.000589552643
  error estimate for blocks of size 2^( 7) =       0.000594878908

      target function =      -0.706765193114
              le_mean =     -22.426050963135
             les_mean =     503.428070196806
             stat err =       0.000584529253
             autocorr =       1.365854659715
   target nu stat err =       0.000584529253
   target dn stat err =       0.004082830584
      target stat err =       0.002994752326
              std dev =       0.707324993077
             le_variance =       0.500308645832


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242605096313e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+58, overlap shift 1.0000e+59 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706776888407       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706776888407       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 2.55e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.55e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+58 is 3.555263e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+58, overlap shift 4.0000e+59 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706776888407       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706776888407       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706776888407       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+58 is 1.497424e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+59, overlap shift 1.6000e+60 and omega -2.3121e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706776888407       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706776888407       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706776888407       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.55e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 2.79e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+59 is 3.743560e-64

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.315387 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0216e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.3922
    reference variance = 0.38
====================================================
  Execution time = 4.4735e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9494e-01
  Total weights = 2.0000e+06
  Execution time = 3.8084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494927706939
                                         uncertainty =       0.003526939404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494927706939
                                         uncertainty =       0.003526939404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497462964
  error estimate for blocks of size 2^( 2) =       0.000523439323
  error estimate for blocks of size 2^( 3) =       0.000548138312
  error estimate for blocks of size 2^( 4) =       0.000567258725
  error estimate for blocks of size 2^( 5) =       0.000579437366
  error estimate for blocks of size 2^( 6) =       0.000585549441
  error estimate for blocks of size 2^( 7) =       0.000589239487

      target function =      -0.710654462586
              le_mean =     -22.425570965790
             les_mean =     503.401171695927
             stat err =       0.000580371255
             autocorr =       1.361100775745
   target nu stat err =       0.000580371255
   target dn stat err =       0.003786639791
      target stat err =       0.002813581200
              std dev =       0.703518870887
             le_variance =       0.494938801694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494927706939
                                         uncertainty =       0.003526939404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494927706939
                                         uncertainty =       0.003526939404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497462964
  error estimate for blocks of size 2^( 2) =       0.000523439323
  error estimate for blocks of size 2^( 3) =       0.000548138312
  error estimate for blocks of size 2^( 4) =       0.000567258725
  error estimate for blocks of size 2^( 5) =       0.000579437366
  error estimate for blocks of size 2^( 6) =       0.000585549441
  error estimate for blocks of size 2^( 7) =       0.000589239487

      target function =      -0.710654462586
              le_mean =     -22.425570965790
             les_mean =     503.401171695927
             stat err =       0.000580371255
             autocorr =       1.361100775745
   target nu stat err =       0.000580371255
   target dn stat err =       0.003786639791
      target stat err =       0.002813581200
              std dev =       0.703518870887
             le_variance =       0.494938801694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494927706939
                                         uncertainty =       0.003526939404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494927706939
                                         uncertainty =       0.003526939404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497462964
  error estimate for blocks of size 2^( 2) =       0.000523439323
  error estimate for blocks of size 2^( 3) =       0.000548138312
  error estimate for blocks of size 2^( 4) =       0.000567258725
  error estimate for blocks of size 2^( 5) =       0.000579437366
  error estimate for blocks of size 2^( 6) =       0.000585549441
  error estimate for blocks of size 2^( 7) =       0.000589239487

      target function =      -0.710654462586
              le_mean =     -22.425570965790
             les_mean =     503.401171695927
             stat err =       0.000580371255
             autocorr =       1.361100775745
   target nu stat err =       0.000580371255
   target dn stat err =       0.003786639791
      target stat err =       0.002813581200
              std dev =       0.703518870887
             le_variance =       0.494938801694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494927706939
                                         uncertainty =       0.003526939404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494927706939
                                         uncertainty =       0.003526939404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497462964
  error estimate for blocks of size 2^( 2) =       0.000523439323
  error estimate for blocks of size 2^( 3) =       0.000548138312
  error estimate for blocks of size 2^( 4) =       0.000567258725
  error estimate for blocks of size 2^( 5) =       0.000579437366
  error estimate for blocks of size 2^( 6) =       0.000585549441
  error estimate for blocks of size 2^( 7) =       0.000589239487

      target function =      -0.710654462586
              le_mean =     -22.425570965790
             les_mean =     503.401171695927
             stat err =       0.000580371255
             autocorr =       1.361100775745
   target nu stat err =       0.000580371255
   target dn stat err =       0.003786639791
      target stat err =       0.002813581200
              std dev =       0.703518870887
             le_variance =       0.494938801694


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.710654462586        initial  <--
     1.0000e+58     1.0000e+59             3.5553e-63        -0.710654462586
     4.0000e+58     4.0000e+59             1.4974e-63        -0.710654462586
     1.6000e+59     1.6000e+60             3.7436e-64        -0.710654462586

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8271
  </log>
  <optVariables href="FORM.s059.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920283e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856224e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969112e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172786e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524321e-02 1 1  ON 42
eH1_3                -2.543347e-02 1 1  ON 43
eH1_4                 3.820769e-03 1 1  ON 44
eH1_5                 1.895374e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873053e-03 1 1  ON 54
eH2_5                 8.664227e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2405e+02 secs
  Total Execution time = 7.5368e+03 secs

=========================================================
  A new xml input file : FORM.s059.cont.xml
