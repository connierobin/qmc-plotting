--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0251.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 77547 MB
Rank =    1  Free Memory = 77545 MB
Rank =    2  Free Memory = 77545 MB
Rank =    3  Free Memory = 77544 MB
Rank =    4  Free Memory = 77544 MB
Rank =    5  Free Memory = 77544 MB
Rank =    6  Free Memory = 77544 MB
Rank =    7  Free Memory = 77544 MB
Rank =    8  Free Memory = 77544 MB
Rank =    9  Free Memory = 77544 MB
Rank =   10  Free Memory = 77544 MB
Rank =   11  Free Memory = 77543 MB
Rank =   12  Free Memory = 77543 MB
Rank =   13  Free Memory = 77543 MB
Rank =   14  Free Memory = 77543 MB
Rank =   15  Free Memory = 77543 MB
Rank =   16  Free Memory = 77543 MB
Rank =   17  Free Memory = 77543 MB
Rank =   18  Free Memory = 77543 MB
Rank =   19  Free Memory = 77543 MB
Rank =   20  Free Memory = 77543 MB
Rank =   21  Free Memory = 77543 MB
Rank =   22  Free Memory = 77543 MB
Rank =   23  Free Memory = 77543 MB
Rank =   24  Free Memory = 77543 MB
Rank =   25  Free Memory = 77543 MB
Rank =   26  Free Memory = 77542 MB
Rank =   27  Free Memory = 77542 MB
Rank =   28  Free Memory = 77542 MB
Rank =   29  Free Memory = 77542 MB
Rank =   30  Free Memory = 77542 MB
Rank =   31  Free Memory = 77542 MB
Rank =   32  Free Memory = 77542 MB
Rank =   33  Free Memory = 77542 MB
Rank =   34  Free Memory = 77542 MB
Rank =   35  Free Memory = 77542 MB
Rank =   36  Free Memory = 77542 MB
Rank =   37  Free Memory = 77542 MB
Rank =   38  Free Memory = 77542 MB
Rank =   39  Free Memory = 77542 MB
Rank =   40  Free Memory = 79678 MB
Rank =   41  Free Memory = 79678 MB
Rank =   42  Free Memory = 79678 MB
Rank =   43  Free Memory = 79678 MB
Rank =   44  Free Memory = 79678 MB
Rank =   45  Free Memory = 79678 MB
Rank =   46  Free Memory = 79678 MB
Rank =   47  Free Memory = 79678 MB
Rank =   48  Free Memory = 79678 MB
Rank =   49  Free Memory = 79678 MB
Rank =   50  Free Memory = 79678 MB
Rank =   51  Free Memory = 79678 MB
Rank =   52  Free Memory = 79678 MB
Rank =   53  Free Memory = 79678 MB
Rank =   54  Free Memory = 79678 MB
Rank =   55  Free Memory = 79678 MB
Rank =   56  Free Memory = 79678 MB
Rank =   57  Free Memory = 79678 MB
Rank =   58  Free Memory = 79678 MB
Rank =   59  Free Memory = 79678 MB
Rank =   60  Free Memory = 79678 MB
Rank =   61  Free Memory = 79678 MB
Rank =   62  Free Memory = 79678 MB
Rank =   63  Free Memory = 79678 MB
Rank =   64  Free Memory = 79678 MB
Rank =   65  Free Memory = 79678 MB
Rank =   66  Free Memory = 79678 MB
Rank =   67  Free Memory = 79678 MB
Rank =   68  Free Memory = 79678 MB
Rank =   69  Free Memory = 79678 MB
Rank =   70  Free Memory = 79678 MB
Rank =   71  Free Memory = 79678 MB
Rank =   72  Free Memory = 79678 MB
Rank =   73  Free Memory = 79678 MB
Rank =   74  Free Memory = 79678 MB
Rank =   75  Free Memory = 79678 MB
Rank =   76  Free Memory = 79678 MB
Rank =   77  Free Memory = 79678 MB
Rank =   78  Free Memory = 79678 MB
Rank =   79  Free Memory = 79678 MB
Rank =   80  Free Memory = 84898 MB
Rank =   81  Free Memory = 84898 MB
Rank =   82  Free Memory = 84898 MB
Rank =   83  Free Memory = 84898 MB
Rank =   84  Free Memory = 84898 MB
Rank =   85  Free Memory = 84898 MB
Rank =   86  Free Memory = 84898 MB
Rank =   87  Free Memory = 84898 MB
Rank =   88  Free Memory = 84898 MB
Rank =   89  Free Memory = 84898 MB
Rank =   90  Free Memory = 84898 MB
Rank =   91  Free Memory = 84898 MB
Rank =   92  Free Memory = 84898 MB
Rank =   93  Free Memory = 84898 MB
Rank =   94  Free Memory = 84898 MB
Rank =   95  Free Memory = 84898 MB
Rank =   96  Free Memory = 84898 MB
Rank =   97  Free Memory = 84898 MB
Rank =   98  Free Memory = 84898 MB
Rank =   99  Free Memory = 84898 MB
Rank =  100  Free Memory = 84898 MB
Rank =  101  Free Memory = 84898 MB
Rank =  102  Free Memory = 84898 MB
Rank =  103  Free Memory = 84898 MB
Rank =  104  Free Memory = 84898 MB
Rank =  105  Free Memory = 84898 MB
Rank =  106  Free Memory = 84898 MB
Rank =  107  Free Memory = 84898 MB
Rank =  108  Free Memory = 84898 MB
Rank =  109  Free Memory = 84898 MB
Rank =  110  Free Memory = 84898 MB
Rank =  111  Free Memory = 84898 MB
Rank =  112  Free Memory = 84898 MB
Rank =  113  Free Memory = 84898 MB
Rank =  114  Free Memory = 84898 MB
Rank =  115  Free Memory = 84898 MB
Rank =  116  Free Memory = 84898 MB
Rank =  117  Free Memory = 84898 MB
Rank =  118  Free Memory = 84898 MB
Rank =  119  Free Memory = 84898 MB
Rank =  120  Free Memory = 80483 MB
  Input file(s): opt_form_pi2pistar_tett_run002l.xml 
Rank =  121  Free Memory = 80483 MB
Rank =  122  Free Memory = 80483 MB
Rank =  127  Free Memory = 80483 MB
Rank =  123  Free Memory = 80483 MB
Rank =  124  Free Memory = 80483 MB
Rank =  125  Free Memory = 80483 MB
Rank =  126  Free Memory = 80483 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_pi2pistar_tett_run002l.xml

  Project = FORM
  date    = 2023-03-18 14:57:46 PDT
  host    = n0247.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 986

  Range of prime numbers to use as seeds over processors and threads = 7817-8971


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.552564e-01    1         1  ON     0
     uu_1                 9.297146e-02    1         1  ON     1
     uu_2                -7.920286e-03    1         1  ON     2
     uu_3                -6.923399e-02    1         1  ON     3
     uu_4                -1.052604e-01    1         1  ON     4
     uu_5                -1.267169e-01    1         1  ON     5
     uu_6                -1.374582e-01    1         1  ON     6
     uu_7                -1.336277e-01    1         1  ON     7
     uu_8                -1.132616e-01    1         1  ON     8
     uu_9                -6.856223e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.731544e-01    1         1  ON     0
     ud_1                 1.324656e-01    1         1  ON     1
     ud_2                 1.338636e-02    1         1  ON     2
     ud_3                -4.969111e-02    1         1  ON     3
     ud_4                -8.583432e-02    1         1  ON     4
     ud_5                -1.074506e-01    1         1  ON     5
     ud_6                -1.175900e-01    1         1  ON     6
     ud_7                -1.128472e-01    1         1  ON     7
     ud_8                -9.300090e-02    1         1  ON     8
     ud_9                -5.426882e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -4.979348e-01    1         1  ON     0
     eC_1                -3.532771e-01    1         1  ON     1
     eC_2                -1.036266e-01    1         1  ON     2
     eC_3                 6.840189e-02    1         1  ON     3
     eC_4                 1.507106e-01    1         1  ON     4
     eC_5                 2.326891e-01    1         1  ON     5
     eC_6                 2.311927e-01    1         1  ON     6
     eC_7                 1.913392e-01    1         1  ON     7
     eC_8                 7.350101e-02    1         1  ON     8
     eC_9                 5.800106e-03    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -8.991038e-01    1         1  ON     0
     eO_1                -5.913999e-01    1         1  ON     1
     eO_2                -1.810805e-01    1         1  ON     2
     eO_3                 8.172785e-02    1         1  ON     3
     eO_4                 2.361583e-01    1         1  ON     4
     eO_5                 3.379148e-01    1         1  ON     5
     eO_6                 3.342742e-01    1         1  ON     6
     eO_7                 2.985276e-01    1         1  ON     7
     eO_8                 2.076720e-01    1         1  ON     8
     eO_9                 1.093498e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.333662e-01    1         1  ON     0
     eH1_1                -3.149677e-02    1         1  ON     1
     eH1_2                -1.524322e-02    1         1  ON     2
     eH1_3                -2.543346e-02    1         1  ON     3
     eH1_4                 3.820773e-03    1         1  ON     4
     eH1_5                 1.895373e-02    1         1  ON     5
     eH1_6                 3.983370e-02    1         1  ON     6
     eH1_7                 4.319402e-02    1         1  ON     7
     eH1_8                 3.913136e-02    1         1  ON     8
     eH1_9                 4.724031e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.451078e-01    1         1  ON     0
     eH2_1                -4.404086e-02    1         1  ON     1
     eH2_2                -2.577917e-02    1         1  ON     2
     eH2_3                -3.487602e-02    1         1  ON     3
     eH2_4                -6.873062e-03    1         1  ON     4
     eH2_5                 8.664230e-03    1         1  ON     5
     eH2_6                 3.559350e-02    1         1  ON     6
     eH2_7                 4.803406e-02    1         1  ON     7
     eH2_8                 6.894747e-02    1         1  ON     8
     eH2_9                 6.265784e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 140 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.016718e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 28 unique up determinants.
Found 28 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 9.9484e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  4.0107225728e-02 -5.0659535091e-01 -4.8356690577e-01
    u -2.0203417087e-01 -1.2691590666e+00 -2.1169263951e+00
    u  2.9913287695e-01 -2.3710879234e-01  2.0101719070e+00
    u  4.8474243406e-02 -5.3051852953e-01  9.5378285444e-01
    u -5.5511775119e-01 -9.8683271286e-02  1.4043240644e+00
    u  6.9646297924e-01  2.5004217823e+00 -2.4744046405e+00
    d -1.1004432466e+00 -7.1118992563e-01 -1.4300801983e+00
    d -3.6824818327e-02  7.5687344105e-01 -1.6708867165e+00
    d -9.4375526199e-01  1.5348935511e-01  1.1974289766e+00
    d -8.9321447322e-02 -6.9596903295e-02  1.4810785623e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0247.savio3:235980] 127 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0247.savio3:235980] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.3575
    reference variance = 0.43465
====================================================
  Execution time = 4.9771e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9434e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5047e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494359387585
                                         uncertainty =       0.003257657613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494359387585
                                         uncertainty =       0.003257657613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497163706
  error estimate for blocks of size 2^( 2) =       0.000523575680
  error estimate for blocks of size 2^( 3) =       0.000549681628
  error estimate for blocks of size 2^( 4) =       0.000569062026
  error estimate for blocks of size 2^( 5) =       0.000581589198
  error estimate for blocks of size 2^( 6) =       0.000589021427
  error estimate for blocks of size 2^( 7) =       0.000591963306

      target function =      -0.711058599866
              le_mean =     -22.427370966747
             les_mean =     503.481311733159
             stat err =       0.000582908989
             autocorr =       1.374683351454
   target nu stat err =       0.000582908989
   target dn stat err =       0.003665622326
      target stat err =       0.002740065546
              std dev =       0.703095655129
             le_variance =       0.494343500261


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.242737096675e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711068190566       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711082240855       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711087933411       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711089729830       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711090976707       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711091822743       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711093502578       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711094289208       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711095101354       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711096271142       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.711097020002       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.711097727332       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.711098666568       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.711099379260       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.711100152873       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.711101585361       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.711101816960       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.711102408740       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.711102664730       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.711102960285       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.711103050345       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.711103243300       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.711103259406       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.711103378783       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.711103488096       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.711103600753       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.711103630894       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.711103617161       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.711103661634       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.711103705309       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.711103688665       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.711103739012       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.711103735859       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 1.788017e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711068190566       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711072186046       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711073796756       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711074312280       residual = 7.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711074781671       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711074921430       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711075430599       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711075625730       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711075876387       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711076155159       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.711076317713       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.711076534743       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.711076657822       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.711076928809       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.711077215198       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.711077576071       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.711077614037       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.711077761344       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.711077814375       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.711077875598       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.711077890015       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.711077933730       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.711077937256       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.711077963928       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.711077985441       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.711078009947       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.711078016887       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.711078013410       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.711078023004       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.711078031498       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.711078027212       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.711078038212       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 4.454652e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711068190566       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711069224988       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711069641604       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711069775488       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711069903304       residual = 8.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711069940592       residual = 7.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711070066458       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711070107918       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711070201321       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711070255707       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.711070312865       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.711070341765       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.711070386210       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.711070449194       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.711070523034       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.711070612744       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.711070620732       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.711070657527       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.711070669849       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.711070684302       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.711070687351       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.711070697990       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.711070698866       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.711070705318       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.711070710314       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.711070716205       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.711070717905       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.711070717028       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.711070719317       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.711070721290       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.711070720226       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.711070722841       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 1.112690e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.266816 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5092e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
uu_0  2.554726e-01                 1 1 ON  0
uu_1  9.315102e-02                 1 1 ON  1
uu_2  -7.773014e-03                1 1 ON  2
uu_3  -6.914377e-02                1 1 ON  3
uu_4  -1.051951e-01                1 1 ON  4
uu_5  -1.266915e-01                1 1 ON  5
uu_6  -1.374519e-01                1 1 ON  6
uu_7  -1.337626e-01                1 1 ON  7
uu_8  -1.134600e-01                1 1 ON  8
uu_9  -6.884041e-02                1 1 ON  9
ud_0  3.731919e-01                 1 1 ON  10
ud_1  1.324679e-01                 1 1 ON  11
ud_2  1.334100e-02                 1 1 ON  12
ud_3  -4.978334e-02                1 1 ON  13
ud_4  -8.588614e-02                1 1 ON  14
ud_5  -1.074538e-01                1 1 ON  15
ud_6  -1.175529e-01                1 1 ON  16
ud_7  -1.129203e-01                1 1 ON  17
ud_8  -9.301676e-02                1 1 ON  18
ud_9  -5.420335e-02                1 1 ON  19
eC_0  -4.983364e-01                1 1 ON  20
eC_1  -3.535582e-01                1 1 ON  21
eC_2  -1.037671e-01                1 1 ON  22
eC_3  6.833677e-02                 1 1 ON  23
eC_4  1.505268e-01                 1 1 ON  24
eC_5  2.327095e-01                 1 1 ON  25
eC_6  2.314285e-01                 1 1 ON  26
eC_7  1.917847e-01                 1 1 ON  27
eC_8  7.383094e-02                 1 1 ON  28
eC_9  5.841266e-03                 1 1 ON  29
eO_0  -8.995114e-01                1 1 ON  30
eO_1  -5.917189e-01                1 1 ON  31
eO_2  -1.813983e-01                1 1 ON  32
eO_3  8.163695e-02                 1 1 ON  33
eO_4  2.361550e-01                 1 1 ON  34
eO_5  3.378809e-01                 1 1 ON  35
eO_6  3.345449e-01                 1 1 ON  36
eO_7  2.988902e-01                 1 1 ON  37
eO_8  2.079563e-01                 1 1 ON  38
eO_9  1.094808e-01                 1 1 ON  39
eH1_0 -1.334836e-01                1 1 ON  40
eH1_1 -3.168378e-02                1 1 ON  41
eH1_2 -1.536788e-02                1 1 ON  42
eH1_3 -2.557600e-02                1 1 ON  43
eH1_4 3.653937e-03                 1 1 ON  44
eH1_5 1.885648e-02                 1 1 ON  45
eH1_6 3.985943e-02                 1 1 ON  46
eH1_7 4.334744e-02                 1 1 ON  47
eH1_8 3.950633e-02                 1 1 ON  48
eH1_9 4.743273e-02                 1 1 ON  49
eH2_0 -1.452419e-01                1 1 ON  50
eH2_1 -4.420010e-02                1 1 ON  51
eH2_2 -2.586988e-02                1 1 ON  52
eH2_3 -3.491497e-02                1 1 ON  53
eH2_4 -6.913121e-03                1 1 ON  54
eH2_5 8.686168e-03                 1 1 ON  55
eH2_6 3.560285e-02                 1 1 ON  56
eH2_7 4.795894e-02                 1 1 ON  57
eH2_8 6.908225e-02                 1 1 ON  58
eH2_9 6.286083e-02                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.4906
    reference variance = 0.396061
====================================================
  Execution time = 4.7572e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.1798e-01
  Total weights = 2.0000e+06
  Execution time = 3.8305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517583285772
                                         uncertainty =       0.023013354148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517583285772
                                         uncertainty =       0.023013354148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508879405
  error estimate for blocks of size 2^( 2) =       0.000535052255
  error estimate for blocks of size 2^( 3) =       0.000560282235
  error estimate for blocks of size 2^( 4) =       0.000579883448
  error estimate for blocks of size 2^( 5) =       0.000593200872
  error estimate for blocks of size 2^( 6) =       0.000598384837
  error estimate for blocks of size 2^( 7) =       0.000600880710

      target function =      -0.693903425999
              le_mean =     -22.427262185866
             les_mean =     503.500005391740
             stat err =       0.000593087467
             autocorr =       1.358337667626
   target nu stat err =       0.000593087467
   target dn stat err =       0.023424317190
      target stat err =       0.016290017331
              std dev =       0.719664155775
             le_variance =       0.517916497108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517809942101
                                         uncertainty =       0.023043017111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517809942101
                                         uncertainty =       0.023043017111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508990992
  error estimate for blocks of size 2^( 2) =       0.000535123573
  error estimate for blocks of size 2^( 3) =       0.000560308917
  error estimate for blocks of size 2^( 4) =       0.000579878701
  error estimate for blocks of size 2^( 5) =       0.000593182519
  error estimate for blocks of size 2^( 6) =       0.000598355663
  error estimate for blocks of size 2^( 7) =       0.000600849444

      target function =      -0.693744776280
              le_mean =     -22.427262526500
             les_mean =     503.500247832367
             stat err =       0.000593066582
             autocorr =       1.357646530355
   target nu stat err =       0.000593066582
   target dn stat err =       0.023454354553
      target stat err =       0.016303451983
              std dev =       0.719821963312
             le_variance =       0.518143658866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517708474449
                                         uncertainty =       0.023029926972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517708474449
                                         uncertainty =       0.023029926972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508941045
  error estimate for blocks of size 2^( 2) =       0.000535091137
  error estimate for blocks of size 2^( 3) =       0.000560296083
  error estimate for blocks of size 2^( 4) =       0.000579879833
  error estimate for blocks of size 2^( 5) =       0.000593189924
  error estimate for blocks of size 2^( 6) =       0.000598368123
  error estimate for blocks of size 2^( 7) =       0.000600862987

      target function =      -0.693815798756
              le_mean =     -22.427261812398
             les_mean =     503.500114118217
             stat err =       0.000593075217
             autocorr =       1.357952556873
   target nu stat err =       0.000593075217
   target dn stat err =       0.023441095929
      target stat err =       0.016297557394
              std dev =       0.719751328863
             le_variance =       0.518041975400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517599183022
                                         uncertainty =       0.023015489541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517599183022
                                         uncertainty =       0.023015489541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508887233
  error estimate for blocks of size 2^( 2) =       0.000535057129
  error estimate for blocks of size 2^( 3) =       0.000560283869
  error estimate for blocks of size 2^( 4) =       0.000579882827
  error estimate for blocks of size 2^( 5) =       0.000593199312
  error estimate for blocks of size 2^( 6) =       0.000598382541
  error estimate for blocks of size 2^( 7) =       0.000600878288

      target function =      -0.693892298326
              le_mean =     -22.427262072194
             les_mean =     503.500016227832
             stat err =       0.000593085742
             autocorr =       1.358287976190
   target nu stat err =       0.000593085742
   target dn stat err =       0.023426479012
      target stat err =       0.016290995196
              std dev =       0.719675226687
             le_variance =       0.517932431906


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.693903425999        initial  <--
     2.5000e-01     2.5000e+00             1.7880e-03        -0.693744776280
     1.0000e+00     1.0000e+01             4.4547e-04        -0.693815798756
     4.0000e+00     4.0000e+01             1.1127e-04        -0.693892298326

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.7993
  </log>
  <optVariables href="FORM.s000.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3200e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2424e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.3489
    reference variance = 0.314732
====================================================
  Execution time = 4.5706e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9930e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5480e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499329327587
                                         uncertainty =       0.010889406310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499329327587
                                         uncertainty =       0.010889406310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499649292
  error estimate for blocks of size 2^( 2) =       0.000525918345
  error estimate for blocks of size 2^( 3) =       0.000551530444
  error estimate for blocks of size 2^( 4) =       0.000571380863
  error estimate for blocks of size 2^( 5) =       0.000583812236
  error estimate for blocks of size 2^( 6) =       0.000590632209
  error estimate for blocks of size 2^( 7) =       0.000594740338

      target function =      -0.707365896849
              le_mean =     -22.428219369727
             les_mean =     503.524322675940
             stat err =       0.000585141412
             autocorr =       1.371485177513
   target nu stat err =       0.000585141412
   target dn stat err =       0.010923541942
      target stat err =       0.007919150139
              std dev =       0.706610804480
             le_variance =       0.499298829007


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242821936973e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707454346837       residual = 7.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707462847266       residual = 4.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707470074107       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707472930205       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707475391735       residual = 6.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707476083086       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707477253432       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707477517107       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707477875519       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707478234869       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707478448880       residual = 9.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.707478934809       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.707479121358       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.707479438700       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.707479571390       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.707479599001       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.707479732391       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.707479786844       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.707479831255       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.707479856947       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.707479947791       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.707479998734       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.707480012735       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.707480037112       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.707480043791       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.707480070919       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.707480096330       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.707480094878       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.707480099502       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.707480105783       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.707480101566       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.707480098029       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 2.070559e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707454346837       residual = 7.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707456505101       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707458338972       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707459061558       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707459683807       residual = 6.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707459859188       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707460154946       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707460221496       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707460311171       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707460401000       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707460455679       residual = 9.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.707460578373       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.707460624324       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.707460705145       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.707460737605       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.707460744476       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.707460778104       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.707460791182       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.707460802343       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.707460808427       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.707460831171       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.707460843706       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.707460847248       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.707460853323       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.707460854960       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.707460861698       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.707460867819       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.707460867418       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.707460868606       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.707460870135       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 5.208073e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707454346837       residual = 7.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707454888515       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707455348715       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707455529903       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707455685887       residual = 6.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707455729904       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707455804048       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707455820731       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707455843148       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707455865601       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707455879351       residual = 9.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.707455910118       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.707455921546       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.707455941843       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.707455949911       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.707455951628       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.707455960052       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.707455963286       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.707455966081       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.707455967580       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.707455973268       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.707455976389       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.707455977277       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.707455978795       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.707455979202       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.707455980883       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.707455982399       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.707455982297       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.707455982596       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.707455982975       residual = 9.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+01 is 1.304068e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.299637 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1225e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.552916e-01 1 1  ON 0
 uu_1                 9.301064e-02 1 1  ON 1
 uu_2                -7.886178e-03 1 1  ON 2
 uu_3                -6.921185e-02 1 1  ON 3
 uu_4                -1.052436e-01 1 1  ON 4
 uu_5                -1.267131e-01 1 1  ON 5
 uu_6                -1.374587e-01 1 1  ON 6
 uu_7                -1.336646e-01 1 1  ON 7
 uu_8                -1.133129e-01 1 1  ON 8
 uu_9                -6.860816e-02 1 1  ON 9
 ud_0                 3.731355e-01 1 1  ON 10
 ud_1                 1.324397e-01 1 1  ON 11
 ud_2                 1.335820e-02 1 1  ON 12
 ud_3                -4.971181e-02 1 1  ON 13
 ud_4                -8.584701e-02 1 1  ON 14
 ud_5                -1.074475e-01 1 1  ON 15
 ud_6                -1.175737e-01 1 1  ON 16
 ud_7                -1.128261e-01 1 1  ON 17
 ud_8                -9.297547e-02 1 1  ON 18
 ud_9                -5.425691e-02 1 1  ON 19
 eC_0                -4.979474e-01 1 1  ON 20
 eC_1                -3.533139e-01 1 1  ON 21
 eC_2                -1.036397e-01 1 1  ON 22
 eC_3                 6.839968e-02 1 1  ON 23
 eC_4                 1.507046e-01 1 1  ON 24
 eC_5                 2.326946e-01 1 1  ON 25
 eC_6                 2.311982e-01 1 1  ON 26
 eC_7                 1.913800e-01 1 1  ON 27
 eC_8                 7.352183e-02 1 1  ON 28
 eC_9                 5.799443e-03 1 1  ON 29
 eO_0                -8.991173e-01 1 1  ON 30
 eO_1                -5.914029e-01 1 1  ON 31
 eO_2                -1.810643e-01 1 1  ON 32
 eO_3                 8.169847e-02 1 1  ON 33
 eO_4                 2.361062e-01 1 1  ON 34
 eO_5                 3.378856e-01 1 1  ON 35
 eO_6                 3.342893e-01 1 1  ON 36
 eO_7                 2.985405e-01 1 1  ON 37
 eO_8                 2.077217e-01 1 1  ON 38
 eO_9                 1.093717e-01 1 1  ON 39
eH1_0                -1.333721e-01 1 1  ON 40
eH1_1                -3.148281e-02 1 1  ON 41
eH1_2                -1.525615e-02 1 1  ON 42
eH1_3                -2.545609e-02 1 1  ON 43
eH1_4                 3.807256e-03 1 1  ON 44
eH1_5                 1.892575e-02 1 1  ON 45
eH1_6                 3.981836e-02 1 1  ON 46
eH1_7                 4.324406e-02 1 1  ON 47
eH1_8                 3.915571e-02 1 1  ON 48
eH1_9                 4.724696e-02 1 1  ON 49
eH2_0                -1.451101e-01 1 1  ON 50
eH2_1                -4.408221e-02 1 1  ON 51
eH2_2                -2.580409e-02 1 1  ON 52
eH2_3                -3.484694e-02 1 1  ON 53
eH2_4                -6.849714e-03 1 1  ON 54
eH2_5                 8.688616e-03 1 1  ON 55
eH2_6                 3.558039e-02 1 1  ON 56
eH2_7                 4.803656e-02 1 1  ON 57
eH2_8                 6.893093e-02 1 1  ON 58
eH2_9                 6.267340e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.5024
    reference variance = 0.818468
====================================================
  Execution time = 4.7872e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0177e-01
  Total weights = 2.0000e+06
  Execution time = 3.8339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501728549927
                                         uncertainty =       0.007113599243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501728549927
                                         uncertainty =       0.007113599243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500880919
  error estimate for blocks of size 2^( 2) =       0.000527224022
  error estimate for blocks of size 2^( 3) =       0.000552940963
  error estimate for blocks of size 2^( 4) =       0.000573149159
  error estimate for blocks of size 2^( 5) =       0.000585490599
  error estimate for blocks of size 2^( 6) =       0.000592428544
  error estimate for blocks of size 2^( 7) =       0.000599528315

      target function =      -0.705666147578
              le_mean =     -22.427056424319
             les_mean =     503.474622998033
             stat err =       0.000587649154
             autocorr =       1.376471603918
   target nu stat err =       0.000587649154
   target dn stat err =       0.007141139422
      target stat err =       0.005163258091
              std dev =       0.708352588279
             le_variance =       0.501763389322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501752543003
                                         uncertainty =       0.007113970734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501752543003
                                         uncertainty =       0.007113970734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500892902
  error estimate for blocks of size 2^( 2) =       0.000527231959
  error estimate for blocks of size 2^( 3) =       0.000552945910
  error estimate for blocks of size 2^( 4) =       0.000573149503
  error estimate for blocks of size 2^( 5) =       0.000585486914
  error estimate for blocks of size 2^( 6) =       0.000592422237
  error estimate for blocks of size 2^( 7) =       0.000599518202

      target function =      -0.705648908440
              le_mean =     -22.427056211762
             les_mean =     503.474637473903
             stat err =       0.000587644214
             autocorr =       1.376382599542
   target nu stat err =       0.000587644214
   target dn stat err =       0.007141405309
      target stat err =       0.005163195013
              std dev =       0.708369535799
             le_variance =       0.501787399248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501740587495
                                         uncertainty =       0.007113785001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501740587495
                                         uncertainty =       0.007113785001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500886931
  error estimate for blocks of size 2^( 2) =       0.000527227973
  error estimate for blocks of size 2^( 3) =       0.000552943392
  error estimate for blocks of size 2^( 4) =       0.000573149249
  error estimate for blocks of size 2^( 5) =       0.000585488649
  error estimate for blocks of size 2^( 6) =       0.000592425260
  error estimate for blocks of size 2^( 7) =       0.000599523112

      target function =      -0.705657498897
              le_mean =     -22.427056283996
             les_mean =     503.474628750339
             stat err =       0.000587646568
             autocorr =       1.376426440680
   target nu stat err =       0.000587646568
   target dn stat err =       0.007141271941
      target stat err =       0.005163225560
              std dev =       0.708361091334
             le_variance =       0.501775435716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501730045930
                                         uncertainty =       0.007113622607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501730045930
                                         uncertainty =       0.007113622607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500881666
  error estimate for blocks of size 2^( 2) =       0.000527224509
  error estimate for blocks of size 2^( 3) =       0.000552941258
  error estimate for blocks of size 2^( 4) =       0.000573149159
  error estimate for blocks of size 2^( 5) =       0.000585490343
  error estimate for blocks of size 2^( 6) =       0.000592428121
  error estimate for blocks of size 2^( 7) =       0.000599527651

      target function =      -0.705665072807
              le_mean =     -22.427056402668
             les_mean =     503.474623524017
             stat err =       0.000587648819
             autocorr =       1.376465923872
   target nu stat err =       0.000587648819
   target dn stat err =       0.007141156107
      target stat err =       0.005163254171
              std dev =       0.708353645035
             le_variance =       0.501764886435


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.705666147578        initial  <--
     2.5000e+00     2.5000e+01             2.0706e-04        -0.705648908440
     1.0000e+01     1.0000e+02             5.2081e-05        -0.705657498897
     4.0000e+01     4.0000e+02             1.3041e-05        -0.705665072807

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.0883
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2839e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2425e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.4264
    reference variance = 0.338093
====================================================
  Execution time = 4.5917e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0711e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5337e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507236858268
                                         uncertainty =       0.008930851873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507236858268
                                         uncertainty =       0.008930851873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503542322
  error estimate for blocks of size 2^( 2) =       0.000530290917
  error estimate for blocks of size 2^( 3) =       0.000555436204
  error estimate for blocks of size 2^( 4) =       0.000575040653
  error estimate for blocks of size 2^( 5) =       0.000586553429
  error estimate for blocks of size 2^( 6) =       0.000594043473
  error estimate for blocks of size 2^( 7) =       0.000594986139

      target function =      -0.701826318660
              le_mean =     -22.427113900334
             les_mean =     503.482547385949
             stat err =       0.000587655923
             autocorr =       1.361991129314
   target nu stat err =       0.000587655923
   target dn stat err =       0.008846766589
      target stat err =       0.006313253150
              std dev =       0.712116381617
             le_variance =       0.507109740967


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242711390033e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.701882685317       residual = 8.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.701883237498       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.701883464712       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.701883655933       residual = 6.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.701883750287       residual = 7.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.701883866340       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.701883904249       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.701883951018       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.701883962436       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.701883983646       residual = 6.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.701884004686       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.701884013282       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.701884017701       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.701884026711       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.701884052371       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.701884064915       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.701884074860       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.701884086962       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.701884090596       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.701884105109       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.701884105090       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.701884106457       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.701884108517       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.701884110790       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.701884112340       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.701884112070       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.701884111003       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.701884110297       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.701884110659       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.701884111273       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.701884111287       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 2.744695e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.701882685317       residual = 8.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.701882823576       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.701882880460       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.701882928340       residual = 6.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.701882951962       residual = 7.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.701882981015       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.701882990500       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.701883002202       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.701883005057       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.701883010365       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.701883015626       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.701883017775       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.701883018880       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.701883021138       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.701883027560       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.701883030695       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.701883033181       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.701883036206       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.701883037113       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.701883040740       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.701883040735       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.701883041073       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.701883041587       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.701883042155       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.701883042541       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.701883042473       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.701883042206       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.701883042030       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.701883042121       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.701883042274       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.701883042278       residual = 9.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+02 is 6.861381e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.701882685317       residual = 8.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.701882719895       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.701882734121       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.701882746096       residual = 6.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.701882752004       residual = 7.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.701882759270       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.701882761641       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.701882764568       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.701882765281       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.701882766608       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.701882767924       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.701882768462       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.701882768737       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.701882769302       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.701882770909       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.701882771692       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.701882772314       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.701882773070       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.701882773296       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.701882774202       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.701882774202       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.701882774287       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.701882774414       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.701882774556       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.701882774653       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.701882774635       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.701882774569       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.701882774525       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.701882774548       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.701882774586       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.701882774587       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+02 is 1.715323e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.332413 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1293e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.552592e-01 1 1  ON 0
 uu_1                 9.297362e-02 1 1  ON 1
 uu_2                -7.920042e-03 1 1  ON 2
 uu_3                -6.923461e-02 1 1  ON 3
 uu_4                -1.052621e-01 1 1  ON 4
 uu_5                -1.267184e-01 1 1  ON 5
 uu_6                -1.374589e-01 1 1  ON 6
 uu_7                -1.336297e-01 1 1  ON 7
 uu_8                -1.132624e-01 1 1  ON 8
 uu_9                -6.856278e-02 1 1  ON 9
 ud_0                 3.731537e-01 1 1  ON 10
 ud_1                 1.324658e-01 1 1  ON 11
 ud_2                 1.338587e-02 1 1  ON 12
 ud_3                -4.969180e-02 1 1  ON 13
 ud_4                -8.583460e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175901e-01 1 1  ON 16
 ud_7                -1.128481e-01 1 1  ON 17
 ud_8                -9.300109e-02 1 1  ON 18
 ud_9                -5.426979e-02 1 1  ON 19
 eC_0                -4.979394e-01 1 1  ON 20
 eC_1                -3.532795e-01 1 1  ON 21
 eC_2                -1.036277e-01 1 1  ON 22
 eC_3                 6.840221e-02 1 1  ON 23
 eC_4                 1.507079e-01 1 1  ON 24
 eC_5                 2.326916e-01 1 1  ON 25
 eC_6                 2.311935e-01 1 1  ON 26
 eC_7                 1.913427e-01 1 1  ON 27
 eC_8                 7.350434e-02 1 1  ON 28
 eC_9                 5.800426e-03 1 1  ON 29
 eO_0                -8.991073e-01 1 1  ON 30
 eO_1                -5.914028e-01 1 1  ON 31
 eO_2                -1.810830e-01 1 1  ON 32
 eO_3                 8.172773e-02 1 1  ON 33
 eO_4                 2.361584e-01 1 1  ON 34
 eO_5                 3.379124e-01 1 1  ON 35
 eO_6                 3.342739e-01 1 1  ON 36
 eO_7                 2.985290e-01 1 1  ON 37
 eO_8                 2.076789e-01 1 1  ON 38
 eO_9                 1.093517e-01 1 1  ON 39
eH1_0                -1.333679e-01 1 1  ON 40
eH1_1                -3.149953e-02 1 1  ON 41
eH1_2                -1.524624e-02 1 1  ON 42
eH1_3                -2.543592e-02 1 1  ON 43
eH1_4                 3.817836e-03 1 1  ON 44
eH1_5                 1.895289e-02 1 1  ON 45
eH1_6                 3.983520e-02 1 1  ON 46
eH1_7                 4.319860e-02 1 1  ON 47
eH1_8                 3.913567e-02 1 1  ON 48
eH1_9                 4.724260e-02 1 1  ON 49
eH2_0                -1.451074e-01 1 1  ON 50
eH2_1                -4.404215e-02 1 1  ON 51
eH2_2                -2.578037e-02 1 1  ON 52
eH2_3                -3.487560e-02 1 1  ON 53
eH2_4                -6.872280e-03 1 1  ON 54
eH2_5                 8.668276e-03 1 1  ON 55
eH2_6                 3.559599e-02 1 1  ON 56
eH2_7                 4.803181e-02 1 1  ON 57
eH2_8                 6.894295e-02 1 1  ON 58
eH2_9                 6.265790e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.3009
    reference variance = 0.460349
====================================================
  Execution time = 4.7703e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.3335e-01
  Total weights = 2.0000e+06
  Execution time = 3.8462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.533394344804
                                         uncertainty =       0.032230439363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.533394344804
                                         uncertainty =       0.032230439363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000516405413
  error estimate for blocks of size 2^( 2) =       0.000542277507
  error estimate for blocks of size 2^( 3) =       0.000567545585
  error estimate for blocks of size 2^( 4) =       0.000587170693
  error estimate for blocks of size 2^( 5) =       0.000600394315
  error estimate for blocks of size 2^( 6) =       0.000607710901
  error estimate for blocks of size 2^( 7) =       0.000612050032

      target function =      -0.683038516905
              le_mean =     -22.426853226107
             les_mean =     503.497094459876
             stat err =       0.000601831485
             autocorr =       1.358214107452
   target nu stat err =       0.000601831485
   target dn stat err =       0.032526249815
      target stat err =       0.021907913122
              std dev =       0.730307538769
             le_variance =       0.533349101183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.533401072327
                                         uncertainty =       0.032231891137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.533401072327
                                         uncertainty =       0.032231891137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000516408670
  error estimate for blocks of size 2^( 2) =       0.000542280251
  error estimate for blocks of size 2^( 3) =       0.000567547629
  error estimate for blocks of size 2^( 4) =       0.000587172287
  error estimate for blocks of size 2^( 5) =       0.000600395353
  error estimate for blocks of size 2^( 6) =       0.000607711699
  error estimate for blocks of size 2^( 7) =       0.000612051180

      target function =      -0.683033932056
              le_mean =     -22.426853250280
             les_mean =     503.497102272560
             stat err =       0.000601832630
             autocorr =       1.358202137793
   target nu stat err =       0.000601832630
   target dn stat err =       0.032527708889
      target stat err =       0.021908603646
              std dev =       0.730312145343
             le_variance =       0.533355829635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.533397711542
                                         uncertainty =       0.032231165999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.533397711542
                                         uncertainty =       0.032231165999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000516407043
  error estimate for blocks of size 2^( 2) =       0.000542278880
  error estimate for blocks of size 2^( 3) =       0.000567546608
  error estimate for blocks of size 2^( 4) =       0.000587171491
  error estimate for blocks of size 2^( 5) =       0.000600394834
  error estimate for blocks of size 2^( 6) =       0.000607711300
  error estimate for blocks of size 2^( 7) =       0.000612050606

      target function =      -0.683036222451
              le_mean =     -22.426853237995
             les_mean =     503.497098360258
             stat err =       0.000601832058
             autocorr =       1.358208116023
   target nu stat err =       0.000601832058
   target dn stat err =       0.032526980104
      target stat err =       0.021908258757
              std dev =       0.730309844098
             le_variance =       0.533352468386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.533394765666
                                         uncertainty =       0.032230530216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.533394765666
                                         uncertainty =       0.032230530216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000516405617
  error estimate for blocks of size 2^( 2) =       0.000542277679
  error estimate for blocks of size 2^( 3) =       0.000567545713
  error estimate for blocks of size 2^( 4) =       0.000587170793
  error estimate for blocks of size 2^( 5) =       0.000600394380
  error estimate for blocks of size 2^( 6) =       0.000607710951
  error estimate for blocks of size 2^( 7) =       0.000612050103

      target function =      -0.683038230084
              le_mean =     -22.426853227570
             les_mean =     503.497094946392
             stat err =       0.000601831557
             autocorr =       1.358213358266
   target nu stat err =       0.000601831557
   target dn stat err =       0.032526341124
      target stat err =       0.021907956341
              std dev =       0.730307826949
             le_variance =       0.533349522104


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.683038516905        initial  <--
     2.5000e+01     2.5000e+02             2.7447e-05        -0.683033932056
     1.0000e+02     1.0000e+03             6.8614e-06        -0.683036222451
     4.0000e+02     4.0000e+03             1.7153e-06        -0.683038230084

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.8932
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2819e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2404e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.4175
    reference variance = 0.336889
====================================================
  Execution time = 4.5942e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2428e+01
  VMC Evar = 5.0155e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5524e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501545121293
                                         uncertainty =       0.003232999925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501545121293
                                         uncertainty =       0.003232999925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500776533
  error estimate for blocks of size 2^( 2) =       0.000527545849
  error estimate for blocks of size 2^( 3) =       0.000553174679
  error estimate for blocks of size 2^( 4) =       0.000572873285
  error estimate for blocks of size 2^( 5) =       0.000585588857
  error estimate for blocks of size 2^( 6) =       0.000593779170
  error estimate for blocks of size 2^( 7) =       0.000600048893

      target function =      -0.705823159785
              le_mean =     -22.428022359050
             les_mean =     503.517740959895
             stat err =       0.000588072551
             autocorr =       1.379030523227
   target nu stat err =       0.000588072551
   target dn stat err =       0.003580326807
      target stat err =       0.002644716353
              std dev =       0.708204965135
             le_variance =       0.501554272642


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242802235905e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705831994868       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705832016881       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705832023565       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705832027627       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705832029804       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705832031922       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705832033636       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705832036950       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705832037292       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705832037989       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.705832037913       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.705832037890       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.705832038445       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.705832038665       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.705832038977       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.705832040279       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.705832040881       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.705832041255       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.705832042220       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.705832042809       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.705832042662       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.705832042971       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.705832043331       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.705832043305       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.705832043170       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.705832043128       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.705832043063       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.705832043085       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.705832043060       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.705832043084       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.705832043061       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+02 is 1.536340e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705831994868       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705832000372       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705832002043       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705832003059       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705832003602       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705832004133       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705832004562       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705832005390       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705832005476       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705832005651       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.705832005630       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.705832005624       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.705832005765       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.705832005820       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.705832005898       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.705832006221       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.705832006373       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.705832006465       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.705832006707       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.705832006855       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.705832006814       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.705832006894       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.705832006985       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.705832006982       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.705832006941       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.705832006936       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.705832006923       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.705832006922       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.705832006917       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.705832006926       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.705832006921       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+03 is 3.840839e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705831994868       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705831996244       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705831996662       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705831996916       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705831997056       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705831997183       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705831997296       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705831997498       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705831997507       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705831997560       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.705831997563       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.705831997549       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.705831997583       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.705831997600       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.705831997616       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.705831997700       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.705831997739       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.705831997771       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.705831997825       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.705831997857       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.705831997857       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.705831997874       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.705831997900       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.705831997890       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.705831997890       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.705831997872       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.705831997877       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.705831997884       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.705831997869       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.705831997856       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.705831997874       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+03 is 9.602090e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.365025 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1505e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297151e-02 1 1  ON 1
 uu_2                -7.920284e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132617e-01 1 1  ON 8
 uu_9                -6.856222e-02 1 1  ON 9
 ud_0                 3.731545e-01 1 1  ON 10
 ud_1                 1.324657e-01 1 1  ON 11
 ud_2                 1.338638e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583431e-02 1 1  ON 14
 ud_5                -1.074505e-01 1 1  ON 15
 ud_6                -1.175899e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300089e-02 1 1  ON 18
 ud_9                -5.426900e-02 1 1  ON 19
 eC_0                -4.979351e-01 1 1  ON 20
 eC_1                -3.532773e-01 1 1  ON 21
 eC_2                -1.036268e-01 1 1  ON 22
 eC_3                 6.840174e-02 1 1  ON 23
 eC_4                 1.507104e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311929e-01 1 1  ON 26
 eC_7                 1.913396e-01 1 1  ON 27
 eC_8                 7.350125e-02 1 1  ON 28
 eC_9                 5.800111e-03 1 1  ON 29
 eO_0                -8.991041e-01 1 1  ON 30
 eO_1                -5.914002e-01 1 1  ON 31
 eO_2                -1.810808e-01 1 1  ON 32
 eO_3                 8.172770e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379146e-01 1 1  ON 35
 eO_6                 3.342744e-01 1 1  ON 36
 eO_7                 2.985278e-01 1 1  ON 37
 eO_8                 2.076724e-01 1 1  ON 38
 eO_9                 1.093500e-01 1 1  ON 39
eH1_0                -1.333664e-01 1 1  ON 40
eH1_1                -3.149702e-02 1 1  ON 41
eH1_2                -1.524339e-02 1 1  ON 42
eH1_3                -2.543343e-02 1 1  ON 43
eH1_4                 3.820780e-03 1 1  ON 44
eH1_5                 1.895377e-02 1 1  ON 45
eH1_6                 3.983388e-02 1 1  ON 46
eH1_7                 4.319411e-02 1 1  ON 47
eH1_8                 3.913161e-02 1 1  ON 48
eH1_9                 4.724034e-02 1 1  ON 49
eH2_0                -1.451081e-01 1 1  ON 50
eH2_1                -4.404102e-02 1 1  ON 51
eH2_2                -2.577916e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.872983e-03 1 1  ON 54
eH2_5                 8.664351e-03 1 1  ON 55
eH2_6                 3.559347e-02 1 1  ON 56
eH2_7                 4.803402e-02 1 1  ON 57
eH2_8                 6.894748e-02 1 1  ON 58
eH2_9                 6.265797e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.4188
    reference variance = 0.598421
====================================================
  Execution time = 4.6203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9688e-01
  Total weights = 2.0000e+06
  Execution time = 4.3527e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496951592914
                                         uncertainty =       0.003574471959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496951592914
                                         uncertainty =       0.003574471959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498435571
  error estimate for blocks of size 2^( 2) =       0.000525798085
  error estimate for blocks of size 2^( 3) =       0.000551466443
  error estimate for blocks of size 2^( 4) =       0.000570903943
  error estimate for blocks of size 2^( 5) =       0.000583337513
  error estimate for blocks of size 2^( 6) =       0.000591178563
  error estimate for blocks of size 2^( 7) =       0.000594946745

      target function =      -0.709221964265
              le_mean =     -22.427034976222
             les_mean =     503.468773613560
             stat err =       0.000585091691
             autocorr =       1.377938403556
   target nu stat err =       0.000585091691
   target dn stat err =       0.003607557816
      target stat err =       0.002684358229
              std dev =       0.704894344773
             le_variance =       0.496876037293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496951649844
                                         uncertainty =       0.003574478739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496951649844
                                         uncertainty =       0.003574478739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498435600
  error estimate for blocks of size 2^( 2) =       0.000525798086
  error estimate for blocks of size 2^( 3) =       0.000551466417
  error estimate for blocks of size 2^( 4) =       0.000570903890
  error estimate for blocks of size 2^( 5) =       0.000583337443
  error estimate for blocks of size 2^( 6) =       0.000591178477
  error estimate for blocks of size 2^( 7) =       0.000594946671

      target function =      -0.709221922842
              le_mean =     -22.427034979064
             les_mean =     503.468773798031
             stat err =       0.000585091620
             autocorr =       1.377937912470
   target nu stat err =       0.000585091620
   target dn stat err =       0.003607564168
      target stat err =       0.002684362410
              std dev =       0.704894385201
             le_variance =       0.496876094287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496951621382
                                         uncertainty =       0.003574475349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496951621382
                                         uncertainty =       0.003574475349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498435586
  error estimate for blocks of size 2^( 2) =       0.000525798085
  error estimate for blocks of size 2^( 3) =       0.000551466430
  error estimate for blocks of size 2^( 4) =       0.000570903917
  error estimate for blocks of size 2^( 5) =       0.000583337478
  error estimate for blocks of size 2^( 6) =       0.000591178520
  error estimate for blocks of size 2^( 7) =       0.000594946708

      target function =      -0.709221943552
              le_mean =     -22.427034977643
             les_mean =     503.468773705771
             stat err =       0.000585091656
             autocorr =       1.377938157983
   target nu stat err =       0.000585091656
   target dn stat err =       0.003607560992
      target stat err =       0.002684360320
              std dev =       0.704894364989
             le_variance =       0.496876065793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496951596472
                                         uncertainty =       0.003574472382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496951596472
                                         uncertainty =       0.003574472382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498435573
  error estimate for blocks of size 2^( 2) =       0.000525798085
  error estimate for blocks of size 2^( 3) =       0.000551466441
  error estimate for blocks of size 2^( 4) =       0.000570903940
  error estimate for blocks of size 2^( 5) =       0.000583337509
  error estimate for blocks of size 2^( 6) =       0.000591178557
  error estimate for blocks of size 2^( 7) =       0.000594946740

      target function =      -0.709221961676
              le_mean =     -22.427034976400
             les_mean =     503.468773625082
             stat err =       0.000585091687
             autocorr =       1.377938372866
   target nu stat err =       0.000585091687
   target dn stat err =       0.003607558213
      target stat err =       0.002684358491
              std dev =       0.704894347300
             le_variance =       0.496876040856


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.709221964265        initial  <--
     2.5000e+02     2.5000e+03             1.5363e-06        -0.709221922842
     1.0000e+03     1.0000e+04             3.8408e-07        -0.709221943552
     4.0000e+03     4.0000e+04             9.6021e-08        -0.709221961676

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.9725
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2749e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2408e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.4428
    reference variance = 0.573624
====================================================
  Execution time = 4.6363e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0652e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5218e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506582287777
                                         uncertainty =       0.007584478070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506582287777
                                         uncertainty =       0.007584478070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503249016
  error estimate for blocks of size 2^( 2) =       0.000529618602
  error estimate for blocks of size 2^( 3) =       0.000555116854
  error estimate for blocks of size 2^( 4) =       0.000574796501
  error estimate for blocks of size 2^( 5) =       0.000587735834
  error estimate for blocks of size 2^( 6) =       0.000594128801
  error estimate for blocks of size 2^( 7) =       0.000599320488

      target function =      -0.702289977468
              le_mean =     -22.426053206722
             les_mean =     503.434381322569
             stat err =       0.000588995406
             autocorr =       1.369802470981
   target nu stat err =       0.000588995406
   target dn stat err =       0.007531599019
      target stat err =       0.005382633234
              std dev =       0.711701584318
             le_variance =       0.506519145121


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242605320672e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702329753557       residual = 9.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702329758973       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.702329762316       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.702329764252       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.702329765648       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.702329766941       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.702329767825       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.702329768360       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.702329769201       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.702329769563       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.702329769894       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.702329770125       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.702329770697       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.702329771271       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.702329771654       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.702329771769       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.702329771894       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.702329772140       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.702329772331       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.702329772512       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.702329772611       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.702329772645       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.702329772771       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.702329772797       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.702329772801       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.702329772821       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.702329772835       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.702329772821       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.702329772821       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.702329772827       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.702329772831       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.702329772826       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.702329772839       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+03 is 5.944829e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702329753557       residual = 9.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702329754911       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.702329755746       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.702329756231       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.702329756584       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.702329756904       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.702329757128       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.702329757260       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.702329757461       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.702329757543       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.702329757644       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.702329757686       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.702329757814       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.702329757972       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.702329758075       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.702329758112       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.702329758141       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.702329758205       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.702329758230       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.702329758298       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.702329758322       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.702329758313       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.702329758374       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.702329758358       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.702329758372       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.702329758316       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.702329758392       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.702329758382       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.702329758378       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.702329758381       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.702329758371       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.702329758370       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.702329758397       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+04 is 1.486210e-07

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702329753557       residual = 9.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702329753895       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.702329754104       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.702329754225       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.702329754297       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.702329754429       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.702329754486       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.702329754479       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.702329754567       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.702329754587       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.702329754517       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.702329754534       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.702329754589       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.702329754750       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.702329754662       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.702329754717       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.702329754615       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.702329754597       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.702329754707       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.702329754779       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.702329754792       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.702329754674       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.702329754739       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.702329754725       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.702329754706       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.702329754837       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.702329754722       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.702329754690       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.702329754762       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.702329754762       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.702329754784       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.702329754810       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.702329754678       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+04 is 3.715526e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.402798 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1625e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297149e-02 1 1  ON 1
 uu_2                -7.920271e-03 1 1  ON 2
 uu_3                -6.923398e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374583e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338634e-02 1 1  ON 12
 ud_3                -4.969113e-02 1 1  ON 13
 ud_4                -8.583433e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175899e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426883e-02 1 1  ON 19
 eC_0                -4.979349e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913393e-01 1 1  ON 27
 eC_8                 7.350104e-02 1 1  ON 28
 eC_9                 5.800105e-03 1 1  ON 29
 eO_0                -8.991039e-01 1 1  ON 30
 eO_1                -5.914000e-01 1 1  ON 31
 eO_2                -1.810806e-01 1 1  ON 32
 eO_3                 8.172782e-02 1 1  ON 33
 eO_4                 2.361582e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342743e-01 1 1  ON 36
 eO_7                 2.985277e-01 1 1  ON 37
 eO_8                 2.076721e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149680e-02 1 1  ON 41
eH1_2                -1.524323e-02 1 1  ON 42
eH1_3                -2.543345e-02 1 1  ON 43
eH1_4                 3.820787e-03 1 1  ON 44
eH1_5                 1.895375e-02 1 1  ON 45
eH1_6                 3.983371e-02 1 1  ON 46
eH1_7                 4.319398e-02 1 1  ON 47
eH1_8                 3.913138e-02 1 1  ON 48
eH1_9                 4.724034e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404083e-02 1 1  ON 51
eH2_2                -2.577915e-02 1 1  ON 52
eH2_3                -3.487600e-02 1 1  ON 53
eH2_4                -6.873036e-03 1 1  ON 54
eH2_5                 8.664251e-03 1 1  ON 55
eH2_6                 3.559347e-02 1 1  ON 56
eH2_7                 4.803399e-02 1 1  ON 57
eH2_8                 6.894743e-02 1 1  ON 58
eH2_9                 6.265783e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.5407
    reference variance = 0.72186
====================================================
  Execution time = 4.5443e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9589e-01
  Total weights = 2.0000e+06
  Execution time = 3.8474e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495882002599
                                         uncertainty =       0.004340142371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495882002599
                                         uncertainty =       0.004340142371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497939121
  error estimate for blocks of size 2^( 2) =       0.000524683727
  error estimate for blocks of size 2^( 3) =       0.000550611649
  error estimate for blocks of size 2^( 4) =       0.000569960742
  error estimate for blocks of size 2^( 5) =       0.000581124523
  error estimate for blocks of size 2^( 6) =       0.000586159111
  error estimate for blocks of size 2^( 7) =       0.000589328619

      target function =      -0.709951251963
              le_mean =     -22.425947575091
             les_mean =     503.419011129554
             stat err =       0.000581643249
             autocorr =       1.364460243956
   target nu stat err =       0.000581643249
   target dn stat err =       0.004527572873
      target stat err =       0.003339147737
              std dev =       0.704192258370
             le_variance =       0.495886736749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495882044086
                                         uncertainty =       0.004340143089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495882044086
                                         uncertainty =       0.004340143089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497939142
  error estimate for blocks of size 2^( 2) =       0.000524683741
  error estimate for blocks of size 2^( 3) =       0.000550611656
  error estimate for blocks of size 2^( 4) =       0.000569960743
  error estimate for blocks of size 2^( 5) =       0.000581124520
  error estimate for blocks of size 2^( 6) =       0.000586159105
  error estimate for blocks of size 2^( 7) =       0.000589328612

      target function =      -0.709951221858
              le_mean =     -22.425947573626
             les_mean =     503.419011105344
             stat err =       0.000581643245
             autocorr =       1.364460111900
   target nu stat err =       0.000581643245
   target dn stat err =       0.004527573341
      target stat err =       0.003339147785
              std dev =       0.704192287841
             le_variance =       0.495886778255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495882023343
                                         uncertainty =       0.004340142730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495882023343
                                         uncertainty =       0.004340142730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497939132
  error estimate for blocks of size 2^( 2) =       0.000524683734
  error estimate for blocks of size 2^( 3) =       0.000550611652
  error estimate for blocks of size 2^( 4) =       0.000569960743
  error estimate for blocks of size 2^( 5) =       0.000581124522
  error estimate for blocks of size 2^( 6) =       0.000586159108
  error estimate for blocks of size 2^( 7) =       0.000589328615

      target function =      -0.709951236910
              le_mean =     -22.425947574359
             les_mean =     503.419011117448
             stat err =       0.000581643247
             autocorr =       1.364460177934
   target nu stat err =       0.000581643247
   target dn stat err =       0.004527573107
      target stat err =       0.003339147761
              std dev =       0.704192273106
             le_variance =       0.495886757502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495882005192
                                         uncertainty =       0.004340142416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495882005192
                                         uncertainty =       0.004340142416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497939122
  error estimate for blocks of size 2^( 2) =       0.000524683728
  error estimate for blocks of size 2^( 3) =       0.000550611649
  error estimate for blocks of size 2^( 4) =       0.000569960742
  error estimate for blocks of size 2^( 5) =       0.000581124523
  error estimate for blocks of size 2^( 6) =       0.000586159111
  error estimate for blocks of size 2^( 7) =       0.000589328618

      target function =      -0.709951250081
              le_mean =     -22.425947575000
             les_mean =     503.419011128041
             stat err =       0.000581643249
             autocorr =       1.364460235700
   target nu stat err =       0.000581643249
   target dn stat err =       0.004527572902
      target stat err =       0.003339147740
              std dev =       0.704192260212
             le_variance =       0.495886739343


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.709951251963        initial  <--
     2.5000e+03     2.5000e+04             5.9448e-07        -0.709951221858
     1.0000e+04     1.0000e+05             1.4862e-07        -0.709951236910
     4.0000e+04     4.0000e+05             3.7155e-08        -0.709951250081

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.0967
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2873e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2425e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.4952
    reference variance = 0.355971
====================================================
  Execution time = 4.5902e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9568e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5259e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495774855039
                                         uncertainty =       0.004020206121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495774855039
                                         uncertainty =       0.004020206121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497834829
  error estimate for blocks of size 2^( 2) =       0.000524233892
  error estimate for blocks of size 2^( 3) =       0.000549953271
  error estimate for blocks of size 2^( 4) =       0.000568897696
  error estimate for blocks of size 2^( 5) =       0.000581569128
  error estimate for blocks of size 2^( 6) =       0.000587422650
  error estimate for blocks of size 2^( 7) =       0.000592275616

      target function =      -0.710081318967
              le_mean =     -22.427516622695
             les_mean =     503.489180647682
             stat err =       0.000582541272
             autocorr =       1.369250303550
   target nu stat err =       0.000582541272
   target dn stat err =       0.004002315016
      target stat err =       0.002972774392
              std dev =       0.704044767218
             le_variance =       0.495679034247


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242751662270e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710092908002       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710092908151       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710092908199       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710092908221       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710092908212       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710092908213       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710092908310       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710092908271       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710092908293       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710092908343       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710092908272       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.710092908318       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.710092908281       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.710092908295       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.710092908326       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.710092908385       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.710092908290       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.710092908331       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.710092908328       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.710092908400       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.710092908401       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.710092908332       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.710092908411       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.710092908434       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.710092908408       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.710092908387       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.710092908344       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.710092908439       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.710092908332       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.710092908345       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.710092908279       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+04 is 2.120396e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710092908002       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710092908040       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710092908051       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710092908059       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710092908168       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710092908030       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710092908164       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710092908044       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710092908060       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710092908021       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710092908044       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.710092908022       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.710092908180       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.710092908148       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.710092908028       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.710092908225       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.710092907935       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.710092908049       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.710092908157       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.710092908042       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.710092908001       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.710092908123       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.710092908029       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.710092908205       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.710092907949       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.710092908320       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.710092908362       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.710092907883       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.710092907928       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.710092907594       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.710092908157       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+05 is 5.300991e-09

solving harmonic davidson linear method for identity shift 4.0000e+05, overlap shift 4.0000e+06 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710092908002       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710092908012       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710092908015       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710092908017       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710092908087       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710092908552       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710092908118       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710092908267       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710092907837       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710092906907       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710092907817       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.710092907412       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.710092908180       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.710092907551       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.710092908594       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.710092908096       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.710092907894       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.710092908136       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.710092908366       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.710092908133       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.710092906463       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.710092908528       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.710092908961       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.710092908493       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.710092907963       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.710092907717       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.710092908071       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.710092907379       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.710092907627       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.710092907078       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.710092907363       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+05 is 1.325248e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.435417 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1200e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920285e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426883e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840188e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820774e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873060e-03 1 1  ON 54
eH2_5                 8.664232e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.495
    reference variance = 0.335679
====================================================
  Execution time = 4.4951e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0251e-01
  Total weights = 2.0000e+06
  Execution time = 3.8382e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502407712083
                                         uncertainty =       0.005509538997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502407712083
                                         uncertainty =       0.005509538997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501253224
  error estimate for blocks of size 2^( 2) =       0.000527754623
  error estimate for blocks of size 2^( 3) =       0.000552596111
  error estimate for blocks of size 2^( 4) =       0.000571760190
  error estimate for blocks of size 2^( 5) =       0.000583763226
  error estimate for blocks of size 2^( 6) =       0.000590465902
  error estimate for blocks of size 2^( 7) =       0.000593121153

      target function =      -0.705133350861
              le_mean =     -22.427472896313
             les_mean =     503.494049852874
             stat err =       0.000584777618
             autocorr =       1.361028204576
   target nu stat err =       0.000584777618
   target dn stat err =       0.005853896763
      target stat err =       0.004242098082
              std dev =       0.708879107671
             le_variance =       0.502509589293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502407713542
                                         uncertainty =       0.005509539075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502407713542
                                         uncertainty =       0.005509539075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501253225
  error estimate for blocks of size 2^( 2) =       0.000527754624
  error estimate for blocks of size 2^( 3) =       0.000552596111
  error estimate for blocks of size 2^( 4) =       0.000571760190
  error estimate for blocks of size 2^( 5) =       0.000583763225
  error estimate for blocks of size 2^( 6) =       0.000590465901
  error estimate for blocks of size 2^( 7) =       0.000593121152

      target function =      -0.705133349812
              le_mean =     -22.427472896301
             les_mean =     503.494049853794
             stat err =       0.000584777617
             autocorr =       1.361028196992
   target nu stat err =       0.000584777617
   target dn stat err =       0.005853896843
      target stat err =       0.004242098126
              std dev =       0.708879108702
             le_variance =       0.502509590755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502407712813
                                         uncertainty =       0.005509539036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502407712813
                                         uncertainty =       0.005509539036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501253224
  error estimate for blocks of size 2^( 2) =       0.000527754623
  error estimate for blocks of size 2^( 3) =       0.000552596111
  error estimate for blocks of size 2^( 4) =       0.000571760190
  error estimate for blocks of size 2^( 5) =       0.000583763225
  error estimate for blocks of size 2^( 6) =       0.000590465902
  error estimate for blocks of size 2^( 7) =       0.000593121152

      target function =      -0.705133350337
              le_mean =     -22.427472896307
             les_mean =     503.494049853334
             stat err =       0.000584777617
             autocorr =       1.361028200783
   target nu stat err =       0.000584777617
   target dn stat err =       0.005853896803
      target stat err =       0.004242098104
              std dev =       0.708879108187
             le_variance =       0.502509590024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502407712174
                                         uncertainty =       0.005509539002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502407712174
                                         uncertainty =       0.005509539002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501253224
  error estimate for blocks of size 2^( 2) =       0.000527754623
  error estimate for blocks of size 2^( 3) =       0.000552596111
  error estimate for blocks of size 2^( 4) =       0.000571760190
  error estimate for blocks of size 2^( 5) =       0.000583763226
  error estimate for blocks of size 2^( 6) =       0.000590465902
  error estimate for blocks of size 2^( 7) =       0.000593121152

      target function =      -0.705133350796
              le_mean =     -22.427472896312
             les_mean =     503.494049852932
             stat err =       0.000584777618
             autocorr =       1.361028204109
   target nu stat err =       0.000584777618
   target dn stat err =       0.005853896768
      target stat err =       0.004242098085
              std dev =       0.708879107736
             le_variance =       0.502509589384


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.705133350861        initial  <--
     2.5000e+04     2.5000e+05             2.1204e-08        -0.705133349812
     1.0000e+05     1.0000e+06             5.3010e-09        -0.705133350337
     4.0000e+05     4.0000e+06             1.3252e-09        -0.705133350796

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.1428
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2535e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2436e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.4721
    reference variance = 0.614238
====================================================
  Execution time = 4.8074e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2428e+01
  VMC Evar = 5.0089e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5442e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500904037599
                                         uncertainty =       0.007076955027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500904037599
                                         uncertainty =       0.007076955027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500446013
  error estimate for blocks of size 2^( 2) =       0.000526722111
  error estimate for blocks of size 2^( 3) =       0.000551532558
  error estimate for blocks of size 2^( 4) =       0.000571449685
  error estimate for blocks of size 2^( 5) =       0.000583261202
  error estimate for blocks of size 2^( 6) =       0.000588076437
  error estimate for blocks of size 2^( 7) =       0.000592859125

      target function =      -0.706267139420
              le_mean =     -22.428291688354
             les_mean =     503.529160232138
             stat err =       0.000583911612
             autocorr =       1.361381222764
   target nu stat err =       0.000583911612
   target dn stat err =       0.007030858008
      target stat err =       0.005101833497
              std dev =       0.707737539430
             le_variance =       0.500892424718


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242829168835e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706302443073       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706302443104       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706302443127       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706302442972       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706302443017       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.706302443222       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.706302442676       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.706302443756       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.706302443001       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.706302443205       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.706302443050       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.706302442595       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.706302443029       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.706302442953       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.706302443326       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.706302443231       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.706302442990       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.706302443301       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.706302443384       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.706302443948       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.706302442952       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.706302444060       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.706302443376       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.706302443553       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.706302443816       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.706302441993       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.706302442664       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.706302443081       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.706302442879       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.706302443281       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.706302441791       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.706302443675       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.706302442830       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+05 is 2.608773e-09

solving harmonic davidson linear method for identity shift 1.0000e+06, overlap shift 1.0000e+07 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706302443073       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706302443081       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706302443087       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706302443396       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706302442910       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.706302444591       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.706302444888       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.706302442098       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.706302441765       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.706302443329       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.706302443103       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.706302444049       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.706302442996       residual = 7.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.706302443073       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.706302443881       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.706302444769       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.706302441290       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.706302441316       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.706302446907       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.706302443314       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.706302443047       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.706302440174       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.706302441435       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.706302444863       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.706302443159       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.706302445070       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.706302444067       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.706302439322       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.706302442845       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.706302443836       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.706302443653       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.706302442827       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.706302447033       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+06 is 6.521927e-10

solving harmonic davidson linear method for identity shift 4.0000e+06, overlap shift 4.0000e+07 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706302443073       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706302443075       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706302443076       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706302440120       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706302441948       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.706302443499       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.706302437766       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.706302447686       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.706302444838       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.706302440890       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.706302447857       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.706302445080       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.706302460030       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.706302434061       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.706302440961       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.706302448004       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.706302449124       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.706302429365       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.706302446370       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.706302452998       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.706302437675       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.706302439294       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.706302445523       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.706302442232       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.706302434695       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.706302437009       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.706302462297       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.706302454315       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.706302443802       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.706302452049       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.706302446787       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.706302432638       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.706302454154       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+06 is 1.630472e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.473763 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3561e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297147e-02 1 1  ON 1
 uu_2                -7.920285e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664231e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.3442
    reference variance = 0.439389
====================================================
  Execution time = 4.4912e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9256e-01
  Total weights = 2.0000e+06
  Execution time = 3.8198e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492605384851
                                         uncertainty =       0.003483011473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492605384851
                                         uncertainty =       0.003483011473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496267558
  error estimate for blocks of size 2^( 2) =       0.000523017075
  error estimate for blocks of size 2^( 3) =       0.000548155864
  error estimate for blocks of size 2^( 4) =       0.000567417093
  error estimate for blocks of size 2^( 5) =       0.000580178106
  error estimate for blocks of size 2^( 6) =       0.000585127409
  error estimate for blocks of size 2^( 7) =       0.000588520331

      target function =      -0.712361497684
              le_mean =     -22.427123747691
             les_mean =     503.468442326569
             stat err =       0.000580310735
             autocorr =       1.367380673600
   target nu stat err =       0.000580310735
   target dn stat err =       0.003909214065
      target stat err =       0.002922616385
              std dev =       0.701828311339
             le_variance =       0.492562978597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492605385256
                                         uncertainty =       0.003483011483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492605385256
                                         uncertainty =       0.003483011483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496267558
  error estimate for blocks of size 2^( 2) =       0.000523017075
  error estimate for blocks of size 2^( 3) =       0.000548155865
  error estimate for blocks of size 2^( 4) =       0.000567417093
  error estimate for blocks of size 2^( 5) =       0.000580178106
  error estimate for blocks of size 2^( 6) =       0.000585127409
  error estimate for blocks of size 2^( 7) =       0.000588520331

      target function =      -0.712361497388
              le_mean =     -22.427123747691
             les_mean =     503.468442326958
             stat err =       0.000580310735
             autocorr =       1.367380672483
   target nu stat err =       0.000580310735
   target dn stat err =       0.003909214076
      target stat err =       0.002922616390
              std dev =       0.701828311628
             le_variance =       0.492562979002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492605385053
                                         uncertainty =       0.003483011478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492605385053
                                         uncertainty =       0.003483011478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496267558
  error estimate for blocks of size 2^( 2) =       0.000523017075
  error estimate for blocks of size 2^( 3) =       0.000548155864
  error estimate for blocks of size 2^( 4) =       0.000567417093
  error estimate for blocks of size 2^( 5) =       0.000580178106
  error estimate for blocks of size 2^( 6) =       0.000585127409
  error estimate for blocks of size 2^( 7) =       0.000588520331

      target function =      -0.712361497536
              le_mean =     -22.427123747691
             les_mean =     503.468442326764
             stat err =       0.000580310735
             autocorr =       1.367380673042
   target nu stat err =       0.000580310735
   target dn stat err =       0.003909214070
      target stat err =       0.002922616387
              std dev =       0.701828311484
             le_variance =       0.492562978800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492605384876
                                         uncertainty =       0.003483011474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492605384876
                                         uncertainty =       0.003483011474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496267558
  error estimate for blocks of size 2^( 2) =       0.000523017075
  error estimate for blocks of size 2^( 3) =       0.000548155864
  error estimate for blocks of size 2^( 4) =       0.000567417093
  error estimate for blocks of size 2^( 5) =       0.000580178106
  error estimate for blocks of size 2^( 6) =       0.000585127409
  error estimate for blocks of size 2^( 7) =       0.000588520331

      target function =      -0.712361497665
              le_mean =     -22.427123747691
             les_mean =     503.468442326593
             stat err =       0.000580310735
             autocorr =       1.367380673522
   target nu stat err =       0.000580310735
   target dn stat err =       0.003909214065
      target stat err =       0.002922616385
              std dev =       0.701828311357
             le_variance =       0.492562978623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.712361497684        initial  <--
     2.5000e+05     2.5000e+06             2.6088e-09        -0.712361497388
     1.0000e+06     1.0000e+07             6.5219e-10        -0.712361497536
     4.0000e+06     4.0000e+07             1.6305e-10        -0.712361497665

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0166
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2759e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2432e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.4183
    reference variance = 0.420659
====================================================
  Execution time = 4.7729e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2428e+01
  VMC Evar = 5.0119e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5278e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501249165108
                                         uncertainty =       0.004752698355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501249165108
                                         uncertainty =       0.004752698355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500592625
  error estimate for blocks of size 2^( 2) =       0.000526918139
  error estimate for blocks of size 2^( 3) =       0.000551792885
  error estimate for blocks of size 2^( 4) =       0.000570998335
  error estimate for blocks of size 2^( 5) =       0.000582509003
  error estimate for blocks of size 2^( 6) =       0.000589883551
  error estimate for blocks of size 2^( 7) =       0.000595620279

      target function =      -0.706083275436
              le_mean =     -22.427789126518
             les_mean =     503.506910805304
             stat err =       0.000584752792
             autocorr =       1.364506832602
   target nu stat err =       0.000584752792
   target dn stat err =       0.005145983320
      target stat err =       0.003751504159
              std dev =       0.707944879447
             le_variance =       0.501185952335


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242778912652e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706102307362       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706102307365       residual = 6.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706102307366       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706102307366       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706102307299       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.706102308795       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.706102307240       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.706102304850       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.706102315105       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.706102306210       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.706102317348       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.706102303024       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.706102306478       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.706102309606       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.706102304060       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.706102307112       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.706102308792       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.706102309494       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.706102298050       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.706102308213       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.706102308685       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.706102316062       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.706102300683       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.706102306377       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.706102302368       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.706102310982       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.706102299158       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.706102302012       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.706102298867       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.706102306764       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.706102294442       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+06 is 1.858978e-10

solving harmonic davidson linear method for identity shift 1.0000e+07, overlap shift 1.0000e+08 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706102307362       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706102307362       residual = 6.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706102307363       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706102307363       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706102307353       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.706102325157       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.706102324030       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.706102292730       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.706102323516       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.706102306632       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.706102307869       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.706102327984       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.706102326217       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.706102280988       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.706102310294       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.706102302160       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.706102313220       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.706102312073       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.706102292107       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.706102296982       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.706102314003       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.706102319817       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.706102307325       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.706102287829       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.706102333687       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.706102273048       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.706102305231       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.706102326457       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.706102317477       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.706102293732       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.706102244733       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+07 is 4.647488e-11

solving harmonic davidson linear method for identity shift 4.0000e+07, overlap shift 4.0000e+08 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706102307362       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706102307362       residual = 6.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706102307362       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706102307362       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706102307396       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.706102257836       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.706102343867       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.706102377459       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.706102280869       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.706102349874       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.706102325625       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.706102239795       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.706102304832       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.706102311491       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.706102350597       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.706102351580       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.706102312372       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.706102328268       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.706102255630       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.706102349126       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.706102372097       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.706102245996       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.706102320176       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.706102356080       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.706102083045       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.706102346202       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.706102323505       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.706102279046       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.706102401715       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.706102137787       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.706102349983       residual = 8.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+07 is 1.161847e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.506228 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3046e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.4006
    reference variance = 0.322874
====================================================
  Execution time = 4.4924e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9053e-01
  Total weights = 2.0000e+06
  Execution time = 3.8428e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490560919077
                                         uncertainty =       0.002758099338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490560919077
                                         uncertainty =       0.002758099338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495244753
  error estimate for blocks of size 2^( 2) =       0.000522318291
  error estimate for blocks of size 2^( 3) =       0.000546939105
  error estimate for blocks of size 2^( 4) =       0.000566858562
  error estimate for blocks of size 2^( 5) =       0.000579881518
  error estimate for blocks of size 2^( 6) =       0.000587460416
  error estimate for blocks of size 2^( 7) =       0.000590674539

      target function =      -0.713850681534
              le_mean =     -22.427514768496
             les_mean =     503.483953176900
             stat err =       0.000581218759
             autocorr =       1.377334668310
   target nu stat err =       0.000581218759
   target dn stat err =       0.002762885824
      target stat err =       0.002118134732
              std dev =       0.700381846602
             le_variance =       0.490534731050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490560919101
                                         uncertainty =       0.002758099339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490560919101
                                         uncertainty =       0.002758099339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495244753
  error estimate for blocks of size 2^( 2) =       0.000522318291
  error estimate for blocks of size 2^( 3) =       0.000546939105
  error estimate for blocks of size 2^( 4) =       0.000566858562
  error estimate for blocks of size 2^( 5) =       0.000579881518
  error estimate for blocks of size 2^( 6) =       0.000587460416
  error estimate for blocks of size 2^( 7) =       0.000590674539

      target function =      -0.713850681517
              le_mean =     -22.427514768496
             les_mean =     503.483953176907
             stat err =       0.000581218759
             autocorr =       1.377334668227
   target nu stat err =       0.000581218759
   target dn stat err =       0.002762885824
      target stat err =       0.002118134732
              std dev =       0.700381846619
             le_variance =       0.490534731074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490560919089
                                         uncertainty =       0.002758099338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490560919089
                                         uncertainty =       0.002758099338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495244753
  error estimate for blocks of size 2^( 2) =       0.000522318291
  error estimate for blocks of size 2^( 3) =       0.000546939105
  error estimate for blocks of size 2^( 4) =       0.000566858562
  error estimate for blocks of size 2^( 5) =       0.000579881518
  error estimate for blocks of size 2^( 6) =       0.000587460416
  error estimate for blocks of size 2^( 7) =       0.000590674539

      target function =      -0.713850681525
              le_mean =     -22.427514768496
             les_mean =     503.483953176903
             stat err =       0.000581218759
             autocorr =       1.377334668271
   target nu stat err =       0.000581218759
   target dn stat err =       0.002762885824
      target stat err =       0.002118134732
              std dev =       0.700381846611
             le_variance =       0.490534731062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490560919079
                                         uncertainty =       0.002758099338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490560919079
                                         uncertainty =       0.002758099338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495244753
  error estimate for blocks of size 2^( 2) =       0.000522318291
  error estimate for blocks of size 2^( 3) =       0.000546939105
  error estimate for blocks of size 2^( 4) =       0.000566858562
  error estimate for blocks of size 2^( 5) =       0.000579881518
  error estimate for blocks of size 2^( 6) =       0.000587460416
  error estimate for blocks of size 2^( 7) =       0.000590674539

      target function =      -0.713850681533
              le_mean =     -22.427514768496
             les_mean =     503.483953176900
             stat err =       0.000581218759
             autocorr =       1.377334668309
   target nu stat err =       0.000581218759
   target dn stat err =       0.002762885824
      target stat err =       0.002118134732
              std dev =       0.700381846603
             le_variance =       0.490534731051


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.713850681534        initial  <--
     2.5000e+06     2.5000e+07             1.8590e-10        -0.713850681517
     1.0000e+07     1.0000e+08             4.6475e-11        -0.713850681525
     4.0000e+07     4.0000e+08             1.1618e-11        -0.713850681533

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.1632
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2722e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2429e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.404
    reference variance = 0.300066
====================================================
  Execution time = 4.5973e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9886e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5217e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498880860341
                                         uncertainty =       0.003485099254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498880860341
                                         uncertainty =       0.003485099254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499429526
  error estimate for blocks of size 2^( 2) =       0.000525926514
  error estimate for blocks of size 2^( 3) =       0.000551455004
  error estimate for blocks of size 2^( 4) =       0.000571193606
  error estimate for blocks of size 2^( 5) =       0.000583188695
  error estimate for blocks of size 2^( 6) =       0.000589590636
  error estimate for blocks of size 2^( 7) =       0.000590091635

      target function =      -0.707777949267
              le_mean =     -22.427426354495
             les_mean =     503.488312340221
             stat err =       0.000583516143
             autocorr =       1.365077544415
   target nu stat err =       0.000583516143
   target dn stat err =       0.003735335587
      target stat err =       0.002764979244
              std dev =       0.706300009449
             le_variance =       0.498859703347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242742635450e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707787774421       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707787774421       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707787774421       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707787774421       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707787774421       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707787774421       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707787774421       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707787774421       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707787774421       residual = 8.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707787774421       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707787774421       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.707787774421       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.707787774421       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.707787704436       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.707787746621       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.707787805116       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.707787781239       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.707787744279       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.707787731369       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.707787689235       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.707787720974       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.707787745697       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.707787701836       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.707787855691       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.707787612674       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.707787744829       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.707787783503       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.707787778758       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.707787880015       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.707787914300       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.707787809373       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.707787831197       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+07 is 2.142719e-11

solving harmonic davidson linear method for identity shift 1.0000e+08, overlap shift 1.0000e+09 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707787774421       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707787774421       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707787774421       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707787774421       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707787774421       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707787746795       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707787812749       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707787841521       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707787663132       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707788054143       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707787648041       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.707787699406       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.707787940738       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.707787859445       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.707787702196       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.707787597457       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.707787748129       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.707787831026       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.707787853989       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.707787655112       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.707787685557       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.707787749175       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.707787689292       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.707787769231       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.707787950270       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.707788057166       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.707787502936       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.707787697170       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.707787701588       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.707787718607       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.707787735067       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.707787822204       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+08 is 5.357008e-12

solving harmonic davidson linear method for identity shift 4.0000e+08, overlap shift 4.0000e+09 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707787774421       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707787774421       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707787774421       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707787774421       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707787774421       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707787777586       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707787392452       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707788702209       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707788077662       residual = 8.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707787597059       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707787774421       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.707787863755       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.707787726260       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.707788173372       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.707787989300       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.707787195913       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.707787140713       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.707786492784       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.707789313197       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.707786462132       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.707787300518       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.707786922020       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.707787345884       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.707786966839       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.707788775567       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.707787172794       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.707788203776       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.707788195887       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.707789670622       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.707788614090       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.707786470454       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.707789220415       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+08 is 1.338964e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.541292 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1231e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.4242
    reference variance = 0.306257
====================================================
  Execution time = 4.7147e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0004e-01
  Total weights = 2.0000e+06
  Execution time = 3.8219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500070122404
                                         uncertainty =       0.004308744463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500070122404
                                         uncertainty =       0.004308744463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500019247
  error estimate for blocks of size 2^( 2) =       0.000526652919
  error estimate for blocks of size 2^( 3) =       0.000552853857
  error estimate for blocks of size 2^( 4) =       0.000572281133
  error estimate for blocks of size 2^( 5) =       0.000584180189
  error estimate for blocks of size 2^( 6) =       0.000591063421
  error estimate for blocks of size 2^( 7) =       0.000594686528

      target function =      -0.706943394776
              le_mean =     -22.426428698550
             les_mean =     503.444742416757
             stat err =       0.000585552818
             autocorr =       1.371382824700
   target nu stat err =       0.000585552818
   target dn stat err =       0.004300360638
      target stat err =       0.003153559707
              std dev =       0.707134001193
             le_variance =       0.500038495643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500070122406
                                         uncertainty =       0.004308744463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500070122406
                                         uncertainty =       0.004308744463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500019247
  error estimate for blocks of size 2^( 2) =       0.000526652919
  error estimate for blocks of size 2^( 3) =       0.000552853857
  error estimate for blocks of size 2^( 4) =       0.000572281133
  error estimate for blocks of size 2^( 5) =       0.000584180189
  error estimate for blocks of size 2^( 6) =       0.000591063421
  error estimate for blocks of size 2^( 7) =       0.000594686528

      target function =      -0.706943394775
              le_mean =     -22.426428698550
             les_mean =     503.444742416759
             stat err =       0.000585552818
             autocorr =       1.371382824700
   target nu stat err =       0.000585552818
   target dn stat err =       0.004300360638
      target stat err =       0.003153559707
              std dev =       0.707134001194
             le_variance =       0.500038495645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500070122405
                                         uncertainty =       0.004308744463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500070122405
                                         uncertainty =       0.004308744463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500019247
  error estimate for blocks of size 2^( 2) =       0.000526652919
  error estimate for blocks of size 2^( 3) =       0.000552853857
  error estimate for blocks of size 2^( 4) =       0.000572281133
  error estimate for blocks of size 2^( 5) =       0.000584180189
  error estimate for blocks of size 2^( 6) =       0.000591063421
  error estimate for blocks of size 2^( 7) =       0.000594686528

      target function =      -0.706943394775
              le_mean =     -22.426428698550
             les_mean =     503.444742416758
             stat err =       0.000585552818
             autocorr =       1.371382824704
   target nu stat err =       0.000585552818
   target dn stat err =       0.004300360638
      target stat err =       0.003153559707
              std dev =       0.707134001193
             le_variance =       0.500038495643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500070122404
                                         uncertainty =       0.004308744463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500070122404
                                         uncertainty =       0.004308744463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500019247
  error estimate for blocks of size 2^( 2) =       0.000526652919
  error estimate for blocks of size 2^( 3) =       0.000552853857
  error estimate for blocks of size 2^( 4) =       0.000572281133
  error estimate for blocks of size 2^( 5) =       0.000584180189
  error estimate for blocks of size 2^( 6) =       0.000591063421
  error estimate for blocks of size 2^( 7) =       0.000594686528

      target function =      -0.706943394776
              le_mean =     -22.426428698550
             les_mean =     503.444742416757
             stat err =       0.000585552818
             autocorr =       1.371382824704
   target nu stat err =       0.000585552818
   target dn stat err =       0.004300360638
      target stat err =       0.003153559707
              std dev =       0.707134001193
             le_variance =       0.500038495643


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706943394776        initial  <--
     2.5000e+07     2.5000e+08             2.1427e-11        -0.706943394775
     1.0000e+08     1.0000e+09             5.3570e-12        -0.706943394775
     4.0000e+08     4.0000e+09             1.3390e-12        -0.706943394776

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.3006
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2754e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2428e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.4771
    reference variance = 0.631547
====================================================
  Execution time = 4.5870e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0227e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5065e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502331821475
                                         uncertainty =       0.008757586615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502331821475
                                         uncertainty =       0.008757586615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501132201
  error estimate for blocks of size 2^( 2) =       0.000527813978
  error estimate for blocks of size 2^( 3) =       0.000552722805
  error estimate for blocks of size 2^( 4) =       0.000572494624
  error estimate for blocks of size 2^( 5) =       0.000585367267
  error estimate for blocks of size 2^( 6) =       0.000593854831
  error estimate for blocks of size 2^( 7) =       0.000601689561

      target function =      -0.705280093090
              le_mean =     -22.427339204855
             les_mean =     503.487810525088
             stat err =       0.000588351571
             autocorr =       1.378380797647
   target nu stat err =       0.000588351571
   target dn stat err =       0.008707628665
      target stat err =       0.006277982937
              std dev =       0.708707955777
             le_variance =       0.502266966582


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242733920486e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705335397137       residual = 7.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705335397137       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705335397137       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705335397137       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705335355602       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705335385266       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705335604783       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705335585448       residual = 8.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705335601514       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705334993315       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.705335644276       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.705335653507       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.705334913314       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.705334974827       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.705335753579       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.705335399870       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.705334883277       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.705335094474       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.705335696380       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.705335344075       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.705334682456       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.705336271337       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.705335976921       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.705335149981       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.705335902973       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.705335923986       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.705334920134       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.705335244901       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.705335300815       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.705335650268       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.705334215361       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.705336358259       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+08 is 1.931251e-12

solving harmonic davidson linear method for identity shift 1.0000e+09, overlap shift 1.0000e+10 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705335397137       residual = 7.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705335397137       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705335397137       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705335397137       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705335244274       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705335383403       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705335801734       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705333990488       residual = 8.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705336487337       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705333989934       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.705332270198       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.705332845194       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.705332920038       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.705336550881       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.705333056430       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.705334230267       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.705334696456       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.705333633958       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.705335516650       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.705332299785       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.705335427385       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.705336700141       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.705335868734       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.705332572215       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.705334068479       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.705333418699       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.705333023946       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.705339976141       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.705333252987       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.705339080890       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.705336413465       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.705334854518       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.705334734450       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+09 is 4.829730e-13

solving harmonic davidson linear method for identity shift 4.0000e+09, overlap shift 4.0000e+10 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705335397137       residual = 7.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705335397137       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705335397137       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705329631901       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705335296217       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705333659032       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705346147848       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705335397137       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705338552665       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705327767266       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.705332344394       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.705337974096       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.705340520573       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.705338749545       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.705336227183       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.705335823468       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.705330748246       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.705343264510       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.705332267374       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.705339944765       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.705329925410       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.705320232031       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.705344063892       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.705324500192       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.705361630821       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.705325611333       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.705336020775       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.705333196049       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.705330442947       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.705337845192       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.705341750873       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.705303529152       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.705306772746       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.705324172160       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.705305812940       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.705359851428       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.705309935179       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.705318937910       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.705356334961       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.705320165339       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.705288525870       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.705334432474       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+09 is 1.211362e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.592186 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0991e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.4252
    reference variance = 0.275973
====================================================
  Execution time = 4.7609e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9845e-01
  Total weights = 2.0000e+06
  Execution time = 3.8311e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498555116746
                                         uncertainty =       0.003052523804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498555116746
                                         uncertainty =       0.003052523804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499225732
  error estimate for blocks of size 2^( 2) =       0.000526031069
  error estimate for blocks of size 2^( 3) =       0.000551494824
  error estimate for blocks of size 2^( 4) =       0.000570773289
  error estimate for blocks of size 2^( 5) =       0.000583033286
  error estimate for blocks of size 2^( 6) =       0.000588694056
  error estimate for blocks of size 2^( 7) =       0.000591024386

      target function =      -0.708069771507
              le_mean =     -22.427726680273
             les_mean =     503.501376459172
             stat err =       0.000583381254
             autocorr =       1.365560714911
   target nu stat err =       0.000583381254
   target dn stat err =       0.003084715253
      target stat err =       0.002310768609
              std dev =       0.706011801146
             le_variance =       0.498452663357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498555116746
                                         uncertainty =       0.003052523804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498555116746
                                         uncertainty =       0.003052523804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499225732
  error estimate for blocks of size 2^( 2) =       0.000526031069
  error estimate for blocks of size 2^( 3) =       0.000551494824
  error estimate for blocks of size 2^( 4) =       0.000570773289
  error estimate for blocks of size 2^( 5) =       0.000583033286
  error estimate for blocks of size 2^( 6) =       0.000588694056
  error estimate for blocks of size 2^( 7) =       0.000591024386

      target function =      -0.708069771507
              le_mean =     -22.427726680273
             les_mean =     503.501376459173
             stat err =       0.000583381254
             autocorr =       1.365560714910
   target nu stat err =       0.000583381254
   target dn stat err =       0.003084715253
      target stat err =       0.002310768609
              std dev =       0.706011801146
             le_variance =       0.498452663358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498555116746
                                         uncertainty =       0.003052523804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498555116746
                                         uncertainty =       0.003052523804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499225732
  error estimate for blocks of size 2^( 2) =       0.000526031069
  error estimate for blocks of size 2^( 3) =       0.000551494824
  error estimate for blocks of size 2^( 4) =       0.000570773289
  error estimate for blocks of size 2^( 5) =       0.000583033286
  error estimate for blocks of size 2^( 6) =       0.000588694056
  error estimate for blocks of size 2^( 7) =       0.000591024386

      target function =      -0.708069771507
              le_mean =     -22.427726680273
             les_mean =     503.501376459173
             stat err =       0.000583381254
             autocorr =       1.365560714914
   target nu stat err =       0.000583381254
   target dn stat err =       0.003084715253
      target stat err =       0.002310768609
              std dev =       0.706011801146
             le_variance =       0.498452663358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498555116746
                                         uncertainty =       0.003052523804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498555116746
                                         uncertainty =       0.003052523804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499225732
  error estimate for blocks of size 2^( 2) =       0.000526031069
  error estimate for blocks of size 2^( 3) =       0.000551494824
  error estimate for blocks of size 2^( 4) =       0.000570773289
  error estimate for blocks of size 2^( 5) =       0.000583033286
  error estimate for blocks of size 2^( 6) =       0.000588694056
  error estimate for blocks of size 2^( 7) =       0.000591024386

      target function =      -0.708069771507
              le_mean =     -22.427726680273
             les_mean =     503.501376459172
             stat err =       0.000583381254
             autocorr =       1.365560714905
   target nu stat err =       0.000583381254
   target dn stat err =       0.003084715253
      target stat err =       0.002310768609
              std dev =       0.706011801146
             le_variance =       0.498452663357


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.708069771507        initial  <--
     2.5000e+08     2.5000e+09             1.9313e-12        -0.708069771507
     1.0000e+09     1.0000e+10             4.8297e-13        -0.708069771507
     4.0000e+09     4.0000e+10             1.2114e-13        -0.708069771507

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.7865
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2803e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2430e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.412
    reference variance = 0.306912
====================================================
  Execution time = 4.6448e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9648e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5100e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496551437606
                                         uncertainty =       0.003742364351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496551437606
                                         uncertainty =       0.003742364351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498235702
  error estimate for blocks of size 2^( 2) =       0.000525004310
  error estimate for blocks of size 2^( 3) =       0.000550823847
  error estimate for blocks of size 2^( 4) =       0.000570330525
  error estimate for blocks of size 2^( 5) =       0.000582392713
  error estimate for blocks of size 2^( 6) =       0.000589405156
  error estimate for blocks of size 2^( 7) =       0.000595228549

      target function =      -0.709515305783
              le_mean =     -22.426828535510
             les_mean =     503.459115541775
             stat err =       0.000584339236
             autocorr =       1.375499408576
   target nu stat err =       0.000584339236
   target dn stat err =       0.003447252487
      target stat err =       0.002572256403
              std dev =       0.704611686571
             le_variance =       0.496477628853


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242682853551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+09, overlap shift 2.5000e+10 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709523677408       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709523677408       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709523677408       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709523677408       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709527651610       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709523677408       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709523677408       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709521915257       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709523677408       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709527256679       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709520363061       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.709522669058       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.709521083849       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.709525551340       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.709524325304       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.709522542592       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.709523501648       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.709524862240       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.709526949379       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.709514293678       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.709525311233       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.709527444600       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.709524154484       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.709524881347       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.709523330241       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.709531874054       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.709528350299       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.709518828580       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.709519086649       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.709525551540       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.709520049485       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.709517100976       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.709532027881       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.709519207842       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.709515987630       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.709525115653       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+09 is 3.244057e-13

solving harmonic davidson linear method for identity shift 1.0000e+10, overlap shift 1.0000e+11 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709523677408       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709523677408       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709523677408       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709523397018       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709524519126       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709525340529       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709499105994       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709523745728       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709530355851       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709514721373       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709526702589       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.709523765735       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.709527178150       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.709534183133       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.709507628381       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.709498326288       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.709548239759       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.709533307361       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.709507357011       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.709527909093       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.709525462409       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.709504907959       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.709511389108       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.709536678311       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.709482446801       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.709527312197       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.709533435072       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.709491075938       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.709512073502       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.709506179064       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.709522724591       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.709517665735       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.709502062837       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.709515579941       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.709544585524       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.709549206254       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.709574815227       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.709479060180       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.709368401295       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.709348152717       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.709368008539       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.709626902912       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.709350889694       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.709526373123       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.709355519188       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.709631341520       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.709225494089       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.709488191624       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.709623459225       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.710000783400       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.710228043809       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.710573860560       residual = 6.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.708818765438       residual = 6.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.706041118307       residual = 6.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.702920568686       residual = 3.00e-02           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.708357223773       residual = 5.83e-03           smallest_sin_value = 9.94e-01
davidson iteration   56 stopping due to small subspace S singular value of 7.30e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+10 is 8.027846e-14

solving harmonic davidson linear method for identity shift 4.0000e+10, overlap shift 4.0000e+11 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709523677408       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709523677408       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709523677408       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709518661304       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709531487936       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709523567141       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709531663393       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709618236506       residual = 9.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709652861651       residual = 9.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709489398361       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709489602243       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.709600144251       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.709571527781       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.709470296630       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.709499778502       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.709571886586       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.709459705012       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.709495803009       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.709333300129       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.709451436750       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.709479555310       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.709586974307       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.709571597389       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.709505368588       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.709473604918       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.709306671630       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.709512856416       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.709500785497       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.709590169209       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.709446289828       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.709525802455       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.709616622298       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.709516967761       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.709559732825       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.709627104768       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.709400361973       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.709701820662       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.709773246872       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.709207385901       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.710094385948       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.709308230014       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.710680498240       residual = 6.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.709498993334       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.709763022927       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.709058423773       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.709980865170       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.711156614201       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.709788540203       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.708791401435       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.708543262057       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.709594506048       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.702708159498       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.708112416906       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.718049852367       residual = 3.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.741650859512       residual = 7.60e-01           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.683193285016       residual = 3.42e-01           smallest_sin_value = 9.99e-01
davidson iteration   56 stopping due to small subspace S singular value of 8.57e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+10 is 1.973683e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.739260 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1702e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.4722
    reference variance = 0.276202
====================================================
  Execution time = 4.5262e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9593e-01
  Total weights = 2.0000e+06
  Execution time = 3.8312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496049947966
                                         uncertainty =       0.003599905720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496049947966
                                         uncertainty =       0.003599905720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497963288
  error estimate for blocks of size 2^( 2) =       0.000524764801
  error estimate for blocks of size 2^( 3) =       0.000549937386
  error estimate for blocks of size 2^( 4) =       0.000568739261
  error estimate for blocks of size 2^( 5) =       0.000579666343
  error estimate for blocks of size 2^( 6) =       0.000586375066
  error estimate for blocks of size 2^( 7) =       0.000590443166

      target function =      -0.709898344552
              le_mean =     -22.427452039120
             les_mean =     503.486539590512
             stat err =       0.000581305959
             autocorr =       1.362745947495
   target nu stat err =       0.000581305959
   target dn stat err =       0.003674001752
      target stat err =       0.002737251567
              std dev =       0.704226434780
             le_variance =       0.495934871443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496049947966
                                         uncertainty =       0.003599905720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496049947966
                                         uncertainty =       0.003599905720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497963288
  error estimate for blocks of size 2^( 2) =       0.000524764801
  error estimate for blocks of size 2^( 3) =       0.000549937386
  error estimate for blocks of size 2^( 4) =       0.000568739261
  error estimate for blocks of size 2^( 5) =       0.000579666343
  error estimate for blocks of size 2^( 6) =       0.000586375066
  error estimate for blocks of size 2^( 7) =       0.000590443166

      target function =      -0.709898344552
              le_mean =     -22.427452039120
             les_mean =     503.486539590512
             stat err =       0.000581305959
             autocorr =       1.362745947496
   target nu stat err =       0.000581305959
   target dn stat err =       0.003674001752
      target stat err =       0.002737251567
              std dev =       0.704226434780
             le_variance =       0.495934871443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496049947966
                                         uncertainty =       0.003599905720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496049947966
                                         uncertainty =       0.003599905720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497963288
  error estimate for blocks of size 2^( 2) =       0.000524764801
  error estimate for blocks of size 2^( 3) =       0.000549937386
  error estimate for blocks of size 2^( 4) =       0.000568739261
  error estimate for blocks of size 2^( 5) =       0.000579666343
  error estimate for blocks of size 2^( 6) =       0.000586375066
  error estimate for blocks of size 2^( 7) =       0.000590443166

      target function =      -0.709898344552
              le_mean =     -22.427452039120
             les_mean =     503.486539590512
             stat err =       0.000581305959
             autocorr =       1.362745947495
   target nu stat err =       0.000581305959
   target dn stat err =       0.003674001752
      target stat err =       0.002737251567
              std dev =       0.704226434780
             le_variance =       0.495934871443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496049947966
                                         uncertainty =       0.003599905720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496049947966
                                         uncertainty =       0.003599905720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497963288
  error estimate for blocks of size 2^( 2) =       0.000524764801
  error estimate for blocks of size 2^( 3) =       0.000549937386
  error estimate for blocks of size 2^( 4) =       0.000568739261
  error estimate for blocks of size 2^( 5) =       0.000579666343
  error estimate for blocks of size 2^( 6) =       0.000586375066
  error estimate for blocks of size 2^( 7) =       0.000590443166

      target function =      -0.709898344552
              le_mean =     -22.427452039120
             les_mean =     503.486539590512
             stat err =       0.000581305959
             autocorr =       1.362745947495
   target nu stat err =       0.000581305959
   target dn stat err =       0.003674001752
      target stat err =       0.002737251567
              std dev =       0.704226434780
             le_variance =       0.495934871443


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.709898344552        initial  <--
     2.5000e+09     2.5000e+10             3.2441e-13        -0.709898344552
     1.0000e+10     1.0000e+11             8.0278e-14        -0.709898344552
     4.0000e+10     4.0000e+11             1.9737e-14        -0.709898344552

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.6566
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2946e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2431e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.4747
    reference variance = 0.964393
====================================================
  Execution time = 4.6438e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9601e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5214e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496002508845
                                         uncertainty =       0.003500808695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496002508845
                                         uncertainty =       0.003500808695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498002626
  error estimate for blocks of size 2^( 2) =       0.000524204657
  error estimate for blocks of size 2^( 3) =       0.000549952474
  error estimate for blocks of size 2^( 4) =       0.000570205823
  error estimate for blocks of size 2^( 5) =       0.000583429795
  error estimate for blocks of size 2^( 6) =       0.000590919133
  error estimate for blocks of size 2^( 7) =       0.000594880657

      target function =      -0.709840858353
              le_mean =     -22.427441560294
             les_mean =     503.486147923773
             stat err =       0.000584858852
             autocorr =       1.379236903923
   target nu stat err =       0.000584858852
   target dn stat err =       0.003768916555
      target stat err =       0.002804951073
              std dev =       0.704282068036
             le_variance =       0.496013231356


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242744156029e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+10, overlap shift 2.5000e+11 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709851055349       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709851055349       residual = 7.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709851055349       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709851055349       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709851055349       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709851315948       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709836502039       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709794178202       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709854636253       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709808031895       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709833893930       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.709851793591       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.709795514515       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.709889608165       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.709802292323       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.709840685708       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.709853360000       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.709777977928       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.709735837377       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.709941119457       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.709856036235       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.709843982683       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.709816522624       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.709965843618       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.709951511253       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.709812621794       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.709712393228       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.709911006379       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.709822487211       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.709801433351       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.709882223775       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.709824398970       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.709810035977       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.709889528769       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.709710875246       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.709881034711       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.709674506549       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.710104105886       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.710100754938       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.709395021461       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.710038915271       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.710106391771       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.709083277864       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.709511059276       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.710034813550       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.709698695933       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.709150636568       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.709602251545       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.708930971822       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.709943210158       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.708875813004       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.708592515422       residual = 9.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.713540683876       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.739450275678       residual = 4.49e-01           smallest_sin_value = 9.99e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+10 is 2.286943e-14

solving harmonic davidson linear method for identity shift 1.0000e+11, overlap shift 1.0000e+12 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709851055349       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709851055349       residual = 7.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709851055349       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709851055349       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709851055349       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709851055421       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709850730502       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709869329747       residual = 7.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709628134838       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709731345493       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709949014671       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.709890715904       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.709712058919       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.709785277710       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.709468692269       residual = 8.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.709979894113       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.710172707198       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.709799441525       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.709867796526       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.709377829995       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.709548324456       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.709893718683       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.709451936400       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.709375310680       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.709839442499       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.710206491021       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.710181565260       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.709602385855       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.709064816149       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.710387548350       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.709845104189       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.709909855862       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.709783599117       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.708087677399       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.708867489584       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.709624527947       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.708592849688       residual = 8.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.710290933728       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.710002642843       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.710107647086       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.710218425955       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.710523684660       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.707695192220       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.708619410084       residual = 9.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.709263942932       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.708146274111       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.710889333668       residual = 5.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.714922895089       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.713110670838       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.713083148301       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.703415343434       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.699485856727       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.737028599866       residual = 3.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.864045216364       residual = 1.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.637893304939       residual = 4.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   55 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+11 is 6.034471e-15

solving harmonic davidson linear method for identity shift 4.0000e+11, overlap shift 4.0000e+12 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709851055349       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709851055349       residual = 7.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709851055349       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709851055349       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709851055349       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709851057487       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709879286643       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709793593820       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710692465807       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710663233984       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709620505816       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.709614795835       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.710097716305       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.710024772012       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.709612709013       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.709163157707       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.709446650899       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.710126691714       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.708068668202       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.711503822724       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.712199611831       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.712924898785       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.708879461078       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.710232930563       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.710804026133       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.711348097417       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.710451758970       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.707127298063       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.713085334284       residual = 5.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.714622358481       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.708949580782       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.714946440828       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.705949106242       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.712955101573       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.713145218510       residual = 5.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.707649936216       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.711656573183       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.711343731154       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.713676098794       residual = 7.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.708337852931       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.709318360490       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.713220526535       residual = 6.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.697243972147       residual = 8.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.703736825196       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.722255571170       residual = 8.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.700225408167       residual = 4.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.699869260483       residual = 5.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.649684736120       residual = 2.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.660989219775       residual = 1.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.664344832698       residual = 1.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.687375318431       residual = 4.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.860086317577       residual = 1.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.831222989434       residual = 8.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.788392205714       residual = 3.83e+00           smallest_sin_value = 9.97e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.69e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+11 is 9.821504e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.916169 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1836e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.3922
    reference variance = 0.374669
====================================================
  Execution time = 4.5417e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9335e-01
  Total weights = 2.0000e+06
  Execution time = 3.8220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493385022607
                                         uncertainty =       0.003158754664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493385022607
                                         uncertainty =       0.003158754664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496662016
  error estimate for blocks of size 2^( 2) =       0.000523424801
  error estimate for blocks of size 2^( 3) =       0.000548947072
  error estimate for blocks of size 2^( 4) =       0.000568088249
  error estimate for blocks of size 2^( 5) =       0.000581117990
  error estimate for blocks of size 2^( 6) =       0.000588524752
  error estimate for blocks of size 2^( 7) =       0.000591448690

      target function =      -0.711790927781
              le_mean =     -22.427234766594
             les_mean =     503.474205344750
             stat err =       0.000582294920
             autocorr =       1.374561289638
   target nu stat err =       0.000582294920
   target dn stat err =       0.003207817848
      target stat err =       0.002419441149
              std dev =       0.702386158393
             le_variance =       0.493346315502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493385022607
                                         uncertainty =       0.003158754664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493385022607
                                         uncertainty =       0.003158754664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496662016
  error estimate for blocks of size 2^( 2) =       0.000523424801
  error estimate for blocks of size 2^( 3) =       0.000548947072
  error estimate for blocks of size 2^( 4) =       0.000568088249
  error estimate for blocks of size 2^( 5) =       0.000581117990
  error estimate for blocks of size 2^( 6) =       0.000588524752
  error estimate for blocks of size 2^( 7) =       0.000591448690

      target function =      -0.711790927781
              le_mean =     -22.427234766594
             les_mean =     503.474205344750
             stat err =       0.000582294920
             autocorr =       1.374561289637
   target nu stat err =       0.000582294920
   target dn stat err =       0.003207817848
      target stat err =       0.002419441149
              std dev =       0.702386158393
             le_variance =       0.493346315502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493385022607
                                         uncertainty =       0.003158754664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493385022607
                                         uncertainty =       0.003158754664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496662016
  error estimate for blocks of size 2^( 2) =       0.000523424801
  error estimate for blocks of size 2^( 3) =       0.000548947072
  error estimate for blocks of size 2^( 4) =       0.000568088249
  error estimate for blocks of size 2^( 5) =       0.000581117990
  error estimate for blocks of size 2^( 6) =       0.000588524752
  error estimate for blocks of size 2^( 7) =       0.000591448690

      target function =      -0.711790927781
              le_mean =     -22.427234766594
             les_mean =     503.474205344750
             stat err =       0.000582294920
             autocorr =       1.374561289642
   target nu stat err =       0.000582294920
   target dn stat err =       0.003207817848
      target stat err =       0.002419441149
              std dev =       0.702386158393
             le_variance =       0.493346315502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493385022607
                                         uncertainty =       0.003158754664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493385022607
                                         uncertainty =       0.003158754664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496662016
  error estimate for blocks of size 2^( 2) =       0.000523424801
  error estimate for blocks of size 2^( 3) =       0.000548947072
  error estimate for blocks of size 2^( 4) =       0.000568088249
  error estimate for blocks of size 2^( 5) =       0.000581117990
  error estimate for blocks of size 2^( 6) =       0.000588524752
  error estimate for blocks of size 2^( 7) =       0.000591448690

      target function =      -0.711790927781
              le_mean =     -22.427234766594
             les_mean =     503.474205344750
             stat err =       0.000582294920
             autocorr =       1.374561289642
   target nu stat err =       0.000582294920
   target dn stat err =       0.003207817848
      target stat err =       0.002419441149
              std dev =       0.702386158393
             le_variance =       0.493346315502


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.711790927781        initial
     2.5000e+10     2.5000e+11             2.2869e-14        -0.711790927781
     1.0000e+11     1.0000e+12             6.0345e-15        -0.711790927781
     4.0000e+11     4.0000e+12             9.8215e-16        -0.711790927781  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+11     and shift_s =   4.0000e+12
*****************************************************************************

  Execution time = 6.8225e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3028e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2431e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.4152
    reference variance = 0.335371
====================================================
  Execution time = 4.6174e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9218e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5462e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492299911632
                                         uncertainty =       0.003131182493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492299911632
                                         uncertainty =       0.003131182493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496074338
  error estimate for blocks of size 2^( 2) =       0.000523212765
  error estimate for blocks of size 2^( 3) =       0.000549104974
  error estimate for blocks of size 2^( 4) =       0.000567730327
  error estimate for blocks of size 2^( 5) =       0.000579190800
  error estimate for blocks of size 2^( 6) =       0.000584827874
  error estimate for blocks of size 2^( 7) =       0.000589748360

      target function =      -0.712639240105
              le_mean =     -22.427644749877
             les_mean =     503.491428278976
             stat err =       0.000580374340
             autocorr =       1.368746059872
   target nu stat err =       0.000580374340
   target dn stat err =       0.003262679740
      target stat err =       0.002464982655
              std dev =       0.701555057282
             le_variance =       0.492179498398


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242764474988e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+11, overlap shift 1.0000e+12 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712646862540       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712646862540       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712646862540       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712646862540       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712591062826       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712620314817       residual = 9.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712499077286       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712636522629       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712569864363       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712609234825       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.712544342885       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.712708081887       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.713019381048       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.712639372095       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.712660964228       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.712583931209       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.712597235554       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.712445160564       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.712818175561       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.712634527752       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.712605640066       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.712773910965       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.712375339507       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.712892427328       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.712833319797       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.712606915117       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.712547933458       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.712556418534       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.712369703225       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.712344365072       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.713549457562       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.713225738976       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.712896752161       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.714380537932       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.713359768257       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.712440695032       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.714303035754       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.714518708617       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.710889092886       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.711450096281       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.713900079311       residual = 8.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.712714061176       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.712684392292       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.712522811030       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.712052269798       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.711369165995       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.710178248974       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.713054797156       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.711903723482       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.714862791849       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.710276325361       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.710192118062       residual = 3.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.726703692574       residual = 9.78e-02           smallest_sin_value = 9.99e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.55e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+11 is 3.769642e-15

solving harmonic davidson linear method for identity shift 4.0000e+11, overlap shift 4.0000e+12 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712646862540       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712646862540       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712646862540       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712646862540       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712648834430       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712646805982       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712528461618       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712234973833       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712088760986       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713066134703       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713335084216       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.712610776182       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.712545004748       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.712618089933       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.713443180655       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.711031026509       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.711425051112       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.714186389449       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.713051118332       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.714684652470       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.712382241045       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.713211278130       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.712047378047       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.714400908001       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.715148035988       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.716461093750       residual = 7.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.713251644033       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.711582865829       residual = 6.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.707502577295       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.713391396492       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.703656795825       residual = 4.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.718159260032       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.709113556740       residual = 6.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.714138804147       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.707694200825       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.715375197396       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.710094430178       residual = 3.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.711787313607       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.714197381453       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.709263400945       residual = 7.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.712795641632       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.713478582509       residual = 8.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.714476568247       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.709626225785       residual = 5.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.717337738267       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.671749055582       residual = 8.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.699204415868       residual = 9.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.563898718694       residual = 1.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.799412802066       residual = 3.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.705735633101       residual = 1.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.001748800123       residual = 4.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.674710153121       residual = 1.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.866686567814       residual = 1.66e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.603316154665       residual = 3.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.653655844833       residual = 1.62e+01           smallest_sin_value = 9.94e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+11 is 6.362752e-16

solving harmonic davidson linear method for identity shift 1.6000e+12, overlap shift 1.6000e+13 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712646862540       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712646862540       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712646862540       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712646862540       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711689341355       residual = 7.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712603126877       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713975392659       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713450034339       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711373454899       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711452202816       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.714341396222       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.711736653055       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.712361484642       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.712563738453       residual = 8.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.713401464699       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.714118435601       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.705811262722       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.706302271625       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.703245755652       residual = 4.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.703779436199       residual = 3.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.714678981794       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.708020448661       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.715660860618       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.713682375887       residual = 9.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.702872470746       residual = 5.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.718459572836       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.701111608187       residual = 6.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.722021130069       residual = 4.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.722128258043       residual = 4.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.734519725901       residual = 2.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.702043626933       residual = 5.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.704205122445       residual = 3.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.695641290140       residual = 1.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.699107098320       residual = 9.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.713094951915       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.715862061660       residual = 9.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.710532636356       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.717922465756       residual = 3.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746953871171       residual = 6.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.700224085979       residual = 8.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.722944509552       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.693413314483       residual = 1.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.711862164139       residual = 6.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.698950519105       residual = 3.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.702163565070       residual = 8.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.734423045875       residual = 7.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.774869066353       residual = 2.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.660899300401       residual = 1.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.697595799555       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.769996851995       residual = 1.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.410494205495       residual = 4.74e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.126548895621       residual = 1.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.880725801951       residual = 2.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.939447865655       residual = 1.43e+03           smallest_sin_value = 9.97e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.70e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+12 is 5.678883e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.092760 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1819e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.3763
    reference variance = 0.359604
====================================================
  Execution time = 4.5664e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0310e-01
  Total weights = 2.0000e+06
  Execution time = 3.8190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503037277010
                                         uncertainty =       0.009139558178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503037277010
                                         uncertainty =       0.009139558178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501546486
  error estimate for blocks of size 2^( 2) =       0.000527777324
  error estimate for blocks of size 2^( 3) =       0.000553072296
  error estimate for blocks of size 2^( 4) =       0.000572723952
  error estimate for blocks of size 2^( 5) =       0.000585395237
  error estimate for blocks of size 2^( 6) =       0.000593536362
  error estimate for blocks of size 2^( 7) =       0.000594493574

      target function =      -0.704676107857
              le_mean =     -22.427463533313
             les_mean =     503.494218041713
             stat err =       0.000586537281
             autocorr =       1.367630758483
   target nu stat err =       0.000586537281
   target dn stat err =       0.009109861943
      target stat err =       0.006555267204
              std dev =       0.709293842634
             le_variance =       0.503097755198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503037277010
                                         uncertainty =       0.009139558178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503037277010
                                         uncertainty =       0.009139558178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501546486
  error estimate for blocks of size 2^( 2) =       0.000527777324
  error estimate for blocks of size 2^( 3) =       0.000553072296
  error estimate for blocks of size 2^( 4) =       0.000572723952
  error estimate for blocks of size 2^( 5) =       0.000585395237
  error estimate for blocks of size 2^( 6) =       0.000593536362
  error estimate for blocks of size 2^( 7) =       0.000594493574

      target function =      -0.704676107857
              le_mean =     -22.427463533313
             les_mean =     503.494218041713
             stat err =       0.000586537281
             autocorr =       1.367630758485
   target nu stat err =       0.000586537281
   target dn stat err =       0.009109861943
      target stat err =       0.006555267204
              std dev =       0.709293842633
             le_variance =       0.503097755197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503037277010
                                         uncertainty =       0.009139558178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503037277010
                                         uncertainty =       0.009139558178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501546486
  error estimate for blocks of size 2^( 2) =       0.000527777324
  error estimate for blocks of size 2^( 3) =       0.000553072296
  error estimate for blocks of size 2^( 4) =       0.000572723952
  error estimate for blocks of size 2^( 5) =       0.000585395237
  error estimate for blocks of size 2^( 6) =       0.000593536362
  error estimate for blocks of size 2^( 7) =       0.000594493574

      target function =      -0.704676107857
              le_mean =     -22.427463533313
             les_mean =     503.494218041713
             stat err =       0.000586537281
             autocorr =       1.367630758484
   target nu stat err =       0.000586537281
   target dn stat err =       0.009109861943
      target stat err =       0.006555267204
              std dev =       0.709293842634
             le_variance =       0.503097755198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503037277010
                                         uncertainty =       0.009139558178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503037277010
                                         uncertainty =       0.009139558178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501546486
  error estimate for blocks of size 2^( 2) =       0.000527777324
  error estimate for blocks of size 2^( 3) =       0.000553072296
  error estimate for blocks of size 2^( 4) =       0.000572723952
  error estimate for blocks of size 2^( 5) =       0.000585395237
  error estimate for blocks of size 2^( 6) =       0.000593536362
  error estimate for blocks of size 2^( 7) =       0.000594493574

      target function =      -0.704676107857
              le_mean =     -22.427463533313
             les_mean =     503.494218041713
             stat err =       0.000586537281
             autocorr =       1.367630758485
   target nu stat err =       0.000586537281
   target dn stat err =       0.009109861943
      target stat err =       0.006555267204
              std dev =       0.709293842634
             le_variance =       0.503097755198


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.704676107857        initial  <--
     1.0000e+11     1.0000e+12             3.7696e-15        -0.704676107857
     4.0000e+11     4.0000e+12             6.3628e-16        -0.704676107857
     1.6000e+12     1.6000e+13             5.6789e-17        -0.704676107857

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.7449
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2657e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2429e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.4369
    reference variance = 0.428861
====================================================
  Execution time = 4.7929e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9357e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5419e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493653283584
                                         uncertainty =       0.003437340729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493653283584
                                         uncertainty =       0.003437340729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496774534
  error estimate for blocks of size 2^( 2) =       0.000523094989
  error estimate for blocks of size 2^( 3) =       0.000548367382
  error estimate for blocks of size 2^( 4) =       0.000568097670
  error estimate for blocks of size 2^( 5) =       0.000580296862
  error estimate for blocks of size 2^( 6) =       0.000588042282
  error estimate for blocks of size 2^( 7) =       0.000590599950

      target function =      -0.711643628122
              le_mean =     -22.425952320484
             les_mean =     503.416907108717
             stat err =       0.000581759191
             autocorr =       1.371411722944
   target nu stat err =       0.000581759191
   target dn stat err =       0.003291578284
      target stat err =       0.002473101645
              std dev =       0.702545283162
             le_variance =       0.493569874893


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242595232048e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+12, overlap shift 1.0000e+13 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711651183926       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711651183926       residual = 7.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711651183926       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711651183926       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711651183926       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711651183926       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710566135829       residual = 8.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713436732220       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709955261428       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713634737120       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.711688993955       residual = 6.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.711923833203       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.712677759461       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.710868610650       residual = 8.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.710063301190       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.712974329845       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.696065023118       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.712240682611       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.712217901457       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.712899722470       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.713698066784       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.714648924881       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.710139216171       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.709570291149       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.714838953421       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.713684277594       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.709334241522       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.703333290029       residual = 3.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.705832343681       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.715126251640       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.704175782024       residual = 3.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.720987781533       residual = 4.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.703900049257       residual = 2.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.723445657164       residual = 7.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.712110143265       residual = 9.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.715155050754       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.714613356970       residual = 3.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.708659718304       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.720236992290       residual = 3.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.715131854623       residual = 9.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.708889528941       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.721141458746       residual = 4.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.712365597144       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.704598372152       residual = 5.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.696655677035       residual = 1.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.728511647544       residual = 2.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.718887388237       residual = 1.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.716711157857       residual = 5.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.626754616108       residual = 7.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.748851386075       residual = 8.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.563835609726       residual = 1.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -1.280964413396       residual = 1.85e+02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.793799041422       residual = 6.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.857379968447       residual = 1.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -1.778650830697       residual = 6.30e+02           smallest_sin_value = 9.91e-01
davidson iteration   55 stopping due to small subspace S singular value of 6.74e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+12 is 1.445634e-16

solving harmonic davidson linear method for identity shift 4.0000e+12, overlap shift 4.0000e+13 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711651183926       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711651183926       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.6000e+13, overlap shift 1.6000e+14 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711651183926       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711651183926       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.157767 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3418e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.4767
    reference variance = 0.414026
====================================================
  Execution time = 4.5178e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9748e-01
  Total weights = 2.0000e+06
  Execution time = 3.8226e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497465565462
                                         uncertainty =       0.004851618770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497465565462
                                         uncertainty =       0.004851618770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498739735
  error estimate for blocks of size 2^( 2) =       0.000525252816
  error estimate for blocks of size 2^( 3) =       0.000550760275
  error estimate for blocks of size 2^( 4) =       0.000570823317
  error estimate for blocks of size 2^( 5) =       0.000582918401
  error estimate for blocks of size 2^( 6) =       0.000591380877
  error estimate for blocks of size 2^( 7) =       0.000597070081

      target function =      -0.708784742129
              le_mean =     -22.426419252383
             les_mean =     503.441762881987
             stat err =       0.000585548169
             autocorr =       1.378406503550
   target nu stat err =       0.000585548169
   target dn stat err =       0.004899701532
      target stat err =       0.003596656514
              std dev =       0.705324497719
             le_variance =       0.497482647083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497465565462
                                         uncertainty =       0.004851618770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497465565462
                                         uncertainty =       0.004851618770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498739735
  error estimate for blocks of size 2^( 2) =       0.000525252816
  error estimate for blocks of size 2^( 3) =       0.000550760275
  error estimate for blocks of size 2^( 4) =       0.000570823317
  error estimate for blocks of size 2^( 5) =       0.000582918401
  error estimate for blocks of size 2^( 6) =       0.000591380877
  error estimate for blocks of size 2^( 7) =       0.000597070081

      target function =      -0.708784742129
              le_mean =     -22.426419252383
             les_mean =     503.441762881987
             stat err =       0.000585548169
             autocorr =       1.378406503550
   target nu stat err =       0.000585548169
   target dn stat err =       0.004899701532
      target stat err =       0.003596656514
              std dev =       0.705324497719
             le_variance =       0.497482647083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497465565462
                                         uncertainty =       0.004851618770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497465565462
                                         uncertainty =       0.004851618770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498739735
  error estimate for blocks of size 2^( 2) =       0.000525252816
  error estimate for blocks of size 2^( 3) =       0.000550760275
  error estimate for blocks of size 2^( 4) =       0.000570823317
  error estimate for blocks of size 2^( 5) =       0.000582918401
  error estimate for blocks of size 2^( 6) =       0.000591380877
  error estimate for blocks of size 2^( 7) =       0.000597070081

      target function =      -0.708784742129
              le_mean =     -22.426419252383
             les_mean =     503.441762881987
             stat err =       0.000585548169
             autocorr =       1.378406503550
   target nu stat err =       0.000585548169
   target dn stat err =       0.004899701532
      target stat err =       0.003596656514
              std dev =       0.705324497719
             le_variance =       0.497482647083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497465565462
                                         uncertainty =       0.004851618770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497465565462
                                         uncertainty =       0.004851618770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498739735
  error estimate for blocks of size 2^( 2) =       0.000525252816
  error estimate for blocks of size 2^( 3) =       0.000550760275
  error estimate for blocks of size 2^( 4) =       0.000570823317
  error estimate for blocks of size 2^( 5) =       0.000582918401
  error estimate for blocks of size 2^( 6) =       0.000591380877
  error estimate for blocks of size 2^( 7) =       0.000597070081

      target function =      -0.708784742129
              le_mean =     -22.426419252383
             les_mean =     503.441762881987
             stat err =       0.000585548169
             autocorr =       1.378406503550
   target nu stat err =       0.000585548169
   target dn stat err =       0.004899701532
      target stat err =       0.003596656514
              std dev =       0.705324497719
             le_variance =       0.497482647083


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.708784742129        initial  <--
     1.0000e+12     1.0000e+13             1.4456e-16        -0.708784742129
     4.0000e+12     4.0000e+13             0.0000e+00        -0.708784742129
     1.6000e+13     1.6000e+14             0.0000e+00        -0.708784742129

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.3388
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2777e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2431e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.4319
    reference variance = 1.09426
====================================================
  Execution time = 4.7588e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9707e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5360e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497023536182
                                         uncertainty =       0.003604130524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497023536182
                                         uncertainty =       0.003604130524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498534290
  error estimate for blocks of size 2^( 2) =       0.000524653975
  error estimate for blocks of size 2^( 3) =       0.000550588791
  error estimate for blocks of size 2^( 4) =       0.000569747897
  error estimate for blocks of size 2^( 5) =       0.000581896152
  error estimate for blocks of size 2^( 6) =       0.000587381708
  error estimate for blocks of size 2^( 7) =       0.000588348899

      target function =      -0.709083460459
              le_mean =     -22.426809752935
             les_mean =     503.458868321445
             stat err =       0.000581843664
             autocorr =       1.362142519209
   target nu stat err =       0.000581843664
   target dn stat err =       0.003527411900
      target stat err =       0.002625109390
              std dev =       0.705033953527
             le_variance =       0.497072875626


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242680975294e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+13, overlap shift 1.0000e+14 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709092246213       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709092246213       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709092246213       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709092246218       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709092246267       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.702064642141       residual = 2.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707264025687       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.727914806277       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.720889589437       residual = 8.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.706687608566       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.698401922163       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.719310258140       residual = 8.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.714919293975       residual = 2.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.714162183262       residual = 1.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.728462472986       residual = 2.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.727583044923       residual = 2.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.708723979691       residual = 3.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.704866589591       residual = 4.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.708868317388       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742777445381       residual = 6.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.730345205831       residual = 2.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743219828598       residual = 6.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.683366645881       residual = 3.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.680533603202       residual = 5.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.684984461418       residual = 6.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.647630747762       residual = 2.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.684304819672       residual = 7.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.770055059948       residual = 2.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.809471701025       residual = 5.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.752113996636       residual = 1.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.830577887661       residual = 7.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.829265245515       residual = 7.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.756286597661       residual = 1.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.672503208570       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.786790325059       residual = 3.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.605911829272       residual = 6.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.900858109799       residual = 2.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.068279861382       residual = 6.44e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.440092261807       residual = 4.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.948616658761       residual = 3.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.595141549540       residual = 8.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.964297433869       residual = 3.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.825916958190       residual = 7.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.635289163112       residual = 4.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.726444118281       residual = 3.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.356295451791       residual = 6.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.576022056295       residual = 1.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -1.028464426465       residual = 6.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.160411034234       residual = 1.61e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -1.076079119542       residual = 1.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.479219296686       residual = 5.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -2.467872417175       residual = 2.16e+03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =       0.543100045438       residual = 1.06e+03           smallest_sin_value = 1.00e+00
davidson iteration   53 stopping due to too large eigenvalue change
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+13 is 7.056769e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+13, overlap shift 4.0000e+14 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709092246213       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709092246213       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709092246213       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709092246213       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709092246213       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709626779616       residual = 1.43e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.680544311058       residual = 4.14e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.756430943667       residual = 1.20e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.725223601873       residual = 6.57e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.699717208316       residual = 6.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.686635689386       residual = 2.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.711368570024       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.686629121577       residual = 8.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.732953440953       residual = 3.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.630025674042       residual = 3.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.783446006325       residual = 3.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.784545245264       residual = 4.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.797589737310       residual = 4.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.679790676015       residual = 1.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.718204422132       residual = 5.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.596091045059       residual = 6.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.005586897114       residual = 4.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.500344380500       residual = 2.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.767584571996       residual = 2.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.767031474520       residual = 2.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.926520545163       residual = 2.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.669785448977       residual = 1.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.380245807859       residual = 5.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.989282474833       residual = 4.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.765830554019       residual = 7.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.472481008004       residual = 4.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.190780964814       residual = 1.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.659181854628       residual = 4.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.107330062941       residual = 1.88e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.008306185961       residual = 5.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.721643518333       residual = 4.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.504660364923       residual = 2.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.342844396548       residual = 7.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.836982171834       residual = 2.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.510224771251       residual = 2.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.461894191114       residual = 3.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.529067436045       residual = 3.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.728765598005       residual = 4.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.797477528118       residual = 7.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.287493923786       residual = 1.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.406602197223       residual = 6.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -1.067641243481       residual = 9.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.841186490428       residual = 4.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.855710461239       residual = 8.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -5.927678279674       residual = 1.52e+04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -6.937052527385       residual = 2.26e+04           smallest_sin_value = 1.00e+00
davidson iteration   51 stopping due to too large eigenvalue change
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+13 is 2.049993e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+14, overlap shift 1.6000e+15 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709092246213       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709092246213       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709092246213       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709092246213       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709092246233       residual = 1.90e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709092405512       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.645285819534       residual = 2.15e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.589919799499       residual = 1.04e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.457551330766       residual = 3.25e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712106832560       residual = 1.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.816887335359       residual = 2.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.645739221894       residual = 4.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.903937131033       residual = 2.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.225828207688       residual = 1.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.140134091384       residual = 1.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.195045047558       residual = 1.83e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.451607785330       residual = 4.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -1.131192881407       residual = 9.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.647863751472       residual = 7.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.367273129910       residual = 6.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =       1.587296119357       residual = 2.70e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.543413235578       residual = 1.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.150288802536       residual = 1.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.483585773478       residual = 3.09e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =       0.193080532603       residual = 4.21e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       0.890230062057       residual = 1.27e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.159954560936       residual = 1.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.813228216871       residual = 6.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.010196314643       residual = 2.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       1.152880030031       residual = 1.67e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750500358323       residual = 8.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.118850762527       residual = 2.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.419418904434       residual = 6.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -2.031153982152       residual = 9.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       1.078864680238       residual = 1.59e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       0.788734221102       residual = 1.14e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =       3.178477288347       residual = 7.97e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.005612231024       residual = 1.96e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -3.735239313477       residual = 4.75e+03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       0.763109069067       residual = 1.32e+03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =       0.593274909416       residual = 8.30e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =       2.648574460954       residual = 6.89e+03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.109857087443       residual = 4.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -2.987334646976       residual = 2.82e+03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -2.040880770973       residual = 1.06e+03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =       6.588575489216       residual = 2.72e+04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -1.420341613306       residual = 6.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.914745634459       residual = 2.55e+03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.682812431996       residual = 3.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -5.314590682416       residual = 1.24e+04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =       8.008029607373       residual = 8.41e+04           smallest_sin_value = 1.00e+00
davidson iteration   51 stopping due to too large eigenvalue change
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+14 is 4.410480e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.315291 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3112e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.3671
    reference variance = 0.35223
====================================================
  Execution time = 4.5531e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0070e-01
  Total weights = 2.0000e+06
  Execution time = 3.8218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500719027413
                                         uncertainty =       0.005351660675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500719027413
                                         uncertainty =       0.005351660675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500347914
  error estimate for blocks of size 2^( 2) =       0.000527196033
  error estimate for blocks of size 2^( 3) =       0.000553157232
  error estimate for blocks of size 2^( 4) =       0.000573256822
  error estimate for blocks of size 2^( 5) =       0.000585207863
  error estimate for blocks of size 2^( 6) =       0.000594220543
  error estimate for blocks of size 2^( 7) =       0.000598078167

      target function =      -0.706450952625
              le_mean =     -22.426928972958
             les_mean =     503.467838977313
             stat err =       0.000587690849
             autocorr =       1.379601538016
   target nu stat err =       0.000587690849
   target dn stat err =       0.005553301080
      target stat err =       0.004040824783
              std dev =       0.707598805504
             le_variance =       0.500696069550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500719027413
                                         uncertainty =       0.005351660675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500719027413
                                         uncertainty =       0.005351660675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500347914
  error estimate for blocks of size 2^( 2) =       0.000527196033
  error estimate for blocks of size 2^( 3) =       0.000553157232
  error estimate for blocks of size 2^( 4) =       0.000573256822
  error estimate for blocks of size 2^( 5) =       0.000585207863
  error estimate for blocks of size 2^( 6) =       0.000594220543
  error estimate for blocks of size 2^( 7) =       0.000598078167

      target function =      -0.706450952625
              le_mean =     -22.426928972958
             les_mean =     503.467838977313
             stat err =       0.000587690849
             autocorr =       1.379601538011
   target nu stat err =       0.000587690849
   target dn stat err =       0.005553301080
      target stat err =       0.004040824783
              std dev =       0.707598805504
             le_variance =       0.500696069550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500719027413
                                         uncertainty =       0.005351660675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500719027413
                                         uncertainty =       0.005351660675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500347914
  error estimate for blocks of size 2^( 2) =       0.000527196033
  error estimate for blocks of size 2^( 3) =       0.000553157232
  error estimate for blocks of size 2^( 4) =       0.000573256822
  error estimate for blocks of size 2^( 5) =       0.000585207863
  error estimate for blocks of size 2^( 6) =       0.000594220543
  error estimate for blocks of size 2^( 7) =       0.000598078167

      target function =      -0.706450952625
              le_mean =     -22.426928972958
             les_mean =     503.467838977313
             stat err =       0.000587690849
             autocorr =       1.379601538011
   target nu stat err =       0.000587690849
   target dn stat err =       0.005553301080
      target stat err =       0.004040824783
              std dev =       0.707598805504
             le_variance =       0.500696069550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500719027413
                                         uncertainty =       0.005351660675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500719027413
                                         uncertainty =       0.005351660675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500347914
  error estimate for blocks of size 2^( 2) =       0.000527196033
  error estimate for blocks of size 2^( 3) =       0.000553157232
  error estimate for blocks of size 2^( 4) =       0.000573256822
  error estimate for blocks of size 2^( 5) =       0.000585207863
  error estimate for blocks of size 2^( 6) =       0.000594220543
  error estimate for blocks of size 2^( 7) =       0.000598078167

      target function =      -0.706450952625
              le_mean =     -22.426928972958
             les_mean =     503.467838977313
             stat err =       0.000587690849
             autocorr =       1.379601538016
   target nu stat err =       0.000587690849
   target dn stat err =       0.005553301080
      target stat err =       0.004040824783
              std dev =       0.707598805504
             le_variance =       0.500696069550


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706450952625        initial  <--
     1.0000e+13     1.0000e+14             7.0568e-18        -0.706450952625
     4.0000e+13     4.0000e+14             2.0500e-18        -0.706450952625
     1.6000e+14     1.6000e+15             4.4105e-19        -0.706450952625

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.6831
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2781e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2429e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.47
    reference variance = 0.474634
====================================================
  Execution time = 4.5880e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9140e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5233e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491391018147
                                         uncertainty =       0.003099135144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491391018147
                                         uncertainty =       0.003099135144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495680335
  error estimate for blocks of size 2^( 2) =       0.000522774824
  error estimate for blocks of size 2^( 3) =       0.000548298523
  error estimate for blocks of size 2^( 4) =       0.000567659243
  error estimate for blocks of size 2^( 5) =       0.000577272324
  error estimate for blocks of size 2^( 6) =       0.000583489090
  error estimate for blocks of size 2^( 7) =       0.000588590293

      target function =      -0.713220470840
              le_mean =     -22.427100268022
             les_mean =     503.466224175710
             stat err =       0.000579252737
             autocorr =       1.365629249789
   target nu stat err =       0.000579252737
   target dn stat err =       0.002932386717
      target stat err =       0.002232292437
              std dev =       0.700997852707
             le_variance =       0.491397989499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242710026802e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+14, overlap shift 1.0000e+15 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713226532663       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713226532663       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 4.0000e+14, overlap shift 4.0000e+15 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713226532663       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713226532663       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.6000e+15, overlap shift 1.6000e+16 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713226532663       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713226532663       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.316355 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1120e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.473
    reference variance = 0.496052
====================================================
  Execution time = 4.7379e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.8837e-01
  Total weights = 2.0000e+06
  Execution time = 3.8316e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488404000061
                                         uncertainty =       0.002682913617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488404000061
                                         uncertainty =       0.002682913617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494148539
  error estimate for blocks of size 2^( 2) =       0.000520908205
  error estimate for blocks of size 2^( 3) =       0.000546476803
  error estimate for blocks of size 2^( 4) =       0.000566699393
  error estimate for blocks of size 2^( 5) =       0.000579731351
  error estimate for blocks of size 2^( 6) =       0.000585892284
  error estimate for blocks of size 2^( 7) =       0.000590579449

      target function =      -0.715456284582
              le_mean =     -22.426652296392
             les_mean =     503.443098537163
             stat err =       0.000580725619
             autocorr =       1.381105768767
   target nu stat err =       0.000580725619
   target dn stat err =       0.002782809201
      target stat err =       0.002138611839
              std dev =       0.698831566312
             le_variance =       0.488365558074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488404000061
                                         uncertainty =       0.002682913617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488404000061
                                         uncertainty =       0.002682913617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494148539
  error estimate for blocks of size 2^( 2) =       0.000520908205
  error estimate for blocks of size 2^( 3) =       0.000546476803
  error estimate for blocks of size 2^( 4) =       0.000566699393
  error estimate for blocks of size 2^( 5) =       0.000579731351
  error estimate for blocks of size 2^( 6) =       0.000585892284
  error estimate for blocks of size 2^( 7) =       0.000590579449

      target function =      -0.715456284582
              le_mean =     -22.426652296392
             les_mean =     503.443098537163
             stat err =       0.000580725619
             autocorr =       1.381105768767
   target nu stat err =       0.000580725619
   target dn stat err =       0.002782809201
      target stat err =       0.002138611839
              std dev =       0.698831566312
             le_variance =       0.488365558074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488404000061
                                         uncertainty =       0.002682913617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488404000061
                                         uncertainty =       0.002682913617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494148539
  error estimate for blocks of size 2^( 2) =       0.000520908205
  error estimate for blocks of size 2^( 3) =       0.000546476803
  error estimate for blocks of size 2^( 4) =       0.000566699393
  error estimate for blocks of size 2^( 5) =       0.000579731351
  error estimate for blocks of size 2^( 6) =       0.000585892284
  error estimate for blocks of size 2^( 7) =       0.000590579449

      target function =      -0.715456284582
              le_mean =     -22.426652296392
             les_mean =     503.443098537163
             stat err =       0.000580725619
             autocorr =       1.381105768767
   target nu stat err =       0.000580725619
   target dn stat err =       0.002782809201
      target stat err =       0.002138611839
              std dev =       0.698831566312
             le_variance =       0.488365558074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488404000061
                                         uncertainty =       0.002682913617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488404000061
                                         uncertainty =       0.002682913617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494148539
  error estimate for blocks of size 2^( 2) =       0.000520908205
  error estimate for blocks of size 2^( 3) =       0.000546476803
  error estimate for blocks of size 2^( 4) =       0.000566699393
  error estimate for blocks of size 2^( 5) =       0.000579731351
  error estimate for blocks of size 2^( 6) =       0.000585892284
  error estimate for blocks of size 2^( 7) =       0.000590579449

      target function =      -0.715456284582
              le_mean =     -22.426652296392
             les_mean =     503.443098537163
             stat err =       0.000580725619
             autocorr =       1.381105768767
   target nu stat err =       0.000580725619
   target dn stat err =       0.002782809201
      target stat err =       0.002138611839
              std dev =       0.698831566312
             le_variance =       0.488365558074


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.715456284582        initial  <--
     1.0000e+14     1.0000e+15             0.0000e+00        -0.715456284582
     4.0000e+14     4.0000e+15             0.0000e+00        -0.715456284582
     1.6000e+15     1.6000e+16             0.0000e+00        -0.715456284582

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.6233
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2775e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2431e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.4409
    reference variance = 0.45556
====================================================
  Execution time = 4.7057e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.8806e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5139e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488158944984
                                         uncertainty =       0.003211258017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488158944984
                                         uncertainty =       0.003211258017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493991844
  error estimate for blocks of size 2^( 2) =       0.000520780297
  error estimate for blocks of size 2^( 3) =       0.000545733429
  error estimate for blocks of size 2^( 4) =       0.000565123632
  error estimate for blocks of size 2^( 5) =       0.000578081683
  error estimate for blocks of size 2^( 6) =       0.000583101077
  error estimate for blocks of size 2^( 7) =       0.000586800646

      target function =      -0.715678979147
              le_mean =     -22.427206909682
             les_mean =     503.467665409548
             stat err =       0.000578276760
             autocorr =       1.370351312775
   target nu stat err =       0.000578276760
   target dn stat err =       0.003156708716
      target stat err =       0.002407421189
              std dev =       0.698609965489
             le_variance =       0.488055883881


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242720690968e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+15, overlap shift 1.0000e+16 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.715686065345       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.715686065345       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.715686065345       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.715686065344       residual = 2.40e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.715686065345       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.715686065345       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714855048778       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.724278201636       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -2.729559687053       residual = 2.03e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -2.537294033463       residual = 2.52e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       0.049019476845       residual = 5.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.587484462879       residual = 8.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.955092570858       residual = 7.67e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.064104618885       residual = 5.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =       0.312480904697       residual = 1.21e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =       3.311797766692       residual = 8.02e+03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =       1.390327415099       residual = 3.32e+03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =       0.413814268810       residual = 7.73e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -3.681824153199       residual = 4.95e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.520016556990       residual = 1.02e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -5.591245065540       residual = 1.43e+04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =       0.758943651041       residual = 1.85e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -4.372094031079       residual = 7.98e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.138675769471       residual = 1.36e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =       2.819199929780       residual = 8.39e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       2.976442831761       residual = 7.89e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -4.169095713129       residual = 6.01e+03           smallest_sin_value = 1.00e+00
davidson iteration   27 stopping due to too large eigenvalue change
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+15 is 1.310814e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+15, overlap shift 4.0000e+16 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.715686065345       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.715686065345       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.715686065345       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.715686065345       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.715686065345       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.715686065345       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.715686063700       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.716496054776       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -5.451414482457       residual = 1.12e+04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -6.881012104611       residual = 1.91e+04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -6.120983620978       residual = 4.77e+04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.001463531251       residual = 1.69e+04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =       3.110056740405       residual = 1.72e+04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =       6.017240596920       residual = 4.47e+04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =       2.608588860600       residual = 8.73e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =       7.935550128474       residual = 4.33e+04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.149861328436       residual = 4.41e+03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =       2.936235524463       residual = 8.25e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -1.984077547496       residual = 2.57e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =       7.632732686752       residual = 3.62e+04           smallest_sin_value = 1.00e+00
davidson iteration   20 stopping due to too large eigenvalue change
davidson solver did not converge after         20 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+15 is 3.277036e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+16, overlap shift 1.6000e+17 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.715686065345       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.715686065345       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.715686065345       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.715686065345       residual = 8.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.987973694912       residual = 3.93e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.116023615726       residual = 3.40e+02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.436787505517       residual = 6.84e+04           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+16 is 3.837140e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.330915 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2217e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.4196
    reference variance = 0.398702
====================================================
  Execution time = 4.6730e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9951e-01
  Total weights = 2.0000e+06
  Execution time = 3.8233e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499599324034
                                         uncertainty =       0.003492907631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499599324034
                                         uncertainty =       0.003492907631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499756393
  error estimate for blocks of size 2^( 2) =       0.000526098603
  error estimate for blocks of size 2^( 3) =       0.000551683403
  error estimate for blocks of size 2^( 4) =       0.000571412585
  error estimate for blocks of size 2^( 5) =       0.000584221711
  error estimate for blocks of size 2^( 6) =       0.000589605544
  error estimate for blocks of size 2^( 7) =       0.000595732665

      target function =      -0.707316297444
              le_mean =     -22.427018705274
             les_mean =     503.470680661836
             stat err =       0.000585243126
             autocorr =       1.371374047187
   target nu stat err =       0.000585243126
   target dn stat err =       0.003310208586
      target stat err =       0.002461647583
              std dev =       0.706762269000
             le_variance =       0.499512904882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499599324034
                                         uncertainty =       0.003492907631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499599324034
                                         uncertainty =       0.003492907631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499756393
  error estimate for blocks of size 2^( 2) =       0.000526098603
  error estimate for blocks of size 2^( 3) =       0.000551683403
  error estimate for blocks of size 2^( 4) =       0.000571412585
  error estimate for blocks of size 2^( 5) =       0.000584221711
  error estimate for blocks of size 2^( 6) =       0.000589605544
  error estimate for blocks of size 2^( 7) =       0.000595732665

      target function =      -0.707316297444
              le_mean =     -22.427018705274
             les_mean =     503.470680661836
             stat err =       0.000585243126
             autocorr =       1.371374047187
   target nu stat err =       0.000585243126
   target dn stat err =       0.003310208586
      target stat err =       0.002461647583
              std dev =       0.706762269000
             le_variance =       0.499512904882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499599324034
                                         uncertainty =       0.003492907631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499599324034
                                         uncertainty =       0.003492907631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499756393
  error estimate for blocks of size 2^( 2) =       0.000526098603
  error estimate for blocks of size 2^( 3) =       0.000551683403
  error estimate for blocks of size 2^( 4) =       0.000571412585
  error estimate for blocks of size 2^( 5) =       0.000584221711
  error estimate for blocks of size 2^( 6) =       0.000589605544
  error estimate for blocks of size 2^( 7) =       0.000595732665

      target function =      -0.707316297444
              le_mean =     -22.427018705274
             les_mean =     503.470680661836
             stat err =       0.000585243126
             autocorr =       1.371374047187
   target nu stat err =       0.000585243126
   target dn stat err =       0.003310208586
      target stat err =       0.002461647583
              std dev =       0.706762269000
             le_variance =       0.499512904882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499599324034
                                         uncertainty =       0.003492907631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499599324034
                                         uncertainty =       0.003492907631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499756393
  error estimate for blocks of size 2^( 2) =       0.000526098603
  error estimate for blocks of size 2^( 3) =       0.000551683403
  error estimate for blocks of size 2^( 4) =       0.000571412585
  error estimate for blocks of size 2^( 5) =       0.000584221711
  error estimate for blocks of size 2^( 6) =       0.000589605544
  error estimate for blocks of size 2^( 7) =       0.000595732665

      target function =      -0.707316297444
              le_mean =     -22.427018705274
             les_mean =     503.470680661836
             stat err =       0.000585243126
             autocorr =       1.371374047187
   target nu stat err =       0.000585243126
   target dn stat err =       0.003310208586
      target stat err =       0.002461647583
              std dev =       0.706762269000
             le_variance =       0.499512904882


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707316297444        initial  <--
     1.0000e+15     1.0000e+16             1.3108e-19        -0.707316297444
     4.0000e+15     4.0000e+16             3.2770e-20        -0.707316297444
     1.6000e+16     1.6000e+17             3.8371e-21        -0.707316297444

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.9847
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2832e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2431e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.3756
    reference variance = 0.538165
====================================================
  Execution time = 4.5794e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9682e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5268e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496859916282
                                         uncertainty =       0.005150657770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496859916282
                                         uncertainty =       0.005150657770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498406856
  error estimate for blocks of size 2^( 2) =       0.000525070056
  error estimate for blocks of size 2^( 3) =       0.000550653518
  error estimate for blocks of size 2^( 4) =       0.000570733774
  error estimate for blocks of size 2^( 5) =       0.000583803085
  error estimate for blocks of size 2^( 6) =       0.000592317548
  error estimate for blocks of size 2^( 7) =       0.000595480860

      target function =      -0.709264368988
              le_mean =     -22.426383252602
             les_mean =     503.439484331538
             stat err =       0.000585583817
             autocorr =       1.380416422601
   target nu stat err =       0.000585583817
   target dn stat err =       0.005101065529
      target stat err =       0.003745281792
              std dev =       0.704853734725
             le_variance =       0.496818787355


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242638325260e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+16, overlap shift 1.0000e+17 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709283310793       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709283310793       residual = 9.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709283310793       residual = 7.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.280945053866       residual = 1.03e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709283310790       residual = 3.77e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       5.143121068931       residual = 1.74e+04           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+16 is 9.315371e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+16, overlap shift 4.0000e+17 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709283310793       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709283310793       residual = 9.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709283310793       residual = 7.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709283310793       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709283310910       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       4.478452576724       residual = 1.36e+04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.869825289383       residual = 1.34e+01           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+16 is 3.074258e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+17, overlap shift 1.6000e+18 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709283310793       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709283310793       residual = 9.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709283310793       residual = 7.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709283310793       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709283310793       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709283310793       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707738101421       residual = 5.44e-01           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+17 is 9.769506e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.333481 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1071e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.3494
    reference variance = 0.503164
====================================================
  Execution time = 4.5410e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2428e+01
  VMC Evar = 5.0115e-01
  Total weights = 2.0000e+06
  Execution time = 3.8130e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501191075545
                                         uncertainty =       0.004888324316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501191075545
                                         uncertainty =       0.004888324316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500576568
  error estimate for blocks of size 2^( 2) =       0.000527114458
  error estimate for blocks of size 2^( 3) =       0.000552697935
  error estimate for blocks of size 2^( 4) =       0.000572928168
  error estimate for blocks of size 2^( 5) =       0.000586027888
  error estimate for blocks of size 2^( 6) =       0.000592047812
  error estimate for blocks of size 2^( 7) =       0.000595988664

      target function =      -0.706112654166
              le_mean =     -22.427542530804
             les_mean =     503.495817522210
             stat err =       0.000586748133
             autocorr =       1.373923017587
   target nu stat err =       0.000586748133
   target dn stat err =       0.005073110710
      target stat err =       0.003699040473
              std dev =       0.707922172115
             le_variance =       0.501153801772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501191075545
                                         uncertainty =       0.004888324316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501191075545
                                         uncertainty =       0.004888324316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500576568
  error estimate for blocks of size 2^( 2) =       0.000527114458
  error estimate for blocks of size 2^( 3) =       0.000552697935
  error estimate for blocks of size 2^( 4) =       0.000572928168
  error estimate for blocks of size 2^( 5) =       0.000586027888
  error estimate for blocks of size 2^( 6) =       0.000592047812
  error estimate for blocks of size 2^( 7) =       0.000595988664

      target function =      -0.706112654166
              le_mean =     -22.427542530804
             les_mean =     503.495817522210
             stat err =       0.000586748133
             autocorr =       1.373923017587
   target nu stat err =       0.000586748133
   target dn stat err =       0.005073110710
      target stat err =       0.003699040473
              std dev =       0.707922172115
             le_variance =       0.501153801772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501191075545
                                         uncertainty =       0.004888324316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501191075545
                                         uncertainty =       0.004888324316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500576568
  error estimate for blocks of size 2^( 2) =       0.000527114458
  error estimate for blocks of size 2^( 3) =       0.000552697935
  error estimate for blocks of size 2^( 4) =       0.000572928168
  error estimate for blocks of size 2^( 5) =       0.000586027888
  error estimate for blocks of size 2^( 6) =       0.000592047812
  error estimate for blocks of size 2^( 7) =       0.000595988664

      target function =      -0.706112654166
              le_mean =     -22.427542530804
             les_mean =     503.495817522210
             stat err =       0.000586748133
             autocorr =       1.373923017587
   target nu stat err =       0.000586748133
   target dn stat err =       0.005073110710
      target stat err =       0.003699040473
              std dev =       0.707922172115
             le_variance =       0.501153801772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501191075545
                                         uncertainty =       0.004888324316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501191075545
                                         uncertainty =       0.004888324316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500576568
  error estimate for blocks of size 2^( 2) =       0.000527114458
  error estimate for blocks of size 2^( 3) =       0.000552697935
  error estimate for blocks of size 2^( 4) =       0.000572928168
  error estimate for blocks of size 2^( 5) =       0.000586027888
  error estimate for blocks of size 2^( 6) =       0.000592047812
  error estimate for blocks of size 2^( 7) =       0.000595988664

      target function =      -0.706112654166
              le_mean =     -22.427542530804
             les_mean =     503.495817522210
             stat err =       0.000586748133
             autocorr =       1.373923017587
   target nu stat err =       0.000586748133
   target dn stat err =       0.005073110710
      target stat err =       0.003699040473
              std dev =       0.707922172115
             le_variance =       0.501153801772


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706112654166        initial  <--
     1.0000e+16     1.0000e+17             9.3154e-21        -0.706112654166
     4.0000e+16     4.0000e+17             3.0743e-21        -0.706112654166
     1.6000e+17     1.6000e+18             9.7695e-22        -0.706112654166

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.2858
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2737e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2427e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.4559
    reference variance = 0.356312
====================================================
  Execution time = 4.5484e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0206e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5139e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502152527500
                                         uncertainty =       0.007000783566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502152527500
                                         uncertainty =       0.007000783566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501030736
  error estimate for blocks of size 2^( 2) =       0.000527668452
  error estimate for blocks of size 2^( 3) =       0.000553119930
  error estimate for blocks of size 2^( 4) =       0.000573159024
  error estimate for blocks of size 2^( 5) =       0.000586177847
  error estimate for blocks of size 2^( 6) =       0.000593070652
  error estimate for blocks of size 2^( 7) =       0.000595474756

      target function =      -0.705473210244
              le_mean =     -22.426373843938
             les_mean =     503.444307134405
             stat err =       0.000586970570
             autocorr =       1.372473333765
   target nu stat err =       0.000586970570
   target dn stat err =       0.006350663598
      target stat err =       0.004592702269
              std dev =       0.708564462394
             le_variance =       0.502063597368


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242637384394e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+17, overlap shift 1.0000e+18 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705502318925       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705502318925       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+17, overlap shift 4.0000e+18 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705502318925       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705502318925       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+18, overlap shift 1.6000e+19 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705502318925       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705502318925       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.334602 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0631e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.4228
    reference variance = 0.448041
====================================================
  Execution time = 4.5558e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9373e-01
  Total weights = 2.0000e+06
  Execution time = 3.8175e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493819495077
                                         uncertainty =       0.004164726347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493819495077
                                         uncertainty =       0.004164726347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496855078
  error estimate for blocks of size 2^( 2) =       0.000523579106
  error estimate for blocks of size 2^( 3) =       0.000549228217
  error estimate for blocks of size 2^( 4) =       0.000568808220
  error estimate for blocks of size 2^( 5) =       0.000581931845
  error estimate for blocks of size 2^( 6) =       0.000589462662
  error estimate for blocks of size 2^( 7) =       0.000596698719

      target function =      -0.711504009029
              le_mean =     -22.427382995936
             les_mean =     503.481237736470
             stat err =       0.000584225362
             autocorr =       1.382615262094
   target nu stat err =       0.000584225362
   target dn stat err =       0.004077494032
      target stat err =       0.003038042301
              std dev =       0.702659189733
             le_variance =       0.493729936916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493819495076
                                         uncertainty =       0.004164726347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493819495076
                                         uncertainty =       0.004164726347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496855078
  error estimate for blocks of size 2^( 2) =       0.000523579106
  error estimate for blocks of size 2^( 3) =       0.000549228217
  error estimate for blocks of size 2^( 4) =       0.000568808220
  error estimate for blocks of size 2^( 5) =       0.000581931845
  error estimate for blocks of size 2^( 6) =       0.000589462662
  error estimate for blocks of size 2^( 7) =       0.000596698719

      target function =      -0.711504009029
              le_mean =     -22.427382995936
             les_mean =     503.481237736470
             stat err =       0.000584225362
             autocorr =       1.382615262090
   target nu stat err =       0.000584225362
   target dn stat err =       0.004077494032
      target stat err =       0.003038042301
              std dev =       0.702659189733
             le_variance =       0.493729936916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493819495076
                                         uncertainty =       0.004164726347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493819495076
                                         uncertainty =       0.004164726347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496855078
  error estimate for blocks of size 2^( 2) =       0.000523579106
  error estimate for blocks of size 2^( 3) =       0.000549228217
  error estimate for blocks of size 2^( 4) =       0.000568808220
  error estimate for blocks of size 2^( 5) =       0.000581931845
  error estimate for blocks of size 2^( 6) =       0.000589462662
  error estimate for blocks of size 2^( 7) =       0.000596698719

      target function =      -0.711504009029
              le_mean =     -22.427382995936
             les_mean =     503.481237736470
             stat err =       0.000584225362
             autocorr =       1.382615262090
   target nu stat err =       0.000584225362
   target dn stat err =       0.004077494032
      target stat err =       0.003038042301
              std dev =       0.702659189733
             le_variance =       0.493729936916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493819495076
                                         uncertainty =       0.004164726347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493819495076
                                         uncertainty =       0.004164726347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496855078
  error estimate for blocks of size 2^( 2) =       0.000523579106
  error estimate for blocks of size 2^( 3) =       0.000549228217
  error estimate for blocks of size 2^( 4) =       0.000568808220
  error estimate for blocks of size 2^( 5) =       0.000581931845
  error estimate for blocks of size 2^( 6) =       0.000589462662
  error estimate for blocks of size 2^( 7) =       0.000596698719

      target function =      -0.711504009029
              le_mean =     -22.427382995936
             les_mean =     503.481237736470
             stat err =       0.000584225362
             autocorr =       1.382615262090
   target nu stat err =       0.000584225362
   target dn stat err =       0.004077494032
      target stat err =       0.003038042301
              std dev =       0.702659189733
             le_variance =       0.493729936916


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.711504009029        initial  <--
     1.0000e+17     1.0000e+18             0.0000e+00        -0.711504009029
     4.0000e+17     4.0000e+18             0.0000e+00        -0.711504009029
     1.6000e+18     1.6000e+19             0.0000e+00        -0.711504009029

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.7523
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2539e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2428e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.4455
    reference variance = 0.294757
====================================================
  Execution time = 5.3325e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0662e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5260e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506707275397
                                         uncertainty =       0.006893211193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506707275397
                                         uncertainty =       0.006893211193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503297768
  error estimate for blocks of size 2^( 2) =       0.000529513273
  error estimate for blocks of size 2^( 3) =       0.000554749338
  error estimate for blocks of size 2^( 4) =       0.000573791615
  error estimate for blocks of size 2^( 5) =       0.000584743411
  error estimate for blocks of size 2^( 6) =       0.000589580843
  error estimate for blocks of size 2^( 7) =       0.000594489885

      target function =      -0.702213998483
              le_mean =     -22.426501803410
             les_mean =     503.454600170846
             stat err =       0.000585651439
             autocorr =       1.354030417142
   target nu stat err =       0.000585651439
   target dn stat err =       0.007033987623
      target stat err =       0.005033246373
              std dev =       0.711770528909
             le_variance =       0.506617285824


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242650180341e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+18, overlap shift 1.0000e+19 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702248709110       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702248709110       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+18, overlap shift 4.0000e+19 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702248709110       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702248709110       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+19, overlap shift 1.6000e+20 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702248709110       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702248709110       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.335714 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.8593e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.5562
    reference variance = 0.530035
====================================================
  Execution time = 4.5231e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2428e+01
  VMC Evar = 5.0832e-01
  Total weights = 2.0000e+06
  Execution time = 3.8289e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508451790229
                                         uncertainty =       0.014079015802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508451790229
                                         uncertainty =       0.014079015802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504141016
  error estimate for blocks of size 2^( 2) =       0.000530192256
  error estimate for blocks of size 2^( 3) =       0.000554869349
  error estimate for blocks of size 2^( 4) =       0.000574286464
  error estimate for blocks of size 2^( 5) =       0.000585425826
  error estimate for blocks of size 2^( 6) =       0.000592167863
  error estimate for blocks of size 2^( 7) =       0.000595168134

      target function =      -0.700862298567
              le_mean =     -22.428296409347
             les_mean =     503.536795898784
             stat err =       0.000586762072
             autocorr =       1.354627858970
   target nu stat err =       0.000586762072
   target dn stat err =       0.013406124671
      target stat err =       0.009533962797
              std dev =       0.712963061731
             le_variance =       0.508316327393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508451790229
                                         uncertainty =       0.014079015802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508451790229
                                         uncertainty =       0.014079015802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504141016
  error estimate for blocks of size 2^( 2) =       0.000530192256
  error estimate for blocks of size 2^( 3) =       0.000554869349
  error estimate for blocks of size 2^( 4) =       0.000574286464
  error estimate for blocks of size 2^( 5) =       0.000585425826
  error estimate for blocks of size 2^( 6) =       0.000592167863
  error estimate for blocks of size 2^( 7) =       0.000595168134

      target function =      -0.700862298567
              le_mean =     -22.428296409347
             les_mean =     503.536795898784
             stat err =       0.000586762072
             autocorr =       1.354627858970
   target nu stat err =       0.000586762072
   target dn stat err =       0.013406124671
      target stat err =       0.009533962797
              std dev =       0.712963061731
             le_variance =       0.508316327393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508451790229
                                         uncertainty =       0.014079015802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508451790229
                                         uncertainty =       0.014079015802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504141016
  error estimate for blocks of size 2^( 2) =       0.000530192256
  error estimate for blocks of size 2^( 3) =       0.000554869349
  error estimate for blocks of size 2^( 4) =       0.000574286464
  error estimate for blocks of size 2^( 5) =       0.000585425826
  error estimate for blocks of size 2^( 6) =       0.000592167863
  error estimate for blocks of size 2^( 7) =       0.000595168134

      target function =      -0.700862298567
              le_mean =     -22.428296409347
             les_mean =     503.536795898784
             stat err =       0.000586762072
             autocorr =       1.354627858970
   target nu stat err =       0.000586762072
   target dn stat err =       0.013406124671
      target stat err =       0.009533962797
              std dev =       0.712963061731
             le_variance =       0.508316327393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508451790229
                                         uncertainty =       0.014079015802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508451790229
                                         uncertainty =       0.014079015802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504141016
  error estimate for blocks of size 2^( 2) =       0.000530192256
  error estimate for blocks of size 2^( 3) =       0.000554869349
  error estimate for blocks of size 2^( 4) =       0.000574286464
  error estimate for blocks of size 2^( 5) =       0.000585425826
  error estimate for blocks of size 2^( 6) =       0.000592167863
  error estimate for blocks of size 2^( 7) =       0.000595168134

      target function =      -0.700862298567
              le_mean =     -22.428296409347
             les_mean =     503.536795898784
             stat err =       0.000586762072
             autocorr =       1.354627858970
   target nu stat err =       0.000586762072
   target dn stat err =       0.013406124671
      target stat err =       0.009533962797
              std dev =       0.712963061731
             le_variance =       0.508316327393


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.700862298567        initial  <--
     1.0000e+18     1.0000e+19             0.0000e+00        -0.700862298567
     4.0000e+18     4.0000e+19             0.0000e+00        -0.700862298567
     1.6000e+19     1.6000e+20             0.0000e+00        -0.700862298567

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.4291
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3303e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2432e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.3968
    reference variance = 0.551302
====================================================
  Execution time = 4.7417e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2429e+01
  VMC Evar = 4.9328e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5076e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493289227318
                                         uncertainty =       0.003561352757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493289227318
                                         uncertainty =       0.003561352757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496628721
  error estimate for blocks of size 2^( 2) =       0.000522834249
  error estimate for blocks of size 2^( 3) =       0.000548282079
  error estimate for blocks of size 2^( 4) =       0.000567722783
  error estimate for blocks of size 2^( 5) =       0.000580074391
  error estimate for blocks of size 2^( 6) =       0.000588283945
  error estimate for blocks of size 2^( 7) =       0.000590851392

      target function =      -0.711814393501
              le_mean =     -22.428795257564
             les_mean =     503.544136631544
             stat err =       0.000581733128
             autocorr =       1.372094199713
   target nu stat err =       0.000581733128
   target dn stat err =       0.003691032260
      target stat err =       0.002769315340
              std dev =       0.702339072293
             le_variance =       0.493280172470


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242879525756e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+19, overlap shift 1.0000e+20 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711823850728       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711823850728       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+19, overlap shift 4.0000e+20 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711823850728       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711823850728       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+20, overlap shift 1.6000e+21 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711823850728       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711823850728       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.336818 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2501e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.4146
    reference variance = 0.300378
====================================================
  Execution time = 4.5188e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9211e-01
  Total weights = 2.0000e+06
  Execution time = 3.8551e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492035454676
                                         uncertainty =       0.002984944848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492035454676
                                         uncertainty =       0.002984944848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496038096
  error estimate for blocks of size 2^( 2) =       0.000523657828
  error estimate for blocks of size 2^( 3) =       0.000548735186
  error estimate for blocks of size 2^( 4) =       0.000567908283
  error estimate for blocks of size 2^( 5) =       0.000579256205
  error estimate for blocks of size 2^( 6) =       0.000585900499
  error estimate for blocks of size 2^( 7) =       0.000587338171

      target function =      -0.712698485151
              le_mean =     -22.427115630504
             les_mean =     503.467622843869
             stat err =       0.000580100790
             autocorr =       1.367655917542
   target nu stat err =       0.000580100790
   target dn stat err =       0.003289649640
      target stat err =       0.002482605860
              std dev =       0.701503803222
             le_variance =       0.492107585934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492035454676
                                         uncertainty =       0.002984944848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492035454676
                                         uncertainty =       0.002984944848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496038096
  error estimate for blocks of size 2^( 2) =       0.000523657828
  error estimate for blocks of size 2^( 3) =       0.000548735186
  error estimate for blocks of size 2^( 4) =       0.000567908283
  error estimate for blocks of size 2^( 5) =       0.000579256205
  error estimate for blocks of size 2^( 6) =       0.000585900499
  error estimate for blocks of size 2^( 7) =       0.000587338171

      target function =      -0.712698485151
              le_mean =     -22.427115630504
             les_mean =     503.467622843869
             stat err =       0.000580100790
             autocorr =       1.367655917542
   target nu stat err =       0.000580100790
   target dn stat err =       0.003289649640
      target stat err =       0.002482605860
              std dev =       0.701503803222
             le_variance =       0.492107585934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492035454676
                                         uncertainty =       0.002984944848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492035454676
                                         uncertainty =       0.002984944848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496038096
  error estimate for blocks of size 2^( 2) =       0.000523657828
  error estimate for blocks of size 2^( 3) =       0.000548735186
  error estimate for blocks of size 2^( 4) =       0.000567908283
  error estimate for blocks of size 2^( 5) =       0.000579256205
  error estimate for blocks of size 2^( 6) =       0.000585900499
  error estimate for blocks of size 2^( 7) =       0.000587338171

      target function =      -0.712698485151
              le_mean =     -22.427115630504
             les_mean =     503.467622843869
             stat err =       0.000580100790
             autocorr =       1.367655917542
   target nu stat err =       0.000580100790
   target dn stat err =       0.003289649640
      target stat err =       0.002482605860
              std dev =       0.701503803222
             le_variance =       0.492107585934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492035454676
                                         uncertainty =       0.002984944848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492035454676
                                         uncertainty =       0.002984944848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496038096
  error estimate for blocks of size 2^( 2) =       0.000523657828
  error estimate for blocks of size 2^( 3) =       0.000548735186
  error estimate for blocks of size 2^( 4) =       0.000567908283
  error estimate for blocks of size 2^( 5) =       0.000579256205
  error estimate for blocks of size 2^( 6) =       0.000585900499
  error estimate for blocks of size 2^( 7) =       0.000587338171

      target function =      -0.712698485151
              le_mean =     -22.427115630504
             les_mean =     503.467622843869
             stat err =       0.000580100790
             autocorr =       1.367655917542
   target nu stat err =       0.000580100790
   target dn stat err =       0.003289649640
      target stat err =       0.002482605860
              std dev =       0.701503803222
             le_variance =       0.492107585934


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.712698485151        initial  <--
     1.0000e+19     1.0000e+20             0.0000e+00        -0.712698485151
     4.0000e+19     4.0000e+20             0.0000e+00        -0.712698485151
     1.6000e+20     1.6000e+21             0.0000e+00        -0.712698485151

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.4529
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2705e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2430e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.4467
    reference variance = 0.34473
====================================================
  Execution time = 4.6336e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0125e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5242e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501236159302
                                         uncertainty =       0.004375691885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501236159302
                                         uncertainty =       0.004375691885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500624209
  error estimate for blocks of size 2^( 2) =       0.000527326464
  error estimate for blocks of size 2^( 3) =       0.000552352505
  error estimate for blocks of size 2^( 4) =       0.000571975151
  error estimate for blocks of size 2^( 5) =       0.000584868518
  error estimate for blocks of size 2^( 6) =       0.000591574936
  error estimate for blocks of size 2^( 7) =       0.000596708231

      target function =      -0.706050700756
              le_mean =     -22.427437714240
             les_mean =     503.491211372747
             stat err =       0.000586281709
             autocorr =       1.371478474136
   target nu stat err =       0.000586281709
   target dn stat err =       0.004408182996
      target stat err =       0.003226652326
              std dev =       0.707989546004
             le_variance =       0.501249197251


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242743771424e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+20, overlap shift 1.0000e+21 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706064519757       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706064519757       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706064519757       residual = 6.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706064519757       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+20 is 6.719844e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+20, overlap shift 4.0000e+21 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706064519757       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706064519757       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706064519757       residual = 6.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+20 is 1.679961e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+21, overlap shift 1.6000e+22 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706064519757       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706064519757       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706064519757       residual = 6.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706064519757       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+21 is 4.199902e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.338367 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1586e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.4529
    reference variance = 0.420622
====================================================
  Execution time = 4.4971e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0893e-01
  Total weights = 2.0000e+06
  Execution time = 3.8431e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508958723874
                                         uncertainty =       0.015110742874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508958723874
                                         uncertainty =       0.015110742874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504445152
  error estimate for blocks of size 2^( 2) =       0.000530693786
  error estimate for blocks of size 2^( 3) =       0.000555730074
  error estimate for blocks of size 2^( 4) =       0.000574886652
  error estimate for blocks of size 2^( 5) =       0.000587306993
  error estimate for blocks of size 2^( 6) =       0.000594237638
  error estimate for blocks of size 2^( 7) =       0.000600612271

      target function =      -0.700448132388
              le_mean =     -22.426134403796
             les_mean =     503.440433865321
             stat err =       0.000589260888
             autocorr =       1.364543318844
   target nu stat err =       0.000589260888
   target dn stat err =       0.015575121646
      target stat err =       0.011024196442
              std dev =       0.713393175361
             le_variance =       0.508929822652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508958723874
                                         uncertainty =       0.015110742874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508958723874
                                         uncertainty =       0.015110742874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504445152
  error estimate for blocks of size 2^( 2) =       0.000530693786
  error estimate for blocks of size 2^( 3) =       0.000555730074
  error estimate for blocks of size 2^( 4) =       0.000574886652
  error estimate for blocks of size 2^( 5) =       0.000587306993
  error estimate for blocks of size 2^( 6) =       0.000594237638
  error estimate for blocks of size 2^( 7) =       0.000600612271

      target function =      -0.700448132388
              le_mean =     -22.426134403796
             les_mean =     503.440433865321
             stat err =       0.000589260888
             autocorr =       1.364543318846
   target nu stat err =       0.000589260888
   target dn stat err =       0.015575121646
      target stat err =       0.011024196442
              std dev =       0.713393175361
             le_variance =       0.508929822652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508958723874
                                         uncertainty =       0.015110742874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508958723874
                                         uncertainty =       0.015110742874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504445152
  error estimate for blocks of size 2^( 2) =       0.000530693786
  error estimate for blocks of size 2^( 3) =       0.000555730074
  error estimate for blocks of size 2^( 4) =       0.000574886652
  error estimate for blocks of size 2^( 5) =       0.000587306993
  error estimate for blocks of size 2^( 6) =       0.000594237638
  error estimate for blocks of size 2^( 7) =       0.000600612271

      target function =      -0.700448132388
              le_mean =     -22.426134403796
             les_mean =     503.440433865321
             stat err =       0.000589260888
             autocorr =       1.364543318846
   target nu stat err =       0.000589260888
   target dn stat err =       0.015575121646
      target stat err =       0.011024196442
              std dev =       0.713393175361
             le_variance =       0.508929822652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508958723874
                                         uncertainty =       0.015110742874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508958723874
                                         uncertainty =       0.015110742874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504445152
  error estimate for blocks of size 2^( 2) =       0.000530693786
  error estimate for blocks of size 2^( 3) =       0.000555730074
  error estimate for blocks of size 2^( 4) =       0.000574886652
  error estimate for blocks of size 2^( 5) =       0.000587306993
  error estimate for blocks of size 2^( 6) =       0.000594237638
  error estimate for blocks of size 2^( 7) =       0.000600612271

      target function =      -0.700448132388
              le_mean =     -22.426134403796
             les_mean =     503.440433865321
             stat err =       0.000589260888
             autocorr =       1.364543318846
   target nu stat err =       0.000589260888
   target dn stat err =       0.015575121646
      target stat err =       0.011024196442
              std dev =       0.713393175361
             le_variance =       0.508929822652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.700448132388        initial  <--
     1.0000e+20     1.0000e+21             6.7198e-25        -0.700448132388
     4.0000e+20     4.0000e+21             1.6800e-25        -0.700448132388
     1.6000e+21     1.6000e+22             4.1999e-26        -0.700448132388

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.1717
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2583e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2431e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.3837
    reference variance = 0.319734
====================================================
  Execution time = 4.5761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9259e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5187e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492537638029
                                         uncertainty =       0.003257243077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492537638029
                                         uncertainty =       0.003257243077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496281987
  error estimate for blocks of size 2^( 2) =       0.000522928260
  error estimate for blocks of size 2^( 3) =       0.000548790239
  error estimate for blocks of size 2^( 4) =       0.000568393885
  error estimate for blocks of size 2^( 5) =       0.000580739568
  error estimate for blocks of size 2^( 6) =       0.000587958788
  error estimate for blocks of size 2^( 7) =       0.000589870894

      target function =      -0.712348501640
              le_mean =     -22.426775831367
             les_mean =     503.452865565822
             stat err =       0.000581740784
             autocorr =       1.374048296588
   target nu stat err =       0.000581740784
   target dn stat err =       0.003257433587
      target stat err =       0.002456562561
              std dev =       0.701848717112
             le_variance =       0.492591621712


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242677583137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+21, overlap shift 1.0000e+22 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712355875260       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712355875260       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+21, overlap shift 4.0000e+22 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712355875260       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712355875260       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+22, overlap shift 1.6000e+23 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712355875260       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712355875260       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.339467 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0955e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.4219
    reference variance = 0.4145
====================================================
  Execution time = 4.7777e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.8893e-01
  Total weights = 2.0000e+06
  Execution time = 3.8277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488822546442
                                         uncertainty =       0.002731474639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488822546442
                                         uncertainty =       0.002731474639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494436606
  error estimate for blocks of size 2^( 2) =       0.000521454690
  error estimate for blocks of size 2^( 3) =       0.000547752593
  error estimate for blocks of size 2^( 4) =       0.000567560338
  error estimate for blocks of size 2^( 5) =       0.000579638682
  error estimate for blocks of size 2^( 6) =       0.000586530211
  error estimate for blocks of size 2^( 7) =       0.000591409893

      target function =      -0.715035525126
              le_mean =     -22.426703897356
             les_mean =     503.445982570791
             stat err =       0.000581284781
             autocorr =       1.382154752224
   target nu stat err =       0.000581284781
   target dn stat err =       0.002877893751
      target stat err =       0.002203866441
              std dev =       0.699238954570
             le_variance =       0.488935115588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488822546442
                                         uncertainty =       0.002731474639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488822546442
                                         uncertainty =       0.002731474639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494436606
  error estimate for blocks of size 2^( 2) =       0.000521454690
  error estimate for blocks of size 2^( 3) =       0.000547752593
  error estimate for blocks of size 2^( 4) =       0.000567560338
  error estimate for blocks of size 2^( 5) =       0.000579638682
  error estimate for blocks of size 2^( 6) =       0.000586530211
  error estimate for blocks of size 2^( 7) =       0.000591409893

      target function =      -0.715035525126
              le_mean =     -22.426703897356
             les_mean =     503.445982570791
             stat err =       0.000581284781
             autocorr =       1.382154752224
   target nu stat err =       0.000581284781
   target dn stat err =       0.002877893751
      target stat err =       0.002203866441
              std dev =       0.699238954570
             le_variance =       0.488935115588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488822546442
                                         uncertainty =       0.002731474639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488822546442
                                         uncertainty =       0.002731474639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494436606
  error estimate for blocks of size 2^( 2) =       0.000521454690
  error estimate for blocks of size 2^( 3) =       0.000547752593
  error estimate for blocks of size 2^( 4) =       0.000567560338
  error estimate for blocks of size 2^( 5) =       0.000579638682
  error estimate for blocks of size 2^( 6) =       0.000586530211
  error estimate for blocks of size 2^( 7) =       0.000591409893

      target function =      -0.715035525126
              le_mean =     -22.426703897356
             les_mean =     503.445982570791
             stat err =       0.000581284781
             autocorr =       1.382154752224
   target nu stat err =       0.000581284781
   target dn stat err =       0.002877893751
      target stat err =       0.002203866441
              std dev =       0.699238954570
             le_variance =       0.488935115588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488822546442
                                         uncertainty =       0.002731474639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488822546442
                                         uncertainty =       0.002731474639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494436606
  error estimate for blocks of size 2^( 2) =       0.000521454690
  error estimate for blocks of size 2^( 3) =       0.000547752593
  error estimate for blocks of size 2^( 4) =       0.000567560338
  error estimate for blocks of size 2^( 5) =       0.000579638682
  error estimate for blocks of size 2^( 6) =       0.000586530211
  error estimate for blocks of size 2^( 7) =       0.000591409893

      target function =      -0.715035525126
              le_mean =     -22.426703897356
             les_mean =     503.445982570791
             stat err =       0.000581284781
             autocorr =       1.382154752224
   target nu stat err =       0.000581284781
   target dn stat err =       0.002877893751
      target stat err =       0.002203866441
              std dev =       0.699238954570
             le_variance =       0.488935115588


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.715035525126        initial  <--
     1.0000e+21     1.0000e+22             0.0000e+00        -0.715035525126
     4.0000e+21     4.0000e+22             0.0000e+00        -0.715035525126
     1.6000e+22     1.6000e+23             0.0000e+00        -0.715035525126

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.9314
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2796e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2430e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.3805
    reference variance = 0.457448
====================================================
  Execution time = 4.6105e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0003e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5062e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499991259454
                                         uncertainty =       0.003765047916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499991259454
                                         uncertainty =       0.003765047916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500016097
  error estimate for blocks of size 2^( 2) =       0.000526850419
  error estimate for blocks of size 2^( 3) =       0.000551910163
  error estimate for blocks of size 2^( 4) =       0.000570899406
  error estimate for blocks of size 2^( 5) =       0.000583030321
  error estimate for blocks of size 2^( 6) =       0.000589269986
  error estimate for blocks of size 2^( 7) =       0.000592355191

      target function =      -0.706932772687
              le_mean =     -22.427314637917
             les_mean =     503.484473812057
             stat err =       0.000583888726
             autocorr =       1.363616377567
   target nu stat err =       0.000583888726
   target dn stat err =       0.003916139123
      target stat err =       0.002885593683
              std dev =       0.707129545378
             le_variance =       0.500032193946


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242731463792e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+22, overlap shift 1.0000e+23 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706943551251       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706943551251       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+22, overlap shift 4.0000e+23 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706943551251       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706943551251       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+23, overlap shift 1.6000e+24 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706943551251       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706943551251       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.340581 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1174e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.3434
    reference variance = 0.484271
====================================================
  Execution time = 4.7041e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0002e-01
  Total weights = 2.0000e+06
  Execution time = 3.8388e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500026113732
                                         uncertainty =       0.003734035647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500026113732
                                         uncertainty =       0.003734035647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500011019
  error estimate for blocks of size 2^( 2) =       0.000526980369
  error estimate for blocks of size 2^( 3) =       0.000552540475
  error estimate for blocks of size 2^( 4) =       0.000571685769
  error estimate for blocks of size 2^( 5) =       0.000582972904
  error estimate for blocks of size 2^( 6) =       0.000589156117
  error estimate for blocks of size 2^( 7) =       0.000592437597

      target function =      -0.706965769666
              le_mean =     -22.426015792446
             les_mean =     503.426206111003
             stat err =       0.000584063097
             autocorr =       1.364458663672
   target nu stat err =       0.000584063097
   target dn stat err =       0.003861706912
      target stat err =       0.002842174584
              std dev =       0.707122364216
             le_variance =       0.500022037975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500026113732
                                         uncertainty =       0.003734035647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500026113732
                                         uncertainty =       0.003734035647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500011019
  error estimate for blocks of size 2^( 2) =       0.000526980369
  error estimate for blocks of size 2^( 3) =       0.000552540475
  error estimate for blocks of size 2^( 4) =       0.000571685769
  error estimate for blocks of size 2^( 5) =       0.000582972904
  error estimate for blocks of size 2^( 6) =       0.000589156117
  error estimate for blocks of size 2^( 7) =       0.000592437597

      target function =      -0.706965769666
              le_mean =     -22.426015792446
             les_mean =     503.426206111003
             stat err =       0.000584063097
             autocorr =       1.364458663672
   target nu stat err =       0.000584063097
   target dn stat err =       0.003861706912
      target stat err =       0.002842174584
              std dev =       0.707122364216
             le_variance =       0.500022037975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500026113732
                                         uncertainty =       0.003734035647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500026113732
                                         uncertainty =       0.003734035647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500011019
  error estimate for blocks of size 2^( 2) =       0.000526980369
  error estimate for blocks of size 2^( 3) =       0.000552540475
  error estimate for blocks of size 2^( 4) =       0.000571685769
  error estimate for blocks of size 2^( 5) =       0.000582972904
  error estimate for blocks of size 2^( 6) =       0.000589156117
  error estimate for blocks of size 2^( 7) =       0.000592437597

      target function =      -0.706965769666
              le_mean =     -22.426015792446
             les_mean =     503.426206111003
             stat err =       0.000584063097
             autocorr =       1.364458663672
   target nu stat err =       0.000584063097
   target dn stat err =       0.003861706912
      target stat err =       0.002842174584
              std dev =       0.707122364216
             le_variance =       0.500022037975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500026113732
                                         uncertainty =       0.003734035647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500026113732
                                         uncertainty =       0.003734035647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500011019
  error estimate for blocks of size 2^( 2) =       0.000526980369
  error estimate for blocks of size 2^( 3) =       0.000552540475
  error estimate for blocks of size 2^( 4) =       0.000571685769
  error estimate for blocks of size 2^( 5) =       0.000582972904
  error estimate for blocks of size 2^( 6) =       0.000589156117
  error estimate for blocks of size 2^( 7) =       0.000592437597

      target function =      -0.706965769666
              le_mean =     -22.426015792446
             les_mean =     503.426206111003
             stat err =       0.000584063097
             autocorr =       1.364458663672
   target nu stat err =       0.000584063097
   target dn stat err =       0.003861706912
      target stat err =       0.002842174584
              std dev =       0.707122364216
             le_variance =       0.500022037975


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706965769666        initial  <--
     1.0000e+22     1.0000e+23             0.0000e+00        -0.706965769666
     4.0000e+22     4.0000e+23             0.0000e+00        -0.706965769666
     1.6000e+23     1.6000e+24             0.0000e+00        -0.706965769666

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.2147
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2740e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2427e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.5196
    reference variance = 0.311605
====================================================
  Execution time = 4.5738e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2429e+01
  VMC Evar = 4.9364e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5222e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493685604996
                                         uncertainty =       0.003064813308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493685604996
                                         uncertainty =       0.003064813308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496811155
  error estimate for blocks of size 2^( 2) =       0.000523566443
  error estimate for blocks of size 2^( 3) =       0.000548753016
  error estimate for blocks of size 2^( 4) =       0.000567825466
  error estimate for blocks of size 2^( 5) =       0.000580306957
  error estimate for blocks of size 2^( 6) =       0.000586389471
  error estimate for blocks of size 2^( 7) =       0.000591359989

      target function =      -0.711549663818
              le_mean =     -22.428917945577
             les_mean =     503.550002610141
             stat err =       0.000581470471
             autocorr =       1.369848857044
   target nu stat err =       0.000581470471
   target dn stat err =       0.003089025863
      target stat err =       0.002339344722
              std dev =       0.702597073394
             le_variance =       0.493642647542


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242891794558e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+23, overlap shift 1.0000e+24 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711556431457       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711556431457       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711556437708       residual = 2.30e+06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711556431457       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711556431456       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+23 is 8.175703e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+23, overlap shift 4.0000e+24 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711556431457       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711556431457       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711556431457       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711556431457       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711556304990       residual = 1.27e+06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+23 is 2.043926e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+24, overlap shift 1.6000e+25 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711556431457       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711556431457       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711556483864       residual = 3.67e+07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711556431457       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+24 is 3.016575e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.342434 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0968e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.4252
    reference variance = 0.623361
====================================================
  Execution time = 4.5334e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0552e-01
  Total weights = 2.0000e+06
  Execution time = 3.8253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505344401265
                                         uncertainty =       0.011899849572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505344401265
                                         uncertainty =       0.011899849572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502753059
  error estimate for blocks of size 2^( 2) =       0.000529618814
  error estimate for blocks of size 2^( 3) =       0.000556353962
  error estimate for blocks of size 2^( 4) =       0.000575305183
  error estimate for blocks of size 2^( 5) =       0.000588647648
  error estimate for blocks of size 2^( 6) =       0.000595892512
  error estimate for blocks of size 2^( 7) =       0.000601817221

      target function =      -0.702919538613
              le_mean =     -22.426810150089
             les_mean =     503.467334531715
             stat err =       0.000590415641
             autocorr =       1.379133363162
   target nu stat err =       0.000590415641
   target dn stat err =       0.011816404426
      target stat err =       0.008439199023
              std dev =       0.711000194346
             le_variance =       0.505521276360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505344401265
                                         uncertainty =       0.011899849572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505344401265
                                         uncertainty =       0.011899849572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502753059
  error estimate for blocks of size 2^( 2) =       0.000529618814
  error estimate for blocks of size 2^( 3) =       0.000556353962
  error estimate for blocks of size 2^( 4) =       0.000575305183
  error estimate for blocks of size 2^( 5) =       0.000588647648
  error estimate for blocks of size 2^( 6) =       0.000595892512
  error estimate for blocks of size 2^( 7) =       0.000601817221

      target function =      -0.702919538613
              le_mean =     -22.426810150089
             les_mean =     503.467334531715
             stat err =       0.000590415641
             autocorr =       1.379133363162
   target nu stat err =       0.000590415641
   target dn stat err =       0.011816404426
      target stat err =       0.008439199023
              std dev =       0.711000194346
             le_variance =       0.505521276360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505344401265
                                         uncertainty =       0.011899849572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505344401265
                                         uncertainty =       0.011899849572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502753059
  error estimate for blocks of size 2^( 2) =       0.000529618814
  error estimate for blocks of size 2^( 3) =       0.000556353962
  error estimate for blocks of size 2^( 4) =       0.000575305183
  error estimate for blocks of size 2^( 5) =       0.000588647648
  error estimate for blocks of size 2^( 6) =       0.000595892512
  error estimate for blocks of size 2^( 7) =       0.000601817221

      target function =      -0.702919538613
              le_mean =     -22.426810150089
             les_mean =     503.467334531715
             stat err =       0.000590415641
             autocorr =       1.379133363162
   target nu stat err =       0.000590415641
   target dn stat err =       0.011816404426
      target stat err =       0.008439199023
              std dev =       0.711000194346
             le_variance =       0.505521276360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505344401265
                                         uncertainty =       0.011899849572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505344401265
                                         uncertainty =       0.011899849572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502753059
  error estimate for blocks of size 2^( 2) =       0.000529618814
  error estimate for blocks of size 2^( 3) =       0.000556353962
  error estimate for blocks of size 2^( 4) =       0.000575305183
  error estimate for blocks of size 2^( 5) =       0.000588647648
  error estimate for blocks of size 2^( 6) =       0.000595892512
  error estimate for blocks of size 2^( 7) =       0.000601817221

      target function =      -0.702919538613
              le_mean =     -22.426810150089
             les_mean =     503.467334531715
             stat err =       0.000590415641
             autocorr =       1.379133363162
   target nu stat err =       0.000590415641
   target dn stat err =       0.011816404426
      target stat err =       0.008439199023
              std dev =       0.711000194346
             le_variance =       0.505521276360


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.702919538613        initial  <--
     1.0000e+23     1.0000e+24             8.1757e-28        -0.702919538613
     4.0000e+23     4.0000e+24             2.0439e-28        -0.702919538613
     1.6000e+24     1.6000e+25             3.0166e-29        -0.702919538613

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.0170
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2902e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2429e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.502
    reference variance = 0.528401
====================================================
  Execution time = 4.5726e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9108e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5102e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491113173505
                                         uncertainty =       0.003992439437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491113173505
                                         uncertainty =       0.003992439437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495518960
  error estimate for blocks of size 2^( 2) =       0.000522345212
  error estimate for blocks of size 2^( 3) =       0.000547187050
  error estimate for blocks of size 2^( 4) =       0.000566969792
  error estimate for blocks of size 2^( 5) =       0.000579902622
  error estimate for blocks of size 2^( 6) =       0.000586015745
  error estimate for blocks of size 2^( 7) =       0.000587645347

      target function =      -0.713458044269
              le_mean =     -22.426333930210
             les_mean =     503.431531382971
             stat err =       0.000580133377
             autocorr =       1.370677083945
   target nu stat err =       0.000580133377
   target dn stat err =       0.003932045097
      target stat err =       0.002944454926
              std dev =       0.700769633475
             le_variance =       0.491078079200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242633393021e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+24, overlap shift 1.0000e+25 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713469230378       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713469230378       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+24, overlap shift 4.0000e+25 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713469230378       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713469230378       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+25, overlap shift 1.6000e+26 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713469230378       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713469230378       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.343545 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0835e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.4114
    reference variance = 0.296625
====================================================
  Execution time = 4.6125e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9181e-01
  Total weights = 2.0000e+06
  Execution time = 3.8352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491854557459
                                         uncertainty =       0.003268245699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491854557459
                                         uncertainty =       0.003268245699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495888534
  error estimate for blocks of size 2^( 2) =       0.000522263282
  error estimate for blocks of size 2^( 3) =       0.000548044858
  error estimate for blocks of size 2^( 4) =       0.000566821928
  error estimate for blocks of size 2^( 5) =       0.000578359969
  error estimate for blocks of size 2^( 6) =       0.000584612252
  error estimate for blocks of size 2^( 7) =       0.000588372637

      target function =      -0.712901389592
              le_mean =     -22.428318440868
             les_mean =     503.521278715694
             stat err =       0.000579541696
             autocorr =       1.365844449115
   target nu stat err =       0.000579541696
   target dn stat err =       0.003172625408
      target stat err =       0.002404825290
              std dev =       0.701292290429
             le_variance =       0.491810876615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491854557459
                                         uncertainty =       0.003268245699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491854557459
                                         uncertainty =       0.003268245699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495888534
  error estimate for blocks of size 2^( 2) =       0.000522263282
  error estimate for blocks of size 2^( 3) =       0.000548044858
  error estimate for blocks of size 2^( 4) =       0.000566821928
  error estimate for blocks of size 2^( 5) =       0.000578359969
  error estimate for blocks of size 2^( 6) =       0.000584612252
  error estimate for blocks of size 2^( 7) =       0.000588372637

      target function =      -0.712901389592
              le_mean =     -22.428318440868
             les_mean =     503.521278715694
             stat err =       0.000579541696
             autocorr =       1.365844449115
   target nu stat err =       0.000579541696
   target dn stat err =       0.003172625408
      target stat err =       0.002404825290
              std dev =       0.701292290429
             le_variance =       0.491810876615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491854557459
                                         uncertainty =       0.003268245699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491854557459
                                         uncertainty =       0.003268245699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495888534
  error estimate for blocks of size 2^( 2) =       0.000522263282
  error estimate for blocks of size 2^( 3) =       0.000548044858
  error estimate for blocks of size 2^( 4) =       0.000566821928
  error estimate for blocks of size 2^( 5) =       0.000578359969
  error estimate for blocks of size 2^( 6) =       0.000584612252
  error estimate for blocks of size 2^( 7) =       0.000588372637

      target function =      -0.712901389592
              le_mean =     -22.428318440868
             les_mean =     503.521278715694
             stat err =       0.000579541696
             autocorr =       1.365844449115
   target nu stat err =       0.000579541696
   target dn stat err =       0.003172625408
      target stat err =       0.002404825290
              std dev =       0.701292290429
             le_variance =       0.491810876615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491854557459
                                         uncertainty =       0.003268245699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491854557459
                                         uncertainty =       0.003268245699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495888534
  error estimate for blocks of size 2^( 2) =       0.000522263282
  error estimate for blocks of size 2^( 3) =       0.000548044858
  error estimate for blocks of size 2^( 4) =       0.000566821928
  error estimate for blocks of size 2^( 5) =       0.000578359969
  error estimate for blocks of size 2^( 6) =       0.000584612252
  error estimate for blocks of size 2^( 7) =       0.000588372637

      target function =      -0.712901389592
              le_mean =     -22.428318440868
             les_mean =     503.521278715694
             stat err =       0.000579541696
             autocorr =       1.365844449115
   target nu stat err =       0.000579541696
   target dn stat err =       0.003172625408
      target stat err =       0.002404825290
              std dev =       0.701292290429
             le_variance =       0.491810876615


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.712901389592        initial  <--
     1.0000e+24     1.0000e+25             0.0000e+00        -0.712901389592
     4.0000e+24     4.0000e+25             0.0000e+00        -0.712901389592
     1.6000e+25     1.6000e+26             0.0000e+00        -0.712901389592

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.2847
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2614e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2430e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.4916
    reference variance = 0.321635
====================================================
  Execution time = 4.7855e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2428e+01
  VMC Evar = 5.0045e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5302e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500533128628
                                         uncertainty =       0.004696220062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500533128628
                                         uncertainty =       0.004696220062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500227313
  error estimate for blocks of size 2^( 2) =       0.000526463549
  error estimate for blocks of size 2^( 3) =       0.000551543853
  error estimate for blocks of size 2^( 4) =       0.000570973514
  error estimate for blocks of size 2^( 5) =       0.000583351525
  error estimate for blocks of size 2^( 6) =       0.000590280183
  error estimate for blocks of size 2^( 7) =       0.000594548952

      target function =      -0.706617829714
              le_mean =     -22.427626632400
             les_mean =     503.498890842363
             stat err =       0.000584788544
             autocorr =       1.366667632992
   target nu stat err =       0.000584788544
   target dn stat err =       0.004528079816
      target stat err =       0.003317313653
              std dev =       0.707428250973
             le_variance =       0.500454730274


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242762663240e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+25, overlap shift 1.0000e+26 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706632484499       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706632484499       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706632484500       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+25 is 4.974718e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+25, overlap shift 4.0000e+26 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706632484499       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706632484499       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706632484500       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+25 is 1.243680e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+26, overlap shift 1.6000e+27 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706632484499       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706632484499       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706632484493       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+26 is 3.109199e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.344939 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3165e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.4938
    reference variance = 0.45651
====================================================
  Execution time = 4.5122e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9817e-01
  Total weights = 2.0000e+06
  Execution time = 3.8247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498210491392
                                         uncertainty =       0.003502065240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498210491392
                                         uncertainty =       0.003502065240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499083740
  error estimate for blocks of size 2^( 2) =       0.000525097871
  error estimate for blocks of size 2^( 3) =       0.000550433110
  error estimate for blocks of size 2^( 4) =       0.000569711586
  error estimate for blocks of size 2^( 5) =       0.000581736762
  error estimate for blocks of size 2^( 6) =       0.000589235872
  error estimate for blocks of size 2^( 7) =       0.000593016887

      target function =      -0.708286473243
              le_mean =     -22.426969802807
             les_mean =     503.467143445437
             stat err =       0.000583425277
             autocorr =       1.366544065925
   target nu stat err =       0.000583425277
   target dn stat err =       0.003615039592
      target stat err =       0.002682102615
              std dev =       0.705810993457
             le_variance =       0.498169158484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498210491392
                                         uncertainty =       0.003502065240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498210491392
                                         uncertainty =       0.003502065240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499083740
  error estimate for blocks of size 2^( 2) =       0.000525097871
  error estimate for blocks of size 2^( 3) =       0.000550433110
  error estimate for blocks of size 2^( 4) =       0.000569711586
  error estimate for blocks of size 2^( 5) =       0.000581736762
  error estimate for blocks of size 2^( 6) =       0.000589235872
  error estimate for blocks of size 2^( 7) =       0.000593016887

      target function =      -0.708286473243
              le_mean =     -22.426969802807
             les_mean =     503.467143445437
             stat err =       0.000583425277
             autocorr =       1.366544065925
   target nu stat err =       0.000583425277
   target dn stat err =       0.003615039592
      target stat err =       0.002682102615
              std dev =       0.705810993457
             le_variance =       0.498169158484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498210491392
                                         uncertainty =       0.003502065240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498210491392
                                         uncertainty =       0.003502065240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499083740
  error estimate for blocks of size 2^( 2) =       0.000525097871
  error estimate for blocks of size 2^( 3) =       0.000550433110
  error estimate for blocks of size 2^( 4) =       0.000569711586
  error estimate for blocks of size 2^( 5) =       0.000581736762
  error estimate for blocks of size 2^( 6) =       0.000589235872
  error estimate for blocks of size 2^( 7) =       0.000593016887

      target function =      -0.708286473243
              le_mean =     -22.426969802807
             les_mean =     503.467143445437
             stat err =       0.000583425277
             autocorr =       1.366544065925
   target nu stat err =       0.000583425277
   target dn stat err =       0.003615039592
      target stat err =       0.002682102615
              std dev =       0.705810993457
             le_variance =       0.498169158484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498210491392
                                         uncertainty =       0.003502065240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498210491392
                                         uncertainty =       0.003502065240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499083740
  error estimate for blocks of size 2^( 2) =       0.000525097871
  error estimate for blocks of size 2^( 3) =       0.000550433110
  error estimate for blocks of size 2^( 4) =       0.000569711586
  error estimate for blocks of size 2^( 5) =       0.000581736762
  error estimate for blocks of size 2^( 6) =       0.000589235872
  error estimate for blocks of size 2^( 7) =       0.000593016887

      target function =      -0.708286473243
              le_mean =     -22.426969802807
             les_mean =     503.467143445437
             stat err =       0.000583425277
             autocorr =       1.366544065925
   target nu stat err =       0.000583425277
   target dn stat err =       0.003615039592
      target stat err =       0.002682102615
              std dev =       0.705810993457
             le_variance =       0.498169158484


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.708286473243        initial  <--
     1.0000e+25     1.0000e+26             4.9747e-30        -0.708286473243
     4.0000e+25     4.0000e+26             1.2437e-30        -0.708286473243
     1.6000e+26     1.6000e+27             3.1092e-31        -0.708286473243

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.2607
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2745e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2432e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.4866
    reference variance = 0.334457
====================================================
  Execution time = 4.7561e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0303e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4993e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503058096297
                                         uncertainty =       0.004715996262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503058096297
                                         uncertainty =       0.004715996262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501510674
  error estimate for blocks of size 2^( 2) =       0.000528121316
  error estimate for blocks of size 2^( 3) =       0.000553639747
  error estimate for blocks of size 2^( 4) =       0.000573246817
  error estimate for blocks of size 2^( 5) =       0.000585874760
  error estimate for blocks of size 2^( 6) =       0.000592954941
  error estimate for blocks of size 2^( 7) =       0.000599749441

      target function =      -0.704803782055
              le_mean =     -22.426024777758
             les_mean =     503.429612993949
             stat err =       0.000587956490
             autocorr =       1.374453382480
   target nu stat err =       0.000587956490
   target dn stat err =       0.004866703709
      target stat err =       0.003532044992
              std dev =       0.709243197235
             le_variance =       0.503025912824


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242602477776e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+26, overlap shift 1.0000e+27 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.704820484994       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.704820484994       residual = 7.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.704820485000       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+26 is 4.772341e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+26, overlap shift 4.0000e+27 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.704820484994       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.704820484994       residual = 7.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.704820485000       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+26 is 1.193085e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+27, overlap shift 1.6000e+28 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.704820484994       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.704820484994       residual = 7.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.704820484994       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.704820484994       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+27 is 5.260293e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.346415 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2561e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.4428
    reference variance = 0.464973
====================================================
  Execution time = 4.5237e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9112e-01
  Total weights = 2.0000e+06
  Execution time = 3.8330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491144892112
                                         uncertainty =       0.002748270461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491144892112
                                         uncertainty =       0.002748270461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495541090
  error estimate for blocks of size 2^( 2) =       0.000522520016
  error estimate for blocks of size 2^( 3) =       0.000548587105
  error estimate for blocks of size 2^( 4) =       0.000568212616
  error estimate for blocks of size 2^( 5) =       0.000580075654
  error estimate for blocks of size 2^( 6) =       0.000586406842
  error estimate for blocks of size 2^( 7) =       0.000589231059

      target function =      -0.713416434935
              le_mean =     -22.427721782481
             les_mean =     503.493826050704
             stat err =       0.000580981543
             autocorr =       1.374565145191
   target nu stat err =       0.000580981543
   target dn stat err =       0.002822445573
      target stat err =       0.002158233877
              std dev =       0.700800930281
             le_variance =       0.491121943882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491144892112
                                         uncertainty =       0.002748270461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491144892112
                                         uncertainty =       0.002748270461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495541090
  error estimate for blocks of size 2^( 2) =       0.000522520016
  error estimate for blocks of size 2^( 3) =       0.000548587105
  error estimate for blocks of size 2^( 4) =       0.000568212616
  error estimate for blocks of size 2^( 5) =       0.000580075654
  error estimate for blocks of size 2^( 6) =       0.000586406842
  error estimate for blocks of size 2^( 7) =       0.000589231059

      target function =      -0.713416434935
              le_mean =     -22.427721782481
             les_mean =     503.493826050704
             stat err =       0.000580981543
             autocorr =       1.374565145191
   target nu stat err =       0.000580981543
   target dn stat err =       0.002822445573
      target stat err =       0.002158233877
              std dev =       0.700800930281
             le_variance =       0.491121943882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491144892112
                                         uncertainty =       0.002748270461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491144892112
                                         uncertainty =       0.002748270461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495541090
  error estimate for blocks of size 2^( 2) =       0.000522520016
  error estimate for blocks of size 2^( 3) =       0.000548587105
  error estimate for blocks of size 2^( 4) =       0.000568212616
  error estimate for blocks of size 2^( 5) =       0.000580075654
  error estimate for blocks of size 2^( 6) =       0.000586406842
  error estimate for blocks of size 2^( 7) =       0.000589231059

      target function =      -0.713416434935
              le_mean =     -22.427721782481
             les_mean =     503.493826050704
             stat err =       0.000580981543
             autocorr =       1.374565145191
   target nu stat err =       0.000580981543
   target dn stat err =       0.002822445573
      target stat err =       0.002158233877
              std dev =       0.700800930281
             le_variance =       0.491121943882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491144892112
                                         uncertainty =       0.002748270461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491144892112
                                         uncertainty =       0.002748270461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495541090
  error estimate for blocks of size 2^( 2) =       0.000522520016
  error estimate for blocks of size 2^( 3) =       0.000548587105
  error estimate for blocks of size 2^( 4) =       0.000568212616
  error estimate for blocks of size 2^( 5) =       0.000580075654
  error estimate for blocks of size 2^( 6) =       0.000586406842
  error estimate for blocks of size 2^( 7) =       0.000589231059

      target function =      -0.713416434935
              le_mean =     -22.427721782481
             les_mean =     503.493826050704
             stat err =       0.000580981543
             autocorr =       1.374565145191
   target nu stat err =       0.000580981543
   target dn stat err =       0.002822445573
      target stat err =       0.002158233877
              std dev =       0.700800930281
             le_variance =       0.491121943882


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.713416434935        initial  <--
     1.0000e+26     1.0000e+27             4.7723e-31        -0.713416434935
     4.0000e+26     4.0000e+27             1.1931e-31        -0.713416434935
     1.6000e+27     1.6000e+28             5.2603e-32        -0.713416434935

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.4524
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2717e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.3472
    reference variance = 0.38165
====================================================
  Execution time = 4.5519e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9908e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5300e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499159727088
                                         uncertainty =       0.005256054335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499159727088
                                         uncertainty =       0.005256054335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499541924
  error estimate for blocks of size 2^( 2) =       0.000525743091
  error estimate for blocks of size 2^( 3) =       0.000551590473
  error estimate for blocks of size 2^( 4) =       0.000571789125
  error estimate for blocks of size 2^( 5) =       0.000584949671
  error estimate for blocks of size 2^( 6) =       0.000592525064
  error estimate for blocks of size 2^( 7) =       0.000599369158

      target function =      -0.707622913719
              le_mean =     -22.426550802754
             les_mean =     503.449264926849
             stat err =       0.000587158254
             autocorr =       1.381549521609
   target nu stat err =       0.000587158254
   target dn stat err =       0.005136553454
      target stat err =       0.003754624570
              std dev =       0.706458964038
             le_variance =       0.499084267870


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242655080275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+27, overlap shift 1.0000e+28 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707642039497       residual = 6.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707642039497       residual = 6.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+27, overlap shift 4.0000e+28 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707642039497       residual = 6.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707642039497       residual = 6.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+28, overlap shift 1.6000e+29 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707642039497       residual = 6.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707642039497       residual = 6.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.347526 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0827e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.438
    reference variance = 0.775185
====================================================
  Execution time = 4.5038e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0071e-01
  Total weights = 2.0000e+06
  Execution time = 3.8123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500740603602
                                         uncertainty =       0.006935731090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500740603602
                                         uncertainty =       0.006935731090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500353436
  error estimate for blocks of size 2^( 2) =       0.000526757241
  error estimate for blocks of size 2^( 3) =       0.000552199707
  error estimate for blocks of size 2^( 4) =       0.000572648985
  error estimate for blocks of size 2^( 5) =       0.000585989561
  error estimate for blocks of size 2^( 6) =       0.000592527132
  error estimate for blocks of size 2^( 7) =       0.000596970093

      target function =      -0.706429594500
              le_mean =     -22.426901166459
             les_mean =     503.466602802561
             stat err =       0.000587033943
             autocorr =       1.376488706584
   target nu stat err =       0.000587033943
   target dn stat err =       0.007111401643
      target stat err =       0.005151870141
              std dev =       0.707606615848
             le_variance =       0.500707122792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500740603602
                                         uncertainty =       0.006935731090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500740603602
                                         uncertainty =       0.006935731090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500353436
  error estimate for blocks of size 2^( 2) =       0.000526757241
  error estimate for blocks of size 2^( 3) =       0.000552199707
  error estimate for blocks of size 2^( 4) =       0.000572648985
  error estimate for blocks of size 2^( 5) =       0.000585989561
  error estimate for blocks of size 2^( 6) =       0.000592527132
  error estimate for blocks of size 2^( 7) =       0.000596970093

      target function =      -0.706429594500
              le_mean =     -22.426901166459
             les_mean =     503.466602802561
             stat err =       0.000587033943
             autocorr =       1.376488706584
   target nu stat err =       0.000587033943
   target dn stat err =       0.007111401643
      target stat err =       0.005151870141
              std dev =       0.707606615848
             le_variance =       0.500707122792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500740603602
                                         uncertainty =       0.006935731090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500740603602
                                         uncertainty =       0.006935731090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500353436
  error estimate for blocks of size 2^( 2) =       0.000526757241
  error estimate for blocks of size 2^( 3) =       0.000552199707
  error estimate for blocks of size 2^( 4) =       0.000572648985
  error estimate for blocks of size 2^( 5) =       0.000585989561
  error estimate for blocks of size 2^( 6) =       0.000592527132
  error estimate for blocks of size 2^( 7) =       0.000596970093

      target function =      -0.706429594500
              le_mean =     -22.426901166459
             les_mean =     503.466602802561
             stat err =       0.000587033943
             autocorr =       1.376488706584
   target nu stat err =       0.000587033943
   target dn stat err =       0.007111401643
      target stat err =       0.005151870141
              std dev =       0.707606615848
             le_variance =       0.500707122792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500740603602
                                         uncertainty =       0.006935731090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500740603602
                                         uncertainty =       0.006935731090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500353436
  error estimate for blocks of size 2^( 2) =       0.000526757241
  error estimate for blocks of size 2^( 3) =       0.000552199707
  error estimate for blocks of size 2^( 4) =       0.000572648985
  error estimate for blocks of size 2^( 5) =       0.000585989561
  error estimate for blocks of size 2^( 6) =       0.000592527132
  error estimate for blocks of size 2^( 7) =       0.000596970093

      target function =      -0.706429594500
              le_mean =     -22.426901166459
             les_mean =     503.466602802561
             stat err =       0.000587033943
             autocorr =       1.376488706584
   target nu stat err =       0.000587033943
   target dn stat err =       0.007111401643
      target stat err =       0.005151870141
              std dev =       0.707606615848
             le_variance =       0.500707122792


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706429594500        initial  <--
     1.0000e+27     1.0000e+28             0.0000e+00        -0.706429594500
     4.0000e+27     4.0000e+28             0.0000e+00        -0.706429594500
     1.6000e+28     1.6000e+29             0.0000e+00        -0.706429594500

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.1614
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2518e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2432e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.4272
    reference variance = 0.389108
====================================================
  Execution time = 4.5417e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9459e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5057e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494623690871
                                         uncertainty =       0.003814618698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494623690871
                                         uncertainty =       0.003814618698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497287129
  error estimate for blocks of size 2^( 2) =       0.000524351423
  error estimate for blocks of size 2^( 3) =       0.000549756770
  error estimate for blocks of size 2^( 4) =       0.000568714651
  error estimate for blocks of size 2^( 5) =       0.000581070803
  error estimate for blocks of size 2^( 6) =       0.000586890109
  error estimate for blocks of size 2^( 7) =       0.000590459330

      target function =      -0.710870378771
              le_mean =     -22.427916885767
             les_mean =     503.506044565755
             stat err =       0.000581783723
             autocorr =       1.368701348519
   target nu stat err =       0.000581783723
   target dn stat err =       0.003790224102
      target stat err =       0.002829362878
              std dev =       0.703270202827
             le_variance =       0.494588978184


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242791688577e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+28, overlap shift 1.0000e+29 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710880787901       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710880787901       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710880787927       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+28 is 3.537849e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+28, overlap shift 4.0000e+29 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710880787901       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710880787901       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710880787810       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+28 is 8.844623e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+29, overlap shift 1.6000e+30 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710880787901       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710880787901       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710880788043       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+29 is 2.211156e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.348908 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0482e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.4004
    reference variance = 0.421522
====================================================
  Execution time = 4.7328e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0035e-01
  Total weights = 2.0000e+06
  Execution time = 3.8365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500247432709
                                         uncertainty =       0.003435368320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500247432709
                                         uncertainty =       0.003435368320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500176435
  error estimate for blocks of size 2^( 2) =       0.000527081314
  error estimate for blocks of size 2^( 3) =       0.000552495329
  error estimate for blocks of size 2^( 4) =       0.000572668493
  error estimate for blocks of size 2^( 5) =       0.000584734651
  error estimate for blocks of size 2^( 6) =       0.000591204707
  error estimate for blocks of size 2^( 7) =       0.000594151127

      target function =      -0.706723991497
              le_mean =     -22.426130958558
             les_mean =     503.431702451810
             stat err =       0.000585689745
             autocorr =       1.371162054588
   target nu stat err =       0.000585689745
   target dn stat err =       0.004124382276
      target stat err =       0.003026101949
              std dev =       0.707356297474
             le_variance =       0.500352931576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500247432709
                                         uncertainty =       0.003435368320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500247432709
                                         uncertainty =       0.003435368320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500176435
  error estimate for blocks of size 2^( 2) =       0.000527081314
  error estimate for blocks of size 2^( 3) =       0.000552495329
  error estimate for blocks of size 2^( 4) =       0.000572668493
  error estimate for blocks of size 2^( 5) =       0.000584734651
  error estimate for blocks of size 2^( 6) =       0.000591204707
  error estimate for blocks of size 2^( 7) =       0.000594151127

      target function =      -0.706723991497
              le_mean =     -22.426130958558
             les_mean =     503.431702451810
             stat err =       0.000585689745
             autocorr =       1.371162054592
   target nu stat err =       0.000585689745
   target dn stat err =       0.004124382276
      target stat err =       0.003026101949
              std dev =       0.707356297474
             le_variance =       0.500352931576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500247432709
                                         uncertainty =       0.003435368320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500247432709
                                         uncertainty =       0.003435368320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500176435
  error estimate for blocks of size 2^( 2) =       0.000527081314
  error estimate for blocks of size 2^( 3) =       0.000552495329
  error estimate for blocks of size 2^( 4) =       0.000572668493
  error estimate for blocks of size 2^( 5) =       0.000584734651
  error estimate for blocks of size 2^( 6) =       0.000591204707
  error estimate for blocks of size 2^( 7) =       0.000594151127

      target function =      -0.706723991497
              le_mean =     -22.426130958558
             les_mean =     503.431702451810
             stat err =       0.000585689745
             autocorr =       1.371162054592
   target nu stat err =       0.000585689745
   target dn stat err =       0.004124382276
      target stat err =       0.003026101949
              std dev =       0.707356297474
             le_variance =       0.500352931576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500247432709
                                         uncertainty =       0.003435368320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500247432709
                                         uncertainty =       0.003435368320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500176435
  error estimate for blocks of size 2^( 2) =       0.000527081314
  error estimate for blocks of size 2^( 3) =       0.000552495329
  error estimate for blocks of size 2^( 4) =       0.000572668493
  error estimate for blocks of size 2^( 5) =       0.000584734651
  error estimate for blocks of size 2^( 6) =       0.000591204707
  error estimate for blocks of size 2^( 7) =       0.000594151127

      target function =      -0.706723991497
              le_mean =     -22.426130958558
             les_mean =     503.431702451810
             stat err =       0.000585689745
             autocorr =       1.371162054592
   target nu stat err =       0.000585689745
   target dn stat err =       0.004124382276
      target stat err =       0.003026101949
              std dev =       0.707356297474
             le_variance =       0.500352931576


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706723991497        initial  <--
     1.0000e+28     1.0000e+29             3.5378e-33        -0.706723991497
     4.0000e+28     4.0000e+29             8.8446e-34        -0.706723991497
     1.6000e+29     1.6000e+30             2.2112e-34        -0.706723991497

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.5394
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2704e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2432e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.3175
    reference variance = 0.385043
====================================================
  Execution time = 4.5989e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9930e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5025e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499418227987
                                         uncertainty =       0.005069305119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499418227987
                                         uncertainty =       0.005069305119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499651064
  error estimate for blocks of size 2^( 2) =       0.000526148027
  error estimate for blocks of size 2^( 3) =       0.000552167415
  error estimate for blocks of size 2^( 4) =       0.000571344887
  error estimate for blocks of size 2^( 5) =       0.000583091697
  error estimate for blocks of size 2^( 6) =       0.000590480159
  error estimate for blocks of size 2^( 7) =       0.000594840337

      target function =      -0.707463655906
              le_mean =     -22.426738932258
             les_mean =     503.457921257982
             stat err =       0.000584939270
             autocorr =       1.370528036518
   target nu stat err =       0.000584939270
   target dn stat err =       0.004962640593
      target stat err =       0.003629780620
              std dev =       0.706613311476
             le_variance =       0.499302371955


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242673893226e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+29, overlap shift 1.0000e+30 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707481184069       residual = 7.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707481184069       residual = 9.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707481184069       residual = 4.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+29 is 7.003643e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+29, overlap shift 4.0000e+30 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707481184069       residual = 7.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707481184069       residual = 9.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707481184069       residual = 4.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+29 is 1.750911e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+30, overlap shift 1.6000e+31 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707481184069       residual = 7.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707481184069       residual = 9.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707481184069       residual = 4.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+30 is 4.377277e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.350227 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1021e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.3603
    reference variance = 0.321002
====================================================
  Execution time = 4.7076e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9861e-01
  Total weights = 2.0000e+06
  Execution time = 3.8429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496508155157
                                         uncertainty =       0.003678943538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496508155157
                                         uncertainty =       0.003678943538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499302465
  error estimate for blocks of size 2^( 2) =       0.000525532762
  error estimate for blocks of size 2^( 3) =       0.000550633940
  error estimate for blocks of size 2^( 4) =       0.000570195073
  error estimate for blocks of size 2^( 5) =       0.000583424071
  error estimate for blocks of size 2^( 6) =       0.000590888062
  error estimate for blocks of size 2^( 7) =       0.000594931769

      target function =      -0.707971777879
              le_mean =     -22.426521356281
             les_mean =     503.447465797227
             stat err =       0.000584859744
             autocorr =       1.372069275798
   target nu stat err =       0.000584859744
   target dn stat err =       0.004752263534
      target stat err =       0.003483965684
              std dev =       0.706120317509
             le_variance =       0.498605902800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496508155157
                                         uncertainty =       0.003678943538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496508155157
                                         uncertainty =       0.003678943538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499302465
  error estimate for blocks of size 2^( 2) =       0.000525532762
  error estimate for blocks of size 2^( 3) =       0.000550633940
  error estimate for blocks of size 2^( 4) =       0.000570195073
  error estimate for blocks of size 2^( 5) =       0.000583424071
  error estimate for blocks of size 2^( 6) =       0.000590888062
  error estimate for blocks of size 2^( 7) =       0.000594931769

      target function =      -0.707971777879
              le_mean =     -22.426521356281
             les_mean =     503.447465797227
             stat err =       0.000584859744
             autocorr =       1.372069275798
   target nu stat err =       0.000584859744
   target dn stat err =       0.004752263534
      target stat err =       0.003483965684
              std dev =       0.706120317509
             le_variance =       0.498605902800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496508155157
                                         uncertainty =       0.003678943538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496508155157
                                         uncertainty =       0.003678943538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499302465
  error estimate for blocks of size 2^( 2) =       0.000525532762
  error estimate for blocks of size 2^( 3) =       0.000550633940
  error estimate for blocks of size 2^( 4) =       0.000570195073
  error estimate for blocks of size 2^( 5) =       0.000583424071
  error estimate for blocks of size 2^( 6) =       0.000590888062
  error estimate for blocks of size 2^( 7) =       0.000594931769

      target function =      -0.707971777879
              le_mean =     -22.426521356281
             les_mean =     503.447465797227
             stat err =       0.000584859744
             autocorr =       1.372069275798
   target nu stat err =       0.000584859744
   target dn stat err =       0.004752263534
      target stat err =       0.003483965684
              std dev =       0.706120317509
             le_variance =       0.498605902800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496508155157
                                         uncertainty =       0.003678943538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496508155157
                                         uncertainty =       0.003678943538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499302465
  error estimate for blocks of size 2^( 2) =       0.000525532762
  error estimate for blocks of size 2^( 3) =       0.000550633940
  error estimate for blocks of size 2^( 4) =       0.000570195073
  error estimate for blocks of size 2^( 5) =       0.000583424071
  error estimate for blocks of size 2^( 6) =       0.000590888062
  error estimate for blocks of size 2^( 7) =       0.000594931769

      target function =      -0.707971777879
              le_mean =     -22.426521356281
             les_mean =     503.447465797227
             stat err =       0.000584859744
             autocorr =       1.372069275798
   target nu stat err =       0.000584859744
   target dn stat err =       0.004752263534
      target stat err =       0.003483965684
              std dev =       0.706120317509
             le_variance =       0.498605902800


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707971777879        initial  <--
     1.0000e+29     1.0000e+30             7.0036e-34        -0.707971777879
     4.0000e+29     4.0000e+30             1.7509e-34        -0.707971777879
     1.6000e+30     1.6000e+31             4.3773e-35        -0.707971777879

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.2640
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2733e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2429e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.4065
    reference variance = 0.289703
====================================================
  Execution time = 4.6137e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2428e+01
  VMC Evar = 5.1009e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5329e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510179372834
                                         uncertainty =       0.016805653416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510179372834
                                         uncertainty =       0.016805653416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505019340
  error estimate for blocks of size 2^( 2) =       0.000531551096
  error estimate for blocks of size 2^( 3) =       0.000556799816
  error estimate for blocks of size 2^( 4) =       0.000575102385
  error estimate for blocks of size 2^( 5) =       0.000587336854
  error estimate for blocks of size 2^( 6) =       0.000594630150
  error estimate for blocks of size 2^( 7) =       0.000598981956

      target function =      -0.699547767709
              le_mean =     -22.427658780551
             les_mean =     503.509967188379
             stat err =       0.000589012836
             autocorr =       1.360296244634
   target nu stat err =       0.000589012836
   target dn stat err =       0.017047386011
      target stat err =       0.012059519776
              std dev =       0.714205199211
             le_variance =       0.510089066580


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242765878055e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+30, overlap shift 1.0000e+31 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.699755722519       residual = 4.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699755722519       residual = 4.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+30, overlap shift 4.0000e+31 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.699755722519       residual = 4.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699755722519       residual = 4.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+31, overlap shift 1.6000e+32 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.699755722519       residual = 4.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699755722519       residual = 4.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.351407 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1473e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.2953
    reference variance = 0.651243
====================================================
  Execution time = 4.5873e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9523e-01
  Total weights = 2.0000e+06
  Execution time = 3.8402e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495292669848
                                         uncertainty =       0.003332117817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495292669848
                                         uncertainty =       0.003332117817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497611442
  error estimate for blocks of size 2^( 2) =       0.000524401498
  error estimate for blocks of size 2^( 3) =       0.000550270794
  error estimate for blocks of size 2^( 4) =       0.000569638155
  error estimate for blocks of size 2^( 5) =       0.000583367242
  error estimate for blocks of size 2^( 6) =       0.000590376104
  error estimate for blocks of size 2^( 7) =       0.000593868090

      target function =      -0.710419118059
              le_mean =     -22.426855628692
             les_mean =     503.459087436735
             stat err =       0.000584312398
             autocorr =       1.378826072534
   target nu stat err =       0.000584312398
   target dn stat err =       0.003318657569
      target stat err =       0.002487808709
              std dev =       0.703728849891
             le_variance =       0.495234294169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495292669848
                                         uncertainty =       0.003332117817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495292669848
                                         uncertainty =       0.003332117817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497611442
  error estimate for blocks of size 2^( 2) =       0.000524401498
  error estimate for blocks of size 2^( 3) =       0.000550270794
  error estimate for blocks of size 2^( 4) =       0.000569638155
  error estimate for blocks of size 2^( 5) =       0.000583367242
  error estimate for blocks of size 2^( 6) =       0.000590376104
  error estimate for blocks of size 2^( 7) =       0.000593868090

      target function =      -0.710419118059
              le_mean =     -22.426855628692
             les_mean =     503.459087436735
             stat err =       0.000584312398
             autocorr =       1.378826072534
   target nu stat err =       0.000584312398
   target dn stat err =       0.003318657569
      target stat err =       0.002487808709
              std dev =       0.703728849891
             le_variance =       0.495234294169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495292669848
                                         uncertainty =       0.003332117817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495292669848
                                         uncertainty =       0.003332117817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497611442
  error estimate for blocks of size 2^( 2) =       0.000524401498
  error estimate for blocks of size 2^( 3) =       0.000550270794
  error estimate for blocks of size 2^( 4) =       0.000569638155
  error estimate for blocks of size 2^( 5) =       0.000583367242
  error estimate for blocks of size 2^( 6) =       0.000590376104
  error estimate for blocks of size 2^( 7) =       0.000593868090

      target function =      -0.710419118059
              le_mean =     -22.426855628692
             les_mean =     503.459087436735
             stat err =       0.000584312398
             autocorr =       1.378826072534
   target nu stat err =       0.000584312398
   target dn stat err =       0.003318657569
      target stat err =       0.002487808709
              std dev =       0.703728849891
             le_variance =       0.495234294169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495292669848
                                         uncertainty =       0.003332117817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495292669848
                                         uncertainty =       0.003332117817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497611442
  error estimate for blocks of size 2^( 2) =       0.000524401498
  error estimate for blocks of size 2^( 3) =       0.000550270794
  error estimate for blocks of size 2^( 4) =       0.000569638155
  error estimate for blocks of size 2^( 5) =       0.000583367242
  error estimate for blocks of size 2^( 6) =       0.000590376104
  error estimate for blocks of size 2^( 7) =       0.000593868090

      target function =      -0.710419118059
              le_mean =     -22.426855628692
             les_mean =     503.459087436735
             stat err =       0.000584312398
             autocorr =       1.378826072534
   target nu stat err =       0.000584312398
   target dn stat err =       0.003318657569
      target stat err =       0.002487808709
              std dev =       0.703728849891
             le_variance =       0.495234294169


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.710419118059        initial  <--
     1.0000e+30     1.0000e+31             0.0000e+00        -0.710419118059
     4.0000e+30     4.0000e+31             0.0000e+00        -0.710419118059
     1.6000e+31     1.6000e+32             0.0000e+00        -0.710419118059

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.0719
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2655e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2426e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.3793
    reference variance = 0.388194
====================================================
  Execution time = 4.7799e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9916e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5089e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498020253874
                                         uncertainty =       0.003839122860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498020253874
                                         uncertainty =       0.003839122860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499581505
  error estimate for blocks of size 2^( 2) =       0.000526159999
  error estimate for blocks of size 2^( 3) =       0.000550722045
  error estimate for blocks of size 2^( 4) =       0.000570255852
  error estimate for blocks of size 2^( 5) =       0.000580882015
  error estimate for blocks of size 2^( 6) =       0.000587178511
  error estimate for blocks of size 2^( 7) =       0.000590163444

      target function =      -0.707561184088
              le_mean =     -22.427144104839
             les_mean =     503.475955809742
             stat err =       0.000582119955
             autocorr =       1.357726425116
   target nu stat err =       0.000582119955
   target dn stat err =       0.004151511711
      target stat err =       0.003056071339
              std dev =       0.706514939755
             le_variance =       0.499163360096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242714410484e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+31, overlap shift 1.0000e+32 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707573831780       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707573831780       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+31, overlap shift 4.0000e+32 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707573831780       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707573831780       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+32, overlap shift 1.6000e+33 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707573831780       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707573831780       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.352527 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2897e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.4984
    reference variance = 0.369279
====================================================
  Execution time = 4.4874e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9771e-01
  Total weights = 2.0000e+06
  Execution time = 3.8515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497666080135
                                         uncertainty =       0.003685290980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497666080135
                                         uncertainty =       0.003685290980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498852479
  error estimate for blocks of size 2^( 2) =       0.000525660797
  error estimate for blocks of size 2^( 3) =       0.000551730620
  error estimate for blocks of size 2^( 4) =       0.000570978415
  error estimate for blocks of size 2^( 5) =       0.000583246420
  error estimate for blocks of size 2^( 6) =       0.000591353521
  error estimate for blocks of size 2^( 7) =       0.000597238944

      target function =      -0.708602202966
              le_mean =     -22.427982088132
             les_mean =     503.512087888248
             stat err =       0.000585704325
             autocorr =       1.378518480225
   target nu stat err =       0.000585704325
   target dn stat err =       0.003578847855
      target stat err =       0.002663301928
              std dev =       0.705483941372
             le_variance =       0.497707591534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497666080135
                                         uncertainty =       0.003685290980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497666080135
                                         uncertainty =       0.003685290980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498852479
  error estimate for blocks of size 2^( 2) =       0.000525660797
  error estimate for blocks of size 2^( 3) =       0.000551730620
  error estimate for blocks of size 2^( 4) =       0.000570978415
  error estimate for blocks of size 2^( 5) =       0.000583246420
  error estimate for blocks of size 2^( 6) =       0.000591353521
  error estimate for blocks of size 2^( 7) =       0.000597238944

      target function =      -0.708602202966
              le_mean =     -22.427982088132
             les_mean =     503.512087888248
             stat err =       0.000585704325
             autocorr =       1.378518480225
   target nu stat err =       0.000585704325
   target dn stat err =       0.003578847855
      target stat err =       0.002663301928
              std dev =       0.705483941372
             le_variance =       0.497707591534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497666080135
                                         uncertainty =       0.003685290980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497666080135
                                         uncertainty =       0.003685290980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498852479
  error estimate for blocks of size 2^( 2) =       0.000525660797
  error estimate for blocks of size 2^( 3) =       0.000551730620
  error estimate for blocks of size 2^( 4) =       0.000570978415
  error estimate for blocks of size 2^( 5) =       0.000583246420
  error estimate for blocks of size 2^( 6) =       0.000591353521
  error estimate for blocks of size 2^( 7) =       0.000597238944

      target function =      -0.708602202966
              le_mean =     -22.427982088132
             les_mean =     503.512087888248
             stat err =       0.000585704325
             autocorr =       1.378518480225
   target nu stat err =       0.000585704325
   target dn stat err =       0.003578847855
      target stat err =       0.002663301928
              std dev =       0.705483941372
             le_variance =       0.497707591534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497666080135
                                         uncertainty =       0.003685290980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497666080135
                                         uncertainty =       0.003685290980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498852479
  error estimate for blocks of size 2^( 2) =       0.000525660797
  error estimate for blocks of size 2^( 3) =       0.000551730620
  error estimate for blocks of size 2^( 4) =       0.000570978415
  error estimate for blocks of size 2^( 5) =       0.000583246420
  error estimate for blocks of size 2^( 6) =       0.000591353521
  error estimate for blocks of size 2^( 7) =       0.000597238944

      target function =      -0.708602202966
              le_mean =     -22.427982088132
             les_mean =     503.512087888248
             stat err =       0.000585704325
             autocorr =       1.378518480225
   target nu stat err =       0.000585704325
   target dn stat err =       0.003578847855
      target stat err =       0.002663301928
              std dev =       0.705483941372
             le_variance =       0.497707591534


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.708602202966        initial  <--
     1.0000e+31     1.0000e+32             0.0000e+00        -0.708602202966
     4.0000e+31     4.0000e+32             0.0000e+00        -0.708602202966
     1.6000e+32     1.6000e+33             0.0000e+00        -0.708602202966

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0345
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2694e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2427e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.4699
    reference variance = 0.510929
====================================================
  Execution time = 4.7908e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0302e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5128e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503058689837
                                         uncertainty =       0.004808227923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503058689837
                                         uncertainty =       0.004808227923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501506034
  error estimate for blocks of size 2^( 2) =       0.000527747339
  error estimate for blocks of size 2^( 3) =       0.000552716430
  error estimate for blocks of size 2^( 4) =       0.000571814804
  error estimate for blocks of size 2^( 5) =       0.000583076679
  error estimate for blocks of size 2^( 6) =       0.000591866348
  error estimate for blocks of size 2^( 7) =       0.000597152488

      target function =      -0.704788305969
              le_mean =     -22.427208405436
             les_mean =     503.482693213610
             stat err =       0.000585977580
             autocorr =       1.365242105232
   target nu stat err =       0.000585977580
   target dn stat err =       0.004216587297
      target stat err =       0.003079398509
              std dev =       0.709236634895
             le_variance =       0.503016604277


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242720840544e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+32, overlap shift 1.0000e+33 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.704800798180       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.704800798180       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+32, overlap shift 4.0000e+33 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.704800798180       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.704800798180       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+33, overlap shift 1.6000e+34 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.704800798180       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.704800798180       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.353648 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3060e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.3821
    reference variance = 0.435488
====================================================
  Execution time = 4.4888e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9895e-01
  Total weights = 2.0000e+06
  Execution time = 3.8225e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498959567904
                                         uncertainty =       0.005911229486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498959567904
                                         uncertainty =       0.005911229486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499473588
  error estimate for blocks of size 2^( 2) =       0.000526088474
  error estimate for blocks of size 2^( 3) =       0.000551713600
  error estimate for blocks of size 2^( 4) =       0.000571296538
  error estimate for blocks of size 2^( 5) =       0.000584671957
  error estimate for blocks of size 2^( 6) =       0.000593319294
  error estimate for blocks of size 2^( 7) =       0.000595724989

      target function =      -0.707725832082
              le_mean =     -22.425937856098
             les_mean =     503.421636207294
             stat err =       0.000586253195
             autocorr =       1.377670592001
   target nu stat err =       0.000586253195
   target dn stat err =       0.005988498533
      target stat err =       0.004359947533
              std dev =       0.706362322891
             le_variance =       0.498947731201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498959567904
                                         uncertainty =       0.005911229486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498959567904
                                         uncertainty =       0.005911229486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499473588
  error estimate for blocks of size 2^( 2) =       0.000526088474
  error estimate for blocks of size 2^( 3) =       0.000551713600
  error estimate for blocks of size 2^( 4) =       0.000571296538
  error estimate for blocks of size 2^( 5) =       0.000584671957
  error estimate for blocks of size 2^( 6) =       0.000593319294
  error estimate for blocks of size 2^( 7) =       0.000595724989

      target function =      -0.707725832082
              le_mean =     -22.425937856098
             les_mean =     503.421636207294
             stat err =       0.000586253195
             autocorr =       1.377670592000
   target nu stat err =       0.000586253195
   target dn stat err =       0.005988498533
      target stat err =       0.004359947533
              std dev =       0.706362322891
             le_variance =       0.498947731201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498959567904
                                         uncertainty =       0.005911229486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498959567904
                                         uncertainty =       0.005911229486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499473588
  error estimate for blocks of size 2^( 2) =       0.000526088474
  error estimate for blocks of size 2^( 3) =       0.000551713600
  error estimate for blocks of size 2^( 4) =       0.000571296538
  error estimate for blocks of size 2^( 5) =       0.000584671957
  error estimate for blocks of size 2^( 6) =       0.000593319294
  error estimate for blocks of size 2^( 7) =       0.000595724989

      target function =      -0.707725832082
              le_mean =     -22.425937856098
             les_mean =     503.421636207294
             stat err =       0.000586253195
             autocorr =       1.377670592000
   target nu stat err =       0.000586253195
   target dn stat err =       0.005988498533
      target stat err =       0.004359947533
              std dev =       0.706362322891
             le_variance =       0.498947731201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498959567904
                                         uncertainty =       0.005911229486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498959567904
                                         uncertainty =       0.005911229486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499473588
  error estimate for blocks of size 2^( 2) =       0.000526088474
  error estimate for blocks of size 2^( 3) =       0.000551713600
  error estimate for blocks of size 2^( 4) =       0.000571296538
  error estimate for blocks of size 2^( 5) =       0.000584671957
  error estimate for blocks of size 2^( 6) =       0.000593319294
  error estimate for blocks of size 2^( 7) =       0.000595724989

      target function =      -0.707725832082
              le_mean =     -22.425937856098
             les_mean =     503.421636207294
             stat err =       0.000586253195
             autocorr =       1.377670592000
   target nu stat err =       0.000586253195
   target dn stat err =       0.005988498533
      target stat err =       0.004359947533
              std dev =       0.706362322891
             le_variance =       0.498947731201


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707725832082        initial  <--
     1.0000e+32     1.0000e+33             0.0000e+00        -0.707725832082
     4.0000e+32     4.0000e+33             0.0000e+00        -0.707725832082
     1.6000e+33     1.6000e+34             0.0000e+00        -0.707725832082

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9947
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2706e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2426e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.479
    reference variance = 0.453436
====================================================
  Execution time = 4.6227e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9564e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5567e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495698397208
                                         uncertainty =       0.004017591742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495698397208
                                         uncertainty =       0.004017591742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497815389
  error estimate for blocks of size 2^( 2) =       0.000524688126
  error estimate for blocks of size 2^( 3) =       0.000550153322
  error estimate for blocks of size 2^( 4) =       0.000568058242
  error estimate for blocks of size 2^( 5) =       0.000581075550
  error estimate for blocks of size 2^( 6) =       0.000587723760
  error estimate for blocks of size 2^( 7) =       0.000591975275

      target function =      -0.710118640504
              le_mean =     -22.426954889074
             les_mean =     503.463945672208
             stat err =       0.000582208207
             autocorr =       1.367791844180
   target nu stat err =       0.000582208207
   target dn stat err =       0.003998322977
      target stat err =       0.002967759315
              std dev =       0.704017274994
             le_variance =       0.495640323490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242695488907e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+33, overlap shift 1.0000e+34 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710129950305       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710129950305       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+33, overlap shift 4.0000e+34 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710129950305       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710129950305       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+34, overlap shift 1.6000e+35 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710129950305       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710129950305       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.354779 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1803e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.3748
    reference variance = 0.335441
====================================================
  Execution time = 4.5242e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2429e+01
  VMC Evar = 4.9960e-01
  Total weights = 2.0000e+06
  Execution time = 3.8162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499629081001
                                         uncertainty =       0.006355489503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499629081001
                                         uncertainty =       0.006355489503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499799692
  error estimate for blocks of size 2^( 2) =       0.000526148303
  error estimate for blocks of size 2^( 3) =       0.000551731602
  error estimate for blocks of size 2^( 4) =       0.000571227310
  error estimate for blocks of size 2^( 5) =       0.000583916511
  error estimate for blocks of size 2^( 6) =       0.000589714822
  error estimate for blocks of size 2^( 7) =       0.000592674590

      target function =      -0.707202189045
              le_mean =     -22.428561312521
             les_mean =     503.539961764478
             stat err =       0.000584383308
             autocorr =       1.367110555866
   target nu stat err =       0.000584383308
   target dn stat err =       0.006178671684
      target stat err =       0.004506031869
              std dev =       0.706823503272
             le_variance =       0.499599464778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499629081001
                                         uncertainty =       0.006355489503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499629081001
                                         uncertainty =       0.006355489503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499799692
  error estimate for blocks of size 2^( 2) =       0.000526148303
  error estimate for blocks of size 2^( 3) =       0.000551731602
  error estimate for blocks of size 2^( 4) =       0.000571227310
  error estimate for blocks of size 2^( 5) =       0.000583916511
  error estimate for blocks of size 2^( 6) =       0.000589714822
  error estimate for blocks of size 2^( 7) =       0.000592674590

      target function =      -0.707202189045
              le_mean =     -22.428561312521
             les_mean =     503.539961764478
             stat err =       0.000584383308
             autocorr =       1.367110555866
   target nu stat err =       0.000584383308
   target dn stat err =       0.006178671684
      target stat err =       0.004506031869
              std dev =       0.706823503272
             le_variance =       0.499599464778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499629081001
                                         uncertainty =       0.006355489503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499629081001
                                         uncertainty =       0.006355489503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499799692
  error estimate for blocks of size 2^( 2) =       0.000526148303
  error estimate for blocks of size 2^( 3) =       0.000551731602
  error estimate for blocks of size 2^( 4) =       0.000571227310
  error estimate for blocks of size 2^( 5) =       0.000583916511
  error estimate for blocks of size 2^( 6) =       0.000589714822
  error estimate for blocks of size 2^( 7) =       0.000592674590

      target function =      -0.707202189045
              le_mean =     -22.428561312521
             les_mean =     503.539961764478
             stat err =       0.000584383308
             autocorr =       1.367110555866
   target nu stat err =       0.000584383308
   target dn stat err =       0.006178671684
      target stat err =       0.004506031869
              std dev =       0.706823503272
             le_variance =       0.499599464778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499629081001
                                         uncertainty =       0.006355489503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499629081001
                                         uncertainty =       0.006355489503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499799692
  error estimate for blocks of size 2^( 2) =       0.000526148303
  error estimate for blocks of size 2^( 3) =       0.000551731602
  error estimate for blocks of size 2^( 4) =       0.000571227310
  error estimate for blocks of size 2^( 5) =       0.000583916511
  error estimate for blocks of size 2^( 6) =       0.000589714822
  error estimate for blocks of size 2^( 7) =       0.000592674590

      target function =      -0.707202189045
              le_mean =     -22.428561312521
             les_mean =     503.539961764478
             stat err =       0.000584383308
             autocorr =       1.367110555866
   target nu stat err =       0.000584383308
   target dn stat err =       0.006178671684
      target stat err =       0.004506031869
              std dev =       0.706823503272
             le_variance =       0.499599464778


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707202189045        initial  <--
     1.0000e+33     1.0000e+34             0.0000e+00        -0.707202189045
     4.0000e+33     4.0000e+34             0.0000e+00        -0.707202189045
     1.6000e+34     1.6000e+35             0.0000e+00        -0.707202189045

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.3664
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2618e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2427e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.3179
    reference variance = 0.576708
====================================================
  Execution time = 4.5917e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9081e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5338e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490758683200
                                         uncertainty =       0.002825062902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490758683200
                                         uncertainty =       0.002825062902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495382832
  error estimate for blocks of size 2^( 2) =       0.000522174614
  error estimate for blocks of size 2^( 3) =       0.000547666565
  error estimate for blocks of size 2^( 4) =       0.000566841235
  error estimate for blocks of size 2^( 5) =       0.000580939893
  error estimate for blocks of size 2^( 6) =       0.000586117902
  error estimate for blocks of size 2^( 7) =       0.000589396186

      target function =      -0.713658850449
              le_mean =     -22.426669999729
             les_mean =     503.446335332118
             stat err =       0.000580823804
             autocorr =       1.374696765513
   target nu stat err =       0.000580823804
   target dn stat err =       0.002702428422
      target stat err =       0.002071814450
              std dev =       0.700577119784
             le_variance =       0.490808300765


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242666999973e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+34, overlap shift 1.0000e+35 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713663850909       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713663850909       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+34, overlap shift 4.0000e+35 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713663850909       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713663850909       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+35, overlap shift 1.6000e+36 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713663850909       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713663850909       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.355918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1263e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.4281
    reference variance = 0.336007
====================================================
  Execution time = 4.7066e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9968e-01
  Total weights = 2.0000e+06
  Execution time = 3.8368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499691847342
                                         uncertainty =       0.004282917386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499691847342
                                         uncertainty =       0.004282917386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499841411
  error estimate for blocks of size 2^( 2) =       0.000526133520
  error estimate for blocks of size 2^( 3) =       0.000551929949
  error estimate for blocks of size 2^( 4) =       0.000570963666
  error estimate for blocks of size 2^( 5) =       0.000584389205
  error estimate for blocks of size 2^( 6) =       0.000591857850
  error estimate for blocks of size 2^( 7) =       0.000597068112

      target function =      -0.707183663161
              le_mean =     -22.427300863246
             les_mean =     503.483506633728
             stat err =       0.000586069708
             autocorr =       1.374782772620
   target nu stat err =       0.000586069708
   target dn stat err =       0.004136679107
      target stat err =       0.003043853383
              std dev =       0.706882502961
             le_variance =       0.499682872992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499691847342
                                         uncertainty =       0.004282917386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499691847342
                                         uncertainty =       0.004282917386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499841411
  error estimate for blocks of size 2^( 2) =       0.000526133520
  error estimate for blocks of size 2^( 3) =       0.000551929949
  error estimate for blocks of size 2^( 4) =       0.000570963666
  error estimate for blocks of size 2^( 5) =       0.000584389205
  error estimate for blocks of size 2^( 6) =       0.000591857850
  error estimate for blocks of size 2^( 7) =       0.000597068112

      target function =      -0.707183663161
              le_mean =     -22.427300863246
             les_mean =     503.483506633728
             stat err =       0.000586069708
             autocorr =       1.374782772621
   target nu stat err =       0.000586069708
   target dn stat err =       0.004136679107
      target stat err =       0.003043853383
              std dev =       0.706882502961
             le_variance =       0.499682872992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499691847342
                                         uncertainty =       0.004282917386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499691847342
                                         uncertainty =       0.004282917386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499841411
  error estimate for blocks of size 2^( 2) =       0.000526133520
  error estimate for blocks of size 2^( 3) =       0.000551929949
  error estimate for blocks of size 2^( 4) =       0.000570963666
  error estimate for blocks of size 2^( 5) =       0.000584389205
  error estimate for blocks of size 2^( 6) =       0.000591857850
  error estimate for blocks of size 2^( 7) =       0.000597068112

      target function =      -0.707183663161
              le_mean =     -22.427300863246
             les_mean =     503.483506633728
             stat err =       0.000586069708
             autocorr =       1.374782772621
   target nu stat err =       0.000586069708
   target dn stat err =       0.004136679107
      target stat err =       0.003043853383
              std dev =       0.706882502961
             le_variance =       0.499682872992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499691847342
                                         uncertainty =       0.004282917386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499691847342
                                         uncertainty =       0.004282917386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499841411
  error estimate for blocks of size 2^( 2) =       0.000526133520
  error estimate for blocks of size 2^( 3) =       0.000551929949
  error estimate for blocks of size 2^( 4) =       0.000570963666
  error estimate for blocks of size 2^( 5) =       0.000584389205
  error estimate for blocks of size 2^( 6) =       0.000591857850
  error estimate for blocks of size 2^( 7) =       0.000597068112

      target function =      -0.707183663161
              le_mean =     -22.427300863246
             les_mean =     503.483506633728
             stat err =       0.000586069708
             autocorr =       1.374782772621
   target nu stat err =       0.000586069708
   target dn stat err =       0.004136679107
      target stat err =       0.003043853383
              std dev =       0.706882502961
             le_variance =       0.499682872992


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707183663161        initial  <--
     1.0000e+34     1.0000e+35             0.0000e+00        -0.707183663161
     4.0000e+34     4.0000e+35             0.0000e+00        -0.707183663161
     1.6000e+35     1.6000e+36             0.0000e+00        -0.707183663161

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.2002
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2747e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2425e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.4408
    reference variance = 0.314142
====================================================
  Execution time = 4.5979e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0062e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5235e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500643465640
                                         uncertainty =       0.003595227191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500643465640
                                         uncertainty =       0.003595227191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500308650
  error estimate for blocks of size 2^( 2) =       0.000526404741
  error estimate for blocks of size 2^( 3) =       0.000551810752
  error estimate for blocks of size 2^( 4) =       0.000571351798
  error estimate for blocks of size 2^( 5) =       0.000583620250
  error estimate for blocks of size 2^( 6) =       0.000590082923
  error estimate for blocks of size 2^( 7) =       0.000589947744

      target function =      -0.706538232272
              le_mean =     -22.426094232055
             les_mean =     503.430319744582
             stat err =       0.000583750679
             autocorr =       1.361378145260
   target nu stat err =       0.000583750679
   target dn stat err =       0.003391426065
      target stat err =       0.002509446792
              std dev =       0.707543277733
             le_variance =       0.500617489865


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242609423206e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+35, overlap shift 1.0000e+36 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706546228332       residual = 5.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706546228332       residual = 5.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+35, overlap shift 4.0000e+36 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706546228332       residual = 5.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706546228332       residual = 5.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+36, overlap shift 1.6000e+37 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706546228332       residual = 5.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706546228332       residual = 5.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.357028 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1221e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.4417
    reference variance = 0.361201
====================================================
  Execution time = 4.6782e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9813e-01
  Total weights = 2.0000e+06
  Execution time = 3.8407e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498089783740
                                         uncertainty =       0.005432226720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498089783740
                                         uncertainty =       0.005432226720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499061801
  error estimate for blocks of size 2^( 2) =       0.000525812904
  error estimate for blocks of size 2^( 3) =       0.000551555290
  error estimate for blocks of size 2^( 4) =       0.000571028286
  error estimate for blocks of size 2^( 5) =       0.000584146183
  error estimate for blocks of size 2^( 6) =       0.000591126243
  error estimate for blocks of size 2^( 7) =       0.000595167210

      target function =      -0.708299749244
              le_mean =     -22.427328573805
             les_mean =     503.483192070106
             stat err =       0.000585366981
             autocorr =       1.375776174038
   target nu stat err =       0.000585366981
   target dn stat err =       0.005425609903
      target stat err =       0.003972361030
              std dev =       0.705779966966
             le_variance =       0.498125361770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498089783740
                                         uncertainty =       0.005432226720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498089783740
                                         uncertainty =       0.005432226720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499061801
  error estimate for blocks of size 2^( 2) =       0.000525812904
  error estimate for blocks of size 2^( 3) =       0.000551555290
  error estimate for blocks of size 2^( 4) =       0.000571028286
  error estimate for blocks of size 2^( 5) =       0.000584146183
  error estimate for blocks of size 2^( 6) =       0.000591126243
  error estimate for blocks of size 2^( 7) =       0.000595167210

      target function =      -0.708299749244
              le_mean =     -22.427328573805
             les_mean =     503.483192070106
             stat err =       0.000585366981
             autocorr =       1.375776174038
   target nu stat err =       0.000585366981
   target dn stat err =       0.005425609903
      target stat err =       0.003972361030
              std dev =       0.705779966966
             le_variance =       0.498125361770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498089783740
                                         uncertainty =       0.005432226720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498089783740
                                         uncertainty =       0.005432226720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499061801
  error estimate for blocks of size 2^( 2) =       0.000525812904
  error estimate for blocks of size 2^( 3) =       0.000551555290
  error estimate for blocks of size 2^( 4) =       0.000571028286
  error estimate for blocks of size 2^( 5) =       0.000584146183
  error estimate for blocks of size 2^( 6) =       0.000591126243
  error estimate for blocks of size 2^( 7) =       0.000595167210

      target function =      -0.708299749244
              le_mean =     -22.427328573805
             les_mean =     503.483192070106
             stat err =       0.000585366981
             autocorr =       1.375776174038
   target nu stat err =       0.000585366981
   target dn stat err =       0.005425609903
      target stat err =       0.003972361030
              std dev =       0.705779966966
             le_variance =       0.498125361770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498089783740
                                         uncertainty =       0.005432226720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498089783740
                                         uncertainty =       0.005432226720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499061801
  error estimate for blocks of size 2^( 2) =       0.000525812904
  error estimate for blocks of size 2^( 3) =       0.000551555290
  error estimate for blocks of size 2^( 4) =       0.000571028286
  error estimate for blocks of size 2^( 5) =       0.000584146183
  error estimate for blocks of size 2^( 6) =       0.000591126243
  error estimate for blocks of size 2^( 7) =       0.000595167210

      target function =      -0.708299749244
              le_mean =     -22.427328573805
             les_mean =     503.483192070106
             stat err =       0.000585366981
             autocorr =       1.375776174038
   target nu stat err =       0.000585366981
   target dn stat err =       0.005425609903
      target stat err =       0.003972361030
              std dev =       0.705779966966
             le_variance =       0.498125361770


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.708299749244        initial  <--
     1.0000e+35     1.0000e+36             0.0000e+00        -0.708299749244
     4.0000e+35     4.0000e+36             0.0000e+00        -0.708299749244
     1.6000e+36     1.6000e+37             0.0000e+00        -0.708299749244

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.9311
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2735e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2425e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.3954
    reference variance = 0.395139
====================================================
  Execution time = 4.5727e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9481e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5128e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493551422254
                                         uncertainty =       0.003206554813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493551422254
                                         uncertainty =       0.003206554813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497397907
  error estimate for blocks of size 2^( 2) =       0.000523729088
  error estimate for blocks of size 2^( 3) =       0.000549425924
  error estimate for blocks of size 2^( 4) =       0.000568966880
  error estimate for blocks of size 2^( 5) =       0.000581135716
  error estimate for blocks of size 2^( 6) =       0.000589002940
  error estimate for blocks of size 2^( 7) =       0.000590784010

      target function =      -0.710734154528
              le_mean =     -22.426364295548
             les_mean =     503.436624625792
             stat err =       0.000582472387
             autocorr =       1.371332521321
   target nu stat err =       0.000582472387
   target dn stat err =       0.003543430635
      target stat err =       0.002646841761
              std dev =       0.703426866539
             le_variance =       0.494809356569


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242636429555e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+36, overlap shift 1.0000e+37 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710743008236       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710743008236       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+36, overlap shift 4.0000e+37 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710743008236       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710743008236       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+37, overlap shift 1.6000e+38 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710743008236       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710743008236       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.358145 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0862e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.4973
    reference variance = 0.592809
====================================================
  Execution time = 4.5644e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9951e-01
  Total weights = 2.0000e+06
  Execution time = 3.8235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499482421323
                                         uncertainty =       0.004875351617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499482421323
                                         uncertainty =       0.004875351617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499756286
  error estimate for blocks of size 2^( 2) =       0.000526173676
  error estimate for blocks of size 2^( 3) =       0.000551567297
  error estimate for blocks of size 2^( 4) =       0.000571506702
  error estimate for blocks of size 2^( 5) =       0.000583715562
  error estimate for blocks of size 2^( 6) =       0.000589381372
  error estimate for blocks of size 2^( 7) =       0.000593824009

      target function =      -0.707293673571
              le_mean =     -22.427660848021
             les_mean =     503.499483554348
             stat err =       0.000584606911
             autocorr =       1.368394627628
   target nu stat err =       0.000584606911
   target dn stat err =       0.004957722779
      target stat err =       0.003629330131
              std dev =       0.706762117166
             le_variance =       0.499512690262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499482421323
                                         uncertainty =       0.004875351617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499482421323
                                         uncertainty =       0.004875351617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499756286
  error estimate for blocks of size 2^( 2) =       0.000526173676
  error estimate for blocks of size 2^( 3) =       0.000551567297
  error estimate for blocks of size 2^( 4) =       0.000571506702
  error estimate for blocks of size 2^( 5) =       0.000583715562
  error estimate for blocks of size 2^( 6) =       0.000589381372
  error estimate for blocks of size 2^( 7) =       0.000593824009

      target function =      -0.707293673571
              le_mean =     -22.427660848021
             les_mean =     503.499483554348
             stat err =       0.000584606911
             autocorr =       1.368394627628
   target nu stat err =       0.000584606911
   target dn stat err =       0.004957722779
      target stat err =       0.003629330131
              std dev =       0.706762117166
             le_variance =       0.499512690262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499482421323
                                         uncertainty =       0.004875351617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499482421323
                                         uncertainty =       0.004875351617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499756286
  error estimate for blocks of size 2^( 2) =       0.000526173676
  error estimate for blocks of size 2^( 3) =       0.000551567297
  error estimate for blocks of size 2^( 4) =       0.000571506702
  error estimate for blocks of size 2^( 5) =       0.000583715562
  error estimate for blocks of size 2^( 6) =       0.000589381372
  error estimate for blocks of size 2^( 7) =       0.000593824009

      target function =      -0.707293673571
              le_mean =     -22.427660848021
             les_mean =     503.499483554348
             stat err =       0.000584606911
             autocorr =       1.368394627628
   target nu stat err =       0.000584606911
   target dn stat err =       0.004957722779
      target stat err =       0.003629330131
              std dev =       0.706762117166
             le_variance =       0.499512690262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499482421323
                                         uncertainty =       0.004875351617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499482421323
                                         uncertainty =       0.004875351617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499756286
  error estimate for blocks of size 2^( 2) =       0.000526173676
  error estimate for blocks of size 2^( 3) =       0.000551567297
  error estimate for blocks of size 2^( 4) =       0.000571506702
  error estimate for blocks of size 2^( 5) =       0.000583715562
  error estimate for blocks of size 2^( 6) =       0.000589381372
  error estimate for blocks of size 2^( 7) =       0.000593824009

      target function =      -0.707293673571
              le_mean =     -22.427660848021
             les_mean =     503.499483554348
             stat err =       0.000584606911
             autocorr =       1.368394627628
   target nu stat err =       0.000584606911
   target dn stat err =       0.004957722779
      target stat err =       0.003629330131
              std dev =       0.706762117166
             le_variance =       0.499512690262


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707293673571        initial  <--
     1.0000e+36     1.0000e+37             0.0000e+00        -0.707293673571
     4.0000e+36     4.0000e+37             0.0000e+00        -0.707293673571
     1.6000e+37     1.6000e+38             0.0000e+00        -0.707293673571

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.4740
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2834e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2426e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.478
    reference variance = 0.442842
====================================================
  Execution time = 4.5831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9569e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5630e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495761996545
                                         uncertainty =       0.004275397403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495761996545
                                         uncertainty =       0.004275397403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497838902
  error estimate for blocks of size 2^( 2) =       0.000524641229
  error estimate for blocks of size 2^( 3) =       0.000549710299
  error estimate for blocks of size 2^( 4) =       0.000568478768
  error estimate for blocks of size 2^( 5) =       0.000580926253
  error estimate for blocks of size 2^( 6) =       0.000586400047
  error estimate for blocks of size 2^( 7) =       0.000588928273

      target function =      -0.710083485210
              le_mean =     -22.426935021360
             les_mean =     503.463101349870
             stat err =       0.000581183335
             autocorr =       1.362851839957
   target nu stat err =       0.000581183335
   target dn stat err =       0.004212732042
      target stat err =       0.003120053350
              std dev =       0.704050527612
             le_variance =       0.495687145431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242693502136e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+37, overlap shift 1.0000e+38 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710096212269       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710096212269       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+37, overlap shift 4.0000e+38 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710096212269       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710096212269       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+38, overlap shift 1.6000e+39 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710096212269       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710096212269       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.359283 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1468e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.3787
    reference variance = 0.398295
====================================================
  Execution time = 4.5509e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9446e-01
  Total weights = 2.0000e+06
  Execution time = 3.8365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494478757896
                                         uncertainty =       0.003968488297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494478757896
                                         uncertainty =       0.003968488297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497224117
  error estimate for blocks of size 2^( 2) =       0.000523827702
  error estimate for blocks of size 2^( 3) =       0.000548979083
  error estimate for blocks of size 2^( 4) =       0.000569008263
  error estimate for blocks of size 2^( 5) =       0.000582155273
  error estimate for blocks of size 2^( 6) =       0.000588744799
  error estimate for blocks of size 2^( 7) =       0.000592122442

      target function =      -0.710967718933
              le_mean =     -22.427550337692
             les_mean =     503.489477547331
             stat err =       0.000583007694
             autocorr =       1.374814812674
   target nu stat err =       0.000583007694
   target dn stat err =       0.003757940694
      target stat err =       0.002805874390
              std dev =       0.703181089654
             le_variance =       0.494463644848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494478757896
                                         uncertainty =       0.003968488297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494478757896
                                         uncertainty =       0.003968488297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497224117
  error estimate for blocks of size 2^( 2) =       0.000523827702
  error estimate for blocks of size 2^( 3) =       0.000548979083
  error estimate for blocks of size 2^( 4) =       0.000569008263
  error estimate for blocks of size 2^( 5) =       0.000582155273
  error estimate for blocks of size 2^( 6) =       0.000588744799
  error estimate for blocks of size 2^( 7) =       0.000592122442

      target function =      -0.710967718933
              le_mean =     -22.427550337692
             les_mean =     503.489477547331
             stat err =       0.000583007694
             autocorr =       1.374814812674
   target nu stat err =       0.000583007694
   target dn stat err =       0.003757940694
      target stat err =       0.002805874390
              std dev =       0.703181089654
             le_variance =       0.494463644848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494478757896
                                         uncertainty =       0.003968488297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494478757896
                                         uncertainty =       0.003968488297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497224117
  error estimate for blocks of size 2^( 2) =       0.000523827702
  error estimate for blocks of size 2^( 3) =       0.000548979083
  error estimate for blocks of size 2^( 4) =       0.000569008263
  error estimate for blocks of size 2^( 5) =       0.000582155273
  error estimate for blocks of size 2^( 6) =       0.000588744799
  error estimate for blocks of size 2^( 7) =       0.000592122442

      target function =      -0.710967718933
              le_mean =     -22.427550337692
             les_mean =     503.489477547331
             stat err =       0.000583007694
             autocorr =       1.374814812674
   target nu stat err =       0.000583007694
   target dn stat err =       0.003757940694
      target stat err =       0.002805874390
              std dev =       0.703181089654
             le_variance =       0.494463644848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494478757896
                                         uncertainty =       0.003968488297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494478757896
                                         uncertainty =       0.003968488297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497224117
  error estimate for blocks of size 2^( 2) =       0.000523827702
  error estimate for blocks of size 2^( 3) =       0.000548979083
  error estimate for blocks of size 2^( 4) =       0.000569008263
  error estimate for blocks of size 2^( 5) =       0.000582155273
  error estimate for blocks of size 2^( 6) =       0.000588744799
  error estimate for blocks of size 2^( 7) =       0.000592122442

      target function =      -0.710967718933
              le_mean =     -22.427550337692
             les_mean =     503.489477547331
             stat err =       0.000583007694
             autocorr =       1.374814812674
   target nu stat err =       0.000583007694
   target dn stat err =       0.003757940694
      target stat err =       0.002805874390
              std dev =       0.703181089654
             le_variance =       0.494463644848


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.710967718933        initial  <--
     1.0000e+37     1.0000e+38             0.0000e+00        -0.710967718933
     4.0000e+37     4.0000e+38             0.0000e+00        -0.710967718933
     1.6000e+38     1.6000e+39             0.0000e+00        -0.710967718933

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.6592
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2636e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2426e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.4705
    reference variance = 0.420893
====================================================
  Execution time = 4.7348e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0031e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5135e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500321005218
                                         uncertainty =       0.004036595685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500321005218
                                         uncertainty =       0.004036595685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500155525
  error estimate for blocks of size 2^( 2) =       0.000526494235
  error estimate for blocks of size 2^( 3) =       0.000551971808
  error estimate for blocks of size 2^( 4) =       0.000571507333
  error estimate for blocks of size 2^( 5) =       0.000583271902
  error estimate for blocks of size 2^( 6) =       0.000591018454
  error estimate for blocks of size 2^( 7) =       0.000597369294

      target function =      -0.706740004181
              le_mean =     -22.426832388308
             les_mean =     503.463121821499
             stat err =       0.000585791746
             autocorr =       1.371754377099
   target nu stat err =       0.000585791746
   target dn stat err =       0.004164415380
      target stat err =       0.003057586902
              std dev =       0.707326726749
             le_variance =       0.500311098374


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242683238831e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+38, overlap shift 1.0000e+39 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706752288594       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706752288594       residual = 7.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706752288621       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+38 is 4.532272e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+38, overlap shift 4.0000e+39 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706752288594       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706752288594       residual = 7.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706752288594       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+38 is 1.476107e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+39, overlap shift 1.6000e+40 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706752288594       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706752288594       residual = 7.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706752288594       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+39 is 3.690268e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.360690 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2491e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.4064
    reference variance = 0.341584
====================================================
  Execution time = 4.4977e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9153e-01
  Total weights = 2.0000e+06
  Execution time = 3.8137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491593567956
                                         uncertainty =       0.002768964121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491593567956
                                         uncertainty =       0.002768964121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495747453
  error estimate for blocks of size 2^( 2) =       0.000522447878
  error estimate for blocks of size 2^( 3) =       0.000548733846
  error estimate for blocks of size 2^( 4) =       0.000569146852
  error estimate for blocks of size 2^( 5) =       0.000580539759
  error estimate for blocks of size 2^( 6) =       0.000585752874
  error estimate for blocks of size 2^( 7) =       0.000586691839

      target function =      -0.713125166151
              le_mean =     -22.426861240718
             les_mean =     503.455635939453
             stat err =       0.000580532831
             autocorr =       1.371300353496
   target nu stat err =       0.000580532831
   target dn stat err =       0.003027471055
      target stat err =       0.002298550713
              std dev =       0.701092771899
             le_variance =       0.491531074809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491593567956
                                         uncertainty =       0.002768964121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491593567956
                                         uncertainty =       0.002768964121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495747453
  error estimate for blocks of size 2^( 2) =       0.000522447878
  error estimate for blocks of size 2^( 3) =       0.000548733846
  error estimate for blocks of size 2^( 4) =       0.000569146852
  error estimate for blocks of size 2^( 5) =       0.000580539759
  error estimate for blocks of size 2^( 6) =       0.000585752874
  error estimate for blocks of size 2^( 7) =       0.000586691839

      target function =      -0.713125166151
              le_mean =     -22.426861240718
             les_mean =     503.455635939453
             stat err =       0.000580532831
             autocorr =       1.371300353496
   target nu stat err =       0.000580532831
   target dn stat err =       0.003027471055
      target stat err =       0.002298550713
              std dev =       0.701092771899
             le_variance =       0.491531074809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491593567956
                                         uncertainty =       0.002768964121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491593567956
                                         uncertainty =       0.002768964121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495747453
  error estimate for blocks of size 2^( 2) =       0.000522447878
  error estimate for blocks of size 2^( 3) =       0.000548733846
  error estimate for blocks of size 2^( 4) =       0.000569146852
  error estimate for blocks of size 2^( 5) =       0.000580539759
  error estimate for blocks of size 2^( 6) =       0.000585752874
  error estimate for blocks of size 2^( 7) =       0.000586691839

      target function =      -0.713125166151
              le_mean =     -22.426861240718
             les_mean =     503.455635939453
             stat err =       0.000580532831
             autocorr =       1.371300353496
   target nu stat err =       0.000580532831
   target dn stat err =       0.003027471055
      target stat err =       0.002298550713
              std dev =       0.701092771899
             le_variance =       0.491531074809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491593567956
                                         uncertainty =       0.002768964121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491593567956
                                         uncertainty =       0.002768964121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495747453
  error estimate for blocks of size 2^( 2) =       0.000522447878
  error estimate for blocks of size 2^( 3) =       0.000548733846
  error estimate for blocks of size 2^( 4) =       0.000569146852
  error estimate for blocks of size 2^( 5) =       0.000580539759
  error estimate for blocks of size 2^( 6) =       0.000585752874
  error estimate for blocks of size 2^( 7) =       0.000586691839

      target function =      -0.713125166151
              le_mean =     -22.426861240718
             les_mean =     503.455635939453
             stat err =       0.000580532831
             autocorr =       1.371300353496
   target nu stat err =       0.000580532831
   target dn stat err =       0.003027471055
      target stat err =       0.002298550713
              std dev =       0.701092771899
             le_variance =       0.491531074809


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.713125166151        initial  <--
     1.0000e+38     1.0000e+39             4.5323e-43        -0.713125166151
     4.0000e+38     4.0000e+39             1.4761e-43        -0.713125166151
     1.6000e+39     1.6000e+40             3.6903e-44        -0.713125166151

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0438
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2654e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2426e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.3308
    reference variance = 0.387515
====================================================
  Execution time = 4.7614e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9580e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5237e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495825930081
                                         uncertainty =       0.003123714551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495825930081
                                         uncertainty =       0.003123714551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497897324
  error estimate for blocks of size 2^( 2) =       0.000524266590
  error estimate for blocks of size 2^( 3) =       0.000549758031
  error estimate for blocks of size 2^( 4) =       0.000569468643
  error estimate for blocks of size 2^( 5) =       0.000582613564
  error estimate for blocks of size 2^( 6) =       0.000590771260
  error estimate for blocks of size 2^( 7) =       0.000597399610

      target function =      -0.709991874874
              le_mean =     -22.427687219122
             les_mean =     503.496957241578
             stat err =       0.000585063269
             autocorr =       1.380785070676
   target nu stat err =       0.000585063269
   target dn stat err =       0.003300576737
      target stat err =       0.002475305581
              std dev =       0.704133148441
             le_variance =       0.495803490733


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242768721912e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+39, overlap shift 1.0000e+40 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709999542318       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709999542318       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+39, overlap shift 4.0000e+40 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709999542318       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709999542318       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+40, overlap shift 1.6000e+41 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709999542318       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709999542318       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.361785 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2861e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.4834
    reference variance = 0.472271
====================================================
  Execution time = 4.4802e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0002e-01
  Total weights = 2.0000e+06
  Execution time = 3.8148e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499821459931
                                         uncertainty =       0.004067413602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499821459931
                                         uncertainty =       0.004067413602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500007720
  error estimate for blocks of size 2^( 2) =       0.000526527078
  error estimate for blocks of size 2^( 3) =       0.000552490739
  error estimate for blocks of size 2^( 4) =       0.000572587608
  error estimate for blocks of size 2^( 5) =       0.000585214606
  error estimate for blocks of size 2^( 6) =       0.000593000012
  error estimate for blocks of size 2^( 7) =       0.000598276645

      target function =      -0.706968034687
              le_mean =     -22.426084168328
             les_mean =     503.429266315477
             stat err =       0.000587269718
             autocorr =       1.379500285065
   target nu stat err =       0.000587269718
   target dn stat err =       0.004048592654
      target stat err =       0.002974804928
              std dev =       0.707117699238
             le_variance =       0.500015440575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499821459931
                                         uncertainty =       0.004067413602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499821459931
                                         uncertainty =       0.004067413602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500007720
  error estimate for blocks of size 2^( 2) =       0.000526527078
  error estimate for blocks of size 2^( 3) =       0.000552490739
  error estimate for blocks of size 2^( 4) =       0.000572587608
  error estimate for blocks of size 2^( 5) =       0.000585214606
  error estimate for blocks of size 2^( 6) =       0.000593000012
  error estimate for blocks of size 2^( 7) =       0.000598276645

      target function =      -0.706968034687
              le_mean =     -22.426084168328
             les_mean =     503.429266315477
             stat err =       0.000587269718
             autocorr =       1.379500285065
   target nu stat err =       0.000587269718
   target dn stat err =       0.004048592654
      target stat err =       0.002974804928
              std dev =       0.707117699238
             le_variance =       0.500015440575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499821459931
                                         uncertainty =       0.004067413602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499821459931
                                         uncertainty =       0.004067413602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500007720
  error estimate for blocks of size 2^( 2) =       0.000526527078
  error estimate for blocks of size 2^( 3) =       0.000552490739
  error estimate for blocks of size 2^( 4) =       0.000572587608
  error estimate for blocks of size 2^( 5) =       0.000585214606
  error estimate for blocks of size 2^( 6) =       0.000593000012
  error estimate for blocks of size 2^( 7) =       0.000598276645

      target function =      -0.706968034687
              le_mean =     -22.426084168328
             les_mean =     503.429266315477
             stat err =       0.000587269718
             autocorr =       1.379500285065
   target nu stat err =       0.000587269718
   target dn stat err =       0.004048592654
      target stat err =       0.002974804928
              std dev =       0.707117699238
             le_variance =       0.500015440575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499821459931
                                         uncertainty =       0.004067413602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499821459931
                                         uncertainty =       0.004067413602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500007720
  error estimate for blocks of size 2^( 2) =       0.000526527078
  error estimate for blocks of size 2^( 3) =       0.000552490739
  error estimate for blocks of size 2^( 4) =       0.000572587608
  error estimate for blocks of size 2^( 5) =       0.000585214606
  error estimate for blocks of size 2^( 6) =       0.000593000012
  error estimate for blocks of size 2^( 7) =       0.000598276645

      target function =      -0.706968034687
              le_mean =     -22.426084168328
             les_mean =     503.429266315477
             stat err =       0.000587269718
             autocorr =       1.379500285065
   target nu stat err =       0.000587269718
   target dn stat err =       0.004048592654
      target stat err =       0.002974804928
              std dev =       0.707117699238
             le_variance =       0.500015440575


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706968034687        initial  <--
     1.0000e+39     1.0000e+40             0.0000e+00        -0.706968034687
     4.0000e+39     4.0000e+40             0.0000e+00        -0.706968034687
     1.6000e+40     1.6000e+41             0.0000e+00        -0.706968034687

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8585
  </log>
  <optVariables href="FORM.s040.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2673e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2426e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.3456
    reference variance = 0.73071
====================================================
  Execution time = 4.5975e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9580e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5296e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495776438715
                                         uncertainty =       0.003131872237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495776438715
                                         uncertainty =       0.003131872237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497895963
  error estimate for blocks of size 2^( 2) =       0.000524727563
  error estimate for blocks of size 2^( 3) =       0.000550556909
  error estimate for blocks of size 2^( 4) =       0.000570671271
  error estimate for blocks of size 2^( 5) =       0.000583544646
  error estimate for blocks of size 2^( 6) =       0.000590819529
  error estimate for blocks of size 2^( 7) =       0.000594069755

      target function =      -0.710016114871
              le_mean =     -22.426339531223
             les_mean =     503.436505301048
             stat err =       0.000584776300
             autocorr =       1.379438418889
   target nu stat err =       0.000584776300
   target dn stat err =       0.003052769033
      target stat err =       0.002296382724
              std dev =       0.704131223030
             le_variance =       0.495800779246


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242633953122e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+40, overlap shift 1.0000e+41 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710022575165       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710022575165       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+40, overlap shift 4.0000e+41 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710022575165       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710022575165       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+41, overlap shift 1.6000e+42 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710022575165       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710022575165       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.363015 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.4294e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.4501
    reference variance = 0.406965
====================================================
  Execution time = 4.4758e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9981e-01
  Total weights = 2.0000e+06
  Execution time = 3.8373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499754599178
                                         uncertainty =       0.005949588827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499754599178
                                         uncertainty =       0.005949588827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499903219
  error estimate for blocks of size 2^( 2) =       0.000526527922
  error estimate for blocks of size 2^( 3) =       0.000551986391
  error estimate for blocks of size 2^( 4) =       0.000572162996
  error estimate for blocks of size 2^( 5) =       0.000585100630
  error estimate for blocks of size 2^( 6) =       0.000590581994
  error estimate for blocks of size 2^( 7) =       0.000595000960

      target function =      -0.707081550802
              le_mean =     -22.427081325167
             les_mean =     503.473782972638
             stat err =       0.000585711645
             autocorr =       1.372763902986
   target nu stat err =       0.000585711645
   target dn stat err =       0.006402599368
      target stat err =       0.004655169999
              std dev =       0.706969912283
             le_variance =       0.499806456874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499754599178
                                         uncertainty =       0.005949588827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499754599178
                                         uncertainty =       0.005949588827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499903219
  error estimate for blocks of size 2^( 2) =       0.000526527922
  error estimate for blocks of size 2^( 3) =       0.000551986391
  error estimate for blocks of size 2^( 4) =       0.000572162996
  error estimate for blocks of size 2^( 5) =       0.000585100630
  error estimate for blocks of size 2^( 6) =       0.000590581994
  error estimate for blocks of size 2^( 7) =       0.000595000960

      target function =      -0.707081550802
              le_mean =     -22.427081325167
             les_mean =     503.473782972638
             stat err =       0.000585711645
             autocorr =       1.372763902986
   target nu stat err =       0.000585711645
   target dn stat err =       0.006402599368
      target stat err =       0.004655169999
              std dev =       0.706969912283
             le_variance =       0.499806456874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499754599178
                                         uncertainty =       0.005949588827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499754599178
                                         uncertainty =       0.005949588827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499903219
  error estimate for blocks of size 2^( 2) =       0.000526527922
  error estimate for blocks of size 2^( 3) =       0.000551986391
  error estimate for blocks of size 2^( 4) =       0.000572162996
  error estimate for blocks of size 2^( 5) =       0.000585100630
  error estimate for blocks of size 2^( 6) =       0.000590581994
  error estimate for blocks of size 2^( 7) =       0.000595000960

      target function =      -0.707081550802
              le_mean =     -22.427081325167
             les_mean =     503.473782972638
             stat err =       0.000585711645
             autocorr =       1.372763902986
   target nu stat err =       0.000585711645
   target dn stat err =       0.006402599368
      target stat err =       0.004655169999
              std dev =       0.706969912283
             le_variance =       0.499806456874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499754599178
                                         uncertainty =       0.005949588827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499754599178
                                         uncertainty =       0.005949588827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499903219
  error estimate for blocks of size 2^( 2) =       0.000526527922
  error estimate for blocks of size 2^( 3) =       0.000551986391
  error estimate for blocks of size 2^( 4) =       0.000572162996
  error estimate for blocks of size 2^( 5) =       0.000585100630
  error estimate for blocks of size 2^( 6) =       0.000590581994
  error estimate for blocks of size 2^( 7) =       0.000595000960

      target function =      -0.707081550802
              le_mean =     -22.427081325167
             les_mean =     503.473782972638
             stat err =       0.000585711645
             autocorr =       1.372763902986
   target nu stat err =       0.000585711645
   target dn stat err =       0.006402599368
      target stat err =       0.004655169999
              std dev =       0.706969912283
             le_variance =       0.499806456874


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707081550802        initial  <--
     1.0000e+40     1.0000e+41             0.0000e+00        -0.707081550802
     4.0000e+40     4.0000e+41             0.0000e+00        -0.707081550802
     1.6000e+41     1.6000e+42             0.0000e+00        -0.707081550802

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8610
  </log>
  <optVariables href="FORM.s041.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2844e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2425e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.4197
    reference variance = 0.353913
====================================================
  Execution time = 4.5835e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2428e+01
  VMC Evar = 5.0074e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5260e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500779200099
                                         uncertainty =       0.004461068017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500779200099
                                         uncertainty =       0.004461068017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500371511
  error estimate for blocks of size 2^( 2) =       0.000526886009
  error estimate for blocks of size 2^( 3) =       0.000552770748
  error estimate for blocks of size 2^( 4) =       0.000572313391
  error estimate for blocks of size 2^( 5) =       0.000585049529
  error estimate for blocks of size 2^( 6) =       0.000593238315
  error estimate for blocks of size 2^( 7) =       0.000598466342

      target function =      -0.706411830038
              le_mean =     -22.427527728231
             les_mean =     503.494743049114
             stat err =       0.000587266894
             autocorr =       1.377481859721
   target nu stat err =       0.000587266894
   target dn stat err =       0.004580677428
      target stat err =       0.003352656523
              std dev =       0.707632177702
             le_variance =       0.500743298920


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242752772823e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+41, overlap shift 1.0000e+42 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706426699003       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706426699003       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+41, overlap shift 4.0000e+42 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706426699003       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706426699003       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+42, overlap shift 1.6000e+43 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706426699003       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706426699003       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.364130 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1103e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.2863
    reference variance = 0.367567
====================================================
  Execution time = 4.6808e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.2552e-01
  Total weights = 2.0000e+06
  Execution time = 3.8427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525576295083
                                         uncertainty =       0.026180813288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525576295083
                                         uncertainty =       0.026180813288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512602527
  error estimate for blocks of size 2^( 2) =       0.000538814465
  error estimate for blocks of size 2^( 3) =       0.000563535631
  error estimate for blocks of size 2^( 4) =       0.000582630085
  error estimate for blocks of size 2^( 5) =       0.000594100637
  error estimate for blocks of size 2^( 6) =       0.000600467720
  error estimate for blocks of size 2^( 7) =       0.000603840322

      target function =      -0.688565896666
              le_mean =     -22.427299150694
             les_mean =     503.509269632680
             stat err =       0.000595259691
             autocorr =       1.348501593352
   target nu stat err =       0.000595259691
   target dn stat err =       0.026123437950
      target stat err =       0.017889838430
              std dev =       0.724929445334
             le_variance =       0.525522700713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525576295083
                                         uncertainty =       0.026180813288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525576295083
                                         uncertainty =       0.026180813288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512602527
  error estimate for blocks of size 2^( 2) =       0.000538814465
  error estimate for blocks of size 2^( 3) =       0.000563535631
  error estimate for blocks of size 2^( 4) =       0.000582630085
  error estimate for blocks of size 2^( 5) =       0.000594100637
  error estimate for blocks of size 2^( 6) =       0.000600467720
  error estimate for blocks of size 2^( 7) =       0.000603840322

      target function =      -0.688565896666
              le_mean =     -22.427299150694
             les_mean =     503.509269632680
             stat err =       0.000595259691
             autocorr =       1.348501593351
   target nu stat err =       0.000595259691
   target dn stat err =       0.026123437950
      target stat err =       0.017889838430
              std dev =       0.724929445334
             le_variance =       0.525522700713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525576295083
                                         uncertainty =       0.026180813288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525576295083
                                         uncertainty =       0.026180813288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512602527
  error estimate for blocks of size 2^( 2) =       0.000538814465
  error estimate for blocks of size 2^( 3) =       0.000563535631
  error estimate for blocks of size 2^( 4) =       0.000582630085
  error estimate for blocks of size 2^( 5) =       0.000594100637
  error estimate for blocks of size 2^( 6) =       0.000600467720
  error estimate for blocks of size 2^( 7) =       0.000603840322

      target function =      -0.688565896666
              le_mean =     -22.427299150694
             les_mean =     503.509269632680
             stat err =       0.000595259691
             autocorr =       1.348501593351
   target nu stat err =       0.000595259691
   target dn stat err =       0.026123437950
      target stat err =       0.017889838430
              std dev =       0.724929445334
             le_variance =       0.525522700713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525576295083
                                         uncertainty =       0.026180813288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525576295083
                                         uncertainty =       0.026180813288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512602527
  error estimate for blocks of size 2^( 2) =       0.000538814465
  error estimate for blocks of size 2^( 3) =       0.000563535631
  error estimate for blocks of size 2^( 4) =       0.000582630085
  error estimate for blocks of size 2^( 5) =       0.000594100637
  error estimate for blocks of size 2^( 6) =       0.000600467720
  error estimate for blocks of size 2^( 7) =       0.000603840322

      target function =      -0.688565896666
              le_mean =     -22.427299150694
             les_mean =     503.509269632680
             stat err =       0.000595259691
             autocorr =       1.348501593351
   target nu stat err =       0.000595259691
   target dn stat err =       0.026123437950
      target stat err =       0.017889838430
              std dev =       0.724929445334
             le_variance =       0.525522700713


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.688565896666        initial  <--
     1.0000e+41     1.0000e+42             0.0000e+00        -0.688565896666
     4.0000e+41     4.0000e+42             0.0000e+00        -0.688565896666
     1.6000e+42     1.6000e+43             0.0000e+00        -0.688565896666

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.9540
  </log>
  <optVariables href="FORM.s042.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2708e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2424e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.4054
    reference variance = 0.64977
====================================================
  Execution time = 4.6241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9075e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5182e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490768564843
                                         uncertainty =       0.004733765787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490768564843
                                         uncertainty =       0.004733765787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495352907
  error estimate for blocks of size 2^( 2) =       0.000522282246
  error estimate for blocks of size 2^( 3) =       0.000548118802
  error estimate for blocks of size 2^( 4) =       0.000567876662
  error estimate for blocks of size 2^( 5) =       0.000581994009
  error estimate for blocks of size 2^( 6) =       0.000590397667
  error estimate for blocks of size 2^( 7) =       0.000595213179

      target function =      -0.713676825294
              le_mean =     -22.428207578703
             les_mean =     503.515243952010
             stat err =       0.000583870379
             autocorr =       1.389323735192
   target nu stat err =       0.000583870379
   target dn stat err =       0.004268200506
      target stat err =       0.003197530169
              std dev =       0.700534798550
             le_variance =       0.490749003980


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242820757870e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+42, overlap shift 1.0000e+43 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713690350794       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713690350794       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713690280914       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+42 is 8.163341e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+42, overlap shift 4.0000e+43 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713690350794       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713690350794       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712890625000       residual = 8.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+42 is 2.040835e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+43, overlap shift 1.6000e+44 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713690350794       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713690350794       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714843750000       residual = 7.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.718750000000       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+43 is 5.102088e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.365613 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1431e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.5268
    reference variance = 0.365498
====================================================
  Execution time = 4.6594e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.1099e-01
  Total weights = 2.0000e+06
  Execution time = 4.0778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511057720358
                                         uncertainty =       0.012430494147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511057720358
                                         uncertainty =       0.012430494147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505463620
  error estimate for blocks of size 2^( 2) =       0.000531944094
  error estimate for blocks of size 2^( 3) =       0.000556884976
  error estimate for blocks of size 2^( 4) =       0.000576907404
  error estimate for blocks of size 2^( 5) =       0.000588886580
  error estimate for blocks of size 2^( 6) =       0.000594402313
  error estimate for blocks of size 2^( 7) =       0.000597637916

      target function =      -0.699038544871
              le_mean =     -22.426833168221
             les_mean =     503.473832641676
             stat err =       0.000589458553
             autocorr =       1.359961899823
   target nu stat err =       0.000589458553
   target dn stat err =       0.012333900961
      target stat err =       0.008710536940
              std dev =       0.714833506463
             le_variance =       0.510986941963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511057720358
                                         uncertainty =       0.012430494147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511057720358
                                         uncertainty =       0.012430494147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505463620
  error estimate for blocks of size 2^( 2) =       0.000531944094
  error estimate for blocks of size 2^( 3) =       0.000556884976
  error estimate for blocks of size 2^( 4) =       0.000576907404
  error estimate for blocks of size 2^( 5) =       0.000588886580
  error estimate for blocks of size 2^( 6) =       0.000594402313
  error estimate for blocks of size 2^( 7) =       0.000597637916

      target function =      -0.699038544871
              le_mean =     -22.426833168221
             les_mean =     503.473832641676
             stat err =       0.000589458553
             autocorr =       1.359961899823
   target nu stat err =       0.000589458553
   target dn stat err =       0.012333900961
      target stat err =       0.008710536940
              std dev =       0.714833506463
             le_variance =       0.510986941963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511057720358
                                         uncertainty =       0.012430494147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511057720358
                                         uncertainty =       0.012430494147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505463620
  error estimate for blocks of size 2^( 2) =       0.000531944094
  error estimate for blocks of size 2^( 3) =       0.000556884976
  error estimate for blocks of size 2^( 4) =       0.000576907404
  error estimate for blocks of size 2^( 5) =       0.000588886580
  error estimate for blocks of size 2^( 6) =       0.000594402313
  error estimate for blocks of size 2^( 7) =       0.000597637916

      target function =      -0.699038544871
              le_mean =     -22.426833168221
             les_mean =     503.473832641676
             stat err =       0.000589458553
             autocorr =       1.359961899823
   target nu stat err =       0.000589458553
   target dn stat err =       0.012333900961
      target stat err =       0.008710536940
              std dev =       0.714833506463
             le_variance =       0.510986941963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511057720358
                                         uncertainty =       0.012430494147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511057720358
                                         uncertainty =       0.012430494147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505463620
  error estimate for blocks of size 2^( 2) =       0.000531944094
  error estimate for blocks of size 2^( 3) =       0.000556884976
  error estimate for blocks of size 2^( 4) =       0.000576907404
  error estimate for blocks of size 2^( 5) =       0.000588886580
  error estimate for blocks of size 2^( 6) =       0.000594402313
  error estimate for blocks of size 2^( 7) =       0.000597637916

      target function =      -0.699038544871
              le_mean =     -22.426833168221
             les_mean =     503.473832641676
             stat err =       0.000589458553
             autocorr =       1.359961899823
   target nu stat err =       0.000589458553
   target dn stat err =       0.012333900961
      target stat err =       0.008710536940
              std dev =       0.714833506463
             le_variance =       0.510986941963


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.699038544871        initial  <--
     1.0000e+42     1.0000e+43             8.1633e-47        -0.699038544871
     4.0000e+42     4.0000e+43             2.0408e-47        -0.699038544871
     1.6000e+43     1.6000e+44             5.1021e-48        -0.699038544871

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.0079
  </log>
  <optVariables href="FORM.s043.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2750e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2425e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.3659
    reference variance = 0.536487
====================================================
  Execution time = 4.5992e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9691e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5394e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496847576979
                                         uncertainty =       0.003947437892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496847576979
                                         uncertainty =       0.003947437892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498454496
  error estimate for blocks of size 2^( 2) =       0.000525220659
  error estimate for blocks of size 2^( 3) =       0.000551005859
  error estimate for blocks of size 2^( 4) =       0.000570358994
  error estimate for blocks of size 2^( 5) =       0.000583021869
  error estimate for blocks of size 2^( 6) =       0.000589895937
  error estimate for blocks of size 2^( 7) =       0.000593130719

      target function =      -0.709209387653
              le_mean =     -22.426130956526
             les_mean =     503.428263200873
             stat err =       0.000584101880
             autocorr =       1.373175897110
   target nu stat err =       0.000584101880
   target dn stat err =       0.003573600148
      target stat err =       0.002656568318
              std dev =       0.704921109103
             le_variance =       0.496913770059


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242613095653e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+43, overlap shift 1.0000e+44 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709218415473       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709218415473       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709218978882       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+43 is 3.675173e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+43, overlap shift 4.0000e+44 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709218415473       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709218415473       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+44, overlap shift 1.6000e+45 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709218415473       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709218415473       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709213256836       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+44 is 2.296983e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.366930 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1394e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.4407
    reference variance = 0.342064
====================================================
  Execution time = 4.5836e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9662e-01
  Total weights = 2.0000e+06
  Execution time = 3.8483e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496410499669
                                         uncertainty =       0.003925244001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496410499669
                                         uncertainty =       0.003925244001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498306651
  error estimate for blocks of size 2^( 2) =       0.000525316707
  error estimate for blocks of size 2^( 3) =       0.000551457840
  error estimate for blocks of size 2^( 4) =       0.000571546223
  error estimate for blocks of size 2^( 5) =       0.000583104226
  error estimate for blocks of size 2^( 6) =       0.000590122490
  error estimate for blocks of size 2^( 7) =       0.000593495456

      target function =      -0.709385865927
              le_mean =     -22.428025014862
             les_mean =     503.512924855401
             stat err =       0.000584567099
             autocorr =       1.376180403873
   target nu stat err =       0.000584567099
   target dn stat err =       0.004495817355
      target stat err =       0.003321751261
              std dev =       0.704712023758
             le_variance =       0.496619036429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496410499669
                                         uncertainty =       0.003925244001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496410499669
                                         uncertainty =       0.003925244001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498306651
  error estimate for blocks of size 2^( 2) =       0.000525316707
  error estimate for blocks of size 2^( 3) =       0.000551457840
  error estimate for blocks of size 2^( 4) =       0.000571546223
  error estimate for blocks of size 2^( 5) =       0.000583104226
  error estimate for blocks of size 2^( 6) =       0.000590122490
  error estimate for blocks of size 2^( 7) =       0.000593495456

      target function =      -0.709385865927
              le_mean =     -22.428025014862
             les_mean =     503.512924855401
             stat err =       0.000584567099
             autocorr =       1.376180403874
   target nu stat err =       0.000584567099
   target dn stat err =       0.004495817355
      target stat err =       0.003321751261
              std dev =       0.704712023758
             le_variance =       0.496619036429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496410499669
                                         uncertainty =       0.003925244001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496410499669
                                         uncertainty =       0.003925244001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498306651
  error estimate for blocks of size 2^( 2) =       0.000525316707
  error estimate for blocks of size 2^( 3) =       0.000551457840
  error estimate for blocks of size 2^( 4) =       0.000571546223
  error estimate for blocks of size 2^( 5) =       0.000583104226
  error estimate for blocks of size 2^( 6) =       0.000590122490
  error estimate for blocks of size 2^( 7) =       0.000593495456

      target function =      -0.709385865927
              le_mean =     -22.428025014862
             les_mean =     503.512924855401
             stat err =       0.000584567099
             autocorr =       1.376180403874
   target nu stat err =       0.000584567099
   target dn stat err =       0.004495817355
      target stat err =       0.003321751261
              std dev =       0.704712023758
             le_variance =       0.496619036429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496410499669
                                         uncertainty =       0.003925244001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496410499669
                                         uncertainty =       0.003925244001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498306651
  error estimate for blocks of size 2^( 2) =       0.000525316707
  error estimate for blocks of size 2^( 3) =       0.000551457840
  error estimate for blocks of size 2^( 4) =       0.000571546223
  error estimate for blocks of size 2^( 5) =       0.000583104226
  error estimate for blocks of size 2^( 6) =       0.000590122490
  error estimate for blocks of size 2^( 7) =       0.000593495456

      target function =      -0.709385865927
              le_mean =     -22.428025014862
             les_mean =     503.512924855401
             stat err =       0.000584567099
             autocorr =       1.376180403874
   target nu stat err =       0.000584567099
   target dn stat err =       0.004495817355
      target stat err =       0.003321751261
              std dev =       0.704712023758
             le_variance =       0.496619036429


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.709385865927        initial  <--
     1.0000e+43     1.0000e+44             3.6752e-48        -0.709385865927
     4.0000e+43     4.0000e+44             0.0000e+00        -0.709385865927
     1.6000e+44     1.6000e+45             2.2970e-49        -0.709385865927

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.6952
  </log>
  <optVariables href="FORM.s044.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2930e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2424e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.5004
    reference variance = 0.446641
====================================================
  Execution time = 4.5404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9545e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5091e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495401467073
                                         uncertainty =       0.003469274863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495401467073
                                         uncertainty =       0.003469274863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497717747
  error estimate for blocks of size 2^( 2) =       0.000524725496
  error estimate for blocks of size 2^( 3) =       0.000550246242
  error estimate for blocks of size 2^( 4) =       0.000570869013
  error estimate for blocks of size 2^( 5) =       0.000582187181
  error estimate for blocks of size 2^( 6) =       0.000591340380
  error estimate for blocks of size 2^( 7) =       0.000595490669

      target function =      -0.710257087527
              le_mean =     -22.427295891892
             les_mean =     503.479046685917
             stat err =       0.000584971811
             autocorr =       1.381349655694
   target nu stat err =       0.000584971811
   target dn stat err =       0.003583316535
      target stat err =       0.002675793319
              std dev =       0.703879187888
             le_variance =       0.495445911142


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242729589189e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+44, overlap shift 1.0000e+45 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710266079389       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710266079389       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+44, overlap shift 4.0000e+45 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710266079389       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710266079389       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+45, overlap shift 1.6000e+46 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710266079389       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710266079389       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.368037 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0503e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.4278
    reference variance = 0.873119
====================================================
  Execution time = 4.5619e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0513e-01
  Total weights = 2.0000e+06
  Execution time = 3.8363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505137559435
                                         uncertainty =       0.007843978251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505137559435
                                         uncertainty =       0.007843978251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502559881
  error estimate for blocks of size 2^( 2) =       0.000529014683
  error estimate for blocks of size 2^( 3) =       0.000554382064
  error estimate for blocks of size 2^( 4) =       0.000574807129
  error estimate for blocks of size 2^( 5) =       0.000589108274
  error estimate for blocks of size 2^( 6) =       0.000596211890
  error estimate for blocks of size 2^( 7) =       0.000600502827

      target function =      -0.703246560959
              le_mean =     -22.427066960140
             les_mean =     503.478465050819
             stat err =       0.000590157530
             autocorr =       1.378987318175
   target nu stat err =       0.000590157530
   target dn stat err =       0.007883257554
      target stat err =       0.005654626459
              std dev =       0.710727000176
             le_variance =       0.505132868779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505137559435
                                         uncertainty =       0.007843978251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505137559435
                                         uncertainty =       0.007843978251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502559881
  error estimate for blocks of size 2^( 2) =       0.000529014683
  error estimate for blocks of size 2^( 3) =       0.000554382064
  error estimate for blocks of size 2^( 4) =       0.000574807129
  error estimate for blocks of size 2^( 5) =       0.000589108274
  error estimate for blocks of size 2^( 6) =       0.000596211890
  error estimate for blocks of size 2^( 7) =       0.000600502827

      target function =      -0.703246560959
              le_mean =     -22.427066960140
             les_mean =     503.478465050819
             stat err =       0.000590157530
             autocorr =       1.378987318174
   target nu stat err =       0.000590157530
   target dn stat err =       0.007883257554
      target stat err =       0.005654626459
              std dev =       0.710727000176
             le_variance =       0.505132868779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505137559435
                                         uncertainty =       0.007843978251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505137559435
                                         uncertainty =       0.007843978251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502559881
  error estimate for blocks of size 2^( 2) =       0.000529014683
  error estimate for blocks of size 2^( 3) =       0.000554382064
  error estimate for blocks of size 2^( 4) =       0.000574807129
  error estimate for blocks of size 2^( 5) =       0.000589108274
  error estimate for blocks of size 2^( 6) =       0.000596211890
  error estimate for blocks of size 2^( 7) =       0.000600502827

      target function =      -0.703246560959
              le_mean =     -22.427066960140
             les_mean =     503.478465050819
             stat err =       0.000590157530
             autocorr =       1.378987318174
   target nu stat err =       0.000590157530
   target dn stat err =       0.007883257554
      target stat err =       0.005654626459
              std dev =       0.710727000176
             le_variance =       0.505132868779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505137559435
                                         uncertainty =       0.007843978251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505137559435
                                         uncertainty =       0.007843978251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502559881
  error estimate for blocks of size 2^( 2) =       0.000529014683
  error estimate for blocks of size 2^( 3) =       0.000554382064
  error estimate for blocks of size 2^( 4) =       0.000574807129
  error estimate for blocks of size 2^( 5) =       0.000589108274
  error estimate for blocks of size 2^( 6) =       0.000596211890
  error estimate for blocks of size 2^( 7) =       0.000600502827

      target function =      -0.703246560959
              le_mean =     -22.427066960140
             les_mean =     503.478465050819
             stat err =       0.000590157530
             autocorr =       1.378987318174
   target nu stat err =       0.000590157530
   target dn stat err =       0.007883257554
      target stat err =       0.005654626459
              std dev =       0.710727000176
             le_variance =       0.505132868779


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.703246560959        initial  <--
     1.0000e+44     1.0000e+45             0.0000e+00        -0.703246560959
     4.0000e+44     4.0000e+45             0.0000e+00        -0.703246560959
     1.6000e+45     1.6000e+46             0.0000e+00        -0.703246560959

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.7587
  </log>
  <optVariables href="FORM.s045.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2549e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2425e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.4416
    reference variance = 0.275573
====================================================
  Execution time = 4.7978e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.1671e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5289e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516818432761
                                         uncertainty =       0.007312607373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516818432761
                                         uncertainty =       0.007312607373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508285611
  error estimate for blocks of size 2^( 2) =       0.000534296363
  error estimate for blocks of size 2^( 3) =       0.000559804691
  error estimate for blocks of size 2^( 4) =       0.000579415069
  error estimate for blocks of size 2^( 5) =       0.000591528250
  error estimate for blocks of size 2^( 6) =       0.000597993825
  error estimate for blocks of size 2^( 7) =       0.000602711477

      target function =      -0.695099502406
              le_mean =     -22.426754612749
             les_mean =     503.476030726954
             stat err =       0.000592912155
             autocorr =       1.360708434179
   target nu stat err =       0.000592912155
   target dn stat err =       0.007812714929
      target stat err =       0.005474040747
              std dev =       0.718824404738
             le_variance =       0.516708524847


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242675461275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+45, overlap shift 1.0000e+46 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.695141220083       residual = 6.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.695141220083       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.695144653320       residual = 6.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+45 is 4.720786e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+45, overlap shift 4.0000e+46 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.695141220083       residual = 6.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.695141220083       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.695129394531       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+45 is 1.180197e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+46, overlap shift 1.6000e+47 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.695141220083       residual = 6.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.695141220083       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.695129394531       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+46 is 2.950491e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.369443 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3278e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.4388
    reference variance = 0.322636
====================================================
  Execution time = 4.5237e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9267e-01
  Total weights = 2.0000e+06
  Execution time = 3.8218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492730464194
                                         uncertainty =       0.002772414239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492730464194
                                         uncertainty =       0.002772414239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496319821
  error estimate for blocks of size 2^( 2) =       0.000522892735
  error estimate for blocks of size 2^( 3) =       0.000548613218
  error estimate for blocks of size 2^( 4) =       0.000568359610
  error estimate for blocks of size 2^( 5) =       0.000579400133
  error estimate for blocks of size 2^( 6) =       0.000584823824
  error estimate for blocks of size 2^( 7) =       0.000588499344

      target function =      -0.712290523285
              le_mean =     -22.427194896338
             les_mean =     503.471737402284
             stat err =       0.000580270728
             autocorr =       1.366904224375
   target nu stat err =       0.000580270728
   target dn stat err =       0.002745822107
      target stat err =       0.002096031800
              std dev =       0.701902222748
             le_variance =       0.492666730299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492730464194
                                         uncertainty =       0.002772414239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492730464194
                                         uncertainty =       0.002772414239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496319821
  error estimate for blocks of size 2^( 2) =       0.000522892735
  error estimate for blocks of size 2^( 3) =       0.000548613218
  error estimate for blocks of size 2^( 4) =       0.000568359610
  error estimate for blocks of size 2^( 5) =       0.000579400133
  error estimate for blocks of size 2^( 6) =       0.000584823824
  error estimate for blocks of size 2^( 7) =       0.000588499344

      target function =      -0.712290523285
              le_mean =     -22.427194896338
             les_mean =     503.471737402284
             stat err =       0.000580270728
             autocorr =       1.366904224375
   target nu stat err =       0.000580270728
   target dn stat err =       0.002745822107
      target stat err =       0.002096031800
              std dev =       0.701902222748
             le_variance =       0.492666730299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492730464194
                                         uncertainty =       0.002772414239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492730464194
                                         uncertainty =       0.002772414239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496319821
  error estimate for blocks of size 2^( 2) =       0.000522892735
  error estimate for blocks of size 2^( 3) =       0.000548613218
  error estimate for blocks of size 2^( 4) =       0.000568359610
  error estimate for blocks of size 2^( 5) =       0.000579400133
  error estimate for blocks of size 2^( 6) =       0.000584823824
  error estimate for blocks of size 2^( 7) =       0.000588499344

      target function =      -0.712290523285
              le_mean =     -22.427194896338
             les_mean =     503.471737402284
             stat err =       0.000580270728
             autocorr =       1.366904224375
   target nu stat err =       0.000580270728
   target dn stat err =       0.002745822107
      target stat err =       0.002096031800
              std dev =       0.701902222748
             le_variance =       0.492666730299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492730464194
                                         uncertainty =       0.002772414239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492730464194
                                         uncertainty =       0.002772414239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496319821
  error estimate for blocks of size 2^( 2) =       0.000522892735
  error estimate for blocks of size 2^( 3) =       0.000548613218
  error estimate for blocks of size 2^( 4) =       0.000568359610
  error estimate for blocks of size 2^( 5) =       0.000579400133
  error estimate for blocks of size 2^( 6) =       0.000584823824
  error estimate for blocks of size 2^( 7) =       0.000588499344

      target function =      -0.712290523285
              le_mean =     -22.427194896338
             les_mean =     503.471737402284
             stat err =       0.000580270728
             autocorr =       1.366904224375
   target nu stat err =       0.000580270728
   target dn stat err =       0.002745822107
      target stat err =       0.002096031800
              std dev =       0.701902222748
             le_variance =       0.492666730299


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.712290523285        initial  <--
     1.0000e+45     1.0000e+46             4.7208e-50        -0.712290523285
     4.0000e+45     4.0000e+46             1.1802e-50        -0.712290523285
     1.6000e+46     1.6000e+47             2.9505e-51        -0.712290523285

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.3439
  </log>
  <optVariables href="FORM.s046.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2772e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2425e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.3602
    reference variance = 0.482046
====================================================
  Execution time = 4.8147e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9682e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5104e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496816443557
                                         uncertainty =       0.003485125471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496816443557
                                         uncertainty =       0.003485125471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498410073
  error estimate for blocks of size 2^( 2) =       0.000525184517
  error estimate for blocks of size 2^( 3) =       0.000550347347
  error estimate for blocks of size 2^( 4) =       0.000569976570
  error estimate for blocks of size 2^( 5) =       0.000582504820
  error estimate for blocks of size 2^( 6) =       0.000586755275
  error estimate for blocks of size 2^( 7) =       0.000589807127

      target function =      -0.709262048791
              le_mean =     -22.426810910229
             les_mean =     503.458672556354
             stat err =       0.000582260948
             autocorr =       1.364777028989
   target nu stat err =       0.000582260948
   target dn stat err =       0.003719378257
      target stat err =       0.002762276243
              std dev =       0.704858284770
             le_variance =       0.496825201609


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242681091023e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+46, overlap shift 1.0000e+47 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709271801255       residual = 3.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709271801255       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709289550781       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+46 is 4.369063e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+46, overlap shift 4.0000e+47 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709271801255       residual = 3.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709271801255       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709228515625       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+46 is 1.092266e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+47, overlap shift 1.6000e+48 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709271801255       residual = 3.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709271801255       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709228515625       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+47 is 2.730664e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.370810 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3259e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.494
    reference variance = 0.556161
====================================================
  Execution time = 4.4899e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9825e-01
  Total weights = 2.0000e+06
  Execution time = 3.8095e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498343633942
                                         uncertainty =       0.004046919519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498343633942
                                         uncertainty =       0.004046919519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499122425
  error estimate for blocks of size 2^( 2) =       0.000525576192
  error estimate for blocks of size 2^( 3) =       0.000551088342
  error estimate for blocks of size 2^( 4) =       0.000570758424
  error estimate for blocks of size 2^( 5) =       0.000583255761
  error estimate for blocks of size 2^( 6) =       0.000590646977
  error estimate for blocks of size 2^( 7) =       0.000592942244

      target function =      -0.708231127221
              le_mean =     -22.426762176205
             les_mean =     503.457907849762
             stat err =       0.000584400851
             autocorr =       1.370905485532
   target nu stat err =       0.000584400851
   target dn stat err =       0.004158127065
      target stat err =       0.003065209707
              std dev =       0.705865703124
             le_variance =       0.498246390846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498343633942
                                         uncertainty =       0.004046919519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498343633942
                                         uncertainty =       0.004046919519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499122425
  error estimate for blocks of size 2^( 2) =       0.000525576192
  error estimate for blocks of size 2^( 3) =       0.000551088342
  error estimate for blocks of size 2^( 4) =       0.000570758424
  error estimate for blocks of size 2^( 5) =       0.000583255761
  error estimate for blocks of size 2^( 6) =       0.000590646977
  error estimate for blocks of size 2^( 7) =       0.000592942244

      target function =      -0.708231127221
              le_mean =     -22.426762176205
             les_mean =     503.457907849762
             stat err =       0.000584400851
             autocorr =       1.370905485527
   target nu stat err =       0.000584400851
   target dn stat err =       0.004158127065
      target stat err =       0.003065209707
              std dev =       0.705865703124
             le_variance =       0.498246390846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498343633942
                                         uncertainty =       0.004046919519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498343633942
                                         uncertainty =       0.004046919519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499122425
  error estimate for blocks of size 2^( 2) =       0.000525576192
  error estimate for blocks of size 2^( 3) =       0.000551088342
  error estimate for blocks of size 2^( 4) =       0.000570758424
  error estimate for blocks of size 2^( 5) =       0.000583255761
  error estimate for blocks of size 2^( 6) =       0.000590646977
  error estimate for blocks of size 2^( 7) =       0.000592942244

      target function =      -0.708231127221
              le_mean =     -22.426762176205
             les_mean =     503.457907849762
             stat err =       0.000584400851
             autocorr =       1.370905485527
   target nu stat err =       0.000584400851
   target dn stat err =       0.004158127065
      target stat err =       0.003065209707
              std dev =       0.705865703124
             le_variance =       0.498246390846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498343633942
                                         uncertainty =       0.004046919519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498343633942
                                         uncertainty =       0.004046919519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499122425
  error estimate for blocks of size 2^( 2) =       0.000525576192
  error estimate for blocks of size 2^( 3) =       0.000551088342
  error estimate for blocks of size 2^( 4) =       0.000570758424
  error estimate for blocks of size 2^( 5) =       0.000583255761
  error estimate for blocks of size 2^( 6) =       0.000590646977
  error estimate for blocks of size 2^( 7) =       0.000592942244

      target function =      -0.708231127221
              le_mean =     -22.426762176205
             les_mean =     503.457907849762
             stat err =       0.000584400851
             autocorr =       1.370905485527
   target nu stat err =       0.000584400851
   target dn stat err =       0.004158127065
      target stat err =       0.003065209707
              std dev =       0.705865703124
             le_variance =       0.498246390846


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.708231127221        initial  <--
     1.0000e+46     1.0000e+47             4.3691e-51        -0.708231127221
     4.0000e+46     4.0000e+47             1.0923e-51        -0.708231127221
     1.6000e+47     1.6000e+48             2.7307e-52        -0.708231127221

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9479
  </log>
  <optVariables href="FORM.s047.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2722e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2425e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.3712
    reference variance = 0.312731
====================================================
  Execution time = 4.5872e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2428e+01
  VMC Evar = 5.0069e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5320e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500739636043
                                         uncertainty =       0.005491774063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500739636043
                                         uncertainty =       0.005491774063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500347206
  error estimate for blocks of size 2^( 2) =       0.000526800940
  error estimate for blocks of size 2^( 3) =       0.000551908700
  error estimate for blocks of size 2^( 4) =       0.000571052018
  error estimate for blocks of size 2^( 5) =       0.000584205159
  error estimate for blocks of size 2^( 6) =       0.000589931546
  error estimate for blocks of size 2^( 7) =       0.000592236060

      target function =      -0.706423960690
              le_mean =     -22.428464099164
             les_mean =     503.536696249756
             stat err =       0.000584356196
             autocorr =       1.363993650083
   target nu stat err =       0.000584356196
   target dn stat err =       0.004886984566
      target stat err =       0.003574381041
              std dev =       0.707597804271
             le_variance =       0.500694652609


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242846409916e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+47, overlap shift 1.0000e+48 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706441110920       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706441110920       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706441110920       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+47 is 6.121573e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+47, overlap shift 4.0000e+48 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706441110920       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706441110920       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706441110920       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+47 is 1.530393e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+48, overlap shift 1.6000e+49 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706441110920       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706441110920       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706441110920       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+48 is 3.825983e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.372181 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1199e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.4825
    reference variance = 0.473736
====================================================
  Execution time = 4.7528e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9618e-01
  Total weights = 2.0000e+06
  Execution time = 3.8098e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496102366673
                                         uncertainty =       0.005834898540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496102366673
                                         uncertainty =       0.005834898540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498085351
  error estimate for blocks of size 2^( 2) =       0.000524556795
  error estimate for blocks of size 2^( 3) =       0.000550350357
  error estimate for blocks of size 2^( 4) =       0.000569568115
  error estimate for blocks of size 2^( 5) =       0.000581580570
  error estimate for blocks of size 2^( 6) =       0.000586610397
  error estimate for blocks of size 2^( 7) =       0.000587958572

      target function =      -0.709717227472
              le_mean =     -22.426897779319
             les_mean =     503.461921789578
             stat err =       0.000581429413
             autocorr =       1.362656707165
   target nu stat err =       0.000581429413
   target dn stat err =       0.005611942762
      target stat err =       0.004118882452
              std dev =       0.704399058524
             le_variance =       0.496178033650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496102366673
                                         uncertainty =       0.005834898540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496102366673
                                         uncertainty =       0.005834898540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498085351
  error estimate for blocks of size 2^( 2) =       0.000524556795
  error estimate for blocks of size 2^( 3) =       0.000550350357
  error estimate for blocks of size 2^( 4) =       0.000569568115
  error estimate for blocks of size 2^( 5) =       0.000581580570
  error estimate for blocks of size 2^( 6) =       0.000586610397
  error estimate for blocks of size 2^( 7) =       0.000587958572

      target function =      -0.709717227472
              le_mean =     -22.426897779319
             les_mean =     503.461921789578
             stat err =       0.000581429413
             autocorr =       1.362656707167
   target nu stat err =       0.000581429413
   target dn stat err =       0.005611942762
      target stat err =       0.004118882452
              std dev =       0.704399058524
             le_variance =       0.496178033650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496102366673
                                         uncertainty =       0.005834898540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496102366673
                                         uncertainty =       0.005834898540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498085351
  error estimate for blocks of size 2^( 2) =       0.000524556795
  error estimate for blocks of size 2^( 3) =       0.000550350357
  error estimate for blocks of size 2^( 4) =       0.000569568115
  error estimate for blocks of size 2^( 5) =       0.000581580570
  error estimate for blocks of size 2^( 6) =       0.000586610397
  error estimate for blocks of size 2^( 7) =       0.000587958572

      target function =      -0.709717227472
              le_mean =     -22.426897779319
             les_mean =     503.461921789578
             stat err =       0.000581429413
             autocorr =       1.362656707167
   target nu stat err =       0.000581429413
   target dn stat err =       0.005611942762
      target stat err =       0.004118882452
              std dev =       0.704399058524
             le_variance =       0.496178033650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496102366673
                                         uncertainty =       0.005834898540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496102366673
                                         uncertainty =       0.005834898540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498085351
  error estimate for blocks of size 2^( 2) =       0.000524556795
  error estimate for blocks of size 2^( 3) =       0.000550350357
  error estimate for blocks of size 2^( 4) =       0.000569568115
  error estimate for blocks of size 2^( 5) =       0.000581580570
  error estimate for blocks of size 2^( 6) =       0.000586610397
  error estimate for blocks of size 2^( 7) =       0.000587958572

      target function =      -0.709717227472
              le_mean =     -22.426897779319
             les_mean =     503.461921789578
             stat err =       0.000581429413
             autocorr =       1.362656707167
   target nu stat err =       0.000581429413
   target dn stat err =       0.005611942762
      target stat err =       0.004118882452
              std dev =       0.704399058524
             le_variance =       0.496178033650


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.709717227472        initial  <--
     1.0000e+47     1.0000e+48             6.1216e-52        -0.709717227472
     4.0000e+47     4.0000e+48             1.5304e-52        -0.709717227472
     1.6000e+48     1.6000e+49             3.8260e-53        -0.709717227472

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.6262
  </log>
  <optVariables href="FORM.s048.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2783e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2425e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.4136
    reference variance = 0.27289
====================================================
  Execution time = 4.6394e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9724e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5190e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497254131479
                                         uncertainty =       0.002710708073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497254131479
                                         uncertainty =       0.002710708073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498618618
  error estimate for blocks of size 2^( 2) =       0.000525584312
  error estimate for blocks of size 2^( 3) =       0.000551384556
  error estimate for blocks of size 2^( 4) =       0.000571022327
  error estimate for blocks of size 2^( 5) =       0.000582635253
  error estimate for blocks of size 2^( 6) =       0.000589932241
  error estimate for blocks of size 2^( 7) =       0.000594246812

      target function =      -0.708958494936
              le_mean =     -22.427101639384
             les_mean =     503.472128747530
             stat err =       0.000584459158
             autocorr =       1.373951348354
   target nu stat err =       0.000584459158
   target dn stat err =       0.003169283622
      target stat err =       0.002373854433
              std dev =       0.705153212367
             le_variance =       0.497241052912


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242710163938e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+48, overlap shift 1.0000e+49 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708965400662       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708965400662       residual = 9.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708965400662       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 1.97e+04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 4.77e+06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+48 is 8.652672e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+48, overlap shift 4.0000e+49 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708965400662       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708965400662       residual = 9.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708965400662       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 1.97e+04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 4.77e+06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+48 is 2.163168e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+49, overlap shift 1.6000e+50 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708965400662       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708965400662       residual = 9.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708965400662       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 1.97e+04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 4.77e+06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+49 is 5.407920e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.374157 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1592e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.3386
    reference variance = 0.411754
====================================================
  Execution time = 4.7631e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9198e-01
  Total weights = 2.0000e+06
  Execution time = 3.8313e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492013750479
                                         uncertainty =       0.003266087539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492013750479
                                         uncertainty =       0.003266087539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495973181
  error estimate for blocks of size 2^( 2) =       0.000522743954
  error estimate for blocks of size 2^( 3) =       0.000548283331
  error estimate for blocks of size 2^( 4) =       0.000568046707
  error estimate for blocks of size 2^( 5) =       0.000580153002
  error estimate for blocks of size 2^( 6) =       0.000586432022
  error estimate for blocks of size 2^( 7) =       0.000589534045

      target function =      -0.712794687915
              le_mean =     -22.426985243976
             les_mean =     503.461645680775
             stat err =       0.000581041444
             autocorr =       1.372454116053
   target nu stat err =       0.000581041444
   target dn stat err =       0.003240407555
      target stat err =       0.002448018947
              std dev =       0.701411999645
             le_variance =       0.491978793246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492013750479
                                         uncertainty =       0.003266087539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492013750479
                                         uncertainty =       0.003266087539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495973181
  error estimate for blocks of size 2^( 2) =       0.000522743954
  error estimate for blocks of size 2^( 3) =       0.000548283331
  error estimate for blocks of size 2^( 4) =       0.000568046707
  error estimate for blocks of size 2^( 5) =       0.000580153002
  error estimate for blocks of size 2^( 6) =       0.000586432022
  error estimate for blocks of size 2^( 7) =       0.000589534045

      target function =      -0.712794687915
              le_mean =     -22.426985243976
             les_mean =     503.461645680775
             stat err =       0.000581041444
             autocorr =       1.372454116053
   target nu stat err =       0.000581041444
   target dn stat err =       0.003240407555
      target stat err =       0.002448018947
              std dev =       0.701411999645
             le_variance =       0.491978793246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492013750479
                                         uncertainty =       0.003266087539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492013750479
                                         uncertainty =       0.003266087539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495973181
  error estimate for blocks of size 2^( 2) =       0.000522743954
  error estimate for blocks of size 2^( 3) =       0.000548283331
  error estimate for blocks of size 2^( 4) =       0.000568046707
  error estimate for blocks of size 2^( 5) =       0.000580153002
  error estimate for blocks of size 2^( 6) =       0.000586432022
  error estimate for blocks of size 2^( 7) =       0.000589534045

      target function =      -0.712794687915
              le_mean =     -22.426985243976
             les_mean =     503.461645680775
             stat err =       0.000581041444
             autocorr =       1.372454116053
   target nu stat err =       0.000581041444
   target dn stat err =       0.003240407555
      target stat err =       0.002448018947
              std dev =       0.701411999645
             le_variance =       0.491978793246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492013750479
                                         uncertainty =       0.003266087539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492013750479
                                         uncertainty =       0.003266087539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495973181
  error estimate for blocks of size 2^( 2) =       0.000522743954
  error estimate for blocks of size 2^( 3) =       0.000548283331
  error estimate for blocks of size 2^( 4) =       0.000568046707
  error estimate for blocks of size 2^( 5) =       0.000580153002
  error estimate for blocks of size 2^( 6) =       0.000586432022
  error estimate for blocks of size 2^( 7) =       0.000589534045

      target function =      -0.712794687915
              le_mean =     -22.426985243976
             les_mean =     503.461645680775
             stat err =       0.000581041444
             autocorr =       1.372454116053
   target nu stat err =       0.000581041444
   target dn stat err =       0.003240407555
      target stat err =       0.002448018947
              std dev =       0.701411999645
             le_variance =       0.491978793246


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.712794687915        initial  <--
     1.0000e+48     1.0000e+49             8.6527e-53        -0.712794687915
     4.0000e+48     4.0000e+49             2.1632e-53        -0.712794687915
     1.6000e+49     1.6000e+50             5.4079e-54        -0.712794687915

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.7730
  </log>
  <optVariables href="FORM.s049.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2837e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2424e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.4276
    reference variance = 0.421754
====================================================
  Execution time = 4.6569e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0623e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5386e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506272458165
                                         uncertainty =       0.005716863907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506272458165
                                         uncertainty =       0.005716863907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503104249
  error estimate for blocks of size 2^( 2) =       0.000529765035
  error estimate for blocks of size 2^( 3) =       0.000554620981
  error estimate for blocks of size 2^( 4) =       0.000574664930
  error estimate for blocks of size 2^( 5) =       0.000588145204
  error estimate for blocks of size 2^( 6) =       0.000595593346
  error estimate for blocks of size 2^( 7) =       0.000601210110

      target function =      -0.702495121668
              le_mean =     -22.426739366551
             les_mean =     503.464866132870
             stat err =       0.000589903397
             autocorr =       1.374819946084
   target nu stat err =       0.000589903397
   target dn stat err =       0.005920360728
      target stat err =       0.004253813297
              std dev =       0.711496852270
             le_variance =       0.506227770791


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242673936655e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+49, overlap shift 1.0000e+50 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702519578132       residual = 4.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702519578132       residual = 7.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.702519578132       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+49 is 7.649233e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+49, overlap shift 4.0000e+50 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702519578132       residual = 4.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702519578132       residual = 7.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.702519578132       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+49 is 1.912308e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+50, overlap shift 1.6000e+51 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702519578132       residual = 4.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702519578132       residual = 7.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.702519578132       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+50 is 4.780771e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.375516 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1965e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.2732
    reference variance = 0.706426
====================================================
  Execution time = 4.5129e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9630e-01
  Total weights = 2.0000e+06
  Execution time = 4.1170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496366069712
                                         uncertainty =       0.005010529455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496366069712
                                         uncertainty =       0.005010529455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498148965
  error estimate for blocks of size 2^( 2) =       0.000524232379
  error estimate for blocks of size 2^( 3) =       0.000549671755
  error estimate for blocks of size 2^( 4) =       0.000568931378
  error estimate for blocks of size 2^( 5) =       0.000581481918
  error estimate for blocks of size 2^( 6) =       0.000588536584
  error estimate for blocks of size 2^( 7) =       0.000591136454

      target function =      -0.709634277562
              le_mean =     -22.426504840930
             les_mean =     503.444423915414
             stat err =       0.000582521583
             autocorr =       1.367431492065
   target nu stat err =       0.000582521583
   target dn stat err =       0.005263258135
      target stat err =       0.003865551042
              std dev =       0.704489022849
             le_variance =       0.496304783315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496366069712
                                         uncertainty =       0.005010529455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496366069712
                                         uncertainty =       0.005010529455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498148965
  error estimate for blocks of size 2^( 2) =       0.000524232379
  error estimate for blocks of size 2^( 3) =       0.000549671755
  error estimate for blocks of size 2^( 4) =       0.000568931378
  error estimate for blocks of size 2^( 5) =       0.000581481918
  error estimate for blocks of size 2^( 6) =       0.000588536584
  error estimate for blocks of size 2^( 7) =       0.000591136454

      target function =      -0.709634277562
              le_mean =     -22.426504840930
             les_mean =     503.444423915414
             stat err =       0.000582521583
             autocorr =       1.367431492065
   target nu stat err =       0.000582521583
   target dn stat err =       0.005263258135
      target stat err =       0.003865551042
              std dev =       0.704489022849
             le_variance =       0.496304783315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496366069712
                                         uncertainty =       0.005010529455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496366069712
                                         uncertainty =       0.005010529455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498148965
  error estimate for blocks of size 2^( 2) =       0.000524232379
  error estimate for blocks of size 2^( 3) =       0.000549671755
  error estimate for blocks of size 2^( 4) =       0.000568931378
  error estimate for blocks of size 2^( 5) =       0.000581481918
  error estimate for blocks of size 2^( 6) =       0.000588536584
  error estimate for blocks of size 2^( 7) =       0.000591136454

      target function =      -0.709634277562
              le_mean =     -22.426504840930
             les_mean =     503.444423915414
             stat err =       0.000582521583
             autocorr =       1.367431492065
   target nu stat err =       0.000582521583
   target dn stat err =       0.005263258135
      target stat err =       0.003865551042
              std dev =       0.704489022849
             le_variance =       0.496304783315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496366069712
                                         uncertainty =       0.005010529455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496366069712
                                         uncertainty =       0.005010529455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498148965
  error estimate for blocks of size 2^( 2) =       0.000524232379
  error estimate for blocks of size 2^( 3) =       0.000549671755
  error estimate for blocks of size 2^( 4) =       0.000568931378
  error estimate for blocks of size 2^( 5) =       0.000581481918
  error estimate for blocks of size 2^( 6) =       0.000588536584
  error estimate for blocks of size 2^( 7) =       0.000591136454

      target function =      -0.709634277562
              le_mean =     -22.426504840930
             les_mean =     503.444423915414
             stat err =       0.000582521583
             autocorr =       1.367431492065
   target nu stat err =       0.000582521583
   target dn stat err =       0.005263258135
      target stat err =       0.003865551042
              std dev =       0.704489022849
             le_variance =       0.496304783315


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.709634277562        initial  <--
     1.0000e+49     1.0000e+50             7.6492e-54        -0.709634277562
     4.0000e+49     4.0000e+50             1.9123e-54        -0.709634277562
     1.6000e+50     1.6000e+51             4.7808e-55        -0.709634277562

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.8631
  </log>
  <optVariables href="FORM.s050.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2719e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2423e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.4197
    reference variance = 0.266022
====================================================
  Execution time = 4.5543e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9490e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5399e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495024596040
                                         uncertainty =       0.003708598242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495024596040
                                         uncertainty =       0.003708598242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497444104
  error estimate for blocks of size 2^( 2) =       0.000524128198
  error estimate for blocks of size 2^( 3) =       0.000549397401
  error estimate for blocks of size 2^( 4) =       0.000569289885
  error estimate for blocks of size 2^( 5) =       0.000580390617
  error estimate for blocks of size 2^( 6) =       0.000587224773
  error estimate for blocks of size 2^( 7) =       0.000591479442

      target function =      -0.710654815822
              le_mean =     -22.427070911931
             les_mean =     503.468410714764
             stat err =       0.000582096179
             autocorr =       1.369307294941
   target nu stat err =       0.000582096179
   target dn stat err =       0.003933373128
      target stat err =       0.002926298169
              std dev =       0.703492198552
             le_variance =       0.494901273424


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242707091193e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+50, overlap shift 1.0000e+51 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710666038556       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710666038556       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+50, overlap shift 4.0000e+51 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710666038556       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710666038556       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+51, overlap shift 1.6000e+52 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710666038556       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710666038556       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.376639 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0949e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.3993
    reference variance = 0.462935
====================================================
  Execution time = 4.5412e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9809e-01
  Total weights = 2.0000e+06
  Execution time = 3.8321e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498127534498
                                         uncertainty =       0.004986094496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498127534498
                                         uncertainty =       0.004986094496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499045901
  error estimate for blocks of size 2^( 2) =       0.000525250960
  error estimate for blocks of size 2^( 3) =       0.000550393118
  error estimate for blocks of size 2^( 4) =       0.000569187984
  error estimate for blocks of size 2^( 5) =       0.000581895571
  error estimate for blocks of size 2^( 6) =       0.000587483664
  error estimate for blocks of size 2^( 7) =       0.000592184052

      target function =      -0.708326423400
              le_mean =     -22.427278016593
             les_mean =     503.480892606408
             stat err =       0.000582687818
             autocorr =       1.363298296362
   target nu stat err =       0.000582687818
   target dn stat err =       0.005051535589
      target stat err =       0.003704466959
              std dev =       0.705757480931
             le_variance =       0.498093621890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498127534498
                                         uncertainty =       0.004986094496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498127534498
                                         uncertainty =       0.004986094496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499045901
  error estimate for blocks of size 2^( 2) =       0.000525250960
  error estimate for blocks of size 2^( 3) =       0.000550393118
  error estimate for blocks of size 2^( 4) =       0.000569187984
  error estimate for blocks of size 2^( 5) =       0.000581895571
  error estimate for blocks of size 2^( 6) =       0.000587483664
  error estimate for blocks of size 2^( 7) =       0.000592184052

      target function =      -0.708326423400
              le_mean =     -22.427278016593
             les_mean =     503.480892606408
             stat err =       0.000582687818
             autocorr =       1.363298296362
   target nu stat err =       0.000582687818
   target dn stat err =       0.005051535589
      target stat err =       0.003704466959
              std dev =       0.705757480931
             le_variance =       0.498093621890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498127534498
                                         uncertainty =       0.004986094496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498127534498
                                         uncertainty =       0.004986094496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499045901
  error estimate for blocks of size 2^( 2) =       0.000525250960
  error estimate for blocks of size 2^( 3) =       0.000550393118
  error estimate for blocks of size 2^( 4) =       0.000569187984
  error estimate for blocks of size 2^( 5) =       0.000581895571
  error estimate for blocks of size 2^( 6) =       0.000587483664
  error estimate for blocks of size 2^( 7) =       0.000592184052

      target function =      -0.708326423400
              le_mean =     -22.427278016593
             les_mean =     503.480892606408
             stat err =       0.000582687818
             autocorr =       1.363298296362
   target nu stat err =       0.000582687818
   target dn stat err =       0.005051535589
      target stat err =       0.003704466959
              std dev =       0.705757480931
             le_variance =       0.498093621890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498127534498
                                         uncertainty =       0.004986094496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498127534498
                                         uncertainty =       0.004986094496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499045901
  error estimate for blocks of size 2^( 2) =       0.000525250960
  error estimate for blocks of size 2^( 3) =       0.000550393118
  error estimate for blocks of size 2^( 4) =       0.000569187984
  error estimate for blocks of size 2^( 5) =       0.000581895571
  error estimate for blocks of size 2^( 6) =       0.000587483664
  error estimate for blocks of size 2^( 7) =       0.000592184052

      target function =      -0.708326423400
              le_mean =     -22.427278016593
             les_mean =     503.480892606408
             stat err =       0.000582687818
             autocorr =       1.363298296362
   target nu stat err =       0.000582687818
   target dn stat err =       0.005051535589
      target stat err =       0.003704466959
              std dev =       0.705757480931
             le_variance =       0.498093621890


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.708326423400        initial  <--
     1.0000e+50     1.0000e+51             0.0000e+00        -0.708326423400
     4.0000e+50     4.0000e+51             0.0000e+00        -0.708326423400
     1.6000e+51     1.6000e+52             0.0000e+00        -0.708326423400

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.5750
  </log>
  <optVariables href="FORM.s051.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2555e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2423e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.4408
    reference variance = 0.420401
====================================================
  Execution time = 4.7247e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0013e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5298e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500207711872
                                         uncertainty =       0.006294418704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500207711872
                                         uncertainty =       0.006294418704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500066762
  error estimate for blocks of size 2^( 2) =       0.000526811941
  error estimate for blocks of size 2^( 3) =       0.000552015636
  error estimate for blocks of size 2^( 4) =       0.000571448093
  error estimate for blocks of size 2^( 5) =       0.000585124779
  error estimate for blocks of size 2^( 6) =       0.000592161462
  error estimate for blocks of size 2^( 7) =       0.000597359751

      target function =      -0.706853447416
              le_mean =     -22.426716537569
             les_mean =     503.457747940011
             stat err =       0.000586523521
             autocorr =       1.375671966375
   target nu stat err =       0.000586523521
   target dn stat err =       0.006361579480
      target stat err =       0.004620552131
              std dev =       0.707201197395
             le_variance =       0.500133533597


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242671653757e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+51, overlap shift 1.0000e+52 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706882451580       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706882451580       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+51, overlap shift 4.0000e+52 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706882451580       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706882451580       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+52, overlap shift 1.6000e+53 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706882451580       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706882451580       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.377789 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2555e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.4484
    reference variance = 0.581584
====================================================
  Execution time = 4.5252e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9431e-01
  Total weights = 2.0000e+06
  Execution time = 3.8153e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494331478239
                                         uncertainty =       0.004400568584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494331478239
                                         uncertainty =       0.004400568584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497149416
  error estimate for blocks of size 2^( 2) =       0.000524401160
  error estimate for blocks of size 2^( 3) =       0.000550297290
  error estimate for blocks of size 2^( 4) =       0.000569627599
  error estimate for blocks of size 2^( 5) =       0.000582436428
  error estimate for blocks of size 2^( 6) =       0.000589958219
  error estimate for blocks of size 2^( 7) =       0.000592781786

      target function =      -0.711082154983
              le_mean =     -22.426789273506
             les_mean =     503.455191954548
             stat err =       0.000583701008
             autocorr =       1.378500789785
   target nu stat err =       0.000583701008
   target dn stat err =       0.004581922067
      target stat err =       0.003393056021
              std dev =       0.703075446479
             le_variance =       0.494315083441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494331478239
                                         uncertainty =       0.004400568584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494331478239
                                         uncertainty =       0.004400568584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497149416
  error estimate for blocks of size 2^( 2) =       0.000524401160
  error estimate for blocks of size 2^( 3) =       0.000550297290
  error estimate for blocks of size 2^( 4) =       0.000569627599
  error estimate for blocks of size 2^( 5) =       0.000582436428
  error estimate for blocks of size 2^( 6) =       0.000589958219
  error estimate for blocks of size 2^( 7) =       0.000592781786

      target function =      -0.711082154983
              le_mean =     -22.426789273506
             les_mean =     503.455191954548
             stat err =       0.000583701008
             autocorr =       1.378500789785
   target nu stat err =       0.000583701008
   target dn stat err =       0.004581922067
      target stat err =       0.003393056021
              std dev =       0.703075446479
             le_variance =       0.494315083441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494331478239
                                         uncertainty =       0.004400568584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494331478239
                                         uncertainty =       0.004400568584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497149416
  error estimate for blocks of size 2^( 2) =       0.000524401160
  error estimate for blocks of size 2^( 3) =       0.000550297290
  error estimate for blocks of size 2^( 4) =       0.000569627599
  error estimate for blocks of size 2^( 5) =       0.000582436428
  error estimate for blocks of size 2^( 6) =       0.000589958219
  error estimate for blocks of size 2^( 7) =       0.000592781786

      target function =      -0.711082154983
              le_mean =     -22.426789273506
             les_mean =     503.455191954548
             stat err =       0.000583701008
             autocorr =       1.378500789785
   target nu stat err =       0.000583701008
   target dn stat err =       0.004581922067
      target stat err =       0.003393056021
              std dev =       0.703075446479
             le_variance =       0.494315083441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494331478239
                                         uncertainty =       0.004400568584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494331478239
                                         uncertainty =       0.004400568584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497149416
  error estimate for blocks of size 2^( 2) =       0.000524401160
  error estimate for blocks of size 2^( 3) =       0.000550297290
  error estimate for blocks of size 2^( 4) =       0.000569627599
  error estimate for blocks of size 2^( 5) =       0.000582436428
  error estimate for blocks of size 2^( 6) =       0.000589958219
  error estimate for blocks of size 2^( 7) =       0.000592781786

      target function =      -0.711082154983
              le_mean =     -22.426789273506
             les_mean =     503.455191954548
             stat err =       0.000583701008
             autocorr =       1.378500789785
   target nu stat err =       0.000583701008
   target dn stat err =       0.004581922067
      target stat err =       0.003393056021
              std dev =       0.703075446479
             le_variance =       0.494315083441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.711082154983        initial  <--
     1.0000e+51     1.0000e+52             0.0000e+00        -0.711082154983
     4.0000e+51     4.0000e+52             0.0000e+00        -0.711082154983
     1.6000e+52     1.6000e+53             0.0000e+00        -0.711082154983

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.4496
  </log>
  <optVariables href="FORM.s052.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2701e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2423e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.5198
    reference variance = 1.22518
====================================================
  Execution time = 4.8492e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0452e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5157e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504518398562
                                         uncertainty =       0.009307753963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504518398562
                                         uncertainty =       0.009307753963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502254247
  error estimate for blocks of size 2^( 2) =       0.000528288046
  error estimate for blocks of size 2^( 3) =       0.000553363267
  error estimate for blocks of size 2^( 4) =       0.000572532914
  error estimate for blocks of size 2^( 5) =       0.000585378899
  error estimate for blocks of size 2^( 6) =       0.000590759150
  error estimate for blocks of size 2^( 7) =       0.000592550673

      target function =      -0.703668463904
              le_mean =     -22.427051061021
             les_mean =     503.477137698922
             stat err =       0.000585305409
             autocorr =       1.358056502054
   target nu stat err =       0.000585305409
   target dn stat err =       0.009297261691
      target stat err =       0.006665902214
              std dev =       0.710294768058
             le_variance =       0.504518657531


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242705106102e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+52, overlap shift 1.0000e+53 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.703730039332       residual = 8.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.703730039332       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.703730039332       residual = 7.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.703730039332       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.703730039332       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+52 is 1.205557e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+52, overlap shift 4.0000e+53 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.703730039332       residual = 8.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.703730039332       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.703730039332       residual = 7.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.703730039332       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.703730039332       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+52 is 3.013891e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+53, overlap shift 1.6000e+54 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.703730039332       residual = 8.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.703730039332       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.703730039332       residual = 7.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.703730039332       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.703730039332       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+53 is 7.534729e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.379759 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3658e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.414
    reference variance = 0.346755
====================================================
  Execution time = 4.4849e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0033e-01
  Total weights = 2.0000e+06
  Execution time = 3.8103e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500330035777
                                         uncertainty =       0.005205390487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500330035777
                                         uncertainty =       0.005205390487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500164731
  error estimate for blocks of size 2^( 2) =       0.000526629121
  error estimate for blocks of size 2^( 3) =       0.000551814255
  error estimate for blocks of size 2^( 4) =       0.000571889627
  error estimate for blocks of size 2^( 5) =       0.000583567027
  error estimate for blocks of size 2^( 6) =       0.000590091220
  error estimate for blocks of size 2^( 7) =       0.000594108900

      target function =      -0.706713629780
              le_mean =     -22.426945485403
             les_mean =     503.468213072141
             stat err =       0.000584914194
             autocorr =       1.367597162096
   target nu stat err =       0.000584914194
   target dn stat err =       0.005659235589
      target stat err =       0.004118953037
              std dev =       0.707339746564
             le_variance =       0.500329517069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500330035777
                                         uncertainty =       0.005205390487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500330035777
                                         uncertainty =       0.005205390487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500164731
  error estimate for blocks of size 2^( 2) =       0.000526629121
  error estimate for blocks of size 2^( 3) =       0.000551814255
  error estimate for blocks of size 2^( 4) =       0.000571889627
  error estimate for blocks of size 2^( 5) =       0.000583567027
  error estimate for blocks of size 2^( 6) =       0.000590091220
  error estimate for blocks of size 2^( 7) =       0.000594108900

      target function =      -0.706713629780
              le_mean =     -22.426945485403
             les_mean =     503.468213072141
             stat err =       0.000584914194
             autocorr =       1.367597162096
   target nu stat err =       0.000584914194
   target dn stat err =       0.005659235589
      target stat err =       0.004118953037
              std dev =       0.707339746564
             le_variance =       0.500329517069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500330035777
                                         uncertainty =       0.005205390487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500330035777
                                         uncertainty =       0.005205390487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500164731
  error estimate for blocks of size 2^( 2) =       0.000526629121
  error estimate for blocks of size 2^( 3) =       0.000551814255
  error estimate for blocks of size 2^( 4) =       0.000571889627
  error estimate for blocks of size 2^( 5) =       0.000583567027
  error estimate for blocks of size 2^( 6) =       0.000590091220
  error estimate for blocks of size 2^( 7) =       0.000594108900

      target function =      -0.706713629780
              le_mean =     -22.426945485403
             les_mean =     503.468213072141
             stat err =       0.000584914194
             autocorr =       1.367597162096
   target nu stat err =       0.000584914194
   target dn stat err =       0.005659235589
      target stat err =       0.004118953037
              std dev =       0.707339746564
             le_variance =       0.500329517069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500330035777
                                         uncertainty =       0.005205390487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500330035777
                                         uncertainty =       0.005205390487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500164731
  error estimate for blocks of size 2^( 2) =       0.000526629121
  error estimate for blocks of size 2^( 3) =       0.000551814255
  error estimate for blocks of size 2^( 4) =       0.000571889627
  error estimate for blocks of size 2^( 5) =       0.000583567027
  error estimate for blocks of size 2^( 6) =       0.000590091220
  error estimate for blocks of size 2^( 7) =       0.000594108900

      target function =      -0.706713629780
              le_mean =     -22.426945485403
             les_mean =     503.468213072141
             stat err =       0.000584914194
             autocorr =       1.367597162096
   target nu stat err =       0.000584914194
   target dn stat err =       0.005659235589
      target stat err =       0.004118953037
              std dev =       0.707339746564
             le_variance =       0.500329517069


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706713629780        initial  <--
     1.0000e+52     1.0000e+53             1.2056e-56        -0.706713629780
     4.0000e+52     4.0000e+53             3.0139e-57        -0.706713629780
     1.6000e+53     1.6000e+54             7.5347e-58        -0.706713629780

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9710
  </log>
  <optVariables href="FORM.s053.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2765e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2424e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.3779
    reference variance = 0.563606
====================================================
  Execution time = 4.6986e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9379e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5396e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493900103031
                                         uncertainty =       0.003530360575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493900103031
                                         uncertainty =       0.003530360575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496884845
  error estimate for blocks of size 2^( 2) =       0.000523741876
  error estimate for blocks of size 2^( 3) =       0.000548958186
  error estimate for blocks of size 2^( 4) =       0.000568786439
  error estimate for blocks of size 2^( 5) =       0.000581338586
  error estimate for blocks of size 2^( 6) =       0.000587967985
  error estimate for blocks of size 2^( 7) =       0.000588536379

      target function =      -0.711466608162
              le_mean =     -22.427076579836
             les_mean =     503.467552769078
             stat err =       0.000581657348
             autocorr =       1.370322962567
   target nu stat err =       0.000581657348
   target dn stat err =       0.003813062395
      target stat err =       0.002846842783
              std dev =       0.702701286559
             le_variance =       0.493789098131


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242707657984e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+53, overlap shift 1.0000e+54 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711476942207       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711476942207       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+53, overlap shift 4.0000e+54 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711476942207       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711476942207       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+54, overlap shift 1.6000e+55 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711476942207       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711476942207       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.380898 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2395e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.3164
    reference variance = 0.48256
====================================================
  Execution time = 4.4937e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9195e-01
  Total weights = 2.0000e+06
  Execution time = 3.8661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491887381062
                                         uncertainty =       0.003735259260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491887381062
                                         uncertainty =       0.003735259260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495956786
  error estimate for blocks of size 2^( 2) =       0.000522482056
  error estimate for blocks of size 2^( 3) =       0.000548021665
  error estimate for blocks of size 2^( 4) =       0.000568552021
  error estimate for blocks of size 2^( 5) =       0.000579920314
  error estimate for blocks of size 2^( 6) =       0.000586656638
  error estimate for blocks of size 2^( 7) =       0.000590672237

      target function =      -0.712809703999
              le_mean =     -22.427512429146
             les_mean =     503.485259781351
             stat err =       0.000581450303
             autocorr =       1.374477159436
   target nu stat err =       0.000581450303
   target dn stat err =       0.003694513918
      target stat err =       0.002774174847
              std dev =       0.701388813596
             le_variance =       0.491946267837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491887381062
                                         uncertainty =       0.003735259260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491887381062
                                         uncertainty =       0.003735259260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495956786
  error estimate for blocks of size 2^( 2) =       0.000522482056
  error estimate for blocks of size 2^( 3) =       0.000548021665
  error estimate for blocks of size 2^( 4) =       0.000568552021
  error estimate for blocks of size 2^( 5) =       0.000579920314
  error estimate for blocks of size 2^( 6) =       0.000586656638
  error estimate for blocks of size 2^( 7) =       0.000590672237

      target function =      -0.712809703999
              le_mean =     -22.427512429146
             les_mean =     503.485259781351
             stat err =       0.000581450303
             autocorr =       1.374477159436
   target nu stat err =       0.000581450303
   target dn stat err =       0.003694513918
      target stat err =       0.002774174847
              std dev =       0.701388813596
             le_variance =       0.491946267837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491887381062
                                         uncertainty =       0.003735259260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491887381062
                                         uncertainty =       0.003735259260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495956786
  error estimate for blocks of size 2^( 2) =       0.000522482056
  error estimate for blocks of size 2^( 3) =       0.000548021665
  error estimate for blocks of size 2^( 4) =       0.000568552021
  error estimate for blocks of size 2^( 5) =       0.000579920314
  error estimate for blocks of size 2^( 6) =       0.000586656638
  error estimate for blocks of size 2^( 7) =       0.000590672237

      target function =      -0.712809703999
              le_mean =     -22.427512429146
             les_mean =     503.485259781351
             stat err =       0.000581450303
             autocorr =       1.374477159436
   target nu stat err =       0.000581450303
   target dn stat err =       0.003694513918
      target stat err =       0.002774174847
              std dev =       0.701388813596
             le_variance =       0.491946267837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491887381062
                                         uncertainty =       0.003735259260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491887381062
                                         uncertainty =       0.003735259260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495956786
  error estimate for blocks of size 2^( 2) =       0.000522482056
  error estimate for blocks of size 2^( 3) =       0.000548021665
  error estimate for blocks of size 2^( 4) =       0.000568552021
  error estimate for blocks of size 2^( 5) =       0.000579920314
  error estimate for blocks of size 2^( 6) =       0.000586656638
  error estimate for blocks of size 2^( 7) =       0.000590672237

      target function =      -0.712809703999
              le_mean =     -22.427512429146
             les_mean =     503.485259781351
             stat err =       0.000581450303
             autocorr =       1.374477159436
   target nu stat err =       0.000581450303
   target dn stat err =       0.003694513918
      target stat err =       0.002774174847
              std dev =       0.701388813596
             le_variance =       0.491946267837


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.712809703999        initial  <--
     1.0000e+53     1.0000e+54             0.0000e+00        -0.712809703999
     4.0000e+53     4.0000e+54             0.0000e+00        -0.712809703999
     1.6000e+54     1.6000e+55             0.0000e+00        -0.712809703999

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.1039
  </log>
  <optVariables href="FORM.s054.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2651e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2422e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.3575
    reference variance = 0.566494
====================================================
  Execution time = 4.6024e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2428e+01
  VMC Evar = 5.4341e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5237e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543575042348
                                         uncertainty =       0.042256743073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543575042348
                                         uncertainty =       0.042256743073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000521251842
  error estimate for blocks of size 2^( 2) =       0.000546386291
  error estimate for blocks of size 2^( 3) =       0.000571250982
  error estimate for blocks of size 2^( 4) =       0.000589999922
  error estimate for blocks of size 2^( 5) =       0.000601703268
  error estimate for blocks of size 2^( 6) =       0.000607137950
  error estimate for blocks of size 2^( 7) =       0.000611141435

      target function =      -0.675810415353
              le_mean =     -22.427585674359
             les_mean =     503.540005874336
             stat err =       0.000602495644
             autocorr =       1.336018946568
   target nu stat err =       0.000602495644
   target dn stat err =       0.042473051944
      target stat err =       0.028050631936
              std dev =       0.737161424205
             le_variance =       0.543406965336


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242758567436e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+54, overlap shift 1.0000e+55 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.676978985551       residual = 5.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.676978985551       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.676978985551       residual = 8.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.676978985551       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.676978535198       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 2.44e+14           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+54 is 6.924905e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+54, overlap shift 4.0000e+55 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.676978985551       residual = 5.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.676978985551       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.676978985551       residual = 8.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.676978985551       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.676978535198       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 2.44e+14           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+54 is 1.731226e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+55, overlap shift 1.6000e+56 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.676978985551       residual = 5.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.676978985551       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.676978985551       residual = 8.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.676978985551       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.676978535198       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 2.44e+14           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+55 is 4.328066e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.383228 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1275e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.4281
    reference variance = 0.358048
====================================================
  Execution time = 4.7099e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.0503e-01
  Total weights = 2.0000e+06
  Execution time = 3.8124e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504879288454
                                         uncertainty =       0.006068686767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504879288454
                                         uncertainty =       0.006068686767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502511303
  error estimate for blocks of size 2^( 2) =       0.000528908564
  error estimate for blocks of size 2^( 3) =       0.000554540960
  error estimate for blocks of size 2^( 4) =       0.000574590616
  error estimate for blocks of size 2^( 5) =       0.000587293563
  error estimate for blocks of size 2^( 6) =       0.000594696334
  error estimate for blocks of size 2^( 7) =       0.000597363474

      target function =      -0.703339073396
              le_mean =     -22.426746644429
             les_mean =     503.464000019330
             stat err =       0.000588485997
             autocorr =       1.371451953894
   target nu stat err =       0.000588485997
   target dn stat err =       0.006469823159
      target stat err =       0.004652108855
              std dev =       0.710658299367
             le_variance =       0.505035218460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504879288454
                                         uncertainty =       0.006068686767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504879288454
                                         uncertainty =       0.006068686767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502511303
  error estimate for blocks of size 2^( 2) =       0.000528908564
  error estimate for blocks of size 2^( 3) =       0.000554540960
  error estimate for blocks of size 2^( 4) =       0.000574590616
  error estimate for blocks of size 2^( 5) =       0.000587293563
  error estimate for blocks of size 2^( 6) =       0.000594696334
  error estimate for blocks of size 2^( 7) =       0.000597363474

      target function =      -0.703339073396
              le_mean =     -22.426746644429
             les_mean =     503.464000019330
             stat err =       0.000588485997
             autocorr =       1.371451953890
   target nu stat err =       0.000588485997
   target dn stat err =       0.006469823159
      target stat err =       0.004652108855
              std dev =       0.710658299367
             le_variance =       0.505035218460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504879288454
                                         uncertainty =       0.006068686767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504879288454
                                         uncertainty =       0.006068686767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502511303
  error estimate for blocks of size 2^( 2) =       0.000528908564
  error estimate for blocks of size 2^( 3) =       0.000554540960
  error estimate for blocks of size 2^( 4) =       0.000574590616
  error estimate for blocks of size 2^( 5) =       0.000587293563
  error estimate for blocks of size 2^( 6) =       0.000594696334
  error estimate for blocks of size 2^( 7) =       0.000597363474

      target function =      -0.703339073396
              le_mean =     -22.426746644429
             les_mean =     503.464000019330
             stat err =       0.000588485997
             autocorr =       1.371451953890
   target nu stat err =       0.000588485997
   target dn stat err =       0.006469823159
      target stat err =       0.004652108855
              std dev =       0.710658299367
             le_variance =       0.505035218460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504879288454
                                         uncertainty =       0.006068686767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504879288454
                                         uncertainty =       0.006068686767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502511303
  error estimate for blocks of size 2^( 2) =       0.000528908564
  error estimate for blocks of size 2^( 3) =       0.000554540960
  error estimate for blocks of size 2^( 4) =       0.000574590616
  error estimate for blocks of size 2^( 5) =       0.000587293563
  error estimate for blocks of size 2^( 6) =       0.000594696334
  error estimate for blocks of size 2^( 7) =       0.000597363474

      target function =      -0.703339073396
              le_mean =     -22.426746644429
             les_mean =     503.464000019330
             stat err =       0.000588485997
             autocorr =       1.371451953890
   target nu stat err =       0.000588485997
   target dn stat err =       0.006469823159
      target stat err =       0.004652108855
              std dev =       0.710658299367
             le_variance =       0.505035218460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.703339073396        initial  <--
     1.0000e+54     1.0000e+55             6.9249e-58        -0.703339073396
     4.0000e+54     4.0000e+55             1.7312e-58        -0.703339073396
     1.6000e+55     1.6000e+56             4.3281e-59        -0.703339073396

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.2598
  </log>
  <optVariables href="FORM.s055.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2763e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2422e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.494
    reference variance = 0.56288
====================================================
  Execution time = 4.5528e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2428e+01
  VMC Evar = 5.0767e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5020e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507631388124
                                         uncertainty =       0.010927757485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507631388124
                                         uncertainty =       0.010927757485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503820690
  error estimate for blocks of size 2^( 2) =       0.000529865547
  error estimate for blocks of size 2^( 3) =       0.000554619110
  error estimate for blocks of size 2^( 4) =       0.000574591564
  error estimate for blocks of size 2^( 5) =       0.000586486627
  error estimate for blocks of size 2^( 6) =       0.000592501155
  error estimate for blocks of size 2^( 7) =       0.000595034106

      target function =      -0.701366860540
              le_mean =     -22.428092514142
             les_mean =     503.527004143777
             stat err =       0.000587153363
             autocorr =       1.358160543534
   target nu stat err =       0.000587153363
   target dn stat err =       0.011146944369
      target stat err =       0.007942817514
              std dev =       0.712510052353
             le_variance =       0.507670574704


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242809251414e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+55, overlap shift 1.0000e+56 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.701456758264       residual = 5.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.701456758264       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 2.53e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.53e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+55 is 5.542966e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+55, overlap shift 4.0000e+56 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.701456758264       residual = 5.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.701456758264       residual = 5.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+56, overlap shift 1.6000e+57 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.701456758264       residual = 5.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.701456758264       residual = 5.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.384532 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0556e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.4064
    reference variance = 0.359078
====================================================
  Execution time = 4.7027e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2428e+01
  VMC Evar = 5.0779e-01
  Total weights = 2.0000e+06
  Execution time = 3.8027e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507845746909
                                         uncertainty =       0.012509231563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507845746909
                                         uncertainty =       0.012509231563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503881379
  error estimate for blocks of size 2^( 2) =       0.000529738513
  error estimate for blocks of size 2^( 3) =       0.000554230398
  error estimate for blocks of size 2^( 4) =       0.000574049488
  error estimate for blocks of size 2^( 5) =       0.000586144860
  error estimate for blocks of size 2^( 6) =       0.000591091202
  error estimate for blocks of size 2^( 7) =       0.000591991812

      target function =      -0.701273750670
              le_mean =     -22.427525011379
             les_mean =     503.501670770347
             stat err =       0.000585819341
             autocorr =       1.351670367657
   target nu stat err =       0.000585819341
   target dn stat err =       0.012484039151
      target stat err =       0.008881073531
              std dev =       0.712595880013
             le_variance =       0.507792888211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507845746909
                                         uncertainty =       0.012509231563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507845746909
                                         uncertainty =       0.012509231563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503881379
  error estimate for blocks of size 2^( 2) =       0.000529738513
  error estimate for blocks of size 2^( 3) =       0.000554230398
  error estimate for blocks of size 2^( 4) =       0.000574049488
  error estimate for blocks of size 2^( 5) =       0.000586144860
  error estimate for blocks of size 2^( 6) =       0.000591091202
  error estimate for blocks of size 2^( 7) =       0.000591991812

      target function =      -0.701273750670
              le_mean =     -22.427525011379
             les_mean =     503.501670770347
             stat err =       0.000585819341
             autocorr =       1.351670367652
   target nu stat err =       0.000585819341
   target dn stat err =       0.012484039151
      target stat err =       0.008881073531
              std dev =       0.712595880013
             le_variance =       0.507792888211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507845746909
                                         uncertainty =       0.012509231563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507845746909
                                         uncertainty =       0.012509231563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503881379
  error estimate for blocks of size 2^( 2) =       0.000529738513
  error estimate for blocks of size 2^( 3) =       0.000554230398
  error estimate for blocks of size 2^( 4) =       0.000574049488
  error estimate for blocks of size 2^( 5) =       0.000586144860
  error estimate for blocks of size 2^( 6) =       0.000591091202
  error estimate for blocks of size 2^( 7) =       0.000591991812

      target function =      -0.701273750670
              le_mean =     -22.427525011379
             les_mean =     503.501670770347
             stat err =       0.000585819341
             autocorr =       1.351670367652
   target nu stat err =       0.000585819341
   target dn stat err =       0.012484039151
      target stat err =       0.008881073531
              std dev =       0.712595880013
             le_variance =       0.507792888211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507845746909
                                         uncertainty =       0.012509231563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507845746909
                                         uncertainty =       0.012509231563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503881379
  error estimate for blocks of size 2^( 2) =       0.000529738513
  error estimate for blocks of size 2^( 3) =       0.000554230398
  error estimate for blocks of size 2^( 4) =       0.000574049488
  error estimate for blocks of size 2^( 5) =       0.000586144860
  error estimate for blocks of size 2^( 6) =       0.000591091202
  error estimate for blocks of size 2^( 7) =       0.000591991812

      target function =      -0.701273750670
              le_mean =     -22.427525011379
             les_mean =     503.501670770347
             stat err =       0.000585819341
             autocorr =       1.351670367652
   target nu stat err =       0.000585819341
   target dn stat err =       0.012484039151
      target stat err =       0.008881073531
              std dev =       0.712595880013
             le_variance =       0.507792888211


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.701273750670        initial  <--
     1.0000e+55     1.0000e+56             5.5430e-60        -0.701273750670
     4.0000e+55     4.0000e+56             0.0000e+00        -0.701273750670
     1.6000e+56     1.6000e+57             0.0000e+00        -0.701273750670

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.0952
  </log>
  <optVariables href="FORM.s056.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2666e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2422e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.4545
    reference variance = 0.657137
====================================================
  Execution time = 4.5391e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.0837e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5104e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508413309395
                                         uncertainty =       0.009869524939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508413309395
                                         uncertainty =       0.009869524939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504167273
  error estimate for blocks of size 2^( 2) =       0.000530698982
  error estimate for blocks of size 2^( 3) =       0.000556287212
  error estimate for blocks of size 2^( 4) =       0.000575518171
  error estimate for blocks of size 2^( 5) =       0.000587660639
  error estimate for blocks of size 2^( 6) =       0.000593925150
  error estimate for blocks of size 2^( 7) =       0.000596817794

      target function =      -0.700959899395
              le_mean =     -22.426423383344
             les_mean =     503.452834792647
             stat err =       0.000588480439
             autocorr =       1.362431766385
   target nu stat err =       0.000588480439
   target dn stat err =       0.008283994164
      target stat err =       0.005894954067
              std dev =       0.713000194837
             le_variance =       0.508369277837


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242642338334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+56, overlap shift 1.0000e+57 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.701008051149       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.701008051149       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+56, overlap shift 4.0000e+57 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.701008051149       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.701008051149       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+57, overlap shift 1.6000e+58 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.701008051149       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.701008051149       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.385618 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0503e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.5812
    reference variance = 0.482034
====================================================
  Execution time = 4.5553e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2428e+01
  VMC Evar = 5.0095e-01
  Total weights = 2.0000e+06
  Execution time = 3.8136e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500935222556
                                         uncertainty =       0.009898620116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500935222556
                                         uncertainty =       0.009898620116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500476222
  error estimate for blocks of size 2^( 2) =       0.000526853898
  error estimate for blocks of size 2^( 3) =       0.000552250746
  error estimate for blocks of size 2^( 4) =       0.000571176414
  error estimate for blocks of size 2^( 5) =       0.000583556433
  error estimate for blocks of size 2^( 6) =       0.000590180660
  error estimate for blocks of size 2^( 7) =       0.000595763653

      target function =      -0.706212523130
              le_mean =     -22.428102053517
             les_mean =     503.520714370140
             stat err =       0.000585169290
             autocorr =       1.367087004209
   target nu stat err =       0.000585169290
   target dn stat err =       0.008307319616
      target stat err =       0.006014088566
              std dev =       0.707780260835
             le_variance =       0.500952897628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500935222556
                                         uncertainty =       0.009898620116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500935222556
                                         uncertainty =       0.009898620116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500476222
  error estimate for blocks of size 2^( 2) =       0.000526853898
  error estimate for blocks of size 2^( 3) =       0.000552250746
  error estimate for blocks of size 2^( 4) =       0.000571176414
  error estimate for blocks of size 2^( 5) =       0.000583556433
  error estimate for blocks of size 2^( 6) =       0.000590180660
  error estimate for blocks of size 2^( 7) =       0.000595763653

      target function =      -0.706212523130
              le_mean =     -22.428102053517
             les_mean =     503.520714370140
             stat err =       0.000585169290
             autocorr =       1.367087004209
   target nu stat err =       0.000585169290
   target dn stat err =       0.008307319616
      target stat err =       0.006014088566
              std dev =       0.707780260835
             le_variance =       0.500952897628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500935222556
                                         uncertainty =       0.009898620116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500935222556
                                         uncertainty =       0.009898620116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500476222
  error estimate for blocks of size 2^( 2) =       0.000526853898
  error estimate for blocks of size 2^( 3) =       0.000552250746
  error estimate for blocks of size 2^( 4) =       0.000571176414
  error estimate for blocks of size 2^( 5) =       0.000583556433
  error estimate for blocks of size 2^( 6) =       0.000590180660
  error estimate for blocks of size 2^( 7) =       0.000595763653

      target function =      -0.706212523130
              le_mean =     -22.428102053517
             les_mean =     503.520714370140
             stat err =       0.000585169290
             autocorr =       1.367087004209
   target nu stat err =       0.000585169290
   target dn stat err =       0.008307319616
      target stat err =       0.006014088566
              std dev =       0.707780260835
             le_variance =       0.500952897628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500935222556
                                         uncertainty =       0.009898620116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500935222556
                                         uncertainty =       0.009898620116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500476222
  error estimate for blocks of size 2^( 2) =       0.000526853898
  error estimate for blocks of size 2^( 3) =       0.000552250746
  error estimate for blocks of size 2^( 4) =       0.000571176414
  error estimate for blocks of size 2^( 5) =       0.000583556433
  error estimate for blocks of size 2^( 6) =       0.000590180660
  error estimate for blocks of size 2^( 7) =       0.000595763653

      target function =      -0.706212523130
              le_mean =     -22.428102053517
             les_mean =     503.520714370140
             stat err =       0.000585169290
             autocorr =       1.367087004209
   target nu stat err =       0.000585169290
   target dn stat err =       0.008307319616
      target stat err =       0.006014088566
              std dev =       0.707780260835
             le_variance =       0.500952897628


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706212523130        initial  <--
     1.0000e+56     1.0000e+57             0.0000e+00        -0.706212523130
     4.0000e+56     4.0000e+57             0.0000e+00        -0.706212523130
     1.6000e+57     1.6000e+58             0.0000e+00        -0.706212523130

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.8031
  </log>
  <optVariables href="FORM.s057.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2632e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2424e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.3998
    reference variance = 0.534107
====================================================
  Execution time = 4.5205e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 4.9716e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5122e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497278995742
                                         uncertainty =       0.007950126868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497278995742
                                         uncertainty =       0.007950126868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498576360
  error estimate for blocks of size 2^( 2) =       0.000525380455
  error estimate for blocks of size 2^( 3) =       0.000551225136
  error estimate for blocks of size 2^( 4) =       0.000571698171
  error estimate for blocks of size 2^( 5) =       0.000584903430
  error estimate for blocks of size 2^( 6) =       0.000591631634
  error estimate for blocks of size 2^( 7) =       0.000594128142

      target function =      -0.708999656764
              le_mean =     -22.425925841932
             les_mean =     503.419306391926
             stat err =       0.000585590344
             autocorr =       1.379508717717
   target nu stat err =       0.000585590344
   target dn stat err =       0.007974912106
      target stat err =       0.005803062323
              std dev =       0.705093449611
             le_variance =       0.497156772684


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242592584193e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+57, overlap shift 1.0000e+58 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709045611306       residual = 6.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709045611306       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709045611306       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.56e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 3.25e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+57 is 1.033531e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+57, overlap shift 4.0000e+58 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709045611306       residual = 6.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709045611306       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709045611306       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.56e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 3.25e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+57 is 2.583828e-62

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+58, overlap shift 1.6000e+59 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709045611306       residual = 6.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709045611306       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 2.56e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709045611306       residual = 6.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+58 is 4.599523e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.387486 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0335e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.3967
    reference variance = 0.333229
====================================================
  Execution time = 4.5617e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9006e-01
  Total weights = 2.0000e+06
  Execution time = 3.7979e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490135815536
                                         uncertainty =       0.002223084267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490135815536
                                         uncertainty =       0.002223084267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495002851
  error estimate for blocks of size 2^( 2) =       0.000522049721
  error estimate for blocks of size 2^( 3) =       0.000547718328
  error estimate for blocks of size 2^( 4) =       0.000567090788
  error estimate for blocks of size 2^( 5) =       0.000579564175
  error estimate for blocks of size 2^( 6) =       0.000586614744
  error estimate for blocks of size 2^( 7) =       0.000590902162

      target function =      -0.714205890536
              le_mean =     -22.427350035580
             les_mean =     503.476085017511
             stat err =       0.000581042967
             autocorr =       1.377847327450
   target nu stat err =       0.000581042967
   target dn stat err =       0.002504006768
      target stat err =       0.001937590353
              std dev =       0.700039744669
             le_variance =       0.490055644116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490135815536
                                         uncertainty =       0.002223084267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490135815536
                                         uncertainty =       0.002223084267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495002851
  error estimate for blocks of size 2^( 2) =       0.000522049721
  error estimate for blocks of size 2^( 3) =       0.000547718328
  error estimate for blocks of size 2^( 4) =       0.000567090788
  error estimate for blocks of size 2^( 5) =       0.000579564175
  error estimate for blocks of size 2^( 6) =       0.000586614744
  error estimate for blocks of size 2^( 7) =       0.000590902162

      target function =      -0.714205890536
              le_mean =     -22.427350035580
             les_mean =     503.476085017511
             stat err =       0.000581042967
             autocorr =       1.377847327450
   target nu stat err =       0.000581042967
   target dn stat err =       0.002504006768
      target stat err =       0.001937590353
              std dev =       0.700039744669
             le_variance =       0.490055644116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490135815536
                                         uncertainty =       0.002223084267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490135815536
                                         uncertainty =       0.002223084267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495002851
  error estimate for blocks of size 2^( 2) =       0.000522049721
  error estimate for blocks of size 2^( 3) =       0.000547718328
  error estimate for blocks of size 2^( 4) =       0.000567090788
  error estimate for blocks of size 2^( 5) =       0.000579564175
  error estimate for blocks of size 2^( 6) =       0.000586614744
  error estimate for blocks of size 2^( 7) =       0.000590902162

      target function =      -0.714205890536
              le_mean =     -22.427350035580
             les_mean =     503.476085017511
             stat err =       0.000581042967
             autocorr =       1.377847327450
   target nu stat err =       0.000581042967
   target dn stat err =       0.002504006768
      target stat err =       0.001937590353
              std dev =       0.700039744669
             le_variance =       0.490055644116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490135815536
                                         uncertainty =       0.002223084267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490135815536
                                         uncertainty =       0.002223084267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495002851
  error estimate for blocks of size 2^( 2) =       0.000522049721
  error estimate for blocks of size 2^( 3) =       0.000547718328
  error estimate for blocks of size 2^( 4) =       0.000567090788
  error estimate for blocks of size 2^( 5) =       0.000579564175
  error estimate for blocks of size 2^( 6) =       0.000586614744
  error estimate for blocks of size 2^( 7) =       0.000590902162

      target function =      -0.714205890536
              le_mean =     -22.427350035580
             les_mean =     503.476085017511
             stat err =       0.000581042967
             autocorr =       1.377847327450
   target nu stat err =       0.000581042967
   target dn stat err =       0.002504006768
      target stat err =       0.001937590353
              std dev =       0.700039744669
             le_variance =       0.490055644116


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.714205890536        initial  <--
     1.0000e+57     1.0000e+58             1.0335e-61        -0.714205890536
     4.0000e+57     4.0000e+58             2.5838e-62        -0.714205890536
     1.6000e+58     1.6000e+59             4.5995e-63        -0.714205890536

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.6630
  </log>
  <optVariables href="FORM.s058.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2500e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2424e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.3764
    reference variance = 0.381423
====================================================
  Execution time = 4.6921e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2428e+01
  VMC Evar = 4.9593e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5124e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495947242559
                                         uncertainty =       0.005160216089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495947242559
                                         uncertainty =       0.005160216089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497962512
  error estimate for blocks of size 2^( 2) =       0.000524630592
  error estimate for blocks of size 2^( 3) =       0.000549967475
  error estimate for blocks of size 2^( 4) =       0.000568857416
  error estimate for blocks of size 2^( 5) =       0.000581097956
  error estimate for blocks of size 2^( 6) =       0.000588737424
  error estimate for blocks of size 2^( 7) =       0.000595455119

      target function =      -0.709872621904
              le_mean =     -22.428444617209
             les_mean =     503.531061026839
             stat err =       0.000583536979
             autocorr =       1.373230579679
   target nu stat err =       0.000583536979
   target dn stat err =       0.005193613236
      target stat err =       0.003829017650
              std dev =       0.704225338643
             le_variance =       0.495933327588


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242844461721e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+58, overlap shift 1.0000e+59 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709891946684       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709891946684       residual = 9.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 2.55e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 1.87e+03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+58 is 4.611019e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 4.0000e+58, overlap shift 4.0000e+59 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709891946684       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709891946684       residual = 9.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 2.55e+02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+58 is 1.152755e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.6000e+59, overlap shift 1.6000e+60 and omega -2.3120e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709891946684       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709891946684       residual = 9.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 2.55e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 1.87e+03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.6000e+59 is 2.881887e-64

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.389025 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2053e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.3858
    reference variance = 0.360206
====================================================
  Execution time = 4.4309e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 4.9408e-01
  Total weights = 2.0000e+06
  Execution time = 3.8066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494043533450
                                         uncertainty =       0.003270377920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494043533450
                                         uncertainty =       0.003270377920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497032434
  error estimate for blocks of size 2^( 2) =       0.000523857902
  error estimate for blocks of size 2^( 3) =       0.000549538888
  error estimate for blocks of size 2^( 4) =       0.000568757882
  error estimate for blocks of size 2^( 5) =       0.000583203025
  error estimate for blocks of size 2^( 6) =       0.000591796359
  error estimate for blocks of size 2^( 7) =       0.000597114337

      target function =      -0.711250493637
              le_mean =     -22.427388917848
             les_mean =     503.481855907077
             stat err =       0.000585217901
             autocorr =       1.386327199560
   target nu stat err =       0.000585217901
   target dn stat err =       0.003343097355
      target stat err =       0.002512926991
              std dev =       0.702910009686
             le_variance =       0.494082481717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494043533450
                                         uncertainty =       0.003270377920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494043533450
                                         uncertainty =       0.003270377920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497032434
  error estimate for blocks of size 2^( 2) =       0.000523857902
  error estimate for blocks of size 2^( 3) =       0.000549538888
  error estimate for blocks of size 2^( 4) =       0.000568757882
  error estimate for blocks of size 2^( 5) =       0.000583203025
  error estimate for blocks of size 2^( 6) =       0.000591796359
  error estimate for blocks of size 2^( 7) =       0.000597114337

      target function =      -0.711250493637
              le_mean =     -22.427388917848
             les_mean =     503.481855907077
             stat err =       0.000585217901
             autocorr =       1.386327199560
   target nu stat err =       0.000585217901
   target dn stat err =       0.003343097355
      target stat err =       0.002512926991
              std dev =       0.702910009686
             le_variance =       0.494082481717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494043533450
                                         uncertainty =       0.003270377920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494043533450
                                         uncertainty =       0.003270377920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497032434
  error estimate for blocks of size 2^( 2) =       0.000523857902
  error estimate for blocks of size 2^( 3) =       0.000549538888
  error estimate for blocks of size 2^( 4) =       0.000568757882
  error estimate for blocks of size 2^( 5) =       0.000583203025
  error estimate for blocks of size 2^( 6) =       0.000591796359
  error estimate for blocks of size 2^( 7) =       0.000597114337

      target function =      -0.711250493637
              le_mean =     -22.427388917848
             les_mean =     503.481855907077
             stat err =       0.000585217901
             autocorr =       1.386327199560
   target nu stat err =       0.000585217901
   target dn stat err =       0.003343097355
      target stat err =       0.002512926991
              std dev =       0.702910009686
             le_variance =       0.494082481717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494043533450
                                         uncertainty =       0.003270377920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494043533450
                                         uncertainty =       0.003270377920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497032434
  error estimate for blocks of size 2^( 2) =       0.000523857902
  error estimate for blocks of size 2^( 3) =       0.000549538888
  error estimate for blocks of size 2^( 4) =       0.000568757882
  error estimate for blocks of size 2^( 5) =       0.000583203025
  error estimate for blocks of size 2^( 6) =       0.000591796359
  error estimate for blocks of size 2^( 7) =       0.000597114337

      target function =      -0.711250493637
              le_mean =     -22.427388917848
             les_mean =     503.481855907077
             stat err =       0.000585217901
             autocorr =       1.386327199560
   target nu stat err =       0.000585217901
   target dn stat err =       0.003343097355
      target stat err =       0.002512926991
              std dev =       0.702910009686
             le_variance =       0.494082481717


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.711250493637        initial  <--
     1.0000e+58     1.0000e+59             4.6110e-63        -0.711250493637
     4.0000e+58     4.0000e+59             1.1528e-63        -0.711250493637
     1.6000e+59     1.6000e+60             2.8819e-64        -0.711250493637

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.3686
  </log>
  <optVariables href="FORM.s059.opt.xml">
 uu_0                 2.552564e-01 1 1  ON 0
 uu_1                 9.297146e-02 1 1  ON 1
 uu_2                -7.920286e-03 1 1  ON 2
 uu_3                -6.923399e-02 1 1  ON 3
 uu_4                -1.052604e-01 1 1  ON 4
 uu_5                -1.267169e-01 1 1  ON 5
 uu_6                -1.374582e-01 1 1  ON 6
 uu_7                -1.336277e-01 1 1  ON 7
 uu_8                -1.132616e-01 1 1  ON 8
 uu_9                -6.856223e-02 1 1  ON 9
 ud_0                 3.731544e-01 1 1  ON 10
 ud_1                 1.324656e-01 1 1  ON 11
 ud_2                 1.338636e-02 1 1  ON 12
 ud_3                -4.969111e-02 1 1  ON 13
 ud_4                -8.583432e-02 1 1  ON 14
 ud_5                -1.074506e-01 1 1  ON 15
 ud_6                -1.175900e-01 1 1  ON 16
 ud_7                -1.128472e-01 1 1  ON 17
 ud_8                -9.300090e-02 1 1  ON 18
 ud_9                -5.426882e-02 1 1  ON 19
 eC_0                -4.979348e-01 1 1  ON 20
 eC_1                -3.532771e-01 1 1  ON 21
 eC_2                -1.036266e-01 1 1  ON 22
 eC_3                 6.840189e-02 1 1  ON 23
 eC_4                 1.507106e-01 1 1  ON 24
 eC_5                 2.326891e-01 1 1  ON 25
 eC_6                 2.311927e-01 1 1  ON 26
 eC_7                 1.913392e-01 1 1  ON 27
 eC_8                 7.350101e-02 1 1  ON 28
 eC_9                 5.800106e-03 1 1  ON 29
 eO_0                -8.991038e-01 1 1  ON 30
 eO_1                -5.913999e-01 1 1  ON 31
 eO_2                -1.810805e-01 1 1  ON 32
 eO_3                 8.172785e-02 1 1  ON 33
 eO_4                 2.361583e-01 1 1  ON 34
 eO_5                 3.379148e-01 1 1  ON 35
 eO_6                 3.342742e-01 1 1  ON 36
 eO_7                 2.985276e-01 1 1  ON 37
 eO_8                 2.076720e-01 1 1  ON 38
 eO_9                 1.093498e-01 1 1  ON 39
eH1_0                -1.333662e-01 1 1  ON 40
eH1_1                -3.149677e-02 1 1  ON 41
eH1_2                -1.524322e-02 1 1  ON 42
eH1_3                -2.543346e-02 1 1  ON 43
eH1_4                 3.820773e-03 1 1  ON 44
eH1_5                 1.895373e-02 1 1  ON 45
eH1_6                 3.983370e-02 1 1  ON 46
eH1_7                 4.319402e-02 1 1  ON 47
eH1_8                 3.913136e-02 1 1  ON 48
eH1_9                 4.724031e-02 1 1  ON 49
eH2_0                -1.451078e-01 1 1  ON 50
eH2_1                -4.404086e-02 1 1  ON 51
eH2_2                -2.577917e-02 1 1  ON 52
eH2_3                -3.487602e-02 1 1  ON 53
eH2_4                -6.873062e-03 1 1  ON 54
eH2_5                 8.664230e-03 1 1  ON 55
eH2_6                 3.559350e-02 1 1  ON 56
eH2_7                 4.803406e-02 1 1  ON 57
eH2_8                 6.894747e-02 1 1  ON 58
eH2_9                 6.265784e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2544e+02 secs
  Total Execution time = 7.6495e+03 secs

=========================================================
  A new xml input file : FORM.s059.cont.xml
