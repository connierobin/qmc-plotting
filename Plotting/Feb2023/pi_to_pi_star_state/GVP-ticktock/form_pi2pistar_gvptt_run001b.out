Rank =    0  Free Memory = 56643 MB
Rank =    1  Free Memory = 56642 MB
Rank =    2  Free Memory = 56642 MB
Rank =    3  Free Memory = 56642 MB
Rank =    4  Free Memory = 56642 MB
Rank =    5  Free Memory = 56642 MB
Rank =    6  Free Memory = 56642 MB
Rank =    7  Free Memory = 56642 MB
Rank =    8  Free Memory = 56642 MB
Rank =    9  Free Memory = 56642 MB
Rank =   10  Free Memory = 56642 MB
Rank =   11  Free Memory = 56642 MB
Rank =   12  Free Memory = 56641 MB
Rank =   13  Free Memory = 56641 MB
Rank =   14  Free Memory = 56640 MB
Rank =   15  Free Memory = 56627 MB
Rank =   16  Free Memory = 56627 MB
Rank =   17  Free Memory = 56627 MB
Rank =   18  Free Memory = 56627 MB
Rank =   19  Free Memory = 56627 MB
Rank =   20  Free Memory = 56627 MB
Rank =   21  Free Memory = 56626 MB
Rank =   22  Free Memory = 56626 MB
Rank =   23  Free Memory = 56626 MB
Rank =   24  Free Memory = 56626 MB
Rank =   25  Free Memory = 56626 MB
Rank =   26  Free Memory = 56626 MB
Rank =   27  Free Memory = 56626 MB
Rank =   28  Free Memory = 56626 MB
Rank =   29  Free Memory = 56626 MB
Rank =   30  Free Memory = 56626 MB
Rank =   31  Free Memory = 56626 MB
Rank =   32  Free Memory = 50841 MB
Rank =   33  Free Memory = 50841 MB
Rank =   34  Free Memory = 50841 MB
Rank =   35  Free Memory = 50841 MB
Rank =   36  Free Memory = 50841 MB
Rank =   37  Free Memory = 50841 MB
Rank =   38  Free Memory = 50841 MB
Rank =   39  Free Memory = 50841 MB
Rank =   40  Free Memory = 50841 MB
Rank =   41  Free Memory = 50841 MB
Rank =   42  Free Memory = 50841 MB
Rank =   43  Free Memory = 50841 MB
Rank =   44  Free Memory = 50841 MB
Rank =   45  Free Memory = 50841 MB
Rank =   46  Free Memory = 50841 MB
Rank =   47  Free Memory = 50841 MB
Rank =   48  Free Memory = 50841 MB
Rank =   49  Free Memory = 50841 MB
Rank =   50  Free Memory = 50841 MB
Rank =   51  Free Memory = 50841 MB
Rank =   52  Free Memory = 50841 MB
Rank =   53  Free Memory = 50841 MB
Rank =   54  Free Memory = 50841 MB
Rank =   55  Free Memory = 50841 MB
Rank =   56  Free Memory = 50841 MB
Rank =   57  Free Memory = 50841 MB
Rank =   58  Free Memory = 50841 MB
Rank =   59  Free Memory = 50841 MB
Rank =   60  Free Memory = 50841 MB
Rank =   61  Free Memory = 50841 MB
Rank =   62  Free Memory = 50841 MB
Rank =   63  Free Memory = 50841 MB
Rank =   64  Free Memory = 46017 MB
Rank =   65  Free Memory = 46017 MB
Rank =   66  Free Memory = 46017 MB
Rank =   67  Free Memory = 46017 MB
Rank =   68  Free Memory = 46017 MB
Rank =   69  Free Memory = 46017 MB
Rank =   70  Free Memory = 46017 MB
Rank =   71  Free Memory = 46017 MB
Rank =   72  Free Memory = 46017 MB
Rank =   73  Free Memory = 46017 MB
Rank =   74  Free Memory = 46017 MB
Rank =   75  Free Memory = 46017 MB
Rank =   76  Free Memory = 46017 MB
Rank =   77  Free Memory = 46017 MB
Rank =   78  Free Memory = 46017 MB
Rank =   79  Free Memory = 46017 MB
Rank =   80  Free Memory = 46017 MB
Rank =   81  Free Memory = 46017 MB
Rank =   82  Free Memory = 46017 MB
Rank =   83  Free Memory = 46017 MB
Rank =   84  Free Memory = 46017 MB
Rank =   85  Free Memory = 46017 MB
Rank =   86  Free Memory = 46017 MB
Rank =   87  Free Memory = 46017 MB
Rank =   88  Free Memory = 46017 MB
Rank =   89  Free Memory = 46017 MB
Rank =   90  Free Memory = 46017 MB
Rank =   91  Free Memory = 46017 MB
Rank =   92  Free Memory = 46017 MB
Rank =   93  Free Memory = 46017 MB
Rank =   94  Free Memory = 46017 MB
Rank =   95  Free Memory = 46017 MB
Rank =   96  Free Memory = 45648 MB
Rank =   97  Free Memory = 45648 MB
Rank =   98  Free Memory = 45648 MB
Rank =   99  Free Memory = 45648 MB
Rank =  100  Free Memory = 45648 MB
Rank =  101  Free Memory = 45648 MB
Rank =  102  Free Memory = 45648 MB
Rank =  103  Free Memory = 45648 MB
Rank =  104  Free Memory = 45648 MB
Rank =  105  Free Memory = 45648 MB
Rank =  106  Free Memory = 45648 MB
Rank =  107  Free Memory = 45648 MB
Rank =  108  Free Memory = 45648 MB
Rank =  109  Free Memory = 45648 MB
Rank =  110  Free Memory = 45648 MB
Rank =  111  Free Memory = 45648 MB
Rank =  112  Free Memory = 45648 MB
Rank =  113  Free Memory = 45648 MB
Rank =  114  Free Memory = 45648 MB
Rank =  115  Free Memory = 45648 MB
Rank =  116  Free Memory = 45648 MB
Rank =  117  Free Memory = 45648 MB
Rank =  118  Free Memory = 45648 MB
Rank =  119  Free Memory = 45648 MB
Rank =  120  Free Memory = 45648 MB
Rank =  121  Free Memory = 45647 MB
Rank =  122  Free Memory = 45647 MB
Rank =  123  Free Memory = 45647 MB
Rank =  124  Free Memory = 45647 MB
Rank =  125  Free Memory = 45647 MB
Rank =  126  Free Memory = 45647 MB
Rank =  127  Free Memory = 45647 MB
  Input file(s): opt_form_pi2pistar_gvptt_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 02b8462cd86e2c45b012131e3a811aee79855b67-dirty
  Last git commit date: Mon Oct 24 16:30:05 2022 -0700
  Last git commit subject: Merge commit 59872d0bcea460ceb08aa7832e89b700ee19b55f into gvp
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_pi2pistar_gvptt_run001b.xml

  Project = FORMN2GVP1B
  date    = 2023-02-09 15:54:11 PST
  host    = n0114.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 931

  Range of prime numbers to use as seeds over processors and threads = 7321-8513


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.678850e-01    1         1  ON     0
     uu_1                 9.644360e-02    1         1  ON     1
     uu_2                -1.282089e-02    1         1  ON     2
     uu_3                -7.353657e-02    1         1  ON     3
     uu_4                -1.033205e-01    1         1  ON     4
     uu_5                -1.144967e-01    1         1  ON     5
     uu_6                -1.105781e-01    1         1  ON     6
     uu_7                -8.744455e-02    1         1  ON     7
     uu_8                -4.467158e-02    1         1  ON     8
     uu_9                 2.596920e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.079908e-01    1         1  ON     0
     ud_1                 1.284668e-01    1         1  ON     1
     ud_2                -1.166832e-02    1         1  ON     2
     ud_3                -8.285832e-02    1         1  ON     3
     ud_4                -1.174315e-01    1         1  ON     4
     ud_5                -1.326474e-01    1         1  ON     5
     ud_6                -1.322881e-01    1         1  ON     6
     ud_7                -1.121357e-01    1         1  ON     7
     ud_8                -7.263715e-02    1         1  ON     8
     ud_9                -4.703866e-03    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -4.664293e-01    1         1  ON     0
     eC_1                -3.119153e-01    1         1  ON     1
     eC_2                -4.129773e-02    1         1  ON     2
     eC_3                 1.341255e-01    1         1  ON     3
     eC_4                 2.203046e-01    1         1  ON     4
     eC_5                 2.638651e-01    1         1  ON     5
     eC_6                 1.415910e-01    1         1  ON     6
     eC_7                 4.470979e-02    1         1  ON     7
     eC_8                 9.029056e-03    1         1  ON     8
     eC_9                 4.305461e-03    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -8.832305e-01    1         1  ON     0
     eO_1                -5.152137e-01    1         1  ON     1
     eO_2                -6.122212e-02    1         1  ON     2
     eO_3                 2.009974e-01    1         1  ON     3
     eO_4                 3.439155e-01    1         1  ON     4
     eO_5                 3.868928e-01    1         1  ON     5
     eO_6                 3.003024e-01    1         1  ON     6
     eO_7                 1.683948e-01    1         1  ON     7
     eO_8                 3.198564e-02    1         1  ON     8
     eO_9                 1.402030e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.275788e-01    1         1  ON     0
     eH1_1                -2.872167e-02    1         1  ON     1
     eH1_2                -8.734089e-03    1         1  ON     2
     eH1_3                -1.493973e-02    1         1  ON     3
     eH1_4                 1.409468e-02    1         1  ON     4
     eH1_5                 1.537302e-02    1         1  ON     5
     eH1_6                 2.920514e-02    1         1  ON     6
     eH1_7                 3.885224e-02    1         1  ON     7
     eH1_8                 5.112517e-02    1         1  ON     8
     eH1_9                 2.466700e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.271026e-01    1         1  ON     0
     eH2_1                -2.944926e-02    1         1  ON     1
     eH2_2                -8.263376e-03    1         1  ON     2
     eH2_3                -1.460496e-02    1         1  ON     3
     eH2_4                 1.493942e-02    1         1  ON     4
     eH2_5                 1.540644e-02    1         1  ON     5
     eH2_6                 2.807576e-02    1         1  ON     6
     eH2_7                 3.888256e-02    1         1  ON     7
     eH2_8                 5.020158e-02    1         1  ON     8
     eH2_9                 2.347092e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 140 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.302199e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 28 unique up determinants.
Found 28 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.1736e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  4.0107225728e-02 -5.0659535091e-01 -4.8356690577e-01
    u -2.0203417087e-01 -1.2691590666e+00 -2.1169263951e+00
    u  2.9913287695e-01 -2.3710879234e-01  2.0101719070e+00
    u  4.8474243406e-02 -5.3051852953e-01  9.5378285444e-01
    u -5.5511775119e-01 -9.8683271286e-02  1.4043240644e+00
    u  6.9646297924e-01  2.5004217823e+00 -2.4744046405e+00
    d -1.1004432466e+00 -7.1118992563e-01 -1.4300801983e+00
    d -3.6824818327e-02  7.5687344105e-01 -1.6708867165e+00
    d -9.4375526199e-01  1.5348935511e-01  1.1974289766e+00
    d -8.9321447322e-02 -6.9596903295e-02  1.4810785623e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 30
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.4544
    reference variance = 0.456498
====================================================
  Execution time = 4.6273e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2435e+01
  VMC Evar = 5.5012e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5137e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.550115613336
                                         uncertainty =       0.005905546325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.550115613336
                                         uncertainty =       0.005905546325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000524463211
  error estimate for blocks of size 2^( 2) =       0.000546586421
  error estimate for blocks of size 2^( 3) =       0.000568107158
  error estimate for blocks of size 2^( 4) =       0.000585060551
  error estimate for blocks of size 2^( 5) =       0.000595745974
  error estimate for blocks of size 2^( 6) =       0.000604166859
  error estimate for blocks of size 2^( 7) =       0.000610017772

      target function =                  N/A
              le_mean =     -22.434711419198
             les_mean =     503.866399507429
             stat err =       0.000598747789
             autocorr =       1.303340185154
              std dev =       0.741702986228
             le_variance =       0.550123319780


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.243471141920e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434711419198       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434777533184       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434801287372       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434814869782       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434839065683       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434845863708       residual = 9.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434863028527       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434875098437       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434885708675       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434891470456       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.434891399391       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.434890892393       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.434889633179       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.434889973807       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.434890154102       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.434890285633       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.434890550373       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 9.700805e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434711419198       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434736531171       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434743589572       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434750537254       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434759409302       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434761973769       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434765409574       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434767692349       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434769608621       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434770174125       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.434770074411       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.434769969624       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.434769943763       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.434769958298       residual = 8.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 2.714165e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434711419198       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434718633836       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434720515794       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434722693944       residual = 8.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434725214744       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434726088005       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434726777370       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434727301512       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434727693443       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434727684675       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.434727691356       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.434727671548       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.434727671335       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.434727680848       residual = 1.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 7.135401e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011099 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1426e+01
  </log>
  <optVariables href="FORMN2GVP1B.s000.opt.xml">
uu_0  2.678921e-01                 1 1 ON  0
uu_1  9.648374e-02                 1 1 ON  1
uu_2  -1.287689e-02                1 1 ON  2
uu_3  -7.374384e-02                1 1 ON  3
uu_4  -1.035732e-01                1 1 ON  4
uu_5  -1.146535e-01                1 1 ON  5
uu_6  -1.106471e-01                1 1 ON  6
uu_7  -8.744739e-02                1 1 ON  7
uu_8  -4.484178e-02                1 1 ON  8
uu_9  2.577737e-02                 1 1 ON  9
ud_0  4.091594e-01                 1 1 ON  10
ud_1  1.295233e-01                 1 1 ON  11
ud_2  -1.150602e-02                1 1 ON  12
ud_3  -8.316604e-02                1 1 ON  13
ud_4  -1.179255e-01                1 1 ON  14
ud_5  -1.331562e-01                1 1 ON  15
ud_6  -1.327883e-01                1 1 ON  16
ud_7  -1.126747e-01                1 1 ON  17
ud_8  -7.310643e-02                1 1 ON  18
ud_9  -5.034319e-03                1 1 ON  19
eC_0  -4.680964e-01                1 1 ON  20
eC_1  -3.130165e-01                1 1 ON  21
eC_2  -4.145515e-02                1 1 ON  22
eC_3  1.342950e-01                 1 1 ON  23
eC_4  2.210469e-01                 1 1 ON  24
eC_5  2.642327e-01                 1 1 ON  25
eC_6  1.424793e-01                 1 1 ON  26
eC_7  4.531752e-02                 1 1 ON  27
eC_8  9.154617e-03                 1 1 ON  28
eC_9  4.325375e-03                 1 1 ON  29
eO_0  -8.859447e-01                1 1 ON  30
eO_1  -5.165043e-01                1 1 ON  31
eO_2  -6.220079e-02                1 1 ON  32
eO_3  2.009027e-01                 1 1 ON  33
eO_4  3.446446e-01                 1 1 ON  34
eO_5  3.877955e-01                 1 1 ON  35
eO_6  3.013024e-01                 1 1 ON  36
eO_7  1.698360e-01                 1 1 ON  37
eO_8  3.271362e-02                 1 1 ON  38
eO_9  1.422049e-02                 1 1 ON  39
eH1_0 -1.278404e-01                1 1 ON  40
eH1_1 -2.889911e-02                1 1 ON  41
eH1_2 -9.004418e-03                1 1 ON  42
eH1_3 -1.473063e-02                1 1 ON  43
eH1_4 1.405702e-02                 1 1 ON  44
eH1_5 1.515239e-02                 1 1 ON  45
eH1_6 2.968856e-02                 1 1 ON  46
eH1_7 3.875734e-02                 1 1 ON  47
eH1_8 5.120884e-02                 1 1 ON  48
eH1_9 2.487704e-02                 1 1 ON  49
eH2_0 -1.272589e-01                1 1 ON  50
eH2_1 -2.952997e-02                1 1 ON  51
eH2_2 -8.761571e-03                1 1 ON  52
eH2_3 -1.439472e-02                1 1 ON  53
eH2_4 1.479001e-02                 1 1 ON  54
eH2_5 1.533684e-02                 1 1 ON  55
eH2_6 2.857525e-02                 1 1 ON  56
eH2_7 3.865281e-02                 1 1 ON  57
eH2_8 5.034333e-02                 1 1 ON  58
eH2_9 2.374209e-02                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.3121
    reference variance = 0.853121
====================================================
  Execution time = 4.4902e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2434e+01
  VMC Evar = 5.4178e-01
  Total weights = 2.0000e+06
  Execution time = 3.8649e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.540377744605
                                         uncertainty =       0.004172855915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.540377744605
                                         uncertainty =       0.004172855915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000519748642
  error estimate for blocks of size 2^( 2) =       0.000542134909
  error estimate for blocks of size 2^( 3) =       0.000563547991
  error estimate for blocks of size 2^( 4) =       0.000580870078
  error estimate for blocks of size 2^( 5) =       0.000593085215
  error estimate for blocks of size 2^( 6) =       0.000598997246
  error estimate for blocks of size 2^( 7) =       0.000601000423

      target function =                  N/A
              le_mean =     -22.433851298456
             les_mean =     503.817961112486
             stat err =       0.000593488240
             autocorr =       1.303879658070
              std dev =       0.735035578328
             le_variance =       0.540277301408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.545027327041
                                         uncertainty =       0.004197988962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.545027327041
                                         uncertainty =       0.004197988962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000521979140
  error estimate for blocks of size 2^( 2) =       0.000544141120
  error estimate for blocks of size 2^( 3) =       0.000565234923
  error estimate for blocks of size 2^( 4) =       0.000582288402
  error estimate for blocks of size 2^( 5) =       0.000594349803
  error estimate for blocks of size 2^( 6) =       0.000600189713
  error estimate for blocks of size 2^( 7) =       0.000602098824

      target function =                  N/A
              le_mean =     -22.433870016416
             les_mean =     503.823448085664
             stat err =       0.000594731685
             autocorr =       1.298182825395
              std dev =       0.738189978723
             le_variance =       0.544924444686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543446944864
                                         uncertainty =       0.004184166000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543446944864
                                         uncertainty =       0.004184166000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000521222161
  error estimate for blocks of size 2^( 2) =       0.000543460403
  error estimate for blocks of size 2^( 3) =       0.000564661127
  error estimate for blocks of size 2^( 4) =       0.000581810567
  error estimate for blocks of size 2^( 5) =       0.000593929328
  error estimate for blocks of size 2^( 6) =       0.000599799452
  error estimate for blocks of size 2^( 7) =       0.000601738306

      target function =                  N/A
              le_mean =     -22.433855239026
             les_mean =     503.821205695185
             stat err =       0.000594319413
             autocorr =       1.300151882061
              std dev =       0.737119448443
             le_variance =       0.543345081273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.540782907050
                                         uncertainty =       0.004173900325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.540782907050
                                         uncertainty =       0.004173900325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000519943404
  error estimate for blocks of size 2^( 2) =       0.000542308275
  error estimate for blocks of size 2^( 3) =       0.000563690934
  error estimate for blocks of size 2^( 4) =       0.000580988728
  error estimate for blocks of size 2^( 5) =       0.000593190448
  error estimate for blocks of size 2^( 6) =       0.000599097003
  error estimate for blocks of size 2^( 7) =       0.000601091195

      target function =                  N/A
              le_mean =     -22.433848757650
             les_mean =     503.818252097023
             stat err =       0.000593591843
             autocorr =       1.303357944683
              std dev =       0.735311013273
             le_variance =       0.540682286241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.433851298456        initial
     2.5000e-01     2.5000e+00             9.7008e-03       -22.433870016416  <--
     1.0000e+00     1.0000e+01             2.7142e-03       -22.433855239026
     4.0000e+00     4.0000e+01             7.1354e-04       -22.433848757650

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.4222e+01
  </log>
  <optVariables href="FORMN2GVP1B.s000.opt.xml">
 uu_0                 2.681888e-01 1 1  ON 0
 uu_1                 9.663386e-02 1 1  ON 1
 uu_2                -1.303621e-02 1 1  ON 2
 uu_3                -7.425390e-02 1 1  ON 3
 uu_4                -1.042871e-01 1 1  ON 4
 uu_5                -1.153048e-01 1 1  ON 5
 uu_6                -1.111346e-01 1 1  ON 6
 uu_7                -8.770711e-02 1 1  ON 7
 uu_8                -4.533808e-02 1 1  ON 8
 uu_9                 2.522357e-02 1 1  ON 9
 ud_0                 4.119361e-01 1 1  ON 10
 ud_1                 1.316797e-01 1 1  ON 11
 ud_2                -1.071076e-02 1 1  ON 12
 ud_3                -8.352647e-02 1 1  ON 13
 ud_4                -1.189299e-01 1 1  ON 14
 ud_5                -1.344698e-01 1 1  ON 15
 ud_6                -1.342309e-01 1 1  ON 16
 ud_7                -1.142546e-01 1 1  ON 17
 ud_8                -7.453014e-02 1 1  ON 18
 ud_9                -6.061412e-03 1 1  ON 19
 eC_0                -4.726461e-01 1 1  ON 20
 eC_1                -3.162346e-01 1 1  ON 21
 eC_2                -4.253766e-02 1 1  ON 22
 eC_3                 1.347434e-01 1 1  ON 23
 eC_4                 2.226752e-01 1 1  ON 24
 eC_5                 2.657303e-01 1 1  ON 25
 eC_6                 1.453300e-01 1 1  ON 26
 eC_7                 4.725468e-02 1 1  ON 27
 eC_8                 9.562816e-03 1 1  ON 28
 eC_9                 4.389824e-03 1 1  ON 29
 eO_0                -8.929313e-01 1 1  ON 30
 eO_1                -5.208679e-01 1 1  ON 31
 eO_2                -6.531479e-02 1 1  ON 32
 eO_3                 1.999952e-01 1 1  ON 33
 eO_4                 3.460946e-01 1 1  ON 34
 eO_5                 3.904535e-01 1 1  ON 35
 eO_6                 3.046648e-01 1 1  ON 36
 eO_7                 1.744665e-01 1 1  ON 37
 eO_8                 3.508164e-02 1 1  ON 38
 eO_9                 1.487614e-02 1 1  ON 39
eH1_0                -1.285777e-01 1 1  ON 40
eH1_1                -2.943880e-02 1 1  ON 41
eH1_2                -9.591896e-03 1 1  ON 42
eH1_3                -1.464646e-02 1 1  ON 43
eH1_4                 1.401231e-02 1 1  ON 44
eH1_5                 1.484346e-02 1 1  ON 45
eH1_6                 3.080009e-02 1 1  ON 46
eH1_7                 3.863046e-02 1 1  ON 47
eH1_8                 5.144765e-02 1 1  ON 48
eH1_9                 2.554171e-02 1 1  ON 49
eH2_0                -1.277395e-01 1 1  ON 50
eH2_1                -2.989346e-02 1 1  ON 51
eH2_2                -9.797768e-03 1 1  ON 52
eH2_3                -1.437297e-02 1 1  ON 53
eH2_4                 1.457166e-02 1 1  ON 54
eH2_5                 1.524249e-02 1 1  ON 55
eH2_6                 2.976840e-02 1 1  ON 56
eH2_7                 3.816826e-02 1 1  ON 57
eH2_8                 5.075295e-02 1 1  ON 58
eH2_9                 2.459698e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2565e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2383e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.5993
    reference variance = 1.59825
====================================================
  Execution time = 4.5674e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2435e+01
  VMC Evar = 5.5823e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5455e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558266039928
                                         uncertainty =       0.005915834176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558266039928
                                         uncertainty =       0.005915834176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528312152
  error estimate for blocks of size 2^( 2) =       0.000550597305
  error estimate for blocks of size 2^( 3) =       0.000571669941
  error estimate for blocks of size 2^( 4) =       0.000588446419
  error estimate for blocks of size 2^( 5) =       0.000598643700
  error estimate for blocks of size 2^( 6) =       0.000604612569
  error estimate for blocks of size 2^( 7) =       0.000607774618

      target function =                  N/A
              le_mean =     -22.434507191281
             les_mean =     503.865340096728
             stat err =       0.000599869327
             autocorr =       1.289235068552
              std dev =       0.747146210728
             le_variance =       0.558227460205


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243450719128e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434507191281       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434518019923       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434553761000       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434566431898       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434608173992       residual = 9.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434666009708       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434727037035       residual = 8.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434766645964       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434768511103       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434776185764       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.434787553103       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.434793090911       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.434798306921       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.434800060312       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.434802017258       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.434798194752       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.434798619101       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.434798099180       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.434798878170       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.434799588067       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.434800042532       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.434799877109       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 3.104785e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434507191281       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434513427193       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434527738471       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434540749891       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434554733243       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434585880495       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434605911177       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434606782373       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434604944875       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434603936100       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.434604550536       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.434605626293       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.434606086810       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.434606221205       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.434605802213       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.434605704145       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.434605563101       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 8.197749e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434507191281       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434509503863       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434513736000       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434519698408       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434522506026       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434532434513       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434537477459       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434536539075       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434536192697       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434535963555       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.434535809960       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.434535926407       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.434535974776       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.434536006228       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 2.201457e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.023500 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1145e+01
  </log>
  <optVariables href="FORMN2GVP1B.s001.opt.xml">
 uu_0                 2.685097e-01 1 1  ON 0
 uu_1                 9.702077e-02 1 1  ON 1
 uu_2                -1.327534e-02 1 1  ON 2
 uu_3                -7.496076e-02 1 1  ON 3
 uu_4                -1.050219e-01 1 1  ON 4
 uu_5                -1.163087e-01 1 1  ON 5
 uu_6                -1.119677e-01 1 1  ON 6
 uu_7                -8.866550e-02 1 1  ON 7
 uu_8                -4.629355e-02 1 1  ON 8
 uu_9                 2.489389e-02 1 1  ON 9
 ud_0                 4.150127e-01 1 1  ON 10
 ud_1                 1.339427e-01 1 1  ON 11
 ud_2                -9.745553e-03 1 1  ON 12
 ud_3                -8.366358e-02 1 1  ON 13
 ud_4                -1.198171e-01 1 1  ON 14
 ud_5                -1.359106e-01 1 1  ON 15
 ud_6                -1.359675e-01 1 1  ON 16
 ud_7                -1.165015e-01 1 1  ON 17
 ud_8                -7.631669e-02 1 1  ON 18
 ud_9                -7.321853e-03 1 1  ON 19
 eC_0                -4.783313e-01 1 1  ON 20
 eC_1                -3.201531e-01 1 1  ON 21
 eC_2                -4.370412e-02 1 1  ON 22
 eC_3                 1.348373e-01 1 1  ON 23
 eC_4                 2.240009e-01 1 1  ON 24
 eC_5                 2.681803e-01 1 1  ON 25
 eC_6                 1.492750e-01 1 1  ON 26
 eC_7                 4.958393e-02 1 1  ON 27
 eC_8                 1.011364e-02 1 1  ON 28
 eC_9                 4.463541e-03 1 1  ON 29
 eO_0                -9.011291e-01 1 1  ON 30
 eO_1                -5.266813e-01 1 1  ON 31
 eO_2                -6.900939e-02 1 1  ON 32
 eO_3                 1.990010e-01 1 1  ON 33
 eO_4                 3.471186e-01 1 1  ON 34
 eO_5                 3.935799e-01 1 1  ON 35
 eO_6                 3.092209e-01 1 1  ON 36
 eO_7                 1.800609e-01 1 1  ON 37
 eO_8                 3.818207e-02 1 1  ON 38
 eO_9                 1.580333e-02 1 1  ON 39
eH1_0                -1.291866e-01 1 1  ON 40
eH1_1                -3.012478e-02 1 1  ON 41
eH1_2                -1.066148e-02 1 1  ON 42
eH1_3                -1.475387e-02 1 1  ON 43
eH1_4                 1.385884e-02 1 1  ON 44
eH1_5                 1.504786e-02 1 1  ON 45
eH1_6                 3.180976e-02 1 1  ON 46
eH1_7                 3.852209e-02 1 1  ON 47
eH1_8                 5.178979e-02 1 1  ON 48
eH1_9                 2.641644e-02 1 1  ON 49
eH2_0                -1.284915e-01 1 1  ON 50
eH2_1                -3.017741e-02 1 1  ON 51
eH2_2                -1.112462e-02 1 1  ON 52
eH2_3                -1.462092e-02 1 1  ON 53
eH2_4                 1.396094e-02 1 1  ON 54
eH2_5                 1.496656e-02 1 1  ON 55
eH2_6                 3.157530e-02 1 1  ON 56
eH2_7                 3.840111e-02 1 1  ON 57
eH2_8                 5.117579e-02 1 1  ON 58
eH2_9                 2.535166e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.4223
    reference variance = 0.454191
====================================================
  Execution time = 4.6227e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2434e+01
  VMC Evar = 5.4818e-01
  Total weights = 2.0000e+06
  Execution time = 3.8696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.544646351455
                                         uncertainty =       0.003441284933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.544646351455
                                         uncertainty =       0.003441284933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000521888696
  error estimate for blocks of size 2^( 2) =       0.000544120982
  error estimate for blocks of size 2^( 3) =       0.000564762869
  error estimate for blocks of size 2^( 4) =       0.000581219929
  error estimate for blocks of size 2^( 5) =       0.000592008017
  error estimate for blocks of size 2^( 6) =       0.000598977863
  error estimate for blocks of size 2^( 7) =       0.000601037037

      target function =                  N/A
              le_mean =     -22.433646031229
             les_mean =     503.813209604437
             stat err =       0.000593310711
             autocorr =       1.292434663243
              std dev =       0.738062072148
             le_variance =       0.544735622344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553128530419
                                         uncertainty =       0.003497143479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553128530419
                                         uncertainty =       0.003497143479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000525936508
  error estimate for blocks of size 2^( 2) =       0.000547751339
  error estimate for blocks of size 2^( 3) =       0.000567813806
  error estimate for blocks of size 2^( 4) =       0.000583733085
  error estimate for blocks of size 2^( 5) =       0.000594204233
  error estimate for blocks of size 2^( 6) =       0.000600978504
  error estimate for blocks of size 2^( 7) =       0.000603031594

      target function =                  N/A
              le_mean =     -22.433666543270
             les_mean =     503.822612719037
             stat err =       0.000595486854
             autocorr =       1.281969579954
              std dev =       0.743786542632
             le_variance =       0.553218421001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.551697645732
                                         uncertainty =       0.003484136135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.551697645732
                                         uncertainty =       0.003484136135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000525255722
  error estimate for blocks of size 2^( 2) =       0.000547194383
  error estimate for blocks of size 2^( 3) =       0.000567436979
  error estimate for blocks of size 2^( 4) =       0.000583531226
  error estimate for blocks of size 2^( 5) =       0.000594116209
  error estimate for blocks of size 2^( 6) =       0.000600947812
  error estimate for blocks of size 2^( 7) =       0.000603001129

      target function =                  N/A
              le_mean =     -22.433636874992
             les_mean =     503.819850310991
             stat err =       0.000595399094
             autocorr =       1.284916049038
              std dev =       0.742823766358
             le_variance =       0.551787147866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.545820289019
                                         uncertainty =       0.003448292305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.545820289019
                                         uncertainty =       0.003448292305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000522450758
  error estimate for blocks of size 2^( 2) =       0.000544631977
  error estimate for blocks of size 2^( 3) =       0.000565207311
  error estimate for blocks of size 2^( 4) =       0.000581605646
  error estimate for blocks of size 2^( 5) =       0.000592362354
  error estimate for blocks of size 2^( 6) =       0.000599308961
  error estimate for blocks of size 2^( 7) =       0.000601366307

      target function =                  N/A
              le_mean =     -22.433634224437
             les_mean =     503.813853832943
             stat err =       0.000593660817
             autocorr =       1.291177777344
              std dev =       0.738856948297
             le_variance =       0.545909590047


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.433646031229        initial
     6.2500e-02     6.2500e-01             3.1048e-02       -22.433666543270  <--
     2.5000e-01     2.5000e+00             8.1977e-03       -22.433636874992
     1.0000e+00     1.0000e+01             2.2015e-03       -22.433634224437

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 6.5640e+01
  </log>
  <optVariables href="FORMN2GVP1B.s001.opt.xml">
 uu_0                 2.699067e-01 1 1  ON 0
 uu_1                 9.798531e-02 1 1  ON 1
 uu_2                -1.340743e-02 1 1  ON 2
 uu_3                -7.623987e-02 1 1  ON 3
 uu_4                -1.072578e-01 1 1  ON 4
 uu_5                -1.194949e-01 1 1  ON 5
 uu_6                -1.158471e-01 1 1  ON 6
 uu_7                -9.304018e-02 1 1  ON 7
 uu_8                -5.064999e-02 1 1  ON 8
 uu_9                 2.307253e-02 1 1  ON 9
 ud_0                 4.209821e-01 1 1  ON 10
 ud_1                 1.387981e-01 1 1  ON 11
 ud_2                -6.665431e-03 1 1  ON 12
 ud_3                -8.272537e-02 1 1  ON 13
 ud_4                -1.209298e-01 1 1  ON 14
 ud_5                -1.389190e-01 1 1  ON 15
 ud_6                -1.406550e-01 1 1  ON 16
 ud_7                -1.228586e-01 1 1  ON 17
 ud_8                -8.269635e-02 1 1  ON 18
 ud_9                -1.221961e-02 1 1  ON 19
 eC_0                -4.938437e-01 1 1  ON 20
 eC_1                -3.319338e-01 1 1  ON 21
 eC_2                -5.053356e-02 1 1  ON 22
 eC_3                 1.329419e-01 1 1  ON 23
 eC_4                 2.261526e-01 1 1  ON 24
 eC_5                 2.759309e-01 1 1  ON 25
 eC_6                 1.637568e-01 1 1  ON 26
 eC_7                 5.873762e-02 1 1  ON 27
 eC_8                 1.231441e-02 1 1  ON 28
 eC_9                 4.739086e-03 1 1  ON 29
 eO_0                -9.239792e-01 1 1  ON 30
 eO_1                -5.456010e-01 1 1  ON 31
 eO_2                -8.277272e-02 1 1  ON 32
 eO_3                 1.921974e-01 1 1  ON 33
 eO_4                 3.476719e-01 1 1  ON 34
 eO_5                 4.021093e-01 1 1  ON 35
 eO_6                 3.248123e-01 1 1  ON 36
 eO_7                 2.005100e-01 1 1  ON 37
 eO_8                 5.030453e-02 1 1  ON 38
 eO_9                 1.948807e-02 1 1  ON 39
eH1_0                -1.314731e-01 1 1  ON 40
eH1_1                -3.246497e-02 1 1  ON 41
eH1_2                -1.310838e-02 1 1  ON 42
eH1_3                -1.605866e-02 1 1  ON 43
eH1_4                 1.348794e-02 1 1  ON 44
eH1_5                 1.564466e-02 1 1  ON 45
eH1_6                 3.434290e-02 1 1  ON 46
eH1_7                 3.851239e-02 1 1  ON 47
eH1_8                 5.292505e-02 1 1  ON 48
eH1_9                 2.973910e-02 1 1  ON 49
eH2_0                -1.309411e-01 1 1  ON 50
eH2_1                -3.212849e-02 1 1  ON 51
eH2_2                -1.396957e-02 1 1  ON 52
eH2_3                -1.634023e-02 1 1  ON 53
eH2_4                 1.291255e-02 1 1  ON 54
eH2_5                 1.493764e-02 1 1  ON 55
eH2_6                 3.505851e-02 1 1  ON 56
eH2_7                 3.941575e-02 1 1  ON 57
eH2_8                 5.271804e-02 1 1  ON 58
eH2_9                 2.826923e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2679e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2447e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.4659
    reference variance = 0.443468
====================================================
  Execution time = 4.5777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2435e+01
  VMC Evar = 5.8301e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5374e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.583135175468
                                         uncertainty =       0.030402028293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.583135175468
                                         uncertainty =       0.030402028293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539912940
  error estimate for blocks of size 2^( 2) =       0.000560537409
  error estimate for blocks of size 2^( 3) =       0.000580955895
  error estimate for blocks of size 2^( 4) =       0.000596738919
  error estimate for blocks of size 2^( 5) =       0.000605668039
  error estimate for blocks of size 2^( 6) =       0.000609738122
  error estimate for blocks of size 2^( 7) =       0.000612034044

      target function =                  N/A
              le_mean =     -22.434512584643
             les_mean =     503.890366583672
             stat err =       0.000606044781
             autocorr =       1.259975091146
              std dev =       0.763552201677
             le_variance =       0.583011964686


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243451258464e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434512584643       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434525035335       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434532323540       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434566613339       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434647513580       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434674558597       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434721346073       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434839007384       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434880153047       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434933804033       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.434978095988       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.435005194815       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.435023887906       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.435033253952       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.435032749600       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.435037311391       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.435049584942       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.435055301023       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.435055005295       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.435055514825       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.435059290248       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.435058342904       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.435062119412       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.435061991782       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.435063170615       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.435063763225       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.435063840093       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.435062938032       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-02 is 1.536983e-01

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434512584643       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434522507749       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434526644245       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434554352539       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434581708800       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434611997203       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434623792581       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434656123163       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434668628283       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434679857662       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.434686716381       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.434690120807       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.434691520817       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.434690273143       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.434689936560       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.434690977833       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.434691671500       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.434691589698       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.434691408158       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.434691379969       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 2.266393e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434512584643       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434518060871       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434518980888       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434526401033       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434537944607       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434550253524       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434553943131       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434558042173       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434559675864       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434561390385       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.434561964989       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.434562251496       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.434561923869       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.434561689837       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.434561939215       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 5.130527e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.041692 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1173e+01
  </log>
  <optVariables href="FORMN2GVP1B.s002.opt.xml">
 uu_0                 2.727793e-01 1 1  ON 0
 uu_1                 9.916689e-02 1 1  ON 1
 uu_2                -1.278921e-02 1 1  ON 2
 uu_3                -7.638409e-02 1 1  ON 3
 uu_4                -1.084715e-01 1 1  ON 4
 uu_5                -1.216456e-01 1 1  ON 5
 uu_6                -1.197124e-01 1 1  ON 6
 uu_7                -9.763928e-02 1 1  ON 7
 uu_8                -5.739617e-02 1 1  ON 8
 uu_9                 1.852255e-02 1 1  ON 9
 ud_0                 4.248853e-01 1 1  ON 10
 ud_1                 1.424331e-01 1 1  ON 11
 ud_2                -3.533152e-03 1 1  ON 12
 ud_3                -8.085200e-02 1 1  ON 13
 ud_4                -1.205519e-01 1 1  ON 14
 ud_5                -1.406873e-01 1 1  ON 15
 ud_6                -1.446933e-01 1 1  ON 16
 ud_7                -1.294993e-01 1 1  ON 17
 ud_8                -9.020685e-02 1 1  ON 18
 ud_9                -1.883702e-02 1 1  ON 19
 eC_0                -5.075520e-01 1 1  ON 20
 eC_1                -3.437171e-01 1 1  ON 21
 eC_2                -5.963491e-02 1 1  ON 22
 eC_3                 1.286623e-01 1 1  ON 23
 eC_4                 2.267941e-01 1 1  ON 24
 eC_5                 2.836287e-01 1 1  ON 25
 eC_6                 1.801049e-01 1 1  ON 26
 eC_7                 6.971730e-02 1 1  ON 27
 eC_8                 1.496800e-02 1 1  ON 28
 eC_9                 5.182550e-03 1 1  ON 29
 eO_0                -9.451064e-01 1 1  ON 30
 eO_1                -5.651089e-01 1 1  ON 31
 eO_2                -9.808217e-02 1 1  ON 32
 eO_3                 1.827415e-01 1 1  ON 33
 eO_4                 3.466918e-01 1 1  ON 34
 eO_5                 4.090156e-01 1 1  ON 35
 eO_6                 3.414059e-01 1 1  ON 36
 eO_7                 2.231739e-01 1 1  ON 37
 eO_8                 6.474791e-02 1 1  ON 38
 eO_9                 2.375015e-02 1 1  ON 39
eH1_0                -1.343436e-01 1 1  ON 40
eH1_1                -3.556076e-02 1 1  ON 41
eH1_2                -1.546871e-02 1 1  ON 42
eH1_3                -1.777592e-02 1 1  ON 43
eH1_4                 1.251758e-02 1 1  ON 44
eH1_5                 1.614830e-02 1 1  ON 45
eH1_6                 3.665443e-02 1 1  ON 46
eH1_7                 3.963938e-02 1 1  ON 47
eH1_8                 5.489621e-02 1 1  ON 48
eH1_9                 3.365624e-02 1 1  ON 49
eH2_0                -1.342112e-01 1 1  ON 50
eH2_1                -3.485768e-02 1 1  ON 51
eH2_2                -1.430844e-02 1 1  ON 52
eH2_3                -1.763208e-02 1 1  ON 53
eH2_4                 1.232362e-02 1 1  ON 54
eH2_5                 1.559369e-02 1 1  ON 55
eH2_6                 3.471340e-02 1 1  ON 56
eH2_7                 3.860409e-02 1 1  ON 57
eH2_8                 5.497352e-02 1 1  ON 58
eH2_9                 3.289380e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.5202
    reference variance = 0.994371
====================================================
  Execution time = 4.5206e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5475e-01
  Total weights = 2.0000e+06
  Execution time = 3.8559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.552866298338
                                         uncertainty =       0.005345411529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.552866298338
                                         uncertainty =       0.005345411529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000525943296
  error estimate for blocks of size 2^( 2) =       0.000547358363
  error estimate for blocks of size 2^( 3) =       0.000567325639
  error estimate for blocks of size 2^( 4) =       0.000582644955
  error estimate for blocks of size 2^( 5) =       0.000593100965
  error estimate for blocks of size 2^( 6) =       0.000597721377
  error estimate for blocks of size 2^( 7) =       0.000602180523

      target function =                  N/A
              le_mean =     -22.436736527636
             les_mean =     503.960378436123
             stat err =       0.000593911955
             autocorr =       1.275164714038
              std dev =       0.743796142880
             le_variance =       0.553232702163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563163099969
                                         uncertainty =       0.005398579834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563163099969
                                         uncertainty =       0.005398579834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530819059
  error estimate for blocks of size 2^( 2) =       0.000551488102
  error estimate for blocks of size 2^( 3) =       0.000570339314
  error estimate for blocks of size 2^( 4) =       0.000584548567
  error estimate for blocks of size 2^( 5) =       0.000594313322
  error estimate for blocks of size 2^( 6) =       0.000598406598
  error estimate for blocks of size 2^( 7) =       0.000602801831

      target function =                  N/A
              le_mean =     -22.437341808519
             les_mean =     503.997844898308
             stat err =       0.000595017579
             autocorr =       1.256511817142
              std dev =       0.750691513042
             le_variance =       0.563537747753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556145692677
                                         uncertainty =       0.005366937336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556145692677
                                         uncertainty =       0.005366937336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527501977
  error estimate for blocks of size 2^( 2) =       0.000548609171
  error estimate for blocks of size 2^( 3) =       0.000568144648
  error estimate for blocks of size 2^( 4) =       0.000583070640
  error estimate for blocks of size 2^( 5) =       0.000593306825
  error estimate for blocks of size 2^( 6) =       0.000597741623
  error estimate for blocks of size 2^( 7) =       0.000602195824

      target function =                  N/A
              le_mean =     -22.436729717742
             les_mean =     503.963356819822
             stat err =       0.000594078728
             autocorr =       1.268352067707
              std dev =       0.746000449778
             le_variance =       0.556516671069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553240638990
                                         uncertainty =       0.005349647178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553240638990
                                         uncertainty =       0.005349647178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526121784
  error estimate for blocks of size 2^( 2) =       0.000547494642
  error estimate for blocks of size 2^( 3) =       0.000567405141
  error estimate for blocks of size 2^( 4) =       0.000582676747
  error estimate for blocks of size 2^( 5) =       0.000593107152
  error estimate for blocks of size 2^( 6) =       0.000597703100
  error estimate for blocks of size 2^( 7) =       0.000602166272

      target function =                  N/A
              le_mean =     -22.436718060845
             les_mean =     503.959925327596
             stat err =       0.000593913318
             autocorr =       1.274305507575
              std dev =       0.744048561964
             le_variance =       0.553608262560


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436736527636        initial
     1.5625e-02     1.5625e-01             1.5370e-01       -22.437341808519  <--
     6.2500e-02     6.2500e-01             2.2664e-02       -22.436729717742
     2.5000e-01     2.5000e+00             5.1305e-03       -22.436718060845

*****************************************************************************
Applying the update for shift_i =   1.5625e-02     and shift_s =   1.5625e-01
*****************************************************************************

  Execution time = 6.4595e+01
  </log>
  <optVariables href="FORMN2GVP1B.s002.opt.xml">
 uu_0                 2.826930e-01 1 1  ON 0
 uu_1                 1.055133e-01 1 1  ON 1
 uu_2                -9.212669e-03 1 1  ON 2
 uu_3                -7.699098e-02 1 1  ON 3
 uu_4                -1.148623e-01 1 1  ON 4
 uu_5                -1.346419e-01 1 1  ON 5
 uu_6                -1.412758e-01 1 1  ON 6
 uu_7                -1.281034e-01 1 1  ON 7
 uu_8                -9.636410e-02 1 1  ON 8
 uu_9                -1.776312e-02 1 1  ON 9
 ud_0                 4.418181e-01 1 1  ON 10
 ud_1                 1.580913e-01 1 1  ON 11
 ud_2                 9.361313e-03 1 1  ON 12
 ud_3                -7.311087e-02 1 1  ON 13
 ud_4                -1.198303e-01 1 1  ON 14
 ud_5                -1.490343e-01 1 1  ON 15
 ud_6                -1.635942e-01 1 1  ON 16
 ud_7                -1.612153e-01 1 1  ON 17
 ud_8                -1.316166e-01 1 1  ON 18
 ud_9                -6.150964e-02 1 1  ON 19
 eC_0                -5.795425e-01 1 1  ON 20
 eC_1                -4.082306e-01 1 1  ON 21
 eC_2                -1.127081e-01 1 1  ON 22
 eC_3                 9.514893e-02 1 1  ON 23
 eC_4                 2.191939e-01 1 1  ON 24
 eC_5                 3.144693e-01 1 1  ON 25
 eC_6                 2.693918e-01 1 1  ON 26
 eC_7                 1.532378e-01 1 1  ON 27
 eC_8                 3.806420e-02 1 1  ON 28
 eC_9                 8.501580e-03 1 1  ON 29
 eO_0                -1.060571e+00 1 1  ON 30
 eO_1                -6.723499e-01 1 1  ON 31
 eO_2                -1.873901e-01 1 1  ON 32
 eO_3                 1.223710e-01 1 1  ON 33
 eO_4                 3.262908e-01 1 1  ON 34
 eO_5                 4.344677e-01 1 1  ON 35
 eO_6                 4.201302e-01 1 1  ON 36
 eO_7                 3.542083e-01 1 1  ON 37
 eO_8                 1.752432e-01 1 1  ON 38
 eO_9                 5.970373e-02 1 1  ON 39
eH1_0                -1.503282e-01 1 1  ON 40
eH1_1                -5.117823e-02 1 1  ON 41
eH1_2                -2.900934e-02 1 1  ON 42
eH1_3                -2.762624e-02 1 1  ON 43
eH1_4                 8.041640e-03 1 1  ON 44
eH1_5                 1.843177e-02 1 1  ON 45
eH1_6                 4.575303e-02 1 1  ON 46
eH1_7                 4.473120e-02 1 1  ON 47
eH1_8                 5.961822e-02 1 1  ON 48
eH1_9                 6.232519e-02 1 1  ON 49
eH2_0                -1.505038e-01 1 1  ON 50
eH2_1                -4.950895e-02 1 1  ON 51
eH2_2                -2.432544e-02 1 1  ON 52
eH2_3                -2.654624e-02 1 1  ON 53
eH2_4                 8.319348e-03 1 1  ON 54
eH2_5                 1.727767e-02 1 1  ON 55
eH2_6                 3.765005e-02 1 1  ON 56
eH2_7                 3.518770e-02 1 1  ON 57
eH2_8                 5.958748e-02 1 1  ON 58
eH2_9                 6.634987e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2578e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2462e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.4538
    reference variance = 0.535687
====================================================
  Execution time = 4.5593e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5949e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5216e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559614903425
                                         uncertainty =       0.004787701464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559614903425
                                         uncertainty =       0.004787701464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528908548
  error estimate for blocks of size 2^( 2) =       0.000549873723
  error estimate for blocks of size 2^( 3) =       0.000568603156
  error estimate for blocks of size 2^( 4) =       0.000583723409
  error estimate for blocks of size 2^( 5) =       0.000593649664
  error estimate for blocks of size 2^( 6) =       0.000599778658
  error estimate for blocks of size 2^( 7) =       0.000602264669

      target function =                  N/A
              le_mean =     -22.436827221205
             les_mean =     503.970703978245
             stat err =       0.000594854100
             autocorr =       1.264910353526
              std dev =       0.747989641483
             le_variance =       0.559488503765


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243682722121e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-03, overlap shift 3.9062e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436827221205       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436849081899       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436870118594       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436879023208       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436886704109       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436909814419       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436910482815       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436917228381       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436927716317       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436948675458       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436961533289       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436990262325       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437019276700       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437073133228       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437078577953       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437084511030       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.437101087000       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.437114523978       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.437140586506       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.437168383351       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.437177134752       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.437186118273       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.437194210875       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.437192035559       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.437189661407       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.437189146087       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.437190323815       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.437191693469       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.437194372973       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.437197873896       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.437197641514       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.437200862798       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.437201818930       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.437199455192       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.437201216500       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.437199025979       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.437201114906       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.437201715525       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-03 is 7.052050e-01

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436827221205       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436847849565       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436866932133       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436875038695       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436881569029       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436902355575       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436902188702       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436907448437       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436915049547       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436932048257       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436938882441       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436957069871       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436971779274       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436990580183       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436987206102       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436985367053       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436989004585       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436990491289       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436993734235       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436998532855       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.436999818460       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.437000972748       residual = 9.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.437002164224       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.437000834452       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.437000242050       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.437000223848       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-02 is 7.734435e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436827221205       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436844053963       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436858051713       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436864358290       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436868201269       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436882828252       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436881918611       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436884915396       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436894117360       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436895546416       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436897238976       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436901622519       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436904945840       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436906045770       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436904163996       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436903481301       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436903555289       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436903565722       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436903794262       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436904056596       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 1.458229e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080209 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0851e+01
  </log>
  <optVariables href="FORMN2GVP1B.s003.opt.xml">
 uu_0                 2.762369e-01 1 1  ON 0
 uu_1                 1.035238e-01 1 1  ON 1
 uu_2                -1.164027e-02 1 1  ON 2
 uu_3                -8.007906e-02 1 1  ON 3
 uu_4                -1.192571e-01 1 1  ON 4
 uu_5                -1.414921e-01 1 1  ON 5
 uu_6                -1.497870e-01 1 1  ON 6
 uu_7                -1.433857e-01 1 1  ON 7
 uu_8                -1.113091e-01 1 1  ON 8
 uu_9                -3.998059e-02 1 1  ON 9
 ud_0                 4.378078e-01 1 1  ON 10
 ud_1                 1.540786e-01 1 1  ON 11
 ud_2                 5.277153e-03 1 1  ON 12
 ud_3                -7.660776e-02 1 1  ON 13
 ud_4                -1.229014e-01 1 1  ON 14
 ud_5                -1.507677e-01 1 1  ON 15
 ud_6                -1.638668e-01 1 1  ON 16
 ud_7                -1.614195e-01 1 1  ON 17
 ud_8                -1.367338e-01 1 1  ON 18
 ud_9                -7.526008e-02 1 1  ON 19
 eC_0                -5.925514e-01 1 1  ON 20
 eC_1                -4.222666e-01 1 1  ON 21
 eC_2                -1.269394e-01 1 1  ON 22
 eC_3                 7.769112e-02 1 1  ON 23
 eC_4                 2.015075e-01 1 1  ON 24
 eC_5                 2.975860e-01 1 1  ON 25
 eC_6                 2.760995e-01 1 1  ON 26
 eC_7                 2.106314e-01 1 1  ON 27
 eC_8                 6.493509e-02 1 1  ON 28
 eC_9                 1.116585e-02 1 1  ON 29
 eO_0                -1.085698e+00 1 1  ON 30
 eO_1                -6.960892e-01 1 1  ON 31
 eO_2                -2.135470e-01 1 1  ON 32
 eO_3                 9.542882e-02 1 1  ON 33
 eO_4                 2.996726e-01 1 1  ON 34
 eO_5                 4.165351e-01 1 1  ON 35
 eO_6                 4.122143e-01 1 1  ON 36
 eO_7                 3.804106e-01 1 1  ON 37
 eO_8                 2.525876e-01 1 1  ON 38
 eO_9                 9.984546e-02 1 1  ON 39
eH1_0                -1.529812e-01 1 1  ON 40
eH1_1                -5.137153e-02 1 1  ON 41
eH1_2                -3.163402e-02 1 1  ON 42
eH1_3                -3.273236e-02 1 1  ON 43
eH1_4                 5.491582e-03 1 1  ON 44
eH1_5                 1.515864e-02 1 1  ON 45
eH1_6                 4.201694e-02 1 1  ON 46
eH1_7                 4.312225e-02 1 1  ON 47
eH1_8                 4.917210e-02 1 1  ON 48
eH1_9                 8.301296e-02 1 1  ON 49
eH2_0                -1.522293e-01 1 1  ON 50
eH2_1                -5.175705e-02 1 1  ON 51
eH2_2                -3.345200e-02 1 1  ON 52
eH2_3                -3.154238e-02 1 1  ON 53
eH2_4                 6.736554e-03 1 1  ON 54
eH2_5                 1.568759e-02 1 1  ON 55
eH2_6                 4.604104e-02 1 1  ON 56
eH2_7                 4.226392e-02 1 1  ON 57
eH2_8                 4.393548e-02 1 1  ON 58
eH2_9                 7.750504e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.4533
    reference variance = 0.67853
====================================================
  Execution time = 4.5127e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5388e-01
  Total weights = 2.0000e+06
  Execution time = 3.8708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554379072957
                                         uncertainty =       0.003287938977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554379072957
                                         uncertainty =       0.003287938977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526494725
  error estimate for blocks of size 2^( 2) =       0.000547080240
  error estimate for blocks of size 2^( 3) =       0.000566234406
  error estimate for blocks of size 2^( 4) =       0.000581035017
  error estimate for blocks of size 2^( 5) =       0.000590100409
  error estimate for blocks of size 2^( 6) =       0.000594830604
  error estimate for blocks of size 2^( 7) =       0.000599937442

      target function =                  N/A
              le_mean =     -22.437220272684
             les_mean =     503.983246678307
             stat err =       0.000591475868
             autocorr =       1.262077464745
              std dev =       0.744575980383
             le_variance =       0.554393390564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573955988857
                                         uncertainty =       0.003308745933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573955988857
                                         uncertainty =       0.003308745933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535705962
  error estimate for blocks of size 2^( 2) =       0.000558779948
  error estimate for blocks of size 2^( 3) =       0.000580486023
  error estimate for blocks of size 2^( 4) =       0.000597769031
  error estimate for blocks of size 2^( 5) =       0.000608782471
  error estimate for blocks of size 2^( 6) =       0.000614758997
  error estimate for blocks of size 2^( 7) =       0.000620542825

      target function =                  N/A
              le_mean =     -22.445698922908
             les_mean =     504.383361605537
             stat err =       0.000610463331
             autocorr =       1.298572510765
              std dev =       0.757602636409
             le_variance =       0.573961754694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554662438431
                                         uncertainty =       0.003288298507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554662438431
                                         uncertainty =       0.003288298507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526632195
  error estimate for blocks of size 2^( 2) =       0.000547199553
  error estimate for blocks of size 2^( 3) =       0.000566319637
  error estimate for blocks of size 2^( 4) =       0.000580951329
  error estimate for blocks of size 2^( 5) =       0.000589722108
  error estimate for blocks of size 2^( 6) =       0.000594199613
  error estimate for blocks of size 2^( 7) =       0.000599320091

      target function =                  N/A
              le_mean =     -22.437185377510
             les_mean =     503.981970325439
             stat err =       0.000591048285
             autocorr =       1.259595533165
              std dev =       0.744770392834
             le_variance =       0.554682938043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554142455846
                                         uncertainty =       0.003286481541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554142455846
                                         uncertainty =       0.003286481541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526383414
  error estimate for blocks of size 2^( 2) =       0.000546951120
  error estimate for blocks of size 2^( 3) =       0.000566080451
  error estimate for blocks of size 2^( 4) =       0.000580832653
  error estimate for blocks of size 2^( 5) =       0.000589820057
  error estimate for blocks of size 2^( 6) =       0.000594489506
  error estimate for blocks of size 2^( 7) =       0.000599629992

      target function =                  N/A
              le_mean =     -22.437095763125
             les_mean =     503.977425003831
             stat err =       0.000591193052
             autocorr =       1.261404132720
              std dev =       0.744418563209
             le_variance =       0.554158997249


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437220272684        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
     1.5625e-02     1.5625e-01             7.7344e-02       -22.437185377510
     6.2500e-02     6.2500e-01             1.4582e-02       -22.437095763125

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.3289
  </log>
  <optVariables href="FORMN2GVP1B.s003.opt.xml">
 uu_0                 2.826930e-01 1 1  ON 0
 uu_1                 1.055133e-01 1 1  ON 1
 uu_2                -9.212669e-03 1 1  ON 2
 uu_3                -7.699098e-02 1 1  ON 3
 uu_4                -1.148623e-01 1 1  ON 4
 uu_5                -1.346419e-01 1 1  ON 5
 uu_6                -1.412758e-01 1 1  ON 6
 uu_7                -1.281034e-01 1 1  ON 7
 uu_8                -9.636410e-02 1 1  ON 8
 uu_9                -1.776312e-02 1 1  ON 9
 ud_0                 4.418181e-01 1 1  ON 10
 ud_1                 1.580913e-01 1 1  ON 11
 ud_2                 9.361313e-03 1 1  ON 12
 ud_3                -7.311087e-02 1 1  ON 13
 ud_4                -1.198303e-01 1 1  ON 14
 ud_5                -1.490343e-01 1 1  ON 15
 ud_6                -1.635942e-01 1 1  ON 16
 ud_7                -1.612153e-01 1 1  ON 17
 ud_8                -1.316166e-01 1 1  ON 18
 ud_9                -6.150964e-02 1 1  ON 19
 eC_0                -5.795425e-01 1 1  ON 20
 eC_1                -4.082306e-01 1 1  ON 21
 eC_2                -1.127081e-01 1 1  ON 22
 eC_3                 9.514893e-02 1 1  ON 23
 eC_4                 2.191939e-01 1 1  ON 24
 eC_5                 3.144693e-01 1 1  ON 25
 eC_6                 2.693918e-01 1 1  ON 26
 eC_7                 1.532378e-01 1 1  ON 27
 eC_8                 3.806420e-02 1 1  ON 28
 eC_9                 8.501580e-03 1 1  ON 29
 eO_0                -1.060571e+00 1 1  ON 30
 eO_1                -6.723499e-01 1 1  ON 31
 eO_2                -1.873901e-01 1 1  ON 32
 eO_3                 1.223710e-01 1 1  ON 33
 eO_4                 3.262908e-01 1 1  ON 34
 eO_5                 4.344677e-01 1 1  ON 35
 eO_6                 4.201302e-01 1 1  ON 36
 eO_7                 3.542083e-01 1 1  ON 37
 eO_8                 1.752432e-01 1 1  ON 38
 eO_9                 5.970373e-02 1 1  ON 39
eH1_0                -1.503282e-01 1 1  ON 40
eH1_1                -5.117823e-02 1 1  ON 41
eH1_2                -2.900934e-02 1 1  ON 42
eH1_3                -2.762624e-02 1 1  ON 43
eH1_4                 8.041640e-03 1 1  ON 44
eH1_5                 1.843177e-02 1 1  ON 45
eH1_6                 4.575303e-02 1 1  ON 46
eH1_7                 4.473120e-02 1 1  ON 47
eH1_8                 5.961822e-02 1 1  ON 48
eH1_9                 6.232519e-02 1 1  ON 49
eH2_0                -1.505038e-01 1 1  ON 50
eH2_1                -4.950895e-02 1 1  ON 51
eH2_2                -2.432544e-02 1 1  ON 52
eH2_3                -2.654624e-02 1 1  ON 53
eH2_4                 8.319348e-03 1 1  ON 54
eH2_5                 1.727767e-02 1 1  ON 55
eH2_6                 3.765005e-02 1 1  ON 56
eH2_7                 3.518770e-02 1 1  ON 57
eH2_8                 5.958748e-02 1 1  ON 58
eH2_9                 6.634987e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2719e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2460e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.3522
    reference variance = 0.5048
====================================================
  Execution time = 4.5662e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6474e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5318e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564766374341
                                         uncertainty =       0.004882474869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564766374341
                                         uncertainty =       0.004882474869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531382820
  error estimate for blocks of size 2^( 2) =       0.000551857044
  error estimate for blocks of size 2^( 3) =       0.000571315002
  error estimate for blocks of size 2^( 4) =       0.000584695156
  error estimate for blocks of size 2^( 5) =       0.000593752144
  error estimate for blocks of size 2^( 6) =       0.000598706255
  error estimate for blocks of size 2^( 7) =       0.000601965780

      target function =                  N/A
              le_mean =     -22.436244001130
             les_mean =     503.949779999569
             stat err =       0.000594779834
             autocorr =       1.252845309420
              std dev =       0.751488791454
             le_variance =       0.564735403681


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243624400113e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436244001130       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436246487258       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436262716522       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436271208317       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436286040444       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436299812457       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436295251110       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436305690142       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436309889235       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436315031512       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436323476283       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436326718989       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436330317747       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436338049507       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436342822940       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436342598682       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436343363141       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436342467995       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436343358756       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436344033789       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.436344305422       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.436344179736       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 2.493289e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436244001130       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436245610544       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436254713949       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436257129361       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436265939593       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436276781234       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436275301652       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436277745759       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436279530925       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436280824972       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436282359644       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436281929873       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436282104561       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436283671849       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436283338336       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436283484607       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 5.623040e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436244001130       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436244668778       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436248147915       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436248343836       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436250728034       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436256126210       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436256651178       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436256987242       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436257095425       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436257374799       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436257214236       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436257119137       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436257360844       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436257422008       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 1.372466e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091414 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0995e+01
  </log>
  <optVariables href="FORMN2GVP1B.s004.opt.xml">
 uu_0                 2.811684e-01 1 1  ON 0
 uu_1                 1.060454e-01 1 1  ON 1
 uu_2                -8.887091e-03 1 1  ON 2
 uu_3                -7.703910e-02 1 1  ON 3
 uu_4                -1.151132e-01 1 1  ON 4
 uu_5                -1.354554e-01 1 1  ON 5
 uu_6                -1.419493e-01 1 1  ON 6
 uu_7                -1.299676e-01 1 1  ON 7
 uu_8                -9.638019e-02 1 1  ON 8
 uu_9                -1.890981e-02 1 1  ON 9
 ud_0                 4.413530e-01 1 1  ON 10
 ud_1                 1.574316e-01 1 1  ON 11
 ud_2                 8.607535e-03 1 1  ON 12
 ud_3                -7.374404e-02 1 1  ON 13
 ud_4                -1.204897e-01 1 1  ON 14
 ud_5                -1.491221e-01 1 1  ON 15
 ud_6                -1.630467e-01 1 1  ON 16
 ud_7                -1.598754e-01 1 1  ON 17
 ud_8                -1.315220e-01 1 1  ON 18
 ud_9                -6.283653e-02 1 1  ON 19
 eC_0                -5.800695e-01 1 1  ON 20
 eC_1                -4.090681e-01 1 1  ON 21
 eC_2                -1.138077e-01 1 1  ON 22
 eC_3                 9.333979e-02 1 1  ON 23
 eC_4                 2.176444e-01 1 1  ON 24
 eC_5                 3.134333e-01 1 1  ON 25
 eC_6                 2.703034e-01 1 1  ON 26
 eC_7                 1.574084e-01 1 1  ON 27
 eC_8                 3.970304e-02 1 1  ON 28
 eC_9                 8.649855e-03 1 1  ON 29
 eO_0                -1.062092e+00 1 1  ON 30
 eO_1                -6.735036e-01 1 1  ON 31
 eO_2                -1.889452e-01 1 1  ON 32
 eO_3                 1.208421e-01 1 1  ON 33
 eO_4                 3.238353e-01 1 1  ON 34
 eO_5                 4.329689e-01 1 1  ON 35
 eO_6                 4.187822e-01 1 1  ON 36
 eO_7                 3.565463e-01 1 1  ON 37
 eO_8                 1.808663e-01 1 1  ON 38
 eO_9                 6.219188e-02 1 1  ON 39
eH1_0                -1.508082e-01 1 1  ON 40
eH1_1                -5.101164e-02 1 1  ON 41
eH1_2                -2.939760e-02 1 1  ON 42
eH1_3                -2.821635e-02 1 1  ON 43
eH1_4                 8.454103e-03 1 1  ON 44
eH1_5                 1.796298e-02 1 1  ON 45
eH1_6                 4.534408e-02 1 1  ON 46
eH1_7                 4.475215e-02 1 1  ON 47
eH1_8                 5.893484e-02 1 1  ON 48
eH1_9                 6.372932e-02 1 1  ON 49
eH2_0                -1.503317e-01 1 1  ON 50
eH2_1                -4.906410e-02 1 1  ON 51
eH2_2                -2.707217e-02 1 1  ON 52
eH2_3                -2.704492e-02 1 1  ON 53
eH2_4                 8.634892e-03 1 1  ON 54
eH2_5                 1.707435e-02 1 1  ON 55
eH2_6                 3.951726e-02 1 1  ON 56
eH2_7                 3.585918e-02 1 1  ON 57
eH2_8                 5.833583e-02 1 1  ON 58
eH2_9                 6.708878e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.5187
    reference variance = 0.398479
====================================================
  Execution time = 4.5115e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6366e-01
  Total weights = 2.0000e+06
  Execution time = 3.8663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563764114413
                                         uncertainty =       0.005613300997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563764114413
                                         uncertainty =       0.005613300997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530856691
  error estimate for blocks of size 2^( 2) =       0.000551161657
  error estimate for blocks of size 2^( 3) =       0.000570831707
  error estimate for blocks of size 2^( 4) =       0.000585027532
  error estimate for blocks of size 2^( 5) =       0.000594469145
  error estimate for blocks of size 2^( 6) =       0.000598118545
  error estimate for blocks of size 2^( 7) =       0.000601951632

      target function =                  N/A
              le_mean =     -22.435728825586
             les_mean =     503.925545305748
             stat err =       0.000594891714
             autocorr =       1.255802225440
              std dev =       0.750744731804
             le_variance =       0.563617652332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563809550279
                                         uncertainty =       0.005606679805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563809550279
                                         uncertainty =       0.005606679805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530878220
  error estimate for blocks of size 2^( 2) =       0.000551141380
  error estimate for blocks of size 2^( 3) =       0.000570730597
  error estimate for blocks of size 2^( 4) =       0.000584808568
  error estimate for blocks of size 2^( 5) =       0.000594179495
  error estimate for blocks of size 2^( 6) =       0.000597799003
  error estimate for blocks of size 2^( 7) =       0.000601537923

      target function =                  N/A
              le_mean =     -22.435740206928
             les_mean =     503.926101719161
             stat err =       0.000594581247
             autocorr =       1.254390046716
              std dev =       0.750775178228
             le_variance =       0.563663368243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564027296306
                                         uncertainty =       0.005608296004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564027296306
                                         uncertainty =       0.005608296004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530980694
  error estimate for blocks of size 2^( 2) =       0.000551252522
  error estimate for blocks of size 2^( 3) =       0.000570853508
  error estimate for blocks of size 2^( 4) =       0.000584951249
  error estimate for blocks of size 2^( 5) =       0.000594353148
  error estimate for blocks of size 2^( 6) =       0.000598023563
  error estimate for blocks of size 2^( 7) =       0.000601793245

      target function =                  N/A
              le_mean =     -22.435734997771
             les_mean =     503.926085602577
             stat err =       0.000594780301
             autocorr =       1.254745631123
              std dev =       0.750920098485
             le_variance =       0.563880994308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563790019546
                                         uncertainty =       0.005613420748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563790019546
                                         uncertainty =       0.005613420748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530868875
  error estimate for blocks of size 2^( 2) =       0.000551163248
  error estimate for blocks of size 2^( 3) =       0.000570816911
  error estimate for blocks of size 2^( 4) =       0.000584992220
  error estimate for blocks of size 2^( 5) =       0.000594427422
  error estimate for blocks of size 2^( 6) =       0.000598087628
  error estimate for blocks of size 2^( 7) =       0.000601909581

      target function =                  N/A
              le_mean =     -22.435718736151
             les_mean =     503.925118451613
             stat err =       0.000594854213
             autocorr =       1.255586264847
              std dev =       0.750761963432
             le_variance =       0.563643525737


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435728825586        initial
     3.9062e-02     3.9062e-01             2.4933e-02       -22.435740206928  <--
     1.5625e-01     1.5625e+00             5.6230e-03       -22.435734997771
     6.2500e-01     6.2500e+00             1.3725e-03       -22.435718736151

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 6.4522e+01
  </log>
  <optVariables href="FORMN2GVP1B.s004.opt.xml">
 uu_0                 2.795945e-01 1 1  ON 0
 uu_1                 1.054893e-01 1 1  ON 1
 uu_2                -9.596080e-03 1 1  ON 2
 uu_3                -7.796124e-02 1 1  ON 3
 uu_4                -1.163266e-01 1 1  ON 4
 uu_5                -1.372310e-01 1 1  ON 5
 uu_6                -1.440729e-01 1 1  ON 6
 uu_7                -1.334996e-01 1 1  ON 7
 uu_8                -9.916153e-02 1 1  ON 8
 uu_9                -2.361024e-02 1 1  ON 9
 ud_0                 4.404785e-01 1 1  ON 10
 ud_1                 1.564681e-01 1 1  ON 11
 ud_2                 7.656154e-03 1 1  ON 12
 ud_3                -7.456959e-02 1 1  ON 13
 ud_4                -1.211799e-01 1 1  ON 14
 ud_5                -1.494107e-01 1 1  ON 15
 ud_6                -1.629206e-01 1 1  ON 16
 ud_7                -1.594658e-01 1 1  ON 17
 ud_8                -1.327147e-01 1 1  ON 18
 ud_9                -6.704769e-02 1 1  ON 19
 eC_0                -5.829005e-01 1 1  ON 20
 eC_1                -4.122858e-01 1 1  ON 21
 eC_2                -1.175754e-01 1 1  ON 22
 eC_3                 8.863934e-02 1 1  ON 23
 eC_4                 2.127120e-01 1 1  ON 24
 eC_5                 3.094769e-01 1 1  ON 25
 eC_6                 2.726194e-01 1 1  ON 26
 eC_7                 1.717563e-01 1 1  ON 27
 eC_8                 4.583992e-02 1 1  ON 28
 eC_9                 9.285023e-03 1 1  ON 29
 eO_0                -1.067786e+00 1 1  ON 30
 eO_1                -6.789314e-01 1 1  ON 31
 eO_2                -1.947191e-01 1 1  ON 32
 eO_3                 1.143821e-01 1 1  ON 33
 eO_4                 3.170010e-01 1 1  ON 34
 eO_5                 4.278812e-01 1 1  ON 35
 eO_6                 4.163524e-01 1 1  ON 36
 eO_7                 3.633349e-01 1 1  ON 37
 eO_8                 2.001761e-01 1 1  ON 38
 eO_9                 7.141513e-02 1 1  ON 39
eH1_0                -1.520633e-01 1 1  ON 40
eH1_1                -5.170065e-02 1 1  ON 41
eH1_2                -3.059470e-02 1 1  ON 42
eH1_3                -2.962255e-02 1 1  ON 43
eH1_4                 7.961273e-03 1 1  ON 44
eH1_5                 1.734981e-02 1 1  ON 45
eH1_6                 4.491618e-02 1 1  ON 46
eH1_7                 4.516842e-02 1 1  ON 47
eH1_8                 5.609718e-02 1 1  ON 48
eH1_9                 6.844584e-02 1 1  ON 49
eH2_0                -1.507744e-01 1 1  ON 50
eH2_1                -4.965471e-02 1 1  ON 51
eH2_2                -3.003222e-02 1 1  ON 52
eH2_3                -2.843044e-02 1 1  ON 53
eH2_4                 8.533219e-03 1 1  ON 54
eH2_5                 1.736444e-02 1 1  ON 55
eH2_6                 4.212729e-02 1 1  ON 56
eH2_7                 3.834755e-02 1 1  ON 57
eH2_8                 5.414019e-02 1 1  ON 58
eH2_9                 6.952883e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2552e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2455e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.41
    reference variance = 0.593721
====================================================
  Execution time = 4.6010e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6510e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5257e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565102297705
                                         uncertainty =       0.003786009080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565102297705
                                         uncertainty =       0.003786009080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531554312
  error estimate for blocks of size 2^( 2) =       0.000551013446
  error estimate for blocks of size 2^( 3) =       0.000569821243
  error estimate for blocks of size 2^( 4) =       0.000583657030
  error estimate for blocks of size 2^( 5) =       0.000593647007
  error estimate for blocks of size 2^( 6) =       0.000599948252
  error estimate for blocks of size 2^( 7) =       0.000603721247

      target function =                  N/A
              le_mean =     -22.436142249429
             les_mean =     503.945578726735
             stat err =       0.000595243384
             autocorr =       1.253989393915
              std dev =       0.751731316801
             le_variance =       0.565099972659


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243614224943e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436142249429       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436146734340       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436145076883       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436144606600       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436146315488       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436161211991       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436166119962       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436186466030       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436217810804       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436239748855       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436240764371       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436250021295       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436260357347       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436269805773       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436274455688       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436276868303       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436284444909       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436292301206       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436295866145       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436299511800       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.436300146320       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.436298017859       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.436297676039       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.436297156706       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.436296587252       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.436296146632       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.436296069531       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.436295995201       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.436296227632       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.436297189063       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-03 is 1.226732e-01

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436142249429       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436146370405       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436145162080       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436144638214       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436144668389       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436155111580       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436159429423       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436170917155       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436183336409       residual = 9.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436189388870       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436186424958       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436187154169       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436187976495       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436188579040       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436188961203       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436188672102       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436190000311       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436190941236       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436191177077       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436191462716       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 2.054181e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436142249429       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436145360571       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436144928509       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436144636519       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436143311158       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436147150617       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436150690889       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436154984117       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436157382654       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436158071631       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436156388429       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436156271018       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436156418445       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436156305970       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436156314286       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436156318292       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 4.772854e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111392 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1291e+01
  </log>
  <optVariables href="FORMN2GVP1B.s005.opt.xml">
 uu_0                 2.791384e-01 1 1  ON 0
 uu_1                 1.043686e-01 1 1  ON 1
 uu_2                -1.075569e-02 1 1  ON 2
 uu_3                -7.890912e-02 1 1  ON 3
 uu_4                -1.175835e-01 1 1  ON 4
 uu_5                -1.386135e-01 1 1  ON 5
 uu_6                -1.461612e-01 1 1  ON 6
 uu_7                -1.362742e-01 1 1  ON 7
 uu_8                -1.046520e-01 1 1  ON 8
 uu_9                -2.980051e-02 1 1  ON 9
 ud_0                 4.397955e-01 1 1  ON 10
 ud_1                 1.559219e-01 1 1  ON 11
 ud_2                 7.060712e-03 1 1  ON 12
 ud_3                -7.509491e-02 1 1  ON 13
 ud_4                -1.215126e-01 1 1  ON 14
 ud_5                -1.498284e-01 1 1  ON 15
 ud_6                -1.641865e-01 1 1  ON 16
 ud_7                -1.615066e-01 1 1  ON 17
 ud_8                -1.341124e-01 1 1  ON 18
 ud_9                -7.097278e-02 1 1  ON 19
 eC_0                -5.865980e-01 1 1  ON 20
 eC_1                -4.157061e-01 1 1  ON 21
 eC_2                -1.215287e-01 1 1  ON 22
 eC_3                 8.440713e-02 1 1  ON 23
 eC_4                 2.082339e-01 1 1  ON 24
 eC_5                 3.056370e-01 1 1  ON 25
 eC_6                 2.747380e-01 1 1  ON 26
 eC_7                 1.858915e-01 1 1  ON 27
 eC_8                 5.214584e-02 1 1  ON 28
 eC_9                 1.035287e-02 1 1  ON 29
 eO_0                -1.075167e+00 1 1  ON 30
 eO_1                -6.861657e-01 1 1  ON 31
 eO_2                -2.026161e-01 1 1  ON 32
 eO_3                 1.073496e-01 1 1  ON 33
 eO_4                 3.103974e-01 1 1  ON 34
 eO_5                 4.237797e-01 1 1  ON 35
 eO_6                 4.149854e-01 1 1  ON 36
 eO_7                 3.708762e-01 1 1  ON 37
 eO_8                 2.207179e-01 1 1  ON 38
 eO_9                 8.177154e-02 1 1  ON 39
eH1_0                -1.531442e-01 1 1  ON 40
eH1_1                -5.204328e-02 1 1  ON 41
eH1_2                -3.070936e-02 1 1  ON 42
eH1_3                -2.958642e-02 1 1  ON 43
eH1_4                 8.177456e-03 1 1  ON 44
eH1_5                 1.867826e-02 1 1  ON 45
eH1_6                 4.549140e-02 1 1  ON 46
eH1_7                 4.436966e-02 1 1  ON 47
eH1_8                 5.164503e-02 1 1  ON 48
eH1_9                 7.077535e-02 1 1  ON 49
eH2_0                -1.517279e-01 1 1  ON 50
eH2_1                -5.129074e-02 1 1  ON 51
eH2_2                -3.041399e-02 1 1  ON 52
eH2_3                -3.011121e-02 1 1  ON 53
eH2_4                 7.492864e-03 1 1  ON 54
eH2_5                 1.676738e-02 1 1  ON 55
eH2_6                 4.287050e-02 1 1  ON 56
eH2_7                 3.934483e-02 1 1  ON 57
eH2_8                 5.152901e-02 1 1  ON 58
eH2_9                 7.348121e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.4862
    reference variance = 0.408452
====================================================
  Execution time = 4.5295e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6866e-01
  Total weights = 2.0000e+06
  Execution time = 3.8386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568934170462
                                         uncertainty =       0.010637245977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568934170462
                                         uncertainty =       0.010637245977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533339982
  error estimate for blocks of size 2^( 2) =       0.000553273217
  error estimate for blocks of size 2^( 3) =       0.000571738863
  error estimate for blocks of size 2^( 4) =       0.000586499983
  error estimate for blocks of size 2^( 5) =       0.000595471819
  error estimate for blocks of size 2^( 6) =       0.000600917354
  error estimate for blocks of size 2^( 7) =       0.000604278238

      target function =                  N/A
              le_mean =     -22.436891340891
             les_mean =     503.982995830640
             stat err =       0.000596791849
             autocorr =       1.252095578417
              std dev =       0.754256635452
             le_variance =       0.568903072123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569123003469
                                         uncertainty =       0.010646809882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569123003469
                                         uncertainty =       0.010646809882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533427373
  error estimate for blocks of size 2^( 2) =       0.000553244213
  error estimate for blocks of size 2^( 3) =       0.000571518345
  error estimate for blocks of size 2^( 4) =       0.000586074361
  error estimate for blocks of size 2^( 5) =       0.000594827641
  error estimate for blocks of size 2^( 6) =       0.000600228323
  error estimate for blocks of size 2^( 7) =       0.000603450166

      target function =                  N/A
              le_mean =     -22.436975607628
             les_mean =     503.986963656888
             stat err =       0.000596145123
             autocorr =       1.248973992380
              std dev =       0.754380225182
             le_variance =       0.569089524145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568525358364
                                         uncertainty =       0.010621874789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568525358364
                                         uncertainty =       0.010621874789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533147412
  error estimate for blocks of size 2^( 2) =       0.000553038931
  error estimate for blocks of size 2^( 3) =       0.000571442859
  error estimate for blocks of size 2^( 4) =       0.000586146699
  error estimate for blocks of size 2^( 5) =       0.000595041910
  error estimate for blocks of size 2^( 6) =       0.000600476598
  error estimate for blocks of size 2^( 7) =       0.000603795773

      target function =                  N/A
              le_mean =     -22.436895967785
             les_mean =     503.982792710713
             stat err =       0.000596365245
             autocorr =       1.251209520620
              std dev =       0.753984300726
             le_variance =       0.568492325741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568876588064
                                         uncertainty =       0.010632316046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568876588064
                                         uncertainty =       0.010632316046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533312704
  error estimate for blocks of size 2^( 2) =       0.000553238197
  error estimate for blocks of size 2^( 3) =       0.000571693227
  error estimate for blocks of size 2^( 4) =       0.000586448062
  error estimate for blocks of size 2^( 5) =       0.000595409875
  error estimate for blocks of size 2^( 6) =       0.000600853911
  error estimate for blocks of size 2^( 7) =       0.000604212670

      target function =                  N/A
              le_mean =     -22.436886817534
             les_mean =     503.982734659506
             stat err =       0.000596731130
             autocorr =       1.251968868798
              std dev =       0.754218059374
             le_variance =       0.568844881086


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436891340891        initial
     9.7656e-03     9.7656e-02             1.2267e-01       -22.436975607628  <--
     3.9062e-02     3.9062e-01             2.0542e-02       -22.436895967785
     1.5625e-01     1.5625e+00             4.7729e-03       -22.436886817534

*****************************************************************************
Applying the update for shift_i =   9.7656e-03     and shift_s =   9.7656e-02
*****************************************************************************

  Execution time = 6.4504e+01
  </log>
  <optVariables href="FORMN2GVP1B.s005.opt.xml">
 uu_0                 2.746603e-01 1 1  ON 0
 uu_1                 9.910200e-02 1 1  ON 1
 uu_2                -1.633502e-02 1 1  ON 2
 uu_3                -8.484589e-02 1 1  ON 3
 uu_4                -1.247040e-01 1 1  ON 4
 uu_5                -1.472263e-01 1 1  ON 5
 uu_6                -1.574192e-01 1 1  ON 6
 uu_7                -1.515072e-01 1 1  ON 7
 uu_8                -1.291111e-01 1 1  ON 8
 uu_9                -6.313280e-02 1 1  ON 9
 ud_0                 4.399373e-01 1 1  ON 10
 ud_1                 1.561226e-01 1 1  ON 11
 ud_2                 7.015700e-03 1 1  ON 12
 ud_3                -7.550727e-02 1 1  ON 13
 ud_4                -1.225317e-01 1 1  ON 14
 ud_5                -1.521929e-01 1 1  ON 15
 ud_6                -1.691332e-01 1 1  ON 16
 ud_7                -1.705592e-01 1 1  ON 17
 ud_8                -1.477894e-01 1 1  ON 18
 ud_9                -9.612412e-02 1 1  ON 19
 eC_0                -6.099541e-01 1 1  ON 20
 eC_1                -4.386463e-01 1 1  ON 21
 eC_2                -1.442474e-01 1 1  ON 22
 eC_3                 6.275720e-02 1 1  ON 23
 eC_4                 1.889012e-01 1 1  ON 24
 eC_5                 2.919617e-01 1 1  ON 25
 eC_6                 2.840307e-01 1 1  ON 26
 eC_7                 2.543448e-01 1 1  ON 27
 eC_8                 9.082786e-02 1 1  ON 28
 eC_9                 1.772495e-02 1 1  ON 29
 eO_0                -1.119547e+00 1 1  ON 30
 eO_1                -7.295135e-01 1 1  ON 31
 eO_2                -2.447833e-01 1 1  ON 32
 eO_3                 6.997298e-02 1 1  ON 33
 eO_4                 2.799382e-01 1 1  ON 34
 eO_5                 4.050217e-01 1 1  ON 35
 eO_6                 4.143868e-01 1 1  ON 36
 eO_7                 4.037782e-01 1 1  ON 37
 eO_8                 3.228494e-01 1 1  ON 38
 eO_9                 1.435383e-01 1 1  ON 39
eH1_0                -1.573978e-01 1 1  ON 40
eH1_1                -5.502453e-02 1 1  ON 41
eH1_2                -3.332518e-02 1 1  ON 42
eH1_3                -3.135759e-02 1 1  ON 43
eH1_4                 7.750321e-03 1 1  ON 44
eH1_5                 2.110951e-02 1 1  ON 45
eH1_6                 4.917446e-02 1 1  ON 46
eH1_7                 4.653449e-02 1 1  ON 47
eH1_8                 3.312482e-02 1 1  ON 48
eH1_9                 7.894303e-02 1 1  ON 49
eH2_0                -1.580121e-01 1 1  ON 50
eH2_1                -5.829089e-02 1 1  ON 51
eH2_2                -3.598500e-02 1 1  ON 52
eH2_3                -3.631562e-02 1 1  ON 53
eH2_4                 3.033552e-03 1 1  ON 54
eH2_5                 1.470504e-02 1 1  ON 55
eH2_6                 4.448751e-02 1 1  ON 56
eH2_7                 4.458651e-02 1 1  ON 57
eH2_8                 3.876769e-02 1 1  ON 58
eH2_9                 9.076094e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2580e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2454e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.4427
    reference variance = 0.328657
====================================================
  Execution time = 4.7147e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7737e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5430e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577402971204
                                         uncertainty =       0.011708621186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577402971204
                                         uncertainty =       0.011708621186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537293222
  error estimate for blocks of size 2^( 2) =       0.000557141428
  error estimate for blocks of size 2^( 3) =       0.000575151533
  error estimate for blocks of size 2^( 4) =       0.000587888986
  error estimate for blocks of size 2^( 5) =       0.000596681731
  error estimate for blocks of size 2^( 6) =       0.000601623833
  error estimate for blocks of size 2^( 7) =       0.000603068159

      target function =                  N/A
              le_mean =     -22.437676968712
             les_mean =     504.026715476087
             stat err =       0.000597315677
             autocorr =       1.235905040254
              std dev =       0.759847361311
             le_variance =       0.577368012491


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243767696871e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-03, overlap shift 2.4414e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437676968712       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437672339562       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437673796246       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437676276131       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437683128626       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437685529712       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437687578244       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437688878790       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437688845180       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437693368318       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437689728030       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437691416978       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437694311877       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437710771232       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437716864859       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437731904776       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.437759039915       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.437772564417       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.437781709341       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.437789000796       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.437791468498       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.437794709713       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.437800623113       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.437800210762       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.437799341322       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.437800998661       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.437800444567       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.437799812122       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.437799440282       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.437797448041       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.437799907798       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.437800640220       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.437802296389       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.437801959067       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.437805019828       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.437805121453       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.437805687559       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.437804190984       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-03 is 3.792546e-01

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437676968712       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437672474134       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437673717486       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437676221667       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437682548559       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437684807694       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437686817919       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437687702965       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437687349675       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437691449282       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437687939573       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437688950521       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437691813044       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437702552782       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437705067399       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437711633918       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.437721939155       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.437725348083       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.437727068292       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.437727079528       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.437726205216       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.437726142705       residual = 9.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.437727202121       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.437726781794       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.437726367352       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.437726695785       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.437726384989       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-03 is 3.610206e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437676968712       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437672942334       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437673456571       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437676136891       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437680852780       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437682615231       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437684591348       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437684505644       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437683531752       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437686610608       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437683778516       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437684031006       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437686393772       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437689680105       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437690359482       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437691322387       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.437692532403       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.437693346401       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.437693443248       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.437692928838       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 7.402569e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149573 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2620e+01
  </log>
  <optVariables href="FORMN2GVP1B.s006.opt.xml">
 uu_0                 2.707365e-01 1 1  ON 0
 uu_1                 9.585762e-02 1 1  ON 1
 uu_2                -1.978463e-02 1 1  ON 2
 uu_3                -8.887828e-02 1 1  ON 3
 uu_4                -1.287230e-01 1 1  ON 4
 uu_5                -1.517119e-01 1 1  ON 5
 uu_6                -1.618886e-01 1 1  ON 6
 uu_7                -1.586428e-01 1 1  ON 7
 uu_8                -1.370780e-01 1 1  ON 8
 uu_9                -8.137390e-02 1 1  ON 9
 ud_0                 4.437835e-01 1 1  ON 10
 ud_1                 1.595567e-01 1 1  ON 11
 ud_2                 1.008666e-02 1 1  ON 12
 ud_3                -7.306970e-02 1 1  ON 13
 ud_4                -1.214039e-01 1 1  ON 14
 ud_5                -1.521155e-01 1 1  ON 15
 ud_6                -1.699931e-01 1 1  ON 16
 ud_7                -1.735230e-01 1 1  ON 17
 ud_8                -1.576528e-01 1 1  ON 18
 ud_9                -1.104415e-01 1 1  ON 19
 eC_0                -6.232998e-01 1 1  ON 20
 eC_1                -4.529964e-01 1 1  ON 21
 eC_2                -1.562502e-01 1 1  ON 22
 eC_3                 5.431503e-02 1 1  ON 23
 eC_4                 1.859807e-01 1 1  ON 24
 eC_5                 2.883055e-01 1 1  ON 25
 eC_6                 2.816320e-01 1 1  ON 26
 eC_7                 2.776192e-01 1 1  ON 27
 eC_8                 1.162422e-01 1 1  ON 28
 eC_9                 2.510472e-02 1 1  ON 29
 eO_0                -1.138880e+00 1 1  ON 30
 eO_1                -7.484699e-01 1 1  ON 31
 eO_2                -2.611756e-01 1 1  ON 32
 eO_3                 5.254884e-02 1 1  ON 33
 eO_4                 2.667604e-01 1 1  ON 34
 eO_5                 3.953522e-01 1 1  ON 35
 eO_6                 4.126891e-01 1 1  ON 36
 eO_7                 4.139924e-01 1 1  ON 37
 eO_8                 3.570829e-01 1 1  ON 38
 eO_9                 1.796403e-01 1 1  ON 39
eH1_0                -1.574374e-01 1 1  ON 40
eH1_1                -5.715277e-02 1 1  ON 41
eH1_2                -3.768090e-02 1 1  ON 42
eH1_3                -3.687533e-02 1 1  ON 43
eH1_4                 3.095698e-03 1 1  ON 44
eH1_5                 1.436197e-02 1 1  ON 45
eH1_6                 4.542410e-02 1 1  ON 46
eH1_7                 5.277561e-02 1 1  ON 47
eH1_8                 3.254761e-02 1 1  ON 48
eH1_9                 8.491477e-02 1 1  ON 49
eH2_0                -1.604965e-01 1 1  ON 50
eH2_1                -5.998311e-02 1 1  ON 51
eH2_2                -3.958682e-02 1 1  ON 52
eH2_3                -3.698000e-02 1 1  ON 53
eH2_4                 2.513235e-03 1 1  ON 54
eH2_5                 1.341409e-02 1 1  ON 55
eH2_6                 4.367855e-02 1 1  ON 56
eH2_7                 5.068786e-02 1 1  ON 57
eH2_8                 3.299228e-02 1 1  ON 58
eH2_9                 9.113104e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.4527
    reference variance = 1.53705
====================================================
  Execution time = 4.4916e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6170e-01
  Total weights = 2.0000e+06
  Execution time = 3.8338e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560171276690
                                         uncertainty =       0.004411186957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560171276690
                                         uncertainty =       0.004411186957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529247728
  error estimate for blocks of size 2^( 2) =       0.000549455019
  error estimate for blocks of size 2^( 3) =       0.000568971880
  error estimate for blocks of size 2^( 4) =       0.000583466338
  error estimate for blocks of size 2^( 5) =       0.000592850397
  error estimate for blocks of size 2^( 6) =       0.000596533927
  error estimate for blocks of size 2^( 7) =       0.000599131260

      target function =                  N/A
              le_mean =     -22.437215885303
             les_mean =     503.988862719601
             stat err =       0.000592995481
             autocorr =       1.255407623842
              std dev =       0.748469315332
             le_variance =       0.560206315994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571895582997
                                         uncertainty =       0.004494603003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571895582997
                                         uncertainty =       0.004494603003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534759780
  error estimate for blocks of size 2^( 2) =       0.000554992271
  error estimate for blocks of size 2^( 3) =       0.000574227247
  error estimate for blocks of size 2^( 4) =       0.000588448559
  error estimate for blocks of size 2^( 5) =       0.000597454761
  error estimate for blocks of size 2^( 6) =       0.000600996100
  error estimate for blocks of size 2^( 7) =       0.000603454614

      target function =                  N/A
              le_mean =     -22.438063787535
             les_mean =     504.038642292628
             stat err =       0.000597588508
             autocorr =       1.248783070284
              std dev =       0.756264533820
             le_variance =       0.571936045114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563537332660
                                         uncertainty =       0.004442444184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563537332660
                                         uncertainty =       0.004442444184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530836080
  error estimate for blocks of size 2^( 2) =       0.000551000331
  error estimate for blocks of size 2^( 3) =       0.000570357606
  error estimate for blocks of size 2^( 4) =       0.000584725877
  error estimate for blocks of size 2^( 5) =       0.000593992688
  error estimate for blocks of size 2^( 6) =       0.000597688529
  error estimate for blocks of size 2^( 7) =       0.000600266218

      target function =                  N/A
              le_mean =     -22.437226769455
             les_mean =     503.992718708980
             stat err =       0.000594168328
             autocorr =       1.252847268222
              std dev =       0.750715583164
             le_variance =       0.563573886806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560939973151
                                         uncertainty =       0.004418443175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560939973151
                                         uncertainty =       0.004418443175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529610831
  error estimate for blocks of size 2^( 2) =       0.000549801946
  error estimate for blocks of size 2^( 3) =       0.000569274688
  error estimate for blocks of size 2^( 4) =       0.000583736690
  error estimate for blocks of size 2^( 5) =       0.000593098233
  error estimate for blocks of size 2^( 6) =       0.000596795744
  error estimate for blocks of size 2^( 7) =       0.000599401746

      target function =                  N/A
              le_mean =     -22.437182831813
             les_mean =     503.988148411594
             stat err =       0.000593258103
             autocorr =       1.254797492003
              std dev =       0.748982819467
             le_variance =       0.560975263856


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437215885303        initial
            N/A            N/A                    N/A                    N/A     bad update
     9.7656e-03     9.7656e-02             3.6102e-02       -22.437226769455  <--
     3.9062e-02     3.9062e-01             7.4026e-03       -22.437182831813

*****************************************************************************
Applying the update for shift_i =   9.7656e-03     and shift_s =   9.7656e-02
*****************************************************************************

  Execution time = 6.4117e+01
  </log>
  <optVariables href="FORMN2GVP1B.s006.opt.xml">
 uu_0                 2.707365e-01 1 1  ON 0
 uu_1                 9.585762e-02 1 1  ON 1
 uu_2                -1.978463e-02 1 1  ON 2
 uu_3                -8.887828e-02 1 1  ON 3
 uu_4                -1.287230e-01 1 1  ON 4
 uu_5                -1.517119e-01 1 1  ON 5
 uu_6                -1.618886e-01 1 1  ON 6
 uu_7                -1.586428e-01 1 1  ON 7
 uu_8                -1.370780e-01 1 1  ON 8
 uu_9                -8.137390e-02 1 1  ON 9
 ud_0                 4.437835e-01 1 1  ON 10
 ud_1                 1.595567e-01 1 1  ON 11
 ud_2                 1.008666e-02 1 1  ON 12
 ud_3                -7.306970e-02 1 1  ON 13
 ud_4                -1.214039e-01 1 1  ON 14
 ud_5                -1.521155e-01 1 1  ON 15
 ud_6                -1.699931e-01 1 1  ON 16
 ud_7                -1.735230e-01 1 1  ON 17
 ud_8                -1.576528e-01 1 1  ON 18
 ud_9                -1.104415e-01 1 1  ON 19
 eC_0                -6.232998e-01 1 1  ON 20
 eC_1                -4.529964e-01 1 1  ON 21
 eC_2                -1.562502e-01 1 1  ON 22
 eC_3                 5.431503e-02 1 1  ON 23
 eC_4                 1.859807e-01 1 1  ON 24
 eC_5                 2.883055e-01 1 1  ON 25
 eC_6                 2.816320e-01 1 1  ON 26
 eC_7                 2.776192e-01 1 1  ON 27
 eC_8                 1.162422e-01 1 1  ON 28
 eC_9                 2.510472e-02 1 1  ON 29
 eO_0                -1.138880e+00 1 1  ON 30
 eO_1                -7.484699e-01 1 1  ON 31
 eO_2                -2.611756e-01 1 1  ON 32
 eO_3                 5.254884e-02 1 1  ON 33
 eO_4                 2.667604e-01 1 1  ON 34
 eO_5                 3.953522e-01 1 1  ON 35
 eO_6                 4.126891e-01 1 1  ON 36
 eO_7                 4.139924e-01 1 1  ON 37
 eO_8                 3.570829e-01 1 1  ON 38
 eO_9                 1.796403e-01 1 1  ON 39
eH1_0                -1.574374e-01 1 1  ON 40
eH1_1                -5.715277e-02 1 1  ON 41
eH1_2                -3.768090e-02 1 1  ON 42
eH1_3                -3.687533e-02 1 1  ON 43
eH1_4                 3.095698e-03 1 1  ON 44
eH1_5                 1.436197e-02 1 1  ON 45
eH1_6                 4.542410e-02 1 1  ON 46
eH1_7                 5.277561e-02 1 1  ON 47
eH1_8                 3.254761e-02 1 1  ON 48
eH1_9                 8.491477e-02 1 1  ON 49
eH2_0                -1.604965e-01 1 1  ON 50
eH2_1                -5.998311e-02 1 1  ON 51
eH2_2                -3.958682e-02 1 1  ON 52
eH2_3                -3.698000e-02 1 1  ON 53
eH2_4                 2.513235e-03 1 1  ON 54
eH2_5                 1.341409e-02 1 1  ON 55
eH2_6                 4.367855e-02 1 1  ON 56
eH2_7                 5.068786e-02 1 1  ON 57
eH2_8                 3.299228e-02 1 1  ON 58
eH2_9                 9.113104e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2674e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2453e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.3515
    reference variance = 0.492134
====================================================
  Execution time = 4.6085e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6082e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5674e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560901496751
                                         uncertainty =       0.003744318988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560901496751
                                         uncertainty =       0.003744318988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529539223
  error estimate for blocks of size 2^( 2) =       0.000549684888
  error estimate for blocks of size 2^( 3) =       0.000568647860
  error estimate for blocks of size 2^( 4) =       0.000582484302
  error estimate for blocks of size 2^( 5) =       0.000590862417
  error estimate for blocks of size 2^( 6) =       0.000593741270
  error estimate for blocks of size 2^( 7) =       0.000598258225

      target function =                  N/A
              le_mean =     -22.437692895705
             les_mean =     504.010885779817
             stat err =       0.000591336553
             autocorr =       1.247019322141
              std dev =       0.748881551554
             le_variance =       0.560823578258


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243769289571e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-03, overlap shift 2.4414e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437692895705       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437697432322       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437696248995       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437699009087       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437702145726       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437702293355       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437702425992       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437703058774       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437702006077       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437706139514       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437718313043       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437720136463       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437720078697       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437728691649       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437734753249       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437745136439       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.437751423120       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.437749583446       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.437750803305       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.437757072696       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.437757737324       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.437759960928       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.437759015840       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.437760453540       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.437761901553       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.437761597556       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.437763244316       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.437765857738       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.437764318234       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.437765840211       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.437766258725       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.437766084871       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.437767069676       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.437769398855       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.437771455069       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.437771018123       residual = 8.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-03 is 1.227564e-01

solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437692895705       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437697236546       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437696138784       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437698667832       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437701728761       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437701760149       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437701754878       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437702429255       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437701512460       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437705148398       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437714889617       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437715509782       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437714216176       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437718393662       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437720778027       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437724033549       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.437724928244       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.437722935548       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.437723471220       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.437724584044       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.437724342174       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.437724589514       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.437724001004       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.437724186870       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.437724365362       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.437724186101       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.437724573695       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.437725006089       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-03 is 2.702191e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437692895705       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437696597540       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437695804048       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437697606273       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437700338706       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437700112103       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437699772310       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437700392245       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437700106205       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437702173455       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437707237053       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437706099638       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437705275297       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437706195443       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437706541850       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437707040479       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.437706886889       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.437706359476       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.437706295867       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.437706510574       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 6.285115e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184626 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1798e+01
  </log>
  <optVariables href="FORMN2GVP1B.s007.opt.xml">
 uu_0                 2.695572e-01 1 1  ON 0
 uu_1                 9.478934e-02 1 1  ON 1
 uu_2                -2.125518e-02 1 1  ON 2
 uu_3                -9.071253e-02 1 1  ON 3
 uu_4                -1.313972e-01 1 1  ON 4
 uu_5                -1.549585e-01 1 1  ON 5
 uu_6                -1.657558e-01 1 1  ON 6
 uu_7                -1.624204e-01 1 1  ON 7
 uu_8                -1.409458e-01 1 1  ON 8
 uu_9                -8.656132e-02 1 1  ON 9
 ud_0                 4.477734e-01 1 1  ON 10
 ud_1                 1.634468e-01 1 1  ON 11
 ud_2                 1.397822e-02 1 1  ON 12
 ud_3                -6.932261e-02 1 1  ON 13
 ud_4                -1.180585e-01 1 1  ON 14
 ud_5                -1.495228e-01 1 1  ON 15
 ud_6                -1.682129e-01 1 1  ON 16
 ud_7                -1.729570e-01 1 1  ON 17
 ud_8                -1.607981e-01 1 1  ON 18
 ud_9                -1.185963e-01 1 1  ON 19
 eC_0                -6.327795e-01 1 1  ON 20
 eC_1                -4.621334e-01 1 1  ON 21
 eC_2                -1.634854e-01 1 1  ON 22
 eC_3                 4.840493e-02 1 1  ON 23
 eC_4                 1.788976e-01 1 1  ON 24
 eC_5                 2.855468e-01 1 1  ON 25
 eC_6                 2.894296e-01 1 1  ON 26
 eC_7                 2.886249e-01 1 1  ON 27
 eC_8                 1.351822e-01 1 1  ON 28
 eC_9                 3.009512e-02 1 1  ON 29
 eO_0                -1.154533e+00 1 1  ON 30
 eO_1                -7.634776e-01 1 1  ON 31
 eO_2                -2.757344e-01 1 1  ON 32
 eO_3                 4.150570e-02 1 1  ON 33
 eO_4                 2.589332e-01 1 1  ON 34
 eO_5                 3.900733e-01 1 1  ON 35
 eO_6                 4.144676e-01 1 1  ON 36
 eO_7                 4.207909e-01 1 1  ON 37
 eO_8                 3.800430e-01 1 1  ON 38
 eO_9                 2.066622e-01 1 1  ON 39
eH1_0                -1.592407e-01 1 1  ON 40
eH1_1                -5.889350e-02 1 1  ON 41
eH1_2                -3.809438e-02 1 1  ON 42
eH1_3                -3.648792e-02 1 1  ON 43
eH1_4                 1.783211e-03 1 1  ON 44
eH1_5                 1.519984e-02 1 1  ON 45
eH1_6                 4.703998e-02 1 1  ON 46
eH1_7                 5.138353e-02 1 1  ON 47
eH1_8                 2.929897e-02 1 1  ON 48
eH1_9                 8.372904e-02 1 1  ON 49
eH2_0                -1.634682e-01 1 1  ON 50
eH2_1                -6.145018e-02 1 1  ON 51
eH2_2                -4.072152e-02 1 1  ON 52
eH2_3                -3.888360e-02 1 1  ON 53
eH2_4                -5.088508e-04 1 1  ON 54
eH2_5                 1.311798e-02 1 1  ON 55
eH2_6                 4.379018e-02 1 1  ON 56
eH2_7                 5.139091e-02 1 1  ON 57
eH2_8                 3.091895e-02 1 1  ON 58
eH2_9                 9.358207e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.3925
    reference variance = 0.402918
====================================================
  Execution time = 4.5220e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6318e-01
  Total weights = 2.0000e+06
  Execution time = 3.9140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562159412654
                                         uncertainty =       0.004651104941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562159412654
                                         uncertainty =       0.004651104941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530477073
  error estimate for blocks of size 2^( 2) =       0.000550329171
  error estimate for blocks of size 2^( 3) =       0.000569115851
  error estimate for blocks of size 2^( 4) =       0.000582843306
  error estimate for blocks of size 2^( 5) =       0.000590660663
  error estimate for blocks of size 2^( 6) =       0.000597060040
  error estimate for blocks of size 2^( 7) =       0.000601814743

      target function =                  N/A
              le_mean =     -22.436962623692
             les_mean =     503.980103346538
             stat err =       0.000593094688
             autocorr =       1.250013866722
              std dev =       0.750207871857
             le_variance =       0.562811850996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563546226169
                                         uncertainty =       0.004682541339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563546226169
                                         uncertainty =       0.004682541339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531127703
  error estimate for blocks of size 2^( 2) =       0.000550942199
  error estimate for blocks of size 2^( 3) =       0.000569636035
  error estimate for blocks of size 2^( 4) =       0.000583273650
  error estimate for blocks of size 2^( 5) =       0.000590971725
  error estimate for blocks of size 2^( 6) =       0.000597278927
  error estimate for blocks of size 2^( 7) =       0.000602083927

      target function =                  N/A
              le_mean =     -22.436959530655
             les_mean =     503.981345972604
             stat err =       0.000593402057
             autocorr =       1.248246008250
              std dev =       0.751128001384
             le_variance =       0.564193274464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563042923471
                                         uncertainty =       0.004675233813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563042923471
                                         uncertainty =       0.004675233813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530890213
  error estimate for blocks of size 2^( 2) =       0.000550719513
  error estimate for blocks of size 2^( 3) =       0.000569441791
  error estimate for blocks of size 2^( 4) =       0.000583123558
  error estimate for blocks of size 2^( 5) =       0.000590860715
  error estimate for blocks of size 2^( 6) =       0.000597175056
  error estimate for blocks of size 2^( 7) =       0.000601980444

      target function =                  N/A
              le_mean =     -22.436947899202
             les_mean =     503.980319585569
             stat err =       0.000593284943
             autocorr =       1.248869947615
              std dev =       0.750792138948
             le_variance =       0.563688835906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562103410040
                                         uncertainty =       0.004654868496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562103410040
                                         uncertainty =       0.004654868496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530449400
  error estimate for blocks of size 2^( 2) =       0.000550295656
  error estimate for blocks of size 2^( 3) =       0.000569070566
  error estimate for blocks of size 2^( 4) =       0.000582798290
  error estimate for blocks of size 2^( 5) =       0.000590600569
  error estimate for blocks of size 2^( 6) =       0.000596974418
  error estimate for blocks of size 2^( 7) =       0.000601746449

      target function =                  N/A
              le_mean =     -22.436943679567
             les_mean =     503.979194531401
             stat err =       0.000593029932
             autocorr =       1.249871317383
              std dev =       0.750168736157
             le_variance =       0.562753132707


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436962623692        initial  <--
     2.4414e-03     2.4414e-02             1.2276e-01       -22.436959530655
     9.7656e-03     9.7656e-02             2.7022e-02       -22.436947899202
     3.9062e-02     3.9062e-01             6.2851e-03       -22.436943679567

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.5009
  </log>
  <optVariables href="FORMN2GVP1B.s007.opt.xml">
 uu_0                 2.707365e-01 1 1  ON 0
 uu_1                 9.585762e-02 1 1  ON 1
 uu_2                -1.978463e-02 1 1  ON 2
 uu_3                -8.887828e-02 1 1  ON 3
 uu_4                -1.287230e-01 1 1  ON 4
 uu_5                -1.517119e-01 1 1  ON 5
 uu_6                -1.618886e-01 1 1  ON 6
 uu_7                -1.586428e-01 1 1  ON 7
 uu_8                -1.370780e-01 1 1  ON 8
 uu_9                -8.137390e-02 1 1  ON 9
 ud_0                 4.437835e-01 1 1  ON 10
 ud_1                 1.595567e-01 1 1  ON 11
 ud_2                 1.008666e-02 1 1  ON 12
 ud_3                -7.306970e-02 1 1  ON 13
 ud_4                -1.214039e-01 1 1  ON 14
 ud_5                -1.521155e-01 1 1  ON 15
 ud_6                -1.699931e-01 1 1  ON 16
 ud_7                -1.735230e-01 1 1  ON 17
 ud_8                -1.576528e-01 1 1  ON 18
 ud_9                -1.104415e-01 1 1  ON 19
 eC_0                -6.232998e-01 1 1  ON 20
 eC_1                -4.529964e-01 1 1  ON 21
 eC_2                -1.562502e-01 1 1  ON 22
 eC_3                 5.431503e-02 1 1  ON 23
 eC_4                 1.859807e-01 1 1  ON 24
 eC_5                 2.883055e-01 1 1  ON 25
 eC_6                 2.816320e-01 1 1  ON 26
 eC_7                 2.776192e-01 1 1  ON 27
 eC_8                 1.162422e-01 1 1  ON 28
 eC_9                 2.510472e-02 1 1  ON 29
 eO_0                -1.138880e+00 1 1  ON 30
 eO_1                -7.484699e-01 1 1  ON 31
 eO_2                -2.611756e-01 1 1  ON 32
 eO_3                 5.254884e-02 1 1  ON 33
 eO_4                 2.667604e-01 1 1  ON 34
 eO_5                 3.953522e-01 1 1  ON 35
 eO_6                 4.126891e-01 1 1  ON 36
 eO_7                 4.139924e-01 1 1  ON 37
 eO_8                 3.570829e-01 1 1  ON 38
 eO_9                 1.796403e-01 1 1  ON 39
eH1_0                -1.574374e-01 1 1  ON 40
eH1_1                -5.715277e-02 1 1  ON 41
eH1_2                -3.768090e-02 1 1  ON 42
eH1_3                -3.687533e-02 1 1  ON 43
eH1_4                 3.095698e-03 1 1  ON 44
eH1_5                 1.436197e-02 1 1  ON 45
eH1_6                 4.542410e-02 1 1  ON 46
eH1_7                 5.277561e-02 1 1  ON 47
eH1_8                 3.254761e-02 1 1  ON 48
eH1_9                 8.491477e-02 1 1  ON 49
eH2_0                -1.604965e-01 1 1  ON 50
eH2_1                -5.998311e-02 1 1  ON 51
eH2_2                -3.958682e-02 1 1  ON 52
eH2_3                -3.698000e-02 1 1  ON 53
eH2_4                 2.513235e-03 1 1  ON 54
eH2_5                 1.341409e-02 1 1  ON 55
eH2_6                 4.367855e-02 1 1  ON 56
eH2_7                 5.068786e-02 1 1  ON 57
eH2_8                 3.299228e-02 1 1  ON 58
eH2_9                 9.113104e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2631e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2443e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.3337
    reference variance = 0.372494
====================================================
  Execution time = 4.5477e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.5487e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5305e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554268129142
                                         uncertainty =       0.003139968444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554268129142
                                         uncertainty =       0.003139968444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526722675
  error estimate for blocks of size 2^( 2) =       0.000546650833
  error estimate for blocks of size 2^( 3) =       0.000565115377
  error estimate for blocks of size 2^( 4) =       0.000578715548
  error estimate for blocks of size 2^( 5) =       0.000588095037
  error estimate for blocks of size 2^( 6) =       0.000594107457
  error estimate for blocks of size 2^( 7) =       0.000597173028

      target function =                  N/A
              le_mean =     -22.438110767160
             les_mean =     504.023688073921
             stat err =       0.000589522768
             autocorr =       1.252671323564
              std dev =       0.744898350117
             le_variance =       0.554873552007


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243811076716e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438110767160       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438114965401       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438118592389       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438113785449       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438113974021       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438114891246       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438113390353       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438112940304       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438113685745       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438117188113       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.438119311299       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.438122265093       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.438121227508       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.438123387010       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.438126749858       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.438126015125       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.438126125357       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.438126152537       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.438126017865       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.438126171154       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.438125746255       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-02 is 1.070340e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438110767160       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438113925880       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438116426814       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438113446061       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438113153820       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438114525828       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438113565114       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438113418186       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438113738657       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438115329558       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.438115516621       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.438116451709       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.438115971025       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.438116101927       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.438116395766       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.438116418699       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 2.584007e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438110767160       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438112354109       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438113526539       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438112539599       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438112182009       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438113125620       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438112592628       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438112617594       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438112731315       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438112837984       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.438112862616       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.438113006446       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.438112952980       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 6.368090e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194847 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0795e+01
  </log>
  <optVariables href="FORMN2GVP1B.s008.opt.xml">
 uu_0                 2.706506e-01 1 1  ON 0
 uu_1                 9.580001e-02 1 1  ON 1
 uu_2                -1.975544e-02 1 1  ON 2
 uu_3                -8.867850e-02 1 1  ON 3
 uu_4                -1.288320e-01 1 1  ON 4
 uu_5                -1.521556e-01 1 1  ON 5
 uu_6                -1.625718e-01 1 1  ON 6
 uu_7                -1.587828e-01 1 1  ON 7
 uu_8                -1.370816e-01 1 1  ON 8
 uu_9                -8.214591e-02 1 1  ON 9
 ud_0                 4.436077e-01 1 1  ON 10
 ud_1                 1.595230e-01 1 1  ON 11
 ud_2                 1.011301e-02 1 1  ON 12
 ud_3                -7.304825e-02 1 1  ON 13
 ud_4                -1.212710e-01 1 1  ON 14
 ud_5                -1.520475e-01 1 1  ON 15
 ud_6                -1.696767e-01 1 1  ON 16
 ud_7                -1.732027e-01 1 1  ON 17
 ud_8                -1.576414e-01 1 1  ON 18
 ud_9                -1.108319e-01 1 1  ON 19
 eC_0                -6.251210e-01 1 1  ON 20
 eC_1                -4.537946e-01 1 1  ON 21
 eC_2                -1.565003e-01 1 1  ON 22
 eC_3                 5.422646e-02 1 1  ON 23
 eC_4                 1.846255e-01 1 1  ON 24
 eC_5                 2.880921e-01 1 1  ON 25
 eC_6                 2.824960e-01 1 1  ON 26
 eC_7                 2.791144e-01 1 1  ON 27
 eC_8                 1.180274e-01 1 1  ON 28
 eC_9                 2.549147e-02 1 1  ON 29
 eO_0                -1.139857e+00 1 1  ON 30
 eO_1                -7.496916e-01 1 1  ON 31
 eO_2                -2.629825e-01 1 1  ON 32
 eO_3                 5.128973e-02 1 1  ON 33
 eO_4                 2.658930e-01 1 1  ON 34
 eO_5                 3.946021e-01 1 1  ON 35
 eO_6                 4.129710e-01 1 1  ON 36
 eO_7                 4.147280e-01 1 1  ON 37
 eO_8                 3.594405e-01 1 1  ON 38
 eO_9                 1.822243e-01 1 1  ON 39
eH1_0                -1.581715e-01 1 1  ON 40
eH1_1                -5.809672e-02 1 1  ON 41
eH1_2                -3.772531e-02 1 1  ON 42
eH1_3                -3.619343e-02 1 1  ON 43
eH1_4                 2.761239e-03 1 1  ON 44
eH1_5                 1.480234e-02 1 1  ON 45
eH1_6                 4.560835e-02 1 1  ON 46
eH1_7                 5.281055e-02 1 1  ON 47
eH1_8                 3.198023e-02 1 1  ON 48
eH1_9                 8.529870e-02 1 1  ON 49
eH2_0                -1.609224e-01 1 1  ON 50
eH2_1                -5.986726e-02 1 1  ON 51
eH2_2                -3.871241e-02 1 1  ON 52
eH2_3                -3.744332e-02 1 1  ON 53
eH2_4                 1.089866e-03 1 1  ON 54
eH2_5                 1.300703e-02 1 1  ON 55
eH2_6                 4.338824e-02 1 1  ON 56
eH2_7                 5.116341e-02 1 1  ON 57
eH2_8                 3.358731e-02 1 1  ON 58
eH2_9                 9.119078e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.4654
    reference variance = 0.412617
====================================================
  Execution time = 4.6480e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6297e-01
  Total weights = 2.0000e+06
  Execution time = 3.8307e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563465075995
                                         uncertainty =       0.006730229716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563465075995
                                         uncertainty =       0.006730229716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530818646
  error estimate for blocks of size 2^( 2) =       0.000550223485
  error estimate for blocks of size 2^( 3) =       0.000567978906
  error estimate for blocks of size 2^( 4) =       0.000580988913
  error estimate for blocks of size 2^( 5) =       0.000590025120
  error estimate for blocks of size 2^( 6) =       0.000593744813
  error estimate for blocks of size 2^( 7) =       0.000593763936

      target function =                  N/A
              le_mean =     -22.437119334549
             les_mean =     503.987860621706
             stat err =       0.000589630696
             autocorr =       1.233865520773
              std dev =       0.750690928865
             le_variance =       0.563536870679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562770518790
                                         uncertainty =       0.006713208242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562770518790
                                         uncertainty =       0.006713208242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530491508
  error estimate for blocks of size 2^( 2) =       0.000549910364
  error estimate for blocks of size 2^( 3) =       0.000567681256
  error estimate for blocks of size 2^( 4) =       0.000580702053
  error estimate for blocks of size 2^( 5) =       0.000589744871
  error estimate for blocks of size 2^( 6) =       0.000593445073
  error estimate for blocks of size 2^( 7) =       0.000593490817

      target function =                  N/A
              le_mean =     -22.437114821897
             les_mean =     503.986963728646
             stat err =       0.000589345703
             autocorr =       1.234193832221
              std dev =       0.750228284656
             le_variance =       0.562842479098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562369395513
                                         uncertainty =       0.006712075135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562369395513
                                         uncertainty =       0.006712075135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530302504
  error estimate for blocks of size 2^( 2) =       0.000549734321
  error estimate for blocks of size 2^( 3) =       0.000567523649
  error estimate for blocks of size 2^( 4) =       0.000580563307
  error estimate for blocks of size 2^( 5) =       0.000589621756
  error estimate for blocks of size 2^( 6) =       0.000593326898
  error estimate for blocks of size 2^( 7) =       0.000593399604

      target function =                  N/A
              le_mean =     -22.437120364259
             les_mean =     503.986811451333
             stat err =       0.000589227891
             autocorr =       1.234579996129
              std dev =       0.749960993858
             le_variance =       0.562441492308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563155804107
                                         uncertainty =       0.006726307447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563155804107
                                         uncertainty =       0.006726307447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530673017
  error estimate for blocks of size 2^( 2) =       0.000550084212
  error estimate for blocks of size 2^( 3) =       0.000567847960
  error estimate for blocks of size 2^( 4) =       0.000580865516
  error estimate for blocks of size 2^( 5) =       0.000589907792
  error estimate for blocks of size 2^( 6) =       0.000593626190
  error estimate for blocks of size 2^( 7) =       0.000593658881

      target function =                  N/A
              le_mean =     -22.437115913416
             les_mean =     503.987397931595
             stat err =       0.000589514595
             autocorr =       1.234056693060
              std dev =       0.750484977298
             le_variance =       0.563227701149


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437119334549        initial
     2.4414e-02     2.4414e-01             1.0703e-02       -22.437114821897
     9.7656e-02     9.7656e-01             2.5840e-03       -22.437120364259  <--
     3.9062e-01     3.9062e+00             6.3681e-04       -22.437115913416

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 6.5819e+01
  </log>
  <optVariables href="FORMN2GVP1B.s008.opt.xml">
 uu_0                 2.706506e-01 1 1  ON 0
 uu_1                 9.580001e-02 1 1  ON 1
 uu_2                -1.975544e-02 1 1  ON 2
 uu_3                -8.867850e-02 1 1  ON 3
 uu_4                -1.288320e-01 1 1  ON 4
 uu_5                -1.521556e-01 1 1  ON 5
 uu_6                -1.625718e-01 1 1  ON 6
 uu_7                -1.587828e-01 1 1  ON 7
 uu_8                -1.370816e-01 1 1  ON 8
 uu_9                -8.214591e-02 1 1  ON 9
 ud_0                 4.436077e-01 1 1  ON 10
 ud_1                 1.595230e-01 1 1  ON 11
 ud_2                 1.011301e-02 1 1  ON 12
 ud_3                -7.304825e-02 1 1  ON 13
 ud_4                -1.212710e-01 1 1  ON 14
 ud_5                -1.520475e-01 1 1  ON 15
 ud_6                -1.696767e-01 1 1  ON 16
 ud_7                -1.732027e-01 1 1  ON 17
 ud_8                -1.576414e-01 1 1  ON 18
 ud_9                -1.108319e-01 1 1  ON 19
 eC_0                -6.251210e-01 1 1  ON 20
 eC_1                -4.537946e-01 1 1  ON 21
 eC_2                -1.565003e-01 1 1  ON 22
 eC_3                 5.422646e-02 1 1  ON 23
 eC_4                 1.846255e-01 1 1  ON 24
 eC_5                 2.880921e-01 1 1  ON 25
 eC_6                 2.824960e-01 1 1  ON 26
 eC_7                 2.791144e-01 1 1  ON 27
 eC_8                 1.180274e-01 1 1  ON 28
 eC_9                 2.549147e-02 1 1  ON 29
 eO_0                -1.139857e+00 1 1  ON 30
 eO_1                -7.496916e-01 1 1  ON 31
 eO_2                -2.629825e-01 1 1  ON 32
 eO_3                 5.128973e-02 1 1  ON 33
 eO_4                 2.658930e-01 1 1  ON 34
 eO_5                 3.946021e-01 1 1  ON 35
 eO_6                 4.129710e-01 1 1  ON 36
 eO_7                 4.147280e-01 1 1  ON 37
 eO_8                 3.594405e-01 1 1  ON 38
 eO_9                 1.822243e-01 1 1  ON 39
eH1_0                -1.581715e-01 1 1  ON 40
eH1_1                -5.809672e-02 1 1  ON 41
eH1_2                -3.772531e-02 1 1  ON 42
eH1_3                -3.619343e-02 1 1  ON 43
eH1_4                 2.761239e-03 1 1  ON 44
eH1_5                 1.480234e-02 1 1  ON 45
eH1_6                 4.560835e-02 1 1  ON 46
eH1_7                 5.281055e-02 1 1  ON 47
eH1_8                 3.198023e-02 1 1  ON 48
eH1_9                 8.529870e-02 1 1  ON 49
eH2_0                -1.609224e-01 1 1  ON 50
eH2_1                -5.986726e-02 1 1  ON 51
eH2_2                -3.871241e-02 1 1  ON 52
eH2_3                -3.744332e-02 1 1  ON 53
eH2_4                 1.089866e-03 1 1  ON 54
eH2_5                 1.300703e-02 1 1  ON 55
eH2_6                 4.338824e-02 1 1  ON 56
eH2_7                 5.116341e-02 1 1  ON 57
eH2_8                 3.358731e-02 1 1  ON 58
eH2_9                 9.119078e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2662e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2438e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.4172
    reference variance = 0.433462
====================================================
  Execution time = 4.5866e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6231e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5418e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562157307320
                                         uncertainty =       0.006184246511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562157307320
                                         uncertainty =       0.006184246511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530240253
  error estimate for blocks of size 2^( 2) =       0.000550368903
  error estimate for blocks of size 2^( 3) =       0.000568723823
  error estimate for blocks of size 2^( 4) =       0.000582627695
  error estimate for blocks of size 2^( 5) =       0.000592040476
  error estimate for blocks of size 2^( 6) =       0.000597406701
  error estimate for blocks of size 2^( 7) =       0.000601933037

      target function =                  N/A
              le_mean =     -22.437352277978
             les_mean =     503.997086417218
             stat err =       0.000593501977
             autocorr =       1.252849639183
              std dev =       0.749872957427
             le_variance =       0.562309452280


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243735227798e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437352277978       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437355119085       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437357683265       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437358118082       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437362246830       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437362640414       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437363802009       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437365187638       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437369612847       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437370923711       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437373800372       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437373777860       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437373853505       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437372588951       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437373845018       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437373002081       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.437373038732       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.437373968073       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.437374780094       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.437374769855       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.437374800038       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.437374736628       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-02 is 1.158658e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437352277978       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437354386594       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437356590609       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437356831404       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437359320025       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437359679330       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437360075541       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437360644274       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437362183204       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437362065485       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437362660548       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437362500995       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437362200159       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437362159013       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437362177423       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437361963847       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.437362029843       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 2.929066e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437352277978       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437353316052       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437354720363       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437354864515       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437355713099       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437355912955       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437356129585       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437356010868       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437356265303       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437356104961       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437356233836       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437356185524       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437356232693       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 7.330691e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206029 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1299e+01
  </log>
  <optVariables href="FORMN2GVP1B.s009.opt.xml">
 uu_0                 2.700652e-01 1 1  ON 0
 uu_1                 9.574315e-02 1 1  ON 1
 uu_2                -1.961044e-02 1 1  ON 2
 uu_3                -8.869759e-02 1 1  ON 3
 uu_4                -1.287385e-01 1 1  ON 4
 uu_5                -1.522575e-01 1 1  ON 5
 uu_6                -1.624852e-01 1 1  ON 6
 uu_7                -1.590355e-01 1 1  ON 7
 uu_8                -1.377311e-01 1 1  ON 8
 uu_9                -8.335542e-02 1 1  ON 9
 ud_0                 4.434418e-01 1 1  ON 10
 ud_1                 1.595332e-01 1 1  ON 11
 ud_2                 9.939266e-03 1 1  ON 12
 ud_3                -7.320712e-02 1 1  ON 13
 ud_4                -1.212867e-01 1 1  ON 14
 ud_5                -1.519799e-01 1 1  ON 15
 ud_6                -1.695138e-01 1 1  ON 16
 ud_7                -1.729927e-01 1 1  ON 17
 ud_8                -1.574968e-01 1 1  ON 18
 ud_9                -1.112279e-01 1 1  ON 19
 eC_0                -6.255035e-01 1 1  ON 20
 eC_1                -4.544119e-01 1 1  ON 21
 eC_2                -1.565826e-01 1 1  ON 22
 eC_3                 5.350957e-02 1 1  ON 23
 eC_4                 1.837266e-01 1 1  ON 24
 eC_5                 2.871543e-01 1 1  ON 25
 eC_6                 2.828146e-01 1 1  ON 26
 eC_7                 2.801850e-01 1 1  ON 27
 eC_8                 1.197560e-01 1 1  ON 28
 eC_9                 2.598565e-02 1 1  ON 29
 eO_0                -1.141209e+00 1 1  ON 30
 eO_1                -7.509150e-01 1 1  ON 31
 eO_2                -2.642132e-01 1 1  ON 32
 eO_3                 5.079790e-02 1 1  ON 33
 eO_4                 2.646101e-01 1 1  ON 34
 eO_5                 3.932944e-01 1 1  ON 35
 eO_6                 4.129946e-01 1 1  ON 36
 eO_7                 4.152575e-01 1 1  ON 37
 eO_8                 3.623696e-01 1 1  ON 38
 eO_9                 1.847637e-01 1 1  ON 39
eH1_0                -1.592508e-01 1 1  ON 40
eH1_1                -5.847413e-02 1 1  ON 41
eH1_2                -3.757306e-02 1 1  ON 42
eH1_3                -3.574951e-02 1 1  ON 43
eH1_4                 2.746696e-03 1 1  ON 44
eH1_5                 1.500978e-02 1 1  ON 45
eH1_6                 4.562624e-02 1 1  ON 46
eH1_7                 5.233413e-02 1 1  ON 47
eH1_8                 3.167417e-02 1 1  ON 48
eH1_9                 8.558298e-02 1 1  ON 49
eH2_0                -1.607765e-01 1 1  ON 50
eH2_1                -5.982749e-02 1 1  ON 51
eH2_2                -3.836621e-02 1 1  ON 52
eH2_3                -3.711274e-02 1 1  ON 53
eH2_4                 1.479333e-03 1 1  ON 54
eH2_5                 1.346792e-02 1 1  ON 55
eH2_6                 4.349293e-02 1 1  ON 56
eH2_7                 4.945924e-02 1 1  ON 57
eH2_8                 3.265173e-02 1 1  ON 58
eH2_9                 9.107874e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.4702
    reference variance = 0.470157
====================================================
  Execution time = 4.4973e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.5906e-01
  Total weights = 2.0000e+06
  Execution time = 3.8380e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559260272406
                                         uncertainty =       0.004340548174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559260272406
                                         uncertainty =       0.004340548174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528828156
  error estimate for blocks of size 2^( 2) =       0.000549070504
  error estimate for blocks of size 2^( 3) =       0.000567844201
  error estimate for blocks of size 2^( 4) =       0.000581815339
  error estimate for blocks of size 2^( 5) =       0.000592214895
  error estimate for blocks of size 2^( 6) =       0.000598252559
  error estimate for blocks of size 2^( 7) =       0.000599393449

      target function =                  N/A
              le_mean =     -22.437532658343
             les_mean =     504.002189952358
             stat err =       0.000592919061
             autocorr =       1.257076429455
              std dev =       0.747875950829
             le_variance =       0.559318437829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558941256849
                                         uncertainty =       0.004338841982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558941256849
                                         uncertainty =       0.004338841982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528677181
  error estimate for blocks of size 2^( 2) =       0.000548905835
  error estimate for blocks of size 2^( 3) =       0.000567677801
  error estimate for blocks of size 2^( 4) =       0.000581646170
  error estimate for blocks of size 2^( 5) =       0.000592047223
  error estimate for blocks of size 2^( 6) =       0.000598065701
  error estimate for blocks of size 2^( 7) =       0.000599233317

      target function =                  N/A
              le_mean =     -22.437540833594
             les_mean =     504.002237502444
             stat err =       0.000592748103
             autocorr =       1.257069282562
              std dev =       0.747662439037
             le_variance =       0.558999122747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558765684779
                                         uncertainty =       0.004337861580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558765684779
                                         uncertainty =       0.004337861580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528594206
  error estimate for blocks of size 2^( 2) =       0.000548826225
  error estimate for blocks of size 2^( 3) =       0.000567607983
  error estimate for blocks of size 2^( 4) =       0.000581584066
  error estimate for blocks of size 2^( 5) =       0.000591989746
  error estimate for blocks of size 2^( 6) =       0.000598011329
  error estimate for blocks of size 2^( 7) =       0.000599169681

      target function =                  N/A
              le_mean =     -22.437540885719
             les_mean =     504.002064388036
             stat err =       0.000592688706
             autocorr =       1.257211966318
              std dev =       0.747545095042
             le_variance =       0.558823669121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559091844015
                                         uncertainty =       0.004339463081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559091844015
                                         uncertainty =       0.004339463081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528748517
  error estimate for blocks of size 2^( 2) =       0.000548989391
  error estimate for blocks of size 2^( 3) =       0.000567766118
  error estimate for blocks of size 2^( 4) =       0.000581738529
  error estimate for blocks of size 2^( 5) =       0.000592138999
  error estimate for blocks of size 2^( 6) =       0.000598173314
  error estimate for blocks of size 2^( 7) =       0.000599316794

      target function =                  N/A
              le_mean =     -22.437532389678
             les_mean =     504.002009447042
             stat err =       0.000592841909
             autocorr =       1.257127912236
              std dev =       0.747763324029
             le_variance =       0.559149988764


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437532658343        initial
     2.4414e-02     2.4414e-01             1.1587e-02       -22.437540833594
     9.7656e-02     9.7656e-01             2.9291e-03       -22.437540885719  <--
     3.9062e-01     3.9062e+00             7.3307e-04       -22.437532389678

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 6.4196e+01
  </log>
  <optVariables href="FORMN2GVP1B.s009.opt.xml">
 uu_0                 2.700652e-01 1 1  ON 0
 uu_1                 9.574315e-02 1 1  ON 1
 uu_2                -1.961044e-02 1 1  ON 2
 uu_3                -8.869759e-02 1 1  ON 3
 uu_4                -1.287385e-01 1 1  ON 4
 uu_5                -1.522575e-01 1 1  ON 5
 uu_6                -1.624852e-01 1 1  ON 6
 uu_7                -1.590355e-01 1 1  ON 7
 uu_8                -1.377311e-01 1 1  ON 8
 uu_9                -8.335542e-02 1 1  ON 9
 ud_0                 4.434418e-01 1 1  ON 10
 ud_1                 1.595332e-01 1 1  ON 11
 ud_2                 9.939266e-03 1 1  ON 12
 ud_3                -7.320712e-02 1 1  ON 13
 ud_4                -1.212867e-01 1 1  ON 14
 ud_5                -1.519799e-01 1 1  ON 15
 ud_6                -1.695138e-01 1 1  ON 16
 ud_7                -1.729927e-01 1 1  ON 17
 ud_8                -1.574968e-01 1 1  ON 18
 ud_9                -1.112279e-01 1 1  ON 19
 eC_0                -6.255035e-01 1 1  ON 20
 eC_1                -4.544119e-01 1 1  ON 21
 eC_2                -1.565826e-01 1 1  ON 22
 eC_3                 5.350957e-02 1 1  ON 23
 eC_4                 1.837266e-01 1 1  ON 24
 eC_5                 2.871543e-01 1 1  ON 25
 eC_6                 2.828146e-01 1 1  ON 26
 eC_7                 2.801850e-01 1 1  ON 27
 eC_8                 1.197560e-01 1 1  ON 28
 eC_9                 2.598565e-02 1 1  ON 29
 eO_0                -1.141209e+00 1 1  ON 30
 eO_1                -7.509150e-01 1 1  ON 31
 eO_2                -2.642132e-01 1 1  ON 32
 eO_3                 5.079790e-02 1 1  ON 33
 eO_4                 2.646101e-01 1 1  ON 34
 eO_5                 3.932944e-01 1 1  ON 35
 eO_6                 4.129946e-01 1 1  ON 36
 eO_7                 4.152575e-01 1 1  ON 37
 eO_8                 3.623696e-01 1 1  ON 38
 eO_9                 1.847637e-01 1 1  ON 39
eH1_0                -1.592508e-01 1 1  ON 40
eH1_1                -5.847413e-02 1 1  ON 41
eH1_2                -3.757306e-02 1 1  ON 42
eH1_3                -3.574951e-02 1 1  ON 43
eH1_4                 2.746696e-03 1 1  ON 44
eH1_5                 1.500978e-02 1 1  ON 45
eH1_6                 4.562624e-02 1 1  ON 46
eH1_7                 5.233413e-02 1 1  ON 47
eH1_8                 3.167417e-02 1 1  ON 48
eH1_9                 8.558298e-02 1 1  ON 49
eH2_0                -1.607765e-01 1 1  ON 50
eH2_1                -5.982749e-02 1 1  ON 51
eH2_2                -3.836621e-02 1 1  ON 52
eH2_3                -3.711274e-02 1 1  ON 53
eH2_4                 1.479333e-03 1 1  ON 54
eH2_5                 1.346792e-02 1 1  ON 55
eH2_6                 4.349293e-02 1 1  ON 56
eH2_7                 4.945924e-02 1 1  ON 57
eH2_8                 3.265173e-02 1 1  ON 58
eH2_9                 9.107874e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2550e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.4395
    reference variance = 0.435349
====================================================
  Execution time = 4.7260e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5224e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5256e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.552058831910
                                         uncertainty =       0.003775932372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.552058831910
                                         uncertainty =       0.003775932372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000525469325
  error estimate for blocks of size 2^( 2) =       0.000545097819
  error estimate for blocks of size 2^( 3) =       0.000563368916
  error estimate for blocks of size 2^( 4) =       0.000577677927
  error estimate for blocks of size 2^( 5) =       0.000586274757
  error estimate for blocks of size 2^( 6) =       0.000591535601
  error estimate for blocks of size 2^( 7) =       0.000595761154

      target function =                  N/A
              le_mean =     -22.436834280424
             les_mean =     503.963768274347
             stat err =       0.000587812360
             autocorr =       1.251361215233
              std dev =       0.743125846175
             le_variance =       0.552236023253


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243683428042e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436834280424       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436836311116       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436841341266       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436845198898       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436845604289       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436844621338       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436843351318       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436841404301       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436842060540       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436843445885       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436846533853       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436847690434       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436850921374       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436850103795       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436848791986       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436849471952       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436849520876       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436851562421       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436851130606       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436851579948       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.436851997528       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-02 is 1.129228e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436834280424       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436835683979       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436838924344       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436841767190       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436842409731       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436841044806       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436839842181       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436838982002       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436839066570       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436839563305       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436841329993       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436841510898       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436841659003       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436841491641       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436841521731       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436841470843       residual = 6.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 2.742628e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436834280424       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436834908324       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436836174564       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436837827267       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436838215280       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436837492482       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436836382625       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436836387146       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436836484636       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436836440753       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436836821353       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436836832732       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436836869721       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 6.808224e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216177 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2530e+01
  </log>
  <optVariables href="FORMN2GVP1B.s010.opt.xml">
 uu_0                 2.704077e-01 1 1  ON 0
 uu_1                 9.607127e-02 1 1  ON 1
 uu_2                -1.950132e-02 1 1  ON 2
 uu_3                -8.884037e-02 1 1  ON 3
 uu_4                -1.290058e-01 1 1  ON 4
 uu_5                -1.524259e-01 1 1  ON 5
 uu_6                -1.631038e-01 1 1  ON 6
 uu_7                -1.596747e-01 1 1  ON 7
 uu_8                -1.383713e-01 1 1  ON 8
 uu_9                -8.430576e-02 1 1  ON 9
 ud_0                 4.436743e-01 1 1  ON 10
 ud_1                 1.595886e-01 1 1  ON 11
 ud_2                 1.005530e-02 1 1  ON 12
 ud_3                -7.306807e-02 1 1  ON 13
 ud_4                -1.211618e-01 1 1  ON 14
 ud_5                -1.517720e-01 1 1  ON 15
 ud_6                -1.694770e-01 1 1  ON 16
 ud_7                -1.730600e-01 1 1  ON 17
 ud_8                -1.580088e-01 1 1  ON 18
 ud_9                -1.118310e-01 1 1  ON 19
 eC_0                -6.263055e-01 1 1  ON 20
 eC_1                -4.545011e-01 1 1  ON 21
 eC_2                -1.572204e-01 1 1  ON 22
 eC_3                 5.324108e-02 1 1  ON 23
 eC_4                 1.829183e-01 1 1  ON 24
 eC_5                 2.867024e-01 1 1  ON 25
 eC_6                 2.827101e-01 1 1  ON 26
 eC_7                 2.812633e-01 1 1  ON 27
 eC_8                 1.214493e-01 1 1  ON 28
 eC_9                 2.634914e-02 1 1  ON 29
 eO_0                -1.143059e+00 1 1  ON 30
 eO_1                -7.529773e-01 1 1  ON 31
 eO_2                -2.656390e-01 1 1  ON 32
 eO_3                 5.008264e-02 1 1  ON 33
 eO_4                 2.643980e-01 1 1  ON 34
 eO_5                 3.932073e-01 1 1  ON 35
 eO_6                 4.133984e-01 1 1  ON 36
 eO_7                 4.152280e-01 1 1  ON 37
 eO_8                 3.644504e-01 1 1  ON 38
 eO_9                 1.875063e-01 1 1  ON 39
eH1_0                -1.585591e-01 1 1  ON 40
eH1_1                -5.819131e-02 1 1  ON 41
eH1_2                -3.732015e-02 1 1  ON 42
eH1_3                -3.626575e-02 1 1  ON 43
eH1_4                 2.107694e-03 1 1  ON 44
eH1_5                 1.470710e-02 1 1  ON 45
eH1_6                 4.523338e-02 1 1  ON 46
eH1_7                 5.232822e-02 1 1  ON 47
eH1_8                 3.187207e-02 1 1  ON 48
eH1_9                 8.530492e-02 1 1  ON 49
eH2_0                -1.603092e-01 1 1  ON 50
eH2_1                -5.878975e-02 1 1  ON 51
eH2_2                -3.876734e-02 1 1  ON 52
eH2_3                -3.735857e-02 1 1  ON 53
eH2_4                 8.367654e-04 1 1  ON 54
eH2_5                 1.350080e-02 1 1  ON 55
eH2_6                 4.415832e-02 1 1  ON 56
eH2_7                 4.883207e-02 1 1  ON 57
eH2_8                 3.150804e-02 1 1  ON 58
eH2_9                 9.102494e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.4893
    reference variance = 0.579504
====================================================
  Execution time = 4.4815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.5758e-01
  Total weights = 2.0000e+06
  Execution time = 3.8385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557364851594
                                         uncertainty =       0.003472292480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557364851594
                                         uncertainty =       0.003472292480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527859343
  error estimate for blocks of size 2^( 2) =       0.000547645278
  error estimate for blocks of size 2^( 3) =       0.000566416941
  error estimate for blocks of size 2^( 4) =       0.000580354153
  error estimate for blocks of size 2^( 5) =       0.000588563663
  error estimate for blocks of size 2^( 6) =       0.000592862965
  error estimate for blocks of size 2^( 7) =       0.000595234318

      target function =                  N/A
              le_mean =     -22.437828108843
             les_mean =     504.013400934495
             stat err =       0.000589253775
             autocorr =       1.246144260101
              std dev =       0.746505841332
             le_variance =       0.557270971144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557965211331
                                         uncertainty =       0.003480269599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557965211331
                                         uncertainty =       0.003480269599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528143805
  error estimate for blocks of size 2^( 2) =       0.000547906612
  error estimate for blocks of size 2^( 3) =       0.000566639203
  error estimate for blocks of size 2^( 4) =       0.000580540555
  error estimate for blocks of size 2^( 5) =       0.000588719245
  error estimate for blocks of size 2^( 6) =       0.000593018351
  error estimate for blocks of size 2^( 7) =       0.000595385411

      target function =                  N/A
              le_mean =     -22.437828495912
             les_mean =     504.014019091139
             stat err =       0.000589415891
             autocorr =       1.245487290077
              std dev =       0.746908132317
             le_variance =       0.557871758121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558017145159
                                         uncertainty =       0.003481461164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558017145159
                                         uncertainty =       0.003481461164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528168362
  error estimate for blocks of size 2^( 2) =       0.000547930354
  error estimate for blocks of size 2^( 3) =       0.000566665518
  error estimate for blocks of size 2^( 4) =       0.000580573967
  error estimate for blocks of size 2^( 5) =       0.000588758766
  error estimate for blocks of size 2^( 6) =       0.000593055514
  error estimate for blocks of size 2^( 7) =       0.000595416799

      target function =                  N/A
              le_mean =     -22.437829465856
             les_mean =     504.014114496412
             stat err =       0.000589451262
             autocorr =       1.245520953025
              std dev =       0.746942860303
             le_variance =       0.557923636558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557527848349
                                         uncertainty =       0.003474439393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557527848349
                                         uncertainty =       0.003474439393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527936553
  error estimate for blocks of size 2^( 2) =       0.000547715719
  error estimate for blocks of size 2^( 3) =       0.000566479281
  error estimate for blocks of size 2^( 4) =       0.000580410259
  error estimate for blocks of size 2^( 5) =       0.000588614486
  error estimate for blocks of size 2^( 6) =       0.000592912631
  error estimate for blocks of size 2^( 7) =       0.000595279450

      target function =                  N/A
              le_mean =     -22.437825838676
             les_mean =     504.013462096555
             stat err =       0.000589304206
             autocorr =       1.245993040843
              std dev =       0.746615033669
             le_variance =       0.557434008501


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437828108843        initial
     2.4414e-02     2.4414e-01             1.1292e-02       -22.437828495912
     9.7656e-02     9.7656e-01             2.7426e-03       -22.437829465856  <--
     3.9062e-01     3.9062e+00             6.8082e-04       -22.437825838676

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 6.4016e+01
  </log>
  <optVariables href="FORMN2GVP1B.s010.opt.xml">
 uu_0                 2.704077e-01 1 1  ON 0
 uu_1                 9.607127e-02 1 1  ON 1
 uu_2                -1.950132e-02 1 1  ON 2
 uu_3                -8.884037e-02 1 1  ON 3
 uu_4                -1.290058e-01 1 1  ON 4
 uu_5                -1.524259e-01 1 1  ON 5
 uu_6                -1.631038e-01 1 1  ON 6
 uu_7                -1.596747e-01 1 1  ON 7
 uu_8                -1.383713e-01 1 1  ON 8
 uu_9                -8.430576e-02 1 1  ON 9
 ud_0                 4.436743e-01 1 1  ON 10
 ud_1                 1.595886e-01 1 1  ON 11
 ud_2                 1.005530e-02 1 1  ON 12
 ud_3                -7.306807e-02 1 1  ON 13
 ud_4                -1.211618e-01 1 1  ON 14
 ud_5                -1.517720e-01 1 1  ON 15
 ud_6                -1.694770e-01 1 1  ON 16
 ud_7                -1.730600e-01 1 1  ON 17
 ud_8                -1.580088e-01 1 1  ON 18
 ud_9                -1.118310e-01 1 1  ON 19
 eC_0                -6.263055e-01 1 1  ON 20
 eC_1                -4.545011e-01 1 1  ON 21
 eC_2                -1.572204e-01 1 1  ON 22
 eC_3                 5.324108e-02 1 1  ON 23
 eC_4                 1.829183e-01 1 1  ON 24
 eC_5                 2.867024e-01 1 1  ON 25
 eC_6                 2.827101e-01 1 1  ON 26
 eC_7                 2.812633e-01 1 1  ON 27
 eC_8                 1.214493e-01 1 1  ON 28
 eC_9                 2.634914e-02 1 1  ON 29
 eO_0                -1.143059e+00 1 1  ON 30
 eO_1                -7.529773e-01 1 1  ON 31
 eO_2                -2.656390e-01 1 1  ON 32
 eO_3                 5.008264e-02 1 1  ON 33
 eO_4                 2.643980e-01 1 1  ON 34
 eO_5                 3.932073e-01 1 1  ON 35
 eO_6                 4.133984e-01 1 1  ON 36
 eO_7                 4.152280e-01 1 1  ON 37
 eO_8                 3.644504e-01 1 1  ON 38
 eO_9                 1.875063e-01 1 1  ON 39
eH1_0                -1.585591e-01 1 1  ON 40
eH1_1                -5.819131e-02 1 1  ON 41
eH1_2                -3.732015e-02 1 1  ON 42
eH1_3                -3.626575e-02 1 1  ON 43
eH1_4                 2.107694e-03 1 1  ON 44
eH1_5                 1.470710e-02 1 1  ON 45
eH1_6                 4.523338e-02 1 1  ON 46
eH1_7                 5.232822e-02 1 1  ON 47
eH1_8                 3.187207e-02 1 1  ON 48
eH1_9                 8.530492e-02 1 1  ON 49
eH2_0                -1.603092e-01 1 1  ON 50
eH2_1                -5.878975e-02 1 1  ON 51
eH2_2                -3.876734e-02 1 1  ON 52
eH2_3                -3.735857e-02 1 1  ON 53
eH2_4                 8.367654e-04 1 1  ON 54
eH2_5                 1.350080e-02 1 1  ON 55
eH2_6                 4.415832e-02 1 1  ON 56
eH2_7                 4.883207e-02 1 1  ON 57
eH2_8                 3.150804e-02 1 1  ON 58
eH2_9                 9.102494e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2655e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2441e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.4736
    reference variance = 0.393115
====================================================
  Execution time = 4.7144e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7967e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5185e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579705580030
                                         uncertainty =       0.013183773249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579705580030
                                         uncertainty =       0.013183773249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538361800
  error estimate for blocks of size 2^( 2) =       0.000557962054
  error estimate for blocks of size 2^( 3) =       0.000576708898
  error estimate for blocks of size 2^( 4) =       0.000590047147
  error estimate for blocks of size 2^( 5) =       0.000598466207
  error estimate for blocks of size 2^( 6) =       0.000603182678
  error estimate for blocks of size 2^( 7) =       0.000607995317

      target function =                  N/A
              le_mean =     -22.436870352953
             les_mean =     503.992817801065
             stat err =       0.000599922837
             autocorr =       1.241773295133
              std dev =       0.761358559207
             le_variance =       0.579666855678


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243687035295e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436870352953       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436872802800       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436873228405       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436873462812       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436875322027       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436877016815       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436880076866       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436883198904       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436883002514       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436886026038       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436887721916       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436888442221       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436889494724       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436889194970       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436886860143       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436886681164       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436886201009       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436887580132       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436889450770       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436888514372       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.436888833867       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.436888952457       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-02 is 1.201595e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436870352953       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436872272279       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436872625557       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436872468040       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436873864625       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436874811246       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436875388606       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436877443048       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436877899664       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436878999006       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436878668402       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436878476102       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436878529335       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436877836433       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436877477056       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436877629709       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436877719511       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 2.873525e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436870352953       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436871381414       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436871657238       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436871446602       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436872056902       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436872283459       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436872092788       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436872748028       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436873191851       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436873182577       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436873178366       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436873071057       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436873010989       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 7.011057e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227253 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2345e+01
  </log>
  <optVariables href="FORMN2GVP1B.s011.opt.xml">
 uu_0                 2.707579e-01 1 1  ON 0
 uu_1                 9.597549e-02 1 1  ON 1
 uu_2                -1.974151e-02 1 1  ON 2
 uu_3                -8.899511e-02 1 1  ON 3
 uu_4                -1.292157e-01 1 1  ON 4
 uu_5                -1.528389e-01 1 1  ON 5
 uu_6                -1.635865e-01 1 1  ON 6
 uu_7                -1.602123e-01 1 1  ON 7
 uu_8                -1.388688e-01 1 1  ON 8
 uu_9                -8.454074e-02 1 1  ON 9
 ud_0                 4.434886e-01 1 1  ON 10
 ud_1                 1.593509e-01 1 1  ON 11
 ud_2                 9.967896e-03 1 1  ON 12
 ud_3                -7.322990e-02 1 1  ON 13
 ud_4                -1.210873e-01 1 1  ON 14
 ud_5                -1.519455e-01 1 1  ON 15
 ud_6                -1.693668e-01 1 1  ON 16
 ud_7                -1.728352e-01 1 1  ON 17
 ud_8                -1.572257e-01 1 1  ON 18
 ud_9                -1.121601e-01 1 1  ON 19
 eC_0                -6.268433e-01 1 1  ON 20
 eC_1                -4.554140e-01 1 1  ON 21
 eC_2                -1.576170e-01 1 1  ON 22
 eC_3                 5.280562e-02 1 1  ON 23
 eC_4                 1.825609e-01 1 1  ON 24
 eC_5                 2.863102e-01 1 1  ON 25
 eC_6                 2.818251e-01 1 1  ON 26
 eC_7                 2.825658e-01 1 1  ON 27
 eC_8                 1.235284e-01 1 1  ON 28
 eC_9                 2.688229e-02 1 1  ON 29
 eO_0                -1.144621e+00 1 1  ON 30
 eO_1                -7.541576e-01 1 1  ON 31
 eO_2                -2.666747e-01 1 1  ON 32
 eO_3                 4.901095e-02 1 1  ON 33
 eO_4                 2.637802e-01 1 1  ON 34
 eO_5                 3.924976e-01 1 1  ON 35
 eO_6                 4.132955e-01 1 1  ON 36
 eO_7                 4.152491e-01 1 1  ON 37
 eO_8                 3.666280e-01 1 1  ON 38
 eO_9                 1.903798e-01 1 1  ON 39
eH1_0                -1.586611e-01 1 1  ON 40
eH1_1                -5.780234e-02 1 1  ON 41
eH1_2                -3.661559e-02 1 1  ON 42
eH1_3                -3.578722e-02 1 1  ON 43
eH1_4                 2.084117e-03 1 1  ON 44
eH1_5                 1.455137e-02 1 1  ON 45
eH1_6                 4.492594e-02 1 1  ON 46
eH1_7                 5.072909e-02 1 1  ON 47
eH1_8                 3.141290e-02 1 1  ON 48
eH1_9                 8.541429e-02 1 1  ON 49
eH2_0                -1.602773e-01 1 1  ON 50
eH2_1                -5.979123e-02 1 1  ON 51
eH2_2                -3.917653e-02 1 1  ON 52
eH2_3                -3.724064e-02 1 1  ON 53
eH2_4                 6.404974e-04 1 1  ON 54
eH2_5                 1.366997e-02 1 1  ON 55
eH2_6                 4.368016e-02 1 1  ON 56
eH2_7                 4.986390e-02 1 1  ON 57
eH2_8                 3.105058e-02 1 1  ON 58
eH2_9                 9.107857e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.4092
    reference variance = 0.524246
====================================================
  Execution time = 4.5234e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6765e-01
  Total weights = 2.0000e+06
  Execution time = 3.8384e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567543390715
                                         uncertainty =       0.005836286260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567543390715
                                         uncertainty =       0.005836286260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532681243
  error estimate for blocks of size 2^( 2) =       0.000552779214
  error estimate for blocks of size 2^( 3) =       0.000571382967
  error estimate for blocks of size 2^( 4) =       0.000585942313
  error estimate for blocks of size 2^( 5) =       0.000594013893
  error estimate for blocks of size 2^( 6) =       0.000600318769
  error estimate for blocks of size 2^( 7) =       0.000605293642

      target function =                  N/A
              le_mean =     -22.437324097468
             les_mean =     504.001010985091
             stat err =       0.000596392154
             autocorr =       1.253513551406
              std dev =       0.753325038759
             le_variance =       0.567498614021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567798463874
                                         uncertainty =       0.005832712564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567798463874
                                         uncertainty =       0.005832712564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532801179
  error estimate for blocks of size 2^( 2) =       0.000552894367
  error estimate for blocks of size 2^( 3) =       0.000571484053
  error estimate for blocks of size 2^( 4) =       0.000586024842
  error estimate for blocks of size 2^( 5) =       0.000594088344
  error estimate for blocks of size 2^( 6) =       0.000600386614
  error estimate for blocks of size 2^( 7) =       0.000605337814

      target function =                  N/A
              le_mean =     -22.437321269436
             les_mean =     504.001139656256
             stat err =       0.000596459403
             autocorr =       1.253231855817
              std dev =       0.753494653105
             le_variance =       0.567754192258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567877237884
                                         uncertainty =       0.005833116000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567877237884
                                         uncertainty =       0.005833116000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532838213
  error estimate for blocks of size 2^( 2) =       0.000552933695
  error estimate for blocks of size 2^( 3) =       0.000571526330
  error estimate for blocks of size 2^( 4) =       0.000586073376
  error estimate for blocks of size 2^( 5) =       0.000594145931
  error estimate for blocks of size 2^( 6) =       0.000600442998
  error estimate for blocks of size 2^( 7) =       0.000605386483

      target function =                  N/A
              le_mean =     -22.437322579744
             les_mean =     504.001277385804
             stat err =       0.000596512197
             autocorr =       1.253279483156
              std dev =       0.753547027220
             le_variance =       0.567833122232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567621509061
                                         uncertainty =       0.005834921713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567621509061
                                         uncertainty =       0.005834921713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532717981
  error estimate for blocks of size 2^( 2) =       0.000552815761
  error estimate for blocks of size 2^( 3) =       0.000571416910
  error estimate for blocks of size 2^( 4) =       0.000585973618
  error estimate for blocks of size 2^( 5) =       0.000594046503
  error estimate for blocks of size 2^( 6) =       0.000600349252
  error estimate for blocks of size 2^( 7) =       0.000605315846

      target function =                  N/A
              le_mean =     -22.437322597950
             les_mean =     504.001021974618
             stat err =       0.000596421305
             autocorr =       1.253463192897
              std dev =       0.753376993234
             le_variance =       0.567576893934


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437324097468        initial  <--
     2.4414e-02     2.4414e-01             1.2016e-02       -22.437321269436
     9.7656e-02     9.7656e-01             2.8735e-03       -22.437322579744
     3.9062e-01     3.9062e+00             7.0111e-04       -22.437322597950

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.4703
  </log>
  <optVariables href="FORMN2GVP1B.s011.opt.xml">
 uu_0                 2.704077e-01 1 1  ON 0
 uu_1                 9.607127e-02 1 1  ON 1
 uu_2                -1.950132e-02 1 1  ON 2
 uu_3                -8.884037e-02 1 1  ON 3
 uu_4                -1.290058e-01 1 1  ON 4
 uu_5                -1.524259e-01 1 1  ON 5
 uu_6                -1.631038e-01 1 1  ON 6
 uu_7                -1.596747e-01 1 1  ON 7
 uu_8                -1.383713e-01 1 1  ON 8
 uu_9                -8.430576e-02 1 1  ON 9
 ud_0                 4.436743e-01 1 1  ON 10
 ud_1                 1.595886e-01 1 1  ON 11
 ud_2                 1.005530e-02 1 1  ON 12
 ud_3                -7.306807e-02 1 1  ON 13
 ud_4                -1.211618e-01 1 1  ON 14
 ud_5                -1.517720e-01 1 1  ON 15
 ud_6                -1.694770e-01 1 1  ON 16
 ud_7                -1.730600e-01 1 1  ON 17
 ud_8                -1.580088e-01 1 1  ON 18
 ud_9                -1.118310e-01 1 1  ON 19
 eC_0                -6.263055e-01 1 1  ON 20
 eC_1                -4.545011e-01 1 1  ON 21
 eC_2                -1.572204e-01 1 1  ON 22
 eC_3                 5.324108e-02 1 1  ON 23
 eC_4                 1.829183e-01 1 1  ON 24
 eC_5                 2.867024e-01 1 1  ON 25
 eC_6                 2.827101e-01 1 1  ON 26
 eC_7                 2.812633e-01 1 1  ON 27
 eC_8                 1.214493e-01 1 1  ON 28
 eC_9                 2.634914e-02 1 1  ON 29
 eO_0                -1.143059e+00 1 1  ON 30
 eO_1                -7.529773e-01 1 1  ON 31
 eO_2                -2.656390e-01 1 1  ON 32
 eO_3                 5.008264e-02 1 1  ON 33
 eO_4                 2.643980e-01 1 1  ON 34
 eO_5                 3.932073e-01 1 1  ON 35
 eO_6                 4.133984e-01 1 1  ON 36
 eO_7                 4.152280e-01 1 1  ON 37
 eO_8                 3.644504e-01 1 1  ON 38
 eO_9                 1.875063e-01 1 1  ON 39
eH1_0                -1.585591e-01 1 1  ON 40
eH1_1                -5.819131e-02 1 1  ON 41
eH1_2                -3.732015e-02 1 1  ON 42
eH1_3                -3.626575e-02 1 1  ON 43
eH1_4                 2.107694e-03 1 1  ON 44
eH1_5                 1.470710e-02 1 1  ON 45
eH1_6                 4.523338e-02 1 1  ON 46
eH1_7                 5.232822e-02 1 1  ON 47
eH1_8                 3.187207e-02 1 1  ON 48
eH1_9                 8.530492e-02 1 1  ON 49
eH2_0                -1.603092e-01 1 1  ON 50
eH2_1                -5.878975e-02 1 1  ON 51
eH2_2                -3.876734e-02 1 1  ON 52
eH2_3                -3.735857e-02 1 1  ON 53
eH2_4                 8.367654e-04 1 1  ON 54
eH2_5                 1.350080e-02 1 1  ON 55
eH2_6                 4.415832e-02 1 1  ON 56
eH2_7                 4.883207e-02 1 1  ON 57
eH2_8                 3.150804e-02 1 1  ON 58
eH2_9                 9.102494e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2682e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2441e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.4361
    reference variance = 0.487412
====================================================
  Execution time = 4.6259e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5757e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5125e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557556806464
                                         uncertainty =       0.003030691859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557556806464
                                         uncertainty =       0.003030691859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528001146
  error estimate for blocks of size 2^( 2) =       0.000548610185
  error estimate for blocks of size 2^( 3) =       0.000566821311
  error estimate for blocks of size 2^( 4) =       0.000581211504
  error estimate for blocks of size 2^( 5) =       0.000589992921
  error estimate for blocks of size 2^( 6) =       0.000594686271
  error estimate for blocks of size 2^( 7) =       0.000598849272

      target function =                  N/A
              le_mean =     -22.437218990935
             les_mean =     503.986366188725
             stat err =       0.000591184992
             autocorr =       1.253652210526
              std dev =       0.746706381617
             le_variance =       0.557570420348


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243721899093e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437218990935       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437218993457       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437218219138       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437218865775       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437218575031       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437219755598       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437220955086       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437221362640       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437221219254       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437220907259       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437221351225       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437221138811       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437221211537       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437221307843       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-01 is 9.364067e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437218990935       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437218991795       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437218580385       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437218719568       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437218292273       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437219070807       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437219303362       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437219518559       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437219422693       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437219357939       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437219409218       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-01 is 2.467405e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437218990935       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437218991171       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437218858783       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437218885686       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437218715555       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437218940557       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437219011606       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437219079712       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437219059402       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437219058294       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+00 is 6.925005e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232201 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1393e+01
  </log>
  <optVariables href="FORMN2GVP1B.s012.opt.xml">
 uu_0                 2.705305e-01 1 1  ON 0
 uu_1                 9.609924e-02 1 1  ON 1
 uu_2                -1.954153e-02 1 1  ON 2
 uu_3                -8.885586e-02 1 1  ON 3
 uu_4                -1.290899e-01 1 1  ON 4
 uu_5                -1.524414e-01 1 1  ON 5
 uu_6                -1.630991e-01 1 1  ON 6
 uu_7                -1.596879e-01 1 1  ON 7
 uu_8                -1.383887e-01 1 1  ON 8
 uu_9                -8.444309e-02 1 1  ON 9
 ud_0                 4.435968e-01 1 1  ON 10
 ud_1                 1.596213e-01 1 1  ON 11
 ud_2                 1.010267e-02 1 1  ON 12
 ud_3                -7.301967e-02 1 1  ON 13
 ud_4                -1.211022e-01 1 1  ON 14
 ud_5                -1.516974e-01 1 1  ON 15
 ud_6                -1.694698e-01 1 1  ON 16
 ud_7                -1.729674e-01 1 1  ON 17
 ud_8                -1.579770e-01 1 1  ON 18
 ud_9                -1.119633e-01 1 1  ON 19
 eC_0                -6.262477e-01 1 1  ON 20
 eC_1                -4.547478e-01 1 1  ON 21
 eC_2                -1.572214e-01 1 1  ON 22
 eC_3                 5.311615e-02 1 1  ON 23
 eC_4                 1.829173e-01 1 1  ON 24
 eC_5                 2.866347e-01 1 1  ON 25
 eC_6                 2.827464e-01 1 1  ON 26
 eC_7                 2.814026e-01 1 1  ON 27
 eC_8                 1.216310e-01 1 1  ON 28
 eC_9                 2.638017e-02 1 1  ON 29
 eO_0                -1.143253e+00 1 1  ON 30
 eO_1                -7.530622e-01 1 1  ON 31
 eO_2                -2.658254e-01 1 1  ON 32
 eO_3                 5.012786e-02 1 1  ON 33
 eO_4                 2.644395e-01 1 1  ON 34
 eO_5                 3.930830e-01 1 1  ON 35
 eO_6                 4.133060e-01 1 1  ON 36
 eO_7                 4.153343e-01 1 1  ON 37
 eO_8                 3.646435e-01 1 1  ON 38
 eO_9                 1.877342e-01 1 1  ON 39
eH1_0                -1.586814e-01 1 1  ON 40
eH1_1                -5.820444e-02 1 1  ON 41
eH1_2                -3.736381e-02 1 1  ON 42
eH1_3                -3.618986e-02 1 1  ON 43
eH1_4                 2.100166e-03 1 1  ON 44
eH1_5                 1.469626e-02 1 1  ON 45
eH1_6                 4.533731e-02 1 1  ON 46
eH1_7                 5.219349e-02 1 1  ON 47
eH1_8                 3.191132e-02 1 1  ON 48
eH1_9                 8.533560e-02 1 1  ON 49
eH2_0                -1.602838e-01 1 1  ON 50
eH2_1                -5.892487e-02 1 1  ON 51
eH2_2                -3.872074e-02 1 1  ON 52
eH2_3                -3.740542e-02 1 1  ON 53
eH2_4                 8.620772e-04 1 1  ON 54
eH2_5                 1.355112e-02 1 1  ON 55
eH2_6                 4.405315e-02 1 1  ON 56
eH2_7                 4.887257e-02 1 1  ON 57
eH2_8                 3.151270e-02 1 1  ON 58
eH2_9                 9.102647e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.3776
    reference variance = 0.356629
====================================================
  Execution time = 4.4959e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.5843e-01
  Total weights = 2.0000e+06
  Execution time = 3.8437e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558566604093
                                         uncertainty =       0.003166978517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558566604093
                                         uncertainty =       0.003166978517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528437919
  error estimate for blocks of size 2^( 2) =       0.000548616421
  error estimate for blocks of size 2^( 3) =       0.000567890612
  error estimate for blocks of size 2^( 4) =       0.000582721976
  error estimate for blocks of size 2^( 5) =       0.000590106694
  error estimate for blocks of size 2^( 6) =       0.000594939062
  error estimate for blocks of size 2^( 7) =       0.000596326009

      target function =                  N/A
              le_mean =     -22.437945989461
             les_mean =     504.019913214433
             stat err =       0.000591023435
             autocorr =       1.250896728711
              std dev =       0.747324071403
             le_variance =       0.558493267698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558465188780
                                         uncertainty =       0.003167373969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558465188780
                                         uncertainty =       0.003167373969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528389916
  error estimate for blocks of size 2^( 2) =       0.000548569334
  error estimate for blocks of size 2^( 3) =       0.000567848031
  error estimate for blocks of size 2^( 4) =       0.000582678957
  error estimate for blocks of size 2^( 5) =       0.000590067960
  error estimate for blocks of size 2^( 6) =       0.000594895349
  error estimate for blocks of size 2^( 7) =       0.000596271344

      target function =                  N/A
              le_mean =     -22.437947824154
             les_mean =     504.019894086004
             stat err =       0.000590978402
             autocorr =       1.250933371759
              std dev =       0.747256184812
             le_variance =       0.558391805740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558451433115
                                         uncertainty =       0.003166913040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558451433115
                                         uncertainty =       0.003166913040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528383401
  error estimate for blocks of size 2^( 2) =       0.000548563664
  error estimate for blocks of size 2^( 3) =       0.000567842188
  error estimate for blocks of size 2^( 4) =       0.000582673020
  error estimate for blocks of size 2^( 5) =       0.000590060928
  error estimate for blocks of size 2^( 6) =       0.000594889456
  error estimate for blocks of size 2^( 7) =       0.000596268237

      target function =                  N/A
              le_mean =     -22.437947455366
             les_mean =     504.019863766866
             stat err =       0.000590972910
             autocorr =       1.250940967984
              std dev =       0.747246971415
             le_variance =       0.558378036288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558541323300
                                         uncertainty =       0.003166915830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558541323300
                                         uncertainty =       0.003166915830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528425952
  error estimate for blocks of size 2^( 2) =       0.000548604869
  error estimate for blocks of size 2^( 3) =       0.000567879871
  error estimate for blocks of size 2^( 4) =       0.000582711106
  error estimate for blocks of size 2^( 5) =       0.000590096300
  error estimate for blocks of size 2^( 6) =       0.000594928026
  error estimate for blocks of size 2^( 7) =       0.000596314057

      target function =                  N/A
              le_mean =     -22.437946132883
             les_mean =     504.019894355885
             stat err =       0.000591012372
             autocorr =       1.250906555729
              std dev =       0.747307147662
             le_variance =       0.558467972946


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437945989461        initial
     2.4414e-01     2.4414e+00             9.3641e-04       -22.437947824154  <--
     9.7656e-01     9.7656e+00             2.4674e-04       -22.437947455366
     3.9062e+00     3.9062e+01             6.9250e-05       -22.437946132883

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 6.4206e+01
  </log>
  <optVariables href="FORMN2GVP1B.s012.opt.xml">
 uu_0                 2.707123e-01 1 1  ON 0
 uu_1                 9.613003e-02 1 1  ON 1
 uu_2                -1.957063e-02 1 1  ON 2
 uu_3                -8.890983e-02 1 1  ON 3
 uu_4                -1.292092e-01 1 1  ON 4
 uu_5                -1.525028e-01 1 1  ON 5
 uu_6                -1.630969e-01 1 1  ON 6
 uu_7                -1.597062e-01 1 1  ON 7
 uu_8                -1.384444e-01 1 1  ON 8
 uu_9                -8.484072e-02 1 1  ON 9
 ud_0                 4.435658e-01 1 1  ON 10
 ud_1                 1.597034e-01 1 1  ON 11
 ud_2                 1.021123e-02 1 1  ON 12
 ud_3                -7.290213e-02 1 1  ON 13
 ud_4                -1.209677e-01 1 1  ON 14
 ud_5                -1.515441e-01 1 1  ON 15
 ud_6                -1.693821e-01 1 1  ON 16
 ud_7                -1.727982e-01 1 1  ON 17
 ud_8                -1.578729e-01 1 1  ON 18
 ud_9                -1.123239e-01 1 1  ON 19
 eC_0                -6.262736e-01 1 1  ON 20
 eC_1                -4.552049e-01 1 1  ON 21
 eC_2                -1.573747e-01 1 1  ON 22
 eC_3                 5.282876e-02 1 1  ON 23
 eC_4                 1.828135e-01 1 1  ON 24
 eC_5                 2.864728e-01 1 1  ON 25
 eC_6                 2.828579e-01 1 1  ON 26
 eC_7                 2.818340e-01 1 1  ON 27
 eC_8                 1.221951e-01 1 1  ON 28
 eC_9                 2.647687e-02 1 1  ON 29
 eO_0                -1.143762e+00 1 1  ON 30
 eO_1                -7.533927e-01 1 1  ON 31
 eO_2                -2.662846e-01 1 1  ON 32
 eO_3                 5.010550e-02 1 1  ON 33
 eO_4                 2.644681e-01 1 1  ON 34
 eO_5                 3.928357e-01 1 1  ON 35
 eO_6                 4.130240e-01 1 1  ON 36
 eO_7                 4.156386e-01 1 1  ON 37
 eO_8                 3.652426e-01 1 1  ON 38
 eO_9                 1.884427e-01 1 1  ON 39
eH1_0                -1.589978e-01 1 1  ON 40
eH1_1                -5.825582e-02 1 1  ON 41
eH1_2                -3.745776e-02 1 1  ON 42
eH1_3                -3.607693e-02 1 1  ON 43
eH1_4                 2.121450e-03 1 1  ON 44
eH1_5                 1.471208e-02 1 1  ON 45
eH1_6                 4.550753e-02 1 1  ON 46
eH1_7                 5.186420e-02 1 1  ON 47
eH1_8                 3.203264e-02 1 1  ON 48
eH1_9                 8.542915e-02 1 1  ON 49
eH2_0                -1.603142e-01 1 1  ON 50
eH2_1                -5.919747e-02 1 1  ON 51
eH2_2                -3.869475e-02 1 1  ON 52
eH2_3                -3.746097e-02 1 1  ON 53
eH2_4                 9.094592e-04 1 1  ON 54
eH2_5                 1.363132e-02 1 1  ON 55
eH2_6                 4.387138e-02 1 1  ON 56
eH2_7                 4.895547e-02 1 1  ON 57
eH2_8                 3.152082e-02 1 1  ON 58
eH2_9                 9.103410e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2561e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2438e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.4493
    reference variance = 0.477669
====================================================
  Execution time = 4.5416e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 6.9574e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5517e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.695869696490
                                         uncertainty =       0.129523498171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.695869696490
                                         uncertainty =       0.129523498171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000589807133
  error estimate for blocks of size 2^( 2) =       0.000607651351
  error estimate for blocks of size 2^( 3) =       0.000624182562
  error estimate for blocks of size 2^( 4) =       0.000636707823
  error estimate for blocks of size 2^( 5) =       0.000645278888
  error estimate for blocks of size 2^( 6) =       0.000650465766
  error estimate for blocks of size 2^( 7) =       0.000652039232

      target function =                  N/A
              le_mean =     -22.436442760770
             les_mean =     504.089708318727
             stat err =       0.000646122927
             autocorr =       1.200080177637
              std dev =       0.834113247285
             le_variance =       0.695744909296


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243644276077e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436442760770       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436443549422       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436443840237       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436443262154       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436440776684       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436442777597       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436446171326       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436443968833       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436444953653       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436446698469       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436449856806       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436448991035       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436447522699       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436448037671       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436448021081       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436448091921       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436447849962       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436448020293       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436447843298       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-02 is 4.518132e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436442760770       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436443253156       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436443388843       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436443312825       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436441698091       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436441876336       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436443721886       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436443209129       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436443173004       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436443961002       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436444721109       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436444161601       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436444101753       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-01 is 1.088753e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436442760770       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436442957516       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436443010861       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436443039542       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436442505975       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436442380010       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436442745278       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436442665648       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436442581565       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436442818794       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436442935067       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436442834779       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-01 is 2.733422e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2141e+01
  </log>
  <optVariables href="FORMN2GVP1B.s013.opt.xml">
 uu_0                 2.709021e-01 1 1  ON 0
 uu_1                 9.604271e-02 1 1  ON 1
 uu_2                -1.965467e-02 1 1  ON 2
 uu_3                -8.880144e-02 1 1  ON 3
 uu_4                -1.290830e-01 1 1  ON 4
 uu_5                -1.525458e-01 1 1  ON 5
 uu_6                -1.631999e-01 1 1  ON 6
 uu_7                -1.597644e-01 1 1  ON 7
 uu_8                -1.390309e-01 1 1  ON 8
 uu_9                -8.519769e-02 1 1  ON 9
 ud_0                 4.436374e-01 1 1  ON 10
 ud_1                 1.596186e-01 1 1  ON 11
 ud_2                 1.028090e-02 1 1  ON 12
 ud_3                -7.283894e-02 1 1  ON 13
 ud_4                -1.210824e-01 1 1  ON 14
 ud_5                -1.518042e-01 1 1  ON 15
 ud_6                -1.696706e-01 1 1  ON 16
 ud_7                -1.728964e-01 1 1  ON 17
 ud_8                -1.574317e-01 1 1  ON 18
 ud_9                -1.120842e-01 1 1  ON 19
 eC_0                -6.265820e-01 1 1  ON 20
 eC_1                -4.556241e-01 1 1  ON 21
 eC_2                -1.580353e-01 1 1  ON 22
 eC_3                 5.268726e-02 1 1  ON 23
 eC_4                 1.828917e-01 1 1  ON 24
 eC_5                 2.866454e-01 1 1  ON 25
 eC_6                 2.829019e-01 1 1  ON 26
 eC_7                 2.822017e-01 1 1  ON 27
 eC_8                 1.229081e-01 1 1  ON 28
 eC_9                 2.663877e-02 1 1  ON 29
 eO_0                -1.144008e+00 1 1  ON 30
 eO_1                -7.539710e-01 1 1  ON 31
 eO_2                -2.670005e-01 1 1  ON 32
 eO_3                 4.961532e-02 1 1  ON 33
 eO_4                 2.642983e-01 1 1  ON 34
 eO_5                 3.930980e-01 1 1  ON 35
 eO_6                 4.127999e-01 1 1  ON 36
 eO_7                 4.155080e-01 1 1  ON 37
 eO_8                 3.660248e-01 1 1  ON 38
 eO_9                 1.895315e-01 1 1  ON 39
eH1_0                -1.591280e-01 1 1  ON 40
eH1_1                -5.838323e-02 1 1  ON 41
eH1_2                -3.793640e-02 1 1  ON 42
eH1_3                -3.641336e-02 1 1  ON 43
eH1_4                 2.261377e-03 1 1  ON 44
eH1_5                 1.473435e-02 1 1  ON 45
eH1_6                 4.562384e-02 1 1  ON 46
eH1_7                 5.240854e-02 1 1  ON 47
eH1_8                 3.201565e-02 1 1  ON 48
eH1_9                 8.536134e-02 1 1  ON 49
eH2_0                -1.603439e-01 1 1  ON 50
eH2_1                -5.950473e-02 1 1  ON 51
eH2_2                -3.860135e-02 1 1  ON 52
eH2_3                -3.727135e-02 1 1  ON 53
eH2_4                 1.013686e-03 1 1  ON 54
eH2_5                 1.331467e-02 1 1  ON 55
eH2_6                 4.407338e-02 1 1  ON 56
eH2_7                 4.885622e-02 1 1  ON 57
eH2_8                 3.140992e-02 1 1  ON 58
eH2_9                 9.100649e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.5187
    reference variance = 0.552233
====================================================
  Execution time = 4.5007e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6486e-01
  Total weights = 2.0000e+06
  Execution time = 3.8342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565022015216
                                         uncertainty =       0.004178113316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565022015216
                                         uncertainty =       0.004178113316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531479075
  error estimate for blocks of size 2^( 2) =       0.000551195257
  error estimate for blocks of size 2^( 3) =       0.000569211638
  error estimate for blocks of size 2^( 4) =       0.000582549844
  error estimate for blocks of size 2^( 5) =       0.000590655795
  error estimate for blocks of size 2^( 6) =       0.000597237918
  error estimate for blocks of size 2^( 7) =       0.000604449065

      target function =                  N/A
              le_mean =     -22.437071899343
             les_mean =     503.987135148447
             stat err =       0.000593723156
             autocorr =       1.247945538679
              std dev =       0.751624916171
             le_variance =       0.564940014609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564966030620
                                         uncertainty =       0.004179159134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564966030620
                                         uncertainty =       0.004179159134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531452707
  error estimate for blocks of size 2^( 2) =       0.000551179689
  error estimate for blocks of size 2^( 3) =       0.000569207413
  error estimate for blocks of size 2^( 4) =       0.000582549449
  error estimate for blocks of size 2^( 5) =       0.000590651251
  error estimate for blocks of size 2^( 6) =       0.000597242493
  error estimate for blocks of size 2^( 7) =       0.000604463165

      target function =                  N/A
              le_mean =     -22.437075637304
             les_mean =     503.987246830713
             stat err =       0.000593726589
             autocorr =       1.248083814099
              std dev =       0.751587625668
             le_variance =       0.564883959058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564876974621
                                         uncertainty =       0.004179511154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564876974621
                                         uncertainty =       0.004179511154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531410844
  error estimate for blocks of size 2^( 2) =       0.000551141787
  error estimate for blocks of size 2^( 3) =       0.000569176652
  error estimate for blocks of size 2^( 4) =       0.000582526552
  error estimate for blocks of size 2^( 5) =       0.000590634033
  error estimate for blocks of size 2^( 6) =       0.000597227676
  error estimate for blocks of size 2^( 7) =       0.000604452079

      target function =                  N/A
              le_mean =     -22.437077885087
             les_mean =     503.987258708406
             stat err =       0.000593710085
             autocorr =       1.248211065749
              std dev =       0.751528422187
             le_variance =       0.564794969355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565018124228
                                         uncertainty =       0.004178802748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565018124228
                                         uncertainty =       0.004178802748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531477251
  error estimate for blocks of size 2^( 2) =       0.000551195723
  error estimate for blocks of size 2^( 3) =       0.000569215395
  error estimate for blocks of size 2^( 4) =       0.000582555628
  error estimate for blocks of size 2^( 5) =       0.000590661852
  error estimate for blocks of size 2^( 6) =       0.000597246262
  error estimate for blocks of size 2^( 7) =       0.000604461204

      target function =                  N/A
              le_mean =     -22.437072591971
             les_mean =     503.987162351260
             stat err =       0.000593731236
             autocorr =       1.247988076475
              std dev =       0.751622336264
             le_variance =       0.564936136371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437071899343        initial
     6.1035e-02     6.1035e-01             4.5181e-03       -22.437075637304
     2.4414e-01     2.4414e+00             1.0888e-03       -22.437077885087  <--
     9.7656e-01     9.7656e+00             2.7334e-04       -22.437072591971

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 6.4252e+01
  </log>
  <optVariables href="FORMN2GVP1B.s013.opt.xml">
 uu_0                 2.709021e-01 1 1  ON 0
 uu_1                 9.604271e-02 1 1  ON 1
 uu_2                -1.965467e-02 1 1  ON 2
 uu_3                -8.880144e-02 1 1  ON 3
 uu_4                -1.290830e-01 1 1  ON 4
 uu_5                -1.525458e-01 1 1  ON 5
 uu_6                -1.631999e-01 1 1  ON 6
 uu_7                -1.597644e-01 1 1  ON 7
 uu_8                -1.390309e-01 1 1  ON 8
 uu_9                -8.519769e-02 1 1  ON 9
 ud_0                 4.436374e-01 1 1  ON 10
 ud_1                 1.596186e-01 1 1  ON 11
 ud_2                 1.028090e-02 1 1  ON 12
 ud_3                -7.283894e-02 1 1  ON 13
 ud_4                -1.210824e-01 1 1  ON 14
 ud_5                -1.518042e-01 1 1  ON 15
 ud_6                -1.696706e-01 1 1  ON 16
 ud_7                -1.728964e-01 1 1  ON 17
 ud_8                -1.574317e-01 1 1  ON 18
 ud_9                -1.120842e-01 1 1  ON 19
 eC_0                -6.265820e-01 1 1  ON 20
 eC_1                -4.556241e-01 1 1  ON 21
 eC_2                -1.580353e-01 1 1  ON 22
 eC_3                 5.268726e-02 1 1  ON 23
 eC_4                 1.828917e-01 1 1  ON 24
 eC_5                 2.866454e-01 1 1  ON 25
 eC_6                 2.829019e-01 1 1  ON 26
 eC_7                 2.822017e-01 1 1  ON 27
 eC_8                 1.229081e-01 1 1  ON 28
 eC_9                 2.663877e-02 1 1  ON 29
 eO_0                -1.144008e+00 1 1  ON 30
 eO_1                -7.539710e-01 1 1  ON 31
 eO_2                -2.670005e-01 1 1  ON 32
 eO_3                 4.961532e-02 1 1  ON 33
 eO_4                 2.642983e-01 1 1  ON 34
 eO_5                 3.930980e-01 1 1  ON 35
 eO_6                 4.127999e-01 1 1  ON 36
 eO_7                 4.155080e-01 1 1  ON 37
 eO_8                 3.660248e-01 1 1  ON 38
 eO_9                 1.895315e-01 1 1  ON 39
eH1_0                -1.591280e-01 1 1  ON 40
eH1_1                -5.838323e-02 1 1  ON 41
eH1_2                -3.793640e-02 1 1  ON 42
eH1_3                -3.641336e-02 1 1  ON 43
eH1_4                 2.261377e-03 1 1  ON 44
eH1_5                 1.473435e-02 1 1  ON 45
eH1_6                 4.562384e-02 1 1  ON 46
eH1_7                 5.240854e-02 1 1  ON 47
eH1_8                 3.201565e-02 1 1  ON 48
eH1_9                 8.536134e-02 1 1  ON 49
eH2_0                -1.603439e-01 1 1  ON 50
eH2_1                -5.950473e-02 1 1  ON 51
eH2_2                -3.860135e-02 1 1  ON 52
eH2_3                -3.727135e-02 1 1  ON 53
eH2_4                 1.013686e-03 1 1  ON 54
eH2_5                 1.331467e-02 1 1  ON 55
eH2_6                 4.407338e-02 1 1  ON 56
eH2_7                 4.885622e-02 1 1  ON 57
eH2_8                 3.140992e-02 1 1  ON 58
eH2_9                 9.100649e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2640e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2442e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.3805
    reference variance = 0.31835
====================================================
  Execution time = 4.5833e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5995e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5241e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560103693792
                                         uncertainty =       0.004476941073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560103693792
                                         uncertainty =       0.004476941073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529128880
  error estimate for blocks of size 2^( 2) =       0.000549251182
  error estimate for blocks of size 2^( 3) =       0.000567882435
  error estimate for blocks of size 2^( 4) =       0.000582739638
  error estimate for blocks of size 2^( 5) =       0.000591360824
  error estimate for blocks of size 2^( 6) =       0.000597018477
  error estimate for blocks of size 2^( 7) =       0.000598283618

      target function =                  N/A
              le_mean =     -22.437498133526
             les_mean =     504.001276954979
             stat err =       0.000592350639
             autocorr =       1.253241566912
              std dev =       0.748301238118
             le_variance =       0.559954742969


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243749813353e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437498133526       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437499244711       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437497458479       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437500875278       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437501923957       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437503036362       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437503873514       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437504809919       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437505576476       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437506148154       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437505331132       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437504958095       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437506300772       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437506338064       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437506898042       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437506419818       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.437506860817       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.437506902067       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-02 is 4.588861e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437498133526       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437498689735       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437497467610       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437499209031       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437499725679       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437500216630       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437500846827       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437500879801       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437500682185       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437500880612       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437500852736       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437500786448       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437500659893       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437500877024       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-01 is 1.114514e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437498133526       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437498319066       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437497803373       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437498306746       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437498571678       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437498857197       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437498896978       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437498783088       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437498914160       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437498841644       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437498839669       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-01 is 2.735659e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247707 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1086e+01
  </log>
  <optVariables href="FORMN2GVP1B.s014.opt.xml">
 uu_0                 2.707777e-01 1 1  ON 0
 uu_1                 9.597812e-02 1 1  ON 1
 uu_2                -1.977121e-02 1 1  ON 2
 uu_3                -8.892570e-02 1 1  ON 3
 uu_4                -1.292578e-01 1 1  ON 4
 uu_5                -1.525772e-01 1 1  ON 5
 uu_6                -1.633657e-01 1 1  ON 6
 uu_7                -1.599868e-01 1 1  ON 7
 uu_8                -1.391015e-01 1 1  ON 8
 uu_9                -8.526708e-02 1 1  ON 9
 ud_0                 4.434919e-01 1 1  ON 10
 ud_1                 1.596511e-01 1 1  ON 11
 ud_2                 1.024334e-02 1 1  ON 12
 ud_3                -7.282191e-02 1 1  ON 13
 ud_4                -1.210474e-01 1 1  ON 14
 ud_5                -1.518112e-01 1 1  ON 15
 ud_6                -1.693177e-01 1 1  ON 16
 ud_7                -1.730849e-01 1 1  ON 17
 ud_8                -1.573461e-01 1 1  ON 18
 ud_9                -1.121133e-01 1 1  ON 19
 eC_0                -6.265109e-01 1 1  ON 20
 eC_1                -4.555866e-01 1 1  ON 21
 eC_2                -1.583383e-01 1 1  ON 22
 eC_3                 5.191966e-02 1 1  ON 23
 eC_4                 1.823243e-01 1 1  ON 24
 eC_5                 2.866951e-01 1 1  ON 25
 eC_6                 2.831221e-01 1 1  ON 26
 eC_7                 2.826104e-01 1 1  ON 27
 eC_8                 1.235435e-01 1 1  ON 28
 eC_9                 2.683620e-02 1 1  ON 29
 eO_0                -1.144737e+00 1 1  ON 30
 eO_1                -7.543435e-01 1 1  ON 31
 eO_2                -2.673987e-01 1 1  ON 32
 eO_3                 4.917223e-02 1 1  ON 33
 eO_4                 2.639164e-01 1 1  ON 34
 eO_5                 3.929789e-01 1 1  ON 35
 eO_6                 4.126368e-01 1 1  ON 36
 eO_7                 4.155804e-01 1 1  ON 37
 eO_8                 3.670739e-01 1 1  ON 38
 eO_9                 1.906460e-01 1 1  ON 39
eH1_0                -1.589324e-01 1 1  ON 40
eH1_1                -5.823683e-02 1 1  ON 41
eH1_2                -3.795336e-02 1 1  ON 42
eH1_3                -3.655470e-02 1 1  ON 43
eH1_4                 2.299408e-03 1 1  ON 44
eH1_5                 1.493184e-02 1 1  ON 45
eH1_6                 4.543670e-02 1 1  ON 46
eH1_7                 5.219341e-02 1 1  ON 47
eH1_8                 3.183431e-02 1 1  ON 48
eH1_9                 8.520555e-02 1 1  ON 49
eH2_0                -1.598434e-01 1 1  ON 50
eH2_1                -5.970834e-02 1 1  ON 51
eH2_2                -3.901348e-02 1 1  ON 52
eH2_3                -3.774657e-02 1 1  ON 53
eH2_4                 9.819442e-04 1 1  ON 54
eH2_5                 1.365094e-02 1 1  ON 55
eH2_6                 4.401369e-02 1 1  ON 56
eH2_7                 4.886310e-02 1 1  ON 57
eH2_8                 3.122099e-02 1 1  ON 58
eH2_9                 9.108913e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.3946
    reference variance = 0.460731
====================================================
  Execution time = 4.5372e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5673e-01
  Total weights = 2.0000e+06
  Execution time = 3.8425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556708155359
                                         uncertainty =       0.004182466454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556708155359
                                         uncertainty =       0.004182466454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527613997
  error estimate for blocks of size 2^( 2) =       0.000547702270
  error estimate for blocks of size 2^( 3) =       0.000566267267
  error estimate for blocks of size 2^( 4) =       0.000580486273
  error estimate for blocks of size 2^( 5) =       0.000589467827
  error estimate for blocks of size 2^( 6) =       0.000593632955
  error estimate for blocks of size 2^( 7) =       0.000594842629

      target function =                  N/A
              le_mean =     -22.436788120489
             les_mean =     503.966213944323
             stat err =       0.000589607421
             autocorr =       1.248801080808
              std dev =       0.746158869800
             le_variance =       0.556753058981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556723736019
                                         uncertainty =       0.004183468615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556723736019
                                         uncertainty =       0.004183468615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527621422
  error estimate for blocks of size 2^( 2) =       0.000547707828
  error estimate for blocks of size 2^( 3) =       0.000566266540
  error estimate for blocks of size 2^( 4) =       0.000580482001
  error estimate for blocks of size 2^( 5) =       0.000589453620
  error estimate for blocks of size 2^( 6) =       0.000593599982
  error estimate for blocks of size 2^( 7) =       0.000594794807

      target function =                  N/A
              le_mean =     -22.436782271350
             les_mean =     503.965967142776
             stat err =       0.000589582603
             autocorr =       1.248660807107
              std dev =       0.746169370312
             le_variance =       0.556768729191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556673136141
                                         uncertainty =       0.004182503704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556673136141
                                         uncertainty =       0.004182503704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527597474
  error estimate for blocks of size 2^( 2) =       0.000547683639
  error estimate for blocks of size 2^( 3) =       0.000566242695
  error estimate for blocks of size 2^( 4) =       0.000580460607
  error estimate for blocks of size 2^( 5) =       0.000589433143
  error estimate for blocks of size 2^( 6) =       0.000593576484
  error estimate for blocks of size 2^( 7) =       0.000594771176

      target function =                  N/A
              le_mean =     -22.436780271885
             les_mean =     503.965826879019
             stat err =       0.000589560352
             autocorr =       1.248679911616
              std dev =       0.746135502799
             le_variance =       0.556718188537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556690244126
                                         uncertainty =       0.004182313363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556690244126
                                         uncertainty =       0.004182313363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527605526
  error estimate for blocks of size 2^( 2) =       0.000547693034
  error estimate for blocks of size 2^( 3) =       0.000566256730
  error estimate for blocks of size 2^( 4) =       0.000580475789
  error estimate for blocks of size 2^( 5) =       0.000589455478
  error estimate for blocks of size 2^( 6) =       0.000593616132
  error estimate for blocks of size 2^( 7) =       0.000594822501

      target function =                  N/A
              le_mean =     -22.436785776389
             les_mean =     503.966090879684
             stat err =       0.000589592475
             autocorr =       1.248777866329
              std dev =       0.746146890700
             le_variance =       0.556735182501


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436788120489        initial  <--
     6.1035e-02     6.1035e-01             4.5889e-03       -22.436782271350
     2.4414e-01     2.4414e+00             1.1145e-03       -22.436780271885
     9.7656e-01     9.7656e+00             2.7357e-04       -22.436785776389

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.6079
  </log>
  <optVariables href="FORMN2GVP1B.s014.opt.xml">
 uu_0                 2.709021e-01 1 1  ON 0
 uu_1                 9.604271e-02 1 1  ON 1
 uu_2                -1.965467e-02 1 1  ON 2
 uu_3                -8.880144e-02 1 1  ON 3
 uu_4                -1.290830e-01 1 1  ON 4
 uu_5                -1.525458e-01 1 1  ON 5
 uu_6                -1.631999e-01 1 1  ON 6
 uu_7                -1.597644e-01 1 1  ON 7
 uu_8                -1.390309e-01 1 1  ON 8
 uu_9                -8.519769e-02 1 1  ON 9
 ud_0                 4.436374e-01 1 1  ON 10
 ud_1                 1.596186e-01 1 1  ON 11
 ud_2                 1.028090e-02 1 1  ON 12
 ud_3                -7.283894e-02 1 1  ON 13
 ud_4                -1.210824e-01 1 1  ON 14
 ud_5                -1.518042e-01 1 1  ON 15
 ud_6                -1.696706e-01 1 1  ON 16
 ud_7                -1.728964e-01 1 1  ON 17
 ud_8                -1.574317e-01 1 1  ON 18
 ud_9                -1.120842e-01 1 1  ON 19
 eC_0                -6.265820e-01 1 1  ON 20
 eC_1                -4.556241e-01 1 1  ON 21
 eC_2                -1.580353e-01 1 1  ON 22
 eC_3                 5.268726e-02 1 1  ON 23
 eC_4                 1.828917e-01 1 1  ON 24
 eC_5                 2.866454e-01 1 1  ON 25
 eC_6                 2.829019e-01 1 1  ON 26
 eC_7                 2.822017e-01 1 1  ON 27
 eC_8                 1.229081e-01 1 1  ON 28
 eC_9                 2.663877e-02 1 1  ON 29
 eO_0                -1.144008e+00 1 1  ON 30
 eO_1                -7.539710e-01 1 1  ON 31
 eO_2                -2.670005e-01 1 1  ON 32
 eO_3                 4.961532e-02 1 1  ON 33
 eO_4                 2.642983e-01 1 1  ON 34
 eO_5                 3.930980e-01 1 1  ON 35
 eO_6                 4.127999e-01 1 1  ON 36
 eO_7                 4.155080e-01 1 1  ON 37
 eO_8                 3.660248e-01 1 1  ON 38
 eO_9                 1.895315e-01 1 1  ON 39
eH1_0                -1.591280e-01 1 1  ON 40
eH1_1                -5.838323e-02 1 1  ON 41
eH1_2                -3.793640e-02 1 1  ON 42
eH1_3                -3.641336e-02 1 1  ON 43
eH1_4                 2.261377e-03 1 1  ON 44
eH1_5                 1.473435e-02 1 1  ON 45
eH1_6                 4.562384e-02 1 1  ON 46
eH1_7                 5.240854e-02 1 1  ON 47
eH1_8                 3.201565e-02 1 1  ON 48
eH1_9                 8.536134e-02 1 1  ON 49
eH2_0                -1.603439e-01 1 1  ON 50
eH2_1                -5.950473e-02 1 1  ON 51
eH2_2                -3.860135e-02 1 1  ON 52
eH2_3                -3.727135e-02 1 1  ON 53
eH2_4                 1.013686e-03 1 1  ON 54
eH2_5                 1.331467e-02 1 1  ON 55
eH2_6                 4.407338e-02 1 1  ON 56
eH2_7                 4.885622e-02 1 1  ON 57
eH2_8                 3.140992e-02 1 1  ON 58
eH2_9                 9.100649e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2570e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2438e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.5436
    reference variance = 0.450231
====================================================
  Execution time = 4.5911e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7408e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5200e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574289547381
                                         uncertainty =       0.017544020412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574289547381
                                         uncertainty =       0.017544020412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535760974
  error estimate for blocks of size 2^( 2) =       0.000555597329
  error estimate for blocks of size 2^( 3) =       0.000573630595
  error estimate for blocks of size 2^( 4) =       0.000587269217
  error estimate for blocks of size 2^( 5) =       0.000597055988
  error estimate for blocks of size 2^( 6) =       0.000600603655
  error estimate for blocks of size 2^( 7) =       0.000605705194

      target function =                  N/A
              le_mean =     -22.436278776668
             les_mean =     503.960684699670
             stat err =       0.000597658514
             autocorr =       1.244411654933
              std dev =       0.757680435497
             le_variance =       0.574079642335


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243627877667e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436278776668       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436277813135       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436278143655       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436277774295       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436277440619       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436277766924       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436278261780       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436278139394       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436278055389       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436278265978       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436278275706       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436278151084       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-01 is 4.204885e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436278776668       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436278480653       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436278519969       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436278353174       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436278316736       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436278368038       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436278507423       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436278495237       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436278469982       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436278489183       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+00 is 1.034738e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436278776668       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436278698173       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436278700957       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436278648651       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436278650907       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436278655994       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436278692185       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436278688512       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436278682739       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436278685150       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+00 is 2.600513e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251972 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1120e+01
  </log>
  <optVariables href="FORMN2GVP1B.s015.opt.xml">
 uu_0                 2.709288e-01 1 1  ON 0
 uu_1                 9.603677e-02 1 1  ON 1
 uu_2                -1.964749e-02 1 1  ON 2
 uu_3                -8.881425e-02 1 1  ON 3
 uu_4                -1.290884e-01 1 1  ON 4
 uu_5                -1.525949e-01 1 1  ON 5
 uu_6                -1.632152e-01 1 1  ON 6
 uu_7                -1.597804e-01 1 1  ON 7
 uu_8                -1.390484e-01 1 1  ON 8
 uu_9                -8.522146e-02 1 1  ON 9
 ud_0                 4.436568e-01 1 1  ON 10
 ud_1                 1.596067e-01 1 1  ON 11
 ud_2                 1.028088e-02 1 1  ON 12
 ud_3                -7.285494e-02 1 1  ON 13
 ud_4                -1.210842e-01 1 1  ON 14
 ud_5                -1.518113e-01 1 1  ON 15
 ud_6                -1.696369e-01 1 1  ON 16
 ud_7                -1.729232e-01 1 1  ON 17
 ud_8                -1.574253e-01 1 1  ON 18
 ud_9                -1.121002e-01 1 1  ON 19
 eC_0                -6.265984e-01 1 1  ON 20
 eC_1                -4.556574e-01 1 1  ON 21
 eC_2                -1.580436e-01 1 1  ON 22
 eC_3                 5.261162e-02 1 1  ON 23
 eC_4                 1.828556e-01 1 1  ON 24
 eC_5                 2.866631e-01 1 1  ON 25
 eC_6                 2.829178e-01 1 1  ON 26
 eC_7                 2.822447e-01 1 1  ON 27
 eC_8                 1.229830e-01 1 1  ON 28
 eC_9                 2.665866e-02 1 1  ON 29
 eO_0                -1.144071e+00 1 1  ON 30
 eO_1                -7.540112e-01 1 1  ON 31
 eO_2                -2.670468e-01 1 1  ON 32
 eO_3                 4.954961e-02 1 1  ON 33
 eO_4                 2.642611e-01 1 1  ON 34
 eO_5                 3.931399e-01 1 1  ON 35
 eO_6                 4.127756e-01 1 1  ON 36
 eO_7                 4.155099e-01 1 1  ON 37
 eO_8                 3.661102e-01 1 1  ON 38
 eO_9                 1.896349e-01 1 1  ON 39
eH1_0                -1.591363e-01 1 1  ON 40
eH1_1                -5.841161e-02 1 1  ON 41
eH1_2                -3.785958e-02 1 1  ON 42
eH1_3                -3.644151e-02 1 1  ON 43
eH1_4                 2.243884e-03 1 1  ON 44
eH1_5                 1.473538e-02 1 1  ON 45
eH1_6                 4.563314e-02 1 1  ON 46
eH1_7                 5.236563e-02 1 1  ON 47
eH1_8                 3.201607e-02 1 1  ON 48
eH1_9                 8.536368e-02 1 1  ON 49
eH2_0                -1.603228e-01 1 1  ON 50
eH2_1                -5.950167e-02 1 1  ON 51
eH2_2                -3.862285e-02 1 1  ON 52
eH2_3                -3.730614e-02 1 1  ON 53
eH2_4                 9.617085e-04 1 1  ON 54
eH2_5                 1.328356e-02 1 1  ON 55
eH2_6                 4.409181e-02 1 1  ON 56
eH2_7                 4.892866e-02 1 1  ON 57
eH2_8                 3.139429e-02 1 1  ON 58
eH2_9                 9.100751e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.3144
    reference variance = 0.417325
====================================================
  Execution time = 4.5867e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5953e-01
  Total weights = 2.0000e+06
  Execution time = 4.4495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559461448014
                                         uncertainty =       0.003774013611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559461448014
                                         uncertainty =       0.003774013611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528907754
  error estimate for blocks of size 2^( 2) =       0.000548993806
  error estimate for blocks of size 2^( 3) =       0.000567486212
  error estimate for blocks of size 2^( 4) =       0.000581723435
  error estimate for blocks of size 2^( 5) =       0.000590094355
  error estimate for blocks of size 2^( 6) =       0.000594039948
  error estimate for blocks of size 2^( 7) =       0.000595101114

      target function =                  N/A
              le_mean =     -22.437260631973
             les_mean =     503.990151212639
             stat err =       0.000590239713
             autocorr =       1.245365942854
              std dev =       0.747988519481
             le_variance =       0.559486825276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559593310338
                                         uncertainty =       0.003775542010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559593310338
                                         uncertainty =       0.003775542010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528970096
  error estimate for blocks of size 2^( 2) =       0.000549051471
  error estimate for blocks of size 2^( 3) =       0.000567539345
  error estimate for blocks of size 2^( 4) =       0.000581771322
  error estimate for blocks of size 2^( 5) =       0.000590139144
  error estimate for blocks of size 2^( 6) =       0.000594085669
  error estimate for blocks of size 2^( 7) =       0.000595144354

      target function =                  N/A
              le_mean =     -22.437260065267
             les_mean =     503.990257680799
             stat err =       0.000590285122
             autocorr =       1.245263999439
              std dev =       0.748076683358
             le_variance =       0.559618724184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559556424941
                                         uncertainty =       0.003775085808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559556424941
                                         uncertainty =       0.003775085808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528952655
  error estimate for blocks of size 2^( 2) =       0.000549035450
  error estimate for blocks of size 2^( 3) =       0.000567524780
  error estimate for blocks of size 2^( 4) =       0.000581758536
  error estimate for blocks of size 2^( 5) =       0.000590127378
  error estimate for blocks of size 2^( 6) =       0.000594073638
  error estimate for blocks of size 2^( 7) =       0.000595133414

      target function =                  N/A
              le_mean =     -22.437260234086
             les_mean =     503.990228354691
             stat err =       0.000590273241
             autocorr =       1.245295989330
              std dev =       0.748052018494
             le_variance =       0.559581822372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559474381959
                                         uncertainty =       0.003774157164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559474381959
                                         uncertainty =       0.003774157164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528913869
  error estimate for blocks of size 2^( 2) =       0.000548999483
  error estimate for blocks of size 2^( 3) =       0.000567491473
  error estimate for blocks of size 2^( 4) =       0.000581728222
  error estimate for blocks of size 2^( 5) =       0.000590098861
  error estimate for blocks of size 2^( 6) =       0.000594044558
  error estimate for blocks of size 2^( 7) =       0.000595105543

      target function =                  N/A
              le_mean =     -22.437260568333
             les_mean =     503.990161293403
             stat err =       0.000590244296
             autocorr =       1.245356486789
              std dev =       0.747997167016
             le_variance =       0.559499761863


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437260631973        initial  <--
     6.1035e-01     6.1035e+00             4.2049e-04       -22.437260065267
     2.4414e+00     2.4414e+01             1.0347e-04       -22.437260234086
     9.7656e+00     9.7656e+01             2.6005e-05       -22.437260568333

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.6847
  </log>
  <optVariables href="FORMN2GVP1B.s015.opt.xml">
 uu_0                 2.709021e-01 1 1  ON 0
 uu_1                 9.604271e-02 1 1  ON 1
 uu_2                -1.965467e-02 1 1  ON 2
 uu_3                -8.880144e-02 1 1  ON 3
 uu_4                -1.290830e-01 1 1  ON 4
 uu_5                -1.525458e-01 1 1  ON 5
 uu_6                -1.631999e-01 1 1  ON 6
 uu_7                -1.597644e-01 1 1  ON 7
 uu_8                -1.390309e-01 1 1  ON 8
 uu_9                -8.519769e-02 1 1  ON 9
 ud_0                 4.436374e-01 1 1  ON 10
 ud_1                 1.596186e-01 1 1  ON 11
 ud_2                 1.028090e-02 1 1  ON 12
 ud_3                -7.283894e-02 1 1  ON 13
 ud_4                -1.210824e-01 1 1  ON 14
 ud_5                -1.518042e-01 1 1  ON 15
 ud_6                -1.696706e-01 1 1  ON 16
 ud_7                -1.728964e-01 1 1  ON 17
 ud_8                -1.574317e-01 1 1  ON 18
 ud_9                -1.120842e-01 1 1  ON 19
 eC_0                -6.265820e-01 1 1  ON 20
 eC_1                -4.556241e-01 1 1  ON 21
 eC_2                -1.580353e-01 1 1  ON 22
 eC_3                 5.268726e-02 1 1  ON 23
 eC_4                 1.828917e-01 1 1  ON 24
 eC_5                 2.866454e-01 1 1  ON 25
 eC_6                 2.829019e-01 1 1  ON 26
 eC_7                 2.822017e-01 1 1  ON 27
 eC_8                 1.229081e-01 1 1  ON 28
 eC_9                 2.663877e-02 1 1  ON 29
 eO_0                -1.144008e+00 1 1  ON 30
 eO_1                -7.539710e-01 1 1  ON 31
 eO_2                -2.670005e-01 1 1  ON 32
 eO_3                 4.961532e-02 1 1  ON 33
 eO_4                 2.642983e-01 1 1  ON 34
 eO_5                 3.930980e-01 1 1  ON 35
 eO_6                 4.127999e-01 1 1  ON 36
 eO_7                 4.155080e-01 1 1  ON 37
 eO_8                 3.660248e-01 1 1  ON 38
 eO_9                 1.895315e-01 1 1  ON 39
eH1_0                -1.591280e-01 1 1  ON 40
eH1_1                -5.838323e-02 1 1  ON 41
eH1_2                -3.793640e-02 1 1  ON 42
eH1_3                -3.641336e-02 1 1  ON 43
eH1_4                 2.261377e-03 1 1  ON 44
eH1_5                 1.473435e-02 1 1  ON 45
eH1_6                 4.562384e-02 1 1  ON 46
eH1_7                 5.240854e-02 1 1  ON 47
eH1_8                 3.201565e-02 1 1  ON 48
eH1_9                 8.536134e-02 1 1  ON 49
eH2_0                -1.603439e-01 1 1  ON 50
eH2_1                -5.950473e-02 1 1  ON 51
eH2_2                -3.860135e-02 1 1  ON 52
eH2_3                -3.727135e-02 1 1  ON 53
eH2_4                 1.013686e-03 1 1  ON 54
eH2_5                 1.331467e-02 1 1  ON 55
eH2_6                 4.407338e-02 1 1  ON 56
eH2_7                 4.885622e-02 1 1  ON 57
eH2_8                 3.140992e-02 1 1  ON 58
eH2_9                 9.100649e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2681e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2438e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.5037
    reference variance = 0.487299
====================================================
  Execution time = 4.6086e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7140e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5226e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571525714049
                                         uncertainty =       0.011487452485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571525714049
                                         uncertainty =       0.011487452485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534509106
  error estimate for blocks of size 2^( 2) =       0.000554553889
  error estimate for blocks of size 2^( 3) =       0.000573906819
  error estimate for blocks of size 2^( 4) =       0.000587652759
  error estimate for blocks of size 2^( 5) =       0.000595829837
  error estimate for blocks of size 2^( 6) =       0.000598880120
  error estimate for blocks of size 2^( 7) =       0.000599985181

      target function =                  N/A
              le_mean =     -22.436963607362
             les_mean =     503.988735601121
             stat err =       0.000595586974
             autocorr =       1.241595602271
              std dev =       0.755910026884
             le_variance =       0.571399968744


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243696360736e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436963607362       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436963753757       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436963820868       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436963840278       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436963908264       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436963969333       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436963949803       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436963968605       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436963970168       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436963960116       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+00 is 4.258117e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436963607362       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436963644898       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436963662848       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436963667789       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436963684215       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436963699791       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436963695056       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436963700449       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436963700414       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436963697985       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+01 is 1.066906e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436963607362       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436963616806       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436963621372       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436963622614       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436963626681       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436963630593       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436963629418       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436963630813       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436963630779       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436963630180       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+01 is 2.668755e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255586 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1320e+01
  </log>
  <optVariables href="FORMN2GVP1B.s016.opt.xml">
 uu_0                 2.708997e-01 1 1  ON 0
 uu_1                 9.604342e-02 1 1  ON 1
 uu_2                -1.965561e-02 1 1  ON 2
 uu_3                -8.880643e-02 1 1  ON 3
 uu_4                -1.290824e-01 1 1  ON 4
 uu_5                -1.525451e-01 1 1  ON 5
 uu_6                -1.631999e-01 1 1  ON 6
 uu_7                -1.597671e-01 1 1  ON 7
 uu_8                -1.390337e-01 1 1  ON 8
 uu_9                -8.519684e-02 1 1  ON 9
 ud_0                 4.436387e-01 1 1  ON 10
 ud_1                 1.596183e-01 1 1  ON 11
 ud_2                 1.028304e-02 1 1  ON 12
 ud_3                -7.283623e-02 1 1  ON 13
 ud_4                -1.210819e-01 1 1  ON 14
 ud_5                -1.518045e-01 1 1  ON 15
 ud_6                -1.696688e-01 1 1  ON 16
 ud_7                -1.729022e-01 1 1  ON 17
 ud_8                -1.574341e-01 1 1  ON 18
 ud_9                -1.120834e-01 1 1  ON 19
 eC_0                -6.265857e-01 1 1  ON 20
 eC_1                -4.556250e-01 1 1  ON 21
 eC_2                -1.580387e-01 1 1  ON 22
 eC_3                 5.268958e-02 1 1  ON 23
 eC_4                 1.828835e-01 1 1  ON 24
 eC_5                 2.866443e-01 1 1  ON 25
 eC_6                 2.829062e-01 1 1  ON 26
 eC_7                 2.822047e-01 1 1  ON 27
 eC_8                 1.229138e-01 1 1  ON 28
 eC_9                 2.664049e-02 1 1  ON 29
 eO_0                -1.144017e+00 1 1  ON 30
 eO_1                -7.539770e-01 1 1  ON 31
 eO_2                -2.669982e-01 1 1  ON 32
 eO_3                 4.961030e-02 1 1  ON 33
 eO_4                 2.642948e-01 1 1  ON 34
 eO_5                 3.930944e-01 1 1  ON 35
 eO_6                 4.127984e-01 1 1  ON 36
 eO_7                 4.155090e-01 1 1  ON 37
 eO_8                 3.660351e-01 1 1  ON 38
 eO_9                 1.895421e-01 1 1  ON 39
eH1_0                -1.591268e-01 1 1  ON 40
eH1_1                -5.838158e-02 1 1  ON 41
eH1_2                -3.793396e-02 1 1  ON 42
eH1_3                -3.640953e-02 1 1  ON 43
eH1_4                 2.259641e-03 1 1  ON 44
eH1_5                 1.473094e-02 1 1  ON 45
eH1_6                 4.562272e-02 1 1  ON 46
eH1_7                 5.240696e-02 1 1  ON 47
eH1_8                 3.201297e-02 1 1  ON 48
eH1_9                 8.535996e-02 1 1  ON 49
eH2_0                -1.603451e-01 1 1  ON 50
eH2_1                -5.950655e-02 1 1  ON 51
eH2_2                -3.860196e-02 1 1  ON 52
eH2_3                -3.727558e-02 1 1  ON 53
eH2_4                 1.016201e-03 1 1  ON 54
eH2_5                 1.331055e-02 1 1  ON 55
eH2_6                 4.407435e-02 1 1  ON 56
eH2_7                 4.886355e-02 1 1  ON 57
eH2_8                 3.140795e-02 1 1  ON 58
eH2_9                 9.100574e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.4193
    reference variance = 0.541542
====================================================
  Execution time = 4.5035e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6732e-01
  Total weights = 2.0000e+06
  Execution time = 3.8730e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567463529733
                                         uncertainty =       0.006384203991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567463529733
                                         uncertainty =       0.006384203991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532597594
  error estimate for blocks of size 2^( 2) =       0.000551974775
  error estimate for blocks of size 2^( 3) =       0.000570716404
  error estimate for blocks of size 2^( 4) =       0.000584200740
  error estimate for blocks of size 2^( 5) =       0.000594614410
  error estimate for blocks of size 2^( 6) =       0.000597316327
  error estimate for blocks of size 2^( 7) =       0.000603090466

      target function =                  N/A
              le_mean =     -22.435695563059
             les_mean =     503.927755509777
             stat err =       0.000594805486
             autocorr =       1.247244305097
              std dev =       0.753206741332
             le_variance =       0.567320395187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567463071155
                                         uncertainty =       0.006384670950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567463071155
                                         uncertainty =       0.006384670950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532597381
  error estimate for blocks of size 2^( 2) =       0.000551974633
  error estimate for blocks of size 2^( 3) =       0.000570716324
  error estimate for blocks of size 2^( 4) =       0.000584200686
  error estimate for blocks of size 2^( 5) =       0.000594614067
  error estimate for blocks of size 2^( 6) =       0.000597316106
  error estimate for blocks of size 2^( 7) =       0.000603090780

      target function =                  N/A
              le_mean =     -22.435695699845
             les_mean =     503.927761193539
             stat err =       0.000594805410
             autocorr =       1.247244984106
              std dev =       0.753206439929
             le_variance =       0.567319941151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567463171356
                                         uncertainty =       0.006384447178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567463171356
                                         uncertainty =       0.006384447178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532597427
  error estimate for blocks of size 2^( 2) =       0.000551974651
  error estimate for blocks of size 2^( 3) =       0.000570716318
  error estimate for blocks of size 2^( 4) =       0.000584200672
  error estimate for blocks of size 2^( 5) =       0.000594614195
  error estimate for blocks of size 2^( 6) =       0.000597316172
  error estimate for blocks of size 2^( 7) =       0.000603090575

      target function =                  N/A
              le_mean =     -22.435695635662
             les_mean =     503.927758411752
             stat err =       0.000594805403
             autocorr =       1.247244740681
              std dev =       0.753206505110
             le_variance =       0.567320039341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567463479918
                                         uncertainty =       0.006384234720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567463479918
                                         uncertainty =       0.006384234720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532597571
  error estimate for blocks of size 2^( 2) =       0.000551974757
  error estimate for blocks of size 2^( 3) =       0.000570716392
  error estimate for blocks of size 2^( 4) =       0.000584200730
  error estimate for blocks of size 2^( 5) =       0.000594614381
  error estimate for blocks of size 2^( 6) =       0.000597316306
  error estimate for blocks of size 2^( 7) =       0.000603090477

      target function =                  N/A
              le_mean =     -22.435695572157
             les_mean =     503.927755868523
             stat err =       0.000594805474
             autocorr =       1.247244362601
              std dev =       0.753206708479
             le_variance =       0.567320345698


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435695563059        initial
     6.1035e+00     6.1035e+01             4.2581e-05       -22.435695699845  <--
     2.4414e+01     2.4414e+02             1.0669e-05       -22.435695635662
     9.7656e+01     9.7656e+02             2.6688e-06       -22.435695572157

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 6.4287e+01
  </log>
  <optVariables href="FORMN2GVP1B.s016.opt.xml">
 uu_0                 2.708931e-01 1 1  ON 0
 uu_1                 9.604535e-02 1 1  ON 1
 uu_2                -1.965884e-02 1 1  ON 2
 uu_3                -8.882051e-02 1 1  ON 3
 uu_4                -1.290814e-01 1 1  ON 4
 uu_5                -1.525428e-01 1 1  ON 5
 uu_6                -1.631997e-01 1 1  ON 6
 uu_7                -1.597749e-01 1 1  ON 7
 uu_8                -1.390421e-01 1 1  ON 8
 uu_9                -8.519435e-02 1 1  ON 9
 ud_0                 4.436424e-01 1 1  ON 10
 ud_1                 1.596177e-01 1 1  ON 11
 ud_2                 1.028920e-02 1 1  ON 12
 ud_3                -7.282833e-02 1 1  ON 13
 ud_4                -1.210801e-01 1 1  ON 14
 ud_5                -1.518054e-01 1 1  ON 15
 ud_6                -1.696638e-01 1 1  ON 16
 ud_7                -1.729189e-01 1 1  ON 17
 ud_8                -1.574415e-01 1 1  ON 18
 ud_9                -1.120810e-01 1 1  ON 19
 eC_0                -6.265966e-01 1 1  ON 20
 eC_1                -4.556279e-01 1 1  ON 21
 eC_2                -1.580486e-01 1 1  ON 22
 eC_3                 5.269617e-02 1 1  ON 23
 eC_4                 1.828599e-01 1 1  ON 24
 eC_5                 2.866408e-01 1 1  ON 25
 eC_6                 2.829190e-01 1 1  ON 26
 eC_7                 2.822138e-01 1 1  ON 27
 eC_8                 1.229308e-01 1 1  ON 28
 eC_9                 2.664563e-02 1 1  ON 29
 eO_0                -1.144042e+00 1 1  ON 30
 eO_1                -7.539946e-01 1 1  ON 31
 eO_2                -2.669919e-01 1 1  ON 32
 eO_3                 4.959550e-02 1 1  ON 33
 eO_4                 2.642843e-01 1 1  ON 34
 eO_5                 3.930838e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155121e-01 1 1  ON 37
 eO_8                 3.660659e-01 1 1  ON 38
 eO_9                 1.895740e-01 1 1  ON 39
eH1_0                -1.591231e-01 1 1  ON 40
eH1_1                -5.837655e-02 1 1  ON 41
eH1_2                -3.792661e-02 1 1  ON 42
eH1_3                -3.639844e-02 1 1  ON 43
eH1_4                 2.254634e-03 1 1  ON 44
eH1_5                 1.472089e-02 1 1  ON 45
eH1_6                 4.561932e-02 1 1  ON 46
eH1_7                 5.240212e-02 1 1  ON 47
eH1_8                 3.200494e-02 1 1  ON 48
eH1_9                 8.535582e-02 1 1  ON 49
eH2_0                -1.603488e-01 1 1  ON 50
eH2_1                -5.951203e-02 1 1  ON 51
eH2_2                -3.860394e-02 1 1  ON 52
eH2_3                -3.728787e-02 1 1  ON 53
eH2_4                 1.023129e-03 1 1  ON 54
eH2_5                 1.329871e-02 1 1  ON 55
eH2_6                 4.407721e-02 1 1  ON 56
eH2_7                 4.888545e-02 1 1  ON 57
eH2_8                 3.140207e-02 1 1  ON 58
eH2_9                 9.100351e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2561e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.3948
    reference variance = 0.562119
====================================================
  Execution time = 4.5756e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6953e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5151e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569609467789
                                         uncertainty =       0.007799853729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569609467789
                                         uncertainty =       0.007799853729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533632261
  error estimate for blocks of size 2^( 2) =       0.000553149956
  error estimate for blocks of size 2^( 3) =       0.000570957135
  error estimate for blocks of size 2^( 4) =       0.000584438955
  error estimate for blocks of size 2^( 5) =       0.000593309956
  error estimate for blocks of size 2^( 6) =       0.000597352538
  error estimate for blocks of size 2^( 7) =       0.000600701272

      target function =                  N/A
              le_mean =     -22.437572841274
             les_mean =     504.014201503249
             stat err =       0.000593950680
             autocorr =       1.238843976025
              std dev =       0.754669981210
             le_variance =       0.569526780540


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243757284127e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437572841274       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437573026679       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437573243989       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437573678631       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437573844619       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437573599667       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437574013540       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437574063968       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437573972035       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437573864278       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437573897051       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+00 is 1.727183e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437572841274       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437572890688       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437572951845       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437573081440       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437573132983       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437573052502       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437573160341       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437573190070       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437573171930       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437573140405       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+00 is 4.371326e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437572841274       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437572853835       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437572869624       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437572903651       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437572917344       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437572895710       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437572922708       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437572931322       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437572927520       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437572919538       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+01 is 1.118873e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259515 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0915e+01
  </log>
  <optVariables href="FORMN2GVP1B.s017.opt.xml">
 uu_0                 2.708952e-01 1 1  ON 0
 uu_1                 9.603536e-02 1 1  ON 1
 uu_2                -1.966957e-02 1 1  ON 2
 uu_3                -8.883835e-02 1 1  ON 3
 uu_4                -1.290879e-01 1 1  ON 4
 uu_5                -1.525470e-01 1 1  ON 5
 uu_6                -1.632109e-01 1 1  ON 6
 uu_7                -1.597862e-01 1 1  ON 7
 uu_8                -1.390429e-01 1 1  ON 8
 uu_9                -8.518692e-02 1 1  ON 9
 ud_0                 4.436295e-01 1 1  ON 10
 ud_1                 1.596237e-01 1 1  ON 11
 ud_2                 1.028849e-02 1 1  ON 12
 ud_3                -7.282658e-02 1 1  ON 13
 ud_4                -1.210701e-01 1 1  ON 14
 ud_5                -1.518187e-01 1 1  ON 15
 ud_6                -1.696402e-01 1 1  ON 16
 ud_7                -1.729442e-01 1 1  ON 17
 ud_8                -1.574330e-01 1 1  ON 18
 ud_9                -1.120776e-01 1 1  ON 19
 eC_0                -6.266036e-01 1 1  ON 20
 eC_1                -4.556255e-01 1 1  ON 21
 eC_2                -1.580742e-01 1 1  ON 22
 eC_3                 5.267147e-02 1 1  ON 23
 eC_4                 1.828378e-01 1 1  ON 24
 eC_5                 2.866558e-01 1 1  ON 25
 eC_6                 2.829358e-01 1 1  ON 26
 eC_7                 2.822266e-01 1 1  ON 27
 eC_8                 1.229564e-01 1 1  ON 28
 eC_9                 2.665222e-02 1 1  ON 29
 eO_0                -1.144085e+00 1 1  ON 30
 eO_1                -7.539959e-01 1 1  ON 31
 eO_2                -2.670035e-01 1 1  ON 32
 eO_3                 4.957422e-02 1 1  ON 33
 eO_4                 2.642741e-01 1 1  ON 34
 eO_5                 3.930644e-01 1 1  ON 35
 eO_6                 4.127980e-01 1 1  ON 36
 eO_7                 4.155136e-01 1 1  ON 37
 eO_8                 3.661085e-01 1 1  ON 38
 eO_9                 1.896160e-01 1 1  ON 39
eH1_0                -1.591204e-01 1 1  ON 40
eH1_1                -5.838875e-02 1 1  ON 41
eH1_2                -3.791642e-02 1 1  ON 42
eH1_3                -3.639470e-02 1 1  ON 43
eH1_4                 2.257242e-03 1 1  ON 44
eH1_5                 1.472489e-02 1 1  ON 45
eH1_6                 4.561598e-02 1 1  ON 46
eH1_7                 5.239674e-02 1 1  ON 47
eH1_8                 3.200104e-02 1 1  ON 48
eH1_9                 8.534860e-02 1 1  ON 49
eH2_0                -1.603658e-01 1 1  ON 50
eH2_1                -5.951505e-02 1 1  ON 51
eH2_2                -3.861024e-02 1 1  ON 52
eH2_3                -3.728089e-02 1 1  ON 53
eH2_4                 1.021000e-03 1 1  ON 54
eH2_5                 1.329701e-02 1 1  ON 55
eH2_6                 4.406231e-02 1 1  ON 56
eH2_7                 4.889980e-02 1 1  ON 57
eH2_8                 3.140245e-02 1 1  ON 58
eH2_9                 9.101081e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.4967
    reference variance = 0.317407
====================================================
  Execution time = 4.4661e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6832e-01
  Total weights = 2.0000e+06
  Execution time = 3.8372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568465600500
                                         uncertainty =       0.006813203393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568465600500
                                         uncertainty =       0.006813203393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533065654
  error estimate for blocks of size 2^( 2) =       0.000552912941
  error estimate for blocks of size 2^( 3) =       0.000571235209
  error estimate for blocks of size 2^( 4) =       0.000584992322
  error estimate for blocks of size 2^( 5) =       0.000593438161
  error estimate for blocks of size 2^( 6) =       0.000597937511
  error estimate for blocks of size 2^( 7) =       0.000600591140

      target function =                  N/A
              le_mean =     -22.436843809601
             les_mean =     503.980277835872
             stat err =       0.000594239784
             autocorr =       1.242687827872
              std dev =       0.753868677969
             le_variance =       0.568317983622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568471939845
                                         uncertainty =       0.006813763188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568471939845
                                         uncertainty =       0.006813763188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533068637
  error estimate for blocks of size 2^( 2) =       0.000552915136
  error estimate for blocks of size 2^( 3) =       0.000571237242
  error estimate for blocks of size 2^( 4) =       0.000584992305
  error estimate for blocks of size 2^( 5) =       0.000593437898
  error estimate for blocks of size 2^( 6) =       0.000597936994
  error estimate for blocks of size 2^( 7) =       0.000600594615

      target function =                  N/A
              le_mean =     -22.436843423784
             les_mean =     503.980266883262
             stat err =       0.000594240453
             autocorr =       1.242676720930
              std dev =       0.753872896474
             le_variance =       0.568324344038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568461874932
                                         uncertainty =       0.006813453440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568461874932
                                         uncertainty =       0.006813453440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533063914
  error estimate for blocks of size 2^( 2) =       0.000552910917
  error estimate for blocks of size 2^( 3) =       0.000571233235
  error estimate for blocks of size 2^( 4) =       0.000584989206
  error estimate for blocks of size 2^( 5) =       0.000593434976
  error estimate for blocks of size 2^( 6) =       0.000597934242
  error estimate for blocks of size 2^( 7) =       0.000600590425

      target function =                  N/A
              le_mean =     -22.436843520968
             les_mean =     503.980261172850
             stat err =       0.000594237213
             autocorr =       1.242685189391
              std dev =       0.753866216654
             le_variance =       0.568314272612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568464917418
                                         uncertainty =       0.006813232804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568464917418
                                         uncertainty =       0.006813232804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533065335
  error estimate for blocks of size 2^( 2) =       0.000552912588
  error estimate for blocks of size 2^( 3) =       0.000571234864
  error estimate for blocks of size 2^( 4) =       0.000584991829
  error estimate for blocks of size 2^( 5) =       0.000593437661
  error estimate for blocks of size 2^( 6) =       0.000597937003
  error estimate for blocks of size 2^( 7) =       0.000600590974

      target function =                  N/A
              le_mean =     -22.436843767750
             les_mean =     503.980275276798
             stat err =       0.000594239367
             autocorr =       1.242687573384
              std dev =       0.753868226239
             le_variance =       0.568317302533


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436843809601        initial  <--
     1.5259e+00     1.5259e+01             1.7272e-04       -22.436843423784
     6.1035e+00     6.1035e+01             4.3713e-05       -22.436843520968
     2.4414e+01     2.4414e+02             1.1189e-05       -22.436843767750

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8671
  </log>
  <optVariables href="FORMN2GVP1B.s017.opt.xml">
 uu_0                 2.708931e-01 1 1  ON 0
 uu_1                 9.604535e-02 1 1  ON 1
 uu_2                -1.965884e-02 1 1  ON 2
 uu_3                -8.882051e-02 1 1  ON 3
 uu_4                -1.290814e-01 1 1  ON 4
 uu_5                -1.525428e-01 1 1  ON 5
 uu_6                -1.631997e-01 1 1  ON 6
 uu_7                -1.597749e-01 1 1  ON 7
 uu_8                -1.390421e-01 1 1  ON 8
 uu_9                -8.519435e-02 1 1  ON 9
 ud_0                 4.436424e-01 1 1  ON 10
 ud_1                 1.596177e-01 1 1  ON 11
 ud_2                 1.028920e-02 1 1  ON 12
 ud_3                -7.282833e-02 1 1  ON 13
 ud_4                -1.210801e-01 1 1  ON 14
 ud_5                -1.518054e-01 1 1  ON 15
 ud_6                -1.696638e-01 1 1  ON 16
 ud_7                -1.729189e-01 1 1  ON 17
 ud_8                -1.574415e-01 1 1  ON 18
 ud_9                -1.120810e-01 1 1  ON 19
 eC_0                -6.265966e-01 1 1  ON 20
 eC_1                -4.556279e-01 1 1  ON 21
 eC_2                -1.580486e-01 1 1  ON 22
 eC_3                 5.269617e-02 1 1  ON 23
 eC_4                 1.828599e-01 1 1  ON 24
 eC_5                 2.866408e-01 1 1  ON 25
 eC_6                 2.829190e-01 1 1  ON 26
 eC_7                 2.822138e-01 1 1  ON 27
 eC_8                 1.229308e-01 1 1  ON 28
 eC_9                 2.664563e-02 1 1  ON 29
 eO_0                -1.144042e+00 1 1  ON 30
 eO_1                -7.539946e-01 1 1  ON 31
 eO_2                -2.669919e-01 1 1  ON 32
 eO_3                 4.959550e-02 1 1  ON 33
 eO_4                 2.642843e-01 1 1  ON 34
 eO_5                 3.930838e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155121e-01 1 1  ON 37
 eO_8                 3.660659e-01 1 1  ON 38
 eO_9                 1.895740e-01 1 1  ON 39
eH1_0                -1.591231e-01 1 1  ON 40
eH1_1                -5.837655e-02 1 1  ON 41
eH1_2                -3.792661e-02 1 1  ON 42
eH1_3                -3.639844e-02 1 1  ON 43
eH1_4                 2.254634e-03 1 1  ON 44
eH1_5                 1.472089e-02 1 1  ON 45
eH1_6                 4.561932e-02 1 1  ON 46
eH1_7                 5.240212e-02 1 1  ON 47
eH1_8                 3.200494e-02 1 1  ON 48
eH1_9                 8.535582e-02 1 1  ON 49
eH2_0                -1.603488e-01 1 1  ON 50
eH2_1                -5.951203e-02 1 1  ON 51
eH2_2                -3.860394e-02 1 1  ON 52
eH2_3                -3.728787e-02 1 1  ON 53
eH2_4                 1.023129e-03 1 1  ON 54
eH2_5                 1.329871e-02 1 1  ON 55
eH2_6                 4.407721e-02 1 1  ON 56
eH2_7                 4.888545e-02 1 1  ON 57
eH2_8                 3.140207e-02 1 1  ON 58
eH2_9                 9.100351e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2479e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.5293
    reference variance = 0.866525
====================================================
  Execution time = 4.7819e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6532e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5122e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565241054934
                                         uncertainty =       0.005410688595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565241054934
                                         uncertainty =       0.005410688595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531659233
  error estimate for blocks of size 2^( 2) =       0.000551300436
  error estimate for blocks of size 2^( 3) =       0.000569653660
  error estimate for blocks of size 2^( 4) =       0.000584757139
  error estimate for blocks of size 2^( 5) =       0.000594468651
  error estimate for blocks of size 2^( 6) =       0.000598448040
  error estimate for blocks of size 2^( 7) =       0.000601210172

      target function =                  N/A
              le_mean =     -22.436279460397
             les_mean =     503.951958822104
             stat err =       0.000594721000
             autocorr =       1.251295342144
              std dev =       0.751879697653
             le_variance =       0.565323079743


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243627946040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436279460397       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436279669600       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436279675135       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436279693917       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436279695041       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436279760266       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436279756410       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436279763981       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436279766459       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436279764659       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436279759949       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+01 is 2.306540e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436279460397       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436279513361       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436279514870       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436279519702       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436279519933       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436279536678       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436279535774       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436279537568       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436279538298       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436279537697       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436279536606       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+01 is 5.826562e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436279460397       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436279473680       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436279474065       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436279475282       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436279475337       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436279479552       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436279479330       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436279479771       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436279479961       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436279479800       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436279479533       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+02 is 1.460487e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.263797 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2950e+01
  </log>
  <optVariables href="FORMN2GVP1B.s018.opt.xml">
 uu_0                 2.708918e-01 1 1  ON 0
 uu_1                 9.604336e-02 1 1  ON 1
 uu_2                -1.965824e-02 1 1  ON 2
 uu_3                -8.882140e-02 1 1  ON 3
 uu_4                -1.290805e-01 1 1  ON 4
 uu_5                -1.525413e-01 1 1  ON 5
 uu_6                -1.631999e-01 1 1  ON 6
 uu_7                -1.597769e-01 1 1  ON 7
 uu_8                -1.390422e-01 1 1  ON 8
 uu_9                -8.519550e-02 1 1  ON 9
 ud_0                 4.436424e-01 1 1  ON 10
 ud_1                 1.596181e-01 1 1  ON 11
 ud_2                 1.029047e-02 1 1  ON 12
 ud_3                -7.282912e-02 1 1  ON 13
 ud_4                -1.210800e-01 1 1  ON 14
 ud_5                -1.518070e-01 1 1  ON 15
 ud_6                -1.696633e-01 1 1  ON 16
 ud_7                -1.729195e-01 1 1  ON 17
 ud_8                -1.574409e-01 1 1  ON 18
 ud_9                -1.120806e-01 1 1  ON 19
 eC_0                -6.265943e-01 1 1  ON 20
 eC_1                -4.556274e-01 1 1  ON 21
 eC_2                -1.580545e-01 1 1  ON 22
 eC_3                 5.269535e-02 1 1  ON 23
 eC_4                 1.828565e-01 1 1  ON 24
 eC_5                 2.866421e-01 1 1  ON 25
 eC_6                 2.829194e-01 1 1  ON 26
 eC_7                 2.822157e-01 1 1  ON 27
 eC_8                 1.229338e-01 1 1  ON 28
 eC_9                 2.664630e-02 1 1  ON 29
 eO_0                -1.144047e+00 1 1  ON 30
 eO_1                -7.539950e-01 1 1  ON 31
 eO_2                -2.669953e-01 1 1  ON 32
 eO_3                 4.959480e-02 1 1  ON 33
 eO_4                 2.642841e-01 1 1  ON 34
 eO_5                 3.930843e-01 1 1  ON 35
 eO_6                 4.127938e-01 1 1  ON 36
 eO_7                 4.155121e-01 1 1  ON 37
 eO_8                 3.660698e-01 1 1  ON 38
 eO_9                 1.895782e-01 1 1  ON 39
eH1_0                -1.591239e-01 1 1  ON 40
eH1_1                -5.837522e-02 1 1  ON 41
eH1_2                -3.792712e-02 1 1  ON 42
eH1_3                -3.639721e-02 1 1  ON 43
eH1_4                 2.254291e-03 1 1  ON 44
eH1_5                 1.471830e-02 1 1  ON 45
eH1_6                 4.561964e-02 1 1  ON 46
eH1_7                 5.240212e-02 1 1  ON 47
eH1_8                 3.200490e-02 1 1  ON 48
eH1_9                 8.535621e-02 1 1  ON 49
eH2_0                -1.603473e-01 1 1  ON 50
eH2_1                -5.951384e-02 1 1  ON 51
eH2_2                -3.860351e-02 1 1  ON 52
eH2_3                -3.728736e-02 1 1  ON 53
eH2_4                 1.022655e-03 1 1  ON 54
eH2_5                 1.329963e-02 1 1  ON 55
eH2_6                 4.407403e-02 1 1  ON 56
eH2_7                 4.888664e-02 1 1  ON 57
eH2_8                 3.140143e-02 1 1  ON 58
eH2_9                 9.100364e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.3899
    reference variance = 0.464676
====================================================
  Execution time = 4.5079e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7132e-01
  Total weights = 2.0000e+06
  Execution time = 3.8323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571388389790
                                         uncertainty =       0.005343459447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571388389790
                                         uncertainty =       0.005343459447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534471276
  error estimate for blocks of size 2^( 2) =       0.000554123053
  error estimate for blocks of size 2^( 3) =       0.000572620661
  error estimate for blocks of size 2^( 4) =       0.000585288887
  error estimate for blocks of size 2^( 5) =       0.000594993844
  error estimate for blocks of size 2^( 6) =       0.000600102517
  error estimate for blocks of size 2^( 7) =       0.000599814413

      target function =                  N/A
              le_mean =     -22.436592043533
             les_mean =     503.971981331190
             stat err =       0.000595049915
             autocorr =       1.239532891509
              std dev =       0.755856526689
             le_variance =       0.571319088939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571381126000
                                         uncertainty =       0.005343387840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571381126000
                                         uncertainty =       0.005343387840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534467882
  error estimate for blocks of size 2^( 2) =       0.000554119787
  error estimate for blocks of size 2^( 3) =       0.000572617436
  error estimate for blocks of size 2^( 4) =       0.000585285739
  error estimate for blocks of size 2^( 5) =       0.000594990595
  error estimate for blocks of size 2^( 6) =       0.000600099723
  error estimate for blocks of size 2^( 7) =       0.000599811585

      target function =                  N/A
              le_mean =     -22.436592065736
             les_mean =     503.971975072333
             stat err =       0.000595046910
             autocorr =       1.239536115153
              std dev =       0.755851727355
             le_variance =       0.571311833745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571384622043
                                         uncertainty =       0.005343421685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571384622043
                                         uncertainty =       0.005343421685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534469515
  error estimate for blocks of size 2^( 2) =       0.000554121360
  error estimate for blocks of size 2^( 3) =       0.000572618991
  error estimate for blocks of size 2^( 4) =       0.000585287255
  error estimate for blocks of size 2^( 5) =       0.000594992162
  error estimate for blocks of size 2^( 6) =       0.000600101068
  error estimate for blocks of size 2^( 7) =       0.000599812947

      target function =                  N/A
              le_mean =     -22.436592054424
             les_mean =     503.971978056609
             stat err =       0.000595048358
             autocorr =       1.239534571088
              std dev =       0.755854037242
             le_variance =       0.571315325615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571387914087
                                         uncertainty =       0.005343454661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571387914087
                                         uncertainty =       0.005343454661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534471053
  error estimate for blocks of size 2^( 2) =       0.000554122839
  error estimate for blocks of size 2^( 3) =       0.000572620450
  error estimate for blocks of size 2^( 4) =       0.000585288681
  error estimate for blocks of size 2^( 5) =       0.000594993631
  error estimate for blocks of size 2^( 6) =       0.000600102334
  error estimate for blocks of size 2^( 7) =       0.000599814227

      target function =                  N/A
              le_mean =     -22.436592044847
             les_mean =     503.971980915032
             stat err =       0.000595049718
             autocorr =       1.239533103676
              std dev =       0.755856212380
             le_variance =       0.571318613793


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436592043533        initial
     1.5259e+01     1.5259e+02             2.3065e-05       -22.436592065736  <--
     6.1035e+01     6.1035e+02             5.8266e-06       -22.436592054424
     2.4414e+02     2.4414e+03             1.4605e-06       -22.436592044847

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 6.4271e+01
  </log>
  <optVariables href="FORMN2GVP1B.s018.opt.xml">
 uu_0                 2.708879e-01 1 1  ON 0
 uu_1                 9.603760e-02 1 1  ON 1
 uu_2                -1.965661e-02 1 1  ON 2
 uu_3                -8.882394e-02 1 1  ON 3
 uu_4                -1.290777e-01 1 1  ON 4
 uu_5                -1.525369e-01 1 1  ON 5
 uu_6                -1.632002e-01 1 1  ON 6
 uu_7                -1.597829e-01 1 1  ON 7
 uu_8                -1.390423e-01 1 1  ON 8
 uu_9                -8.519896e-02 1 1  ON 9
 ud_0                 4.436424e-01 1 1  ON 10
 ud_1                 1.596193e-01 1 1  ON 11
 ud_2                 1.029415e-02 1 1  ON 12
 ud_3                -7.283139e-02 1 1  ON 13
 ud_4                -1.210798e-01 1 1  ON 14
 ud_5                -1.518117e-01 1 1  ON 15
 ud_6                -1.696621e-01 1 1  ON 16
 ud_7                -1.729213e-01 1 1  ON 17
 ud_8                -1.574391e-01 1 1  ON 18
 ud_9                -1.120794e-01 1 1  ON 19
 eC_0                -6.265872e-01 1 1  ON 20
 eC_1                -4.556260e-01 1 1  ON 21
 eC_2                -1.580717e-01 1 1  ON 22
 eC_3                 5.269276e-02 1 1  ON 23
 eC_4                 1.828464e-01 1 1  ON 24
 eC_5                 2.866459e-01 1 1  ON 25
 eC_6                 2.829208e-01 1 1  ON 26
 eC_7                 2.822213e-01 1 1  ON 27
 eC_8                 1.229428e-01 1 1  ON 28
 eC_9                 2.664831e-02 1 1  ON 29
 eO_0                -1.144063e+00 1 1  ON 30
 eO_1                -7.539966e-01 1 1  ON 31
 eO_2                -2.670054e-01 1 1  ON 32
 eO_3                 4.959259e-02 1 1  ON 33
 eO_4                 2.642836e-01 1 1  ON 34
 eO_5                 3.930857e-01 1 1  ON 35
 eO_6                 4.127935e-01 1 1  ON 36
 eO_7                 4.155122e-01 1 1  ON 37
 eO_8                 3.660813e-01 1 1  ON 38
 eO_9                 1.895909e-01 1 1  ON 39
eH1_0                -1.591262e-01 1 1  ON 40
eH1_1                -5.837129e-02 1 1  ON 41
eH1_2                -3.792857e-02 1 1  ON 42
eH1_3                -3.639360e-02 1 1  ON 43
eH1_4                 2.253314e-03 1 1  ON 44
eH1_5                 1.471061e-02 1 1  ON 45
eH1_6                 4.562057e-02 1 1  ON 46
eH1_7                 5.240209e-02 1 1  ON 47
eH1_8                 3.200480e-02 1 1  ON 48
eH1_9                 8.535739e-02 1 1  ON 49
eH2_0                -1.603428e-01 1 1  ON 50
eH2_1                -5.951923e-02 1 1  ON 51
eH2_2                -3.860221e-02 1 1  ON 52
eH2_3                -3.728588e-02 1 1  ON 53
eH2_4                 1.021330e-03 1 1  ON 54
eH2_5                 1.330232e-02 1 1  ON 55
eH2_6                 4.406460e-02 1 1  ON 56
eH2_7                 4.889014e-02 1 1  ON 57
eH2_8                 3.139950e-02 1 1  ON 58
eH2_9                 9.100401e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2723e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2440e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.5256
    reference variance = 1.34934
====================================================
  Execution time = 4.5895e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5607e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5021e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556168251574
                                         uncertainty =       0.003662452954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556168251574
                                         uncertainty =       0.003662452954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527289718
  error estimate for blocks of size 2^( 2) =       0.000547049482
  error estimate for blocks of size 2^( 3) =       0.000565078300
  error estimate for blocks of size 2^( 4) =       0.000579175593
  error estimate for blocks of size 2^( 5) =       0.000589139734
  error estimate for blocks of size 2^( 6) =       0.000593560628
  error estimate for blocks of size 2^( 7) =       0.000595415580

      target function =                  N/A
              le_mean =     -22.435900177137
             les_mean =     503.925685373645
             stat err =       0.000589322884
             autocorr =       1.249131053985
              std dev =       0.745700270353
             le_variance =       0.556068893205


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243590017714e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435900177137       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435900217725       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435900308986       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435900527246       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435900544537       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435900628201       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435900709508       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435900731334       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435900769712       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435900714479       residual = 8.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+00 is 6.554823e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435900177137       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435900187667       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435900211301       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435900268638       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435900272662       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435900294747       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435900317283       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435900322158       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435900331481       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435900318453       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+01 is 1.650465e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435900177137       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435900179795       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435900185757       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435900200278       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435900201264       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435900206868       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435900212656       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435900213838       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435900216145       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435900212944       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+01 is 4.132803e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267452 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0923e+01
  </log>
  <optVariables href="FORMN2GVP1B.s019.opt.xml">
 uu_0                 2.708800e-01 1 1  ON 0
 uu_1                 9.603463e-02 1 1  ON 1
 uu_2                -1.966129e-02 1 1  ON 2
 uu_3                -8.882910e-02 1 1  ON 3
 uu_4                -1.290778e-01 1 1  ON 4
 uu_5                -1.525344e-01 1 1  ON 5
 uu_6                -1.631944e-01 1 1  ON 6
 uu_7                -1.597837e-01 1 1  ON 7
 uu_8                -1.390437e-01 1 1  ON 8
 uu_9                -8.520525e-02 1 1  ON 9
 ud_0                 4.436312e-01 1 1  ON 10
 ud_1                 1.596281e-01 1 1  ON 11
 ud_2                 1.029882e-02 1 1  ON 12
 ud_3                -7.282741e-02 1 1  ON 13
 ud_4                -1.210799e-01 1 1  ON 14
 ud_5                -1.518137e-01 1 1  ON 15
 ud_6                -1.696624e-01 1 1  ON 16
 ud_7                -1.729272e-01 1 1  ON 17
 ud_8                -1.574415e-01 1 1  ON 18
 ud_9                -1.120798e-01 1 1  ON 19
 eC_0                -6.266020e-01 1 1  ON 20
 eC_1                -4.556227e-01 1 1  ON 21
 eC_2                -1.580760e-01 1 1  ON 22
 eC_3                 5.269006e-02 1 1  ON 23
 eC_4                 1.828321e-01 1 1  ON 24
 eC_5                 2.866568e-01 1 1  ON 25
 eC_6                 2.829214e-01 1 1  ON 26
 eC_7                 2.822275e-01 1 1  ON 27
 eC_8                 1.229543e-01 1 1  ON 28
 eC_9                 2.665168e-02 1 1  ON 29
 eO_0                -1.144074e+00 1 1  ON 30
 eO_1                -7.539970e-01 1 1  ON 31
 eO_2                -2.670152e-01 1 1  ON 32
 eO_3                 4.958515e-02 1 1  ON 33
 eO_4                 2.642766e-01 1 1  ON 34
 eO_5                 3.930809e-01 1 1  ON 35
 eO_6                 4.127937e-01 1 1  ON 36
 eO_7                 4.155147e-01 1 1  ON 37
 eO_8                 3.660952e-01 1 1  ON 38
 eO_9                 1.896074e-01 1 1  ON 39
eH1_0                -1.591263e-01 1 1  ON 40
eH1_1                -5.837783e-02 1 1  ON 41
eH1_2                -3.792305e-02 1 1  ON 42
eH1_3                -3.639075e-02 1 1  ON 43
eH1_4                 2.258315e-03 1 1  ON 44
eH1_5                 1.470276e-02 1 1  ON 45
eH1_6                 4.561892e-02 1 1  ON 46
eH1_7                 5.240116e-02 1 1  ON 47
eH1_8                 3.200318e-02 1 1  ON 48
eH1_9                 8.535701e-02 1 1  ON 49
eH2_0                -1.603500e-01 1 1  ON 50
eH2_1                -5.952997e-02 1 1  ON 51
eH2_2                -3.859570e-02 1 1  ON 52
eH2_3                -3.729032e-02 1 1  ON 53
eH2_4                 1.025191e-03 1 1  ON 54
eH2_5                 1.329942e-02 1 1  ON 55
eH2_6                 4.406747e-02 1 1  ON 56
eH2_7                 4.889585e-02 1 1  ON 57
eH2_8                 3.139858e-02 1 1  ON 58
eH2_9                 9.100608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6078
    reference variance = 0.912054
====================================================
  Execution time = 4.5021e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.8013e-01
  Total weights = 2.0000e+06
  Execution time = 3.8276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.580126686942
                                         uncertainty =       0.008236273105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.580126686942
                                         uncertainty =       0.008236273105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538584980
  error estimate for blocks of size 2^( 2) =       0.000558198613
  error estimate for blocks of size 2^( 3) =       0.000575936590
  error estimate for blocks of size 2^( 4) =       0.000589929329
  error estimate for blocks of size 2^( 5) =       0.000598532025
  error estimate for blocks of size 2^( 6) =       0.000603199270
  error estimate for blocks of size 2^( 7) =       0.000606194952

      target function =                  N/A
              le_mean =     -22.437013715837
             les_mean =     503.999731755122
             stat err =       0.000599463894
             autocorr =       1.238846751462
              std dev =       0.761674182674
             le_variance =       0.580147560552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.580062894623
                                         uncertainty =       0.008236024083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.580062894623
                                         uncertainty =       0.008236024083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538555371
  error estimate for blocks of size 2^( 2) =       0.000558170171
  error estimate for blocks of size 2^( 3) =       0.000575909730
  error estimate for blocks of size 2^( 4) =       0.000589902667
  error estimate for blocks of size 2^( 5) =       0.000598505511
  error estimate for blocks of size 2^( 6) =       0.000603172350
  error estimate for blocks of size 2^( 7) =       0.000606168483

      target function =                  N/A
              le_mean =     -22.437013294110
             les_mean =     503.999649045409
             stat err =       0.000599437253
             autocorr =       1.238872849085
              std dev =       0.761632309826
             le_variance =       0.580083775371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.580090758446
                                         uncertainty =       0.008236133943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.580090758446
                                         uncertainty =       0.008236133943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538568304
  error estimate for blocks of size 2^( 2) =       0.000558182594
  error estimate for blocks of size 2^( 3) =       0.000575921458
  error estimate for blocks of size 2^( 4) =       0.000589914317
  error estimate for blocks of size 2^( 5) =       0.000598517111
  error estimate for blocks of size 2^( 6) =       0.000603184127
  error estimate for blocks of size 2^( 7) =       0.000606180022

      target function =                  N/A
              le_mean =     -22.437013478130
             les_mean =     503.999685163062
             stat err =       0.000599448894
             autocorr =       1.238861470841
              std dev =       0.761650599240
             le_variance =       0.580111635322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.580122049874
                                         uncertainty =       0.008236255263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.580122049874
                                         uncertainty =       0.008236255263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538582827
  error estimate for blocks of size 2^( 2) =       0.000558196546
  error estimate for blocks of size 2^( 3) =       0.000575934637
  error estimate for blocks of size 2^( 4) =       0.000589927392
  error estimate for blocks of size 2^( 5) =       0.000598530101
  error estimate for blocks of size 2^( 6) =       0.000603197316
  error estimate for blocks of size 2^( 7) =       0.000606193024

      target function =                  N/A
              le_mean =     -22.437013684774
             les_mean =     503.999725724539
             stat err =       0.000599461958
             autocorr =       1.238848650230
              std dev =       0.761671138929
             le_variance =       0.580142923877


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437013715837        initial  <--
     3.8147e+00     3.8147e+01             6.5548e-05       -22.437013294110
     1.5259e+01     1.5259e+02             1.6505e-05       -22.437013478130
     6.1035e+01     6.1035e+02             4.1328e-06       -22.437013684774

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.2802
  </log>
  <optVariables href="FORMN2GVP1B.s019.opt.xml">
 uu_0                 2.708879e-01 1 1  ON 0
 uu_1                 9.603760e-02 1 1  ON 1
 uu_2                -1.965661e-02 1 1  ON 2
 uu_3                -8.882394e-02 1 1  ON 3
 uu_4                -1.290777e-01 1 1  ON 4
 uu_5                -1.525369e-01 1 1  ON 5
 uu_6                -1.632002e-01 1 1  ON 6
 uu_7                -1.597829e-01 1 1  ON 7
 uu_8                -1.390423e-01 1 1  ON 8
 uu_9                -8.519896e-02 1 1  ON 9
 ud_0                 4.436424e-01 1 1  ON 10
 ud_1                 1.596193e-01 1 1  ON 11
 ud_2                 1.029415e-02 1 1  ON 12
 ud_3                -7.283139e-02 1 1  ON 13
 ud_4                -1.210798e-01 1 1  ON 14
 ud_5                -1.518117e-01 1 1  ON 15
 ud_6                -1.696621e-01 1 1  ON 16
 ud_7                -1.729213e-01 1 1  ON 17
 ud_8                -1.574391e-01 1 1  ON 18
 ud_9                -1.120794e-01 1 1  ON 19
 eC_0                -6.265872e-01 1 1  ON 20
 eC_1                -4.556260e-01 1 1  ON 21
 eC_2                -1.580717e-01 1 1  ON 22
 eC_3                 5.269276e-02 1 1  ON 23
 eC_4                 1.828464e-01 1 1  ON 24
 eC_5                 2.866459e-01 1 1  ON 25
 eC_6                 2.829208e-01 1 1  ON 26
 eC_7                 2.822213e-01 1 1  ON 27
 eC_8                 1.229428e-01 1 1  ON 28
 eC_9                 2.664831e-02 1 1  ON 29
 eO_0                -1.144063e+00 1 1  ON 30
 eO_1                -7.539966e-01 1 1  ON 31
 eO_2                -2.670054e-01 1 1  ON 32
 eO_3                 4.959259e-02 1 1  ON 33
 eO_4                 2.642836e-01 1 1  ON 34
 eO_5                 3.930857e-01 1 1  ON 35
 eO_6                 4.127935e-01 1 1  ON 36
 eO_7                 4.155122e-01 1 1  ON 37
 eO_8                 3.660813e-01 1 1  ON 38
 eO_9                 1.895909e-01 1 1  ON 39
eH1_0                -1.591262e-01 1 1  ON 40
eH1_1                -5.837129e-02 1 1  ON 41
eH1_2                -3.792857e-02 1 1  ON 42
eH1_3                -3.639360e-02 1 1  ON 43
eH1_4                 2.253314e-03 1 1  ON 44
eH1_5                 1.471061e-02 1 1  ON 45
eH1_6                 4.562057e-02 1 1  ON 46
eH1_7                 5.240209e-02 1 1  ON 47
eH1_8                 3.200480e-02 1 1  ON 48
eH1_9                 8.535739e-02 1 1  ON 49
eH2_0                -1.603428e-01 1 1  ON 50
eH2_1                -5.951923e-02 1 1  ON 51
eH2_2                -3.860221e-02 1 1  ON 52
eH2_3                -3.728588e-02 1 1  ON 53
eH2_4                 1.021330e-03 1 1  ON 54
eH2_5                 1.330232e-02 1 1  ON 55
eH2_6                 4.406460e-02 1 1  ON 56
eH2_7                 4.889014e-02 1 1  ON 57
eH2_8                 3.139950e-02 1 1  ON 58
eH2_9                 9.100401e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2521e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2447e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.3642
    reference variance = 0.566775
====================================================
  Execution time = 4.5663e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5933e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5252e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559176481832
                                         uncertainty =       0.003459059637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559176481832
                                         uncertainty =       0.003459059637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528835850
  error estimate for blocks of size 2^( 2) =       0.000548823981
  error estimate for blocks of size 2^( 3) =       0.000567509794
  error estimate for blocks of size 2^( 4) =       0.000581841363
  error estimate for blocks of size 2^( 5) =       0.000590438891
  error estimate for blocks of size 2^( 6) =       0.000595608303
  error estimate for blocks of size 2^( 7) =       0.000597177817

      target function =                  N/A
              le_mean =     -22.436988293636
             les_mean =     503.977778121431
             stat err =       0.000591266593
             autocorr =       1.250042869384
              std dev =       0.747886831243
             le_variance =       0.559334712347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243698829364e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436988293636       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436988287228       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436988273759       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436988245700       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436988246811       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436988236915       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436988241653       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436988248605       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436988254039       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436988252333       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436988253628       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+01 is 6.993731e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436988293636       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436988292029       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436988288642       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436988281543       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436988281757       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436988279243       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436988280373       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436988282132       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436988283527       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436988283099       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436988283411       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+02 is 1.748592e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436988293636       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436988293234       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436988292386       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436988290606       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436988290655       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436988290024       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436988290302       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436988290747       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436988291096       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436988290986       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436988291063       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+02 is 4.371574e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271753 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0923e+01
  </log>
  <optVariables href="FORMN2GVP1B.s020.opt.xml">
 uu_0                 2.708879e-01 1 1  ON 0
 uu_1                 9.603678e-02 1 1  ON 1
 uu_2                -1.965653e-02 1 1  ON 2
 uu_3                -8.882447e-02 1 1  ON 3
 uu_4                -1.290774e-01 1 1  ON 4
 uu_5                -1.525377e-01 1 1  ON 5
 uu_6                -1.632004e-01 1 1  ON 6
 uu_7                -1.597824e-01 1 1  ON 7
 uu_8                -1.390418e-01 1 1  ON 8
 uu_9                -8.519935e-02 1 1  ON 9
 ud_0                 4.436419e-01 1 1  ON 10
 ud_1                 1.596194e-01 1 1  ON 11
 ud_2                 1.029439e-02 1 1  ON 12
 ud_3                -7.283169e-02 1 1  ON 13
 ud_4                -1.210789e-01 1 1  ON 14
 ud_5                -1.518120e-01 1 1  ON 15
 ud_6                -1.696617e-01 1 1  ON 16
 ud_7                -1.729219e-01 1 1  ON 17
 ud_8                -1.574394e-01 1 1  ON 18
 ud_9                -1.120790e-01 1 1  ON 19
 eC_0                -6.265877e-01 1 1  ON 20
 eC_1                -4.556268e-01 1 1  ON 21
 eC_2                -1.580717e-01 1 1  ON 22
 eC_3                 5.269234e-02 1 1  ON 23
 eC_4                 1.828461e-01 1 1  ON 24
 eC_5                 2.866453e-01 1 1  ON 25
 eC_6                 2.829211e-01 1 1  ON 26
 eC_7                 2.822221e-01 1 1  ON 27
 eC_8                 1.229439e-01 1 1  ON 28
 eC_9                 2.664857e-02 1 1  ON 29
 eO_0                -1.144064e+00 1 1  ON 30
 eO_1                -7.539980e-01 1 1  ON 31
 eO_2                -2.670058e-01 1 1  ON 32
 eO_3                 4.959163e-02 1 1  ON 33
 eO_4                 2.642830e-01 1 1  ON 34
 eO_5                 3.930855e-01 1 1  ON 35
 eO_6                 4.127937e-01 1 1  ON 36
 eO_7                 4.155121e-01 1 1  ON 37
 eO_8                 3.660829e-01 1 1  ON 38
 eO_9                 1.895926e-01 1 1  ON 39
eH1_0                -1.591259e-01 1 1  ON 40
eH1_1                -5.837187e-02 1 1  ON 41
eH1_2                -3.792821e-02 1 1  ON 42
eH1_3                -3.639276e-02 1 1  ON 43
eH1_4                 2.253163e-03 1 1  ON 44
eH1_5                 1.471034e-02 1 1  ON 45
eH1_6                 4.561991e-02 1 1  ON 46
eH1_7                 5.240206e-02 1 1  ON 47
eH1_8                 3.200458e-02 1 1  ON 48
eH1_9                 8.535730e-02 1 1  ON 49
eH2_0                -1.603429e-01 1 1  ON 50
eH2_1                -5.951928e-02 1 1  ON 51
eH2_2                -3.860192e-02 1 1  ON 52
eH2_3                -3.728649e-02 1 1  ON 53
eH2_4                 1.020861e-03 1 1  ON 54
eH2_5                 1.330262e-02 1 1  ON 55
eH2_6                 4.406386e-02 1 1  ON 56
eH2_7                 4.889055e-02 1 1  ON 57
eH2_8                 3.139973e-02 1 1  ON 58
eH2_9                 9.100414e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.4813
    reference variance = 0.415067
====================================================
  Execution time = 4.6612e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6319e-01
  Total weights = 2.0000e+06
  Execution time = 3.8294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563226038025
                                         uncertainty =       0.004038137430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563226038025
                                         uncertainty =       0.004038137430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530653800
  error estimate for blocks of size 2^( 2) =       0.000550264251
  error estimate for blocks of size 2^( 3) =       0.000568508165
  error estimate for blocks of size 2^( 4) =       0.000582407429
  error estimate for blocks of size 2^( 5) =       0.000590541155
  error estimate for blocks of size 2^( 6) =       0.000595531591
  error estimate for blocks of size 2^( 7) =       0.000601707083

      target function =                  N/A
              le_mean =     -22.437229833239
             les_mean =     503.992469219013
             stat err =       0.000592546814
             autocorr =       1.246874600211
              std dev =       0.750457800956
             le_variance =       0.563186911016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563221538955
                                         uncertainty =       0.004038083036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563221538955
                                         uncertainty =       0.004038083036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530651680
  error estimate for blocks of size 2^( 2) =       0.000550262218
  error estimate for blocks of size 2^( 3) =       0.000568506234
  error estimate for blocks of size 2^( 4) =       0.000582405515
  error estimate for blocks of size 2^( 5) =       0.000590539262
  error estimate for blocks of size 2^( 6) =       0.000595529725
  error estimate for blocks of size 2^( 7) =       0.000601705227

      target function =                  N/A
              le_mean =     -22.437229849443
             les_mean =     503.992465446591
             stat err =       0.000592544932
             autocorr =       1.246876639757
              std dev =       0.750454803065
             le_variance =       0.563182411443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563223761495
                                         uncertainty =       0.004038109924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563223761495
                                         uncertainty =       0.004038109924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530652727
  error estimate for blocks of size 2^( 2) =       0.000550263222
  error estimate for blocks of size 2^( 3) =       0.000568507188
  error estimate for blocks of size 2^( 4) =       0.000582406460
  error estimate for blocks of size 2^( 5) =       0.000590540197
  error estimate for blocks of size 2^( 6) =       0.000595530647
  error estimate for blocks of size 2^( 7) =       0.000601706144

      target function =                  N/A
              le_mean =     -22.437229841311
             les_mean =     503.992467304450
             stat err =       0.000592545862
             autocorr =       1.246875632867
              std dev =       0.750456284024
             le_variance =       0.563184634231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563225752561
                                         uncertainty =       0.004038133982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563225752561
                                         uncertainty =       0.004038133982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530653666
  error estimate for blocks of size 2^( 2) =       0.000550264122
  error estimate for blocks of size 2^( 3) =       0.000568508042
  error estimate for blocks of size 2^( 4) =       0.000582407307
  error estimate for blocks of size 2^( 5) =       0.000590541035
  error estimate for blocks of size 2^( 6) =       0.000595531473
  error estimate for blocks of size 2^( 7) =       0.000601706965

      target function =                  N/A
              le_mean =     -22.437229834243
             les_mean =     503.992468978558
             stat err =       0.000592546695
             autocorr =       1.246874729711
              std dev =       0.750457610741
             le_variance =       0.563186625520


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437229833239        initial
     3.8147e+01     3.8147e+02             6.9937e-06       -22.437229849443  <--
     1.5259e+02     1.5259e+03             1.7486e-06       -22.437229841311
     6.1035e+02     6.1035e+03             4.3716e-07       -22.437229834243

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 6.5778e+01
  </log>
  <optVariables href="FORMN2GVP1B.s020.opt.xml">
 uu_0                 2.708876e-01 1 1  ON 0
 uu_1                 9.603438e-02 1 1  ON 1
 uu_2                -1.965630e-02 1 1  ON 2
 uu_3                -8.882603e-02 1 1  ON 3
 uu_4                -1.290764e-01 1 1  ON 4
 uu_5                -1.525402e-01 1 1  ON 5
 uu_6                -1.632008e-01 1 1  ON 6
 uu_7                -1.597810e-01 1 1  ON 7
 uu_8                -1.390403e-01 1 1  ON 8
 uu_9                -8.520054e-02 1 1  ON 9
 ud_0                 4.436405e-01 1 1  ON 10
 ud_1                 1.596199e-01 1 1  ON 11
 ud_2                 1.029512e-02 1 1  ON 12
 ud_3                -7.283254e-02 1 1  ON 13
 ud_4                -1.210764e-01 1 1  ON 14
 ud_5                -1.518129e-01 1 1  ON 15
 ud_6                -1.696605e-01 1 1  ON 16
 ud_7                -1.729238e-01 1 1  ON 17
 ud_8                -1.574403e-01 1 1  ON 18
 ud_9                -1.120780e-01 1 1  ON 19
 eC_0                -6.265891e-01 1 1  ON 20
 eC_1                -4.556291e-01 1 1  ON 21
 eC_2                -1.580716e-01 1 1  ON 22
 eC_3                 5.269107e-02 1 1  ON 23
 eC_4                 1.828451e-01 1 1  ON 24
 eC_5                 2.866435e-01 1 1  ON 25
 eC_6                 2.829222e-01 1 1  ON 26
 eC_7                 2.822246e-01 1 1  ON 27
 eC_8                 1.229473e-01 1 1  ON 28
 eC_9                 2.664936e-02 1 1  ON 29
 eO_0                -1.144066e+00 1 1  ON 30
 eO_1                -7.540019e-01 1 1  ON 31
 eO_2                -2.670070e-01 1 1  ON 32
 eO_3                 4.958876e-02 1 1  ON 33
 eO_4                 2.642813e-01 1 1  ON 34
 eO_5                 3.930851e-01 1 1  ON 35
 eO_6                 4.127943e-01 1 1  ON 36
 eO_7                 4.155120e-01 1 1  ON 37
 eO_8                 3.660877e-01 1 1  ON 38
 eO_9                 1.895979e-01 1 1  ON 39
eH1_0                -1.591249e-01 1 1  ON 40
eH1_1                -5.837360e-02 1 1  ON 41
eH1_2                -3.792713e-02 1 1  ON 42
eH1_3                -3.639024e-02 1 1  ON 43
eH1_4                 2.252718e-03 1 1  ON 44
eH1_5                 1.470952e-02 1 1  ON 45
eH1_6                 4.561794e-02 1 1  ON 46
eH1_7                 5.240195e-02 1 1  ON 47
eH1_8                 3.200390e-02 1 1  ON 48
eH1_9                 8.535704e-02 1 1  ON 49
eH2_0                -1.603431e-01 1 1  ON 50
eH2_1                -5.951942e-02 1 1  ON 51
eH2_2                -3.860105e-02 1 1  ON 52
eH2_3                -3.728830e-02 1 1  ON 53
eH2_4                 1.019458e-03 1 1  ON 54
eH2_5                 1.330348e-02 1 1  ON 55
eH2_6                 4.406166e-02 1 1  ON 56
eH2_7                 4.889175e-02 1 1  ON 57
eH2_8                 3.140041e-02 1 1  ON 58
eH2_9                 9.100455e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2671e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2446e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.4686
    reference variance = 0.473838
====================================================
  Execution time = 4.6161e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6658e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5161e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566626212177
                                         uncertainty =       0.007263221006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566626212177
                                         uncertainty =       0.007263221006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532249915
  error estimate for blocks of size 2^( 2) =       0.000552040912
  error estimate for blocks of size 2^( 3) =       0.000570246049
  error estimate for blocks of size 2^( 4) =       0.000584388537
  error estimate for blocks of size 2^( 5) =       0.000593285972
  error estimate for blocks of size 2^( 6) =       0.000597951861
  error estimate for blocks of size 2^( 7) =       0.000603272226

      target function =                  N/A
              le_mean =     -22.437791606408
             les_mean =     504.021071834064
             stat err =       0.000594724649
             autocorr =       1.248534866738
              std dev =       0.752715048838
             le_variance =       0.566579944747


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243779160641e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437791606408       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437791658982       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437791654610       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437791680541       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437791734524       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437791754691       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437791801792       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437791800281       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437791800229       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437791806853       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+00 is 2.715071e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437791606408       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437791619721       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437791618716       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437791625168       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437791639083       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437791644155       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437791656170       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437791656171       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437791656178       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437791657706       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+01 is 6.801370e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437791606408       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437791609747       residual = 9.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437791609502       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437791611113       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437791614619       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437791615889       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437791618907       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437791618932       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437791618937       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437791619311       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+02 is 1.702603e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.275424 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1329e+01
  </log>
  <optVariables href="FORMN2GVP1B.s021.opt.xml">
 uu_0                 2.708870e-01 1 1  ON 0
 uu_1                 9.603150e-02 1 1  ON 1
 uu_2                -1.965694e-02 1 1  ON 2
 uu_3                -8.882624e-02 1 1  ON 3
 uu_4                -1.290778e-01 1 1  ON 4
 uu_5                -1.525412e-01 1 1  ON 5
 uu_6                -1.631994e-01 1 1  ON 6
 uu_7                -1.597840e-01 1 1  ON 7
 uu_8                -1.390379e-01 1 1  ON 8
 uu_9                -8.520123e-02 1 1  ON 9
 ud_0                 4.436416e-01 1 1  ON 10
 ud_1                 1.596210e-01 1 1  ON 11
 ud_2                 1.029513e-02 1 1  ON 12
 ud_3                -7.283358e-02 1 1  ON 13
 ud_4                -1.210726e-01 1 1  ON 14
 ud_5                -1.518162e-01 1 1  ON 15
 ud_6                -1.696563e-01 1 1  ON 16
 ud_7                -1.729260e-01 1 1  ON 17
 ud_8                -1.574417e-01 1 1  ON 18
 ud_9                -1.120793e-01 1 1  ON 19
 eC_0                -6.265900e-01 1 1  ON 20
 eC_1                -4.556331e-01 1 1  ON 21
 eC_2                -1.580719e-01 1 1  ON 22
 eC_3                 5.268921e-02 1 1  ON 23
 eC_4                 1.828435e-01 1 1  ON 24
 eC_5                 2.866412e-01 1 1  ON 25
 eC_6                 2.829237e-01 1 1  ON 26
 eC_7                 2.822290e-01 1 1  ON 27
 eC_8                 1.229514e-01 1 1  ON 28
 eC_9                 2.665036e-02 1 1  ON 29
 eO_0                -1.144073e+00 1 1  ON 30
 eO_1                -7.540003e-01 1 1  ON 31
 eO_2                -2.670111e-01 1 1  ON 32
 eO_3                 4.958686e-02 1 1  ON 33
 eO_4                 2.642789e-01 1 1  ON 34
 eO_5                 3.930833e-01 1 1  ON 35
 eO_6                 4.127942e-01 1 1  ON 36
 eO_7                 4.155113e-01 1 1  ON 37
 eO_8                 3.660943e-01 1 1  ON 38
 eO_9                 1.896047e-01 1 1  ON 39
eH1_0                -1.591273e-01 1 1  ON 40
eH1_1                -5.837688e-02 1 1  ON 41
eH1_2                -3.792478e-02 1 1  ON 42
eH1_3                -3.638570e-02 1 1  ON 43
eH1_4                 2.252015e-03 1 1  ON 44
eH1_5                 1.471332e-02 1 1  ON 45
eH1_6                 4.561710e-02 1 1  ON 46
eH1_7                 5.239681e-02 1 1  ON 47
eH1_8                 3.200352e-02 1 1  ON 48
eH1_9                 8.535729e-02 1 1  ON 49
eH2_0                -1.603424e-01 1 1  ON 50
eH2_1                -5.952060e-02 1 1  ON 51
eH2_2                -3.860369e-02 1 1  ON 52
eH2_3                -3.728875e-02 1 1  ON 53
eH2_4                 1.018641e-03 1 1  ON 54
eH2_5                 1.330152e-02 1 1  ON 55
eH2_6                 4.406006e-02 1 1  ON 56
eH2_7                 4.889611e-02 1 1  ON 57
eH2_8                 3.140146e-02 1 1  ON 58
eH2_9                 9.100505e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.5387
    reference variance = 0.545757
====================================================
  Execution time = 4.4898e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6508e-01
  Total weights = 2.0000e+06
  Execution time = 3.8295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565077029938
                                         uncertainty =       0.005139574340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565077029938
                                         uncertainty =       0.005139574340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531542215
  error estimate for blocks of size 2^( 2) =       0.000551317816
  error estimate for blocks of size 2^( 3) =       0.000570517002
  error estimate for blocks of size 2^( 4) =       0.000584624266
  error estimate for blocks of size 2^( 5) =       0.000592176854
  error estimate for blocks of size 2^( 6) =       0.000597443059
  error estimate for blocks of size 2^( 7) =       0.000602219465

      target function =                  N/A
              le_mean =     -22.436586885931
             les_mean =     503.965505061021
             stat err =       0.000594115911
             autocorr =       1.249300294283
              std dev =       0.751714210071
             le_variance =       0.565074253623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565085020481
                                         uncertainty =       0.005139789338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565085020481
                                         uncertainty =       0.005139789338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531545982
  error estimate for blocks of size 2^( 2) =       0.000551321098
  error estimate for blocks of size 2^( 3) =       0.000570519920
  error estimate for blocks of size 2^( 4) =       0.000584627260
  error estimate for blocks of size 2^( 5) =       0.000592179724
  error estimate for blocks of size 2^( 6) =       0.000597445594
  error estimate for blocks of size 2^( 7) =       0.000602221969

      target function =                  N/A
              le_mean =     -22.436587069513
             les_mean =     503.965521307917
             stat err =       0.000594118637
             autocorr =       1.249294051802
              std dev =       0.751719537201
             le_variance =       0.565082262610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565081044101
                                         uncertainty =       0.005139684294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565081044101
                                         uncertainty =       0.005139684294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531544108
  error estimate for blocks of size 2^( 2) =       0.000551319460
  error estimate for blocks of size 2^( 3) =       0.000570518459
  error estimate for blocks of size 2^( 4) =       0.000584625764
  error estimate for blocks of size 2^( 5) =       0.000592178286
  error estimate for blocks of size 2^( 6) =       0.000597444316
  error estimate for blocks of size 2^( 7) =       0.000602220706

      target function =                  N/A
              le_mean =     -22.436586981000
             les_mean =     503.965513350916
             stat err =       0.000594117268
             autocorr =       1.249297105571
              std dev =       0.751716886515
             le_variance =       0.565078277472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565077531375
                                         uncertainty =       0.005139588162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565077531375
                                         uncertainty =       0.005139588162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531542452
  error estimate for blocks of size 2^( 2) =       0.000551318022
  error estimate for blocks of size 2^( 3) =       0.000570517184
  error estimate for blocks of size 2^( 4) =       0.000584624453
  error estimate for blocks of size 2^( 5) =       0.000592177033
  error estimate for blocks of size 2^( 6) =       0.000597443215
  error estimate for blocks of size 2^( 7) =       0.000602219619

      target function =                  N/A
              le_mean =     -22.436586897842
             les_mean =     503.965506098162
             stat err =       0.000594116080
             autocorr =       1.249299893657
              std dev =       0.751714544416
             le_variance =       0.565074756286


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436586885931        initial
     9.5367e+00     9.5367e+01             2.7151e-05       -22.436587069513  <--
     3.8147e+01     3.8147e+02             6.8014e-06       -22.436586981000
     1.5259e+02     1.5259e+03             1.7026e-06       -22.436586897842

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 6.4157e+01
  </log>
  <optVariables href="FORMN2GVP1B.s021.opt.xml">
 uu_0                 2.708852e-01 1 1  ON 0
 uu_1                 9.602309e-02 1 1  ON 1
 uu_2                -1.965893e-02 1 1  ON 2
 uu_3                -8.882700e-02 1 1  ON 3
 uu_4                -1.290819e-01 1 1  ON 4
 uu_5                -1.525445e-01 1 1  ON 5
 uu_6                -1.631956e-01 1 1  ON 6
 uu_7                -1.597927e-01 1 1  ON 7
 uu_8                -1.390308e-01 1 1  ON 8
 uu_9                -8.520329e-02 1 1  ON 9
 ud_0                 4.436449e-01 1 1  ON 10
 ud_1                 1.596243e-01 1 1  ON 11
 ud_2                 1.029518e-02 1 1  ON 12
 ud_3                -7.283639e-02 1 1  ON 13
 ud_4                -1.210618e-01 1 1  ON 14
 ud_5                -1.518253e-01 1 1  ON 15
 ud_6                -1.696446e-01 1 1  ON 16
 ud_7                -1.729321e-01 1 1  ON 17
 ud_8                -1.574458e-01 1 1  ON 18
 ud_9                -1.120834e-01 1 1  ON 19
 eC_0                -6.265927e-01 1 1  ON 20
 eC_1                -4.556452e-01 1 1  ON 21
 eC_2                -1.580730e-01 1 1  ON 22
 eC_3                 5.268363e-02 1 1  ON 23
 eC_4                 1.828388e-01 1 1  ON 24
 eC_5                 2.866345e-01 1 1  ON 25
 eC_6                 2.829280e-01 1 1  ON 26
 eC_7                 2.822422e-01 1 1  ON 27
 eC_8                 1.229639e-01 1 1  ON 28
 eC_9                 2.665336e-02 1 1  ON 29
 eO_0                -1.144093e+00 1 1  ON 30
 eO_1                -7.539959e-01 1 1  ON 31
 eO_2                -2.670233e-01 1 1  ON 32
 eO_3                 4.958121e-02 1 1  ON 33
 eO_4                 2.642717e-01 1 1  ON 34
 eO_5                 3.930776e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155091e-01 1 1  ON 37
 eO_8                 3.661140e-01 1 1  ON 38
 eO_9                 1.896250e-01 1 1  ON 39
eH1_0                -1.591344e-01 1 1  ON 40
eH1_1                -5.838653e-02 1 1  ON 41
eH1_2                -3.791777e-02 1 1  ON 42
eH1_3                -3.637234e-02 1 1  ON 43
eH1_4                 2.250221e-03 1 1  ON 44
eH1_5                 1.472447e-02 1 1  ON 45
eH1_6                 4.561472e-02 1 1  ON 46
eH1_7                 5.238139e-02 1 1  ON 47
eH1_8                 3.200234e-02 1 1  ON 48
eH1_9                 8.535804e-02 1 1  ON 49
eH2_0                -1.603406e-01 1 1  ON 50
eH2_1                -5.952419e-02 1 1  ON 51
eH2_2                -3.861152e-02 1 1  ON 52
eH2_3                -3.729011e-02 1 1  ON 53
eH2_4                 1.016204e-03 1 1  ON 54
eH2_5                 1.329570e-02 1 1  ON 55
eH2_6                 4.405527e-02 1 1  ON 56
eH2_7                 4.890917e-02 1 1  ON 57
eH2_8                 3.140461e-02 1 1  ON 58
eH2_9                 9.100652e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2549e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2448e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.3861
    reference variance = 0.420036
====================================================
  Execution time = 4.5667e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7901e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5150e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579071074492
                                         uncertainty =       0.009261727733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579071074492
                                         uncertainty =       0.009261727733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538058415
  error estimate for blocks of size 2^( 2) =       0.000558192615
  error estimate for blocks of size 2^( 3) =       0.000576363402
  error estimate for blocks of size 2^( 4) =       0.000590393392
  error estimate for blocks of size 2^( 5) =       0.000598166586
  error estimate for blocks of size 2^( 6) =       0.000601155328
  error estimate for blocks of size 2^( 7) =       0.000602905428

      target function =                  N/A
              le_mean =     -22.437274389525
             les_mean =     504.010295458244
             stat err =       0.000598155184
             autocorr =       1.235858887357
              std dev =       0.760929508497
             le_variance =       0.579013716901


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243727438953e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437274389525       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437274589076       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437274659117       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437274674797       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437274333567       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437274069503       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437274399364       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437274352500       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437274416202       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437274383772       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437274395133       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+00 is 1.158318e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437274389525       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437274442542       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437274463111       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437274470875       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437274384066       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437274301103       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437274378857       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437274370713       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437274385046       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437274378766       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+00 is 2.844716e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437274389525       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437274402991       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437274408348       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437274410580       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437274388847       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437274366840       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437274385743       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437274383971       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437274387433       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437274386019       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+01 is 7.129040e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.279372 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0825e+01
  </log>
  <optVariables href="FORMN2GVP1B.s022.opt.xml">
 uu_0                 2.708734e-01 1 1  ON 0
 uu_1                 9.601100e-02 1 1  ON 1
 uu_2                -1.964861e-02 1 1  ON 2
 uu_3                -8.882516e-02 1 1  ON 3
 uu_4                -1.290874e-01 1 1  ON 4
 uu_5                -1.525581e-01 1 1  ON 5
 uu_6                -1.631999e-01 1 1  ON 6
 uu_7                -1.598048e-01 1 1  ON 7
 uu_8                -1.390377e-01 1 1  ON 8
 uu_9                -8.519449e-02 1 1  ON 9
 ud_0                 4.436303e-01 1 1  ON 10
 ud_1                 1.596187e-01 1 1  ON 11
 ud_2                 1.028870e-02 1 1  ON 12
 ud_3                -7.283827e-02 1 1  ON 13
 ud_4                -1.210610e-01 1 1  ON 14
 ud_5                -1.518234e-01 1 1  ON 15
 ud_6                -1.696394e-01 1 1  ON 16
 ud_7                -1.729423e-01 1 1  ON 17
 ud_8                -1.574356e-01 1 1  ON 18
 ud_9                -1.120758e-01 1 1  ON 19
 eC_0                -6.265995e-01 1 1  ON 20
 eC_1                -4.556555e-01 1 1  ON 21
 eC_2                -1.580850e-01 1 1  ON 22
 eC_3                 5.266891e-02 1 1  ON 23
 eC_4                 1.828266e-01 1 1  ON 24
 eC_5                 2.866385e-01 1 1  ON 25
 eC_6                 2.829400e-01 1 1  ON 26
 eC_7                 2.822563e-01 1 1  ON 27
 eC_8                 1.229840e-01 1 1  ON 28
 eC_9                 2.665892e-02 1 1  ON 29
 eO_0                -1.144106e+00 1 1  ON 30
 eO_1                -7.540101e-01 1 1  ON 31
 eO_2                -2.670432e-01 1 1  ON 32
 eO_3                 4.956219e-02 1 1  ON 33
 eO_4                 2.642746e-01 1 1  ON 34
 eO_5                 3.930786e-01 1 1  ON 35
 eO_6                 4.127930e-01 1 1  ON 36
 eO_7                 4.155115e-01 1 1  ON 37
 eO_8                 3.661335e-01 1 1  ON 38
 eO_9                 1.896534e-01 1 1  ON 39
eH1_0                -1.591443e-01 1 1  ON 40
eH1_1                -5.839603e-02 1 1  ON 41
eH1_2                -3.791294e-02 1 1  ON 42
eH1_3                -3.636944e-02 1 1  ON 43
eH1_4                 2.243947e-03 1 1  ON 44
eH1_5                 1.473201e-02 1 1  ON 45
eH1_6                 4.560310e-02 1 1  ON 46
eH1_7                 5.239148e-02 1 1  ON 47
eH1_8                 3.200589e-02 1 1  ON 48
eH1_9                 8.535841e-02 1 1  ON 49
eH2_0                -1.603332e-01 1 1  ON 50
eH2_1                -5.952680e-02 1 1  ON 51
eH2_2                -3.862510e-02 1 1  ON 52
eH2_3                -3.730208e-02 1 1  ON 53
eH2_4                 1.023288e-03 1 1  ON 54
eH2_5                 1.328549e-02 1 1  ON 55
eH2_6                 4.404728e-02 1 1  ON 56
eH2_7                 4.892005e-02 1 1  ON 57
eH2_8                 3.141191e-02 1 1  ON 58
eH2_9                 9.100831e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.3671
    reference variance = 0.574031
====================================================
  Execution time = 4.5408e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6284e-01
  Total weights = 2.0000e+06
  Execution time = 3.8419e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562800750911
                                         uncertainty =       0.004762888977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562800750911
                                         uncertainty =       0.004762888977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530503003
  error estimate for blocks of size 2^( 2) =       0.000550082278
  error estimate for blocks of size 2^( 3) =       0.000568859885
  error estimate for blocks of size 2^( 4) =       0.000582178036
  error estimate for blocks of size 2^( 5) =       0.000590521948
  error estimate for blocks of size 2^( 6) =       0.000595236506
  error estimate for blocks of size 2^( 7) =       0.000601519111

      target function =                  N/A
              le_mean =     -22.436487785561
             les_mean =     503.958850742249
             stat err =       0.000592363900
             autocorr =       1.246813438742
              std dev =       0.750244541493
             le_variance =       0.562866872041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562718605302
                                         uncertainty =       0.004762598892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562718605302
                                         uncertainty =       0.004762598892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530464261
  error estimate for blocks of size 2^( 2) =       0.000550045058
  error estimate for blocks of size 2^( 3) =       0.000568824672
  error estimate for blocks of size 2^( 4) =       0.000582144233
  error estimate for blocks of size 2^( 5) =       0.000590488961
  error estimate for blocks of size 2^( 6) =       0.000595204150
  error estimate for blocks of size 2^( 7) =       0.000601485982

      target function =                  N/A
              le_mean =     -22.436487416922
             les_mean =     503.958751992953
             stat err =       0.000592330831
             autocorr =       1.246856340579
              std dev =       0.750189752413
             le_variance =       0.562784664626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562754161478
                                         uncertainty =       0.004762703569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562754161478
                                         uncertainty =       0.004762703569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530481031
  error estimate for blocks of size 2^( 2) =       0.000550061179
  error estimate for blocks of size 2^( 3) =       0.000568839923
  error estimate for blocks of size 2^( 4) =       0.000582158800
  error estimate for blocks of size 2^( 5) =       0.000590503099
  error estimate for blocks of size 2^( 6) =       0.000595218002
  error estimate for blocks of size 2^( 7) =       0.000601500066

      target function =                  N/A
              le_mean =     -22.436487538684
             les_mean =     503.958793041002
             stat err =       0.000592344992
             autocorr =       1.246837120217
              std dev =       0.750213468867
             le_variance =       0.562820248869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562794758439
                                         uncertainty =       0.004762865606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562794758439
                                         uncertainty =       0.004762865606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530500177
  error estimate for blocks of size 2^( 2) =       0.000550079563
  error estimate for blocks of size 2^( 3) =       0.000568857315
  error estimate for blocks of size 2^( 4) =       0.000582175559
  error estimate for blocks of size 2^( 5) =       0.000590519519
  error estimate for blocks of size 2^( 6) =       0.000595234120
  error estimate for blocks of size 2^( 7) =       0.000601516655

      target function =                  N/A
              le_mean =     -22.436487751101
             les_mean =     503.958843199106
             stat err =       0.000592361463
             autocorr =       1.246816464306
              std dev =       0.750240544899
             le_variance =       0.562860875211


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436487785561        initial  <--
     2.3842e+00     2.3842e+01             1.1583e-04       -22.436487416922
     9.5367e+00     9.5367e+01             2.8447e-05       -22.436487538684
     3.8147e+01     3.8147e+02             7.1290e-06       -22.436487751101

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.6308
  </log>
  <optVariables href="FORMN2GVP1B.s022.opt.xml">
 uu_0                 2.708852e-01 1 1  ON 0
 uu_1                 9.602309e-02 1 1  ON 1
 uu_2                -1.965893e-02 1 1  ON 2
 uu_3                -8.882700e-02 1 1  ON 3
 uu_4                -1.290819e-01 1 1  ON 4
 uu_5                -1.525445e-01 1 1  ON 5
 uu_6                -1.631956e-01 1 1  ON 6
 uu_7                -1.597927e-01 1 1  ON 7
 uu_8                -1.390308e-01 1 1  ON 8
 uu_9                -8.520329e-02 1 1  ON 9
 ud_0                 4.436449e-01 1 1  ON 10
 ud_1                 1.596243e-01 1 1  ON 11
 ud_2                 1.029518e-02 1 1  ON 12
 ud_3                -7.283639e-02 1 1  ON 13
 ud_4                -1.210618e-01 1 1  ON 14
 ud_5                -1.518253e-01 1 1  ON 15
 ud_6                -1.696446e-01 1 1  ON 16
 ud_7                -1.729321e-01 1 1  ON 17
 ud_8                -1.574458e-01 1 1  ON 18
 ud_9                -1.120834e-01 1 1  ON 19
 eC_0                -6.265927e-01 1 1  ON 20
 eC_1                -4.556452e-01 1 1  ON 21
 eC_2                -1.580730e-01 1 1  ON 22
 eC_3                 5.268363e-02 1 1  ON 23
 eC_4                 1.828388e-01 1 1  ON 24
 eC_5                 2.866345e-01 1 1  ON 25
 eC_6                 2.829280e-01 1 1  ON 26
 eC_7                 2.822422e-01 1 1  ON 27
 eC_8                 1.229639e-01 1 1  ON 28
 eC_9                 2.665336e-02 1 1  ON 29
 eO_0                -1.144093e+00 1 1  ON 30
 eO_1                -7.539959e-01 1 1  ON 31
 eO_2                -2.670233e-01 1 1  ON 32
 eO_3                 4.958121e-02 1 1  ON 33
 eO_4                 2.642717e-01 1 1  ON 34
 eO_5                 3.930776e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155091e-01 1 1  ON 37
 eO_8                 3.661140e-01 1 1  ON 38
 eO_9                 1.896250e-01 1 1  ON 39
eH1_0                -1.591344e-01 1 1  ON 40
eH1_1                -5.838653e-02 1 1  ON 41
eH1_2                -3.791777e-02 1 1  ON 42
eH1_3                -3.637234e-02 1 1  ON 43
eH1_4                 2.250221e-03 1 1  ON 44
eH1_5                 1.472447e-02 1 1  ON 45
eH1_6                 4.561472e-02 1 1  ON 46
eH1_7                 5.238139e-02 1 1  ON 47
eH1_8                 3.200234e-02 1 1  ON 48
eH1_9                 8.535804e-02 1 1  ON 49
eH2_0                -1.603406e-01 1 1  ON 50
eH2_1                -5.952419e-02 1 1  ON 51
eH2_2                -3.861152e-02 1 1  ON 52
eH2_3                -3.729011e-02 1 1  ON 53
eH2_4                 1.016204e-03 1 1  ON 54
eH2_5                 1.329570e-02 1 1  ON 55
eH2_6                 4.405527e-02 1 1  ON 56
eH2_7                 4.890917e-02 1 1  ON 57
eH2_8                 3.140461e-02 1 1  ON 58
eH2_9                 9.100652e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2546e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2445e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.2635
    reference variance = 0.550739
====================================================
  Execution time = 4.6865e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7614e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5458e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576287463989
                                         uncertainty =       0.009252433021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576287463989
                                         uncertainty =       0.009252433021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536719640
  error estimate for blocks of size 2^( 2) =       0.000556376659
  error estimate for blocks of size 2^( 3) =       0.000574498212
  error estimate for blocks of size 2^( 4) =       0.000587718199
  error estimate for blocks of size 2^( 5) =       0.000595991811
  error estimate for blocks of size 2^( 6) =       0.000601047060
  error estimate for blocks of size 2^( 7) =       0.000600255586

      target function =                  N/A
              le_mean =     -22.436339119617
             les_mean =     503.965448746084
             stat err =       0.000596253164
             autocorr =       1.234145654488
              std dev =       0.759036193944
             le_variance =       0.576135943717


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243633911962e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436339119617       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436339143987       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436339144356       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436339131806       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436339138731       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436339141133       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436339126473       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436339121985       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436339127306       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436339129608       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+01 is 1.172032e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436339119617       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436339125741       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436339125853       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436339122707       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436339124435       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436339125131       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436339121471       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436339120341       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436339121621       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436339122161       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+01 is 2.932544e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436339119617       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436339121150       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436339121179       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436339120392       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436339120824       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436339121003       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436339120089       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436339119806       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436339120124       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436339120255       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+02 is 7.332905e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283009 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2331e+01
  </log>
  <optVariables href="FORMN2GVP1B.s023.opt.xml">
 uu_0                 2.708865e-01 1 1  ON 0
 uu_1                 9.602300e-02 1 1  ON 1
 uu_2                -1.965887e-02 1 1  ON 2
 uu_3                -8.882724e-02 1 1  ON 3
 uu_4                -1.290825e-01 1 1  ON 4
 uu_5                -1.525441e-01 1 1  ON 5
 uu_6                -1.631959e-01 1 1  ON 6
 uu_7                -1.597932e-01 1 1  ON 7
 uu_8                -1.390312e-01 1 1  ON 8
 uu_9                -8.520432e-02 1 1  ON 9
 ud_0                 4.436449e-01 1 1  ON 10
 ud_1                 1.596248e-01 1 1  ON 11
 ud_2                 1.029460e-02 1 1  ON 12
 ud_3                -7.283612e-02 1 1  ON 13
 ud_4                -1.210612e-01 1 1  ON 14
 ud_5                -1.518248e-01 1 1  ON 15
 ud_6                -1.696435e-01 1 1  ON 16
 ud_7                -1.729333e-01 1 1  ON 17
 ud_8                -1.574464e-01 1 1  ON 18
 ud_9                -1.120826e-01 1 1  ON 19
 eC_0                -6.265940e-01 1 1  ON 20
 eC_1                -4.556439e-01 1 1  ON 21
 eC_2                -1.580743e-01 1 1  ON 22
 eC_3                 5.268272e-02 1 1  ON 23
 eC_4                 1.828370e-01 1 1  ON 24
 eC_5                 2.866341e-01 1 1  ON 25
 eC_6                 2.829299e-01 1 1  ON 26
 eC_7                 2.822429e-01 1 1  ON 27
 eC_8                 1.229655e-01 1 1  ON 28
 eC_9                 2.665367e-02 1 1  ON 29
 eO_0                -1.144094e+00 1 1  ON 30
 eO_1                -7.539963e-01 1 1  ON 31
 eO_2                -2.670240e-01 1 1  ON 32
 eO_3                 4.957986e-02 1 1  ON 33
 eO_4                 2.642709e-01 1 1  ON 34
 eO_5                 3.930763e-01 1 1  ON 35
 eO_6                 4.127937e-01 1 1  ON 36
 eO_7                 4.155088e-01 1 1  ON 37
 eO_8                 3.661164e-01 1 1  ON 38
 eO_9                 1.896279e-01 1 1  ON 39
eH1_0                -1.591345e-01 1 1  ON 40
eH1_1                -5.838744e-02 1 1  ON 41
eH1_2                -3.791785e-02 1 1  ON 42
eH1_3                -3.637262e-02 1 1  ON 43
eH1_4                 2.250622e-03 1 1  ON 44
eH1_5                 1.472519e-02 1 1  ON 45
eH1_6                 4.561516e-02 1 1  ON 46
eH1_7                 5.238117e-02 1 1  ON 47
eH1_8                 3.200164e-02 1 1  ON 48
eH1_9                 8.535781e-02 1 1  ON 49
eH2_0                -1.603406e-01 1 1  ON 50
eH2_1                -5.952466e-02 1 1  ON 51
eH2_2                -3.861160e-02 1 1  ON 52
eH2_3                -3.729062e-02 1 1  ON 53
eH2_4                 1.015808e-03 1 1  ON 54
eH2_5                 1.329630e-02 1 1  ON 55
eH2_6                 4.405428e-02 1 1  ON 56
eH2_7                 4.891051e-02 1 1  ON 57
eH2_8                 3.140499e-02 1 1  ON 58
eH2_9                 9.100603e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.2725
    reference variance = 0.502735
====================================================
  Execution time = 4.5348e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7188e-01
  Total weights = 2.0000e+06
  Execution time = 3.8548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572078642992
                                         uncertainty =       0.009476117861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572078642992
                                         uncertainty =       0.009476117861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534735038
  error estimate for blocks of size 2^( 2) =       0.000554424991
  error estimate for blocks of size 2^( 3) =       0.000572755750
  error estimate for blocks of size 2^( 4) =       0.000586737638
  error estimate for blocks of size 2^( 5) =       0.000595810096
  error estimate for blocks of size 2^( 6) =       0.000600463584
  error estimate for blocks of size 2^( 7) =       0.000603689579

      target function =                  N/A
              le_mean =     -22.436307665740
             les_mean =     503.959784506805
             stat err =       0.000596675224
             autocorr =       1.245084215019
              std dev =       0.756229542522
             le_variance =       0.571883120983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572082846196
                                         uncertainty =       0.009476277399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572082846196
                                         uncertainty =       0.009476277399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534737001
  error estimate for blocks of size 2^( 2) =       0.000554426815
  error estimate for blocks of size 2^( 3) =       0.000572757420
  error estimate for blocks of size 2^( 4) =       0.000586739245
  error estimate for blocks of size 2^( 5) =       0.000595811714
  error estimate for blocks of size 2^( 6) =       0.000600465152
  error estimate for blocks of size 2^( 7) =       0.000603691222

      target function =                  N/A
              le_mean =     -22.436307660021
             les_mean =     503.959788449659
             stat err =       0.000596676833
             autocorr =       1.245081786427
              std dev =       0.756232319130
             le_variance =       0.571887320497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572080757295
                                         uncertainty =       0.009476197632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572080757295
                                         uncertainty =       0.009476197632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534736025
  error estimate for blocks of size 2^( 2) =       0.000554425908
  error estimate for blocks of size 2^( 3) =       0.000572756589
  error estimate for blocks of size 2^( 4) =       0.000586738446
  error estimate for blocks of size 2^( 5) =       0.000595810910
  error estimate for blocks of size 2^( 6) =       0.000600464372
  error estimate for blocks of size 2^( 7) =       0.000603690405

      target function =                  N/A
              le_mean =     -22.436307662934
             les_mean =     503.959786493291
             stat err =       0.000596676033
             autocorr =       1.245082991314
              std dev =       0.756230939211
             le_variance =       0.571885233420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572078907630
                                         uncertainty =       0.009476127832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572078907630
                                         uncertainty =       0.009476127832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534735161
  error estimate for blocks of size 2^( 2) =       0.000554425106
  error estimate for blocks of size 2^( 3) =       0.000572755855
  error estimate for blocks of size 2^( 4) =       0.000586737739
  error estimate for blocks of size 2^( 5) =       0.000595810198
  error estimate for blocks of size 2^( 6) =       0.000600463683
  error estimate for blocks of size 2^( 7) =       0.000603689682

      target function =                  N/A
              le_mean =     -22.436307665386
             les_mean =     503.959784755297
             stat err =       0.000596675326
             autocorr =       1.245084061760
              std dev =       0.756229717339
             le_variance =       0.571883385387


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436307665740        initial  <--
     2.3842e+01     2.3842e+02             1.1720e-05       -22.436307660021
     9.5367e+01     9.5367e+02             2.9325e-06       -22.436307662934
     3.8147e+02     3.8147e+03             7.3329e-07       -22.436307665386

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.5676
  </log>
  <optVariables href="FORMN2GVP1B.s023.opt.xml">
 uu_0                 2.708852e-01 1 1  ON 0
 uu_1                 9.602309e-02 1 1  ON 1
 uu_2                -1.965893e-02 1 1  ON 2
 uu_3                -8.882700e-02 1 1  ON 3
 uu_4                -1.290819e-01 1 1  ON 4
 uu_5                -1.525445e-01 1 1  ON 5
 uu_6                -1.631956e-01 1 1  ON 6
 uu_7                -1.597927e-01 1 1  ON 7
 uu_8                -1.390308e-01 1 1  ON 8
 uu_9                -8.520329e-02 1 1  ON 9
 ud_0                 4.436449e-01 1 1  ON 10
 ud_1                 1.596243e-01 1 1  ON 11
 ud_2                 1.029518e-02 1 1  ON 12
 ud_3                -7.283639e-02 1 1  ON 13
 ud_4                -1.210618e-01 1 1  ON 14
 ud_5                -1.518253e-01 1 1  ON 15
 ud_6                -1.696446e-01 1 1  ON 16
 ud_7                -1.729321e-01 1 1  ON 17
 ud_8                -1.574458e-01 1 1  ON 18
 ud_9                -1.120834e-01 1 1  ON 19
 eC_0                -6.265927e-01 1 1  ON 20
 eC_1                -4.556452e-01 1 1  ON 21
 eC_2                -1.580730e-01 1 1  ON 22
 eC_3                 5.268363e-02 1 1  ON 23
 eC_4                 1.828388e-01 1 1  ON 24
 eC_5                 2.866345e-01 1 1  ON 25
 eC_6                 2.829280e-01 1 1  ON 26
 eC_7                 2.822422e-01 1 1  ON 27
 eC_8                 1.229639e-01 1 1  ON 28
 eC_9                 2.665336e-02 1 1  ON 29
 eO_0                -1.144093e+00 1 1  ON 30
 eO_1                -7.539959e-01 1 1  ON 31
 eO_2                -2.670233e-01 1 1  ON 32
 eO_3                 4.958121e-02 1 1  ON 33
 eO_4                 2.642717e-01 1 1  ON 34
 eO_5                 3.930776e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155091e-01 1 1  ON 37
 eO_8                 3.661140e-01 1 1  ON 38
 eO_9                 1.896250e-01 1 1  ON 39
eH1_0                -1.591344e-01 1 1  ON 40
eH1_1                -5.838653e-02 1 1  ON 41
eH1_2                -3.791777e-02 1 1  ON 42
eH1_3                -3.637234e-02 1 1  ON 43
eH1_4                 2.250221e-03 1 1  ON 44
eH1_5                 1.472447e-02 1 1  ON 45
eH1_6                 4.561472e-02 1 1  ON 46
eH1_7                 5.238139e-02 1 1  ON 47
eH1_8                 3.200234e-02 1 1  ON 48
eH1_9                 8.535804e-02 1 1  ON 49
eH2_0                -1.603406e-01 1 1  ON 50
eH2_1                -5.952419e-02 1 1  ON 51
eH2_2                -3.861152e-02 1 1  ON 52
eH2_3                -3.729011e-02 1 1  ON 53
eH2_4                 1.016204e-03 1 1  ON 54
eH2_5                 1.329570e-02 1 1  ON 55
eH2_6                 4.405527e-02 1 1  ON 56
eH2_7                 4.890917e-02 1 1  ON 57
eH2_8                 3.140461e-02 1 1  ON 58
eH2_9                 9.100652e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2691e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2438e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.5177
    reference variance = 0.503714
====================================================
  Execution time = 4.5733e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7680e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5287e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576844774140
                                         uncertainty =       0.008550475353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576844774140
                                         uncertainty =       0.008550475353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537029494
  error estimate for blocks of size 2^( 2) =       0.000557275888
  error estimate for blocks of size 2^( 3) =       0.000575735174
  error estimate for blocks of size 2^( 4) =       0.000588838404
  error estimate for blocks of size 2^( 5) =       0.000597569086
  error estimate for blocks of size 2^( 6) =       0.000603236796
  error estimate for blocks of size 2^( 7) =       0.000605359740

      target function =                  N/A
              le_mean =     -22.436599955530
             les_mean =     503.977818631801
             stat err =       0.000598751007
             autocorr =       1.243071862566
              std dev =       0.759474394376
             le_variance =       0.576801355713


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243659995553e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436599955530       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436599955502       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436599956969       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436599955585       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436599958750       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436599959189       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436599956411       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436599957681       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436599956988       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436599956952       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+02 is 1.089249e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436599955530       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436599955523       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436599955890       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436599955543       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436599956335       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436599956445       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436599955752       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436599956066       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436599955894       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436599955884       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+02 is 2.723325e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436599955530       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436599955528       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436599955620       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436599955533       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436599955731       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436599955760       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436599955589       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436599955665       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436599955619       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436599955612       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+03 is 6.808439e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286671 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1028e+01
  </log>
  <optVariables href="FORMN2GVP1B.s024.opt.xml">
 uu_0                 2.708854e-01 1 1  ON 0
 uu_1                 9.602311e-02 1 1  ON 1
 uu_2                -1.965897e-02 1 1  ON 2
 uu_3                -8.882710e-02 1 1  ON 3
 uu_4                -1.290820e-01 1 1  ON 4
 uu_5                -1.525445e-01 1 1  ON 5
 uu_6                -1.631957e-01 1 1  ON 6
 uu_7                -1.597928e-01 1 1  ON 7
 uu_8                -1.390308e-01 1 1  ON 8
 uu_9                -8.520329e-02 1 1  ON 9
 ud_0                 4.436450e-01 1 1  ON 10
 ud_1                 1.596243e-01 1 1  ON 11
 ud_2                 1.029522e-02 1 1  ON 12
 ud_3                -7.283638e-02 1 1  ON 13
 ud_4                -1.210616e-01 1 1  ON 14
 ud_5                -1.518252e-01 1 1  ON 15
 ud_6                -1.696445e-01 1 1  ON 16
 ud_7                -1.729323e-01 1 1  ON 17
 ud_8                -1.574458e-01 1 1  ON 18
 ud_9                -1.120835e-01 1 1  ON 19
 eC_0                -6.265927e-01 1 1  ON 20
 eC_1                -4.556452e-01 1 1  ON 21
 eC_2                -1.580731e-01 1 1  ON 22
 eC_3                 5.268340e-02 1 1  ON 23
 eC_4                 1.828388e-01 1 1  ON 24
 eC_5                 2.866346e-01 1 1  ON 25
 eC_6                 2.829280e-01 1 1  ON 26
 eC_7                 2.822423e-01 1 1  ON 27
 eC_8                 1.229641e-01 1 1  ON 28
 eC_9                 2.665340e-02 1 1  ON 29
 eO_0                -1.144093e+00 1 1  ON 30
 eO_1                -7.539960e-01 1 1  ON 31
 eO_2                -2.670235e-01 1 1  ON 32
 eO_3                 4.958106e-02 1 1  ON 33
 eO_4                 2.642716e-01 1 1  ON 34
 eO_5                 3.930777e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155092e-01 1 1  ON 37
 eO_8                 3.661142e-01 1 1  ON 38
 eO_9                 1.896253e-01 1 1  ON 39
eH1_0                -1.591344e-01 1 1  ON 40
eH1_1                -5.838664e-02 1 1  ON 41
eH1_2                -3.791782e-02 1 1  ON 42
eH1_3                -3.637235e-02 1 1  ON 43
eH1_4                 2.250219e-03 1 1  ON 44
eH1_5                 1.472463e-02 1 1  ON 45
eH1_6                 4.561472e-02 1 1  ON 46
eH1_7                 5.238126e-02 1 1  ON 47
eH1_8                 3.200240e-02 1 1  ON 48
eH1_9                 8.535803e-02 1 1  ON 49
eH2_0                -1.603406e-01 1 1  ON 50
eH2_1                -5.952431e-02 1 1  ON 51
eH2_2                -3.861153e-02 1 1  ON 52
eH2_3                -3.729005e-02 1 1  ON 53
eH2_4                 1.016254e-03 1 1  ON 54
eH2_5                 1.329562e-02 1 1  ON 55
eH2_6                 4.405530e-02 1 1  ON 56
eH2_7                 4.890926e-02 1 1  ON 57
eH2_8                 3.140452e-02 1 1  ON 58
eH2_9                 9.100649e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.4218
    reference variance = 0.324891
====================================================
  Execution time = 4.4642e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6508e-01
  Total weights = 2.0000e+06
  Execution time = 3.8515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564993539277
                                         uncertainty =       0.007441634178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564993539277
                                         uncertainty =       0.007441634178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531545441
  error estimate for blocks of size 2^( 2) =       0.000551671861
  error estimate for blocks of size 2^( 3) =       0.000570113318
  error estimate for blocks of size 2^( 4) =       0.000583584154
  error estimate for blocks of size 2^( 5) =       0.000591307076
  error estimate for blocks of size 2^( 6) =       0.000597228504
  error estimate for blocks of size 2^( 7) =       0.000596636126

      target function =                  N/A
              le_mean =     -22.436619174570
             les_mean =     503.966960814268
             stat err =       0.000592188965
             autocorr =       1.241194450026
              std dev =       0.751718771976
             le_variance =       0.565081112141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564994029219
                                         uncertainty =       0.007441642680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564994029219
                                         uncertainty =       0.007441642680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531545672
  error estimate for blocks of size 2^( 2) =       0.000551672083
  error estimate for blocks of size 2^( 3) =       0.000570113530
  error estimate for blocks of size 2^( 4) =       0.000583584360
  error estimate for blocks of size 2^( 5) =       0.000591307291
  error estimate for blocks of size 2^( 6) =       0.000597228696
  error estimate for blocks of size 2^( 7) =       0.000596636319

      target function =                  N/A
              le_mean =     -22.436619163720
             les_mean =     503.966960817248
             stat err =       0.000592189167
             autocorr =       1.241194219587
              std dev =       0.751719097778
             le_variance =       0.565081601965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564993784599
                                         uncertainty =       0.007441638443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564993784599
                                         uncertainty =       0.007441638443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531545557
  error estimate for blocks of size 2^( 2) =       0.000551671972
  error estimate for blocks of size 2^( 3) =       0.000570113424
  error estimate for blocks of size 2^( 4) =       0.000583584257
  error estimate for blocks of size 2^( 5) =       0.000591307183
  error estimate for blocks of size 2^( 6) =       0.000597228600
  error estimate for blocks of size 2^( 7) =       0.000596636223

      target function =                  N/A
              le_mean =     -22.436619169143
             les_mean =     503.966960815999
             stat err =       0.000592189066
             autocorr =       1.241194334649
              std dev =       0.751718935110
             le_variance =       0.565081357403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564993569953
                                         uncertainty =       0.007441634712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564993569953
                                         uncertainty =       0.007441634712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531545456
  error estimate for blocks of size 2^( 2) =       0.000551671874
  error estimate for blocks of size 2^( 3) =       0.000570113331
  error estimate for blocks of size 2^( 4) =       0.000583584167
  error estimate for blocks of size 2^( 5) =       0.000591307089
  error estimate for blocks of size 2^( 6) =       0.000597228516
  error estimate for blocks of size 2^( 7) =       0.000596636138

      target function =                  N/A
              le_mean =     -22.436619173891
             les_mean =     503.966960814488
             stat err =       0.000592188977
             autocorr =       1.241194435599
              std dev =       0.751718792374
             le_variance =       0.565081142809


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436619174570        initial  <--
     2.3842e+02     2.3842e+03             1.0892e-06       -22.436619163720
     9.5367e+02     9.5367e+03             2.7233e-07       -22.436619169143
     3.8147e+03     3.8147e+04             6.8084e-08       -22.436619173891

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9161
  </log>
  <optVariables href="FORMN2GVP1B.s024.opt.xml">
 uu_0                 2.708852e-01 1 1  ON 0
 uu_1                 9.602309e-02 1 1  ON 1
 uu_2                -1.965893e-02 1 1  ON 2
 uu_3                -8.882700e-02 1 1  ON 3
 uu_4                -1.290819e-01 1 1  ON 4
 uu_5                -1.525445e-01 1 1  ON 5
 uu_6                -1.631956e-01 1 1  ON 6
 uu_7                -1.597927e-01 1 1  ON 7
 uu_8                -1.390308e-01 1 1  ON 8
 uu_9                -8.520329e-02 1 1  ON 9
 ud_0                 4.436449e-01 1 1  ON 10
 ud_1                 1.596243e-01 1 1  ON 11
 ud_2                 1.029518e-02 1 1  ON 12
 ud_3                -7.283639e-02 1 1  ON 13
 ud_4                -1.210618e-01 1 1  ON 14
 ud_5                -1.518253e-01 1 1  ON 15
 ud_6                -1.696446e-01 1 1  ON 16
 ud_7                -1.729321e-01 1 1  ON 17
 ud_8                -1.574458e-01 1 1  ON 18
 ud_9                -1.120834e-01 1 1  ON 19
 eC_0                -6.265927e-01 1 1  ON 20
 eC_1                -4.556452e-01 1 1  ON 21
 eC_2                -1.580730e-01 1 1  ON 22
 eC_3                 5.268363e-02 1 1  ON 23
 eC_4                 1.828388e-01 1 1  ON 24
 eC_5                 2.866345e-01 1 1  ON 25
 eC_6                 2.829280e-01 1 1  ON 26
 eC_7                 2.822422e-01 1 1  ON 27
 eC_8                 1.229639e-01 1 1  ON 28
 eC_9                 2.665336e-02 1 1  ON 29
 eO_0                -1.144093e+00 1 1  ON 30
 eO_1                -7.539959e-01 1 1  ON 31
 eO_2                -2.670233e-01 1 1  ON 32
 eO_3                 4.958121e-02 1 1  ON 33
 eO_4                 2.642717e-01 1 1  ON 34
 eO_5                 3.930776e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155091e-01 1 1  ON 37
 eO_8                 3.661140e-01 1 1  ON 38
 eO_9                 1.896250e-01 1 1  ON 39
eH1_0                -1.591344e-01 1 1  ON 40
eH1_1                -5.838653e-02 1 1  ON 41
eH1_2                -3.791777e-02 1 1  ON 42
eH1_3                -3.637234e-02 1 1  ON 43
eH1_4                 2.250221e-03 1 1  ON 44
eH1_5                 1.472447e-02 1 1  ON 45
eH1_6                 4.561472e-02 1 1  ON 46
eH1_7                 5.238139e-02 1 1  ON 47
eH1_8                 3.200234e-02 1 1  ON 48
eH1_9                 8.535804e-02 1 1  ON 49
eH2_0                -1.603406e-01 1 1  ON 50
eH2_1                -5.952419e-02 1 1  ON 51
eH2_2                -3.861152e-02 1 1  ON 52
eH2_3                -3.729011e-02 1 1  ON 53
eH2_4                 1.016204e-03 1 1  ON 54
eH2_5                 1.329570e-02 1 1  ON 55
eH2_6                 4.405527e-02 1 1  ON 56
eH2_7                 4.890917e-02 1 1  ON 57
eH2_8                 3.140461e-02 1 1  ON 58
eH2_9                 9.100652e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2495e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.3524
    reference variance = 2.11587
====================================================
  Execution time = 4.5725e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5974e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5451e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559650429558
                                         uncertainty =       0.003714843658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559650429558
                                         uncertainty =       0.003714843658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529026118
  error estimate for blocks of size 2^( 2) =       0.000549485943
  error estimate for blocks of size 2^( 3) =       0.000568065629
  error estimate for blocks of size 2^( 4) =       0.000582240066
  error estimate for blocks of size 2^( 5) =       0.000590965264
  error estimate for blocks of size 2^( 6) =       0.000594568578
  error estimate for blocks of size 2^( 7) =       0.000597042358

      target function =                  N/A
              le_mean =     -22.436187411499
             les_mean =     503.942242551019
             stat err =       0.000591204066
             autocorr =       1.248879675190
              std dev =       0.748155910883
             le_variance =       0.559737266989


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243618741150e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436187411499       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436187411819       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436187412103       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436187412104       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436187412528       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436187412451       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436187412423       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436187412388       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436187412469       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436187412439       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+03 is 1.328824e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436187411499       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436187411579       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436187411650       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436187411650       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436187411759       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436187411743       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436187411733       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436187411708       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436187411747       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436187411723       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+03 is 3.322228e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436187411499       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436187411519       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436187411537       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436187411533       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436187411535       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436187411572       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436187411551       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436187411559       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436187411629       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436187411439       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+04 is 8.305675e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.290343 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1184e+01
  </log>
  <optVariables href="FORMN2GVP1B.s025.opt.xml">
 uu_0                 2.708853e-01 1 1  ON 0
 uu_1                 9.602308e-02 1 1  ON 1
 uu_2                -1.965892e-02 1 1  ON 2
 uu_3                -8.882701e-02 1 1  ON 3
 uu_4                -1.290819e-01 1 1  ON 4
 uu_5                -1.525445e-01 1 1  ON 5
 uu_6                -1.631956e-01 1 1  ON 6
 uu_7                -1.597928e-01 1 1  ON 7
 uu_8                -1.390308e-01 1 1  ON 8
 uu_9                -8.520330e-02 1 1  ON 9
 ud_0                 4.436449e-01 1 1  ON 10
 ud_1                 1.596243e-01 1 1  ON 11
 ud_2                 1.029518e-02 1 1  ON 12
 ud_3                -7.283638e-02 1 1  ON 13
 ud_4                -1.210618e-01 1 1  ON 14
 ud_5                -1.518253e-01 1 1  ON 15
 ud_6                -1.696446e-01 1 1  ON 16
 ud_7                -1.729321e-01 1 1  ON 17
 ud_8                -1.574458e-01 1 1  ON 18
 ud_9                -1.120834e-01 1 1  ON 19
 eC_0                -6.265927e-01 1 1  ON 20
 eC_1                -4.556452e-01 1 1  ON 21
 eC_2                -1.580730e-01 1 1  ON 22
 eC_3                 5.268362e-02 1 1  ON 23
 eC_4                 1.828387e-01 1 1  ON 24
 eC_5                 2.866345e-01 1 1  ON 25
 eC_6                 2.829280e-01 1 1  ON 26
 eC_7                 2.822422e-01 1 1  ON 27
 eC_8                 1.229639e-01 1 1  ON 28
 eC_9                 2.665336e-02 1 1  ON 29
 eO_0                -1.144093e+00 1 1  ON 30
 eO_1                -7.539959e-01 1 1  ON 31
 eO_2                -2.670234e-01 1 1  ON 32
 eO_3                 4.958119e-02 1 1  ON 33
 eO_4                 2.642717e-01 1 1  ON 34
 eO_5                 3.930776e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155091e-01 1 1  ON 37
 eO_8                 3.661140e-01 1 1  ON 38
 eO_9                 1.896250e-01 1 1  ON 39
eH1_0                -1.591344e-01 1 1  ON 40
eH1_1                -5.838653e-02 1 1  ON 41
eH1_2                -3.791777e-02 1 1  ON 42
eH1_3                -3.637235e-02 1 1  ON 43
eH1_4                 2.250213e-03 1 1  ON 44
eH1_5                 1.472447e-02 1 1  ON 45
eH1_6                 4.561472e-02 1 1  ON 46
eH1_7                 5.238139e-02 1 1  ON 47
eH1_8                 3.200235e-02 1 1  ON 48
eH1_9                 8.535804e-02 1 1  ON 49
eH2_0                -1.603406e-01 1 1  ON 50
eH2_1                -5.952420e-02 1 1  ON 51
eH2_2                -3.861152e-02 1 1  ON 52
eH2_3                -3.729013e-02 1 1  ON 53
eH2_4                 1.016205e-03 1 1  ON 54
eH2_5                 1.329571e-02 1 1  ON 55
eH2_6                 4.405526e-02 1 1  ON 56
eH2_7                 4.890918e-02 1 1  ON 57
eH2_8                 3.140461e-02 1 1  ON 58
eH2_9                 9.100652e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.3332
    reference variance = 0.523679
====================================================
  Execution time = 4.5174e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.5966e-01
  Total weights = 2.0000e+06
  Execution time = 3.8320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559742523001
                                         uncertainty =       0.004068682972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559742523001
                                         uncertainty =       0.004068682972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528988997
  error estimate for blocks of size 2^( 2) =       0.000548692930
  error estimate for blocks of size 2^( 3) =       0.000566797662
  error estimate for blocks of size 2^( 4) =       0.000580691595
  error estimate for blocks of size 2^( 5) =       0.000590529709
  error estimate for blocks of size 2^( 6) =       0.000594669981
  error estimate for blocks of size 2^( 7) =       0.000599263038

      target function =                  N/A
              le_mean =     -22.437544801922
             les_mean =     504.003075175406
             stat err =       0.000591288581
             autocorr =       1.249412097231
              std dev =       0.748103413302
             le_variance =       0.559658716995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559742436173
                                         uncertainty =       0.004068681857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559742436173
                                         uncertainty =       0.004068681857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528988956
  error estimate for blocks of size 2^( 2) =       0.000548692892
  error estimate for blocks of size 2^( 3) =       0.000566797626
  error estimate for blocks of size 2^( 4) =       0.000580691561
  error estimate for blocks of size 2^( 5) =       0.000590529677
  error estimate for blocks of size 2^( 6) =       0.000594669949
  error estimate for blocks of size 2^( 7) =       0.000599263005

      target function =                  N/A
              le_mean =     -22.437544801566
             les_mean =     504.003075072621
             stat err =       0.000591288548
             autocorr =       1.249412153966
              std dev =       0.748103355273
             le_variance =       0.559658630171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559742479580
                                         uncertainty =       0.004068682414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559742479580
                                         uncertainty =       0.004068682414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528988976
  error estimate for blocks of size 2^( 2) =       0.000548692911
  error estimate for blocks of size 2^( 3) =       0.000566797644
  error estimate for blocks of size 2^( 4) =       0.000580691578
  error estimate for blocks of size 2^( 5) =       0.000590529693
  error estimate for blocks of size 2^( 6) =       0.000594669965
  error estimate for blocks of size 2^( 7) =       0.000599263021

      target function =                  N/A
              le_mean =     -22.437544801744
             les_mean =     504.003075124005
             stat err =       0.000591288564
             autocorr =       1.249412125605
              std dev =       0.748103384284
             le_variance =       0.559658673576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559742517573
                                         uncertainty =       0.004068682902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559742517573
                                         uncertainty =       0.004068682902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528988994
  error estimate for blocks of size 2^( 2) =       0.000548692928
  error estimate for blocks of size 2^( 3) =       0.000566797660
  error estimate for blocks of size 2^( 4) =       0.000580691593
  error estimate for blocks of size 2^( 5) =       0.000590529707
  error estimate for blocks of size 2^( 6) =       0.000594669979
  error estimate for blocks of size 2^( 7) =       0.000599263036

      target function =                  N/A
              le_mean =     -22.437544801899
             les_mean =     504.003075168980
             stat err =       0.000591288579
             autocorr =       1.249412100773
              std dev =       0.748103409675
             le_variance =       0.559658711567


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437544801922        initial  <--
     2.3842e+03     2.3842e+04             1.3288e-07       -22.437544801566
     9.5367e+03     9.5367e+04             3.3222e-08       -22.437544801744
     3.8147e+04     3.8147e+05             8.3057e-09       -22.437544801899

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.3560
  </log>
  <optVariables href="FORMN2GVP1B.s025.opt.xml">
 uu_0                 2.708852e-01 1 1  ON 0
 uu_1                 9.602309e-02 1 1  ON 1
 uu_2                -1.965893e-02 1 1  ON 2
 uu_3                -8.882700e-02 1 1  ON 3
 uu_4                -1.290819e-01 1 1  ON 4
 uu_5                -1.525445e-01 1 1  ON 5
 uu_6                -1.631956e-01 1 1  ON 6
 uu_7                -1.597927e-01 1 1  ON 7
 uu_8                -1.390308e-01 1 1  ON 8
 uu_9                -8.520329e-02 1 1  ON 9
 ud_0                 4.436449e-01 1 1  ON 10
 ud_1                 1.596243e-01 1 1  ON 11
 ud_2                 1.029518e-02 1 1  ON 12
 ud_3                -7.283639e-02 1 1  ON 13
 ud_4                -1.210618e-01 1 1  ON 14
 ud_5                -1.518253e-01 1 1  ON 15
 ud_6                -1.696446e-01 1 1  ON 16
 ud_7                -1.729321e-01 1 1  ON 17
 ud_8                -1.574458e-01 1 1  ON 18
 ud_9                -1.120834e-01 1 1  ON 19
 eC_0                -6.265927e-01 1 1  ON 20
 eC_1                -4.556452e-01 1 1  ON 21
 eC_2                -1.580730e-01 1 1  ON 22
 eC_3                 5.268363e-02 1 1  ON 23
 eC_4                 1.828388e-01 1 1  ON 24
 eC_5                 2.866345e-01 1 1  ON 25
 eC_6                 2.829280e-01 1 1  ON 26
 eC_7                 2.822422e-01 1 1  ON 27
 eC_8                 1.229639e-01 1 1  ON 28
 eC_9                 2.665336e-02 1 1  ON 29
 eO_0                -1.144093e+00 1 1  ON 30
 eO_1                -7.539959e-01 1 1  ON 31
 eO_2                -2.670233e-01 1 1  ON 32
 eO_3                 4.958121e-02 1 1  ON 33
 eO_4                 2.642717e-01 1 1  ON 34
 eO_5                 3.930776e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155091e-01 1 1  ON 37
 eO_8                 3.661140e-01 1 1  ON 38
 eO_9                 1.896250e-01 1 1  ON 39
eH1_0                -1.591344e-01 1 1  ON 40
eH1_1                -5.838653e-02 1 1  ON 41
eH1_2                -3.791777e-02 1 1  ON 42
eH1_3                -3.637234e-02 1 1  ON 43
eH1_4                 2.250221e-03 1 1  ON 44
eH1_5                 1.472447e-02 1 1  ON 45
eH1_6                 4.561472e-02 1 1  ON 46
eH1_7                 5.238139e-02 1 1  ON 47
eH1_8                 3.200234e-02 1 1  ON 48
eH1_9                 8.535804e-02 1 1  ON 49
eH2_0                -1.603406e-01 1 1  ON 50
eH2_1                -5.952419e-02 1 1  ON 51
eH2_2                -3.861152e-02 1 1  ON 52
eH2_3                -3.729011e-02 1 1  ON 53
eH2_4                 1.016204e-03 1 1  ON 54
eH2_5                 1.329570e-02 1 1  ON 55
eH2_6                 4.405527e-02 1 1  ON 56
eH2_7                 4.890917e-02 1 1  ON 57
eH2_8                 3.140461e-02 1 1  ON 58
eH2_9                 9.100652e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2555e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2435e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.2836
    reference variance = 1.34328
====================================================
  Execution time = 4.5365e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5916e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5092e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559149373851
                                         uncertainty =       0.003694860824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559149373851
                                         uncertainty =       0.003694860824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528751789
  error estimate for blocks of size 2^( 2) =       0.000548379173
  error estimate for blocks of size 2^( 3) =       0.000567139411
  error estimate for blocks of size 2^( 4) =       0.000580857743
  error estimate for blocks of size 2^( 5) =       0.000589828450
  error estimate for blocks of size 2^( 6) =       0.000595854584
  error estimate for blocks of size 2^( 7) =       0.000599738985

      target function =                  N/A
              le_mean =     -22.437023579208
             les_mean =     503.979183722412
             stat err =       0.000591569941
             autocorr =       1.251723763223
              std dev =       0.747767950680
             le_variance =       0.559156908065


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243702357921e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437023579208       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437023579225       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437023579229       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437023579255       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437023579256       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437023579272       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437023579278       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437023579255       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437023579349       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437023579208       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+04 is 1.194080e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437023579208       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437023579212       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437023579213       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437023579262       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437023579221       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437023579213       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437023579187       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437023579202       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437023579351       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437023579249       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+04 is 2.985203e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437023579208       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437023579209       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437023579209       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437023579210       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437023579211       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437023579599       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437023579268       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437023579370       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437023579415       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437023579884       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+05 is 7.463012e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.294005 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0465e+01
  </log>
  <optVariables href="FORMN2GVP1B.s026.opt.xml">
 uu_0                 2.708852e-01 1 1  ON 0
 uu_1                 9.602309e-02 1 1  ON 1
 uu_2                -1.965893e-02 1 1  ON 2
 uu_3                -8.882700e-02 1 1  ON 3
 uu_4                -1.290819e-01 1 1  ON 4
 uu_5                -1.525445e-01 1 1  ON 5
 uu_6                -1.631956e-01 1 1  ON 6
 uu_7                -1.597927e-01 1 1  ON 7
 uu_8                -1.390308e-01 1 1  ON 8
 uu_9                -8.520329e-02 1 1  ON 9
 ud_0                 4.436449e-01 1 1  ON 10
 ud_1                 1.596243e-01 1 1  ON 11
 ud_2                 1.029518e-02 1 1  ON 12
 ud_3                -7.283639e-02 1 1  ON 13
 ud_4                -1.210618e-01 1 1  ON 14
 ud_5                -1.518253e-01 1 1  ON 15
 ud_6                -1.696446e-01 1 1  ON 16
 ud_7                -1.729321e-01 1 1  ON 17
 ud_8                -1.574458e-01 1 1  ON 18
 ud_9                -1.120834e-01 1 1  ON 19
 eC_0                -6.265927e-01 1 1  ON 20
 eC_1                -4.556452e-01 1 1  ON 21
 eC_2                -1.580730e-01 1 1  ON 22
 eC_3                 5.268363e-02 1 1  ON 23
 eC_4                 1.828388e-01 1 1  ON 24
 eC_5                 2.866345e-01 1 1  ON 25
 eC_6                 2.829280e-01 1 1  ON 26
 eC_7                 2.822422e-01 1 1  ON 27
 eC_8                 1.229639e-01 1 1  ON 28
 eC_9                 2.665336e-02 1 1  ON 29
 eO_0                -1.144093e+00 1 1  ON 30
 eO_1                -7.539959e-01 1 1  ON 31
 eO_2                -2.670234e-01 1 1  ON 32
 eO_3                 4.958121e-02 1 1  ON 33
 eO_4                 2.642717e-01 1 1  ON 34
 eO_5                 3.930776e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155091e-01 1 1  ON 37
 eO_8                 3.661140e-01 1 1  ON 38
 eO_9                 1.896250e-01 1 1  ON 39
eH1_0                -1.591344e-01 1 1  ON 40
eH1_1                -5.838653e-02 1 1  ON 41
eH1_2                -3.791777e-02 1 1  ON 42
eH1_3                -3.637234e-02 1 1  ON 43
eH1_4                 2.250221e-03 1 1  ON 44
eH1_5                 1.472447e-02 1 1  ON 45
eH1_6                 4.561472e-02 1 1  ON 46
eH1_7                 5.238139e-02 1 1  ON 47
eH1_8                 3.200234e-02 1 1  ON 48
eH1_9                 8.535804e-02 1 1  ON 49
eH2_0                -1.603406e-01 1 1  ON 50
eH2_1                -5.952420e-02 1 1  ON 51
eH2_2                -3.861152e-02 1 1  ON 52
eH2_3                -3.729011e-02 1 1  ON 53
eH2_4                 1.016204e-03 1 1  ON 54
eH2_5                 1.329570e-02 1 1  ON 55
eH2_6                 4.405527e-02 1 1  ON 56
eH2_7                 4.890917e-02 1 1  ON 57
eH2_8                 3.140461e-02 1 1  ON 58
eH2_9                 9.100652e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.4859
    reference variance = 0.524615
====================================================
  Execution time = 4.5298e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 6.2640e-01
  Total weights = 2.0000e+06
  Execution time = 3.8289e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.626595612631
                                         uncertainty =       0.060259811710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.626595612631
                                         uncertainty =       0.060259811710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000559644868
  error estimate for blocks of size 2^( 2) =       0.000578803643
  error estimate for blocks of size 2^( 3) =       0.000596092400
  error estimate for blocks of size 2^( 4) =       0.000608590813
  error estimate for blocks of size 2^( 5) =       0.000617835196
  error estimate for blocks of size 2^( 6) =       0.000622522369
  error estimate for blocks of size 2^( 7) =       0.000626117310

      target function =                  N/A
              le_mean =     -22.436057803150
             les_mean =     504.003094190686
             stat err =       0.000618766422
             autocorr =       1.222442455528
              std dev =       0.791457363105
             le_variance =       0.626404757614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.626595596809
                                         uncertainty =       0.060259810042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.626595596809
                                         uncertainty =       0.060259810042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000559644861
  error estimate for blocks of size 2^( 2) =       0.000578803637
  error estimate for blocks of size 2^( 3) =       0.000596092393
  error estimate for blocks of size 2^( 4) =       0.000608590807
  error estimate for blocks of size 2^( 5) =       0.000617835190
  error estimate for blocks of size 2^( 6) =       0.000622522363
  error estimate for blocks of size 2^( 7) =       0.000626117304

      target function =                  N/A
              le_mean =     -22.436057803145
             les_mean =     504.003094174679
             stat err =       0.000618766416
             autocorr =       1.222442463372
              std dev =       0.791457353112
             le_variance =       0.626404741795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.626595604720
                                         uncertainty =       0.060259810876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.626595604720
                                         uncertainty =       0.060259810876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000559644865
  error estimate for blocks of size 2^( 2) =       0.000578803640
  error estimate for blocks of size 2^( 3) =       0.000596092396
  error estimate for blocks of size 2^( 4) =       0.000608590810
  error estimate for blocks of size 2^( 5) =       0.000617835193
  error estimate for blocks of size 2^( 6) =       0.000622522366
  error estimate for blocks of size 2^( 7) =       0.000626117307

      target function =                  N/A
              le_mean =     -22.436057803148
             les_mean =     504.003094182682
             stat err =       0.000618766419
             autocorr =       1.222442459449
              std dev =       0.791457358109
             le_variance =       0.626404749704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.626595611642
                                         uncertainty =       0.060259811606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.626595611642
                                         uncertainty =       0.060259811606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000559644868
  error estimate for blocks of size 2^( 2) =       0.000578803643
  error estimate for blocks of size 2^( 3) =       0.000596092399
  error estimate for blocks of size 2^( 4) =       0.000608590813
  error estimate for blocks of size 2^( 5) =       0.000617835195
  error estimate for blocks of size 2^( 6) =       0.000622522369
  error estimate for blocks of size 2^( 7) =       0.000626117310

      target function =                  N/A
              le_mean =     -22.436057803149
             les_mean =     504.003094189686
             stat err =       0.000618766422
             autocorr =       1.222442456020
              std dev =       0.791457362481
             le_variance =       0.626404756625


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436057803150        initial  <--
     2.3842e+04     2.3842e+05             1.1941e-08       -22.436057803145
     9.5367e+04     9.5367e+05             2.9852e-09       -22.436057803148
     3.8147e+05     3.8147e+06             7.4630e-10       -22.436057803149

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.4856
  </log>
  <optVariables href="FORMN2GVP1B.s026.opt.xml">
 uu_0                 2.708852e-01 1 1  ON 0
 uu_1                 9.602309e-02 1 1  ON 1
 uu_2                -1.965893e-02 1 1  ON 2
 uu_3                -8.882700e-02 1 1  ON 3
 uu_4                -1.290819e-01 1 1  ON 4
 uu_5                -1.525445e-01 1 1  ON 5
 uu_6                -1.631956e-01 1 1  ON 6
 uu_7                -1.597927e-01 1 1  ON 7
 uu_8                -1.390308e-01 1 1  ON 8
 uu_9                -8.520329e-02 1 1  ON 9
 ud_0                 4.436449e-01 1 1  ON 10
 ud_1                 1.596243e-01 1 1  ON 11
 ud_2                 1.029518e-02 1 1  ON 12
 ud_3                -7.283639e-02 1 1  ON 13
 ud_4                -1.210618e-01 1 1  ON 14
 ud_5                -1.518253e-01 1 1  ON 15
 ud_6                -1.696446e-01 1 1  ON 16
 ud_7                -1.729321e-01 1 1  ON 17
 ud_8                -1.574458e-01 1 1  ON 18
 ud_9                -1.120834e-01 1 1  ON 19
 eC_0                -6.265927e-01 1 1  ON 20
 eC_1                -4.556452e-01 1 1  ON 21
 eC_2                -1.580730e-01 1 1  ON 22
 eC_3                 5.268363e-02 1 1  ON 23
 eC_4                 1.828388e-01 1 1  ON 24
 eC_5                 2.866345e-01 1 1  ON 25
 eC_6                 2.829280e-01 1 1  ON 26
 eC_7                 2.822422e-01 1 1  ON 27
 eC_8                 1.229639e-01 1 1  ON 28
 eC_9                 2.665336e-02 1 1  ON 29
 eO_0                -1.144093e+00 1 1  ON 30
 eO_1                -7.539959e-01 1 1  ON 31
 eO_2                -2.670233e-01 1 1  ON 32
 eO_3                 4.958121e-02 1 1  ON 33
 eO_4                 2.642717e-01 1 1  ON 34
 eO_5                 3.930776e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155091e-01 1 1  ON 37
 eO_8                 3.661140e-01 1 1  ON 38
 eO_9                 1.896250e-01 1 1  ON 39
eH1_0                -1.591344e-01 1 1  ON 40
eH1_1                -5.838653e-02 1 1  ON 41
eH1_2                -3.791777e-02 1 1  ON 42
eH1_3                -3.637234e-02 1 1  ON 43
eH1_4                 2.250221e-03 1 1  ON 44
eH1_5                 1.472447e-02 1 1  ON 45
eH1_6                 4.561472e-02 1 1  ON 46
eH1_7                 5.238139e-02 1 1  ON 47
eH1_8                 3.200234e-02 1 1  ON 48
eH1_9                 8.535804e-02 1 1  ON 49
eH2_0                -1.603406e-01 1 1  ON 50
eH2_1                -5.952419e-02 1 1  ON 51
eH2_2                -3.861152e-02 1 1  ON 52
eH2_3                -3.729011e-02 1 1  ON 53
eH2_4                 1.016204e-03 1 1  ON 54
eH2_5                 1.329570e-02 1 1  ON 55
eH2_6                 4.405527e-02 1 1  ON 56
eH2_7                 4.890917e-02 1 1  ON 57
eH2_8                 3.140461e-02 1 1  ON 58
eH2_9                 9.100652e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2496e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2433e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.4526
    reference variance = 0.507665
====================================================
  Execution time = 4.4981e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6438e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5150e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564430290812
                                         uncertainty =       0.004088949507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564430290812
                                         uncertainty =       0.004088949507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531216523
  error estimate for blocks of size 2^( 2) =       0.000550933089
  error estimate for blocks of size 2^( 3) =       0.000568804400
  error estimate for blocks of size 2^( 4) =       0.000582502183
  error estimate for blocks of size 2^( 5) =       0.000591409752
  error estimate for blocks of size 2^( 6) =       0.000596510358
  error estimate for blocks of size 2^( 7) =       0.000595853585

      target function =                  N/A
              le_mean =     -22.436021737238
             les_mean =     503.939453099790
             stat err =       0.000591568970
             autocorr =       1.240131163301
              std dev =       0.751253611088
             le_variance =       0.564381988173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243602173724e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436021737238       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436021737242       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436021737244       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436021737306       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436021737245       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436021737297       residual = 9.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436021737145       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436021737188       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436021737212       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436021737640       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+05 is 1.238000e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436021737238       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436021737239       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436021737239       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436021737240       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436021737356       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436021737840       residual = 9.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436021736997       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436021736788       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436021736735       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436021738280       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+05 is 3.095000e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436021737238       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436021737238       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436021737238       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436021737212       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436021731175       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436021736418       residual = 9.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436021734485       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436021736142       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436021735623       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436021738909       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+06 is 7.737581e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.297826 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0139e+01
  </log>
  <optVariables href="FORMN2GVP1B.s027.opt.xml">
 uu_0                 2.708852e-01 1 1  ON 0
 uu_1                 9.602309e-02 1 1  ON 1
 uu_2                -1.965893e-02 1 1  ON 2
 uu_3                -8.882700e-02 1 1  ON 3
 uu_4                -1.290819e-01 1 1  ON 4
 uu_5                -1.525445e-01 1 1  ON 5
 uu_6                -1.631956e-01 1 1  ON 6
 uu_7                -1.597927e-01 1 1  ON 7
 uu_8                -1.390308e-01 1 1  ON 8
 uu_9                -8.520329e-02 1 1  ON 9
 ud_0                 4.436449e-01 1 1  ON 10
 ud_1                 1.596243e-01 1 1  ON 11
 ud_2                 1.029518e-02 1 1  ON 12
 ud_3                -7.283639e-02 1 1  ON 13
 ud_4                -1.210618e-01 1 1  ON 14
 ud_5                -1.518253e-01 1 1  ON 15
 ud_6                -1.696446e-01 1 1  ON 16
 ud_7                -1.729321e-01 1 1  ON 17
 ud_8                -1.574458e-01 1 1  ON 18
 ud_9                -1.120834e-01 1 1  ON 19
 eC_0                -6.265927e-01 1 1  ON 20
 eC_1                -4.556452e-01 1 1  ON 21
 eC_2                -1.580730e-01 1 1  ON 22
 eC_3                 5.268363e-02 1 1  ON 23
 eC_4                 1.828388e-01 1 1  ON 24
 eC_5                 2.866345e-01 1 1  ON 25
 eC_6                 2.829280e-01 1 1  ON 26
 eC_7                 2.822422e-01 1 1  ON 27
 eC_8                 1.229639e-01 1 1  ON 28
 eC_9                 2.665336e-02 1 1  ON 29
 eO_0                -1.144093e+00 1 1  ON 30
 eO_1                -7.539959e-01 1 1  ON 31
 eO_2                -2.670233e-01 1 1  ON 32
 eO_3                 4.958121e-02 1 1  ON 33
 eO_4                 2.642717e-01 1 1  ON 34
 eO_5                 3.930776e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155091e-01 1 1  ON 37
 eO_8                 3.661140e-01 1 1  ON 38
 eO_9                 1.896250e-01 1 1  ON 39
eH1_0                -1.591344e-01 1 1  ON 40
eH1_1                -5.838653e-02 1 1  ON 41
eH1_2                -3.791777e-02 1 1  ON 42
eH1_3                -3.637234e-02 1 1  ON 43
eH1_4                 2.250221e-03 1 1  ON 44
eH1_5                 1.472447e-02 1 1  ON 45
eH1_6                 4.561472e-02 1 1  ON 46
eH1_7                 5.238139e-02 1 1  ON 47
eH1_8                 3.200234e-02 1 1  ON 48
eH1_9                 8.535804e-02 1 1  ON 49
eH2_0                -1.603406e-01 1 1  ON 50
eH2_1                -5.952419e-02 1 1  ON 51
eH2_2                -3.861152e-02 1 1  ON 52
eH2_3                -3.729011e-02 1 1  ON 53
eH2_4                 1.016204e-03 1 1  ON 54
eH2_5                 1.329570e-02 1 1  ON 55
eH2_6                 4.405527e-02 1 1  ON 56
eH2_7                 4.890917e-02 1 1  ON 57
eH2_8                 3.140461e-02 1 1  ON 58
eH2_9                 9.100652e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.5146
    reference variance = 0.453925
====================================================
  Execution time = 4.7199e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6742e-01
  Total weights = 2.0000e+06
  Execution time = 3.8330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567473151950
                                         uncertainty =       0.010980683870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567473151950
                                         uncertainty =       0.010980683870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532646327
  error estimate for blocks of size 2^( 2) =       0.000552505265
  error estimate for blocks of size 2^( 3) =       0.000571306519
  error estimate for blocks of size 2^( 4) =       0.000584412446
  error estimate for blocks of size 2^( 5) =       0.000593064850
  error estimate for blocks of size 2^( 6) =       0.000596731733
  error estimate for blocks of size 2^( 7) =       0.000597897937

      target function =                  N/A
              le_mean =     -22.435974350760
             les_mean =     503.940369003317
             stat err =       0.000593026742
             autocorr =       1.239568930538
              std dev =       0.753275659409
             le_variance =       0.567424219058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567473151628
                                         uncertainty =       0.010980683837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567473151628
                                         uncertainty =       0.010980683837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532646327
  error estimate for blocks of size 2^( 2) =       0.000552505265
  error estimate for blocks of size 2^( 3) =       0.000571306519
  error estimate for blocks of size 2^( 4) =       0.000584412446
  error estimate for blocks of size 2^( 5) =       0.000593064850
  error estimate for blocks of size 2^( 6) =       0.000596731733
  error estimate for blocks of size 2^( 7) =       0.000597897936

      target function =                  N/A
              le_mean =     -22.435974350762
             les_mean =     503.940369003085
             stat err =       0.000593026741
             autocorr =       1.239568930596
              std dev =       0.753275659195
             le_variance =       0.567424218736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567473151789
                                         uncertainty =       0.010980683854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567473151789
                                         uncertainty =       0.010980683854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532646327
  error estimate for blocks of size 2^( 2) =       0.000552505265
  error estimate for blocks of size 2^( 3) =       0.000571306519
  error estimate for blocks of size 2^( 4) =       0.000584412446
  error estimate for blocks of size 2^( 5) =       0.000593064850
  error estimate for blocks of size 2^( 6) =       0.000596731733
  error estimate for blocks of size 2^( 7) =       0.000597897936

      target function =                  N/A
              le_mean =     -22.435974350761
             les_mean =     503.940369003201
             stat err =       0.000593026741
             autocorr =       1.239568930567
              std dev =       0.753275659302
             le_variance =       0.567424218897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567473151930
                                         uncertainty =       0.010980683868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567473151930
                                         uncertainty =       0.010980683868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532646327
  error estimate for blocks of size 2^( 2) =       0.000552505265
  error estimate for blocks of size 2^( 3) =       0.000571306519
  error estimate for blocks of size 2^( 4) =       0.000584412446
  error estimate for blocks of size 2^( 5) =       0.000593064850
  error estimate for blocks of size 2^( 6) =       0.000596731733
  error estimate for blocks of size 2^( 7) =       0.000597897936

      target function =                  N/A
              le_mean =     -22.435974350760
             les_mean =     503.940369003302
             stat err =       0.000593026742
             autocorr =       1.239568930541
              std dev =       0.753275659396
             le_variance =       0.567424219038


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435974350760        initial
     2.3842e+05     2.3842e+06             1.2380e-09       -22.435974350762  <--
     9.5367e+05     9.5367e+06             3.0950e-10       -22.435974350761
     3.8147e+06     3.8147e+07             7.7376e-11       -22.435974350760

*****************************************************************************
Applying the update for shift_i =   2.3842e+05     and shift_s =   2.3842e+06
*****************************************************************************

  Execution time = 6.6456e+01
  </log>
  <optVariables href="FORMN2GVP1B.s027.opt.xml">
 uu_0                 2.708852e-01 1 1  ON 0
 uu_1                 9.602309e-02 1 1  ON 1
 uu_2                -1.965893e-02 1 1  ON 2
 uu_3                -8.882700e-02 1 1  ON 3
 uu_4                -1.290819e-01 1 1  ON 4
 uu_5                -1.525445e-01 1 1  ON 5
 uu_6                -1.631956e-01 1 1  ON 6
 uu_7                -1.597927e-01 1 1  ON 7
 uu_8                -1.390308e-01 1 1  ON 8
 uu_9                -8.520329e-02 1 1  ON 9
 ud_0                 4.436449e-01 1 1  ON 10
 ud_1                 1.596243e-01 1 1  ON 11
 ud_2                 1.029518e-02 1 1  ON 12
 ud_3                -7.283639e-02 1 1  ON 13
 ud_4                -1.210618e-01 1 1  ON 14
 ud_5                -1.518253e-01 1 1  ON 15
 ud_6                -1.696446e-01 1 1  ON 16
 ud_7                -1.729321e-01 1 1  ON 17
 ud_8                -1.574458e-01 1 1  ON 18
 ud_9                -1.120834e-01 1 1  ON 19
 eC_0                -6.265927e-01 1 1  ON 20
 eC_1                -4.556452e-01 1 1  ON 21
 eC_2                -1.580730e-01 1 1  ON 22
 eC_3                 5.268363e-02 1 1  ON 23
 eC_4                 1.828388e-01 1 1  ON 24
 eC_5                 2.866345e-01 1 1  ON 25
 eC_6                 2.829280e-01 1 1  ON 26
 eC_7                 2.822422e-01 1 1  ON 27
 eC_8                 1.229639e-01 1 1  ON 28
 eC_9                 2.665336e-02 1 1  ON 29
 eO_0                -1.144093e+00 1 1  ON 30
 eO_1                -7.539959e-01 1 1  ON 31
 eO_2                -2.670233e-01 1 1  ON 32
 eO_3                 4.958121e-02 1 1  ON 33
 eO_4                 2.642717e-01 1 1  ON 34
 eO_5                 3.930776e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155091e-01 1 1  ON 37
 eO_8                 3.661140e-01 1 1  ON 38
 eO_9                 1.896250e-01 1 1  ON 39
eH1_0                -1.591344e-01 1 1  ON 40
eH1_1                -5.838653e-02 1 1  ON 41
eH1_2                -3.791777e-02 1 1  ON 42
eH1_3                -3.637234e-02 1 1  ON 43
eH1_4                 2.250221e-03 1 1  ON 44
eH1_5                 1.472447e-02 1 1  ON 45
eH1_6                 4.561472e-02 1 1  ON 46
eH1_7                 5.238139e-02 1 1  ON 47
eH1_8                 3.200234e-02 1 1  ON 48
eH1_9                 8.535804e-02 1 1  ON 49
eH2_0                -1.603406e-01 1 1  ON 50
eH2_1                -5.952419e-02 1 1  ON 51
eH2_2                -3.861152e-02 1 1  ON 52
eH2_3                -3.729011e-02 1 1  ON 53
eH2_4                 1.016204e-03 1 1  ON 54
eH2_5                 1.329570e-02 1 1  ON 55
eH2_6                 4.405527e-02 1 1  ON 56
eH2_7                 4.890917e-02 1 1  ON 57
eH2_8                 3.140461e-02 1 1  ON 58
eH2_9                 9.100652e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2660e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2435e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.4255
    reference variance = 0.600254
====================================================
  Execution time = 4.5611e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7246e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5140e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572574921876
                                         uncertainty =       0.012130904978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572574921876
                                         uncertainty =       0.012130904978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535004780
  error estimate for blocks of size 2^( 2) =       0.000555147418
  error estimate for blocks of size 2^( 3) =       0.000573820495
  error estimate for blocks of size 2^( 4) =       0.000588364540
  error estimate for blocks of size 2^( 5) =       0.000597077104
  error estimate for blocks of size 2^( 6) =       0.000599260876
  error estimate for blocks of size 2^( 7) =       0.000602838185

      target function =                  N/A
              le_mean =     -22.437916523435
             les_mean =     504.032557854645
             stat err =       0.000596885176
             autocorr =       1.244704509717
              std dev =       0.756611015146
             le_variance =       0.572460228241


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243791652343e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437916523435       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437916523445       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437916523453       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437916523478       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437916523481       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437916523468       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437916523455       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437916523464       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437916523519       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437916523567       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+04 is 4.251632e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437916523435       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437916523437       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437916523439       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437916523446       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437916523598       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437916523484       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437916523521       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437916523653       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437916523377       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437916524726       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+05 is 1.062909e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437916523435       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437916523436       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437916523436       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437916523438       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437916523303       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437916523161       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437916522251       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437916523659       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437916526545       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437916520971       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+05 is 2.657268e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301438 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0759e+01
  </log>
  <optVariables href="FORMN2GVP1B.s028.opt.xml">
 uu_0                 2.708852e-01 1 1  ON 0
 uu_1                 9.602309e-02 1 1  ON 1
 uu_2                -1.965893e-02 1 1  ON 2
 uu_3                -8.882700e-02 1 1  ON 3
 uu_4                -1.290819e-01 1 1  ON 4
 uu_5                -1.525445e-01 1 1  ON 5
 uu_6                -1.631956e-01 1 1  ON 6
 uu_7                -1.597927e-01 1 1  ON 7
 uu_8                -1.390308e-01 1 1  ON 8
 uu_9                -8.520329e-02 1 1  ON 9
 ud_0                 4.436449e-01 1 1  ON 10
 ud_1                 1.596243e-01 1 1  ON 11
 ud_2                 1.029518e-02 1 1  ON 12
 ud_3                -7.283639e-02 1 1  ON 13
 ud_4                -1.210618e-01 1 1  ON 14
 ud_5                -1.518253e-01 1 1  ON 15
 ud_6                -1.696446e-01 1 1  ON 16
 ud_7                -1.729321e-01 1 1  ON 17
 ud_8                -1.574458e-01 1 1  ON 18
 ud_9                -1.120834e-01 1 1  ON 19
 eC_0                -6.265927e-01 1 1  ON 20
 eC_1                -4.556452e-01 1 1  ON 21
 eC_2                -1.580730e-01 1 1  ON 22
 eC_3                 5.268363e-02 1 1  ON 23
 eC_4                 1.828388e-01 1 1  ON 24
 eC_5                 2.866345e-01 1 1  ON 25
 eC_6                 2.829280e-01 1 1  ON 26
 eC_7                 2.822422e-01 1 1  ON 27
 eC_8                 1.229639e-01 1 1  ON 28
 eC_9                 2.665336e-02 1 1  ON 29
 eO_0                -1.144093e+00 1 1  ON 30
 eO_1                -7.539959e-01 1 1  ON 31
 eO_2                -2.670234e-01 1 1  ON 32
 eO_3                 4.958121e-02 1 1  ON 33
 eO_4                 2.642717e-01 1 1  ON 34
 eO_5                 3.930776e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155091e-01 1 1  ON 37
 eO_8                 3.661140e-01 1 1  ON 38
 eO_9                 1.896250e-01 1 1  ON 39
eH1_0                -1.591344e-01 1 1  ON 40
eH1_1                -5.838653e-02 1 1  ON 41
eH1_2                -3.791777e-02 1 1  ON 42
eH1_3                -3.637234e-02 1 1  ON 43
eH1_4                 2.250221e-03 1 1  ON 44
eH1_5                 1.472447e-02 1 1  ON 45
eH1_6                 4.561472e-02 1 1  ON 46
eH1_7                 5.238139e-02 1 1  ON 47
eH1_8                 3.200234e-02 1 1  ON 48
eH1_9                 8.535804e-02 1 1  ON 49
eH2_0                -1.603406e-01 1 1  ON 50
eH2_1                -5.952419e-02 1 1  ON 51
eH2_2                -3.861152e-02 1 1  ON 52
eH2_3                -3.729011e-02 1 1  ON 53
eH2_4                 1.016204e-03 1 1  ON 54
eH2_5                 1.329570e-02 1 1  ON 55
eH2_6                 4.405527e-02 1 1  ON 56
eH2_7                 4.890917e-02 1 1  ON 57
eH2_8                 3.140461e-02 1 1  ON 58
eH2_9                 9.100652e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.4248
    reference variance = 0.450297
====================================================
  Execution time = 4.5078e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5885e-01
  Total weights = 2.0000e+06
  Execution time = 3.8335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558875760404
                                         uncertainty =       0.004718192058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558875760404
                                         uncertainty =       0.004718192058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528606176
  error estimate for blocks of size 2^( 2) =       0.000548807458
  error estimate for blocks of size 2^( 3) =       0.000567605649
  error estimate for blocks of size 2^( 4) =       0.000582303712
  error estimate for blocks of size 2^( 5) =       0.000592145648
  error estimate for blocks of size 2^( 6) =       0.000596929494
  error estimate for blocks of size 2^( 7) =       0.000600280492

      target function =                  N/A
              le_mean =     -22.436795397871
             les_mean =     503.968636425871
             stat err =       0.000592914836
             autocorr =       1.258114504117
              std dev =       0.747562023768
             le_variance =       0.558848979381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558875754216
                                         uncertainty =       0.004718191967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558875754216
                                         uncertainty =       0.004718191967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528606173
  error estimate for blocks of size 2^( 2) =       0.000548807455
  error estimate for blocks of size 2^( 3) =       0.000567605646
  error estimate for blocks of size 2^( 4) =       0.000582303710
  error estimate for blocks of size 2^( 5) =       0.000592145645
  error estimate for blocks of size 2^( 6) =       0.000596929491
  error estimate for blocks of size 2^( 7) =       0.000600280490

      target function =                  N/A
              le_mean =     -22.436795397864
             les_mean =     503.968636419365
             stat err =       0.000592914834
             autocorr =       1.258114507183
              std dev =       0.747562019627
             le_variance =       0.558848973189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558875757310
                                         uncertainty =       0.004718192013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558875757310
                                         uncertainty =       0.004718192013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528606175
  error estimate for blocks of size 2^( 2) =       0.000548807456
  error estimate for blocks of size 2^( 3) =       0.000567605647
  error estimate for blocks of size 2^( 4) =       0.000582303711
  error estimate for blocks of size 2^( 5) =       0.000592145646
  error estimate for blocks of size 2^( 6) =       0.000596929492
  error estimate for blocks of size 2^( 7) =       0.000600280491

      target function =                  N/A
              le_mean =     -22.436795397867
             les_mean =     503.968636422618
             stat err =       0.000592914835
             autocorr =       1.258114505648
              std dev =       0.747562021698
             le_variance =       0.558848976285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558875760017
                                         uncertainty =       0.004718192053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558875760017
                                         uncertainty =       0.004718192053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528606176
  error estimate for blocks of size 2^( 2) =       0.000548807457
  error estimate for blocks of size 2^( 3) =       0.000567605649
  error estimate for blocks of size 2^( 4) =       0.000582303712
  error estimate for blocks of size 2^( 5) =       0.000592145648
  error estimate for blocks of size 2^( 6) =       0.000596929493
  error estimate for blocks of size 2^( 7) =       0.000600280492

      target function =                  N/A
              le_mean =     -22.436795397870
             les_mean =     503.968636425464
             stat err =       0.000592914836
             autocorr =       1.258114504304
              std dev =       0.747562023510
             le_variance =       0.558848978994


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436795397871        initial  <--
     5.9605e+04     5.9605e+05             4.2516e-09       -22.436795397864
     2.3842e+05     2.3842e+06             1.0629e-09       -22.436795397867
     9.5367e+05     9.5367e+06             2.6573e-10       -22.436795397870

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.2826
  </log>
  <optVariables href="FORMN2GVP1B.s028.opt.xml">
 uu_0                 2.708852e-01 1 1  ON 0
 uu_1                 9.602309e-02 1 1  ON 1
 uu_2                -1.965893e-02 1 1  ON 2
 uu_3                -8.882700e-02 1 1  ON 3
 uu_4                -1.290819e-01 1 1  ON 4
 uu_5                -1.525445e-01 1 1  ON 5
 uu_6                -1.631956e-01 1 1  ON 6
 uu_7                -1.597927e-01 1 1  ON 7
 uu_8                -1.390308e-01 1 1  ON 8
 uu_9                -8.520329e-02 1 1  ON 9
 ud_0                 4.436449e-01 1 1  ON 10
 ud_1                 1.596243e-01 1 1  ON 11
 ud_2                 1.029518e-02 1 1  ON 12
 ud_3                -7.283639e-02 1 1  ON 13
 ud_4                -1.210618e-01 1 1  ON 14
 ud_5                -1.518253e-01 1 1  ON 15
 ud_6                -1.696446e-01 1 1  ON 16
 ud_7                -1.729321e-01 1 1  ON 17
 ud_8                -1.574458e-01 1 1  ON 18
 ud_9                -1.120834e-01 1 1  ON 19
 eC_0                -6.265927e-01 1 1  ON 20
 eC_1                -4.556452e-01 1 1  ON 21
 eC_2                -1.580730e-01 1 1  ON 22
 eC_3                 5.268363e-02 1 1  ON 23
 eC_4                 1.828388e-01 1 1  ON 24
 eC_5                 2.866345e-01 1 1  ON 25
 eC_6                 2.829280e-01 1 1  ON 26
 eC_7                 2.822422e-01 1 1  ON 27
 eC_8                 1.229639e-01 1 1  ON 28
 eC_9                 2.665336e-02 1 1  ON 29
 eO_0                -1.144093e+00 1 1  ON 30
 eO_1                -7.539959e-01 1 1  ON 31
 eO_2                -2.670233e-01 1 1  ON 32
 eO_3                 4.958121e-02 1 1  ON 33
 eO_4                 2.642717e-01 1 1  ON 34
 eO_5                 3.930776e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155091e-01 1 1  ON 37
 eO_8                 3.661140e-01 1 1  ON 38
 eO_9                 1.896250e-01 1 1  ON 39
eH1_0                -1.591344e-01 1 1  ON 40
eH1_1                -5.838653e-02 1 1  ON 41
eH1_2                -3.791777e-02 1 1  ON 42
eH1_3                -3.637234e-02 1 1  ON 43
eH1_4                 2.250221e-03 1 1  ON 44
eH1_5                 1.472447e-02 1 1  ON 45
eH1_6                 4.561472e-02 1 1  ON 46
eH1_7                 5.238139e-02 1 1  ON 47
eH1_8                 3.200234e-02 1 1  ON 48
eH1_9                 8.535804e-02 1 1  ON 49
eH2_0                -1.603406e-01 1 1  ON 50
eH2_1                -5.952419e-02 1 1  ON 51
eH2_2                -3.861152e-02 1 1  ON 52
eH2_3                -3.729011e-02 1 1  ON 53
eH2_4                 1.016204e-03 1 1  ON 54
eH2_5                 1.329570e-02 1 1  ON 55
eH2_6                 4.405527e-02 1 1  ON 56
eH2_7                 4.890917e-02 1 1  ON 57
eH2_8                 3.140461e-02 1 1  ON 58
eH2_9                 9.100652e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2505e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2GVP1B.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2GVP1B.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2435e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.463
    reference variance = 0.506878
====================================================
  Execution time = 4.5789e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2GVP1B.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2435e+01
  VMC Evar = 5.6177e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5466e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561796290618
                                         uncertainty =       0.007771679849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561796290618
                                         uncertainty =       0.007771679849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529984499
  error estimate for blocks of size 2^( 2) =       0.000550042427
  error estimate for blocks of size 2^( 3) =       0.000568321339
  error estimate for blocks of size 2^( 4) =       0.000583579563
  error estimate for blocks of size 2^( 5) =       0.000592644507
  error estimate for blocks of size 2^( 6) =       0.000597221918
  error estimate for blocks of size 2^( 7) =       0.000600696187

      target function =                  N/A
              le_mean =     -22.435191574200
             les_mean =     503.899587828504
             stat err =       0.000593535544
             autocorr =       1.254200957776
              std dev =       0.749511266324
             le_variance =       0.561767138346


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243519157420e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435191574200       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435191574201       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435191574202       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435191574204       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435191574447       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435191574042       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435191574861       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435191574243       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435191574671       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435191572440       residual = 8.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+05 is 4.176550e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435191574200       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435191574200       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435191574200       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435191574201       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435191574201       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435191573655       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435191573911       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435191574258       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435191573843       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435191574099       residual = 8.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+06 is 1.044136e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435191574200       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435191574200       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435191574200       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435191571650       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435191573281       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435191574236       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435191570201       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435191570187       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435191602019       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435191596998       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+06 is 2.610509e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.305076 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1263e+01
  </log>
  <optVariables href="FORMN2GVP1B.s029.opt.xml">
 uu_0                 2.708852e-01 1 1  ON 0
 uu_1                 9.602309e-02 1 1  ON 1
 uu_2                -1.965893e-02 1 1  ON 2
 uu_3                -8.882700e-02 1 1  ON 3
 uu_4                -1.290819e-01 1 1  ON 4
 uu_5                -1.525445e-01 1 1  ON 5
 uu_6                -1.631956e-01 1 1  ON 6
 uu_7                -1.597927e-01 1 1  ON 7
 uu_8                -1.390308e-01 1 1  ON 8
 uu_9                -8.520329e-02 1 1  ON 9
 ud_0                 4.436449e-01 1 1  ON 10
 ud_1                 1.596243e-01 1 1  ON 11
 ud_2                 1.029518e-02 1 1  ON 12
 ud_3                -7.283639e-02 1 1  ON 13
 ud_4                -1.210618e-01 1 1  ON 14
 ud_5                -1.518253e-01 1 1  ON 15
 ud_6                -1.696446e-01 1 1  ON 16
 ud_7                -1.729321e-01 1 1  ON 17
 ud_8                -1.574458e-01 1 1  ON 18
 ud_9                -1.120834e-01 1 1  ON 19
 eC_0                -6.265927e-01 1 1  ON 20
 eC_1                -4.556452e-01 1 1  ON 21
 eC_2                -1.580730e-01 1 1  ON 22
 eC_3                 5.268363e-02 1 1  ON 23
 eC_4                 1.828388e-01 1 1  ON 24
 eC_5                 2.866345e-01 1 1  ON 25
 eC_6                 2.829280e-01 1 1  ON 26
 eC_7                 2.822422e-01 1 1  ON 27
 eC_8                 1.229639e-01 1 1  ON 28
 eC_9                 2.665336e-02 1 1  ON 29
 eO_0                -1.144093e+00 1 1  ON 30
 eO_1                -7.539959e-01 1 1  ON 31
 eO_2                -2.670233e-01 1 1  ON 32
 eO_3                 4.958121e-02 1 1  ON 33
 eO_4                 2.642717e-01 1 1  ON 34
 eO_5                 3.930776e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155091e-01 1 1  ON 37
 eO_8                 3.661140e-01 1 1  ON 38
 eO_9                 1.896250e-01 1 1  ON 39
eH1_0                -1.591344e-01 1 1  ON 40
eH1_1                -5.838653e-02 1 1  ON 41
eH1_2                -3.791777e-02 1 1  ON 42
eH1_3                -3.637234e-02 1 1  ON 43
eH1_4                 2.250221e-03 1 1  ON 44
eH1_5                 1.472447e-02 1 1  ON 45
eH1_6                 4.561472e-02 1 1  ON 46
eH1_7                 5.238139e-02 1 1  ON 47
eH1_8                 3.200234e-02 1 1  ON 48
eH1_9                 8.535804e-02 1 1  ON 49
eH2_0                -1.603406e-01 1 1  ON 50
eH2_1                -5.952419e-02 1 1  ON 51
eH2_2                -3.861152e-02 1 1  ON 52
eH2_3                -3.729011e-02 1 1  ON 53
eH2_4                 1.016204e-03 1 1  ON 54
eH2_5                 1.329570e-02 1 1  ON 55
eH2_6                 4.405527e-02 1 1  ON 56
eH2_7                 4.890917e-02 1 1  ON 57
eH2_8                 3.140461e-02 1 1  ON 58
eH2_9                 9.100652e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.429
    reference variance = 0.443526
====================================================
  Execution time = 4.5794e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2GVP1B.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6827e-01
  Total weights = 2.0000e+06
  Execution time = 3.8361e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567989609541
                                         uncertainty =       0.005965983200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567989609541
                                         uncertainty =       0.005965983200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533044628
  error estimate for blocks of size 2^( 2) =       0.000553442198
  error estimate for blocks of size 2^( 3) =       0.000571654496
  error estimate for blocks of size 2^( 4) =       0.000584709832
  error estimate for blocks of size 2^( 5) =       0.000592969053
  error estimate for blocks of size 2^( 6) =       0.000595987607
  error estimate for blocks of size 2^( 7) =       0.000597449491

      target function =                  N/A
              le_mean =     -22.437227447971
             les_mean =     503.997448418635
             stat err =       0.000592778996
             autocorr =       1.236683229450
              std dev =       0.753838942195
             le_variance =       0.568273150769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567989609709
                                         uncertainty =       0.005965983201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567989609709
                                         uncertainty =       0.005965983201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533044628
  error estimate for blocks of size 2^( 2) =       0.000553442198
  error estimate for blocks of size 2^( 3) =       0.000571654496
  error estimate for blocks of size 2^( 4) =       0.000584709832
  error estimate for blocks of size 2^( 5) =       0.000592969053
  error estimate for blocks of size 2^( 6) =       0.000595987607
  error estimate for blocks of size 2^( 7) =       0.000597449491

      target function =                  N/A
              le_mean =     -22.437227447971
             les_mean =     503.997448418799
             stat err =       0.000592778996
             autocorr =       1.236683229285
              std dev =       0.753838942306
             le_variance =       0.568273150937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567989609625
                                         uncertainty =       0.005965983200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567989609625
                                         uncertainty =       0.005965983200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533044628
  error estimate for blocks of size 2^( 2) =       0.000553442198
  error estimate for blocks of size 2^( 3) =       0.000571654496
  error estimate for blocks of size 2^( 4) =       0.000584709832
  error estimate for blocks of size 2^( 5) =       0.000592969053
  error estimate for blocks of size 2^( 6) =       0.000595987607
  error estimate for blocks of size 2^( 7) =       0.000597449491

      target function =                  N/A
              le_mean =     -22.437227447971
             les_mean =     503.997448418717
             stat err =       0.000592778996
             autocorr =       1.236683229371
              std dev =       0.753838942251
             le_variance =       0.568273150853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567989609551
                                         uncertainty =       0.005965983200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567989609551
                                         uncertainty =       0.005965983200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533044628
  error estimate for blocks of size 2^( 2) =       0.000553442198
  error estimate for blocks of size 2^( 3) =       0.000571654496
  error estimate for blocks of size 2^( 4) =       0.000584709832
  error estimate for blocks of size 2^( 5) =       0.000592969053
  error estimate for blocks of size 2^( 6) =       0.000595987607
  error estimate for blocks of size 2^( 7) =       0.000597449491

      target function =                  N/A
              le_mean =     -22.437227447971
             les_mean =     503.997448418645
             stat err =       0.000592778996
             autocorr =       1.236683229441
              std dev =       0.753838942202
             le_variance =       0.568273150780


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437227447971        initial  <--
     5.9605e+05     5.9605e+06             4.1765e-10       -22.437227447971
     2.3842e+06     2.3842e+07             1.0441e-10       -22.437227447971
     9.5367e+06     9.5367e+07             2.6105e-11       -22.437227447971

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.0183
  </log>
  <optVariables href="FORMN2GVP1B.s029.opt.xml">
 uu_0                 2.708852e-01 1 1  ON 0
 uu_1                 9.602309e-02 1 1  ON 1
 uu_2                -1.965893e-02 1 1  ON 2
 uu_3                -8.882700e-02 1 1  ON 3
 uu_4                -1.290819e-01 1 1  ON 4
 uu_5                -1.525445e-01 1 1  ON 5
 uu_6                -1.631956e-01 1 1  ON 6
 uu_7                -1.597927e-01 1 1  ON 7
 uu_8                -1.390308e-01 1 1  ON 8
 uu_9                -8.520329e-02 1 1  ON 9
 ud_0                 4.436449e-01 1 1  ON 10
 ud_1                 1.596243e-01 1 1  ON 11
 ud_2                 1.029518e-02 1 1  ON 12
 ud_3                -7.283639e-02 1 1  ON 13
 ud_4                -1.210618e-01 1 1  ON 14
 ud_5                -1.518253e-01 1 1  ON 15
 ud_6                -1.696446e-01 1 1  ON 16
 ud_7                -1.729321e-01 1 1  ON 17
 ud_8                -1.574458e-01 1 1  ON 18
 ud_9                -1.120834e-01 1 1  ON 19
 eC_0                -6.265927e-01 1 1  ON 20
 eC_1                -4.556452e-01 1 1  ON 21
 eC_2                -1.580730e-01 1 1  ON 22
 eC_3                 5.268363e-02 1 1  ON 23
 eC_4                 1.828388e-01 1 1  ON 24
 eC_5                 2.866345e-01 1 1  ON 25
 eC_6                 2.829280e-01 1 1  ON 26
 eC_7                 2.822422e-01 1 1  ON 27
 eC_8                 1.229639e-01 1 1  ON 28
 eC_9                 2.665336e-02 1 1  ON 29
 eO_0                -1.144093e+00 1 1  ON 30
 eO_1                -7.539959e-01 1 1  ON 31
 eO_2                -2.670233e-01 1 1  ON 32
 eO_3                 4.958121e-02 1 1  ON 33
 eO_4                 2.642717e-01 1 1  ON 34
 eO_5                 3.930776e-01 1 1  ON 35
 eO_6                 4.127940e-01 1 1  ON 36
 eO_7                 4.155091e-01 1 1  ON 37
 eO_8                 3.661140e-01 1 1  ON 38
 eO_9                 1.896250e-01 1 1  ON 39
eH1_0                -1.591344e-01 1 1  ON 40
eH1_1                -5.838653e-02 1 1  ON 41
eH1_2                -3.791777e-02 1 1  ON 42
eH1_3                -3.637234e-02 1 1  ON 43
eH1_4                 2.250221e-03 1 1  ON 44
eH1_5                 1.472447e-02 1 1  ON 45
eH1_6                 4.561472e-02 1 1  ON 46
eH1_7                 5.238139e-02 1 1  ON 47
eH1_8                 3.200234e-02 1 1  ON 48
eH1_9                 8.535804e-02 1 1  ON 49
eH2_0                -1.603406e-01 1 1  ON 50
eH2_1                -5.952419e-02 1 1  ON 51
eH2_2                -3.861152e-02 1 1  ON 52
eH2_3                -3.729011e-02 1 1  ON 53
eH2_4                 1.016204e-03 1 1  ON 54
eH2_5                 1.329570e-02 1 1  ON 55
eH2_6                 4.405527e-02 1 1  ON 56
eH2_7                 4.890917e-02 1 1  ON 57
eH2_8                 3.140461e-02 1 1  ON 58
eH2_9                 9.100652e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2629e+02 secs
  Total Execution time = 3.7809e+03 secs

=========================================================
  A new xml input file : FORMN2GVP1B.s029.cont.xml
