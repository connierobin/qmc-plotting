--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0254.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 79254 MB
Rank =    1  Free Memory = 79251 MB
Rank =    2  Free Memory = 79250 MB
Rank =    3  Free Memory = 79250 MB
Rank =    4  Free Memory = 79249 MB
Rank =    5  Free Memory = 79249 MB
Rank =    6  Free Memory = 79249 MB
Rank =    7  Free Memory = 79249 MB
Rank =    8  Free Memory = 79249 MB
Rank =    9  Free Memory = 79248 MB
Rank =   10  Free Memory = 79248 MB
Rank =   11  Free Memory = 79248 MB
Rank =   12  Free Memory = 79248 MB
Rank =   13  Free Memory = 79248 MB
Rank =   14  Free Memory = 79248 MB
Rank =   15  Free Memory = 79248 MB
Rank =   16  Free Memory = 79248 MB
Rank =   17  Free Memory = 79248 MB
Rank =   18  Free Memory = 79248 MB
Rank =   19  Free Memory = 79248 MB
Rank =   20  Free Memory = 79248 MB
Rank =   21  Free Memory = 79248 MB
Rank =   22  Free Memory = 79248 MB
Rank =   23  Free Memory = 79248 MB
Rank =   24  Free Memory = 79248 MB
Rank =   25  Free Memory = 79248 MB
Rank =   26  Free Memory = 79248 MB
Rank =   27  Free Memory = 79248 MB
Rank =   28  Free Memory = 79248 MB
Rank =   29  Free Memory = 79248 MB
Rank =   30  Free Memory = 79248 MB
Rank =   31  Free Memory = 79248 MB
Rank =   32  Free Memory = 79248 MB
Rank =   33  Free Memory = 79247 MB
Rank =   34  Free Memory = 79247 MB
Rank =   35  Free Memory = 79247 MB
Rank =   36  Free Memory = 79247 MB
Rank =   37  Free Memory = 79247 MB
Rank =   38  Free Memory = 79247 MB
Rank =   39  Free Memory = 79247 MB
Rank =   40  Free Memory = 79103 MB
Rank =   41  Free Memory = 79103 MB
Rank =   42  Free Memory = 79103 MB
Rank =   43  Free Memory = 79103 MB
Rank =   44  Free Memory = 79103 MB
Rank =   45  Free Memory = 79103 MB
Rank =   46  Free Memory = 79103 MB
Rank =   47  Free Memory = 79103 MB
Rank =   48  Free Memory = 79103 MB
Rank =   49  Free Memory = 79103 MB
Rank =   50  Free Memory = 79103 MB
Rank =   51  Free Memory = 79103 MB
Rank =   52  Free Memory = 79103 MB
Rank =   53  Free Memory = 79103 MB
Rank =   54  Free Memory = 79103 MB
Rank =   55  Free Memory = 79103 MB
Rank =   56  Free Memory = 79103 MB
Rank =   57  Free Memory = 79103 MB
Rank =   58  Free Memory = 79103 MB
Rank =   59  Free Memory = 79103 MB
Rank =   60  Free Memory = 79103 MB
Rank =   61  Free Memory = 79103 MB
Rank =   62  Free Memory = 79103 MB
Rank =   63  Free Memory = 79103 MB
Rank =   64  Free Memory = 79103 MB
Rank =   65  Free Memory = 79103 MB
Rank =   66  Free Memory = 79103 MB
Rank =   67  Free Memory = 79103 MB
Rank =   68  Free Memory = 79102 MB
Rank =   69  Free Memory = 79102 MB
Rank =   70  Free Memory = 79102 MB
Rank =   71  Free Memory = 79102 MB
Rank =   72  Free Memory = 79102 MB
Rank =   73  Free Memory = 79102 MB
Rank =   74  Free Memory = 79102 MB
Rank =   75  Free Memory = 79102 MB
Rank =   76  Free Memory = 79102 MB
Rank =   77  Free Memory = 79102 MB
Rank =   78  Free Memory = 79102 MB
Rank =   79  Free Memory = 79102 MB
Rank =   80  Free Memory = 90621 MB
Rank =   81  Free Memory = 90621 MB
Rank =   82  Free Memory = 90621 MB
Rank =   83  Free Memory = 90621 MB
Rank =   84  Free Memory = 90621 MB
Rank =   85  Free Memory = 90621 MB
Rank =   86  Free Memory = 90621 MB
Rank =   87  Free Memory = 90621 MB
Rank =   88  Free Memory = 90621 MB
Rank =   89  Free Memory = 90621 MB
Rank =   90  Free Memory = 90621 MB
Rank =   91  Free Memory = 90621 MB
Rank =   92  Free Memory = 90621 MB
Rank =   93  Free Memory = 90620 MB
Rank =   94  Free Memory = 90620 MB
Rank =   95  Free Memory = 90620 MB
Rank =   96  Free Memory = 90620 MB
Rank =   97  Free Memory = 90620 MB
Rank =   98  Free Memory = 90619 MB
Rank =   99  Free Memory = 90619 MB
Rank =  100  Free Memory = 90619 MB
Rank =  101  Free Memory = 90619 MB
Rank =  102  Free Memory = 90619 MB
Rank =  103  Free Memory = 90619 MB
Rank =  104  Free Memory = 90619 MB
Rank =  105  Free Memory = 90619 MB
Rank =  106  Free Memory = 90619 MB
Rank =  107  Free Memory = 90619 MB
Rank =  108  Free Memory = 90619 MB
Rank =  109  Free Memory = 90619 MB
Rank =  110  Free Memory = 90619 MB
Rank =  111  Free Memory = 90619 MB
Rank =  112  Free Memory = 90619 MB
Rank =  113  Free Memory = 90619 MB
Rank =  114  Free Memory = 90619 MB
Rank =  115  Free Memory = 90619 MB
Rank =  116  Free Memory = 90619 MB
Rank =  117  Free Memory = 90619 MB
Rank =  118  Free Memory = 90619 MB
Rank =  119  Free Memory = 90619 MB
  Input file(s): opt_form_pi2pistar_gvptt_run003h.xml 
Rank =  120  Free Memory = 91814 MB
Rank =  121  Free Memory = 91814 MB
Rank =  122  Free Memory = 91814 MB
Rank =  123  Free Memory = 91814 MB
Rank =  124  Free Memory = 91814 MB
Rank =  125  Free Memory = 91814 MB
Rank =  126  Free Memory = 91814 MB
Rank =  127  Free Memory = 91814 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_pi2pistar_gvptt_run003h.xml

  Project = FORM
  date    = 2023-03-18 14:58:32 PDT
  host    = n0239.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 8

  Range of prime numbers to use as seeds over processors and threads = 29-787


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.737366e-01    1         1  ON     0
     uu_1                 9.852186e-02    1         1  ON     1
     uu_2                -1.792633e-02    1         1  ON     2
     uu_3                -8.821766e-02    1         1  ON     3
     uu_4                -1.299412e-01    1         1  ON     4
     uu_5                -1.550084e-01    1         1  ON     5
     uu_6                -1.677578e-01    1         1  ON     6
     uu_7                -1.685982e-01    1         1  ON     7
     uu_8                -1.531611e-01    1         1  ON     8
     uu_9                -1.129470e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.658689e-01    1         1  ON     0
     ud_1                 1.814999e-01    1         1  ON     1
     ud_2                 3.090195e-02    1         1  ON     2
     ud_3                -5.381756e-02    1         1  ON     3
     ud_4                -1.041963e-01    1         1  ON     4
     ud_5                -1.374857e-01    1         1  ON     5
     ud_6                -1.582655e-01    1         1  ON     6
     ud_7                -1.660918e-01    1         1  ON     7
     ud_8                -1.567908e-01    1         1  ON     8
     ud_9                -1.265287e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -6.704770e-01    1         1  ON     0
     eC_1                -4.977410e-01    1         1  ON     1
     eC_2                -1.966748e-01    1         1  ON     2
     eC_3                 2.163421e-02    1         1  ON     3
     eC_4                 1.635276e-01    1         1  ON     4
     eC_5                 2.842474e-01    1         1  ON     5
     eC_6                 3.003015e-01    1         1  ON     6
     eC_7                 3.289336e-01    1         1  ON     7
     eC_8                 2.209408e-01    1         1  ON     8
     eC_9                 4.691343e-02    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.206658e+00    1         1  ON     0
     eO_1                -8.142227e-01    1         1  ON     1
     eO_2                -3.207455e-01    1         1  ON     2
     eO_3                 4.277986e-03    1         1  ON     3
     eO_4                 2.287441e-01    1         1  ON     4
     eO_5                 3.698531e-01    1         1  ON     5
     eO_6                 4.055440e-01    1         1  ON     6
     eO_7                 4.311395e-01    1         1  ON     7
     eO_8                 4.436197e-01    1         1  ON     8
     eO_9                 3.226280e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.654437e-01    1         1  ON     0
     eH1_1                -6.474760e-02    1         1  ON     1
     eH1_2                -4.351173e-02    1         1  ON     2
     eH1_3                -4.086449e-02    1         1  ON     3
     eH1_4                -2.044978e-03    1         1  ON     4
     eH1_5                 1.014062e-02    1         1  ON     5
     eH1_6                 3.965584e-02    1         1  ON     6
     eH1_7                 4.614509e-02    1         1  ON     7
     eH1_8                 3.160893e-02    1         1  ON     8
     eH1_9                 9.116540e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.673943e-01    1         1  ON     0
     eH2_1                -6.673774e-02    1         1  ON     1
     eH2_2                -4.598526e-02    1         1  ON     2
     eH2_3                -4.340550e-02    1         1  ON     3
     eH2_4                -4.916001e-03    1         1  ON     4
     eH2_5                 6.741883e-03    1         1  ON     5
     eH2_6                 3.590765e-02    1         1  ON     6
     eH2_7                 4.248805e-02    1         1  ON     7
     eH2_8                 2.843876e-02    1         1  ON     8
     eH2_9                 9.553017e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 140 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.665328e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 28 unique up determinants.
Found 28 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.9629e+00 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  4.0107225728e-02 -5.0659535091e-01 -4.8356690577e-01
    u -2.0203417087e-01 -1.2691590666e+00 -2.1169263951e+00
    u  2.9913287695e-01 -2.3710879234e-01  2.0101719070e+00
    u  4.8474243406e-02 -5.3051852953e-01  9.5378285444e-01
    u -5.5511775119e-01 -9.8683271286e-02  1.4043240644e+00
    u  6.9646297924e-01  2.5004217823e+00 -2.4744046405e+00
    d -1.1004432466e+00 -7.1118992563e-01 -1.4300801983e+00
    d -3.6824818327e-02  7.5687344105e-01 -1.6708867165e+00
    d -9.4375526199e-01  1.5348935511e-01  1.1974289766e+00
    d -8.9321447322e-02 -6.9596903295e-02  1.4810785623e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0239.savio3:267488] 127 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0239.savio3:267488] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.3123
    reference variance = 0.556263
====================================================
  Execution time = 4.6461e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6017e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5205e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560109080870
                                         uncertainty =       0.002911783785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560109080870
                                         uncertainty =       0.002911783785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529230236
  error estimate for blocks of size 2^( 2) =       0.000549813501
  error estimate for blocks of size 2^( 3) =       0.000568868950
  error estimate for blocks of size 2^( 4) =       0.000583517808
  error estimate for blocks of size 2^( 5) =       0.000593381501
  error estimate for blocks of size 2^( 6) =       0.000598001554
  error estimate for blocks of size 2^( 7) =       0.000603516042

      target function =                  N/A
              le_mean =     -22.437814187414
             les_mean =     504.015674514449
             stat err =       0.000594604226
             autocorr =       1.262311929008
              std dev =       0.748444577531
             le_variance =       0.560169285635


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.243781418741e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437814187414       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437815457860       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437815444768       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437814237167       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437813603594       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437815168074       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437814959562       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437815648186       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437815278903       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437814800016       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437815339735       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437815269975       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437815411846       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 7.574558e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437814187414       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437814694700       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437814822544       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437814473469       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437813977294       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437814338363       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437814445402       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437814601176       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437814571566       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437814538173       residual = 9.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 2.428811e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437814187414       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437814336492       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437814391106       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437814307542       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437814150550       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437814212313       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437814257571       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437814281035       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437814293412       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437814293019       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 6.749351e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134639 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1806e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
uu_0  2.737641e-01                 1 1 ON  0
uu_1  9.859103e-02                 1 1 ON  1
uu_2  -1.789609e-02                1 1 ON  2
uu_3  -8.826470e-02                1 1 ON  3
uu_4  -1.299426e-01                1 1 ON  4
uu_5  -1.550579e-01                1 1 ON  5
uu_6  -1.678103e-01                1 1 ON  6
uu_7  -1.686096e-01                1 1 ON  7
uu_8  -1.531064e-01                1 1 ON  8
uu_9  -1.129649e-01                1 1 ON  9
ud_0  4.658926e-01                 1 1 ON  10
ud_1  1.815225e-01                 1 1 ON  11
ud_2  3.090086e-02                 1 1 ON  12
ud_3  -5.381424e-02                1 1 ON  13
ud_4  -1.042060e-01                1 1 ON  14
ud_5  -1.374839e-01                1 1 ON  15
ud_6  -1.582995e-01                1 1 ON  16
ud_7  -1.659792e-01                1 1 ON  17
ud_8  -1.567854e-01                1 1 ON  18
ud_9  -1.265257e-01                1 1 ON  19
eC_0  -6.705924e-01                1 1 ON  20
eC_1  -4.978283e-01                1 1 ON  21
eC_2  -1.966607e-01                1 1 ON  22
eC_3  2.166964e-02                 1 1 ON  23
eC_4  1.636625e-01                 1 1 ON  24
eC_5  2.842747e-01                 1 1 ON  25
eC_6  3.002272e-01                 1 1 ON  26
eC_7  3.288820e-01                 1 1 ON  27
eC_8  2.210232e-01                 1 1 ON  28
eC_9  4.694744e-02                 1 1 ON  29
eO_0  -1.206815e+00                1 1 ON  30
eO_1  -8.143111e-01                1 1 ON  31
eO_2  -3.209884e-01                1 1 ON  32
eO_3  4.384507e-03                 1 1 ON  33
eO_4  2.287957e-01                 1 1 ON  34
eO_5  3.699636e-01                 1 1 ON  35
eO_6  4.055296e-01                 1 1 ON  36
eO_7  4.310980e-01                 1 1 ON  37
eO_8  4.436587e-01                 1 1 ON  38
eO_9  3.227766e-01                 1 1 ON  39
eH1_0 -1.653313e-01                1 1 ON  40
eH1_1 -6.465231e-02                1 1 ON  41
eH1_2 -4.347444e-02                1 1 ON  42
eH1_3 -4.080136e-02                1 1 ON  43
eH1_4 -2.044529e-03                1 1 ON  44
eH1_5 1.007534e-02                 1 1 ON  45
eH1_6 3.966632e-02                 1 1 ON  46
eH1_7 4.599773e-02                 1 1 ON  47
eH1_8 3.152923e-02                 1 1 ON  48
eH1_9 9.109870e-02                 1 1 ON  49
eH2_0 -1.673645e-01                1 1 ON  50
eH2_1 -6.692309e-02                1 1 ON  51
eH2_2 -4.593782e-02                1 1 ON  52
eH2_3 -4.343569e-02                1 1 ON  53
eH2_4 -4.931038e-03                1 1 ON  54
eH2_5 6.742054e-03                 1 1 ON  55
eH2_6 3.599707e-02                 1 1 ON  56
eH2_7 4.254453e-02                 1 1 ON  57
eH2_8 2.840283e-02                 1 1 ON  58
eH2_9 9.551390e-02                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.47
    reference variance = 0.315409
====================================================
  Execution time = 4.5372e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5973e-01
  Total weights = 2.0000e+06
  Execution time = 3.8848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559360414683
                                         uncertainty =       0.003680963502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559360414683
                                         uncertainty =       0.003680963502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528983650
  error estimate for blocks of size 2^( 2) =       0.000549532870
  error estimate for blocks of size 2^( 3) =       0.000568199492
  error estimate for blocks of size 2^( 4) =       0.000581857249
  error estimate for blocks of size 2^( 5) =       0.000590247507
  error estimate for blocks of size 2^( 6) =       0.000593451985
  error estimate for blocks of size 2^( 7) =       0.000596205614

      target function =                  N/A
              le_mean =     -22.436464177667
             les_mean =     503.954571919967
             stat err =       0.000590440589
             autocorr =       1.245856181570
              std dev =       0.748095852176
             le_variance =       0.559647404043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559623149728
                                         uncertainty =       0.003683621599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559623149728
                                         uncertainty =       0.003683621599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529107926
  error estimate for blocks of size 2^( 2) =       0.000549648934
  error estimate for blocks of size 2^( 3) =       0.000568305860
  error estimate for blocks of size 2^( 4) =       0.000581956552
  error estimate for blocks of size 2^( 5) =       0.000590346450
  error estimate for blocks of size 2^( 6) =       0.000593550984
  error estimate for blocks of size 2^( 7) =       0.000596312349

      target function =                  N/A
              le_mean =     -22.436464492411
             les_mean =     503.954849032971
             stat err =       0.000590541584
             autocorr =       1.245697047470
              std dev =       0.748271604231
             le_variance =       0.559910393698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559531235153
                                         uncertainty =       0.003683005571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559531235153
                                         uncertainty =       0.003683005571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529064502
  error estimate for blocks of size 2^( 2) =       0.000549607716
  error estimate for blocks of size 2^( 3) =       0.000568267621
  error estimate for blocks of size 2^( 4) =       0.000581921103
  error estimate for blocks of size 2^( 5) =       0.000590312627
  error estimate for blocks of size 2^( 6) =       0.000593518547
  error estimate for blocks of size 2^( 7) =       0.000596278509

      target function =                  N/A
              le_mean =     -22.436464336352
             les_mean =     503.954750130398
             stat err =       0.000590507696
             autocorr =       1.245758556857
              std dev =       0.748210193661
             le_variance =       0.559818493899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559384827587
                                         uncertainty =       0.003681281260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559384827587
                                         uncertainty =       0.003681281260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528995205
  error estimate for blocks of size 2^( 2) =       0.000549543502
  error estimate for blocks of size 2^( 3) =       0.000568209133
  error estimate for blocks of size 2^( 4) =       0.000581866291
  error estimate for blocks of size 2^( 5) =       0.000590256764
  error estimate for blocks of size 2^( 6) =       0.000593461507
  error estimate for blocks of size 2^( 7) =       0.000596216126

      target function =                  N/A
              le_mean =     -22.436464138507
             les_mean =     503.954594612599
             stat err =       0.000590450172
             autocorr =       1.245842195050
              std dev =       0.748112193418
             le_variance =       0.559671853940


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436464177667        initial
     2.5000e-01     2.5000e+00             7.5746e-04       -22.436464492411  <--
     1.0000e+00     1.0000e+01             2.4288e-04       -22.436464336352
     4.0000e+00     4.0000e+01             6.7494e-05       -22.436464138507

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.4837e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
 uu_0                 2.738817e-01 1 1  ON 0
 uu_1                 9.869422e-02 1 1  ON 1
 uu_2                -1.783876e-02 1 1  ON 2
 uu_3                -8.831714e-02 1 1  ON 3
 uu_4                -1.300027e-01 1 1  ON 4
 uu_5                -1.551562e-01 1 1  ON 5
 uu_6                -1.679327e-01 1 1  ON 6
 uu_7                -1.686492e-01 1 1  ON 7
 uu_8                -1.529667e-01 1 1  ON 8
 uu_9                -1.130087e-01 1 1  ON 9
 ud_0                 4.659746e-01 1 1  ON 10
 ud_1                 1.815804e-01 1 1  ON 11
 ud_2                 3.093188e-02 1 1  ON 12
 ud_3                -5.381303e-02 1 1  ON 13
 ud_4                -1.042290e-01 1 1  ON 14
 ud_5                -1.375104e-01 1 1  ON 15
 ud_6                -1.583196e-01 1 1  ON 16
 ud_7                -1.657910e-01 1 1  ON 17
 ud_8                -1.567183e-01 1 1  ON 18
 ud_9                -1.264937e-01 1 1  ON 19
 eC_0                -6.709222e-01 1 1  ON 20
 eC_1                -4.980221e-01 1 1  ON 21
 eC_2                -1.966806e-01 1 1  ON 22
 eC_3                 2.178526e-02 1 1  ON 23
 eC_4                 1.639395e-01 1 1  ON 24
 eC_5                 2.843960e-01 1 1  ON 25
 eC_6                 3.000504e-01 1 1  ON 26
 eC_7                 3.287297e-01 1 1  ON 27
 eC_8                 2.212754e-01 1 1  ON 28
 eC_9                 4.705195e-02 1 1  ON 29
 eO_0                -1.207276e+00 1 1  ON 30
 eO_1                -8.146250e-01 1 1  ON 31
 eO_2                -3.215029e-01 1 1  ON 32
 eO_3                 4.522943e-03 1 1  ON 33
 eO_4                 2.289822e-01 1 1  ON 34
 eO_5                 3.702139e-01 1 1  ON 35
 eO_6                 4.055028e-01 1 1  ON 36
 eO_7                 4.309889e-01 1 1  ON 37
 eO_8                 4.437805e-01 1 1  ON 38
 eO_9                 3.232327e-01 1 1  ON 39
eH1_0                -1.650248e-01 1 1  ON 40
eH1_1                -6.444842e-02 1 1  ON 41
eH1_2                -4.333684e-02 1 1  ON 42
eH1_3                -4.066984e-02 1 1  ON 43
eH1_4                -2.016524e-03 1 1  ON 44
eH1_5                 9.967219e-03 1 1  ON 45
eH1_6                 3.965578e-02 1 1  ON 46
eH1_7                 4.561460e-02 1 1  ON 47
eH1_8                 3.130491e-02 1 1  ON 48
eH1_9                 9.089469e-02 1 1  ON 49
eH2_0                -1.673296e-01 1 1  ON 50
eH2_1                -6.728327e-02 1 1  ON 51
eH2_2                -4.589972e-02 1 1  ON 52
eH2_3                -4.349617e-02 1 1  ON 53
eH2_4                -4.961101e-03 1 1  ON 54
eH2_5                 6.741618e-03 1 1  ON 55
eH2_6                 3.615594e-02 1 1  ON 56
eH2_7                 4.271653e-02 1 1  ON 57
eH2_8                 2.831519e-02 1 1  ON 58
eH2_9                 9.546626e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2680e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2391e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.3709
    reference variance = 0.358892
====================================================
  Execution time = 4.8440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6083e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5618e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560621801907
                                         uncertainty =       0.004249777474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560621801907
                                         uncertainty =       0.004249777474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529541493
  error estimate for blocks of size 2^( 2) =       0.000549933715
  error estimate for blocks of size 2^( 3) =       0.000568326882
  error estimate for blocks of size 2^( 4) =       0.000582358411
  error estimate for blocks of size 2^( 5) =       0.000591382176
  error estimate for blocks of size 2^( 6) =       0.000595123972
  error estimate for blocks of size 2^( 7) =       0.000595608345

      target function =                  N/A
              le_mean =     -22.438149595713
             les_mean =     504.031385385664
             stat err =       0.000591118226
             autocorr =       1.246087985187
              std dev =       0.748884761816
             le_variance =       0.560828386481


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243814959571e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438149595713       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438151141695       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438152335825       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438151244629       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438152877008       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438154317230       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438154838478       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438154323643       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438154415295       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438154327486       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.438153898193       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.438153728082       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.438154718870       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.438154688672       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.438155681315       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.438155784377       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.438156073327       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.438156027569       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 2.643311e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438149595713       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438150519597       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438151642725       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438151056280       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438151675657       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438152284292       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438152316023       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438152381406       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438152393115       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438151994305       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.438152255693       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.438152238912       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.438152296177       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 6.475888e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438149595713       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438149949748       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438150567138       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438150380630       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438150555524       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438150790379       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438150621117       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438150722132       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438150708578       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438150697449       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.438150699294       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 2.082778e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.4070e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.740018e-01 1 1  ON 0
 uu_1                 9.876626e-02 1 1  ON 1
 uu_2                -1.774056e-02 1 1  ON 2
 uu_3                -8.835964e-02 1 1  ON 3
 uu_4                -1.299400e-01 1 1  ON 4
 uu_5                -1.553670e-01 1 1  ON 5
 uu_6                -1.680054e-01 1 1  ON 6
 uu_7                -1.686846e-01 1 1  ON 7
 uu_8                -1.530687e-01 1 1  ON 8
 uu_9                -1.129565e-01 1 1  ON 9
 ud_0                 4.660263e-01 1 1  ON 10
 ud_1                 1.815166e-01 1 1  ON 11
 ud_2                 3.092644e-02 1 1  ON 12
 ud_3                -5.402759e-02 1 1  ON 13
 ud_4                -1.042108e-01 1 1  ON 14
 ud_5                -1.375888e-01 1 1  ON 15
 ud_6                -1.583783e-01 1 1  ON 16
 ud_7                -1.661172e-01 1 1  ON 17
 ud_8                -1.560707e-01 1 1  ON 18
 ud_9                -1.260817e-01 1 1  ON 19
 eC_0                -6.712694e-01 1 1  ON 20
 eC_1                -4.980990e-01 1 1  ON 21
 eC_2                -1.968352e-01 1 1  ON 22
 eC_3                 2.169496e-02 1 1  ON 23
 eC_4                 1.639573e-01 1 1  ON 24
 eC_5                 2.844738e-01 1 1  ON 25
 eC_6                 3.000695e-01 1 1  ON 26
 eC_7                 3.286618e-01 1 1  ON 27
 eC_8                 2.216793e-01 1 1  ON 28
 eC_9                 4.723694e-02 1 1  ON 29
 eO_0                -1.207704e+00 1 1  ON 30
 eO_1                -8.147171e-01 1 1  ON 31
 eO_2                -3.218464e-01 1 1  ON 32
 eO_3                 4.424657e-03 1 1  ON 33
 eO_4                 2.289467e-01 1 1  ON 34
 eO_5                 3.703021e-01 1 1  ON 35
 eO_6                 4.052123e-01 1 1  ON 36
 eO_7                 4.309250e-01 1 1  ON 37
 eO_8                 4.439968e-01 1 1  ON 38
 eO_9                 3.238593e-01 1 1  ON 39
eH1_0                -1.646371e-01 1 1  ON 40
eH1_1                -6.433051e-02 1 1  ON 41
eH1_2                -4.338664e-02 1 1  ON 42
eH1_3                -4.068452e-02 1 1  ON 43
eH1_4                -2.281553e-03 1 1  ON 44
eH1_5                 9.697224e-03 1 1  ON 45
eH1_6                 3.968810e-02 1 1  ON 46
eH1_7                 4.548613e-02 1 1  ON 47
eH1_8                 3.130121e-02 1 1  ON 48
eH1_9                 9.076700e-02 1 1  ON 49
eH2_0                -1.676476e-01 1 1  ON 50
eH2_1                -6.735685e-02 1 1  ON 51
eH2_2                -4.588447e-02 1 1  ON 52
eH2_3                -4.355154e-02 1 1  ON 53
eH2_4                -4.886987e-03 1 1  ON 54
eH2_5                 6.682326e-03 1 1  ON 55
eH2_6                 3.629886e-02 1 1  ON 56
eH2_7                 4.289287e-02 1 1  ON 57
eH2_8                 2.830560e-02 1 1  ON 58
eH2_9                 9.532527e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.5272
    reference variance = 0.599859
====================================================
  Execution time = 4.5531e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7472e-01
  Total weights = 2.0000e+06
  Execution time = 3.8833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574477888618
                                         uncertainty =       0.009443936586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574477888618
                                         uncertainty =       0.009443936586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535938394
  error estimate for blocks of size 2^( 2) =       0.000555608799
  error estimate for blocks of size 2^( 3) =       0.000573841935
  error estimate for blocks of size 2^( 4) =       0.000587817646
  error estimate for blocks of size 2^( 5) =       0.000596818515
  error estimate for blocks of size 2^( 6) =       0.000600822894
  error estimate for blocks of size 2^( 7) =       0.000603056073

      target function =                  N/A
              le_mean =     -22.436663252170
             les_mean =     503.978317528876
             stat err =       0.000597128782
             autocorr =       1.241384357428
              std dev =       0.757931345730
             le_variance =       0.574459924840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575051283950
                                         uncertainty =       0.009448663018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575051283950
                                         uncertainty =       0.009448663018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536205735
  error estimate for blocks of size 2^( 2) =       0.000555865055
  error estimate for blocks of size 2^( 3) =       0.000574084086
  error estimate for blocks of size 2^( 4) =       0.000588039097
  error estimate for blocks of size 2^( 5) =       0.000597028010
  error estimate for blocks of size 2^( 6) =       0.000601024196
  error estimate for blocks of size 2^( 7) =       0.000603250596

      target function =                  N/A
              le_mean =     -22.436660856959
             les_mean =     503.978783302213
             stat err =       0.000597335475
             autocorr =       1.241005499768
              std dev =       0.758309422024
             le_variance =       0.575033179530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575005780935
                                         uncertainty =       0.009443749533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575005780935
                                         uncertainty =       0.009443749533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536184484
  error estimate for blocks of size 2^( 2) =       0.000555843542
  error estimate for blocks of size 2^( 3) =       0.000574063109
  error estimate for blocks of size 2^( 4) =       0.000588020056
  error estimate for blocks of size 2^( 5) =       0.000597010541
  error estimate for blocks of size 2^( 6) =       0.000601011973
  error estimate for blocks of size 2^( 7) =       0.000603234192

      target function =                  N/A
              le_mean =     -22.436661341553
             les_mean =     503.978759470163
             stat err =       0.000597319190
             autocorr =       1.241036202889
              std dev =       0.758279369451
             le_variance =       0.574987602135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574568085382
                                         uncertainty =       0.009442275129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574568085382
                                         uncertainty =       0.009442275129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535980434
  error estimate for blocks of size 2^( 2) =       0.000555648517
  error estimate for blocks of size 2^( 3) =       0.000573879052
  error estimate for blocks of size 2^( 4) =       0.000587851228
  error estimate for blocks of size 2^( 5) =       0.000596850478
  error estimate for blocks of size 2^( 6) =       0.000600855263
  error estimate for blocks of size 2^( 7) =       0.000603084915

      target function =                  N/A
              le_mean =     -22.436662215909
             les_mean =     503.978361154514
             stat err =       0.000597160471
             autocorr =       1.241321369587
              std dev =       0.757990798757
             le_variance =       0.574550051000


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436663252170        initial  <--
     6.2500e-02     6.2500e-01             2.6433e-03       -22.436660856959
     2.5000e-01     2.5000e+00             6.4759e-04       -22.436661341553
     1.0000e+00     1.0000e+01             2.0828e-04       -22.436662215909

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.9680
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.738817e-01 1 1  ON 0
 uu_1                 9.869422e-02 1 1  ON 1
 uu_2                -1.783876e-02 1 1  ON 2
 uu_3                -8.831714e-02 1 1  ON 3
 uu_4                -1.300027e-01 1 1  ON 4
 uu_5                -1.551562e-01 1 1  ON 5
 uu_6                -1.679327e-01 1 1  ON 6
 uu_7                -1.686492e-01 1 1  ON 7
 uu_8                -1.529667e-01 1 1  ON 8
 uu_9                -1.130087e-01 1 1  ON 9
 ud_0                 4.659746e-01 1 1  ON 10
 ud_1                 1.815804e-01 1 1  ON 11
 ud_2                 3.093188e-02 1 1  ON 12
 ud_3                -5.381303e-02 1 1  ON 13
 ud_4                -1.042290e-01 1 1  ON 14
 ud_5                -1.375104e-01 1 1  ON 15
 ud_6                -1.583196e-01 1 1  ON 16
 ud_7                -1.657910e-01 1 1  ON 17
 ud_8                -1.567183e-01 1 1  ON 18
 ud_9                -1.264937e-01 1 1  ON 19
 eC_0                -6.709222e-01 1 1  ON 20
 eC_1                -4.980221e-01 1 1  ON 21
 eC_2                -1.966806e-01 1 1  ON 22
 eC_3                 2.178526e-02 1 1  ON 23
 eC_4                 1.639395e-01 1 1  ON 24
 eC_5                 2.843960e-01 1 1  ON 25
 eC_6                 3.000504e-01 1 1  ON 26
 eC_7                 3.287297e-01 1 1  ON 27
 eC_8                 2.212754e-01 1 1  ON 28
 eC_9                 4.705195e-02 1 1  ON 29
 eO_0                -1.207276e+00 1 1  ON 30
 eO_1                -8.146250e-01 1 1  ON 31
 eO_2                -3.215029e-01 1 1  ON 32
 eO_3                 4.522943e-03 1 1  ON 33
 eO_4                 2.289822e-01 1 1  ON 34
 eO_5                 3.702139e-01 1 1  ON 35
 eO_6                 4.055028e-01 1 1  ON 36
 eO_7                 4.309889e-01 1 1  ON 37
 eO_8                 4.437805e-01 1 1  ON 38
 eO_9                 3.232327e-01 1 1  ON 39
eH1_0                -1.650248e-01 1 1  ON 40
eH1_1                -6.444842e-02 1 1  ON 41
eH1_2                -4.333684e-02 1 1  ON 42
eH1_3                -4.066984e-02 1 1  ON 43
eH1_4                -2.016524e-03 1 1  ON 44
eH1_5                 9.967219e-03 1 1  ON 45
eH1_6                 3.965578e-02 1 1  ON 46
eH1_7                 4.561460e-02 1 1  ON 47
eH1_8                 3.130491e-02 1 1  ON 48
eH1_9                 9.089469e-02 1 1  ON 49
eH2_0                -1.673296e-01 1 1  ON 50
eH2_1                -6.728327e-02 1 1  ON 51
eH2_2                -4.589972e-02 1 1  ON 52
eH2_3                -4.349617e-02 1 1  ON 53
eH2_4                -4.961101e-03 1 1  ON 54
eH2_5                 6.741618e-03 1 1  ON 55
eH2_6                 3.615594e-02 1 1  ON 56
eH2_7                 4.271653e-02 1 1  ON 57
eH2_8                 2.831519e-02 1 1  ON 58
eH2_9                 9.546626e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2905e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2420e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.4422
    reference variance = 0.385796
====================================================
  Execution time = 4.8114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7422e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5254e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574162778943
                                         uncertainty =       0.010950417838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574162778943
                                         uncertainty =       0.010950417838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535827829
  error estimate for blocks of size 2^( 2) =       0.000555867331
  error estimate for blocks of size 2^( 3) =       0.000573915552
  error estimate for blocks of size 2^( 4) =       0.000587996360
  error estimate for blocks of size 2^( 5) =       0.000596561066
  error estimate for blocks of size 2^( 6) =       0.000600360830
  error estimate for blocks of size 2^( 7) =       0.000603602984

      target function =                  N/A
              le_mean =     -22.437492252250
             les_mean =     504.015281207217
             stat err =       0.000597130310
             autocorr =       1.241903073099
              std dev =       0.757774982795
             le_variance =       0.574222924551


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243749225225e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437492252250       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437494233221       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437496561105       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437496539329       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437496093869       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437496566642       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437496589797       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437496397701       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437496383080       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437496407205       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437496349638       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437496385971       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 2.334608e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437492252250       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437492837921       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437493622525       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437493700185       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437493482431       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437493533260       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437493633392       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437493590906       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437493548849       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437493570807       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437493568893       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 5.952141e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437492252250       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437492405671       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437492620115       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437492649032       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437492590471       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437492598027       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437492619482       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437492611164       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437492602425       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437492606833       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 1.648296e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146186 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3378e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.739411e-01 1 1  ON 0
 uu_1                 9.864690e-02 1 1  ON 1
 uu_2                -1.784327e-02 1 1  ON 2
 uu_3                -8.833089e-02 1 1  ON 3
 uu_4                -1.300089e-01 1 1  ON 4
 uu_5                -1.551971e-01 1 1  ON 5
 uu_6                -1.679531e-01 1 1  ON 6
 uu_7                -1.686404e-01 1 1  ON 7
 uu_8                -1.529804e-01 1 1  ON 8
 uu_9                -1.129566e-01 1 1  ON 9
 ud_0                 4.660088e-01 1 1  ON 10
 ud_1                 1.816184e-01 1 1  ON 11
 ud_2                 3.094560e-02 1 1  ON 12
 ud_3                -5.383396e-02 1 1  ON 13
 ud_4                -1.042067e-01 1 1  ON 14
 ud_5                -1.374590e-01 1 1  ON 15
 ud_6                -1.582849e-01 1 1  ON 16
 ud_7                -1.658329e-01 1 1  ON 17
 ud_8                -1.567773e-01 1 1  ON 18
 ud_9                -1.264972e-01 1 1  ON 19
 eC_0                -6.709645e-01 1 1  ON 20
 eC_1                -4.980625e-01 1 1  ON 21
 eC_2                -1.966682e-01 1 1  ON 22
 eC_3                 2.180425e-02 1 1  ON 23
 eC_4                 1.639484e-01 1 1  ON 24
 eC_5                 2.843794e-01 1 1  ON 25
 eC_6                 3.000431e-01 1 1  ON 26
 eC_7                 3.287245e-01 1 1  ON 27
 eC_8                 2.213225e-01 1 1  ON 28
 eC_9                 4.707508e-02 1 1  ON 29
 eO_0                -1.207325e+00 1 1  ON 30
 eO_1                -8.146795e-01 1 1  ON 31
 eO_2                -3.214921e-01 1 1  ON 32
 eO_3                 4.510696e-03 1 1  ON 33
 eO_4                 2.290230e-01 1 1  ON 34
 eO_5                 3.701838e-01 1 1  ON 35
 eO_6                 4.054875e-01 1 1  ON 36
 eO_7                 4.309842e-01 1 1  ON 37
 eO_8                 4.437924e-01 1 1  ON 38
 eO_9                 3.232922e-01 1 1  ON 39
eH1_0                -1.649864e-01 1 1  ON 40
eH1_1                -6.448195e-02 1 1  ON 41
eH1_2                -4.335307e-02 1 1  ON 42
eH1_3                -4.067867e-02 1 1  ON 43
eH1_4                -2.022292e-03 1 1  ON 44
eH1_5                 9.944816e-03 1 1  ON 45
eH1_6                 3.966428e-02 1 1  ON 46
eH1_7                 4.561010e-02 1 1  ON 47
eH1_8                 3.130256e-02 1 1  ON 48
eH1_9                 9.090196e-02 1 1  ON 49
eH2_0                -1.673021e-01 1 1  ON 50
eH2_1                -6.725372e-02 1 1  ON 51
eH2_2                -4.591964e-02 1 1  ON 52
eH2_3                -4.352137e-02 1 1  ON 53
eH2_4                -4.985583e-03 1 1  ON 54
eH2_5                 6.750408e-03 1 1  ON 55
eH2_6                 3.616899e-02 1 1  ON 56
eH2_7                 4.269587e-02 1 1  ON 57
eH2_8                 2.831441e-02 1 1  ON 58
eH2_9                 9.544996e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.4027
    reference variance = 0.437904
====================================================
  Execution time = 4.5445e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6793e-01
  Total weights = 2.0000e+06
  Execution time = 3.8749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567774376877
                                         uncertainty =       0.007238172640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567774376877
                                         uncertainty =       0.007238172640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532862762
  error estimate for blocks of size 2^( 2) =       0.000553350628
  error estimate for blocks of size 2^( 3) =       0.000571459235
  error estimate for blocks of size 2^( 4) =       0.000586078365
  error estimate for blocks of size 2^( 5) =       0.000596931746
  error estimate for blocks of size 2^( 6) =       0.000600961563
  error estimate for blocks of size 2^( 7) =       0.000600971827

      target function =                  N/A
              le_mean =     -22.437073819392
             les_mean =     503.990166739976
             stat err =       0.000596235875
             autocorr =       1.252003272062
              std dev =       0.753581745449
             le_variance =       0.567885447073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567946389083
                                         uncertainty =       0.007242519020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567946389083
                                         uncertainty =       0.007242519020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532943432
  error estimate for blocks of size 2^( 2) =       0.000553426886
  error estimate for blocks of size 2^( 3) =       0.000571528829
  error estimate for blocks of size 2^( 4) =       0.000586144347
  error estimate for blocks of size 2^( 5) =       0.000596992566
  error estimate for blocks of size 2^( 6) =       0.000601024340
  error estimate for blocks of size 2^( 7) =       0.000601030525

      target function =                  N/A
              le_mean =     -22.437073871789
             les_mean =     503.990341048361
             stat err =       0.000596297944
             autocorr =       1.251884883209
              std dev =       0.753695830066
             le_variance =       0.568057404259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567865851238
                                         uncertainty =       0.007239978831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567865851238
                                         uncertainty =       0.007239978831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532905665
  error estimate for blocks of size 2^( 2) =       0.000553391317
  error estimate for blocks of size 2^( 3) =       0.000571496110
  error estimate for blocks of size 2^( 4) =       0.000586113375
  error estimate for blocks of size 2^( 5) =       0.000596963348
  error estimate for blocks of size 2^( 6) =       0.000600994710
  error estimate for blocks of size 2^( 7) =       0.000601002348

      target function =                  N/A
              le_mean =     -22.437073895263
             les_mean =     503.990261593464
             stat err =       0.000596268445
             autocorr =       1.251938455127
              std dev =       0.753642419172
             le_variance =       0.567976895975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567785751064
                                         uncertainty =       0.007238383854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567785751064
                                         uncertainty =       0.007238383854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532868097
  error estimate for blocks of size 2^( 2) =       0.000553355683
  error estimate for blocks of size 2^( 3) =       0.000571463786
  error estimate for blocks of size 2^( 4) =       0.000586082686
  error estimate for blocks of size 2^( 5) =       0.000596935595
  error estimate for blocks of size 2^( 6) =       0.000600965645
  error estimate for blocks of size 2^( 7) =       0.000600975562

      target function =                  N/A
              le_mean =     -22.437073808765
             les_mean =     503.990177634481
             stat err =       0.000596239872
             autocorr =       1.251994987060
              std dev =       0.753589290291
             le_variance =       0.567896818441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437073819392        initial
     6.2500e-01     6.2500e+00             2.3346e-04       -22.437073871789
     2.5000e+00     2.5000e+01             5.9521e-05       -22.437073895263  <--
     1.0000e+01     1.0000e+02             1.6483e-05       -22.437073808765

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 6.4847e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.739411e-01 1 1  ON 0
 uu_1                 9.864690e-02 1 1  ON 1
 uu_2                -1.784327e-02 1 1  ON 2
 uu_3                -8.833089e-02 1 1  ON 3
 uu_4                -1.300089e-01 1 1  ON 4
 uu_5                -1.551971e-01 1 1  ON 5
 uu_6                -1.679531e-01 1 1  ON 6
 uu_7                -1.686404e-01 1 1  ON 7
 uu_8                -1.529804e-01 1 1  ON 8
 uu_9                -1.129566e-01 1 1  ON 9
 ud_0                 4.660088e-01 1 1  ON 10
 ud_1                 1.816184e-01 1 1  ON 11
 ud_2                 3.094560e-02 1 1  ON 12
 ud_3                -5.383396e-02 1 1  ON 13
 ud_4                -1.042067e-01 1 1  ON 14
 ud_5                -1.374590e-01 1 1  ON 15
 ud_6                -1.582849e-01 1 1  ON 16
 ud_7                -1.658329e-01 1 1  ON 17
 ud_8                -1.567773e-01 1 1  ON 18
 ud_9                -1.264972e-01 1 1  ON 19
 eC_0                -6.709645e-01 1 1  ON 20
 eC_1                -4.980625e-01 1 1  ON 21
 eC_2                -1.966682e-01 1 1  ON 22
 eC_3                 2.180425e-02 1 1  ON 23
 eC_4                 1.639484e-01 1 1  ON 24
 eC_5                 2.843794e-01 1 1  ON 25
 eC_6                 3.000431e-01 1 1  ON 26
 eC_7                 3.287245e-01 1 1  ON 27
 eC_8                 2.213225e-01 1 1  ON 28
 eC_9                 4.707508e-02 1 1  ON 29
 eO_0                -1.207325e+00 1 1  ON 30
 eO_1                -8.146795e-01 1 1  ON 31
 eO_2                -3.214921e-01 1 1  ON 32
 eO_3                 4.510696e-03 1 1  ON 33
 eO_4                 2.290230e-01 1 1  ON 34
 eO_5                 3.701838e-01 1 1  ON 35
 eO_6                 4.054875e-01 1 1  ON 36
 eO_7                 4.309842e-01 1 1  ON 37
 eO_8                 4.437924e-01 1 1  ON 38
 eO_9                 3.232922e-01 1 1  ON 39
eH1_0                -1.649864e-01 1 1  ON 40
eH1_1                -6.448195e-02 1 1  ON 41
eH1_2                -4.335307e-02 1 1  ON 42
eH1_3                -4.067867e-02 1 1  ON 43
eH1_4                -2.022292e-03 1 1  ON 44
eH1_5                 9.944816e-03 1 1  ON 45
eH1_6                 3.966428e-02 1 1  ON 46
eH1_7                 4.561010e-02 1 1  ON 47
eH1_8                 3.130256e-02 1 1  ON 48
eH1_9                 9.090196e-02 1 1  ON 49
eH2_0                -1.673021e-01 1 1  ON 50
eH2_1                -6.725372e-02 1 1  ON 51
eH2_2                -4.591964e-02 1 1  ON 52
eH2_3                -4.352137e-02 1 1  ON 53
eH2_4                -4.985583e-03 1 1  ON 54
eH2_5                 6.750408e-03 1 1  ON 55
eH2_6                 3.616899e-02 1 1  ON 56
eH2_7                 4.269587e-02 1 1  ON 57
eH2_8                 2.831441e-02 1 1  ON 58
eH2_9                 9.544996e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2824e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2421e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.3837
    reference variance = 0.343876
====================================================
  Execution time = 4.6137e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6651e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5619e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566438201688
                                         uncertainty =       0.007750010664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566438201688
                                         uncertainty =       0.007750010664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532217791
  error estimate for blocks of size 2^( 2) =       0.000552540890
  error estimate for blocks of size 2^( 3) =       0.000571575866
  error estimate for blocks of size 2^( 4) =       0.000585400995
  error estimate for blocks of size 2^( 5) =       0.000594146597
  error estimate for blocks of size 2^( 6) =       0.000597355111
  error estimate for blocks of size 2^( 7) =       0.000600950216

      target function =                  N/A
              le_mean =     -22.437129819143
             les_mean =     503.991305791941
             stat err =       0.000594463230
             autocorr =       1.247588081314
              std dev =       0.752669618184
             le_variance =       0.566511554138


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243712981914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437129819143       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437130746159       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437131231928       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437131629191       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437131273491       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437130593865       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437130893849       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437130793182       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437130841814       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437130837262       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437131013520       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437131117786       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 2.816371e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437129819143       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437130097497       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437130234817       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437130364470       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437130240522       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437130031387       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437130085641       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437130075169       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437130105889       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437130091975       residual = 8.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 6.827336e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437129819143       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437129892414       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437129928135       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437129963277       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437129928306       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437129873249       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437129884009       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437129882887       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437129891852       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 1.683891e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150045 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1764e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.739055e-01 1 1  ON 0
 uu_1                 9.862572e-02 1 1  ON 1
 uu_2                -1.785202e-02 1 1  ON 2
 uu_3                -8.835136e-02 1 1  ON 3
 uu_4                -1.300130e-01 1 1  ON 4
 uu_5                -1.551874e-01 1 1  ON 5
 uu_6                -1.679762e-01 1 1  ON 6
 uu_7                -1.686254e-01 1 1  ON 7
 uu_8                -1.529505e-01 1 1  ON 8
 uu_9                -1.129220e-01 1 1  ON 9
 ud_0                 4.660369e-01 1 1  ON 10
 ud_1                 1.816489e-01 1 1  ON 11
 ud_2                 3.095722e-02 1 1  ON 12
 ud_3                -5.384234e-02 1 1  ON 13
 ud_4                -1.042212e-01 1 1  ON 14
 ud_5                -1.374924e-01 1 1  ON 15
 ud_6                -1.582642e-01 1 1  ON 16
 ud_7                -1.658657e-01 1 1  ON 17
 ud_8                -1.567948e-01 1 1  ON 18
 ud_9                -1.264546e-01 1 1  ON 19
 eC_0                -6.710314e-01 1 1  ON 20
 eC_1                -4.980956e-01 1 1  ON 21
 eC_2                -1.966701e-01 1 1  ON 22
 eC_3                 2.181642e-02 1 1  ON 23
 eC_4                 1.639372e-01 1 1  ON 24
 eC_5                 2.843744e-01 1 1  ON 25
 eC_6                 3.000650e-01 1 1  ON 26
 eC_7                 3.287378e-01 1 1  ON 27
 eC_8                 2.213711e-01 1 1  ON 28
 eC_9                 4.709400e-02 1 1  ON 29
 eO_0                -1.207390e+00 1 1  ON 30
 eO_1                -8.147173e-01 1 1  ON 31
 eO_2                -3.214686e-01 1 1  ON 32
 eO_3                 4.512486e-03 1 1  ON 33
 eO_4                 2.290373e-01 1 1  ON 34
 eO_5                 3.701463e-01 1 1  ON 35
 eO_6                 4.054529e-01 1 1  ON 36
 eO_7                 4.309947e-01 1 1  ON 37
 eO_8                 4.438087e-01 1 1  ON 38
 eO_9                 3.233605e-01 1 1  ON 39
eH1_0                -1.649770e-01 1 1  ON 40
eH1_1                -6.448424e-02 1 1  ON 41
eH1_2                -4.340931e-02 1 1  ON 42
eH1_3                -4.063585e-02 1 1  ON 43
eH1_4                -2.042661e-03 1 1  ON 44
eH1_5                 9.948311e-03 1 1  ON 45
eH1_6                 3.964473e-02 1 1  ON 46
eH1_7                 4.562199e-02 1 1  ON 47
eH1_8                 3.131251e-02 1 1  ON 48
eH1_9                 9.089928e-02 1 1  ON 49
eH2_0                -1.673332e-01 1 1  ON 50
eH2_1                -6.730024e-02 1 1  ON 51
eH2_2                -4.591793e-02 1 1  ON 52
eH2_3                -4.356082e-02 1 1  ON 53
eH2_4                -4.986040e-03 1 1  ON 54
eH2_5                 6.778993e-03 1 1  ON 55
eH2_6                 3.620990e-02 1 1  ON 56
eH2_7                 4.269101e-02 1 1  ON 57
eH2_8                 2.832080e-02 1 1  ON 58
eH2_9                 9.545959e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.4192
    reference variance = 0.382401
====================================================
  Execution time = 4.7598e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7517e-01
  Total weights = 2.0000e+06
  Execution time = 3.8861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575080263010
                                         uncertainty =       0.013602114255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575080263010
                                         uncertainty =       0.013602114255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536258198
  error estimate for blocks of size 2^( 2) =       0.000556147836
  error estimate for blocks of size 2^( 3) =       0.000574557129
  error estimate for blocks of size 2^( 4) =       0.000588799400
  error estimate for blocks of size 2^( 5) =       0.000599562848
  error estimate for blocks of size 2^( 6) =       0.000606883858
  error estimate for blocks of size 2^( 7) =       0.000611313463

      target function =                  N/A
              le_mean =     -22.437916586543
             les_mean =     504.035246165975
             stat err =       0.000601639892
             autocorr =       1.258709069727
              std dev =       0.758383615900
             le_variance =       0.575145708866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575197903098
                                         uncertainty =       0.013605999697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575197903098
                                         uncertainty =       0.013605999697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536313040
  error estimate for blocks of size 2^( 2) =       0.000556201294
  error estimate for blocks of size 2^( 3) =       0.000574607060
  error estimate for blocks of size 2^( 4) =       0.000588845555
  error estimate for blocks of size 2^( 5) =       0.000599606285
  error estimate for blocks of size 2^( 6) =       0.000606925095
  error estimate for blocks of size 2^( 7) =       0.000611347459

      target function =                  N/A
              le_mean =     -22.437916444123
             les_mean =     504.035357419588
             stat err =       0.000601681099
             autocorr =       1.258624044285
              std dev =       0.758461174873
             le_variance =       0.575263353789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575133805491
                                         uncertainty =       0.013603724664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575133805491
                                         uncertainty =       0.013603724664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536283161
  error estimate for blocks of size 2^( 2) =       0.000556172402
  error estimate for blocks of size 2^( 3) =       0.000574579837
  error estimate for blocks of size 2^( 4) =       0.000588820074
  error estimate for blocks of size 2^( 5) =       0.000599581981
  error estimate for blocks of size 2^( 6) =       0.000606901999
  error estimate for blocks of size 2^( 7) =       0.000611326476

      target function =                  N/A
              le_mean =     -22.437916327769
             les_mean =     504.035288101973
             stat err =       0.000601657633
             autocorr =       1.258666112678
              std dev =       0.758418919610
             le_variance =       0.575199257622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575086811902
                                         uncertainty =       0.013602293279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575086811902
                                         uncertainty =       0.013602293279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536261251
  error estimate for blocks of size 2^( 2) =       0.000556150839
  error estimate for blocks of size 2^( 3) =       0.000574559882
  error estimate for blocks of size 2^( 4) =       0.000588801878
  error estimate for blocks of size 2^( 5) =       0.000599565106
  error estimate for blocks of size 2^( 6) =       0.000606885993
  error estimate for blocks of size 2^( 7) =       0.000611314886

      target function =                  N/A
              le_mean =     -22.437916537594
             les_mean =     504.035250519263
             stat err =       0.000601641966
             autocorr =       1.258703410778
              std dev =       0.758387934232
             le_variance =       0.575152258789


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437916586543        initial  <--
     6.2500e-01     6.2500e+00             2.8164e-04       -22.437916444123
     2.5000e+00     2.5000e+01             6.8273e-05       -22.437916327769
     1.0000e+01     1.0000e+02             1.6839e-05       -22.437916537594

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.1109
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.739411e-01 1 1  ON 0
 uu_1                 9.864690e-02 1 1  ON 1
 uu_2                -1.784327e-02 1 1  ON 2
 uu_3                -8.833089e-02 1 1  ON 3
 uu_4                -1.300089e-01 1 1  ON 4
 uu_5                -1.551971e-01 1 1  ON 5
 uu_6                -1.679531e-01 1 1  ON 6
 uu_7                -1.686404e-01 1 1  ON 7
 uu_8                -1.529804e-01 1 1  ON 8
 uu_9                -1.129566e-01 1 1  ON 9
 ud_0                 4.660088e-01 1 1  ON 10
 ud_1                 1.816184e-01 1 1  ON 11
 ud_2                 3.094560e-02 1 1  ON 12
 ud_3                -5.383396e-02 1 1  ON 13
 ud_4                -1.042067e-01 1 1  ON 14
 ud_5                -1.374590e-01 1 1  ON 15
 ud_6                -1.582849e-01 1 1  ON 16
 ud_7                -1.658329e-01 1 1  ON 17
 ud_8                -1.567773e-01 1 1  ON 18
 ud_9                -1.264972e-01 1 1  ON 19
 eC_0                -6.709645e-01 1 1  ON 20
 eC_1                -4.980625e-01 1 1  ON 21
 eC_2                -1.966682e-01 1 1  ON 22
 eC_3                 2.180425e-02 1 1  ON 23
 eC_4                 1.639484e-01 1 1  ON 24
 eC_5                 2.843794e-01 1 1  ON 25
 eC_6                 3.000431e-01 1 1  ON 26
 eC_7                 3.287245e-01 1 1  ON 27
 eC_8                 2.213225e-01 1 1  ON 28
 eC_9                 4.707508e-02 1 1  ON 29
 eO_0                -1.207325e+00 1 1  ON 30
 eO_1                -8.146795e-01 1 1  ON 31
 eO_2                -3.214921e-01 1 1  ON 32
 eO_3                 4.510696e-03 1 1  ON 33
 eO_4                 2.290230e-01 1 1  ON 34
 eO_5                 3.701838e-01 1 1  ON 35
 eO_6                 4.054875e-01 1 1  ON 36
 eO_7                 4.309842e-01 1 1  ON 37
 eO_8                 4.437924e-01 1 1  ON 38
 eO_9                 3.232922e-01 1 1  ON 39
eH1_0                -1.649864e-01 1 1  ON 40
eH1_1                -6.448195e-02 1 1  ON 41
eH1_2                -4.335307e-02 1 1  ON 42
eH1_3                -4.067867e-02 1 1  ON 43
eH1_4                -2.022292e-03 1 1  ON 44
eH1_5                 9.944816e-03 1 1  ON 45
eH1_6                 3.966428e-02 1 1  ON 46
eH1_7                 4.561010e-02 1 1  ON 47
eH1_8                 3.130256e-02 1 1  ON 48
eH1_9                 9.090196e-02 1 1  ON 49
eH2_0                -1.673021e-01 1 1  ON 50
eH2_1                -6.725372e-02 1 1  ON 51
eH2_2                -4.591964e-02 1 1  ON 52
eH2_3                -4.352137e-02 1 1  ON 53
eH2_4                -4.985583e-03 1 1  ON 54
eH2_5                 6.750408e-03 1 1  ON 55
eH2_6                 3.616899e-02 1 1  ON 56
eH2_7                 4.269587e-02 1 1  ON 57
eH2_8                 2.831441e-02 1 1  ON 58
eH2_9                 9.544996e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2889e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2416e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.4581
    reference variance = 0.422512
====================================================
  Execution time = 4.7348e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 6.1624e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5501e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.616118460003
                                         uncertainty =       0.050829930748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.616118460003
                                         uncertainty =       0.050829930748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000555084326
  error estimate for blocks of size 2^( 2) =       0.000574070398
  error estimate for blocks of size 2^( 3) =       0.000591803458
  error estimate for blocks of size 2^( 4) =       0.000605357091
  error estimate for blocks of size 2^( 5) =       0.000613348226
  error estimate for blocks of size 2^( 6) =       0.000617549503
  error estimate for blocks of size 2^( 7) =       0.000618995473

      target function =                  N/A
              le_mean =     -22.437535870326
             les_mean =     504.059252841980
             stat err =       0.000613812573
             autocorr =       1.222794936743
              std dev =       0.785007782072
             le_variance =       0.616237217913


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243753587033e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437535870326       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437536042762       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437536102937       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437536080432       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437535963969       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437535931344       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437535955763       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437535944524       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437535930365       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437535936941       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 2.748042e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437535870326       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437535914444       residual = 9.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437535930742       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437535925763       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437535895655       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437535885562       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437535891443       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437535888528       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437535884855       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437535886492       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 7.011031e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437535870326       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437535881421       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437535885579       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437535884379       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437535876789       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437535874135       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437535875585       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437535874849       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437535873923       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437535874331       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+02 is 1.761785e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153582 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2857e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.739465e-01 1 1  ON 0
 uu_1                 9.864370e-02 1 1  ON 1
 uu_2                -1.784308e-02 1 1  ON 2
 uu_3                -8.833431e-02 1 1  ON 3
 uu_4                -1.300099e-01 1 1  ON 4
 uu_5                -1.551929e-01 1 1  ON 5
 uu_6                -1.679596e-01 1 1  ON 6
 uu_7                -1.686405e-01 1 1  ON 7
 uu_8                -1.529810e-01 1 1  ON 8
 uu_9                -1.129546e-01 1 1  ON 9
 ud_0                 4.660134e-01 1 1  ON 10
 ud_1                 1.816182e-01 1 1  ON 11
 ud_2                 3.094489e-02 1 1  ON 12
 ud_3                -5.383513e-02 1 1  ON 13
 ud_4                -1.042055e-01 1 1  ON 14
 ud_5                -1.374644e-01 1 1  ON 15
 ud_6                -1.582833e-01 1 1  ON 16
 ud_7                -1.658326e-01 1 1  ON 17
 ud_8                -1.567755e-01 1 1  ON 18
 ud_9                -1.264956e-01 1 1  ON 19
 eC_0                -6.709686e-01 1 1  ON 20
 eC_1                -4.980690e-01 1 1  ON 21
 eC_2                -1.966650e-01 1 1  ON 22
 eC_3                 2.180842e-02 1 1  ON 23
 eC_4                 1.639469e-01 1 1  ON 24
 eC_5                 2.843788e-01 1 1  ON 25
 eC_6                 3.000414e-01 1 1  ON 26
 eC_7                 3.287241e-01 1 1  ON 27
 eC_8                 2.213269e-01 1 1  ON 28
 eC_9                 4.707769e-02 1 1  ON 29
 eO_0                -1.207321e+00 1 1  ON 30
 eO_1                -8.146851e-01 1 1  ON 31
 eO_2                -3.214966e-01 1 1  ON 32
 eO_3                 4.509368e-03 1 1  ON 33
 eO_4                 2.290191e-01 1 1  ON 34
 eO_5                 3.701824e-01 1 1  ON 35
 eO_6                 4.054881e-01 1 1  ON 36
 eO_7                 4.309858e-01 1 1  ON 37
 eO_8                 4.437940e-01 1 1  ON 38
 eO_9                 3.232978e-01 1 1  ON 39
eH1_0                -1.649872e-01 1 1  ON 40
eH1_1                -6.447871e-02 1 1  ON 41
eH1_2                -4.335305e-02 1 1  ON 42
eH1_3                -4.067512e-02 1 1  ON 43
eH1_4                -2.029303e-03 1 1  ON 44
eH1_5                 9.943909e-03 1 1  ON 45
eH1_6                 3.966399e-02 1 1  ON 46
eH1_7                 4.560871e-02 1 1  ON 47
eH1_8                 3.130207e-02 1 1  ON 48
eH1_9                 9.090217e-02 1 1  ON 49
eH2_0                -1.673079e-01 1 1  ON 50
eH2_1                -6.725145e-02 1 1  ON 51
eH2_2                -4.591842e-02 1 1  ON 52
eH2_3                -4.351999e-02 1 1  ON 53
eH2_4                -4.984641e-03 1 1  ON 54
eH2_5                 6.747239e-03 1 1  ON 55
eH2_6                 3.617074e-02 1 1  ON 56
eH2_7                 4.269543e-02 1 1  ON 57
eH2_8                 2.831441e-02 1 1  ON 58
eH2_9                 9.544889e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.4642
    reference variance = 0.485324
====================================================
  Execution time = 4.7206e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6145e-01
  Total weights = 2.0000e+06
  Execution time = 3.8828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561394350218
                                         uncertainty =       0.004327753567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561394350218
                                         uncertainty =       0.004327753567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529831920
  error estimate for blocks of size 2^( 2) =       0.000550337759
  error estimate for blocks of size 2^( 3) =       0.000569762681
  error estimate for blocks of size 2^( 4) =       0.000584737195
  error estimate for blocks of size 2^( 5) =       0.000593302604
  error estimate for blocks of size 2^( 6) =       0.000598028635
  error estimate for blocks of size 2^( 7) =       0.000601659989

      target function =                  N/A
              le_mean =     -22.437936651669
             les_mean =     504.022444630648
             stat err =       0.000594432106
             autocorr =       1.258717521261
              std dev =       0.749295487142
             le_variance =       0.561443727051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561417322200
                                         uncertainty =       0.004328037968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561417322200
                                         uncertainty =       0.004328037968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529842756
  error estimate for blocks of size 2^( 2) =       0.000550347821
  error estimate for blocks of size 2^( 3) =       0.000569772524
  error estimate for blocks of size 2^( 4) =       0.000584746440
  error estimate for blocks of size 2^( 5) =       0.000593311567
  error estimate for blocks of size 2^( 6) =       0.000598037179
  error estimate for blocks of size 2^( 7) =       0.000601668729

      target function =                  N/A
              le_mean =     -22.437936835996
             les_mean =     504.022475867346
             stat err =       0.000594440979
             autocorr =       1.258703614242
              std dev =       0.749310811291
             le_variance =       0.561466691917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561406502494
                                         uncertainty =       0.004327903352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561406502494
                                         uncertainty =       0.004327903352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529837652
  error estimate for blocks of size 2^( 2) =       0.000550343080
  error estimate for blocks of size 2^( 3) =       0.000569767881
  error estimate for blocks of size 2^( 4) =       0.000584742079
  error estimate for blocks of size 2^( 5) =       0.000593307337
  error estimate for blocks of size 2^( 6) =       0.000598033152
  error estimate for blocks of size 2^( 7) =       0.000601664614

      target function =                  N/A
              le_mean =     -22.437936744409
             les_mean =     504.022460941021
             stat err =       0.000594436795
             autocorr =       1.258710146551
              std dev =       0.749303593770
             le_variance =       0.561455875636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561395889671
                                         uncertainty =       0.004327772537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561395889671
                                         uncertainty =       0.004327772537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529832646
  error estimate for blocks of size 2^( 2) =       0.000550338433
  error estimate for blocks of size 2^( 3) =       0.000569763339
  error estimate for blocks of size 2^( 4) =       0.000584737813
  error estimate for blocks of size 2^( 5) =       0.000593303203
  error estimate for blocks of size 2^( 6) =       0.000598029206
  error estimate for blocks of size 2^( 7) =       0.000601660575

      target function =                  N/A
              le_mean =     -22.437936663099
             les_mean =     504.022446682539
             stat err =       0.000594432699
             autocorr =       1.258716585567
              std dev =       0.749296514097
             le_variance =       0.561445266039


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437936651669        initial
     6.2500e+00     6.2500e+01             2.7480e-05       -22.437936835996  <--
     2.5000e+01     2.5000e+02             7.0110e-06       -22.437936744409
     1.0000e+02     1.0000e+03             1.7618e-06       -22.437936663099

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 6.6605e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.739617e-01 1 1  ON 0
 uu_1                 9.863460e-02 1 1  ON 1
 uu_2                -1.784285e-02 1 1  ON 2
 uu_3                -8.834399e-02 1 1  ON 3
 uu_4                -1.300124e-01 1 1  ON 4
 uu_5                -1.551814e-01 1 1  ON 5
 uu_6                -1.679777e-01 1 1  ON 6
 uu_7                -1.686412e-01 1 1  ON 7
 uu_8                -1.529827e-01 1 1  ON 8
 uu_9                -1.129485e-01 1 1  ON 9
 ud_0                 4.660262e-01 1 1  ON 10
 ud_1                 1.816177e-01 1 1  ON 11
 ud_2                 3.094290e-02 1 1  ON 12
 ud_3                -5.383831e-02 1 1  ON 13
 ud_4                -1.042023e-01 1 1  ON 14
 ud_5                -1.374794e-01 1 1  ON 15
 ud_6                -1.582794e-01 1 1  ON 16
 ud_7                -1.658317e-01 1 1  ON 17
 ud_8                -1.567700e-01 1 1  ON 18
 ud_9                -1.264907e-01 1 1  ON 19
 eC_0                -6.709806e-01 1 1  ON 20
 eC_1                -4.980878e-01 1 1  ON 21
 eC_2                -1.966556e-01 1 1  ON 22
 eC_3                 2.182074e-02 1 1  ON 23
 eC_4                 1.639425e-01 1 1  ON 24
 eC_5                 2.843770e-01 1 1  ON 25
 eC_6                 3.000363e-01 1 1  ON 26
 eC_7                 3.287230e-01 1 1  ON 27
 eC_8                 2.213400e-01 1 1  ON 28
 eC_9                 4.708543e-02 1 1  ON 29
 eO_0                -1.207311e+00 1 1  ON 30
 eO_1                -8.147013e-01 1 1  ON 31
 eO_2                -3.215100e-01 1 1  ON 32
 eO_3                 4.505233e-03 1 1  ON 33
 eO_4                 2.290079e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054897e-01 1 1  ON 36
 eO_7                 4.309905e-01 1 1  ON 37
 eO_8                 4.437987e-01 1 1  ON 38
 eO_9                 3.233143e-01 1 1  ON 39
eH1_0                -1.649892e-01 1 1  ON 40
eH1_1                -6.446905e-02 1 1  ON 41
eH1_2                -4.335292e-02 1 1  ON 42
eH1_3                -4.066486e-02 1 1  ON 43
eH1_4                -2.049773e-03 1 1  ON 44
eH1_5                 9.940986e-03 1 1  ON 45
eH1_6                 3.966312e-02 1 1  ON 46
eH1_7                 4.560452e-02 1 1  ON 47
eH1_8                 3.130064e-02 1 1  ON 48
eH1_9                 9.090279e-02 1 1  ON 49
eH2_0                -1.673249e-01 1 1  ON 50
eH2_1                -6.724475e-02 1 1  ON 51
eH2_2                -4.591488e-02 1 1  ON 52
eH2_3                -4.351567e-02 1 1  ON 53
eH2_4                -4.982317e-03 1 1  ON 54
eH2_5                 6.738168e-03 1 1  ON 55
eH2_6                 3.617586e-02 1 1  ON 56
eH2_7                 4.269407e-02 1 1  ON 57
eH2_8                 2.831442e-02 1 1  ON 58
eH2_9                 9.544573e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2975e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2425e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.4267
    reference variance = 0.353388
====================================================
  Execution time = 4.7086e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6010e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5445e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560055997981
                                         uncertainty =       0.002947922512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560055997981
                                         uncertainty =       0.002947922512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529198966
  error estimate for blocks of size 2^( 2) =       0.000549130748
  error estimate for blocks of size 2^( 3) =       0.000567321601
  error estimate for blocks of size 2^( 4) =       0.000580866755
  error estimate for blocks of size 2^( 5) =       0.000587942764
  error estimate for blocks of size 2^( 6) =       0.000594837230
  error estimate for blocks of size 2^( 7) =       0.000597095166

      target function =                  N/A
              le_mean =     -22.436976593239
             les_mean =     503.978021456917
             stat err =       0.000590185479
             autocorr =       1.243767101220
              std dev =       0.748400355048
             le_variance =       0.560103091435


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243697659324e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436976593239       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436976270822       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436975910810       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436975332651       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436975404329       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436975719701       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436975754951       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436975565326       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436975605043       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436975630648       residual = 9.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 1.133013e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436976593239       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436976505011       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436976402092       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436976224137       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436976224963       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436976320912       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436976331351       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436976292023       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436976299451       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436976303627       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 3.122757e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436976593239       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436976570648       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436976543962       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436976496871       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436976495589       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436976520628       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436976523244       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436976514193       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436976516091       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436976516958       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 8.023025e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157194 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2539e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.739756e-01 1 1  ON 0
 uu_1                 9.863979e-02 1 1  ON 1
 uu_2                -1.785327e-02 1 1  ON 2
 uu_3                -8.833382e-02 1 1  ON 3
 uu_4                -1.300199e-01 1 1  ON 4
 uu_5                -1.551919e-01 1 1  ON 5
 uu_6                -1.680054e-01 1 1  ON 6
 uu_7                -1.686516e-01 1 1  ON 7
 uu_8                -1.529733e-01 1 1  ON 8
 uu_9                -1.129341e-01 1 1  ON 9
 ud_0                 4.660339e-01 1 1  ON 10
 ud_1                 1.816127e-01 1 1  ON 11
 ud_2                 3.094069e-02 1 1  ON 12
 ud_3                -5.384771e-02 1 1  ON 13
 ud_4                -1.041964e-01 1 1  ON 14
 ud_5                -1.374803e-01 1 1  ON 15
 ud_6                -1.582591e-01 1 1  ON 16
 ud_7                -1.658593e-01 1 1  ON 17
 ud_8                -1.567515e-01 1 1  ON 18
 ud_9                -1.264737e-01 1 1  ON 19
 eC_0                -6.710013e-01 1 1  ON 20
 eC_1                -4.981071e-01 1 1  ON 21
 eC_2                -1.966544e-01 1 1  ON 22
 eC_3                 2.183932e-02 1 1  ON 23
 eC_4                 1.639346e-01 1 1  ON 24
 eC_5                 2.843733e-01 1 1  ON 25
 eC_6                 3.000325e-01 1 1  ON 26
 eC_7                 3.287291e-01 1 1  ON 27
 eC_8                 2.213622e-01 1 1  ON 28
 eC_9                 4.709306e-02 1 1  ON 29
 eO_0                -1.207326e+00 1 1  ON 30
 eO_1                -8.147085e-01 1 1  ON 31
 eO_2                -3.215311e-01 1 1  ON 32
 eO_3                 4.513334e-03 1 1  ON 33
 eO_4                 2.290056e-01 1 1  ON 34
 eO_5                 3.701930e-01 1 1  ON 35
 eO_6                 4.054777e-01 1 1  ON 36
 eO_7                 4.309863e-01 1 1  ON 37
 eO_8                 4.437990e-01 1 1  ON 38
 eO_9                 3.233381e-01 1 1  ON 39
eH1_0                -1.649834e-01 1 1  ON 40
eH1_1                -6.447349e-02 1 1  ON 41
eH1_2                -4.335059e-02 1 1  ON 42
eH1_3                -4.067945e-02 1 1  ON 43
eH1_4                -2.066633e-03 1 1  ON 44
eH1_5                 9.943352e-03 1 1  ON 45
eH1_6                 3.966662e-02 1 1  ON 46
eH1_7                 4.559643e-02 1 1  ON 47
eH1_8                 3.131478e-02 1 1  ON 48
eH1_9                 9.090656e-02 1 1  ON 49
eH2_0                -1.673150e-01 1 1  ON 50
eH2_1                -6.725356e-02 1 1  ON 51
eH2_2                -4.592357e-02 1 1  ON 52
eH2_3                -4.349715e-02 1 1  ON 53
eH2_4                -5.013545e-03 1 1  ON 54
eH2_5                 6.737645e-03 1 1  ON 55
eH2_6                 3.618259e-02 1 1  ON 56
eH2_7                 4.269473e-02 1 1  ON 57
eH2_8                 2.831301e-02 1 1  ON 58
eH2_9                 9.544781e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.4752
    reference variance = 0.473155
====================================================
  Execution time = 4.8147e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6624e-01
  Total weights = 2.0000e+06
  Execution time = 3.8624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566333877876
                                         uncertainty =       0.006393748801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566333877876
                                         uncertainty =       0.006393748801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532080136
  error estimate for blocks of size 2^( 2) =       0.000551988041
  error estimate for blocks of size 2^( 3) =       0.000570533563
  error estimate for blocks of size 2^( 4) =       0.000583799084
  error estimate for blocks of size 2^( 5) =       0.000592908836
  error estimate for blocks of size 2^( 6) =       0.000594774910
  error estimate for blocks of size 2^( 7) =       0.000598989480

      target function =                  N/A
              le_mean =     -22.437299489529
             les_mean =     503.998626641613
             stat err =       0.000592618078
             autocorr =       1.240496945947
              std dev =       0.752474944358
             le_variance =       0.566218541887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566390151746
                                         uncertainty =       0.006394008324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566390151746
                                         uncertainty =       0.006394008324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532106566
  error estimate for blocks of size 2^( 2) =       0.000552012768
  error estimate for blocks of size 2^( 3) =       0.000570556760
  error estimate for blocks of size 2^( 4) =       0.000583820697
  error estimate for blocks of size 2^( 5) =       0.000592931270
  error estimate for blocks of size 2^( 6) =       0.000594797127
  error estimate for blocks of size 2^( 7) =       0.000599012126

      target function =                  N/A
              le_mean =     -22.437298733261
             les_mean =     503.998648957664
             stat err =       0.000592640305
             autocorr =       1.240466762636
              std dev =       0.752512322282
             le_variance =       0.566274795186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566368655430
                                         uncertainty =       0.006393940234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566368655430
                                         uncertainty =       0.006393940234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532096471
  error estimate for blocks of size 2^( 2) =       0.000552003363
  error estimate for blocks of size 2^( 3) =       0.000570548004
  error estimate for blocks of size 2^( 4) =       0.000583812633
  error estimate for blocks of size 2^( 5) =       0.000592922879
  error estimate for blocks of size 2^( 6) =       0.000594788770
  error estimate for blocks of size 2^( 7) =       0.000599003695

      target function =                  N/A
              le_mean =     -22.437299053644
             les_mean =     503.998641847673
             stat err =       0.000592631994
             autocorr =       1.240479042419
              std dev =       0.752498045274
             le_variance =       0.566253308142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566338476538
                                         uncertainty =       0.006393775587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566338476538
                                         uncertainty =       0.006393775587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532082296
  error estimate for blocks of size 2^( 2) =       0.000551990068
  error estimate for blocks of size 2^( 3) =       0.000570535475
  error estimate for blocks of size 2^( 4) =       0.000583800882
  error estimate for blocks of size 2^( 5) =       0.000592910698
  error estimate for blocks of size 2^( 6) =       0.000594776746
  error estimate for blocks of size 2^( 7) =       0.000598991366

      target function =                  N/A
              le_mean =     -22.437299430944
             les_mean =     503.998628609820
             stat err =       0.000592619923
             autocorr =       1.240494599291
              std dev =       0.752477999082
             le_variance =       0.566223139102


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437299489529        initial  <--
     1.5625e+00     1.5625e+01             1.1330e-04       -22.437298733261
     6.2500e+00     6.2500e+01             3.1228e-05       -22.437299053644
     2.5000e+01     2.5000e+02             8.0230e-06       -22.437299430944

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.4640
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.739617e-01 1 1  ON 0
 uu_1                 9.863460e-02 1 1  ON 1
 uu_2                -1.784285e-02 1 1  ON 2
 uu_3                -8.834399e-02 1 1  ON 3
 uu_4                -1.300124e-01 1 1  ON 4
 uu_5                -1.551814e-01 1 1  ON 5
 uu_6                -1.679777e-01 1 1  ON 6
 uu_7                -1.686412e-01 1 1  ON 7
 uu_8                -1.529827e-01 1 1  ON 8
 uu_9                -1.129485e-01 1 1  ON 9
 ud_0                 4.660262e-01 1 1  ON 10
 ud_1                 1.816177e-01 1 1  ON 11
 ud_2                 3.094290e-02 1 1  ON 12
 ud_3                -5.383831e-02 1 1  ON 13
 ud_4                -1.042023e-01 1 1  ON 14
 ud_5                -1.374794e-01 1 1  ON 15
 ud_6                -1.582794e-01 1 1  ON 16
 ud_7                -1.658317e-01 1 1  ON 17
 ud_8                -1.567700e-01 1 1  ON 18
 ud_9                -1.264907e-01 1 1  ON 19
 eC_0                -6.709806e-01 1 1  ON 20
 eC_1                -4.980878e-01 1 1  ON 21
 eC_2                -1.966556e-01 1 1  ON 22
 eC_3                 2.182074e-02 1 1  ON 23
 eC_4                 1.639425e-01 1 1  ON 24
 eC_5                 2.843770e-01 1 1  ON 25
 eC_6                 3.000363e-01 1 1  ON 26
 eC_7                 3.287230e-01 1 1  ON 27
 eC_8                 2.213400e-01 1 1  ON 28
 eC_9                 4.708543e-02 1 1  ON 29
 eO_0                -1.207311e+00 1 1  ON 30
 eO_1                -8.147013e-01 1 1  ON 31
 eO_2                -3.215100e-01 1 1  ON 32
 eO_3                 4.505233e-03 1 1  ON 33
 eO_4                 2.290079e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054897e-01 1 1  ON 36
 eO_7                 4.309905e-01 1 1  ON 37
 eO_8                 4.437987e-01 1 1  ON 38
 eO_9                 3.233143e-01 1 1  ON 39
eH1_0                -1.649892e-01 1 1  ON 40
eH1_1                -6.446905e-02 1 1  ON 41
eH1_2                -4.335292e-02 1 1  ON 42
eH1_3                -4.066486e-02 1 1  ON 43
eH1_4                -2.049773e-03 1 1  ON 44
eH1_5                 9.940986e-03 1 1  ON 45
eH1_6                 3.966312e-02 1 1  ON 46
eH1_7                 4.560452e-02 1 1  ON 47
eH1_8                 3.130064e-02 1 1  ON 48
eH1_9                 9.090279e-02 1 1  ON 49
eH2_0                -1.673249e-01 1 1  ON 50
eH2_1                -6.724475e-02 1 1  ON 51
eH2_2                -4.591488e-02 1 1  ON 52
eH2_3                -4.351567e-02 1 1  ON 53
eH2_4                -4.982317e-03 1 1  ON 54
eH2_5                 6.738168e-03 1 1  ON 55
eH2_6                 3.617586e-02 1 1  ON 56
eH2_7                 4.269407e-02 1 1  ON 57
eH2_8                 2.831442e-02 1 1  ON 58
eH2_9                 9.544573e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3003e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2429e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.4028
    reference variance = 0.48974
====================================================
  Execution time = 4.5945e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 6.3901e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5361e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.639166860452
                                         uncertainty =       0.068848390284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.639166860452
                                         uncertainty =       0.068848390284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000565248679
  error estimate for blocks of size 2^( 2) =       0.000584026194
  error estimate for blocks of size 2^( 3) =       0.000601612162
  error estimate for blocks of size 2^( 4) =       0.000614399188
  error estimate for blocks of size 2^( 5) =       0.000623147764
  error estimate for blocks of size 2^( 6) =       0.000628494145
  error estimate for blocks of size 2^( 7) =       0.000630630613

      target function =                  N/A
              le_mean =     -22.437163441093
             les_mean =     504.065315100547
             stat err =       0.000624167927
             autocorr =       1.219337093285
              std dev =       0.799382347661
             le_variance =       0.639012137751


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243716344109e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437163441093       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437163554803       residual = 9.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437163585807       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437163618102       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437163624265       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437163605767       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437163626666       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437163651318       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437163656931       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437163652184       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+01 is 1.566284e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437163441093       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437163469851       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437163477661       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437163485866       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437163487415       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437163482577       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437163487954       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437163494204       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437163495638       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437163494419       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+01 is 3.954281e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437163441093       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437163448303       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437163450259       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437163452319       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437163452707       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437163451483       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437163452837       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437163454405       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437163454766       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437163454459       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+02 is 9.910209e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160743 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1314e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.739602e-01 1 1  ON 0
 uu_1                 9.863328e-02 1 1  ON 1
 uu_2                -1.784455e-02 1 1  ON 2
 uu_3                -8.834522e-02 1 1  ON 3
 uu_4                -1.300113e-01 1 1  ON 4
 uu_5                -1.551815e-01 1 1  ON 5
 uu_6                -1.679779e-01 1 1  ON 6
 uu_7                -1.686387e-01 1 1  ON 7
 uu_8                -1.529813e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660272e-01 1 1  ON 10
 ud_1                 1.816193e-01 1 1  ON 11
 ud_2                 3.094531e-02 1 1  ON 12
 ud_3                -5.383892e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582811e-01 1 1  ON 16
 ud_7                -1.658319e-01 1 1  ON 17
 ud_8                -1.567686e-01 1 1  ON 18
 ud_9                -1.264892e-01 1 1  ON 19
 eC_0                -6.709800e-01 1 1  ON 20
 eC_1                -4.980917e-01 1 1  ON 21
 eC_2                -1.966547e-01 1 1  ON 22
 eC_3                 2.182216e-02 1 1  ON 23
 eC_4                 1.639432e-01 1 1  ON 24
 eC_5                 2.843750e-01 1 1  ON 25
 eC_6                 3.000350e-01 1 1  ON 26
 eC_7                 3.287235e-01 1 1  ON 27
 eC_8                 2.213424e-01 1 1  ON 28
 eC_9                 4.708615e-02 1 1  ON 29
 eO_0                -1.207311e+00 1 1  ON 30
 eO_1                -8.147052e-01 1 1  ON 31
 eO_2                -3.215111e-01 1 1  ON 32
 eO_3                 4.504174e-03 1 1  ON 33
 eO_4                 2.290083e-01 1 1  ON 34
 eO_5                 3.701794e-01 1 1  ON 35
 eO_6                 4.054900e-01 1 1  ON 36
 eO_7                 4.309907e-01 1 1  ON 37
 eO_8                 4.437990e-01 1 1  ON 38
 eO_9                 3.233167e-01 1 1  ON 39
eH1_0                -1.649889e-01 1 1  ON 40
eH1_1                -6.446846e-02 1 1  ON 41
eH1_2                -4.335404e-02 1 1  ON 42
eH1_3                -4.066401e-02 1 1  ON 43
eH1_4                -2.049500e-03 1 1  ON 44
eH1_5                 9.938206e-03 1 1  ON 45
eH1_6                 3.966456e-02 1 1  ON 46
eH1_7                 4.560305e-02 1 1  ON 47
eH1_8                 3.130075e-02 1 1  ON 48
eH1_9                 9.090336e-02 1 1  ON 49
eH2_0                -1.673239e-01 1 1  ON 50
eH2_1                -6.724421e-02 1 1  ON 51
eH2_2                -4.591559e-02 1 1  ON 52
eH2_3                -4.351465e-02 1 1  ON 53
eH2_4                -4.981739e-03 1 1  ON 54
eH2_5                 6.738621e-03 1 1  ON 55
eH2_6                 3.617354e-02 1 1  ON 56
eH2_7                 4.269224e-02 1 1  ON 57
eH2_8                 2.831415e-02 1 1  ON 58
eH2_9                 9.544590e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.5018
    reference variance = 0.6012
====================================================
  Execution time = 4.6071e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2439e+01
  VMC Evar = 5.7201e-01
  Total weights = 2.0000e+06
  Execution time = 3.8869e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572048025879
                                         uncertainty =       0.005020540519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572048025879
                                         uncertainty =       0.005020540519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534797104
  error estimate for blocks of size 2^( 2) =       0.000554818881
  error estimate for blocks of size 2^( 3) =       0.000574163225
  error estimate for blocks of size 2^( 4) =       0.000588378749
  error estimate for blocks of size 2^( 5) =       0.000597559822
  error estimate for blocks of size 2^( 6) =       0.000603700308
  error estimate for blocks of size 2^( 7) =       0.000605917199

      target function =                  N/A
              le_mean =     -22.438588809246
             les_mean =     504.062283348891
             stat err =       0.000598889020
             autocorr =       1.254049293053
              std dev =       0.756317317307
             le_variance =       0.572015884458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572043413106
                                         uncertainty =       0.005020579933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572043413106
                                         uncertainty =       0.005020579933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534794945
  error estimate for blocks of size 2^( 2) =       0.000554817098
  error estimate for blocks of size 2^( 3) =       0.000574161654
  error estimate for blocks of size 2^( 4) =       0.000588376903
  error estimate for blocks of size 2^( 5) =       0.000597558219
  error estimate for blocks of size 2^( 6) =       0.000603698965
  error estimate for blocks of size 2^( 7) =       0.000605916013

      target function =                  N/A
              le_mean =     -22.438588749177
             les_mean =     504.062276034125
             stat err =       0.000598887525
             autocorr =       1.254053160036
              std dev =       0.756314263662
             le_variance =       0.572011265418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572045633657
                                         uncertainty =       0.005020559876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572045633657
                                         uncertainty =       0.005020559876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534795984
  error estimate for blocks of size 2^( 2) =       0.000554817954
  error estimate for blocks of size 2^( 3) =       0.000574162407
  error estimate for blocks of size 2^( 4) =       0.000588377792
  error estimate for blocks of size 2^( 5) =       0.000597558989
  error estimate for blocks of size 2^( 6) =       0.000603699607
  error estimate for blocks of size 2^( 7) =       0.000605916577

      target function =                  N/A
              le_mean =     -22.438588777987
             les_mean =     504.062279550678
             stat err =       0.000598888241
             autocorr =       1.254051284015
              std dev =       0.756315733711
             le_variance =       0.572013489058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572047723885
                                         uncertainty =       0.005020542927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572047723885
                                         uncertainty =       0.005020542927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534796962
  error estimate for blocks of size 2^( 2) =       0.000554818764
  error estimate for blocks of size 2^( 3) =       0.000574163122
  error estimate for blocks of size 2^( 4) =       0.000588378628
  error estimate for blocks of size 2^( 5) =       0.000597559717
  error estimate for blocks of size 2^( 6) =       0.000603700219
  error estimate for blocks of size 2^( 7) =       0.000605917120

      target function =                  N/A
              le_mean =     -22.438588805266
             les_mean =     504.062282867886
             stat err =       0.000598888921
             autocorr =       1.254049543730
              std dev =       0.756317117395
             le_variance =       0.572015582065


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.438588809246        initial  <--
     1.5625e+01     1.5625e+02             1.5663e-05       -22.438588749177
     6.2500e+01     6.2500e+02             3.9543e-06       -22.438588777987
     2.5000e+02     2.5000e+03             9.9102e-07       -22.438588805266

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.2311
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.739617e-01 1 1  ON 0
 uu_1                 9.863460e-02 1 1  ON 1
 uu_2                -1.784285e-02 1 1  ON 2
 uu_3                -8.834399e-02 1 1  ON 3
 uu_4                -1.300124e-01 1 1  ON 4
 uu_5                -1.551814e-01 1 1  ON 5
 uu_6                -1.679777e-01 1 1  ON 6
 uu_7                -1.686412e-01 1 1  ON 7
 uu_8                -1.529827e-01 1 1  ON 8
 uu_9                -1.129485e-01 1 1  ON 9
 ud_0                 4.660262e-01 1 1  ON 10
 ud_1                 1.816177e-01 1 1  ON 11
 ud_2                 3.094290e-02 1 1  ON 12
 ud_3                -5.383831e-02 1 1  ON 13
 ud_4                -1.042023e-01 1 1  ON 14
 ud_5                -1.374794e-01 1 1  ON 15
 ud_6                -1.582794e-01 1 1  ON 16
 ud_7                -1.658317e-01 1 1  ON 17
 ud_8                -1.567700e-01 1 1  ON 18
 ud_9                -1.264907e-01 1 1  ON 19
 eC_0                -6.709806e-01 1 1  ON 20
 eC_1                -4.980878e-01 1 1  ON 21
 eC_2                -1.966556e-01 1 1  ON 22
 eC_3                 2.182074e-02 1 1  ON 23
 eC_4                 1.639425e-01 1 1  ON 24
 eC_5                 2.843770e-01 1 1  ON 25
 eC_6                 3.000363e-01 1 1  ON 26
 eC_7                 3.287230e-01 1 1  ON 27
 eC_8                 2.213400e-01 1 1  ON 28
 eC_9                 4.708543e-02 1 1  ON 29
 eO_0                -1.207311e+00 1 1  ON 30
 eO_1                -8.147013e-01 1 1  ON 31
 eO_2                -3.215100e-01 1 1  ON 32
 eO_3                 4.505233e-03 1 1  ON 33
 eO_4                 2.290079e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054897e-01 1 1  ON 36
 eO_7                 4.309905e-01 1 1  ON 37
 eO_8                 4.437987e-01 1 1  ON 38
 eO_9                 3.233143e-01 1 1  ON 39
eH1_0                -1.649892e-01 1 1  ON 40
eH1_1                -6.446905e-02 1 1  ON 41
eH1_2                -4.335292e-02 1 1  ON 42
eH1_3                -4.066486e-02 1 1  ON 43
eH1_4                -2.049773e-03 1 1  ON 44
eH1_5                 9.940986e-03 1 1  ON 45
eH1_6                 3.966312e-02 1 1  ON 46
eH1_7                 4.560452e-02 1 1  ON 47
eH1_8                 3.130064e-02 1 1  ON 48
eH1_9                 9.090279e-02 1 1  ON 49
eH2_0                -1.673249e-01 1 1  ON 50
eH2_1                -6.724475e-02 1 1  ON 51
eH2_2                -4.591488e-02 1 1  ON 52
eH2_3                -4.351567e-02 1 1  ON 53
eH2_4                -4.982317e-03 1 1  ON 54
eH2_5                 6.738168e-03 1 1  ON 55
eH2_6                 3.617586e-02 1 1  ON 56
eH2_7                 4.269407e-02 1 1  ON 57
eH2_8                 2.831442e-02 1 1  ON 58
eH2_9                 9.544573e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2956e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2433e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.5179
    reference variance = 0.40497
====================================================
  Execution time = 4.6688e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6422e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5089e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564262754140
                                         uncertainty =       0.005559639227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564262754140
                                         uncertainty =       0.005559639227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531141120
  error estimate for blocks of size 2^( 2) =       0.000551284858
  error estimate for blocks of size 2^( 3) =       0.000569652825
  error estimate for blocks of size 2^( 4) =       0.000582829065
  error estimate for blocks of size 2^( 5) =       0.000590284837
  error estimate for blocks of size 2^( 6) =       0.000594028991
  error estimate for blocks of size 2^( 7) =       0.000596395274

      target function =                  N/A
              le_mean =     -22.437541577550
             les_mean =     504.007493541155
             stat err =       0.000590884542
             autocorr =       1.237614549950
              std dev =       0.751146975633
             le_variance =       0.564221779003


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243754157755e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437541577550       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437541587550       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437541591125       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437541588880       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437541586029       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437541588853       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437541590086       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437541591471       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437541590443       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437541591093       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+02 is 1.356665e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437541577550       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437541580053       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437541580949       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437541580388       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437541579676       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437541580381       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437541580690       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437541581036       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437541580780       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437541580944       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+02 is 3.394228e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437541577550       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437541578176       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437541578400       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437541578259       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437541578084       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437541578258       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437541578337       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437541578422       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437541578356       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437541578397       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+03 is 8.487177e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164292 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1785e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.739616e-01 1 1  ON 0
 uu_1                 9.863461e-02 1 1  ON 1
 uu_2                -1.784301e-02 1 1  ON 2
 uu_3                -8.834402e-02 1 1  ON 3
 uu_4                -1.300123e-01 1 1  ON 4
 uu_5                -1.551815e-01 1 1  ON 5
 uu_6                -1.679778e-01 1 1  ON 6
 uu_7                -1.686411e-01 1 1  ON 7
 uu_8                -1.529825e-01 1 1  ON 8
 uu_9                -1.129484e-01 1 1  ON 9
 ud_0                 4.660262e-01 1 1  ON 10
 ud_1                 1.816179e-01 1 1  ON 11
 ud_2                 3.094299e-02 1 1  ON 12
 ud_3                -5.383829e-02 1 1  ON 13
 ud_4                -1.042024e-01 1 1  ON 14
 ud_5                -1.374794e-01 1 1  ON 15
 ud_6                -1.582793e-01 1 1  ON 16
 ud_7                -1.658320e-01 1 1  ON 17
 ud_8                -1.567697e-01 1 1  ON 18
 ud_9                -1.264906e-01 1 1  ON 19
 eC_0                -6.709807e-01 1 1  ON 20
 eC_1                -4.980881e-01 1 1  ON 21
 eC_2                -1.966556e-01 1 1  ON 22
 eC_3                 2.182076e-02 1 1  ON 23
 eC_4                 1.639427e-01 1 1  ON 24
 eC_5                 2.843770e-01 1 1  ON 25
 eC_6                 3.000362e-01 1 1  ON 26
 eC_7                 3.287230e-01 1 1  ON 27
 eC_8                 2.213402e-01 1 1  ON 28
 eC_9                 4.708550e-02 1 1  ON 29
 eO_0                -1.207311e+00 1 1  ON 30
 eO_1                -8.147015e-01 1 1  ON 31
 eO_2                -3.215102e-01 1 1  ON 32
 eO_3                 4.505066e-03 1 1  ON 33
 eO_4                 2.290080e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054897e-01 1 1  ON 36
 eO_7                 4.309905e-01 1 1  ON 37
 eO_8                 4.437987e-01 1 1  ON 38
 eO_9                 3.233146e-01 1 1  ON 39
eH1_0                -1.649892e-01 1 1  ON 40
eH1_1                -6.446925e-02 1 1  ON 41
eH1_2                -4.335264e-02 1 1  ON 42
eH1_3                -4.066478e-02 1 1  ON 43
eH1_4                -2.049806e-03 1 1  ON 44
eH1_5                 9.941022e-03 1 1  ON 45
eH1_6                 3.966292e-02 1 1  ON 46
eH1_7                 4.560449e-02 1 1  ON 47
eH1_8                 3.130061e-02 1 1  ON 48
eH1_9                 9.090274e-02 1 1  ON 49
eH2_0                -1.673250e-01 1 1  ON 50
eH2_1                -6.724460e-02 1 1  ON 51
eH2_2                -4.591504e-02 1 1  ON 52
eH2_3                -4.351564e-02 1 1  ON 53
eH2_4                -4.982401e-03 1 1  ON 54
eH2_5                 6.738104e-03 1 1  ON 55
eH2_6                 3.617587e-02 1 1  ON 56
eH2_7                 4.269410e-02 1 1  ON 57
eH2_8                 2.831452e-02 1 1  ON 58
eH2_9                 9.544571e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.4065
    reference variance = 0.434787
====================================================
  Execution time = 4.5493e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7102e-01
  Total weights = 2.0000e+06
  Execution time = 3.8674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571144322837
                                         uncertainty =       0.006320983385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571144322837
                                         uncertainty =       0.006320983385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534332107
  error estimate for blocks of size 2^( 2) =       0.000554537127
  error estimate for blocks of size 2^( 3) =       0.000572914455
  error estimate for blocks of size 2^( 4) =       0.000586207151
  error estimate for blocks of size 2^( 5) =       0.000594962661
  error estimate for blocks of size 2^( 6) =       0.000599609510
  error estimate for blocks of size 2^( 7) =       0.000601038328

      target function =                  N/A
              le_mean =     -22.436748560240
             les_mean =     503.978707271594
             stat err =       0.000595454413
             autocorr =       1.241865303821
              std dev =       0.755659712871
             le_variance =       0.571021601656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571144345994
                                         uncertainty =       0.006320985376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571144345994
                                         uncertainty =       0.006320985376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534332118
  error estimate for blocks of size 2^( 2) =       0.000554537147
  error estimate for blocks of size 2^( 3) =       0.000572914474
  error estimate for blocks of size 2^( 4) =       0.000586207159
  error estimate for blocks of size 2^( 5) =       0.000594962671
  error estimate for blocks of size 2^( 6) =       0.000599609510
  error estimate for blocks of size 2^( 7) =       0.000601038285

      target function =                  N/A
              le_mean =     -22.436748561148
             les_mean =     503.978707335508
             stat err =       0.000595454406
             autocorr =       1.241865227338
              std dev =       0.755659728199
             le_variance =       0.571021624821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571144334270
                                         uncertainty =       0.006320984382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571144334270
                                         uncertainty =       0.006320984382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534332113
  error estimate for blocks of size 2^( 2) =       0.000554537137
  error estimate for blocks of size 2^( 3) =       0.000572914464
  error estimate for blocks of size 2^( 4) =       0.000586207155
  error estimate for blocks of size 2^( 5) =       0.000594962666
  error estimate for blocks of size 2^( 6) =       0.000599609510
  error estimate for blocks of size 2^( 7) =       0.000601038306

      target function =                  N/A
              le_mean =     -22.436748560691
             les_mean =     503.978707303264
             stat err =       0.000595454409
             autocorr =       1.241865265563
              std dev =       0.755659720439
             le_variance =       0.571021613094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571144324260
                                         uncertainty =       0.006320983510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571144324260
                                         uncertainty =       0.006320983510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534332108
  error estimate for blocks of size 2^( 2) =       0.000554537128
  error estimate for blocks of size 2^( 3) =       0.000572914457
  error estimate for blocks of size 2^( 4) =       0.000586207151
  error estimate for blocks of size 2^( 5) =       0.000594962662
  error estimate for blocks of size 2^( 6) =       0.000599609510
  error estimate for blocks of size 2^( 7) =       0.000601038326

      target function =                  N/A
              le_mean =     -22.436748560296
             les_mean =     503.978707275536
             stat err =       0.000595454412
             autocorr =       1.241865299043
              std dev =       0.755659713813
             le_variance =       0.571021603080


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436748560240        initial
     1.5625e+02     1.5625e+03             1.3567e-06       -22.436748561148  <--
     6.2500e+02     6.2500e+03             3.3942e-07       -22.436748560691
     2.5000e+03     2.5000e+04             8.4872e-08       -22.436748560296

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 6.4890e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.739614e-01 1 1  ON 0
 uu_1                 9.863463e-02 1 1  ON 1
 uu_2                -1.784350e-02 1 1  ON 2
 uu_3                -8.834411e-02 1 1  ON 3
 uu_4                -1.300122e-01 1 1  ON 4
 uu_5                -1.551820e-01 1 1  ON 5
 uu_6                -1.679781e-01 1 1  ON 6
 uu_7                -1.686410e-01 1 1  ON 7
 uu_8                -1.529819e-01 1 1  ON 8
 uu_9                -1.129480e-01 1 1  ON 9
 ud_0                 4.660263e-01 1 1  ON 10
 ud_1                 1.816182e-01 1 1  ON 11
 ud_2                 3.094324e-02 1 1  ON 12
 ud_3                -5.383824e-02 1 1  ON 13
 ud_4                -1.042025e-01 1 1  ON 14
 ud_5                -1.374795e-01 1 1  ON 15
 ud_6                -1.582791e-01 1 1  ON 16
 ud_7                -1.658329e-01 1 1  ON 17
 ud_8                -1.567689e-01 1 1  ON 18
 ud_9                -1.264905e-01 1 1  ON 19
 eC_0                -6.709808e-01 1 1  ON 20
 eC_1                -4.980891e-01 1 1  ON 21
 eC_2                -1.966554e-01 1 1  ON 22
 eC_3                 2.182079e-02 1 1  ON 23
 eC_4                 1.639433e-01 1 1  ON 24
 eC_5                 2.843770e-01 1 1  ON 25
 eC_6                 3.000357e-01 1 1  ON 26
 eC_7                 3.287231e-01 1 1  ON 27
 eC_8                 2.213408e-01 1 1  ON 28
 eC_9                 4.708570e-02 1 1  ON 29
 eO_0                -1.207311e+00 1 1  ON 30
 eO_1                -8.147021e-01 1 1  ON 31
 eO_2                -3.215107e-01 1 1  ON 32
 eO_3                 4.504566e-03 1 1  ON 33
 eO_4                 2.290083e-01 1 1  ON 34
 eO_5                 3.701785e-01 1 1  ON 35
 eO_6                 4.054900e-01 1 1  ON 36
 eO_7                 4.309904e-01 1 1  ON 37
 eO_8                 4.437988e-01 1 1  ON 38
 eO_9                 3.233154e-01 1 1  ON 39
eH1_0                -1.649891e-01 1 1  ON 40
eH1_1                -6.446984e-02 1 1  ON 41
eH1_2                -4.335180e-02 1 1  ON 42
eH1_3                -4.066452e-02 1 1  ON 43
eH1_4                -2.049905e-03 1 1  ON 44
eH1_5                 9.941133e-03 1 1  ON 45
eH1_6                 3.966234e-02 1 1  ON 46
eH1_7                 4.560439e-02 1 1  ON 47
eH1_8                 3.130051e-02 1 1  ON 48
eH1_9                 9.090259e-02 1 1  ON 49
eH2_0                -1.673253e-01 1 1  ON 50
eH2_1                -6.724415e-02 1 1  ON 51
eH2_2                -4.591551e-02 1 1  ON 52
eH2_3                -4.351555e-02 1 1  ON 53
eH2_4                -4.982651e-03 1 1  ON 54
eH2_5                 6.737912e-03 1 1  ON 55
eH2_6                 3.617591e-02 1 1  ON 56
eH2_7                 4.269420e-02 1 1  ON 57
eH2_8                 2.831481e-02 1 1  ON 58
eH2_9                 9.544566e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2683e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2436e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.529
    reference variance = 0.527283
====================================================
  Execution time = 4.8297e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5867e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5738e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558715406909
                                         uncertainty =       0.004139382846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558715406909
                                         uncertainty =       0.004139382846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528523229
  error estimate for blocks of size 2^( 2) =       0.000548791753
  error estimate for blocks of size 2^( 3) =       0.000566985979
  error estimate for blocks of size 2^( 4) =       0.000581205923
  error estimate for blocks of size 2^( 5) =       0.000590318000
  error estimate for blocks of size 2^( 6) =       0.000595899656
  error estimate for blocks of size 2^( 7) =       0.000597914920

      target function =                  N/A
              le_mean =     -22.436642645301
             les_mean =     503.961606520886
             stat err =       0.000591334625
             autocorr =       1.251810122576
              std dev =       0.747444718556
             le_variance =       0.558673607297


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243664264530e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436642645301       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436642645245       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436642661927       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436642666953       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436642668474       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436642670687       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436642675399       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436642676663       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436642674381       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436642674260       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+01 is 5.149258e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436642645301       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436642645287       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436642649473       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436642650737       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436642651126       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436642651684       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436642652862       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436642653184       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436642652628       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436642652584       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+02 is 1.292257e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436642645301       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436642645297       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436642646345       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436642646661       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436642646759       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436642646899       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436642647193       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436642647275       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436642647135       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436642647125       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+02 is 3.233748e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167873 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.4043e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.739605e-01 1 1  ON 0
 uu_1                 9.863518e-02 1 1  ON 1
 uu_2                -1.784334e-02 1 1  ON 2
 uu_3                -8.834364e-02 1 1  ON 3
 uu_4                -1.300123e-01 1 1  ON 4
 uu_5                -1.551825e-01 1 1  ON 5
 uu_6                -1.679780e-01 1 1  ON 6
 uu_7                -1.686413e-01 1 1  ON 7
 uu_8                -1.529825e-01 1 1  ON 8
 uu_9                -1.129476e-01 1 1  ON 9
 ud_0                 4.660275e-01 1 1  ON 10
 ud_1                 1.816181e-01 1 1  ON 11
 ud_2                 3.094291e-02 1 1  ON 12
 ud_3                -5.383878e-02 1 1  ON 13
 ud_4                -1.042026e-01 1 1  ON 14
 ud_5                -1.374796e-01 1 1  ON 15
 ud_6                -1.582783e-01 1 1  ON 16
 ud_7                -1.658334e-01 1 1  ON 17
 ud_8                -1.567693e-01 1 1  ON 18
 ud_9                -1.264899e-01 1 1  ON 19
 eC_0                -6.709809e-01 1 1  ON 20
 eC_1                -4.980896e-01 1 1  ON 21
 eC_2                -1.966559e-01 1 1  ON 22
 eC_3                 2.182098e-02 1 1  ON 23
 eC_4                 1.639429e-01 1 1  ON 24
 eC_5                 2.843772e-01 1 1  ON 25
 eC_6                 3.000358e-01 1 1  ON 26
 eC_7                 3.287228e-01 1 1  ON 27
 eC_8                 2.213415e-01 1 1  ON 28
 eC_9                 4.708606e-02 1 1  ON 29
 eO_0                -1.207312e+00 1 1  ON 30
 eO_1                -8.147031e-01 1 1  ON 31
 eO_2                -3.215115e-01 1 1  ON 32
 eO_3                 4.503620e-03 1 1  ON 33
 eO_4                 2.290096e-01 1 1  ON 34
 eO_5                 3.701790e-01 1 1  ON 35
 eO_6                 4.054896e-01 1 1  ON 36
 eO_7                 4.309904e-01 1 1  ON 37
 eO_8                 4.437988e-01 1 1  ON 38
 eO_9                 3.233164e-01 1 1  ON 39
eH1_0                -1.649889e-01 1 1  ON 40
eH1_1                -6.446887e-02 1 1  ON 41
eH1_2                -4.335189e-02 1 1  ON 42
eH1_3                -4.066452e-02 1 1  ON 43
eH1_4                -2.051120e-03 1 1  ON 44
eH1_5                 9.941245e-03 1 1  ON 45
eH1_6                 3.966205e-02 1 1  ON 46
eH1_7                 4.560436e-02 1 1  ON 47
eH1_8                 3.130047e-02 1 1  ON 48
eH1_9                 9.090249e-02 1 1  ON 49
eH2_0                -1.673255e-01 1 1  ON 50
eH2_1                -6.724393e-02 1 1  ON 51
eH2_2                -4.591568e-02 1 1  ON 52
eH2_3                -4.351506e-02 1 1  ON 53
eH2_4                -4.983106e-03 1 1  ON 54
eH2_5                 6.737845e-03 1 1  ON 55
eH2_6                 3.617604e-02 1 1  ON 56
eH2_7                 4.269473e-02 1 1  ON 57
eH2_8                 2.831447e-02 1 1  ON 58
eH2_9                 9.544526e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.5058
    reference variance = 0.240906
====================================================
  Execution time = 4.5019e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6361e-01
  Total weights = 2.0000e+06
  Execution time = 3.8547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563706385864
                                         uncertainty =       0.005360258421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563706385864
                                         uncertainty =       0.005360258421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530851399
  error estimate for blocks of size 2^( 2) =       0.000550842209
  error estimate for blocks of size 2^( 3) =       0.000569658198
  error estimate for blocks of size 2^( 4) =       0.000583941367
  error estimate for blocks of size 2^( 5) =       0.000591731663
  error estimate for blocks of size 2^( 6) =       0.000596043461
  error estimate for blocks of size 2^( 7) =       0.000598377266

      target function =                  N/A
              le_mean =     -22.437119508977
             les_mean =     503.987937993228
             stat err =       0.000592523439
             autocorr =       1.245848226429
              std dev =       0.750737247579
             le_variance =       0.563606414903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563713133668
                                         uncertainty =       0.005360300479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563713133668
                                         uncertainty =       0.005360300479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530854574
  error estimate for blocks of size 2^( 2) =       0.000550845165
  error estimate for blocks of size 2^( 3) =       0.000569660903
  error estimate for blocks of size 2^( 4) =       0.000583943884
  error estimate for blocks of size 2^( 5) =       0.000591734063
  error estimate for blocks of size 2^( 6) =       0.000596045841
  error estimate for blocks of size 2^( 7) =       0.000598379533

      target function =                  N/A
              le_mean =     -22.437119538579
             les_mean =     503.987946064796
             stat err =       0.000592525830
             autocorr =       1.245843375672
              std dev =       0.750741738622
             le_variance =       0.563613158109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563709789435
                                         uncertainty =       0.005360279642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563709789435
                                         uncertainty =       0.005360279642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530853000
  error estimate for blocks of size 2^( 2) =       0.000550843700
  error estimate for blocks of size 2^( 3) =       0.000569659563
  error estimate for blocks of size 2^( 4) =       0.000583942637
  error estimate for blocks of size 2^( 5) =       0.000591732874
  error estimate for blocks of size 2^( 6) =       0.000596044662
  error estimate for blocks of size 2^( 7) =       0.000598378410

      target function =                  N/A
              le_mean =     -22.437119523862
             les_mean =     503.987942062431
             stat err =       0.000592524646
             autocorr =       1.245845782147
              std dev =       0.750739512852
             le_variance =       0.563609816157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563706812223
                                         uncertainty =       0.005360261079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563706812223
                                         uncertainty =       0.005360261079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530851599
  error estimate for blocks of size 2^( 2) =       0.000550842396
  error estimate for blocks of size 2^( 3) =       0.000569658369
  error estimate for blocks of size 2^( 4) =       0.000583941526
  error estimate for blocks of size 2^( 5) =       0.000591731815
  error estimate for blocks of size 2^( 6) =       0.000596043612
  error estimate for blocks of size 2^( 7) =       0.000598377409

      target function =                  N/A
              le_mean =     -22.437119510837
             les_mean =     503.987938502756
             stat err =       0.000592523591
             autocorr =       1.245847920280
              std dev =       0.750737531346
             le_variance =       0.563606840972


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437119508977        initial
     3.9062e+01     3.9062e+02             5.1493e-06       -22.437119538579  <--
     1.5625e+02     1.5625e+03             1.2923e-06       -22.437119523862
     6.2500e+02     6.2500e+03             3.2337e-07       -22.437119510837

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 6.4321e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.739580e-01 1 1  ON 0
 uu_1                 9.863679e-02 1 1  ON 1
 uu_2                -1.784288e-02 1 1  ON 2
 uu_3                -8.834223e-02 1 1  ON 3
 uu_4                -1.300126e-01 1 1  ON 4
 uu_5                -1.551841e-01 1 1  ON 5
 uu_6                -1.679778e-01 1 1  ON 6
 uu_7                -1.686424e-01 1 1  ON 7
 uu_8                -1.529844e-01 1 1  ON 8
 uu_9                -1.129466e-01 1 1  ON 9
 ud_0                 4.660311e-01 1 1  ON 10
 ud_1                 1.816179e-01 1 1  ON 11
 ud_2                 3.094194e-02 1 1  ON 12
 ud_3                -5.384039e-02 1 1  ON 13
 ud_4                -1.042030e-01 1 1  ON 14
 ud_5                -1.374800e-01 1 1  ON 15
 ud_6                -1.582761e-01 1 1  ON 16
 ud_7                -1.658349e-01 1 1  ON 17
 ud_8                -1.567705e-01 1 1  ON 18
 ud_9                -1.264882e-01 1 1  ON 19
 eC_0                -6.709814e-01 1 1  ON 20
 eC_1                -4.980908e-01 1 1  ON 21
 eC_2                -1.966570e-01 1 1  ON 22
 eC_3                 2.182155e-02 1 1  ON 23
 eC_4                 1.639417e-01 1 1  ON 24
 eC_5                 2.843779e-01 1 1  ON 25
 eC_6                 3.000361e-01 1 1  ON 26
 eC_7                 3.287219e-01 1 1  ON 27
 eC_8                 2.213438e-01 1 1  ON 28
 eC_9                 4.708713e-02 1 1  ON 29
 eO_0                -1.207314e+00 1 1  ON 30
 eO_1                -8.147060e-01 1 1  ON 31
 eO_2                -3.215137e-01 1 1  ON 32
 eO_3                 4.500794e-03 1 1  ON 33
 eO_4                 2.290135e-01 1 1  ON 34
 eO_5                 3.701807e-01 1 1  ON 35
 eO_6                 4.054885e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437988e-01 1 1  ON 38
 eO_9                 3.233193e-01 1 1  ON 39
eH1_0                -1.649884e-01 1 1  ON 40
eH1_1                -6.446596e-02 1 1  ON 41
eH1_2                -4.335218e-02 1 1  ON 42
eH1_3                -4.066454e-02 1 1  ON 43
eH1_4                -2.054745e-03 1 1  ON 44
eH1_5                 9.941569e-03 1 1  ON 45
eH1_6                 3.966118e-02 1 1  ON 46
eH1_7                 4.560428e-02 1 1  ON 47
eH1_8                 3.130032e-02 1 1  ON 48
eH1_9                 9.090219e-02 1 1  ON 49
eH2_0                -1.673263e-01 1 1  ON 50
eH2_1                -6.724327e-02 1 1  ON 51
eH2_2                -4.591619e-02 1 1  ON 52
eH2_3                -4.351361e-02 1 1  ON 53
eH2_4                -4.984459e-03 1 1  ON 54
eH2_5                 6.737642e-03 1 1  ON 55
eH2_6                 3.617641e-02 1 1  ON 56
eH2_7                 4.269632e-02 1 1  ON 57
eH2_8                 2.831347e-02 1 1  ON 58
eH2_9                 9.544406e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2851e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2445e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.5499
    reference variance = 0.524644
====================================================
  Execution time = 4.8199e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6471e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5588e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564719777928
                                         uncertainty =       0.006937954908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564719777928
                                         uncertainty =       0.006937954908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531371519
  error estimate for blocks of size 2^( 2) =       0.000551387702
  error estimate for blocks of size 2^( 3) =       0.000569574278
  error estimate for blocks of size 2^( 4) =       0.000583869460
  error estimate for blocks of size 2^( 5) =       0.000590984487
  error estimate for blocks of size 2^( 6) =       0.000595502744
  error estimate for blocks of size 2^( 7) =       0.000598369073

      target function =                  N/A
              le_mean =     -22.436238908316
             les_mean =     503.949527450393
             stat err =       0.000592181441
             autocorr =       1.241975530548
              std dev =       0.751472808370
             le_variance =       0.564711381719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243623890832e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436238908316       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436238956012       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436238998611       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436239072407       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436239058711       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436239072788       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436239077119       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436239070768       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436239054333       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436239053375       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+00 is 1.708676e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436238908316       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436238920391       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436238931187       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436238949753       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436238946435       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436238949977       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436238950784       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436238949282       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436238945209       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436238944992       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+01 is 4.337195e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436238908316       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436238911344       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436238914053       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436238918701       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436238917880       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436238918766       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436238918949       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436238918580       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436238917564       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436238917512       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+02 is 1.088557e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171414 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3795e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.739593e-01 1 1  ON 0
 uu_1                 9.863658e-02 1 1  ON 1
 uu_2                -1.784470e-02 1 1  ON 2
 uu_3                -8.834456e-02 1 1  ON 3
 uu_4                -1.300128e-01 1 1  ON 4
 uu_5                -1.551840e-01 1 1  ON 5
 uu_6                -1.679763e-01 1 1  ON 6
 uu_7                -1.686431e-01 1 1  ON 7
 uu_8                -1.529858e-01 1 1  ON 8
 uu_9                -1.129460e-01 1 1  ON 9
 ud_0                 4.660331e-01 1 1  ON 10
 ud_1                 1.816206e-01 1 1  ON 11
 ud_2                 3.094324e-02 1 1  ON 12
 ud_3                -5.383938e-02 1 1  ON 13
 ud_4                -1.042023e-01 1 1  ON 14
 ud_5                -1.374801e-01 1 1  ON 15
 ud_6                -1.582749e-01 1 1  ON 16
 ud_7                -1.658376e-01 1 1  ON 17
 ud_8                -1.567731e-01 1 1  ON 18
 ud_9                -1.264894e-01 1 1  ON 19
 eC_0                -6.709789e-01 1 1  ON 20
 eC_1                -4.980941e-01 1 1  ON 21
 eC_2                -1.966579e-01 1 1  ON 22
 eC_3                 2.182093e-02 1 1  ON 23
 eC_4                 1.639437e-01 1 1  ON 24
 eC_5                 2.843780e-01 1 1  ON 25
 eC_6                 3.000331e-01 1 1  ON 26
 eC_7                 3.287201e-01 1 1  ON 27
 eC_8                 2.213470e-01 1 1  ON 28
 eC_9                 4.708880e-02 1 1  ON 29
 eO_0                -1.207316e+00 1 1  ON 30
 eO_1                -8.147103e-01 1 1  ON 31
 eO_2                -3.215171e-01 1 1  ON 32
 eO_3                 4.500925e-03 1 1  ON 33
 eO_4                 2.290161e-01 1 1  ON 34
 eO_5                 3.701800e-01 1 1  ON 35
 eO_6                 4.054874e-01 1 1  ON 36
 eO_7                 4.309918e-01 1 1  ON 37
 eO_8                 4.437996e-01 1 1  ON 38
 eO_9                 3.233230e-01 1 1  ON 39
eH1_0                -1.649874e-01 1 1  ON 40
eH1_1                -6.446179e-02 1 1  ON 41
eH1_2                -4.335345e-02 1 1  ON 42
eH1_3                -4.066232e-02 1 1  ON 43
eH1_4                -2.054022e-03 1 1  ON 44
eH1_5                 9.937524e-03 1 1  ON 45
eH1_6                 3.966118e-02 1 1  ON 46
eH1_7                 4.560270e-02 1 1  ON 47
eH1_8                 3.129796e-02 1 1  ON 48
eH1_9                 9.090088e-02 1 1  ON 49
eH2_0                -1.673246e-01 1 1  ON 50
eH2_1                -6.724178e-02 1 1  ON 51
eH2_2                -4.591813e-02 1 1  ON 52
eH2_3                -4.351313e-02 1 1  ON 53
eH2_4                -4.985830e-03 1 1  ON 54
eH2_5                 6.738953e-03 1 1  ON 55
eH2_6                 3.617599e-02 1 1  ON 56
eH2_7                 4.269603e-02 1 1  ON 57
eH2_8                 2.831159e-02 1 1  ON 58
eH2_9                 9.544312e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.5331
    reference variance = 0.313193
====================================================
  Execution time = 4.6123e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5952e-01
  Total weights = 2.0000e+06
  Execution time = 3.8770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559478281020
                                         uncertainty =       0.004765011808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559478281020
                                         uncertainty =       0.004765011808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528921234
  error estimate for blocks of size 2^( 2) =       0.000549942739
  error estimate for blocks of size 2^( 3) =       0.000568677730
  error estimate for blocks of size 2^( 4) =       0.000582880640
  error estimate for blocks of size 2^( 5) =       0.000590302705
  error estimate for blocks of size 2^( 6) =       0.000596177990
  error estimate for blocks of size 2^( 7) =       0.000596630274

      target function =                  N/A
              le_mean =     -22.436346496002
             les_mean =     503.949159152430
             stat err =       0.000591497902
             autocorr =       1.250617243038
              std dev =       0.748007582544
             le_variance =       0.559515343543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559489554233
                                         uncertainty =       0.004765049418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559489554233
                                         uncertainty =       0.004765049418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528926558
  error estimate for blocks of size 2^( 2) =       0.000549947716
  error estimate for blocks of size 2^( 3) =       0.000568682228
  error estimate for blocks of size 2^( 4) =       0.000582884837
  error estimate for blocks of size 2^( 5) =       0.000590306908
  error estimate for blocks of size 2^( 6) =       0.000596182315
  error estimate for blocks of size 2^( 7) =       0.000596634469

      target function =                  N/A
              le_mean =     -22.436346431888
             les_mean =     503.949167540138
             stat err =       0.000591502132
             autocorr =       1.250609951806
              std dev =       0.748015112293
             le_variance =       0.559526608219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559483984870
                                         uncertainty =       0.004765029893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559483984870
                                         uncertainty =       0.004765029893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528923928
  error estimate for blocks of size 2^( 2) =       0.000549945257
  error estimate for blocks of size 2^( 3) =       0.000568680005
  error estimate for blocks of size 2^( 4) =       0.000582882762
  error estimate for blocks of size 2^( 5) =       0.000590304832
  error estimate for blocks of size 2^( 6) =       0.000596180181
  error estimate for blocks of size 2^( 7) =       0.000596632398

      target function =                  N/A
              le_mean =     -22.436346462846
             les_mean =     503.949163364148
             stat err =       0.000591500043
             autocorr =       1.250613556805
              std dev =       0.748011392320
             le_variance =       0.559521043041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559478995888
                                         uncertainty =       0.004765014043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559478995888
                                         uncertainty =       0.004765014043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528921572
  error estimate for blocks of size 2^( 2) =       0.000549943054
  error estimate for blocks of size 2^( 3) =       0.000568678015
  error estimate for blocks of size 2^( 4) =       0.000582880906
  error estimate for blocks of size 2^( 5) =       0.000590302971
  error estimate for blocks of size 2^( 6) =       0.000596178265
  error estimate for blocks of size 2^( 7) =       0.000596630540

      target function =                  N/A
              le_mean =     -22.436346491782
             les_mean =     503.949159677413
             stat err =       0.000591498170
             autocorr =       1.250616780903
              std dev =       0.748008060027
             le_variance =       0.559516057865


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436346496002        initial  <--
     9.7656e+00     9.7656e+01             1.7087e-05       -22.436346431888
     3.9062e+01     3.9062e+02             4.3372e-06       -22.436346462846
     1.5625e+02     1.5625e+03             1.0886e-06       -22.436346491782

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.5163
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.739580e-01 1 1  ON 0
 uu_1                 9.863679e-02 1 1  ON 1
 uu_2                -1.784288e-02 1 1  ON 2
 uu_3                -8.834223e-02 1 1  ON 3
 uu_4                -1.300126e-01 1 1  ON 4
 uu_5                -1.551841e-01 1 1  ON 5
 uu_6                -1.679778e-01 1 1  ON 6
 uu_7                -1.686424e-01 1 1  ON 7
 uu_8                -1.529844e-01 1 1  ON 8
 uu_9                -1.129466e-01 1 1  ON 9
 ud_0                 4.660311e-01 1 1  ON 10
 ud_1                 1.816179e-01 1 1  ON 11
 ud_2                 3.094194e-02 1 1  ON 12
 ud_3                -5.384039e-02 1 1  ON 13
 ud_4                -1.042030e-01 1 1  ON 14
 ud_5                -1.374800e-01 1 1  ON 15
 ud_6                -1.582761e-01 1 1  ON 16
 ud_7                -1.658349e-01 1 1  ON 17
 ud_8                -1.567705e-01 1 1  ON 18
 ud_9                -1.264882e-01 1 1  ON 19
 eC_0                -6.709814e-01 1 1  ON 20
 eC_1                -4.980908e-01 1 1  ON 21
 eC_2                -1.966570e-01 1 1  ON 22
 eC_3                 2.182155e-02 1 1  ON 23
 eC_4                 1.639417e-01 1 1  ON 24
 eC_5                 2.843779e-01 1 1  ON 25
 eC_6                 3.000361e-01 1 1  ON 26
 eC_7                 3.287219e-01 1 1  ON 27
 eC_8                 2.213438e-01 1 1  ON 28
 eC_9                 4.708713e-02 1 1  ON 29
 eO_0                -1.207314e+00 1 1  ON 30
 eO_1                -8.147060e-01 1 1  ON 31
 eO_2                -3.215137e-01 1 1  ON 32
 eO_3                 4.500794e-03 1 1  ON 33
 eO_4                 2.290135e-01 1 1  ON 34
 eO_5                 3.701807e-01 1 1  ON 35
 eO_6                 4.054885e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437988e-01 1 1  ON 38
 eO_9                 3.233193e-01 1 1  ON 39
eH1_0                -1.649884e-01 1 1  ON 40
eH1_1                -6.446596e-02 1 1  ON 41
eH1_2                -4.335218e-02 1 1  ON 42
eH1_3                -4.066454e-02 1 1  ON 43
eH1_4                -2.054745e-03 1 1  ON 44
eH1_5                 9.941569e-03 1 1  ON 45
eH1_6                 3.966118e-02 1 1  ON 46
eH1_7                 4.560428e-02 1 1  ON 47
eH1_8                 3.130032e-02 1 1  ON 48
eH1_9                 9.090219e-02 1 1  ON 49
eH2_0                -1.673263e-01 1 1  ON 50
eH2_1                -6.724327e-02 1 1  ON 51
eH2_2                -4.591619e-02 1 1  ON 52
eH2_3                -4.351361e-02 1 1  ON 53
eH2_4                -4.984459e-03 1 1  ON 54
eH2_5                 6.737642e-03 1 1  ON 55
eH2_6                 3.617641e-02 1 1  ON 56
eH2_7                 4.269632e-02 1 1  ON 57
eH2_8                 2.831347e-02 1 1  ON 58
eH2_9                 9.544406e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2932e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2455e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.4461
    reference variance = 0.531909
====================================================
  Execution time = 4.6739e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6267e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5288e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562556625225
                                         uncertainty =       0.003939803577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562556625225
                                         uncertainty =       0.003939803577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530412664
  error estimate for blocks of size 2^( 2) =       0.000550699520
  error estimate for blocks of size 2^( 3) =       0.000569231096
  error estimate for blocks of size 2^( 4) =       0.000583059888
  error estimate for blocks of size 2^( 5) =       0.000591197820
  error estimate for blocks of size 2^( 6) =       0.000596292263
  error estimate for blocks of size 2^( 7) =       0.000599996187

      target function =                  N/A
              le_mean =     -22.438161399426
             les_mean =     504.033761893025
             stat err =       0.000592636540
             autocorr =       1.248386549543
              std dev =       0.750116782684
             le_variance =       0.562675187665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243816139943e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438161399426       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438161403007       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438161405223       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438161401825       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438161400794       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438161398906       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438161399580       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438161400258       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438161399231       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438161400298       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+01 is 1.865677e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438161399426       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438161400322       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438161400880       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438161400034       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438161399780       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438161399306       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438161399471       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438161399641       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438161399385       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438161399651       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+02 is 4.683300e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438161399426       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438161399650       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438161399790       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438161399579       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438161399515       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438161399397       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438161399437       residual = 9.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438161399478       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438161399416       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438161399489       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+03 is 1.172027e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175013 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5182e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.739579e-01 1 1  ON 0
 uu_1                 9.863676e-02 1 1  ON 1
 uu_2                -1.784280e-02 1 1  ON 2
 uu_3                -8.834221e-02 1 1  ON 3
 uu_4                -1.300129e-01 1 1  ON 4
 uu_5                -1.551841e-01 1 1  ON 5
 uu_6                -1.679779e-01 1 1  ON 6
 uu_7                -1.686422e-01 1 1  ON 7
 uu_8                -1.529845e-01 1 1  ON 8
 uu_9                -1.129464e-01 1 1  ON 9
 ud_0                 4.660311e-01 1 1  ON 10
 ud_1                 1.816180e-01 1 1  ON 11
 ud_2                 3.094201e-02 1 1  ON 12
 ud_3                -5.384041e-02 1 1  ON 13
 ud_4                -1.042026e-01 1 1  ON 14
 ud_5                -1.374801e-01 1 1  ON 15
 ud_6                -1.582756e-01 1 1  ON 16
 ud_7                -1.658351e-01 1 1  ON 17
 ud_8                -1.567708e-01 1 1  ON 18
 ud_9                -1.264882e-01 1 1  ON 19
 eC_0                -6.709818e-01 1 1  ON 20
 eC_1                -4.980909e-01 1 1  ON 21
 eC_2                -1.966570e-01 1 1  ON 22
 eC_3                 2.182168e-02 1 1  ON 23
 eC_4                 1.639419e-01 1 1  ON 24
 eC_5                 2.843781e-01 1 1  ON 25
 eC_6                 3.000359e-01 1 1  ON 26
 eC_7                 3.287217e-01 1 1  ON 27
 eC_8                 2.213441e-01 1 1  ON 28
 eC_9                 4.708725e-02 1 1  ON 29
 eO_0                -1.207314e+00 1 1  ON 30
 eO_1                -8.147061e-01 1 1  ON 31
 eO_2                -3.215141e-01 1 1  ON 32
 eO_3                 4.500601e-03 1 1  ON 33
 eO_4                 2.290134e-01 1 1  ON 34
 eO_5                 3.701807e-01 1 1  ON 35
 eO_6                 4.054887e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437988e-01 1 1  ON 38
 eO_9                 3.233197e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446592e-02 1 1  ON 41
eH1_2                -4.335224e-02 1 1  ON 42
eH1_3                -4.066458e-02 1 1  ON 43
eH1_4                -2.054803e-03 1 1  ON 44
eH1_5                 9.941197e-03 1 1  ON 45
eH1_6                 3.966155e-02 1 1  ON 46
eH1_7                 4.560434e-02 1 1  ON 47
eH1_8                 3.130018e-02 1 1  ON 48
eH1_9                 9.090205e-02 1 1  ON 49
eH2_0                -1.673264e-01 1 1  ON 50
eH2_1                -6.724311e-02 1 1  ON 51
eH2_2                -4.591607e-02 1 1  ON 52
eH2_3                -4.351332e-02 1 1  ON 53
eH2_4                -4.984584e-03 1 1  ON 54
eH2_5                 6.737461e-03 1 1  ON 55
eH2_6                 3.617643e-02 1 1  ON 56
eH2_7                 4.269614e-02 1 1  ON 57
eH2_8                 2.831334e-02 1 1  ON 58
eH2_9                 9.544396e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.3986
    reference variance = 0.355152
====================================================
  Execution time = 4.5400e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6207e-01
  Total weights = 2.0000e+06
  Execution time = 3.8700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562204475741
                                         uncertainty =       0.004238649446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562204475741
                                         uncertainty =       0.004238649446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530128911
  error estimate for blocks of size 2^( 2) =       0.000550053845
  error estimate for blocks of size 2^( 3) =       0.000568650294
  error estimate for blocks of size 2^( 4) =       0.000583641876
  error estimate for blocks of size 2^( 5) =       0.000592665311
  error estimate for blocks of size 2^( 6) =       0.000598407160
  error estimate for blocks of size 2^( 7) =       0.000598850642

      target function =                  N/A
              le_mean =     -22.437141890851
             les_mean =     503.987409274065
             stat err =       0.000593391247
             autocorr =       1.252908319364
              std dev =       0.749715495973
             le_variance =       0.562073324901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562204085604
                                         uncertainty =       0.004238652828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562204085604
                                         uncertainty =       0.004238652828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530128728
  error estimate for blocks of size 2^( 2) =       0.000550053656
  error estimate for blocks of size 2^( 3) =       0.000568650090
  error estimate for blocks of size 2^( 4) =       0.000583641662
  error estimate for blocks of size 2^( 5) =       0.000592665139
  error estimate for blocks of size 2^( 6) =       0.000598407021
  error estimate for blocks of size 2^( 7) =       0.000598850460

      target function =                  N/A
              le_mean =     -22.437141876360
             les_mean =     503.987408234873
             stat err =       0.000593391071
             autocorr =       1.252908439936
              std dev =       0.749715236615
             le_variance =       0.562072936012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562204279747
                                         uncertainty =       0.004238651146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562204279747
                                         uncertainty =       0.004238651146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530128819
  error estimate for blocks of size 2^( 2) =       0.000550053750
  error estimate for blocks of size 2^( 3) =       0.000568650191
  error estimate for blocks of size 2^( 4) =       0.000583641769
  error estimate for blocks of size 2^( 5) =       0.000592665225
  error estimate for blocks of size 2^( 6) =       0.000598407091
  error estimate for blocks of size 2^( 7) =       0.000598850551

      target function =                  N/A
              le_mean =     -22.437141883577
             les_mean =     503.987408752245
             stat err =       0.000593391159
             autocorr =       1.252908380055
              std dev =       0.749715365679
             le_variance =       0.562073129535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562204451208
                                         uncertainty =       0.004238649659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562204451208
                                         uncertainty =       0.004238649659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530128900
  error estimate for blocks of size 2^( 2) =       0.000550053833
  error estimate for blocks of size 2^( 3) =       0.000568650281
  error estimate for blocks of size 2^( 4) =       0.000583641863
  error estimate for blocks of size 2^( 5) =       0.000592665300
  error estimate for blocks of size 2^( 6) =       0.000598407152
  error estimate for blocks of size 2^( 7) =       0.000598850631

      target function =                  N/A
              le_mean =     -22.437141889941
             les_mean =     503.987409208737
             stat err =       0.000593391236
             autocorr =       1.252908326966
              std dev =       0.749715479663
             le_variance =       0.562073300447


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437141890851        initial  <--
     9.7656e+01     9.7656e+02             1.8657e-06       -22.437141876360
     3.9062e+02     3.9062e+03             4.6833e-07       -22.437141883577
     1.5625e+03     1.5625e+04             1.1720e-07       -22.437141889941

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.7556
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.739580e-01 1 1  ON 0
 uu_1                 9.863679e-02 1 1  ON 1
 uu_2                -1.784288e-02 1 1  ON 2
 uu_3                -8.834223e-02 1 1  ON 3
 uu_4                -1.300126e-01 1 1  ON 4
 uu_5                -1.551841e-01 1 1  ON 5
 uu_6                -1.679778e-01 1 1  ON 6
 uu_7                -1.686424e-01 1 1  ON 7
 uu_8                -1.529844e-01 1 1  ON 8
 uu_9                -1.129466e-01 1 1  ON 9
 ud_0                 4.660311e-01 1 1  ON 10
 ud_1                 1.816179e-01 1 1  ON 11
 ud_2                 3.094194e-02 1 1  ON 12
 ud_3                -5.384039e-02 1 1  ON 13
 ud_4                -1.042030e-01 1 1  ON 14
 ud_5                -1.374800e-01 1 1  ON 15
 ud_6                -1.582761e-01 1 1  ON 16
 ud_7                -1.658349e-01 1 1  ON 17
 ud_8                -1.567705e-01 1 1  ON 18
 ud_9                -1.264882e-01 1 1  ON 19
 eC_0                -6.709814e-01 1 1  ON 20
 eC_1                -4.980908e-01 1 1  ON 21
 eC_2                -1.966570e-01 1 1  ON 22
 eC_3                 2.182155e-02 1 1  ON 23
 eC_4                 1.639417e-01 1 1  ON 24
 eC_5                 2.843779e-01 1 1  ON 25
 eC_6                 3.000361e-01 1 1  ON 26
 eC_7                 3.287219e-01 1 1  ON 27
 eC_8                 2.213438e-01 1 1  ON 28
 eC_9                 4.708713e-02 1 1  ON 29
 eO_0                -1.207314e+00 1 1  ON 30
 eO_1                -8.147060e-01 1 1  ON 31
 eO_2                -3.215137e-01 1 1  ON 32
 eO_3                 4.500794e-03 1 1  ON 33
 eO_4                 2.290135e-01 1 1  ON 34
 eO_5                 3.701807e-01 1 1  ON 35
 eO_6                 4.054885e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437988e-01 1 1  ON 38
 eO_9                 3.233193e-01 1 1  ON 39
eH1_0                -1.649884e-01 1 1  ON 40
eH1_1                -6.446596e-02 1 1  ON 41
eH1_2                -4.335218e-02 1 1  ON 42
eH1_3                -4.066454e-02 1 1  ON 43
eH1_4                -2.054745e-03 1 1  ON 44
eH1_5                 9.941569e-03 1 1  ON 45
eH1_6                 3.966118e-02 1 1  ON 46
eH1_7                 4.560428e-02 1 1  ON 47
eH1_8                 3.130032e-02 1 1  ON 48
eH1_9                 9.090219e-02 1 1  ON 49
eH2_0                -1.673263e-01 1 1  ON 50
eH2_1                -6.724327e-02 1 1  ON 51
eH2_2                -4.591619e-02 1 1  ON 52
eH2_3                -4.351361e-02 1 1  ON 53
eH2_4                -4.984459e-03 1 1  ON 54
eH2_5                 6.737642e-03 1 1  ON 55
eH2_6                 3.617641e-02 1 1  ON 56
eH2_7                 4.269632e-02 1 1  ON 57
eH2_8                 2.831347e-02 1 1  ON 58
eH2_9                 9.544406e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2996e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2452e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.4372
    reference variance = 0.320153
====================================================
  Execution time = 4.6423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6993e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5459e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570065661082
                                         uncertainty =       0.005097151162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570065661082
                                         uncertainty =       0.005097151162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533819403
  error estimate for blocks of size 2^( 2) =       0.000553956022
  error estimate for blocks of size 2^( 3) =       0.000572888981
  error estimate for blocks of size 2^( 4) =       0.000586586397
  error estimate for blocks of size 2^( 5) =       0.000596003842
  error estimate for blocks of size 2^( 6) =       0.000599951067
  error estimate for blocks of size 2^( 7) =       0.000603800069

      target function =                  N/A
              le_mean =     -22.437789302514
             les_mean =     504.024314809274
             stat err =       0.000596585344
             autocorr =       1.248982775039
              std dev =       0.754934639719
             le_variance =       0.569926310248


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243778930251e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437789302514       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437789303206       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437789303611       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437789303986       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437789304032       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437789304022       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437789304135       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437789304042       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437789304079       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437789304134       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+02 is 2.735262e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437789302514       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437789302687       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437789302788       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437789302882       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437789302893       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437789302890       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437789302918       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437789302896       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437789302908       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437789302918       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+03 is 6.839242e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437789302514       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437789302557       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437789302582       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437789302606       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437789302608       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437789302621       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437789302635       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437789302623       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437789302627       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437789302715       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+04 is 1.709878e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178536 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1890e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.739580e-01 1 1  ON 0
 uu_1                 9.863679e-02 1 1  ON 1
 uu_2                -1.784290e-02 1 1  ON 2
 uu_3                -8.834226e-02 1 1  ON 3
 uu_4                -1.300127e-01 1 1  ON 4
 uu_5                -1.551841e-01 1 1  ON 5
 uu_6                -1.679778e-01 1 1  ON 6
 uu_7                -1.686424e-01 1 1  ON 7
 uu_8                -1.529844e-01 1 1  ON 8
 uu_9                -1.129466e-01 1 1  ON 9
 ud_0                 4.660311e-01 1 1  ON 10
 ud_1                 1.816179e-01 1 1  ON 11
 ud_2                 3.094193e-02 1 1  ON 12
 ud_3                -5.384039e-02 1 1  ON 13
 ud_4                -1.042030e-01 1 1  ON 14
 ud_5                -1.374800e-01 1 1  ON 15
 ud_6                -1.582761e-01 1 1  ON 16
 ud_7                -1.658350e-01 1 1  ON 17
 ud_8                -1.567705e-01 1 1  ON 18
 ud_9                -1.264881e-01 1 1  ON 19
 eC_0                -6.709814e-01 1 1  ON 20
 eC_1                -4.980908e-01 1 1  ON 21
 eC_2                -1.966570e-01 1 1  ON 22
 eC_3                 2.182154e-02 1 1  ON 23
 eC_4                 1.639418e-01 1 1  ON 24
 eC_5                 2.843779e-01 1 1  ON 25
 eC_6                 3.000360e-01 1 1  ON 26
 eC_7                 3.287219e-01 1 1  ON 27
 eC_8                 2.213439e-01 1 1  ON 28
 eC_9                 4.708714e-02 1 1  ON 29
 eO_0                -1.207314e+00 1 1  ON 30
 eO_1                -8.147060e-01 1 1  ON 31
 eO_2                -3.215138e-01 1 1  ON 32
 eO_3                 4.500773e-03 1 1  ON 33
 eO_4                 2.290135e-01 1 1  ON 34
 eO_5                 3.701807e-01 1 1  ON 35
 eO_6                 4.054885e-01 1 1  ON 36
 eO_7                 4.309904e-01 1 1  ON 37
 eO_8                 4.437988e-01 1 1  ON 38
 eO_9                 3.233194e-01 1 1  ON 39
eH1_0                -1.649884e-01 1 1  ON 40
eH1_1                -6.446596e-02 1 1  ON 41
eH1_2                -4.335217e-02 1 1  ON 42
eH1_3                -4.066454e-02 1 1  ON 43
eH1_4                -2.054745e-03 1 1  ON 44
eH1_5                 9.941557e-03 1 1  ON 45
eH1_6                 3.966118e-02 1 1  ON 46
eH1_7                 4.560427e-02 1 1  ON 47
eH1_8                 3.130031e-02 1 1  ON 48
eH1_9                 9.090219e-02 1 1  ON 49
eH2_0                -1.673263e-01 1 1  ON 50
eH2_1                -6.724327e-02 1 1  ON 51
eH2_2                -4.591619e-02 1 1  ON 52
eH2_3                -4.351365e-02 1 1  ON 53
eH2_4                -4.984451e-03 1 1  ON 54
eH2_5                 6.737641e-03 1 1  ON 55
eH2_6                 3.617644e-02 1 1  ON 56
eH2_7                 4.269631e-02 1 1  ON 57
eH2_8                 2.831346e-02 1 1  ON 58
eH2_9                 9.544406e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.4484
    reference variance = 0.761154
====================================================
  Execution time = 4.7178e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7518e-01
  Total weights = 2.0000e+06
  Execution time = 3.8704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574839483520
                                         uncertainty =       0.007293802628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574839483520
                                         uncertainty =       0.007293802628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536274894
  error estimate for blocks of size 2^( 2) =       0.000556353684
  error estimate for blocks of size 2^( 3) =       0.000574655990
  error estimate for blocks of size 2^( 4) =       0.000588986211
  error estimate for blocks of size 2^( 5) =       0.000597221210
  error estimate for blocks of size 2^( 6) =       0.000600000969
  error estimate for blocks of size 2^( 7) =       0.000603924450

      target function =                  N/A
              le_mean =     -22.438312574389
             les_mean =     504.053052423110
             stat err =       0.000597533210
             autocorr =       1.241506973050
              std dev =       0.758407228800
             le_variance =       0.575181524697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574839628904
                                         uncertainty =       0.007293805450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574839628904
                                         uncertainty =       0.007293805450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536274962
  error estimate for blocks of size 2^( 2) =       0.000556353748
  error estimate for blocks of size 2^( 3) =       0.000574656049
  error estimate for blocks of size 2^( 4) =       0.000588986267
  error estimate for blocks of size 2^( 5) =       0.000597221260
  error estimate for blocks of size 2^( 6) =       0.000600001015
  error estimate for blocks of size 2^( 7) =       0.000603924497

      target function =                  N/A
              le_mean =     -22.438312575237
             les_mean =     504.053052606883
             stat err =       0.000597533260
             autocorr =       1.241506865319
              std dev =       0.758407324893
             le_variance =       0.575181670451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574839556229
                                         uncertainty =       0.007293804039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574839556229
                                         uncertainty =       0.007293804039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536274928
  error estimate for blocks of size 2^( 2) =       0.000556353716
  error estimate for blocks of size 2^( 3) =       0.000574656019
  error estimate for blocks of size 2^( 4) =       0.000588986239
  error estimate for blocks of size 2^( 5) =       0.000597221235
  error estimate for blocks of size 2^( 6) =       0.000600000992
  error estimate for blocks of size 2^( 7) =       0.000603924473

      target function =                  N/A
              le_mean =     -22.438312574813
             les_mean =     504.053052515021
             stat err =       0.000597533235
             autocorr =       1.241506919159
              std dev =       0.758407276858
             le_variance =       0.575181597591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574839492610
                                         uncertainty =       0.007293802804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574839492610
                                         uncertainty =       0.007293802804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536274899
  error estimate for blocks of size 2^( 2) =       0.000556353688
  error estimate for blocks of size 2^( 3) =       0.000574655994
  error estimate for blocks of size 2^( 4) =       0.000588986214
  error estimate for blocks of size 2^( 5) =       0.000597221213
  error estimate for blocks of size 2^( 6) =       0.000600000972
  error estimate for blocks of size 2^( 7) =       0.000603924453

      target function =                  N/A
              le_mean =     -22.438312574442
             les_mean =     504.053052434599
             stat err =       0.000597533213
             autocorr =       1.241506966311
              std dev =       0.758407234808
             le_variance =       0.575181533809


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.438312574389        initial
     9.7656e+02     9.7656e+03             2.7353e-07       -22.438312575237  <--
     3.9062e+03     3.9062e+04             6.8392e-08       -22.438312574813
     1.5625e+04     1.5625e+05             1.7099e-08       -22.438312574442

*****************************************************************************
Applying the update for shift_i =   9.7656e+02     and shift_s =   9.7656e+03
*****************************************************************************

  Execution time = 6.6518e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.739580e-01 1 1  ON 0
 uu_1                 9.863678e-02 1 1  ON 1
 uu_2                -1.784296e-02 1 1  ON 2
 uu_3                -8.834234e-02 1 1  ON 3
 uu_4                -1.300127e-01 1 1  ON 4
 uu_5                -1.551841e-01 1 1  ON 5
 uu_6                -1.679778e-01 1 1  ON 6
 uu_7                -1.686422e-01 1 1  ON 7
 uu_8                -1.529843e-01 1 1  ON 8
 uu_9                -1.129466e-01 1 1  ON 9
 ud_0                 4.660311e-01 1 1  ON 10
 ud_1                 1.816180e-01 1 1  ON 11
 ud_2                 3.094191e-02 1 1  ON 12
 ud_3                -5.384038e-02 1 1  ON 13
 ud_4                -1.042029e-01 1 1  ON 14
 ud_5                -1.374800e-01 1 1  ON 15
 ud_6                -1.582760e-01 1 1  ON 16
 ud_7                -1.658352e-01 1 1  ON 17
 ud_8                -1.567705e-01 1 1  ON 18
 ud_9                -1.264880e-01 1 1  ON 19
 eC_0                -6.709816e-01 1 1  ON 20
 eC_1                -4.980908e-01 1 1  ON 21
 eC_2                -1.966570e-01 1 1  ON 22
 eC_3                 2.182153e-02 1 1  ON 23
 eC_4                 1.639418e-01 1 1  ON 24
 eC_5                 2.843779e-01 1 1  ON 25
 eC_6                 3.000360e-01 1 1  ON 26
 eC_7                 3.287219e-01 1 1  ON 27
 eC_8                 2.213440e-01 1 1  ON 28
 eC_9                 4.708719e-02 1 1  ON 29
 eO_0                -1.207314e+00 1 1  ON 30
 eO_1                -8.147061e-01 1 1  ON 31
 eO_2                -3.215138e-01 1 1  ON 32
 eO_3                 4.500712e-03 1 1  ON 33
 eO_4                 2.290135e-01 1 1  ON 34
 eO_5                 3.701807e-01 1 1  ON 35
 eO_6                 4.054885e-01 1 1  ON 36
 eO_7                 4.309904e-01 1 1  ON 37
 eO_8                 4.437988e-01 1 1  ON 38
 eO_9                 3.233195e-01 1 1  ON 39
eH1_0                -1.649884e-01 1 1  ON 40
eH1_1                -6.446597e-02 1 1  ON 41
eH1_2                -4.335215e-02 1 1  ON 42
eH1_3                -4.066451e-02 1 1  ON 43
eH1_4                -2.054744e-03 1 1  ON 44
eH1_5                 9.941524e-03 1 1  ON 45
eH1_6                 3.966116e-02 1 1  ON 46
eH1_7                 4.560425e-02 1 1  ON 47
eH1_8                 3.130028e-02 1 1  ON 48
eH1_9                 9.090218e-02 1 1  ON 49
eH2_0                -1.673263e-01 1 1  ON 50
eH2_1                -6.724325e-02 1 1  ON 51
eH2_2                -4.591620e-02 1 1  ON 52
eH2_3                -4.351375e-02 1 1  ON 53
eH2_4                -4.984428e-03 1 1  ON 54
eH2_5                 6.737637e-03 1 1  ON 55
eH2_6                 3.617654e-02 1 1  ON 56
eH2_7                 4.269626e-02 1 1  ON 57
eH2_8                 2.831344e-02 1 1  ON 58
eH2_9                 9.544405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2842e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2451e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.4388
    reference variance = 0.290958
====================================================
  Execution time = 4.6304e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.5953e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5318e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559353177683
                                         uncertainty =       0.004060621101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559353177683
                                         uncertainty =       0.004060621101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528929909
  error estimate for blocks of size 2^( 2) =       0.000549588553
  error estimate for blocks of size 2^( 3) =       0.000568629231
  error estimate for blocks of size 2^( 4) =       0.000583054202
  error estimate for blocks of size 2^( 5) =       0.000590999317
  error estimate for blocks of size 2^( 6) =       0.000595256890
  error estimate for blocks of size 2^( 7) =       0.000598355709

      target function =                  N/A
              le_mean =     -22.437647425018
             les_mean =     504.007555387934
             stat err =       0.000591916530
             autocorr =       1.252347013262
              std dev =       0.748019851541
             le_variance =       0.559533698299


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243764742502e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437647425018       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437647428829       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437647427343       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437647427490       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437647426755       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437647427208       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437647427805       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437647426697       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437647426308       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437647426593       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+02 is 9.260507e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437647425018       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437647425971       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437647425600       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437647425636       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437647425453       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437647425566       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437647425711       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437647425436       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437647425340       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437647425414       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+02 is 2.316245e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437647425018       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437647425256       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437647425163       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437647425173       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437647425127       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437647425156       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437647425177       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437647425130       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437647425094       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437647425111       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+03 is 5.791311e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182097 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1631e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.739579e-01 1 1  ON 0
 uu_1                 9.863673e-02 1 1  ON 1
 uu_2                -1.784301e-02 1 1  ON 2
 uu_3                -8.834237e-02 1 1  ON 3
 uu_4                -1.300127e-01 1 1  ON 4
 uu_5                -1.551843e-01 1 1  ON 5
 uu_6                -1.679778e-01 1 1  ON 6
 uu_7                -1.686422e-01 1 1  ON 7
 uu_8                -1.529843e-01 1 1  ON 8
 uu_9                -1.129465e-01 1 1  ON 9
 ud_0                 4.660311e-01 1 1  ON 10
 ud_1                 1.816181e-01 1 1  ON 11
 ud_2                 3.094189e-02 1 1  ON 12
 ud_3                -5.384040e-02 1 1  ON 13
 ud_4                -1.042029e-01 1 1  ON 14
 ud_5                -1.374801e-01 1 1  ON 15
 ud_6                -1.582760e-01 1 1  ON 16
 ud_7                -1.658352e-01 1 1  ON 17
 ud_8                -1.567705e-01 1 1  ON 18
 ud_9                -1.264879e-01 1 1  ON 19
 eC_0                -6.709817e-01 1 1  ON 20
 eC_1                -4.980908e-01 1 1  ON 21
 eC_2                -1.966571e-01 1 1  ON 22
 eC_3                 2.182164e-02 1 1  ON 23
 eC_4                 1.639417e-01 1 1  ON 24
 eC_5                 2.843779e-01 1 1  ON 25
 eC_6                 3.000360e-01 1 1  ON 26
 eC_7                 3.287219e-01 1 1  ON 27
 eC_8                 2.213441e-01 1 1  ON 28
 eC_9                 4.708724e-02 1 1  ON 29
 eO_0                -1.207314e+00 1 1  ON 30
 eO_1                -8.147063e-01 1 1  ON 31
 eO_2                -3.215139e-01 1 1  ON 32
 eO_3                 4.500617e-03 1 1  ON 33
 eO_4                 2.290136e-01 1 1  ON 34
 eO_5                 3.701807e-01 1 1  ON 35
 eO_6                 4.054885e-01 1 1  ON 36
 eO_7                 4.309904e-01 1 1  ON 37
 eO_8                 4.437988e-01 1 1  ON 38
 eO_9                 3.233196e-01 1 1  ON 39
eH1_0                -1.649884e-01 1 1  ON 40
eH1_1                -6.446588e-02 1 1  ON 41
eH1_2                -4.335211e-02 1 1  ON 42
eH1_3                -4.066441e-02 1 1  ON 43
eH1_4                -2.054817e-03 1 1  ON 44
eH1_5                 9.941293e-03 1 1  ON 45
eH1_6                 3.966117e-02 1 1  ON 46
eH1_7                 4.560427e-02 1 1  ON 47
eH1_8                 3.130027e-02 1 1  ON 48
eH1_9                 9.090213e-02 1 1  ON 49
eH2_0                -1.673262e-01 1 1  ON 50
eH2_1                -6.724328e-02 1 1  ON 51
eH2_2                -4.591642e-02 1 1  ON 52
eH2_3                -4.351371e-02 1 1  ON 53
eH2_4                -4.984443e-03 1 1  ON 54
eH2_5                 6.737645e-03 1 1  ON 55
eH2_6                 3.617663e-02 1 1  ON 56
eH2_7                 4.269622e-02 1 1  ON 57
eH2_8                 2.831345e-02 1 1  ON 58
eH2_9                 9.544404e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.5323
    reference variance = 0.76743
====================================================
  Execution time = 4.7300e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7322e-01
  Total weights = 2.0000e+06
  Execution time = 3.8683e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573308986428
                                         uncertainty =       0.006289773015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573308986428
                                         uncertainty =       0.006289773015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535360286
  error estimate for blocks of size 2^( 2) =       0.000555203257
  error estimate for blocks of size 2^( 3) =       0.000573851767
  error estimate for blocks of size 2^( 4) =       0.000588503515
  error estimate for blocks of size 2^( 5) =       0.000596935823
  error estimate for blocks of size 2^( 6) =       0.000601348036
  error estimate for blocks of size 2^( 7) =       0.000607702484

      target function =                  N/A
              le_mean =     -22.436929408480
             les_mean =     503.989022267114
             stat err =       0.000598622465
             autocorr =       1.250298523152
              std dev =       0.757113777844
             le_variance =       0.573221272602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573308814063
                                         uncertainty =       0.006289768914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573308814063
                                         uncertainty =       0.006289768914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535360206
  error estimate for blocks of size 2^( 2) =       0.000555203185
  error estimate for blocks of size 2^( 3) =       0.000573851693
  error estimate for blocks of size 2^( 4) =       0.000588503431
  error estimate for blocks of size 2^( 5) =       0.000596935739
  error estimate for blocks of size 2^( 6) =       0.000601347977
  error estimate for blocks of size 2^( 7) =       0.000607702417

      target function =                  N/A
              le_mean =     -22.436929413159
             les_mean =     503.989022304874
             stat err =       0.000598622391
             autocorr =       1.250298590780
              std dev =       0.757113664122
             le_variance =       0.573221100400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573308900012
                                         uncertainty =       0.006289770957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573308900012
                                         uncertainty =       0.006289770957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535360246
  error estimate for blocks of size 2^( 2) =       0.000555203221
  error estimate for blocks of size 2^( 3) =       0.000573851730
  error estimate for blocks of size 2^( 4) =       0.000588503473
  error estimate for blocks of size 2^( 5) =       0.000596935781
  error estimate for blocks of size 2^( 6) =       0.000601348006
  error estimate for blocks of size 2^( 7) =       0.000607702451

      target function =                  N/A
              le_mean =     -22.436929410823
             les_mean =     503.989022285925
             stat err =       0.000598622428
             autocorr =       1.250298557071
              std dev =       0.757113720829
             le_variance =       0.573221186267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573308975618
                                         uncertainty =       0.006289772758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573308975618
                                         uncertainty =       0.006289772758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535360281
  error estimate for blocks of size 2^( 2) =       0.000555203252
  error estimate for blocks of size 2^( 3) =       0.000573851762
  error estimate for blocks of size 2^( 4) =       0.000588503510
  error estimate for blocks of size 2^( 5) =       0.000596935818
  error estimate for blocks of size 2^( 6) =       0.000601348032
  error estimate for blocks of size 2^( 7) =       0.000607702480

      target function =                  N/A
              le_mean =     -22.436929408773
             les_mean =     503.989022269459
             stat err =       0.000598622460
             autocorr =       1.250298527396
              std dev =       0.757113770712
             le_variance =       0.573221261802


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436929408480        initial
     2.4414e+02     2.4414e+03             9.2605e-07       -22.436929413159  <--
     9.7656e+02     9.7656e+03             2.3162e-07       -22.436929410823
     3.9062e+03     3.9062e+04             5.7913e-08       -22.436929408773

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 6.6641e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.739577e-01 1 1  ON 0
 uu_1                 9.863661e-02 1 1  ON 1
 uu_2                -1.784317e-02 1 1  ON 2
 uu_3                -8.834247e-02 1 1  ON 3
 uu_4                -1.300127e-01 1 1  ON 4
 uu_5                -1.551847e-01 1 1  ON 5
 uu_6                -1.679779e-01 1 1  ON 6
 uu_7                -1.686423e-01 1 1  ON 7
 uu_8                -1.529840e-01 1 1  ON 8
 uu_9                -1.129462e-01 1 1  ON 9
 ud_0                 4.660309e-01 1 1  ON 10
 ud_1                 1.816183e-01 1 1  ON 11
 ud_2                 3.094182e-02 1 1  ON 12
 ud_3                -5.384047e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374804e-01 1 1  ON 15
 ud_6                -1.582759e-01 1 1  ON 16
 ud_7                -1.658351e-01 1 1  ON 17
 ud_8                -1.567705e-01 1 1  ON 18
 ud_9                -1.264875e-01 1 1  ON 19
 eC_0                -6.709823e-01 1 1  ON 20
 eC_1                -4.980907e-01 1 1  ON 21
 eC_2                -1.966573e-01 1 1  ON 22
 eC_3                 2.182198e-02 1 1  ON 23
 eC_4                 1.639417e-01 1 1  ON 24
 eC_5                 2.843779e-01 1 1  ON 25
 eC_6                 3.000359e-01 1 1  ON 26
 eC_7                 3.287219e-01 1 1  ON 27
 eC_8                 2.213445e-01 1 1  ON 28
 eC_9                 4.708740e-02 1 1  ON 29
 eO_0                -1.207314e+00 1 1  ON 30
 eO_1                -8.147066e-01 1 1  ON 31
 eO_2                -3.215143e-01 1 1  ON 32
 eO_3                 4.500332e-03 1 1  ON 33
 eO_4                 2.290139e-01 1 1  ON 34
 eO_5                 3.701808e-01 1 1  ON 35
 eO_6                 4.054883e-01 1 1  ON 36
 eO_7                 4.309905e-01 1 1  ON 37
 eO_8                 4.437989e-01 1 1  ON 38
 eO_9                 3.233201e-01 1 1  ON 39
eH1_0                -1.649883e-01 1 1  ON 40
eH1_1                -6.446560e-02 1 1  ON 41
eH1_2                -4.335199e-02 1 1  ON 42
eH1_3                -4.066409e-02 1 1  ON 43
eH1_4                -2.055034e-03 1 1  ON 44
eH1_5                 9.940598e-03 1 1  ON 45
eH1_6                 3.966120e-02 1 1  ON 46
eH1_7                 4.560432e-02 1 1  ON 47
eH1_8                 3.130024e-02 1 1  ON 48
eH1_9                 9.090198e-02 1 1  ON 49
eH2_0                -1.673259e-01 1 1  ON 50
eH2_1                -6.724337e-02 1 1  ON 51
eH2_2                -4.591709e-02 1 1  ON 52
eH2_3                -4.351357e-02 1 1  ON 53
eH2_4                -4.984490e-03 1 1  ON 54
eH2_5                 6.737671e-03 1 1  ON 55
eH2_6                 3.617691e-02 1 1  ON 56
eH2_7                 4.269609e-02 1 1  ON 57
eH2_8                 2.831348e-02 1 1  ON 58
eH2_9                 9.544399e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2829e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2454e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.421
    reference variance = 0.58731
====================================================
  Execution time = 4.5712e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6888e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5251e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568971944919
                                         uncertainty =       0.006926872116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568971944919
                                         uncertainty =       0.006926872116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533328297
  error estimate for blocks of size 2^( 2) =       0.000553230011
  error estimate for blocks of size 2^( 3) =       0.000572768763
  error estimate for blocks of size 2^( 4) =       0.000586038536
  error estimate for blocks of size 2^( 5) =       0.000594262138
  error estimate for blocks of size 2^( 6) =       0.000598374660
  error estimate for blocks of size 2^( 7) =       0.000599122538

      target function =                  N/A
              le_mean =     -22.437240200587
             les_mean =     503.998625678206
             stat err =       0.000594449468
             autocorr =       1.242340469655
              std dev =       0.754240110191
             le_variance =       0.568878143820


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243724020059e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437240200587       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437240216984       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437240216182       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437240212523       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437240212248       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437240214050       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437240221384       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437240221049       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437240221024       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437240222137       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+01 is 4.565263e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437240200587       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437240204699       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437240204499       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437240203585       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437240203512       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437240203960       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437240205802       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437240205719       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437240205716       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437240205995       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+02 is 1.143912e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437240200587       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437240201616       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437240201566       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437240201337       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437240201319       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437240201429       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437240201892       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437240201869       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437240201871       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437240201938       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+02 is 2.861408e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185789 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0971e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.739577e-01 1 1  ON 0
 uu_1                 9.863650e-02 1 1  ON 1
 uu_2                -1.784335e-02 1 1  ON 2
 uu_3                -8.834225e-02 1 1  ON 3
 uu_4                -1.300127e-01 1 1  ON 4
 uu_5                -1.551846e-01 1 1  ON 5
 uu_6                -1.679785e-01 1 1  ON 6
 uu_7                -1.686413e-01 1 1  ON 7
 uu_8                -1.529840e-01 1 1  ON 8
 uu_9                -1.129465e-01 1 1  ON 9
 ud_0                 4.660316e-01 1 1  ON 10
 ud_1                 1.816188e-01 1 1  ON 11
 ud_2                 3.094203e-02 1 1  ON 12
 ud_3                -5.384051e-02 1 1  ON 13
 ud_4                -1.042030e-01 1 1  ON 14
 ud_5                -1.374808e-01 1 1  ON 15
 ud_6                -1.582751e-01 1 1  ON 16
 ud_7                -1.658352e-01 1 1  ON 17
 ud_8                -1.567707e-01 1 1  ON 18
 ud_9                -1.264880e-01 1 1  ON 19
 eC_0                -6.709828e-01 1 1  ON 20
 eC_1                -4.980909e-01 1 1  ON 21
 eC_2                -1.966577e-01 1 1  ON 22
 eC_3                 2.182217e-02 1 1  ON 23
 eC_4                 1.639424e-01 1 1  ON 24
 eC_5                 2.843778e-01 1 1  ON 25
 eC_6                 3.000358e-01 1 1  ON 26
 eC_7                 3.287216e-01 1 1  ON 27
 eC_8                 2.213449e-01 1 1  ON 28
 eC_9                 4.708757e-02 1 1  ON 29
 eO_0                -1.207315e+00 1 1  ON 30
 eO_1                -8.147073e-01 1 1  ON 31
 eO_2                -3.215145e-01 1 1  ON 32
 eO_3                 4.499881e-03 1 1  ON 33
 eO_4                 2.290150e-01 1 1  ON 34
 eO_5                 3.701805e-01 1 1  ON 35
 eO_6                 4.054878e-01 1 1  ON 36
 eO_7                 4.309909e-01 1 1  ON 37
 eO_8                 4.437990e-01 1 1  ON 38
 eO_9                 3.233206e-01 1 1  ON 39
eH1_0                -1.649884e-01 1 1  ON 40
eH1_1                -6.446600e-02 1 1  ON 41
eH1_2                -4.335171e-02 1 1  ON 42
eH1_3                -4.066388e-02 1 1  ON 43
eH1_4                -2.055087e-03 1 1  ON 44
eH1_5                 9.940651e-03 1 1  ON 45
eH1_6                 3.966117e-02 1 1  ON 46
eH1_7                 4.560428e-02 1 1  ON 47
eH1_8                 3.130017e-02 1 1  ON 48
eH1_9                 9.090185e-02 1 1  ON 49
eH2_0                -1.673257e-01 1 1  ON 50
eH2_1                -6.724399e-02 1 1  ON 51
eH2_2                -4.591703e-02 1 1  ON 52
eH2_3                -4.351321e-02 1 1  ON 53
eH2_4                -4.984404e-03 1 1  ON 54
eH2_5                 6.737503e-03 1 1  ON 55
eH2_6                 3.617733e-02 1 1  ON 56
eH2_7                 4.269596e-02 1 1  ON 57
eH2_8                 2.831322e-02 1 1  ON 58
eH2_9                 9.544379e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.3936
    reference variance = 0.514672
====================================================
  Execution time = 4.5410e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7184e-01
  Total weights = 2.0000e+06
  Execution time = 3.8866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571894009773
                                         uncertainty =       0.011588222963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571894009773
                                         uncertainty =       0.011588222963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534715120
  error estimate for blocks of size 2^( 2) =       0.000555009639
  error estimate for blocks of size 2^( 3) =       0.000573583451
  error estimate for blocks of size 2^( 4) =       0.000587445652
  error estimate for blocks of size 2^( 5) =       0.000596019982
  error estimate for blocks of size 2^( 6) =       0.000599267924
  error estimate for blocks of size 2^( 7) =       0.000598381849

      target function =                  N/A
              le_mean =     -22.437964918649
             les_mean =     504.034109923396
             stat err =       0.000595278852
             autocorr =       1.239355727647
              std dev =       0.756201374507
             le_variance =       0.571840518806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571897022388
                                         uncertainty =       0.011588177637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571897022388
                                         uncertainty =       0.011588177637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534716528
  error estimate for blocks of size 2^( 2) =       0.000555010977
  error estimate for blocks of size 2^( 3) =       0.000573584662
  error estimate for blocks of size 2^( 4) =       0.000587446751
  error estimate for blocks of size 2^( 5) =       0.000596021047
  error estimate for blocks of size 2^( 6) =       0.000599268906
  error estimate for blocks of size 2^( 7) =       0.000598382891

      target function =                  N/A
              le_mean =     -22.437964922908
             les_mean =     504.034113126135
             stat err =       0.000595279899
             autocorr =       1.239353560846
              std dev =       0.756203365784
             le_variance =       0.571843530424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571895522589
                                         uncertainty =       0.011588200205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571895522589
                                         uncertainty =       0.011588200205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534715827
  error estimate for blocks of size 2^( 2) =       0.000555010311
  error estimate for blocks of size 2^( 3) =       0.000573584059
  error estimate for blocks of size 2^( 4) =       0.000587446204
  error estimate for blocks of size 2^( 5) =       0.000596020517
  error estimate for blocks of size 2^( 6) =       0.000599268417
  error estimate for blocks of size 2^( 7) =       0.000598382372

      target function =                  N/A
              le_mean =     -22.437964920788
             les_mean =     504.034111531711
             stat err =       0.000595279378
             autocorr =       1.239354640451
              std dev =       0.756202374448
             le_variance =       0.571842031120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571894199068
                                         uncertainty =       0.011588220116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571894199068
                                         uncertainty =       0.011588220116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534715208
  error estimate for blocks of size 2^( 2) =       0.000555009723
  error estimate for blocks of size 2^( 3) =       0.000573583527
  error estimate for blocks of size 2^( 4) =       0.000587445721
  error estimate for blocks of size 2^( 5) =       0.000596020048
  error estimate for blocks of size 2^( 6) =       0.000599267986
  error estimate for blocks of size 2^( 7) =       0.000598381914

      target function =                  N/A
              le_mean =     -22.437964918915
             les_mean =     504.034110124568
             stat err =       0.000595278917
             autocorr =       1.239355591620
              std dev =       0.756201499627
             le_variance =       0.571840708038


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437964918649        initial
     6.1035e+01     6.1035e+02             4.5653e-06       -22.437964922908  <--
     2.4414e+02     2.4414e+03             1.1439e-06       -22.437964920788
     9.7656e+02     9.7656e+03             2.8614e-07       -22.437964918915

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 6.7742e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.739574e-01 1 1  ON 0
 uu_1                 9.863616e-02 1 1  ON 1
 uu_2                -1.784391e-02 1 1  ON 2
 uu_3                -8.834162e-02 1 1  ON 3
 uu_4                -1.300126e-01 1 1  ON 4
 uu_5                -1.551844e-01 1 1  ON 5
 uu_6                -1.679804e-01 1 1  ON 6
 uu_7                -1.686381e-01 1 1  ON 7
 uu_8                -1.529839e-01 1 1  ON 8
 uu_9                -1.129473e-01 1 1  ON 9
 ud_0                 4.660340e-01 1 1  ON 10
 ud_1                 1.816202e-01 1 1  ON 11
 ud_2                 3.094266e-02 1 1  ON 12
 ud_3                -5.384061e-02 1 1  ON 13
 ud_4                -1.042034e-01 1 1  ON 14
 ud_5                -1.374820e-01 1 1  ON 15
 ud_6                -1.582729e-01 1 1  ON 16
 ud_7                -1.658358e-01 1 1  ON 17
 ud_8                -1.567715e-01 1 1  ON 18
 ud_9                -1.264893e-01 1 1  ON 19
 eC_0                -6.709843e-01 1 1  ON 20
 eC_1                -4.980915e-01 1 1  ON 21
 eC_2                -1.966589e-01 1 1  ON 22
 eC_3                 2.182276e-02 1 1  ON 23
 eC_4                 1.639447e-01 1 1  ON 24
 eC_5                 2.843775e-01 1 1  ON 25
 eC_6                 3.000356e-01 1 1  ON 26
 eC_7                 3.287209e-01 1 1  ON 27
 eC_8                 2.213460e-01 1 1  ON 28
 eC_9                 4.708810e-02 1 1  ON 29
 eO_0                -1.207316e+00 1 1  ON 30
 eO_1                -8.147093e-01 1 1  ON 31
 eO_2                -3.215152e-01 1 1  ON 32
 eO_3                 4.498535e-03 1 1  ON 33
 eO_4                 2.290185e-01 1 1  ON 34
 eO_5                 3.701795e-01 1 1  ON 35
 eO_6                 4.054864e-01 1 1  ON 36
 eO_7                 4.309919e-01 1 1  ON 37
 eO_8                 4.437993e-01 1 1  ON 38
 eO_9                 3.233221e-01 1 1  ON 39
eH1_0                -1.649885e-01 1 1  ON 40
eH1_1                -6.446720e-02 1 1  ON 41
eH1_2                -4.335088e-02 1 1  ON 42
eH1_3                -4.066325e-02 1 1  ON 43
eH1_4                -2.055242e-03 1 1  ON 44
eH1_5                 9.940807e-03 1 1  ON 45
eH1_6                 3.966108e-02 1 1  ON 46
eH1_7                 4.560418e-02 1 1  ON 47
eH1_8                 3.129996e-02 1 1  ON 48
eH1_9                 9.090145e-02 1 1  ON 49
eH2_0                -1.673251e-01 1 1  ON 50
eH2_1                -6.724587e-02 1 1  ON 51
eH2_2                -4.591686e-02 1 1  ON 52
eH2_3                -4.351214e-02 1 1  ON 53
eH2_4                -4.984144e-03 1 1  ON 54
eH2_5                 6.737001e-03 1 1  ON 55
eH2_6                 3.617860e-02 1 1  ON 56
eH2_7                 4.269555e-02 1 1  ON 57
eH2_8                 2.831245e-02 1 1  ON 58
eH2_9                 9.544318e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2873e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2451e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.4171
    reference variance = 0.54592
====================================================
  Execution time = 4.6765e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6929e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5562e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569377020743
                                         uncertainty =       0.007463481370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569377020743
                                         uncertainty =       0.007463481370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533520241
  error estimate for blocks of size 2^( 2) =       0.000553155668
  error estimate for blocks of size 2^( 3) =       0.000571990550
  error estimate for blocks of size 2^( 4) =       0.000585084492
  error estimate for blocks of size 2^( 5) =       0.000592698445
  error estimate for blocks of size 2^( 6) =       0.000597448437
  error estimate for blocks of size 2^( 7) =       0.000602187865

      target function =                  N/A
              le_mean =     -22.437808584033
             les_mean =     504.024541464931
             stat err =       0.000594354810
             autocorr =       1.241051379316
              std dev =       0.754511561133
             le_variance =       0.569287695884


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243780858403e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437808584033       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437808611938       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437808621872       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437808613531       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437808615569       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437808615375       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437808635948       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437808640411       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437808636514       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437808630911       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+01 is 1.249851e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437808584033       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437808591143       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437808593680       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437808591612       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437808592084       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437808591840       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437808596940       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437808598116       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437808597263       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437808595907       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+01 is 3.147970e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437808584033       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437808585819       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437808586456       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437808585941       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437808586056       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437808585983       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437808587255       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437808587552       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437808587347       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437808587011       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+02 is 7.884746e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193122 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2342e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.739583e-01 1 1  ON 0
 uu_1                 9.863511e-02 1 1  ON 1
 uu_2                -1.784427e-02 1 1  ON 2
 uu_3                -8.834261e-02 1 1  ON 3
 uu_4                -1.300121e-01 1 1  ON 4
 uu_5                -1.551863e-01 1 1  ON 5
 uu_6                -1.679804e-01 1 1  ON 6
 uu_7                -1.686371e-01 1 1  ON 7
 uu_8                -1.529842e-01 1 1  ON 8
 uu_9                -1.129460e-01 1 1  ON 9
 ud_0                 4.660318e-01 1 1  ON 10
 ud_1                 1.816212e-01 1 1  ON 11
 ud_2                 3.094429e-02 1 1  ON 12
 ud_3                -5.384117e-02 1 1  ON 13
 ud_4                -1.042033e-01 1 1  ON 14
 ud_5                -1.374808e-01 1 1  ON 15
 ud_6                -1.582713e-01 1 1  ON 16
 ud_7                -1.658377e-01 1 1  ON 17
 ud_8                -1.567714e-01 1 1  ON 18
 ud_9                -1.264876e-01 1 1  ON 19
 eC_0                -6.709874e-01 1 1  ON 20
 eC_1                -4.980909e-01 1 1  ON 21
 eC_2                -1.966582e-01 1 1  ON 22
 eC_3                 2.182301e-02 1 1  ON 23
 eC_4                 1.639445e-01 1 1  ON 24
 eC_5                 2.843751e-01 1 1  ON 25
 eC_6                 3.000364e-01 1 1  ON 26
 eC_7                 3.287221e-01 1 1  ON 27
 eC_8                 2.213477e-01 1 1  ON 28
 eC_9                 4.708862e-02 1 1  ON 29
 eO_0                -1.207318e+00 1 1  ON 30
 eO_1                -8.147103e-01 1 1  ON 31
 eO_2                -3.215161e-01 1 1  ON 32
 eO_3                 4.498321e-03 1 1  ON 33
 eO_4                 2.290194e-01 1 1  ON 34
 eO_5                 3.701800e-01 1 1  ON 35
 eO_6                 4.054858e-01 1 1  ON 36
 eO_7                 4.309910e-01 1 1  ON 37
 eO_8                 4.437995e-01 1 1  ON 38
 eO_9                 3.233248e-01 1 1  ON 39
eH1_0                -1.649888e-01 1 1  ON 40
eH1_1                -6.446812e-02 1 1  ON 41
eH1_2                -4.335200e-02 1 1  ON 42
eH1_3                -4.066234e-02 1 1  ON 43
eH1_4                -2.056280e-03 1 1  ON 44
eH1_5                 9.941431e-03 1 1  ON 45
eH1_6                 3.966013e-02 1 1  ON 46
eH1_7                 4.560448e-02 1 1  ON 47
eH1_8                 3.130151e-02 1 1  ON 48
eH1_9                 9.090157e-02 1 1  ON 49
eH2_0                -1.673261e-01 1 1  ON 50
eH2_1                -6.724468e-02 1 1  ON 51
eH2_2                -4.591650e-02 1 1  ON 52
eH2_3                -4.351103e-02 1 1  ON 53
eH2_4                -4.984791e-03 1 1  ON 54
eH2_5                 6.736439e-03 1 1  ON 55
eH2_6                 3.617726e-02 1 1  ON 56
eH2_7                 4.269503e-02 1 1  ON 57
eH2_8                 2.831293e-02 1 1  ON 58
eH2_9                 9.544304e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.4212
    reference variance = 0.392699
====================================================
  Execution time = 4.6674e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6318e-01
  Total weights = 2.0000e+06
  Execution time = 3.8892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563288281769
                                         uncertainty =       0.003701402656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563288281769
                                         uncertainty =       0.003701402656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530653304
  error estimate for blocks of size 2^( 2) =       0.000550921719
  error estimate for blocks of size 2^( 3) =       0.000569542031
  error estimate for blocks of size 2^( 4) =       0.000583088658
  error estimate for blocks of size 2^( 5) =       0.000591851344
  error estimate for blocks of size 2^( 6) =       0.000597188389
  error estimate for blocks of size 2^( 7) =       0.000600745223

      target function =                  N/A
              le_mean =     -22.436802942445
             les_mean =     503.973311854943
             stat err =       0.000593218404
             autocorr =       1.249704939094
              std dev =       0.750457099667
             le_variance =       0.563185858441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563275253365
                                         uncertainty =       0.003701301074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563275253365
                                         uncertainty =       0.003701301074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530647166
  error estimate for blocks of size 2^( 2) =       0.000550916016
  error estimate for blocks of size 2^( 3) =       0.000569536468
  error estimate for blocks of size 2^( 4) =       0.000583083314
  error estimate for blocks of size 2^( 5) =       0.000591845986
  error estimate for blocks of size 2^( 6) =       0.000597183232
  error estimate for blocks of size 2^( 7) =       0.000600741055

      target function =                  N/A
              le_mean =     -22.436802813679
             les_mean =     503.973293048152
             stat err =       0.000593213397
             autocorr =       1.249712753861
              std dev =       0.750448419170
             le_variance =       0.563172829835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563281537483
                                         uncertainty =       0.003701350184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563281537483
                                         uncertainty =       0.003701350184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530650127
  error estimate for blocks of size 2^( 2) =       0.000550918766
  error estimate for blocks of size 2^( 3) =       0.000569539152
  error estimate for blocks of size 2^( 4) =       0.000583085893
  error estimate for blocks of size 2^( 5) =       0.000591848573
  error estimate for blocks of size 2^( 6) =       0.000597185722
  error estimate for blocks of size 2^( 7) =       0.000600743062

      target function =                  N/A
              le_mean =     -22.436802875528
             les_mean =     503.973302107743
             stat err =       0.000593215812
             autocorr =       1.249708987043
              std dev =       0.750452606133
             le_variance =       0.563179114052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563287431121
                                         uncertainty =       0.003701396043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563287431121
                                         uncertainty =       0.003701396043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530652903
  error estimate for blocks of size 2^( 2) =       0.000550921346
  error estimate for blocks of size 2^( 3) =       0.000569541668
  error estimate for blocks of size 2^( 4) =       0.000583088309
  error estimate for blocks of size 2^( 5) =       0.000591850995
  error estimate for blocks of size 2^( 6) =       0.000597188053
  error estimate for blocks of size 2^( 7) =       0.000600744950

      target function =                  N/A
              le_mean =     -22.436802933973
             les_mean =     503.973310624131
             stat err =       0.000593218077
             autocorr =       1.249705449629
              std dev =       0.750456532905
             le_variance =       0.563185007780


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436802942445        initial  <--
     1.5259e+01     1.5259e+02             1.2499e-05       -22.436802813679
     6.1035e+01     6.1035e+02             3.1480e-06       -22.436802875528
     2.4414e+02     2.4414e+03             7.8847e-07       -22.436802933973

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.1399
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.739574e-01 1 1  ON 0
 uu_1                 9.863616e-02 1 1  ON 1
 uu_2                -1.784391e-02 1 1  ON 2
 uu_3                -8.834162e-02 1 1  ON 3
 uu_4                -1.300126e-01 1 1  ON 4
 uu_5                -1.551844e-01 1 1  ON 5
 uu_6                -1.679804e-01 1 1  ON 6
 uu_7                -1.686381e-01 1 1  ON 7
 uu_8                -1.529839e-01 1 1  ON 8
 uu_9                -1.129473e-01 1 1  ON 9
 ud_0                 4.660340e-01 1 1  ON 10
 ud_1                 1.816202e-01 1 1  ON 11
 ud_2                 3.094266e-02 1 1  ON 12
 ud_3                -5.384061e-02 1 1  ON 13
 ud_4                -1.042034e-01 1 1  ON 14
 ud_5                -1.374820e-01 1 1  ON 15
 ud_6                -1.582729e-01 1 1  ON 16
 ud_7                -1.658358e-01 1 1  ON 17
 ud_8                -1.567715e-01 1 1  ON 18
 ud_9                -1.264893e-01 1 1  ON 19
 eC_0                -6.709843e-01 1 1  ON 20
 eC_1                -4.980915e-01 1 1  ON 21
 eC_2                -1.966589e-01 1 1  ON 22
 eC_3                 2.182276e-02 1 1  ON 23
 eC_4                 1.639447e-01 1 1  ON 24
 eC_5                 2.843775e-01 1 1  ON 25
 eC_6                 3.000356e-01 1 1  ON 26
 eC_7                 3.287209e-01 1 1  ON 27
 eC_8                 2.213460e-01 1 1  ON 28
 eC_9                 4.708810e-02 1 1  ON 29
 eO_0                -1.207316e+00 1 1  ON 30
 eO_1                -8.147093e-01 1 1  ON 31
 eO_2                -3.215152e-01 1 1  ON 32
 eO_3                 4.498535e-03 1 1  ON 33
 eO_4                 2.290185e-01 1 1  ON 34
 eO_5                 3.701795e-01 1 1  ON 35
 eO_6                 4.054864e-01 1 1  ON 36
 eO_7                 4.309919e-01 1 1  ON 37
 eO_8                 4.437993e-01 1 1  ON 38
 eO_9                 3.233221e-01 1 1  ON 39
eH1_0                -1.649885e-01 1 1  ON 40
eH1_1                -6.446720e-02 1 1  ON 41
eH1_2                -4.335088e-02 1 1  ON 42
eH1_3                -4.066325e-02 1 1  ON 43
eH1_4                -2.055242e-03 1 1  ON 44
eH1_5                 9.940807e-03 1 1  ON 45
eH1_6                 3.966108e-02 1 1  ON 46
eH1_7                 4.560418e-02 1 1  ON 47
eH1_8                 3.129996e-02 1 1  ON 48
eH1_9                 9.090145e-02 1 1  ON 49
eH2_0                -1.673251e-01 1 1  ON 50
eH2_1                -6.724587e-02 1 1  ON 51
eH2_2                -4.591686e-02 1 1  ON 52
eH2_3                -4.351214e-02 1 1  ON 53
eH2_4                -4.984144e-03 1 1  ON 54
eH2_5                 6.737001e-03 1 1  ON 55
eH2_6                 3.617860e-02 1 1  ON 56
eH2_7                 4.269555e-02 1 1  ON 57
eH2_8                 2.831245e-02 1 1  ON 58
eH2_9                 9.544318e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2850e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2448e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.4617
    reference variance = 0.776844
====================================================
  Execution time = 4.8351e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6766e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5432e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567580596757
                                         uncertainty =       0.004675108726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567580596757
                                         uncertainty =       0.004675108726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532756144
  error estimate for blocks of size 2^( 2) =       0.000553787150
  error estimate for blocks of size 2^( 3) =       0.000572471087
  error estimate for blocks of size 2^( 4) =       0.000587102475
  error estimate for blocks of size 2^( 5) =       0.000595739936
  error estimate for blocks of size 2^( 6) =       0.000600786289
  error estimate for blocks of size 2^( 7) =       0.000600548203

      target function =                  N/A
              le_mean =     -22.436770771735
             les_mean =     503.976340598020
             stat err =       0.000596044226
             autocorr =       1.251699376354
              std dev =       0.753430964638
             le_variance =       0.567658218475


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243677077173e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436770771735       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436770775155       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436770774521       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436770779292       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436770778488       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436770780467       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436770779506       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436770778058       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436770778916       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436770778790       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+02 is 1.562561e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436770771735       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436770772591       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436770772432       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436770773626       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436770773424       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436770773920       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436770773679       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436770773318       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436770773530       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436770773499       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+02 is 3.914779e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436770771735       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436770771949       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436770771909       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436770772208       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436770772157       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436770772282       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436770772227       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436770772130       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436770772189       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436770772191       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+03 is 9.792197e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196644 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3791e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.739576e-01 1 1  ON 0
 uu_1                 9.863610e-02 1 1  ON 1
 uu_2                -1.784392e-02 1 1  ON 2
 uu_3                -8.834164e-02 1 1  ON 3
 uu_4                -1.300127e-01 1 1  ON 4
 uu_5                -1.551845e-01 1 1  ON 5
 uu_6                -1.679805e-01 1 1  ON 6
 uu_7                -1.686380e-01 1 1  ON 7
 uu_8                -1.529839e-01 1 1  ON 8
 uu_9                -1.129472e-01 1 1  ON 9
 ud_0                 4.660344e-01 1 1  ON 10
 ud_1                 1.816201e-01 1 1  ON 11
 ud_2                 3.094266e-02 1 1  ON 12
 ud_3                -5.384068e-02 1 1  ON 13
 ud_4                -1.042035e-01 1 1  ON 14
 ud_5                -1.374820e-01 1 1  ON 15
 ud_6                -1.582729e-01 1 1  ON 16
 ud_7                -1.658358e-01 1 1  ON 17
 ud_8                -1.567715e-01 1 1  ON 18
 ud_9                -1.264892e-01 1 1  ON 19
 eC_0                -6.709845e-01 1 1  ON 20
 eC_1                -4.980916e-01 1 1  ON 21
 eC_2                -1.966587e-01 1 1  ON 22
 eC_3                 2.182273e-02 1 1  ON 23
 eC_4                 1.639449e-01 1 1  ON 24
 eC_5                 2.843775e-01 1 1  ON 25
 eC_6                 3.000355e-01 1 1  ON 26
 eC_7                 3.287208e-01 1 1  ON 27
 eC_8                 2.213461e-01 1 1  ON 28
 eC_9                 4.708818e-02 1 1  ON 29
 eO_0                -1.207316e+00 1 1  ON 30
 eO_1                -8.147095e-01 1 1  ON 31
 eO_2                -3.215153e-01 1 1  ON 32
 eO_3                 4.498519e-03 1 1  ON 33
 eO_4                 2.290187e-01 1 1  ON 34
 eO_5                 3.701795e-01 1 1  ON 35
 eO_6                 4.054864e-01 1 1  ON 36
 eO_7                 4.309919e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233224e-01 1 1  ON 39
eH1_0                -1.649883e-01 1 1  ON 40
eH1_1                -6.446710e-02 1 1  ON 41
eH1_2                -4.335071e-02 1 1  ON 42
eH1_3                -4.066311e-02 1 1  ON 43
eH1_4                -2.055372e-03 1 1  ON 44
eH1_5                 9.940742e-03 1 1  ON 45
eH1_6                 3.966094e-02 1 1  ON 46
eH1_7                 4.560401e-02 1 1  ON 47
eH1_8                 3.129985e-02 1 1  ON 48
eH1_9                 9.090136e-02 1 1  ON 49
eH2_0                -1.673253e-01 1 1  ON 50
eH2_1                -6.724593e-02 1 1  ON 51
eH2_2                -4.591680e-02 1 1  ON 52
eH2_3                -4.351209e-02 1 1  ON 53
eH2_4                -4.984345e-03 1 1  ON 54
eH2_5                 6.737039e-03 1 1  ON 55
eH2_6                 3.617878e-02 1 1  ON 56
eH2_7                 4.269561e-02 1 1  ON 57
eH2_8                 2.831241e-02 1 1  ON 58
eH2_9                 9.544310e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.4133
    reference variance = 0.378554
====================================================
  Execution time = 4.6880e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2439e+01
  VMC Evar = 5.7454e-01
  Total weights = 2.0000e+06
  Execution time = 3.8758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574610178844
                                         uncertainty =       0.007968409725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574610178844
                                         uncertainty =       0.007968409725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535974762
  error estimate for blocks of size 2^( 2) =       0.000555698120
  error estimate for blocks of size 2^( 3) =       0.000574625395
  error estimate for blocks of size 2^( 4) =       0.000589087187
  error estimate for blocks of size 2^( 5) =       0.000596359926
  error estimate for blocks of size 2^( 6) =       0.000601650606
  error estimate for blocks of size 2^( 7) =       0.000603489105

      target function =                  N/A
              le_mean =     -22.438528471331
             les_mean =     504.062097562518
             stat err =       0.000597646706
             autocorr =       1.243369988028
              std dev =       0.757982777546
             le_variance =       0.574537891056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574612475358
                                         uncertainty =       0.007968443118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574612475358
                                         uncertainty =       0.007968443118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535975833
  error estimate for blocks of size 2^( 2) =       0.000555699140
  error estimate for blocks of size 2^( 3) =       0.000574626356
  error estimate for blocks of size 2^( 4) =       0.000589088106
  error estimate for blocks of size 2^( 5) =       0.000596360824
  error estimate for blocks of size 2^( 6) =       0.000601651479
  error estimate for blocks of size 2^( 7) =       0.000603489949

      target function =                  N/A
              le_mean =     -22.438528479741
             les_mean =     504.062100235920
             stat err =       0.000597647589
             autocorr =       1.243368694256
              std dev =       0.757984292067
             le_variance =       0.574540187021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574611329310
                                         uncertainty =       0.007968426450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574611329310
                                         uncertainty =       0.007968426450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535975299
  error estimate for blocks of size 2^( 2) =       0.000555698631
  error estimate for blocks of size 2^( 3) =       0.000574625877
  error estimate for blocks of size 2^( 4) =       0.000589087647
  error estimate for blocks of size 2^( 5) =       0.000596360376
  error estimate for blocks of size 2^( 6) =       0.000601651043
  error estimate for blocks of size 2^( 7) =       0.000603489528

      target function =                  N/A
              le_mean =     -22.438528475537
             les_mean =     504.062098901453
             stat err =       0.000597647149
             autocorr =       1.243369340037
              std dev =       0.757983536264
             le_variance =       0.574539041247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574610322720
                                         uncertainty =       0.007968411816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574610322720
                                         uncertainty =       0.007968411816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535974829
  error estimate for blocks of size 2^( 2) =       0.000555698184
  error estimate for blocks of size 2^( 3) =       0.000574625455
  error estimate for blocks of size 2^( 4) =       0.000589087245
  error estimate for blocks of size 2^( 5) =       0.000596359983
  error estimate for blocks of size 2^( 6) =       0.000601650660
  error estimate for blocks of size 2^( 7) =       0.000603489158

      target function =                  N/A
              le_mean =     -22.438528471857
             les_mean =     504.062097729946
             stat err =       0.000597646761
             autocorr =       1.243369906994
              std dev =       0.757982872430
             le_variance =       0.574538034898


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.438528471331        initial
     1.5259e+02     1.5259e+03             1.5626e-06       -22.438528479741  <--
     6.1035e+02     6.1035e+03             3.9148e-07       -22.438528475537
     2.4414e+03     2.4414e+04             9.7922e-08       -22.438528471857

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 6.6266e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.739580e-01 1 1  ON 0
 uu_1                 9.863592e-02 1 1  ON 1
 uu_2                -1.784393e-02 1 1  ON 2
 uu_3                -8.834171e-02 1 1  ON 3
 uu_4                -1.300129e-01 1 1  ON 4
 uu_5                -1.551848e-01 1 1  ON 5
 uu_6                -1.679809e-01 1 1  ON 6
 uu_7                -1.686376e-01 1 1  ON 7
 uu_8                -1.529837e-01 1 1  ON 8
 uu_9                -1.129471e-01 1 1  ON 9
 ud_0                 4.660355e-01 1 1  ON 10
 ud_1                 1.816201e-01 1 1  ON 11
 ud_2                 3.094266e-02 1 1  ON 12
 ud_3                -5.384089e-02 1 1  ON 13
 ud_4                -1.042040e-01 1 1  ON 14
 ud_5                -1.374822e-01 1 1  ON 15
 ud_6                -1.582728e-01 1 1  ON 16
 ud_7                -1.658358e-01 1 1  ON 17
 ud_8                -1.567714e-01 1 1  ON 18
 ud_9                -1.264890e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980920e-01 1 1  ON 21
 eC_2                -1.966584e-01 1 1  ON 22
 eC_3                 2.182264e-02 1 1  ON 23
 eC_4                 1.639455e-01 1 1  ON 24
 eC_5                 2.843774e-01 1 1  ON 25
 eC_6                 3.000353e-01 1 1  ON 26
 eC_7                 3.287205e-01 1 1  ON 27
 eC_8                 2.213466e-01 1 1  ON 28
 eC_9                 4.708844e-02 1 1  ON 29
 eO_0                -1.207317e+00 1 1  ON 30
 eO_1                -8.147102e-01 1 1  ON 31
 eO_2                -3.215158e-01 1 1  ON 32
 eO_3                 4.498473e-03 1 1  ON 33
 eO_4                 2.290193e-01 1 1  ON 34
 eO_5                 3.701792e-01 1 1  ON 35
 eO_6                 4.054862e-01 1 1  ON 36
 eO_7                 4.309920e-01 1 1  ON 37
 eO_8                 4.437995e-01 1 1  ON 38
 eO_9                 3.233231e-01 1 1  ON 39
eH1_0                -1.649878e-01 1 1  ON 40
eH1_1                -6.446680e-02 1 1  ON 41
eH1_2                -4.335020e-02 1 1  ON 42
eH1_3                -4.066267e-02 1 1  ON 43
eH1_4                -2.055759e-03 1 1  ON 44
eH1_5                 9.940548e-03 1 1  ON 45
eH1_6                 3.966051e-02 1 1  ON 46
eH1_7                 4.560350e-02 1 1  ON 47
eH1_8                 3.129954e-02 1 1  ON 48
eH1_9                 9.090111e-02 1 1  ON 49
eH2_0                -1.673257e-01 1 1  ON 50
eH2_1                -6.724613e-02 1 1  ON 51
eH2_2                -4.591662e-02 1 1  ON 52
eH2_3                -4.351197e-02 1 1  ON 53
eH2_4                -4.984950e-03 1 1  ON 54
eH2_5                 6.737152e-03 1 1  ON 55
eH2_6                 3.617930e-02 1 1  ON 56
eH2_7                 4.269581e-02 1 1  ON 57
eH2_8                 2.831230e-02 1 1  ON 58
eH2_9                 9.544287e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3007e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2448e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.3651
    reference variance = 0.56185
====================================================
  Execution time = 4.8841e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5711e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5437e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557151567244
                                         uncertainty =       0.003583589864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557151567244
                                         uncertainty =       0.003583589864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527781819
  error estimate for blocks of size 2^( 2) =       0.000547233608
  error estimate for blocks of size 2^( 3) =       0.000566061410
  error estimate for blocks of size 2^( 4) =       0.000579252081
  error estimate for blocks of size 2^( 5) =       0.000589056347
  error estimate for blocks of size 2^( 6) =       0.000597207958
  error estimate for blocks of size 2^( 7) =       0.000601580104

      target function =                  N/A
              le_mean =     -22.436505877921
             les_mean =     503.953903028757
             stat err =       0.000591774123
             autocorr =       1.257196284803
              std dev =       0.746396206667
             le_variance =       0.557107297327


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243650587792e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436505877921       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436505894093       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436505904392       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436505904762       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436505907652       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436505905695       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436505902142       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436505900492       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436505903261       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436505905047       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+01 is 5.744194e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436505877921       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436505881984       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436505884581       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436505884683       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436505885423       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436505884950       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436505884040       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436505883592       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436505884269       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436505884710       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+02 is 1.440355e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436505877921       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436505878938       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436505879589       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436505879615       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436505879801       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436505879684       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436505879455       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436505879341       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436505879509       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436505879619       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+02 is 3.603596e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200089 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.4287e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.739585e-01 1 1  ON 0
 uu_1                 9.863620e-02 1 1  ON 1
 uu_2                -1.784437e-02 1 1  ON 2
 uu_3                -8.834122e-02 1 1  ON 3
 uu_4                -1.300132e-01 1 1  ON 4
 uu_5                -1.551856e-01 1 1  ON 5
 uu_6                -1.679806e-01 1 1  ON 6
 uu_7                -1.686372e-01 1 1  ON 7
 uu_8                -1.529842e-01 1 1  ON 8
 uu_9                -1.129471e-01 1 1  ON 9
 ud_0                 4.660366e-01 1 1  ON 10
 ud_1                 1.816205e-01 1 1  ON 11
 ud_2                 3.094292e-02 1 1  ON 12
 ud_3                -5.384095e-02 1 1  ON 13
 ud_4                -1.042037e-01 1 1  ON 14
 ud_5                -1.374820e-01 1 1  ON 15
 ud_6                -1.582720e-01 1 1  ON 16
 ud_7                -1.658369e-01 1 1  ON 17
 ud_8                -1.567722e-01 1 1  ON 18
 ud_9                -1.264889e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980931e-01 1 1  ON 21
 eC_2                -1.966584e-01 1 1  ON 22
 eC_3                 2.182289e-02 1 1  ON 23
 eC_4                 1.639463e-01 1 1  ON 24
 eC_5                 2.843772e-01 1 1  ON 25
 eC_6                 3.000348e-01 1 1  ON 26
 eC_7                 3.287203e-01 1 1  ON 27
 eC_8                 2.213473e-01 1 1  ON 28
 eC_9                 4.708869e-02 1 1  ON 29
 eO_0                -1.207317e+00 1 1  ON 30
 eO_1                -8.147111e-01 1 1  ON 31
 eO_2                -3.215163e-01 1 1  ON 32
 eO_3                 4.498250e-03 1 1  ON 33
 eO_4                 2.290208e-01 1 1  ON 34
 eO_5                 3.701790e-01 1 1  ON 35
 eO_6                 4.054864e-01 1 1  ON 36
 eO_7                 4.309916e-01 1 1  ON 37
 eO_8                 4.437995e-01 1 1  ON 38
 eO_9                 3.233240e-01 1 1  ON 39
eH1_0                -1.649879e-01 1 1  ON 40
eH1_1                -6.446636e-02 1 1  ON 41
eH1_2                -4.335031e-02 1 1  ON 42
eH1_3                -4.066311e-02 1 1  ON 43
eH1_4                -2.055802e-03 1 1  ON 44
eH1_5                 9.939712e-03 1 1  ON 45
eH1_6                 3.966094e-02 1 1  ON 46
eH1_7                 4.560407e-02 1 1  ON 47
eH1_8                 3.129951e-02 1 1  ON 48
eH1_9                 9.090097e-02 1 1  ON 49
eH2_0                -1.673262e-01 1 1  ON 50
eH2_1                -6.724526e-02 1 1  ON 51
eH2_2                -4.591633e-02 1 1  ON 52
eH2_3                -4.351119e-02 1 1  ON 53
eH2_4                -4.985178e-03 1 1  ON 54
eH2_5                 6.737016e-03 1 1  ON 55
eH2_6                 3.617845e-02 1 1  ON 56
eH2_7                 4.269565e-02 1 1  ON 57
eH2_8                 2.831193e-02 1 1  ON 58
eH2_9                 9.544270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.4612
    reference variance = 0.407921
====================================================
  Execution time = 4.5770e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7179e-01
  Total weights = 2.0000e+06
  Execution time = 3.8698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571772237920
                                         uncertainty =       0.005547721253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571772237920
                                         uncertainty =       0.005547721253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534688910
  error estimate for blocks of size 2^( 2) =       0.000554211247
  error estimate for blocks of size 2^( 3) =       0.000572430479
  error estimate for blocks of size 2^( 4) =       0.000585625154
  error estimate for blocks of size 2^( 5) =       0.000593477336
  error estimate for blocks of size 2^( 6) =       0.000597684829
  error estimate for blocks of size 2^( 7) =       0.000598069180

      target function =                  N/A
              le_mean =     -22.437997217911
             les_mean =     504.035503326582
             stat err =       0.000593714125
             autocorr =       1.232969714503
              std dev =       0.756164308519
             le_variance =       0.571784461478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571778032498
                                         uncertainty =       0.005547735046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571778032498
                                         uncertainty =       0.005547735046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534691620
  error estimate for blocks of size 2^( 2) =       0.000554213770
  error estimate for blocks of size 2^( 3) =       0.000572432816
  error estimate for blocks of size 2^( 4) =       0.000585627421
  error estimate for blocks of size 2^( 5) =       0.000593479444
  error estimate for blocks of size 2^( 6) =       0.000597686850
  error estimate for blocks of size 2^( 7) =       0.000598071238

      target function =                  N/A
              le_mean =     -22.437997244374
             les_mean =     504.035510309548
             stat err =       0.000593716238
             autocorr =       1.232965995583
              std dev =       0.756168140625
             le_variance =       0.571790256896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571775155247
                                         uncertainty =       0.005547728007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571775155247
                                         uncertainty =       0.005547728007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534690274
  error estimate for blocks of size 2^( 2) =       0.000554212517
  error estimate for blocks of size 2^( 3) =       0.000572431656
  error estimate for blocks of size 2^( 4) =       0.000585626296
  error estimate for blocks of size 2^( 5) =       0.000593478398
  error estimate for blocks of size 2^( 6) =       0.000597685846
  error estimate for blocks of size 2^( 7) =       0.000598070216

      target function =                  N/A
              le_mean =     -22.437997231353
             les_mean =     504.035506847557
             stat err =       0.000593715189
             autocorr =       1.232967842400
              std dev =       0.756166237829
             le_variance =       0.571787379233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571772603189
                                         uncertainty =       0.005547722093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571772603189
                                         uncertainty =       0.005547722093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534689081
  error estimate for blocks of size 2^( 2) =       0.000554211406
  error estimate for blocks of size 2^( 3) =       0.000572430626
  error estimate for blocks of size 2^( 4) =       0.000585625297
  error estimate for blocks of size 2^( 5) =       0.000593477469
  error estimate for blocks of size 2^( 6) =       0.000597684957
  error estimate for blocks of size 2^( 7) =       0.000598069310

      target function =                  N/A
              le_mean =     -22.437997219594
             les_mean =     504.035503767427
             stat err =       0.000593714258
             autocorr =       1.232969480090
              std dev =       0.756164550082
             le_variance =       0.571784826801


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437997217911        initial
     3.8147e+01     3.8147e+02             5.7442e-06       -22.437997244374  <--
     1.5259e+02     1.5259e+03             1.4404e-06       -22.437997231353
     6.1035e+02     6.1035e+03             3.6036e-07       -22.437997219594

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 6.5130e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863705e-02 1 1  ON 1
 uu_2                -1.784566e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686360e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660399e-01 1 1  ON 10
 ud_1                 1.816215e-01 1 1  ON 11
 ud_2                 3.094370e-02 1 1  ON 12
 ud_3                -5.384113e-02 1 1  ON 13
 ud_4                -1.042029e-01 1 1  ON 14
 ud_5                -1.374817e-01 1 1  ON 15
 ud_6                -1.582697e-01 1 1  ON 16
 ud_7                -1.658403e-01 1 1  ON 17
 ud_8                -1.567748e-01 1 1  ON 18
 ud_9                -1.264886e-01 1 1  ON 19
 eC_0                -6.709850e-01 1 1  ON 20
 eC_1                -4.980963e-01 1 1  ON 21
 eC_2                -1.966584e-01 1 1  ON 22
 eC_3                 2.182365e-02 1 1  ON 23
 eC_4                 1.639485e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213494e-01 1 1  ON 28
 eC_9                 4.708947e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147136e-01 1 1  ON 31
 eO_2                -3.215178e-01 1 1  ON 32
 eO_3                 4.497595e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233265e-01 1 1  ON 39
eH1_0                -1.649884e-01 1 1  ON 40
eH1_1                -6.446504e-02 1 1  ON 41
eH1_2                -4.335062e-02 1 1  ON 42
eH1_3                -4.066442e-02 1 1  ON 43
eH1_4                -2.055936e-03 1 1  ON 44
eH1_5                 9.937214e-03 1 1  ON 45
eH1_6                 3.966223e-02 1 1  ON 46
eH1_7                 4.560578e-02 1 1  ON 47
eH1_8                 3.129942e-02 1 1  ON 48
eH1_9                 9.090056e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724265e-02 1 1  ON 51
eH2_2                -4.591549e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985857e-03 1 1  ON 54
eH2_5                 6.736602e-03 1 1  ON 55
eH2_6                 3.617592e-02 1 1  ON 56
eH2_7                 4.269519e-02 1 1  ON 57
eH2_8                 2.831082e-02 1 1  ON 58
eH2_9                 9.544221e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2942e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2446e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.475
    reference variance = 0.437467
====================================================
  Execution time = 4.6407e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7636e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5389e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576366137663
                                         uncertainty =       0.010421366199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576366137663
                                         uncertainty =       0.010421366199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536823235
  error estimate for blocks of size 2^( 2) =       0.000556638850
  error estimate for blocks of size 2^( 3) =       0.000574837666
  error estimate for blocks of size 2^( 4) =       0.000589422342
  error estimate for blocks of size 2^( 5) =       0.000598804922
  error estimate for blocks of size 2^( 6) =       0.000604142491
  error estimate for blocks of size 2^( 7) =       0.000606406451

      target function =                  N/A
              le_mean =     -22.436280357867
             les_mean =     503.963034378855
             stat err =       0.000599694051
             autocorr =       1.247949101171
              std dev =       0.759182698845
             le_variance =       0.576358370226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243628035787e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436280357867       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436280386250       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436280431812       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436280424109       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436280436328       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436280439507       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436280415872       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436280435932       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436280429648       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436280437298       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+00 is 1.858523e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436280357867       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436280365071       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436280376695       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436280374649       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436280377688       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436280378564       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436280372860       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436280377808       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436280376061       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436280377911       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+01 is 4.685704e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436280357867       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436280359675       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436280362596       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436280362077       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436280362835       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436280363059       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436280361649       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436280362881       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436280362433       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436280362890       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+02 is 1.173970e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203576 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1805e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.739571e-01 1 1  ON 0
 uu_1                 9.863798e-02 1 1  ON 1
 uu_2                -1.784488e-02 1 1  ON 2
 uu_3                -8.833970e-02 1 1  ON 3
 uu_4                -1.300121e-01 1 1  ON 4
 uu_5                -1.551876e-01 1 1  ON 5
 uu_6                -1.679790e-01 1 1  ON 6
 uu_7                -1.686335e-01 1 1  ON 7
 uu_8                -1.529869e-01 1 1  ON 8
 uu_9                -1.129488e-01 1 1  ON 9
 ud_0                 4.660440e-01 1 1  ON 10
 ud_1                 1.816224e-01 1 1  ON 11
 ud_2                 3.094359e-02 1 1  ON 12
 ud_3                -5.384108e-02 1 1  ON 13
 ud_4                -1.042038e-01 1 1  ON 14
 ud_5                -1.374835e-01 1 1  ON 15
 ud_6                -1.582670e-01 1 1  ON 16
 ud_7                -1.658434e-01 1 1  ON 17
 ud_8                -1.567725e-01 1 1  ON 18
 ud_9                -1.264868e-01 1 1  ON 19
 eC_0                -6.709896e-01 1 1  ON 20
 eC_1                -4.980986e-01 1 1  ON 21
 eC_2                -1.966567e-01 1 1  ON 22
 eC_3                 2.182537e-02 1 1  ON 23
 eC_4                 1.639489e-01 1 1  ON 24
 eC_5                 2.843760e-01 1 1  ON 25
 eC_6                 3.000324e-01 1 1  ON 26
 eC_7                 3.287202e-01 1 1  ON 27
 eC_8                 2.213523e-01 1 1  ON 28
 eC_9                 4.709052e-02 1 1  ON 29
 eO_0                -1.207325e+00 1 1  ON 30
 eO_1                -8.147160e-01 1 1  ON 31
 eO_2                -3.215221e-01 1 1  ON 32
 eO_3                 4.497011e-03 1 1  ON 33
 eO_4                 2.290272e-01 1 1  ON 34
 eO_5                 3.701781e-01 1 1  ON 35
 eO_6                 4.054896e-01 1 1  ON 36
 eO_7                 4.309912e-01 1 1  ON 37
 eO_8                 4.438000e-01 1 1  ON 38
 eO_9                 3.233303e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446537e-02 1 1  ON 41
eH1_2                -4.335024e-02 1 1  ON 42
eH1_3                -4.066209e-02 1 1  ON 43
eH1_4                -2.058413e-03 1 1  ON 44
eH1_5                 9.936666e-03 1 1  ON 45
eH1_6                 3.966246e-02 1 1  ON 46
eH1_7                 4.560485e-02 1 1  ON 47
eH1_8                 3.129934e-02 1 1  ON 48
eH1_9                 9.090021e-02 1 1  ON 49
eH2_0                -1.673293e-01 1 1  ON 50
eH2_1                -6.724188e-02 1 1  ON 51
eH2_2                -4.591525e-02 1 1  ON 52
eH2_3                -4.350786e-02 1 1  ON 53
eH2_4                -4.984507e-03 1 1  ON 54
eH2_5                 6.736608e-03 1 1  ON 55
eH2_6                 3.617462e-02 1 1  ON 56
eH2_7                 4.269192e-02 1 1  ON 57
eH2_8                 2.831146e-02 1 1  ON 58
eH2_9                 9.544208e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.4767
    reference variance = 0.771597
====================================================
  Execution time = 4.6143e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5950e-01
  Total weights = 2.0000e+06
  Execution time = 3.8576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559630692344
                                         uncertainty =       0.003140495421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559630692344
                                         uncertainty =       0.003140495421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528910719
  error estimate for blocks of size 2^( 2) =       0.000549140295
  error estimate for blocks of size 2^( 3) =       0.000568430588
  error estimate for blocks of size 2^( 4) =       0.000583129977
  error estimate for blocks of size 2^( 5) =       0.000591600985
  error estimate for blocks of size 2^( 6) =       0.000595604554
  error estimate for blocks of size 2^( 7) =       0.000596087635

      target function =                  N/A
              le_mean =     -22.436868330652
             les_mean =     503.972553304265
             stat err =       0.000591605788
             autocorr =       1.251123240107
              std dev =       0.747992711870
             le_variance =       0.559493097011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559646934038
                                         uncertainty =       0.003140554878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559646934038
                                         uncertainty =       0.003140554878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528918397
  error estimate for blocks of size 2^( 2) =       0.000549147379
  error estimate for blocks of size 2^( 3) =       0.000568437197
  error estimate for blocks of size 2^( 4) =       0.000583136144
  error estimate for blocks of size 2^( 5) =       0.000591606832
  error estimate for blocks of size 2^( 6) =       0.000595609889
  error estimate for blocks of size 2^( 7) =       0.000596092441

      target function =                  N/A
              le_mean =     -22.436868246854
             les_mean =     503.972565787408
             stat err =       0.000591611326
             autocorr =       1.251110343779
              std dev =       0.748003569815
             le_variance =       0.559509340456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559639057634
                                         uncertainty =       0.003140526079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559639057634
                                         uncertainty =       0.003140526079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528914673
  error estimate for blocks of size 2^( 2) =       0.000549143943
  error estimate for blocks of size 2^( 3) =       0.000568433993
  error estimate for blocks of size 2^( 4) =       0.000583133156
  error estimate for blocks of size 2^( 5) =       0.000591604001
  error estimate for blocks of size 2^( 6) =       0.000595607306
  error estimate for blocks of size 2^( 7) =       0.000596090111

      target function =                  N/A
              le_mean =     -22.436868286112
             les_mean =     503.972559671752
             stat err =       0.000591608644
             autocorr =       1.251116611652
              std dev =       0.747998304238
             le_variance =       0.559501463143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559631745557
                                         uncertainty =       0.003140499283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559631745557
                                         uncertainty =       0.003140499283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528911217
  error estimate for blocks of size 2^( 2) =       0.000549140754
  error estimate for blocks of size 2^( 3) =       0.000568431017
  error estimate for blocks of size 2^( 4) =       0.000583130378
  error estimate for blocks of size 2^( 5) =       0.000591601365
  error estimate for blocks of size 2^( 6) =       0.000595604901
  error estimate for blocks of size 2^( 7) =       0.000596087946

      target function =                  N/A
              le_mean =     -22.436868324955
             les_mean =     503.972554101956
             stat err =       0.000591606147
             autocorr =       1.251122405715
              std dev =       0.747993415966
             le_variance =       0.559494150328


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436868330652        initial  <--
     9.5367e+00     9.5367e+01             1.8585e-05       -22.436868246854
     3.8147e+01     3.8147e+02             4.6857e-06       -22.436868286112
     1.5259e+02     1.5259e+03             1.1740e-06       -22.436868324955

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.4892
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863705e-02 1 1  ON 1
 uu_2                -1.784566e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686360e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660399e-01 1 1  ON 10
 ud_1                 1.816215e-01 1 1  ON 11
 ud_2                 3.094370e-02 1 1  ON 12
 ud_3                -5.384113e-02 1 1  ON 13
 ud_4                -1.042029e-01 1 1  ON 14
 ud_5                -1.374817e-01 1 1  ON 15
 ud_6                -1.582697e-01 1 1  ON 16
 ud_7                -1.658403e-01 1 1  ON 17
 ud_8                -1.567748e-01 1 1  ON 18
 ud_9                -1.264886e-01 1 1  ON 19
 eC_0                -6.709850e-01 1 1  ON 20
 eC_1                -4.980963e-01 1 1  ON 21
 eC_2                -1.966584e-01 1 1  ON 22
 eC_3                 2.182365e-02 1 1  ON 23
 eC_4                 1.639485e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213494e-01 1 1  ON 28
 eC_9                 4.708947e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147136e-01 1 1  ON 31
 eO_2                -3.215178e-01 1 1  ON 32
 eO_3                 4.497595e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233265e-01 1 1  ON 39
eH1_0                -1.649884e-01 1 1  ON 40
eH1_1                -6.446504e-02 1 1  ON 41
eH1_2                -4.335062e-02 1 1  ON 42
eH1_3                -4.066442e-02 1 1  ON 43
eH1_4                -2.055936e-03 1 1  ON 44
eH1_5                 9.937214e-03 1 1  ON 45
eH1_6                 3.966223e-02 1 1  ON 46
eH1_7                 4.560578e-02 1 1  ON 47
eH1_8                 3.129942e-02 1 1  ON 48
eH1_9                 9.090056e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724265e-02 1 1  ON 51
eH2_2                -4.591549e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985857e-03 1 1  ON 54
eH2_5                 6.736602e-03 1 1  ON 55
eH2_6                 3.617592e-02 1 1  ON 56
eH2_7                 4.269519e-02 1 1  ON 57
eH2_8                 2.831082e-02 1 1  ON 58
eH2_9                 9.544221e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2730e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2447e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.5027
    reference variance = 0.441605
====================================================
  Execution time = 4.6041e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5985e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5576e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559827761402
                                         uncertainty =       0.004028807061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559827761402
                                         uncertainty =       0.004028807061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529079385
  error estimate for blocks of size 2^( 2) =       0.000549460642
  error estimate for blocks of size 2^( 3) =       0.000567691324
  error estimate for blocks of size 2^( 4) =       0.000581448479
  error estimate for blocks of size 2^( 5) =       0.000590973015
  error estimate for blocks of size 2^( 6) =       0.000595210418
  error estimate for blocks of size 2^( 7) =       0.000597553405

      target function =                  N/A
              le_mean =     -22.436848250371
             les_mean =     503.972009120525
             stat err =       0.000591296329
             autocorr =       1.249017967947
              std dev =       0.748231241180
             le_variance =       0.559849990278


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243684825037e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436848250371       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436848258243       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436848255477       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436848249115       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436848251171       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436848252826       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436848251198       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436848249418       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436848248748       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436848249243       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+01 is 1.999770e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436848250371       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436848252343       residual = 9.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436848251652       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436848250057       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436848250572       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436848250986       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436848250574       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436848250132       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436848249964       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436848250087       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+02 is 5.005863e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436848250371       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436848250864       residual = 9.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436848250691       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436848250293       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436848250421       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436848250524       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436848250421       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436848250311       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436848250269       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436848250300       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+03 is 1.251869e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207095 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1682e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.739603e-01 1 1  ON 0
 uu_1                 9.863661e-02 1 1  ON 1
 uu_2                -1.784564e-02 1 1  ON 2
 uu_3                -8.833982e-02 1 1  ON 3
 uu_4                -1.300141e-01 1 1  ON 4
 uu_5                -1.551882e-01 1 1  ON 5
 uu_6                -1.679797e-01 1 1  ON 6
 uu_7                -1.686362e-01 1 1  ON 7
 uu_8                -1.529854e-01 1 1  ON 8
 uu_9                -1.129472e-01 1 1  ON 9
 ud_0                 4.660402e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094351e-02 1 1  ON 12
 ud_3                -5.384141e-02 1 1  ON 13
 ud_4                -1.042029e-01 1 1  ON 14
 ud_5                -1.374819e-01 1 1  ON 15
 ud_6                -1.582694e-01 1 1  ON 16
 ud_7                -1.658406e-01 1 1  ON 17
 ud_8                -1.567747e-01 1 1  ON 18
 ud_9                -1.264882e-01 1 1  ON 19
 eC_0                -6.709853e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966582e-01 1 1  ON 22
 eC_3                 2.182376e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843761e-01 1 1  ON 25
 eC_6                 3.000331e-01 1 1  ON 26
 eC_7                 3.287198e-01 1 1  ON 27
 eC_8                 2.213497e-01 1 1  ON 28
 eC_9                 4.708959e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147140e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497169e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701782e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309904e-01 1 1  ON 37
 eO_8                 4.437995e-01 1 1  ON 38
 eO_9                 3.233270e-01 1 1  ON 39
eH1_0                -1.649884e-01 1 1  ON 40
eH1_1                -6.446463e-02 1 1  ON 41
eH1_2                -4.335012e-02 1 1  ON 42
eH1_3                -4.066441e-02 1 1  ON 43
eH1_4                -2.056030e-03 1 1  ON 44
eH1_5                 9.937051e-03 1 1  ON 45
eH1_6                 3.966220e-02 1 1  ON 46
eH1_7                 4.560539e-02 1 1  ON 47
eH1_8                 3.129918e-02 1 1  ON 48
eH1_9                 9.090048e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724274e-02 1 1  ON 51
eH2_2                -4.591543e-02 1 1  ON 52
eH2_3                -4.350885e-02 1 1  ON 53
eH2_4                -4.985971e-03 1 1  ON 54
eH2_5                 6.736370e-03 1 1  ON 55
eH2_6                 3.617605e-02 1 1  ON 56
eH2_7                 4.269514e-02 1 1  ON 57
eH2_8                 2.831094e-02 1 1  ON 58
eH2_9                 9.544216e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.5358
    reference variance = 1.00471
====================================================
  Execution time = 4.7912e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7569e-01
  Total weights = 2.0000e+06
  Execution time = 3.8906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575762890218
                                         uncertainty =       0.008921530454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575762890218
                                         uncertainty =       0.008921530454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536510819
  error estimate for blocks of size 2^( 2) =       0.000556189451
  error estimate for blocks of size 2^( 3) =       0.000573845543
  error estimate for blocks of size 2^( 4) =       0.000586674180
  error estimate for blocks of size 2^( 5) =       0.000595379829
  error estimate for blocks of size 2^( 6) =       0.000600627398
  error estimate for blocks of size 2^( 7) =       0.000603647143

      target function =                  N/A
              le_mean =     -22.437991152898
             les_mean =     504.039134406652
             stat err =       0.000596582138
             autocorr =       1.236469830975
              std dev =       0.758740876022
             le_variance =       0.575687716947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575764896057
                                         uncertainty =       0.008921556940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575764896057
                                         uncertainty =       0.008921556940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536511753
  error estimate for blocks of size 2^( 2) =       0.000556190325
  error estimate for blocks of size 2^( 3) =       0.000573846354
  error estimate for blocks of size 2^( 4) =       0.000586674934
  error estimate for blocks of size 2^( 5) =       0.000595380522
  error estimate for blocks of size 2^( 6) =       0.000600628082
  error estimate for blocks of size 2^( 7) =       0.000603647813

      target function =                  N/A
              le_mean =     -22.437991152646
             les_mean =     504.039136401099
             stat err =       0.000596582838
             autocorr =       1.236468423821
              std dev =       0.758742197806
             le_variance =       0.575689722731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575763894967
                                         uncertainty =       0.008921543681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575763894967
                                         uncertainty =       0.008921543681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536511287
  error estimate for blocks of size 2^( 2) =       0.000556189889
  error estimate for blocks of size 2^( 3) =       0.000573845949
  error estimate for blocks of size 2^( 4) =       0.000586674557
  error estimate for blocks of size 2^( 5) =       0.000595380176
  error estimate for blocks of size 2^( 6) =       0.000600627741
  error estimate for blocks of size 2^( 7) =       0.000603647479

      target function =                  N/A
              le_mean =     -22.437991152781
             les_mean =     504.039135406122
             stat err =       0.000596582488
             autocorr =       1.236469125907
              std dev =       0.758741538120
             le_variance =       0.575688721668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575763015865
                                         uncertainty =       0.008921532107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575763015865
                                         uncertainty =       0.008921532107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536510877
  error estimate for blocks of size 2^( 2) =       0.000556189506
  error estimate for blocks of size 2^( 3) =       0.000573845594
  error estimate for blocks of size 2^( 4) =       0.000586674227
  error estimate for blocks of size 2^( 5) =       0.000595379873
  error estimate for blocks of size 2^( 6) =       0.000600627441
  error estimate for blocks of size 2^( 7) =       0.000603647185

      target function =                  N/A
              le_mean =     -22.437991152884
             les_mean =     504.039134531626
             stat err =       0.000596582182
             autocorr =       1.236469742786
              std dev =       0.758740958819
             le_variance =       0.575687842590


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437991152898        initial  <--
     9.5367e+01     9.5367e+02             1.9998e-06       -22.437991152646
     3.8147e+02     3.8147e+03             5.0059e-07       -22.437991152781
     1.5259e+03     1.5259e+04             1.2519e-07       -22.437991152884

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.3797
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863705e-02 1 1  ON 1
 uu_2                -1.784566e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686360e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660399e-01 1 1  ON 10
 ud_1                 1.816215e-01 1 1  ON 11
 ud_2                 3.094370e-02 1 1  ON 12
 ud_3                -5.384113e-02 1 1  ON 13
 ud_4                -1.042029e-01 1 1  ON 14
 ud_5                -1.374817e-01 1 1  ON 15
 ud_6                -1.582697e-01 1 1  ON 16
 ud_7                -1.658403e-01 1 1  ON 17
 ud_8                -1.567748e-01 1 1  ON 18
 ud_9                -1.264886e-01 1 1  ON 19
 eC_0                -6.709850e-01 1 1  ON 20
 eC_1                -4.980963e-01 1 1  ON 21
 eC_2                -1.966584e-01 1 1  ON 22
 eC_3                 2.182365e-02 1 1  ON 23
 eC_4                 1.639485e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213494e-01 1 1  ON 28
 eC_9                 4.708947e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147136e-01 1 1  ON 31
 eO_2                -3.215178e-01 1 1  ON 32
 eO_3                 4.497595e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233265e-01 1 1  ON 39
eH1_0                -1.649884e-01 1 1  ON 40
eH1_1                -6.446504e-02 1 1  ON 41
eH1_2                -4.335062e-02 1 1  ON 42
eH1_3                -4.066442e-02 1 1  ON 43
eH1_4                -2.055936e-03 1 1  ON 44
eH1_5                 9.937214e-03 1 1  ON 45
eH1_6                 3.966223e-02 1 1  ON 46
eH1_7                 4.560578e-02 1 1  ON 47
eH1_8                 3.129942e-02 1 1  ON 48
eH1_9                 9.090056e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724265e-02 1 1  ON 51
eH2_2                -4.591549e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985857e-03 1 1  ON 54
eH2_5                 6.736602e-03 1 1  ON 55
eH2_6                 3.617592e-02 1 1  ON 56
eH2_7                 4.269519e-02 1 1  ON 57
eH2_8                 2.831082e-02 1 1  ON 58
eH2_9                 9.544221e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2936e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2451e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.3372
    reference variance = 0.441047
====================================================
  Execution time = 4.6640e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7443e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5469e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574422087770
                                         uncertainty =       0.007773951849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574422087770
                                         uncertainty =       0.007773951849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535922373
  error estimate for blocks of size 2^( 2) =       0.000555561309
  error estimate for blocks of size 2^( 3) =       0.000574041313
  error estimate for blocks of size 2^( 4) =       0.000587695396
  error estimate for blocks of size 2^( 5) =       0.000597846230
  error estimate for blocks of size 2^( 6) =       0.000604200319
  error estimate for blocks of size 2^( 7) =       0.000607573174

      target function =                  N/A
              le_mean =     -22.437390312674
             les_mean =     504.010909336021
             stat err =       0.000599328780
             autocorr =       1.250623227443
              std dev =       0.757908688402
             le_variance =       0.574425579955


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243739031267e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437390312674       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437390312980       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437390312130       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437390311986       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437390312424       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437390312484       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437390312300       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437390312456       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437390312640       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+02 is 1.957341e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437390312674       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437390312750       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437390312538       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437390312502       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437390312614       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437390312626       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437390312582       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437390312625       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437390312663       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+03 is 4.893902e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437390312674       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437390312693       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437390312640       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437390312631       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437390312677       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437390312662       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437390312653       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437390312619       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437390312629       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+04 is 1.223510e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213690 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2123e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.739602e-01 1 1  ON 0
 uu_1                 9.863704e-02 1 1  ON 1
 uu_2                -1.784565e-02 1 1  ON 2
 uu_3                -8.833979e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686360e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660399e-01 1 1  ON 10
 ud_1                 1.816215e-01 1 1  ON 11
 ud_2                 3.094371e-02 1 1  ON 12
 ud_3                -5.384114e-02 1 1  ON 13
 ud_4                -1.042029e-01 1 1  ON 14
 ud_5                -1.374817e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658403e-01 1 1  ON 17
 ud_8                -1.567748e-01 1 1  ON 18
 ud_9                -1.264886e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980963e-01 1 1  ON 21
 eC_2                -1.966584e-01 1 1  ON 22
 eC_3                 2.182366e-02 1 1  ON 23
 eC_4                 1.639485e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213494e-01 1 1  ON 28
 eC_9                 4.708948e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147136e-01 1 1  ON 31
 eO_2                -3.215178e-01 1 1  ON 32
 eO_3                 4.497593e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649883e-01 1 1  ON 40
eH1_1                -6.446500e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066441e-02 1 1  ON 43
eH1_4                -2.055934e-03 1 1  ON 44
eH1_5                 9.937195e-03 1 1  ON 45
eH1_6                 3.966221e-02 1 1  ON 46
eH1_7                 4.560577e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724263e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350888e-02 1 1  ON 53
eH2_4                -4.985890e-03 1 1  ON 54
eH2_5                 6.736583e-03 1 1  ON 55
eH2_6                 3.617597e-02 1 1  ON 56
eH2_7                 4.269520e-02 1 1  ON 57
eH2_8                 2.831082e-02 1 1  ON 58
eH2_9                 9.544221e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.3747
    reference variance = 0.576235
====================================================
  Execution time = 4.7107e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2439e+01
  VMC Evar = 5.8127e-01
  Total weights = 2.0000e+06
  Execution time = 3.8679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581398441668
                                         uncertainty =       0.015714104386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581398441668
                                         uncertainty =       0.015714104386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539106709
  error estimate for blocks of size 2^( 2) =       0.000558790526
  error estimate for blocks of size 2^( 3) =       0.000577435221
  error estimate for blocks of size 2^( 4) =       0.000591396093
  error estimate for blocks of size 2^( 5) =       0.000598899017
  error estimate for blocks of size 2^( 6) =       0.000601021148
  error estimate for blocks of size 2^( 7) =       0.000604089772

      target function =                  N/A
              le_mean =     -22.439024301932
             les_mean =     504.091083419365
             stat err =       0.000598851508
             autocorr =       1.233925164946
              std dev =       0.762412019391
             le_variance =       0.581272087311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581398567549
                                         uncertainty =       0.015714109046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581398567549
                                         uncertainty =       0.015714109046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539106767
  error estimate for blocks of size 2^( 2) =       0.000558790582
  error estimate for blocks of size 2^( 3) =       0.000577435272
  error estimate for blocks of size 2^( 4) =       0.000591396139
  error estimate for blocks of size 2^( 5) =       0.000598899058
  error estimate for blocks of size 2^( 6) =       0.000601021190
  error estimate for blocks of size 2^( 7) =       0.000604089816

      target function =                  N/A
              le_mean =     -22.439024299504
             les_mean =     504.091083436228
             stat err =       0.000598851551
             autocorr =       1.233925075453
              std dev =       0.762412101915
             le_variance =       0.581272213147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581398504615
                                         uncertainty =       0.015714106717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581398504615
                                         uncertainty =       0.015714106717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539106738
  error estimate for blocks of size 2^( 2) =       0.000558790554
  error estimate for blocks of size 2^( 3) =       0.000577435246
  error estimate for blocks of size 2^( 4) =       0.000591396116
  error estimate for blocks of size 2^( 5) =       0.000598899038
  error estimate for blocks of size 2^( 6) =       0.000601021169
  error estimate for blocks of size 2^( 7) =       0.000604089794

      target function =                  N/A
              le_mean =     -22.439024300717
             les_mean =     504.091083427782
             stat err =       0.000598851529
             autocorr =       1.233925120201
              std dev =       0.762412060657
             le_variance =       0.581272150236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581398449537
                                         uncertainty =       0.015714104677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581398449537
                                         uncertainty =       0.015714104677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539106713
  error estimate for blocks of size 2^( 2) =       0.000558790530
  error estimate for blocks of size 2^( 3) =       0.000577435225
  error estimate for blocks of size 2^( 4) =       0.000591396096
  error estimate for blocks of size 2^( 5) =       0.000598899020
  error estimate for blocks of size 2^( 6) =       0.000601021150
  error estimate for blocks of size 2^( 7) =       0.000604089775

      target function =                  N/A
              le_mean =     -22.439024301780
             les_mean =     504.091083420417
             stat err =       0.000598851510
             autocorr =       1.233925159353
              std dev =       0.762412024549
             le_variance =       0.581272095177


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.439024301932        initial  <--
     9.5367e+02     9.5367e+03             1.9573e-07       -22.439024299504
     3.8147e+03     3.8147e+04             4.8939e-08       -22.439024300717
     1.5259e+04     1.5259e+05             1.2235e-08       -22.439024301780

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.4430
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863705e-02 1 1  ON 1
 uu_2                -1.784566e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686360e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660399e-01 1 1  ON 10
 ud_1                 1.816215e-01 1 1  ON 11
 ud_2                 3.094370e-02 1 1  ON 12
 ud_3                -5.384113e-02 1 1  ON 13
 ud_4                -1.042029e-01 1 1  ON 14
 ud_5                -1.374817e-01 1 1  ON 15
 ud_6                -1.582697e-01 1 1  ON 16
 ud_7                -1.658403e-01 1 1  ON 17
 ud_8                -1.567748e-01 1 1  ON 18
 ud_9                -1.264886e-01 1 1  ON 19
 eC_0                -6.709850e-01 1 1  ON 20
 eC_1                -4.980963e-01 1 1  ON 21
 eC_2                -1.966584e-01 1 1  ON 22
 eC_3                 2.182365e-02 1 1  ON 23
 eC_4                 1.639485e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213494e-01 1 1  ON 28
 eC_9                 4.708947e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147136e-01 1 1  ON 31
 eO_2                -3.215178e-01 1 1  ON 32
 eO_3                 4.497595e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233265e-01 1 1  ON 39
eH1_0                -1.649884e-01 1 1  ON 40
eH1_1                -6.446504e-02 1 1  ON 41
eH1_2                -4.335062e-02 1 1  ON 42
eH1_3                -4.066442e-02 1 1  ON 43
eH1_4                -2.055936e-03 1 1  ON 44
eH1_5                 9.937214e-03 1 1  ON 45
eH1_6                 3.966223e-02 1 1  ON 46
eH1_7                 4.560578e-02 1 1  ON 47
eH1_8                 3.129942e-02 1 1  ON 48
eH1_9                 9.090056e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724265e-02 1 1  ON 51
eH2_2                -4.591549e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985857e-03 1 1  ON 54
eH2_5                 6.736602e-03 1 1  ON 55
eH2_6                 3.617592e-02 1 1  ON 56
eH2_7                 4.269519e-02 1 1  ON 57
eH2_8                 2.831082e-02 1 1  ON 58
eH2_9                 9.544221e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2858e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2446e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.4174
    reference variance = 0.351442
====================================================
  Execution time = 4.6742e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2439e+01
  VMC Evar = 5.7093e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5267e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571082531749
                                         uncertainty =       0.006155583453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571082531749
                                         uncertainty =       0.006155583453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534290918
  error estimate for blocks of size 2^( 2) =       0.000554330902
  error estimate for blocks of size 2^( 3) =       0.000572004483
  error estimate for blocks of size 2^( 4) =       0.000585916949
  error estimate for blocks of size 2^( 5) =       0.000594022890
  error estimate for blocks of size 2^( 6) =       0.000600819345
  error estimate for blocks of size 2^( 7) =       0.000602624990

      target function =                  N/A
              le_mean =     -22.439102231007
             les_mean =     504.084242218050
             stat err =       0.000595846043
             autocorr =       1.243691126807
              std dev =       0.755601462378
             le_variance =       0.570933569947


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243910223101e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.439102231007       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.439102231032       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.439102231076       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.439102231127       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.439102231041       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.439102231039       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.439102230954       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.439102230959       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.439102231006       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.439102230986       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+03 is 2.781036e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.439102231007       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.439102231013       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.439102231024       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.439102231052       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.439102231015       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.439102230997       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.439102231013       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.439102231007       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.439102230984       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.439102231055       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+04 is 6.952727e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.439102231007       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.439102231008       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.439102231011       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.439102230981       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.439102231163       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.439102231035       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.439102231013       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.439102231041       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.439102231080       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.439102230913       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+05 is 1.738189e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221033 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2024e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863705e-02 1 1  ON 1
 uu_2                -1.784566e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686360e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660399e-01 1 1  ON 10
 ud_1                 1.816215e-01 1 1  ON 11
 ud_2                 3.094370e-02 1 1  ON 12
 ud_3                -5.384113e-02 1 1  ON 13
 ud_4                -1.042029e-01 1 1  ON 14
 ud_5                -1.374817e-01 1 1  ON 15
 ud_6                -1.582697e-01 1 1  ON 16
 ud_7                -1.658403e-01 1 1  ON 17
 ud_8                -1.567748e-01 1 1  ON 18
 ud_9                -1.264886e-01 1 1  ON 19
 eC_0                -6.709850e-01 1 1  ON 20
 eC_1                -4.980963e-01 1 1  ON 21
 eC_2                -1.966584e-01 1 1  ON 22
 eC_3                 2.182365e-02 1 1  ON 23
 eC_4                 1.639485e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213494e-01 1 1  ON 28
 eC_9                 4.708947e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147136e-01 1 1  ON 31
 eO_2                -3.215178e-01 1 1  ON 32
 eO_3                 4.497594e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233265e-01 1 1  ON 39
eH1_0                -1.649884e-01 1 1  ON 40
eH1_1                -6.446504e-02 1 1  ON 41
eH1_2                -4.335062e-02 1 1  ON 42
eH1_3                -4.066442e-02 1 1  ON 43
eH1_4                -2.055941e-03 1 1  ON 44
eH1_5                 9.937216e-03 1 1  ON 45
eH1_6                 3.966222e-02 1 1  ON 46
eH1_7                 4.560579e-02 1 1  ON 47
eH1_8                 3.129942e-02 1 1  ON 48
eH1_9                 9.090056e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724265e-02 1 1  ON 51
eH2_2                -4.591549e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985858e-03 1 1  ON 54
eH2_5                 6.736602e-03 1 1  ON 55
eH2_6                 3.617592e-02 1 1  ON 56
eH2_7                 4.269519e-02 1 1  ON 57
eH2_8                 2.831082e-02 1 1  ON 58
eH2_9                 9.544221e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.4232
    reference variance = 0.457303
====================================================
  Execution time = 4.7000e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6839e-01
  Total weights = 2.0000e+06
  Execution time = 4.2789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568474193976
                                         uncertainty =       0.005913697032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568474193976
                                         uncertainty =       0.005913697032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533098708
  error estimate for blocks of size 2^( 2) =       0.000553447715
  error estimate for blocks of size 2^( 3) =       0.000571694693
  error estimate for blocks of size 2^( 4) =       0.000585863922
  error estimate for blocks of size 2^( 5) =       0.000594003513
  error estimate for blocks of size 2^( 6) =       0.000599489249
  error estimate for blocks of size 2^( 7) =       0.000600468025

      target function =                  N/A
              le_mean =     -22.438128436201
             les_mean =     504.037995899996
             stat err =       0.000594956177
             autocorr =       1.245531444893
              std dev =       0.753915422802
             le_variance =       0.568388464739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568474191364
                                         uncertainty =       0.005913696734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568474191364
                                         uncertainty =       0.005913696734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533098707
  error estimate for blocks of size 2^( 2) =       0.000553447713
  error estimate for blocks of size 2^( 3) =       0.000571694691
  error estimate for blocks of size 2^( 4) =       0.000585863921
  error estimate for blocks of size 2^( 5) =       0.000594003512
  error estimate for blocks of size 2^( 6) =       0.000599489247
  error estimate for blocks of size 2^( 7) =       0.000600468023

      target function =                  N/A
              le_mean =     -22.438128436215
             les_mean =     504.037995898036
             stat err =       0.000594956176
             autocorr =       1.245531443339
              std dev =       0.753915421076
             le_variance =       0.568388462137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568474192670
                                         uncertainty =       0.005913696883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568474192670
                                         uncertainty =       0.005913696883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533098707
  error estimate for blocks of size 2^( 2) =       0.000553447714
  error estimate for blocks of size 2^( 3) =       0.000571694692
  error estimate for blocks of size 2^( 4) =       0.000585863922
  error estimate for blocks of size 2^( 5) =       0.000594003512
  error estimate for blocks of size 2^( 6) =       0.000599489248
  error estimate for blocks of size 2^( 7) =       0.000600468024

      target function =                  N/A
              le_mean =     -22.438128436208
             les_mean =     504.037995899016
             stat err =       0.000594956176
             autocorr =       1.245531444121
              std dev =       0.753915421939
             le_variance =       0.568388463438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568474193813
                                         uncertainty =       0.005913697013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568474193813
                                         uncertainty =       0.005913697013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533098708
  error estimate for blocks of size 2^( 2) =       0.000553447715
  error estimate for blocks of size 2^( 3) =       0.000571694692
  error estimate for blocks of size 2^( 4) =       0.000585863922
  error estimate for blocks of size 2^( 5) =       0.000594003513
  error estimate for blocks of size 2^( 6) =       0.000599489248
  error estimate for blocks of size 2^( 7) =       0.000600468025

      target function =                  N/A
              le_mean =     -22.438128436202
             les_mean =     504.037995899873
             stat err =       0.000594956177
             autocorr =       1.245531444797
              std dev =       0.753915422694
             le_variance =       0.568388464576


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.438128436201        initial
     9.5367e+03     9.5367e+04             2.7810e-08       -22.438128436215  <--
     3.8147e+04     3.8147e+05             6.9527e-09       -22.438128436208
     1.5259e+05     1.5259e+06             1.7382e-09       -22.438128436202

*****************************************************************************
Applying the update for shift_i =   9.5367e+03     and shift_s =   9.5367e+04
*****************************************************************************

  Execution time = 6.7268e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863704e-02 1 1  ON 1
 uu_2                -1.784566e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686360e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660399e-01 1 1  ON 10
 ud_1                 1.816215e-01 1 1  ON 11
 ud_2                 3.094371e-02 1 1  ON 12
 ud_3                -5.384113e-02 1 1  ON 13
 ud_4                -1.042029e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658403e-01 1 1  ON 17
 ud_8                -1.567748e-01 1 1  ON 18
 ud_9                -1.264886e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980963e-01 1 1  ON 21
 eC_2                -1.966584e-01 1 1  ON 22
 eC_3                 2.182365e-02 1 1  ON 23
 eC_4                 1.639485e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213494e-01 1 1  ON 28
 eC_9                 4.708947e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147136e-01 1 1  ON 31
 eO_2                -3.215178e-01 1 1  ON 32
 eO_3                 4.497592e-03 1 1  ON 33
 eO_4                 2.290250e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233265e-01 1 1  ON 39
eH1_0                -1.649884e-01 1 1  ON 40
eH1_1                -6.446503e-02 1 1  ON 41
eH1_2                -4.335062e-02 1 1  ON 42
eH1_3                -4.066442e-02 1 1  ON 43
eH1_4                -2.055954e-03 1 1  ON 44
eH1_5                 9.937220e-03 1 1  ON 45
eH1_6                 3.966222e-02 1 1  ON 46
eH1_7                 4.560579e-02 1 1  ON 47
eH1_8                 3.129942e-02 1 1  ON 48
eH1_9                 9.090056e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724265e-02 1 1  ON 51
eH2_2                -4.591549e-02 1 1  ON 52
eH2_3                -4.350886e-02 1 1  ON 53
eH2_4                -4.985862e-03 1 1  ON 54
eH2_5                 6.736602e-03 1 1  ON 55
eH2_6                 3.617592e-02 1 1  ON 56
eH2_7                 4.269519e-02 1 1  ON 57
eH2_8                 2.831082e-02 1 1  ON 58
eH2_9                 9.544221e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2933e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2445e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.4499
    reference variance = 0.773015
====================================================
  Execution time = 4.6163e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6354e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5407e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563646637935
                                         uncertainty =       0.003958953110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563646637935
                                         uncertainty =       0.003958953110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530817974
  error estimate for blocks of size 2^( 2) =       0.000550955803
  error estimate for blocks of size 2^( 3) =       0.000570034231
  error estimate for blocks of size 2^( 4) =       0.000584238602
  error estimate for blocks of size 2^( 5) =       0.000592792696
  error estimate for blocks of size 2^( 6) =       0.000597650124
  error estimate for blocks of size 2^( 7) =       0.000594705381

      target function =                  N/A
              le_mean =     -22.437002757820
             les_mean =     503.982627914766
             stat err =       0.000592346701
             autocorr =       1.245261923025
              std dev =       0.750689977375
             le_variance =       0.563535442131


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243700275782e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437002757820       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437002758125       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437002758271       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437002758358       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437002758264       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437002758048       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437002757991       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437002758054       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437002758045       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437002758054       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+03 is 1.067161e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437002757820       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437002757896       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437002757932       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437002757949       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437002757932       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437002757881       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437002757873       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437002757895       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437002757871       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437002757885       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+03 is 2.668112e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437002757820       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437002757839       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437002757848       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437002757852       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437002757855       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437002757825       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437002757844       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437002757825       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437002757751       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437002757713       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+04 is 6.670412e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224503 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1578e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784565e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686360e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660399e-01 1 1  ON 10
 ud_1                 1.816215e-01 1 1  ON 11
 ud_2                 3.094371e-02 1 1  ON 12
 ud_3                -5.384114e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658403e-01 1 1  ON 17
 ud_8                -1.567748e-01 1 1  ON 18
 ud_9                -1.264886e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980963e-01 1 1  ON 21
 eC_2                -1.966584e-01 1 1  ON 22
 eC_3                 2.182366e-02 1 1  ON 23
 eC_4                 1.639485e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213494e-01 1 1  ON 28
 eC_9                 4.708947e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147136e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497602e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649883e-01 1 1  ON 40
eH1_1                -6.446503e-02 1 1  ON 41
eH1_2                -4.335062e-02 1 1  ON 42
eH1_3                -4.066441e-02 1 1  ON 43
eH1_4                -2.055963e-03 1 1  ON 44
eH1_5                 9.937226e-03 1 1  ON 45
eH1_6                 3.966221e-02 1 1  ON 46
eH1_7                 4.560578e-02 1 1  ON 47
eH1_8                 3.129941e-02 1 1  ON 48
eH1_9                 9.090056e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724265e-02 1 1  ON 51
eH2_2                -4.591549e-02 1 1  ON 52
eH2_3                -4.350886e-02 1 1  ON 53
eH2_4                -4.985864e-03 1 1  ON 54
eH2_5                 6.736594e-03 1 1  ON 55
eH2_6                 3.617593e-02 1 1  ON 56
eH2_7                 4.269518e-02 1 1  ON 57
eH2_8                 2.831082e-02 1 1  ON 58
eH2_9                 9.544220e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.3687
    reference variance = 0.506055
====================================================
  Execution time = 4.5032e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7570e-01
  Total weights = 2.0000e+06
  Execution time = 3.8698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575855797193
                                         uncertainty =       0.013087252718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575855797193
                                         uncertainty =       0.013087252718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536518461
  error estimate for blocks of size 2^( 2) =       0.000556502035
  error estimate for blocks of size 2^( 3) =       0.000575604091
  error estimate for blocks of size 2^( 4) =       0.000589641976
  error estimate for blocks of size 2^( 5) =       0.000598874712
  error estimate for blocks of size 2^( 6) =       0.000603992769
  error estimate for blocks of size 2^( 7) =       0.000609314755

      target function =                  N/A
              le_mean =     -22.436810305912
             les_mean =     503.986160534235
             stat err =       0.000600456053
             autocorr =       1.252544353897
              std dev =       0.758751684416
             le_variance =       0.575704118603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575855797338
                                         uncertainty =       0.013087251422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575855797338
                                         uncertainty =       0.013087251422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536518461
  error estimate for blocks of size 2^( 2) =       0.000556502035
  error estimate for blocks of size 2^( 3) =       0.000575604090
  error estimate for blocks of size 2^( 4) =       0.000589641974
  error estimate for blocks of size 2^( 5) =       0.000598874711
  error estimate for blocks of size 2^( 6) =       0.000603992768
  error estimate for blocks of size 2^( 7) =       0.000609314758

      target function =                  N/A
              le_mean =     -22.436810306858
             les_mean =     503.986160576859
             stat err =       0.000600456053
             autocorr =       1.252544352716
              std dev =       0.758751684543
             le_variance =       0.575704118797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575855797265
                                         uncertainty =       0.013087252069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575855797265
                                         uncertainty =       0.013087252069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536518461
  error estimate for blocks of size 2^( 2) =       0.000556502035
  error estimate for blocks of size 2^( 3) =       0.000575604090
  error estimate for blocks of size 2^( 4) =       0.000589641975
  error estimate for blocks of size 2^( 5) =       0.000598874712
  error estimate for blocks of size 2^( 6) =       0.000603992768
  error estimate for blocks of size 2^( 7) =       0.000609314757

      target function =                  N/A
              le_mean =     -22.436810306385
             les_mean =     503.986160555551
             stat err =       0.000600456053
             autocorr =       1.252544353308
              std dev =       0.758751684479
             le_variance =       0.575704118700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575855797202
                                         uncertainty =       0.013087252637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575855797202
                                         uncertainty =       0.013087252637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536518461
  error estimate for blocks of size 2^( 2) =       0.000556502035
  error estimate for blocks of size 2^( 3) =       0.000575604091
  error estimate for blocks of size 2^( 4) =       0.000589641976
  error estimate for blocks of size 2^( 5) =       0.000598874712
  error estimate for blocks of size 2^( 6) =       0.000603992769
  error estimate for blocks of size 2^( 7) =       0.000609314755

      target function =                  N/A
              le_mean =     -22.436810305971
             les_mean =     503.986160536900
             stat err =       0.000600456053
             autocorr =       1.252544353825
              std dev =       0.758751684424
             le_variance =       0.575704118616


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436810305912        initial
     2.3842e+03     2.3842e+04             1.0672e-07       -22.436810306858  <--
     9.5367e+03     9.5367e+04             2.6681e-08       -22.436810306385
     3.8147e+04     3.8147e+05             6.6704e-09       -22.436810305971

*****************************************************************************
Applying the update for shift_i =   2.3842e+03     and shift_s =   2.3842e+04
*****************************************************************************

  Execution time = 6.4382e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679794e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660399e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384116e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567748e-01 1 1  ON 18
 ud_9                -1.264886e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708948e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497631e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649883e-01 1 1  ON 40
eH1_1                -6.446503e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066439e-02 1 1  ON 43
eH1_4                -2.055990e-03 1 1  ON 44
eH1_5                 9.937244e-03 1 1  ON 45
eH1_6                 3.966218e-02 1 1  ON 46
eH1_7                 4.560574e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591549e-02 1 1  ON 52
eH2_3                -4.350885e-02 1 1  ON 53
eH2_4                -4.985868e-03 1 1  ON 54
eH2_5                 6.736572e-03 1 1  ON 55
eH2_6                 3.617597e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831082e-02 1 1  ON 58
eH2_9                 9.544219e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2614e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2444e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.4164
    reference variance = 0.634015
====================================================
  Execution time = 4.7854e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6061e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5417e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560331727658
                                         uncertainty =       0.004237636928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560331727658
                                         uncertainty =       0.004237636928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529439263
  error estimate for blocks of size 2^( 2) =       0.000549514906
  error estimate for blocks of size 2^( 3) =       0.000567604779
  error estimate for blocks of size 2^( 4) =       0.000581122229
  error estimate for blocks of size 2^( 5) =       0.000590996033
  error estimate for blocks of size 2^( 6) =       0.000594448385
  error estimate for blocks of size 2^( 7) =       0.000598061766

      target function =                  N/A
              le_mean =     -22.437083540108
             les_mean =     503.983329371241
             stat err =       0.000591157103
             autocorr =       1.246733228601
              std dev =       0.748740185757
             le_variance =       0.560611865767


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243708354011e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437083540108       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437083540607       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437083541004       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437083541422       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437083541071       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437083541558       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437083542153       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437083542101       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437083542005       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437083542085       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+02 is 3.825232e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437083540108       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437083540233       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437083540332       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437083540437       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437083540352       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437083540470       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437083540623       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437083540612       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437083540586       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437083540603       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+03 is 9.564578e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437083540108       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437083540139       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437083540164       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437083540191       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437083540173       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437083540196       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437083540229       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437083540226       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437083540226       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437083540221       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+03 is 2.391238e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3279e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863704e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833979e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551881e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094372e-02 1 1  ON 12
 ud_3                -5.384119e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567748e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709852e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182372e-02 1 1  ON 23
 eC_4                 1.639485e-01 1 1  ON 24
 eC_5                 2.843764e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708950e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497641e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233267e-01 1 1  ON 39
eH1_0                -1.649883e-01 1 1  ON 40
eH1_1                -6.446496e-02 1 1  ON 41
eH1_2                -4.335065e-02 1 1  ON 42
eH1_3                -4.066443e-02 1 1  ON 43
eH1_4                -2.056048e-03 1 1  ON 44
eH1_5                 9.937246e-03 1 1  ON 45
eH1_6                 3.966218e-02 1 1  ON 46
eH1_7                 4.560570e-02 1 1  ON 47
eH1_8                 3.129941e-02 1 1  ON 48
eH1_9                 9.090058e-02 1 1  ON 49
eH2_0                -1.673278e-01 1 1  ON 50
eH2_1                -6.724262e-02 1 1  ON 51
eH2_2                -4.591547e-02 1 1  ON 52
eH2_3                -4.350885e-02 1 1  ON 53
eH2_4                -4.985839e-03 1 1  ON 54
eH2_5                 6.736521e-03 1 1  ON 55
eH2_6                 3.617597e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831082e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.4342
    reference variance = 0.298146
====================================================
  Execution time = 4.5261e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6814e-01
  Total weights = 2.0000e+06
  Execution time = 3.8634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568244129823
                                         uncertainty =       0.004853652718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568244129823
                                         uncertainty =       0.004853652718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532984606
  error estimate for blocks of size 2^( 2) =       0.000553059658
  error estimate for blocks of size 2^( 3) =       0.000570880944
  error estimate for blocks of size 2^( 4) =       0.000585288565
  error estimate for blocks of size 2^( 5) =       0.000593799092
  error estimate for blocks of size 2^( 6) =       0.000598699315
  error estimate for blocks of size 2^( 7) =       0.000600798843

      target function =                  N/A
              le_mean =     -22.437241627624
             les_mean =     503.997956753307
             stat err =       0.000594646454
             autocorr =       1.244767769043
              std dev =       0.753754058692
             le_variance =       0.568145180995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568244277958
                                         uncertainty =       0.004853654115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568244277958
                                         uncertainty =       0.004853654115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532984676
  error estimate for blocks of size 2^( 2) =       0.000553059724
  error estimate for blocks of size 2^( 3) =       0.000570881003
  error estimate for blocks of size 2^( 4) =       0.000585288618
  error estimate for blocks of size 2^( 5) =       0.000593799147
  error estimate for blocks of size 2^( 6) =       0.000598699372
  error estimate for blocks of size 2^( 7) =       0.000600798895

      target function =                  N/A
              le_mean =     -22.437241625393
             les_mean =     503.997956801186
             stat err =       0.000594646508
             autocorr =       1.244767672537
              std dev =       0.753754156877
             le_variance =       0.568145329010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568244203911
                                         uncertainty =       0.004853653417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568244203911
                                         uncertainty =       0.004853653417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532984641
  error estimate for blocks of size 2^( 2) =       0.000553059691
  error estimate for blocks of size 2^( 3) =       0.000570880973
  error estimate for blocks of size 2^( 4) =       0.000585288592
  error estimate for blocks of size 2^( 5) =       0.000593799119
  error estimate for blocks of size 2^( 6) =       0.000598699343
  error estimate for blocks of size 2^( 7) =       0.000600798869

      target function =                  N/A
              le_mean =     -22.437241626508
             les_mean =     503.997956777236
             stat err =       0.000594646481
             autocorr =       1.244767720788
              std dev =       0.753754107798
             le_variance =       0.568145255023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568244139085
                                         uncertainty =       0.004853652805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568244139085
                                         uncertainty =       0.004853652805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532984611
  error estimate for blocks of size 2^( 2) =       0.000553059663
  error estimate for blocks of size 2^( 3) =       0.000570880948
  error estimate for blocks of size 2^( 4) =       0.000585288568
  error estimate for blocks of size 2^( 5) =       0.000593799095
  error estimate for blocks of size 2^( 6) =       0.000598699318
  error estimate for blocks of size 2^( 7) =       0.000600798846

      target function =                  N/A
              le_mean =     -22.437241627484
             les_mean =     503.997956756297
             stat err =       0.000594646457
             autocorr =       1.244767763010
              std dev =       0.753754064831
             le_variance =       0.568145190249


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437241627624        initial  <--
     5.9605e+02     5.9605e+03             3.8252e-07       -22.437241625393
     2.3842e+03     2.3842e+04             9.5646e-08       -22.437241626508
     9.5367e+03     9.5367e+04             2.3912e-08       -22.437241627484

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.5804
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679794e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660399e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384116e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567748e-01 1 1  ON 18
 ud_9                -1.264886e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708948e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497631e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649883e-01 1 1  ON 40
eH1_1                -6.446503e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066439e-02 1 1  ON 43
eH1_4                -2.055990e-03 1 1  ON 44
eH1_5                 9.937244e-03 1 1  ON 45
eH1_6                 3.966218e-02 1 1  ON 46
eH1_7                 4.560574e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591549e-02 1 1  ON 52
eH2_3                -4.350885e-02 1 1  ON 53
eH2_4                -4.985868e-03 1 1  ON 54
eH2_5                 6.736572e-03 1 1  ON 55
eH2_6                 3.617597e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831082e-02 1 1  ON 58
eH2_9                 9.544219e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2816e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2443e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.4991
    reference variance = 0.591689
====================================================
  Execution time = 4.8282e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7715e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5403e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576571435766
                                         uncertainty =       0.014429533590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576571435766
                                         uncertainty =       0.014429533590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537193312
  error estimate for blocks of size 2^( 2) =       0.000557123860
  error estimate for blocks of size 2^( 3) =       0.000575519245
  error estimate for blocks of size 2^( 4) =       0.000589574278
  error estimate for blocks of size 2^( 5) =       0.000598083109
  error estimate for blocks of size 2^( 6) =       0.000600761785
  error estimate for blocks of size 2^( 7) =       0.000600632859

      target function =                  N/A
              le_mean =     -22.437813715561
             les_mean =     504.032637355277
             stat err =       0.000597263008
             autocorr =       1.236146771961
              std dev =       0.759706067915
             le_variance =       0.577153309627


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243781371556e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437813715561       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437813715647       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437813715659       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437813715601       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437813715620       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437813715569       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437813715604       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437813715646       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437813715645       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437813715620       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+03 is 2.822650e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437813715561       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437813715583       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437813715586       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437813715572       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437813715564       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437813715559       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437813715570       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437813715527       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437813715543       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437813715563       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+04 is 7.056671e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437813715561       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437813715567       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437813715567       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437813715571       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437813715577       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437813715650       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437813715500       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437813715689       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437813715820       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437813715661       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+04 is 1.764173e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.231497 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3694e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679794e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660399e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384116e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567748e-01 1 1  ON 18
 ud_9                -1.264886e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708948e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497626e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649883e-01 1 1  ON 40
eH1_1                -6.446503e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066439e-02 1 1  ON 43
eH1_4                -2.055993e-03 1 1  ON 44
eH1_5                 9.937238e-03 1 1  ON 45
eH1_6                 3.966217e-02 1 1  ON 46
eH1_7                 4.560574e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591549e-02 1 1  ON 52
eH2_3                -4.350886e-02 1 1  ON 53
eH2_4                -4.985869e-03 1 1  ON 54
eH2_5                 6.736573e-03 1 1  ON 55
eH2_6                 3.617598e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544219e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.4753
    reference variance = 0.474558
====================================================
  Execution time = 4.5798e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6574e-01
  Total weights = 2.0000e+06
  Execution time = 3.8810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565703751085
                                         uncertainty =       0.004253057638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565703751085
                                         uncertainty =       0.004253057638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531853451
  error estimate for blocks of size 2^( 2) =       0.000551974534
  error estimate for blocks of size 2^( 3) =       0.000571059205
  error estimate for blocks of size 2^( 4) =       0.000584640990
  error estimate for blocks of size 2^( 5) =       0.000593692414
  error estimate for blocks of size 2^( 6) =       0.000596196405
  error estimate for blocks of size 2^( 7) =       0.000597866762

      target function =                  N/A
              le_mean =     -22.437417756884
             les_mean =     504.003451501025
             stat err =       0.000593099143
             autocorr =       1.243571124698
              std dev =       0.752154363787
             le_variance =       0.565736186964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565703767243
                                         uncertainty =       0.004253057738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565703767243
                                         uncertainty =       0.004253057738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531853459
  error estimate for blocks of size 2^( 2) =       0.000551974541
  error estimate for blocks of size 2^( 3) =       0.000571059211
  error estimate for blocks of size 2^( 4) =       0.000584640996
  error estimate for blocks of size 2^( 5) =       0.000593692419
  error estimate for blocks of size 2^( 6) =       0.000596196411
  error estimate for blocks of size 2^( 7) =       0.000597866767

      target function =                  N/A
              le_mean =     -22.437417757180
             les_mean =     504.003451530485
             stat err =       0.000593099148
             autocorr =       1.243571111031
              std dev =       0.752154374525
             le_variance =       0.565736203117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565703759164
                                         uncertainty =       0.004253057688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565703759164
                                         uncertainty =       0.004253057688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531853455
  error estimate for blocks of size 2^( 2) =       0.000551974538
  error estimate for blocks of size 2^( 3) =       0.000571059208
  error estimate for blocks of size 2^( 4) =       0.000584640993
  error estimate for blocks of size 2^( 5) =       0.000593692416
  error estimate for blocks of size 2^( 6) =       0.000596196408
  error estimate for blocks of size 2^( 7) =       0.000597866764

      target function =                  N/A
              le_mean =     -22.437417757032
             les_mean =     504.003451515756
             stat err =       0.000593099145
             autocorr =       1.243571117857
              std dev =       0.752154369156
             le_variance =       0.565736195040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565703752095
                                         uncertainty =       0.004253057644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565703752095
                                         uncertainty =       0.004253057644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531853452
  error estimate for blocks of size 2^( 2) =       0.000551974535
  error estimate for blocks of size 2^( 3) =       0.000571059205
  error estimate for blocks of size 2^( 4) =       0.000584640991
  error estimate for blocks of size 2^( 5) =       0.000593692414
  error estimate for blocks of size 2^( 6) =       0.000596196406
  error estimate for blocks of size 2^( 7) =       0.000597866762

      target function =                  N/A
              le_mean =     -22.437417756902
             les_mean =     504.003451502866
             stat err =       0.000593099143
             autocorr =       1.243571123838
              std dev =       0.752154364458
             le_variance =       0.565736187973


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437417756884        initial
     5.9605e+03     5.9605e+04             2.8226e-08       -22.437417757180  <--
     2.3842e+04     2.3842e+05             7.0567e-09       -22.437417757032
     9.5367e+04     9.5367e+05             1.7642e-09       -22.437417756902

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 6.5227e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736576e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2896e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2445e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.3861
    reference variance = 0.440309
====================================================
  Execution time = 4.6704e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6946e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5628e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569624868894
                                         uncertainty =       0.006343878826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569624868894
                                         uncertainty =       0.006343878826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533599390
  error estimate for blocks of size 2^( 2) =       0.000553564029
  error estimate for blocks of size 2^( 3) =       0.000572207975
  error estimate for blocks of size 2^( 4) =       0.000586096600
  error estimate for blocks of size 2^( 5) =       0.000595375092
  error estimate for blocks of size 2^( 6) =       0.000602588020
  error estimate for blocks of size 2^( 7) =       0.000604967114

      target function =                  N/A
              le_mean =     -22.435614051569
             les_mean =     503.926234205152
             stat err =       0.000597256706
             autocorr =       1.252827912037
              std dev =       0.754623494823
             le_variance =       0.569456618939


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243561405157e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435614051569       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435614052424       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435614053223       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435614053328       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435614053264       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435614053280       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435614053606       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435614053502       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435614053495       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435614053464       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+03 is 1.816663e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435614051569       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435614051782       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435614051982       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435614052009       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435614051993       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435614051996       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435614052078       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435614052035       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435614052048       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435614052052       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+03 is 4.542330e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435614051569       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435614051622       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435614051672       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435614051679       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435614051674       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435614051663       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435614051684       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435614051733       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435614051691       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435614051638       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+04 is 1.135624e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238852 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2346e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863704e-02 1 1  ON 1
 uu_2                -1.784564e-02 1 1  ON 2
 uu_3                -8.833978e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529855e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384117e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374817e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182370e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708950e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497607e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233267e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446504e-02 1 1  ON 41
eH1_2                -4.335062e-02 1 1  ON 42
eH1_3                -4.066437e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937209e-03 1 1  ON 45
eH1_6                 3.966215e-02 1 1  ON 46
eH1_7                 4.560571e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724263e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350886e-02 1 1  ON 53
eH2_4                -4.985875e-03 1 1  ON 54
eH2_5                 6.736564e-03 1 1  ON 55
eH2_6                 3.617601e-02 1 1  ON 56
eH2_7                 4.269516e-02 1 1  ON 57
eH2_8                 2.831080e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.4634
    reference variance = 0.784342
====================================================
  Execution time = 4.5648e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5725e-01
  Total weights = 2.0000e+06
  Execution time = 3.8730e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557300447011
                                         uncertainty =       0.003398300284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557300447011
                                         uncertainty =       0.003398300284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527850011
  error estimate for blocks of size 2^( 2) =       0.000548457644
  error estimate for blocks of size 2^( 3) =       0.000566769054
  error estimate for blocks of size 2^( 4) =       0.000580428030
  error estimate for blocks of size 2^( 5) =       0.000590126816
  error estimate for blocks of size 2^( 6) =       0.000594496302
  error estimate for blocks of size 2^( 7) =       0.000597229286

      target function =                  N/A
              le_mean =     -22.437249522226
             les_mean =     503.987417112226
             stat err =       0.000590570108
             autocorr =       1.251762258110
              std dev =       0.746492644452
             le_variance =       0.557251268221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557300542410
                                         uncertainty =       0.003398301252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557300542410
                                         uncertainty =       0.003398301252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527850056
  error estimate for blocks of size 2^( 2) =       0.000548457687
  error estimate for blocks of size 2^( 3) =       0.000566769094
  error estimate for blocks of size 2^( 4) =       0.000580428066
  error estimate for blocks of size 2^( 5) =       0.000590126847
  error estimate for blocks of size 2^( 6) =       0.000594496333
  error estimate for blocks of size 2^( 7) =       0.000597229313

      target function =                  N/A
              le_mean =     -22.437249522157
             les_mean =     503.987417204444
             stat err =       0.000590570140
             autocorr =       1.251762176764
              std dev =       0.746492708291
             le_variance =       0.557251363532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557300494720
                                         uncertainty =       0.003398300768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557300494720
                                         uncertainty =       0.003398300768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527850034
  error estimate for blocks of size 2^( 2) =       0.000548457665
  error estimate for blocks of size 2^( 3) =       0.000566769074
  error estimate for blocks of size 2^( 4) =       0.000580428048
  error estimate for blocks of size 2^( 5) =       0.000590126831
  error estimate for blocks of size 2^( 6) =       0.000594496318
  error estimate for blocks of size 2^( 7) =       0.000597229300

      target function =                  N/A
              le_mean =     -22.437249522192
             les_mean =     503.987417158345
             stat err =       0.000590570124
             autocorr =       1.251762217428
              std dev =       0.746492676378
             le_variance =       0.557251315886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557300452975
                                         uncertainty =       0.003398300344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557300452975
                                         uncertainty =       0.003398300344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527850014
  error estimate for blocks of size 2^( 2) =       0.000548457646
  error estimate for blocks of size 2^( 3) =       0.000566769057
  error estimate for blocks of size 2^( 4) =       0.000580428032
  error estimate for blocks of size 2^( 5) =       0.000590126818
  error estimate for blocks of size 2^( 6) =       0.000594496304
  error estimate for blocks of size 2^( 7) =       0.000597229288

      target function =                  N/A
              le_mean =     -22.437249522222
             les_mean =     503.987417117991
             stat err =       0.000590570110
             autocorr =       1.251762253021
              std dev =       0.746492648443
             le_variance =       0.557251274179


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437249522226        initial  <--
     1.4901e+03     1.4901e+04             1.8167e-07       -22.437249522157
     5.9605e+03     5.9605e+04             4.5423e-08       -22.437249522192
     2.3842e+04     2.3842e+05             1.1356e-08       -22.437249522222

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.0362
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736576e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2743e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2444e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.4486
    reference variance = 0.398022
====================================================
  Execution time = 4.6627e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5986e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5437e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560035036763
                                         uncertainty =       0.004282050493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560035036763
                                         uncertainty =       0.004282050493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529082345
  error estimate for blocks of size 2^( 2) =       0.000549179251
  error estimate for blocks of size 2^( 3) =       0.000567493526
  error estimate for blocks of size 2^( 4) =       0.000581714852
  error estimate for blocks of size 2^( 5) =       0.000592355321
  error estimate for blocks of size 2^( 6) =       0.000598644521
  error estimate for blocks of size 2^( 7) =       0.000604548089

      target function =                  N/A
              le_mean =     -22.437240224789
             les_mean =     503.989604879634
             stat err =       0.000594315696
             autocorr =       1.261792266227
              std dev =       0.748235427313
             le_variance =       0.559856254687


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243724022479e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437240224789       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437240224813       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437240224807       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437240224808       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437240224823       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437240224815       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437240224805       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437240224783       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437240224816       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437240224818       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+04 is 1.088317e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437240224789       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437240224795       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437240224793       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437240224794       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437240224804       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437240224793       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437240224800       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437240224768       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437240224763       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437240225007       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+04 is 2.720825e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437240224789       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437240224790       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437240224790       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437240224890       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437240224861       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437240224810       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437240224807       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437240225121       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437240224707       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437240225657       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+05 is 6.802081e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246235 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2079e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784564e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384116e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497610e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560573e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.3206
    reference variance = 0.389509
====================================================
  Execution time = 4.7661e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6426e-01
  Total weights = 2.0000e+06
  Execution time = 3.9055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564364576129
                                         uncertainty =       0.004610853907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564364576129
                                         uncertainty =       0.004610853907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531160795
  error estimate for blocks of size 2^( 2) =       0.000551101752
  error estimate for blocks of size 2^( 3) =       0.000569743866
  error estimate for blocks of size 2^( 4) =       0.000583960382
  error estimate for blocks of size 2^( 5) =       0.000591785377
  error estimate for blocks of size 2^( 6) =       0.000596231338
  error estimate for blocks of size 2^( 7) =       0.000600269644

      target function =                  N/A
              le_mean =     -22.437687911767
             les_mean =     504.014102124655
             stat err =       0.000593061685
             autocorr =       1.246659095055
              std dev =       0.751174800507
             le_variance =       0.564263580917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564364578878
                                         uncertainty =       0.004610853895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564364578878
                                         uncertainty =       0.004610853895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531160797
  error estimate for blocks of size 2^( 2) =       0.000551101754
  error estimate for blocks of size 2^( 3) =       0.000569743867
  error estimate for blocks of size 2^( 4) =       0.000583960383
  error estimate for blocks of size 2^( 5) =       0.000591785378
  error estimate for blocks of size 2^( 6) =       0.000596231338
  error estimate for blocks of size 2^( 7) =       0.000600269645

      target function =                  N/A
              le_mean =     -22.437687911760
             les_mean =     504.014102127081
             stat err =       0.000593061686
             autocorr =       1.246659092748
              std dev =       0.751174802335
             le_variance =       0.564263583663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564364577504
                                         uncertainty =       0.004610853901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564364577504
                                         uncertainty =       0.004610853901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531160796
  error estimate for blocks of size 2^( 2) =       0.000551101753
  error estimate for blocks of size 2^( 3) =       0.000569743866
  error estimate for blocks of size 2^( 4) =       0.000583960383
  error estimate for blocks of size 2^( 5) =       0.000591785377
  error estimate for blocks of size 2^( 6) =       0.000596231338
  error estimate for blocks of size 2^( 7) =       0.000600269645

      target function =                  N/A
              le_mean =     -22.437687911764
             les_mean =     504.014102125868
             stat err =       0.000593061686
             autocorr =       1.246659093903
              std dev =       0.751174801421
             le_variance =       0.564263582290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564364576301
                                         uncertainty =       0.004610853906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564364576301
                                         uncertainty =       0.004610853906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531160795
  error estimate for blocks of size 2^( 2) =       0.000551101752
  error estimate for blocks of size 2^( 3) =       0.000569743866
  error estimate for blocks of size 2^( 4) =       0.000583960382
  error estimate for blocks of size 2^( 5) =       0.000591785377
  error estimate for blocks of size 2^( 6) =       0.000596231338
  error estimate for blocks of size 2^( 7) =       0.000600269644

      target function =                  N/A
              le_mean =     -22.437687911767
             les_mean =     504.014102124807
             stat err =       0.000593061685
             autocorr =       1.246659094912
              std dev =       0.751174800621
             le_variance =       0.564263581088


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437687911767        initial  <--
     1.4901e+04     1.4901e+05             1.0883e-08       -22.437687911760
     5.9605e+04     5.9605e+05             2.7208e-09       -22.437687911764
     2.3842e+05     2.3842e+06             6.8021e-10       -22.437687911767

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.1035
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736576e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2920e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2442e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.3633
    reference variance = 0.369502
====================================================
  Execution time = 4.5402e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7040e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5529e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570198487766
                                         uncertainty =       0.009058570722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570198487766
                                         uncertainty =       0.009058570722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534042013
  error estimate for blocks of size 2^( 2) =       0.000554055071
  error estimate for blocks of size 2^( 3) =       0.000572466693
  error estimate for blocks of size 2^( 4) =       0.000586688083
  error estimate for blocks of size 2^( 5) =       0.000593337244
  error estimate for blocks of size 2^( 6) =       0.000597313433
  error estimate for blocks of size 2^( 7) =       0.000601623495

      target function =                  N/A
              le_mean =     -22.436130789716
             les_mean =     503.950366271143
             stat err =       0.000594740564
             autocorr =       1.240235824585
              std dev =       0.755249457527
             le_variance =       0.570401743095


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243613078972e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436130789716       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436130789717       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436130789718       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436130789748       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436130789692       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436130789727       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436130789748       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436130789657       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436130790124       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436130789326       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+05 is 1.692329e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436130789716       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436130789716       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436130789717       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436130789716       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436130789558       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436130789475       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436130789361       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436130789938       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436130790087       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436130788972       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+05 is 4.230828e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436130789716       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436130789716       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436130789716       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436130789716       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436130787297       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436130790565       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436130791703       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436130790642       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436130790354       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436130796026       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+06 is 1.057700e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249664 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0940e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736576e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.4009
    reference variance = 0.400084
====================================================
  Execution time = 4.6836e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6829e-01
  Total weights = 2.0000e+06
  Execution time = 3.8927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568312902809
                                         uncertainty =       0.008465177699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568312902809
                                         uncertainty =       0.008465177699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533050527
  error estimate for blocks of size 2^( 2) =       0.000552976602
  error estimate for blocks of size 2^( 3) =       0.000571488852
  error estimate for blocks of size 2^( 4) =       0.000586286027
  error estimate for blocks of size 2^( 5) =       0.000594905252
  error estimate for blocks of size 2^( 6) =       0.000598406052
  error estimate for blocks of size 2^( 7) =       0.000599778308

      target function =                  N/A
              le_mean =     -22.437024586189
             les_mean =     503.988357725680
             stat err =       0.000594843910
             autocorr =       1.245286514028
              std dev =       0.753847284635
             le_variance =       0.568285728552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568312902706
                                         uncertainty =       0.008465177721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568312902706
                                         uncertainty =       0.008465177721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533050527
  error estimate for blocks of size 2^( 2) =       0.000552976602
  error estimate for blocks of size 2^( 3) =       0.000571488851
  error estimate for blocks of size 2^( 4) =       0.000586286027
  error estimate for blocks of size 2^( 5) =       0.000594905251
  error estimate for blocks of size 2^( 6) =       0.000598406052
  error estimate for blocks of size 2^( 7) =       0.000599778308

      target function =                  N/A
              le_mean =     -22.437024586195
             les_mean =     503.988357725816
             stat err =       0.000594843910
             autocorr =       1.245286514031
              std dev =       0.753847284568
             le_variance =       0.568285728450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568312902758
                                         uncertainty =       0.008465177710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568312902758
                                         uncertainty =       0.008465177710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533050527
  error estimate for blocks of size 2^( 2) =       0.000552976602
  error estimate for blocks of size 2^( 3) =       0.000571488852
  error estimate for blocks of size 2^( 4) =       0.000586286027
  error estimate for blocks of size 2^( 5) =       0.000594905252
  error estimate for blocks of size 2^( 6) =       0.000598406052
  error estimate for blocks of size 2^( 7) =       0.000599778308

      target function =                  N/A
              le_mean =     -22.437024586192
             les_mean =     503.988357725748
             stat err =       0.000594843910
             autocorr =       1.245286514027
              std dev =       0.753847284601
             le_variance =       0.568285728501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568312902802
                                         uncertainty =       0.008465177700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568312902802
                                         uncertainty =       0.008465177700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533050527
  error estimate for blocks of size 2^( 2) =       0.000552976602
  error estimate for blocks of size 2^( 3) =       0.000571488852
  error estimate for blocks of size 2^( 4) =       0.000586286027
  error estimate for blocks of size 2^( 5) =       0.000594905252
  error estimate for blocks of size 2^( 6) =       0.000598406052
  error estimate for blocks of size 2^( 7) =       0.000599778308

      target function =                  N/A
              le_mean =     -22.437024586190
             les_mean =     503.988357725688
             stat err =       0.000594843910
             autocorr =       1.245286514026
              std dev =       0.753847284631
             le_variance =       0.568285728545


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437024586189        initial
     1.4901e+05     1.4901e+06             1.6923e-09       -22.437024586195  <--
     5.9605e+05     5.9605e+06             4.2308e-10       -22.437024586192
     2.3842e+06     2.3842e+07             1.0577e-10       -22.437024586190

*****************************************************************************
Applying the update for shift_i =   1.4901e+05     and shift_s =   1.4901e+06
*****************************************************************************

  Execution time = 6.6289e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2744e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.2799
    reference variance = 0.435479
====================================================
  Execution time = 4.5685e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6079e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5221e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560845782581
                                         uncertainty =       0.004591833043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560845782581
                                         uncertainty =       0.004591833043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529522492
  error estimate for blocks of size 2^( 2) =       0.000549375906
  error estimate for blocks of size 2^( 3) =       0.000567972669
  error estimate for blocks of size 2^( 4) =       0.000582250284
  error estimate for blocks of size 2^( 5) =       0.000591018761
  error estimate for blocks of size 2^( 6) =       0.000595306850
  error estimate for blocks of size 2^( 7) =       0.000601474112

      target function =                  N/A
              le_mean =     -22.437493397332
             les_mean =     504.001897813997
             stat err =       0.000592512502
             autocorr =       1.252063088799
              std dev =       0.748857889773
             le_variance =       0.560788139076


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243749339733e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437493397332       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437493397357       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437493397347       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437493397354       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437493397348       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437493397350       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437493397327       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437493397306       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437493397370       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437493397359       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+04 is 5.541553e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437493397332       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437493397338       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437493397336       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437493397295       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437493397303       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437493397354       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437493397282       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437493397364       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437493397161       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437493397885       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+05 is 1.385407e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437493397332       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437493397334       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437493397333       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437493397516       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437493396894       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437493397246       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437493397073       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437493396743       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437493396594       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437493396550       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+05 is 3.463548e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253175 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0916e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384116e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497608e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937220e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724265e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736576e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.4835
    reference variance = 0.321817
====================================================
  Execution time = 4.4812e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6586e-01
  Total weights = 2.0000e+06
  Execution time = 3.8830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565963163369
                                         uncertainty =       0.005481814520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565963163369
                                         uncertainty =       0.005481814520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531910702
  error estimate for blocks of size 2^( 2) =       0.000551772185
  error estimate for blocks of size 2^( 3) =       0.000570492415
  error estimate for blocks of size 2^( 4) =       0.000585334275
  error estimate for blocks of size 2^( 5) =       0.000594246697
  error estimate for blocks of size 2^( 6) =       0.000600828306
  error estimate for blocks of size 2^( 7) =       0.000605781285

      target function =                  N/A
              le_mean =     -22.437135169649
             les_mean =     503.990892328269
             stat err =       0.000596547641
             autocorr =       1.257803526511
              std dev =       0.752235328924
             le_variance =       0.565857990081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565963168317
                                         uncertainty =       0.005481814538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565963168317
                                         uncertainty =       0.005481814538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531910704
  error estimate for blocks of size 2^( 2) =       0.000551772187
  error estimate for blocks of size 2^( 3) =       0.000570492417
  error estimate for blocks of size 2^( 4) =       0.000585334277
  error estimate for blocks of size 2^( 5) =       0.000594246699
  error estimate for blocks of size 2^( 6) =       0.000600828308
  error estimate for blocks of size 2^( 7) =       0.000605781287

      target function =                  N/A
              le_mean =     -22.437135169607
             les_mean =     503.990892331321
             stat err =       0.000596547643
             autocorr =       1.257803524137
              std dev =       0.752235332211
             le_variance =       0.565857995026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565963165843
                                         uncertainty =       0.005481814529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565963165843
                                         uncertainty =       0.005481814529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531910703
  error estimate for blocks of size 2^( 2) =       0.000551772186
  error estimate for blocks of size 2^( 3) =       0.000570492416
  error estimate for blocks of size 2^( 4) =       0.000585334276
  error estimate for blocks of size 2^( 5) =       0.000594246698
  error estimate for blocks of size 2^( 6) =       0.000600828307
  error estimate for blocks of size 2^( 7) =       0.000605781286

      target function =                  N/A
              le_mean =     -22.437135169628
             les_mean =     503.990892329795
             stat err =       0.000596547642
             autocorr =       1.257803525327
              std dev =       0.752235330567
             le_variance =       0.565857992554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565963163678
                                         uncertainty =       0.005481814521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565963163678
                                         uncertainty =       0.005481814521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531910702
  error estimate for blocks of size 2^( 2) =       0.000551772185
  error estimate for blocks of size 2^( 3) =       0.000570492415
  error estimate for blocks of size 2^( 4) =       0.000585334275
  error estimate for blocks of size 2^( 5) =       0.000594246697
  error estimate for blocks of size 2^( 6) =       0.000600828306
  error estimate for blocks of size 2^( 7) =       0.000605781285

      target function =                  N/A
              le_mean =     -22.437135169647
             les_mean =     503.990892328460
             stat err =       0.000596547641
             autocorr =       1.257803526359
              std dev =       0.752235329129
             le_variance =       0.565857990390


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437135169649        initial  <--
     3.7253e+04     3.7253e+05             5.5416e-09       -22.437135169607
     1.4901e+05     1.4901e+06             1.3854e-09       -22.437135169628
     5.9605e+05     5.9605e+06             3.4635e-10       -22.437135169647

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.0592
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2799e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2437e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.5089
    reference variance = 0.430695
====================================================
  Execution time = 4.6793e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6000e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5106e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560050100347
                                         uncertainty =       0.003637321647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560050100347
                                         uncertainty =       0.003637321647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529151979
  error estimate for blocks of size 2^( 2) =       0.000549372144
  error estimate for blocks of size 2^( 3) =       0.000568254169
  error estimate for blocks of size 2^( 4) =       0.000582833527
  error estimate for blocks of size 2^( 5) =       0.000591932205
  error estimate for blocks of size 2^( 6) =       0.000597823004
  error estimate for blocks of size 2^( 7) =       0.000601501806

      target function =                  N/A
              le_mean =     -22.437809290810
             les_mean =     504.015289124051
             stat err =       0.000593522635
             autocorr =       1.258095833159
              std dev =       0.748333904962
             le_variance =       0.560003633315


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243780929081e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437809290810       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437809290813       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437809290815       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437809290670       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437809290814       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437809290875       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437809290737       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437809291028       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437809290919       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437809290155       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+05 is 5.873108e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437809290810       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437809290810       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437809290811       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437809290819       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437809290811       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437809290889       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437809290879       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437809290214       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437809289238       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437809291768       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+06 is 1.468281e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437809290810       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437809290810       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437809290810       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437809290913       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437809291055       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437809290682       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437809296367       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437809288956       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437809299769       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437809313737       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+06 is 3.670698e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.260541 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1914e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.3571
    reference variance = 0.433184
====================================================
  Execution time = 4.5637e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6377e-01
  Total weights = 2.0000e+06
  Execution time = 3.8667e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563754403041
                                         uncertainty =       0.004257438844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563754403041
                                         uncertainty =       0.004257438844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530927325
  error estimate for blocks of size 2^( 2) =       0.000550929219
  error estimate for blocks of size 2^( 3) =       0.000569832025
  error estimate for blocks of size 2^( 4) =       0.000583603963
  error estimate for blocks of size 2^( 5) =       0.000593469677
  error estimate for blocks of size 2^( 6) =       0.000598607264
  error estimate for blocks of size 2^( 7) =       0.000597878194

      target function =                  N/A
              le_mean =     -22.437503853763
             les_mean =     504.005346554499
             stat err =       0.000593389774
             autocorr =       1.249136679550
              std dev =       0.750844623589
             le_variance =       0.563767648772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563754402390
                                         uncertainty =       0.004257438842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563754402390
                                         uncertainty =       0.004257438842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530927325
  error estimate for blocks of size 2^( 2) =       0.000550929218
  error estimate for blocks of size 2^( 3) =       0.000569832025
  error estimate for blocks of size 2^( 4) =       0.000583603963
  error estimate for blocks of size 2^( 5) =       0.000593469677
  error estimate for blocks of size 2^( 6) =       0.000598607264
  error estimate for blocks of size 2^( 7) =       0.000597878194

      target function =                  N/A
              le_mean =     -22.437503853760
             les_mean =     504.005346553732
             stat err =       0.000593389774
             autocorr =       1.249136679881
              std dev =       0.750844623155
             le_variance =       0.563767648121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563754402716
                                         uncertainty =       0.004257438843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563754402716
                                         uncertainty =       0.004257438843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530927325
  error estimate for blocks of size 2^( 2) =       0.000550929218
  error estimate for blocks of size 2^( 3) =       0.000569832025
  error estimate for blocks of size 2^( 4) =       0.000583603963
  error estimate for blocks of size 2^( 5) =       0.000593469677
  error estimate for blocks of size 2^( 6) =       0.000598607264
  error estimate for blocks of size 2^( 7) =       0.000597878194

      target function =                  N/A
              le_mean =     -22.437503853761
             les_mean =     504.005346554115
             stat err =       0.000593389774
             autocorr =       1.249136679723
              std dev =       0.750844623372
             le_variance =       0.563767648447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563754403001
                                         uncertainty =       0.004257438844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563754403001
                                         uncertainty =       0.004257438844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530927325
  error estimate for blocks of size 2^( 2) =       0.000550929219
  error estimate for blocks of size 2^( 3) =       0.000569832025
  error estimate for blocks of size 2^( 4) =       0.000583603963
  error estimate for blocks of size 2^( 5) =       0.000593469677
  error estimate for blocks of size 2^( 6) =       0.000598607264
  error estimate for blocks of size 2^( 7) =       0.000597878194

      target function =                  N/A
              le_mean =     -22.437503853762
             les_mean =     504.005346554451
             stat err =       0.000593389774
             autocorr =       1.249136679573
              std dev =       0.750844623562
             le_variance =       0.563767648731


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437503853763        initial  <--
     3.7253e+05     3.7253e+06             5.8731e-10       -22.437503853760
     1.4901e+06     1.4901e+07             1.4683e-10       -22.437503853761
     5.9605e+06     5.9605e+07             3.6707e-11       -22.437503853762

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.9860
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2692e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2437e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.5063
    reference variance = 0.478436
====================================================
  Execution time = 4.8558e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7074e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5236e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570480944288
                                         uncertainty =       0.005665518884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570480944288
                                         uncertainty =       0.005665518884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534199494
  error estimate for blocks of size 2^( 2) =       0.000553815804
  error estimate for blocks of size 2^( 3) =       0.000572197100
  error estimate for blocks of size 2^( 4) =       0.000586327315
  error estimate for blocks of size 2^( 5) =       0.000595306681
  error estimate for blocks of size 2^( 6) =       0.000600299280
  error estimate for blocks of size 2^( 7) =       0.000603334882

      target function =                  N/A
              le_mean =     -22.437698539233
             les_mean =     504.021053651788
             stat err =       0.000596317039
             autocorr =       1.246084497889
              std dev =       0.755472169998
             le_variance =       0.570738199641


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243769853923e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437698539233       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437698539234       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437698539234       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437698539235       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437698539234       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437698541036       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437698538784       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437698541792       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437698538632       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437698540512       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+06 is 5.399013e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437698539233       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437698539233       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437698539233       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437698533867       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437698535868       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437698538227       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437698538315       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437698541213       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437698532536       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437698535766       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+07 is 1.349773e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437698539233       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437698539233       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437698539233       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437698539233       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437698602126       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437698581085       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437698579541       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437698525364       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437698521139       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437698524250       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+07 is 3.374059e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264065 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3805e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.4367
    reference variance = 0.334179
====================================================
  Execution time = 4.5624e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6379e-01
  Total weights = 2.0000e+06
  Execution time = 3.8686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563814820016
                                         uncertainty =       0.005404846732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563814820016
                                         uncertainty =       0.005404846732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530936810
  error estimate for blocks of size 2^( 2) =       0.000551139632
  error estimate for blocks of size 2^( 3) =       0.000570149854
  error estimate for blocks of size 2^( 4) =       0.000584225559
  error estimate for blocks of size 2^( 5) =       0.000592722694
  error estimate for blocks of size 2^( 6) =       0.000598470569
  error estimate for blocks of size 2^( 7) =       0.000601444594

      target function =                  N/A
              le_mean =     -22.436276470561
             les_mean =     503.950289373415
             stat err =       0.000594215854
             autocorr =       1.252572283957
              std dev =       0.750858037102
             le_variance =       0.563787791880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563814819976
                                         uncertainty =       0.005404846732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563814819976
                                         uncertainty =       0.005404846732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530936810
  error estimate for blocks of size 2^( 2) =       0.000551139632
  error estimate for blocks of size 2^( 3) =       0.000570149854
  error estimate for blocks of size 2^( 4) =       0.000584225559
  error estimate for blocks of size 2^( 5) =       0.000592722694
  error estimate for blocks of size 2^( 6) =       0.000598470568
  error estimate for blocks of size 2^( 7) =       0.000601444594

      target function =                  N/A
              le_mean =     -22.436276470561
             les_mean =     503.950289373387
             stat err =       0.000594215854
             autocorr =       1.252572283970
              std dev =       0.750858037075
             le_variance =       0.563787791841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563814819996
                                         uncertainty =       0.005404846732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563814819996
                                         uncertainty =       0.005404846732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530936810
  error estimate for blocks of size 2^( 2) =       0.000551139632
  error estimate for blocks of size 2^( 3) =       0.000570149854
  error estimate for blocks of size 2^( 4) =       0.000584225559
  error estimate for blocks of size 2^( 5) =       0.000592722694
  error estimate for blocks of size 2^( 6) =       0.000598470569
  error estimate for blocks of size 2^( 7) =       0.000601444594

      target function =                  N/A
              le_mean =     -22.436276470561
             les_mean =     503.950289373401
             stat err =       0.000594215854
             autocorr =       1.252572283965
              std dev =       0.750858037088
             le_variance =       0.563787791860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563814820013
                                         uncertainty =       0.005404846732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563814820013
                                         uncertainty =       0.005404846732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530936810
  error estimate for blocks of size 2^( 2) =       0.000551139632
  error estimate for blocks of size 2^( 3) =       0.000570149854
  error estimate for blocks of size 2^( 4) =       0.000584225559
  error estimate for blocks of size 2^( 5) =       0.000592722694
  error estimate for blocks of size 2^( 6) =       0.000598470569
  error estimate for blocks of size 2^( 7) =       0.000601444594

      target function =                  N/A
              le_mean =     -22.436276470561
             les_mean =     503.950289373413
             stat err =       0.000594215854
             autocorr =       1.252572283961
              std dev =       0.750858037100
             le_variance =       0.563787791878


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436276470561        initial
     3.7253e+06     3.7253e+07             5.3990e-11       -22.436276470561  <--
     1.4901e+07     1.4901e+08             1.3498e-11       -22.436276470561
     5.9605e+07     5.9605e+08             3.3741e-12       -22.436276470561

*****************************************************************************
Applying the update for shift_i =   3.7253e+06     and shift_s =   3.7253e+07
*****************************************************************************

  Execution time = 6.4973e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2883e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2438e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.4196
    reference variance = 0.823347
====================================================
  Execution time = 4.7836e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6861e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5215e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568445530494
                                         uncertainty =       0.005006207367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568445530494
                                         uncertainty =       0.005006207367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533200850
  error estimate for blocks of size 2^( 2) =       0.000553528923
  error estimate for blocks of size 2^( 3) =       0.000572122748
  error estimate for blocks of size 2^( 4) =       0.000585660549
  error estimate for blocks of size 2^( 5) =       0.000594094897
  error estimate for blocks of size 2^( 6) =       0.000597843086
  error estimate for blocks of size 2^( 7) =       0.000600751150

      target function =                  N/A
              le_mean =     -22.437323257470
             les_mean =     504.002080969246
             stat err =       0.000594587421
             autocorr =       1.243511388975
              std dev =       0.754059873846
             le_variance =       0.568606293345


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243732325747e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437323257470       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437323257470       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437323257471       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437323256768       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437323257473       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437323257754       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437323257235       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437323257442       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437323259288       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437323256782       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+05 is 2.119729e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437323257470       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437323257470       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437323257470       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437323254917       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437323258036       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437323257470       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437323257380       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437323259778       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437323254306       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437323257663       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+06 is 5.299345e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437323257470       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437323257470       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437323257470       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437323273397       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437323249043       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437323259939       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437323251740       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437323268620       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437323258268       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437323273760       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+07 is 1.324818e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3060e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.4288
    reference variance = 0.37015
====================================================
  Execution time = 4.5970e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2439e+01
  VMC Evar = 5.5878e-01
  Total weights = 2.0000e+06
  Execution time = 3.8694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558843827232
                                         uncertainty =       0.003782173051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558843827232
                                         uncertainty =       0.003782173051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528575835
  error estimate for blocks of size 2^( 2) =       0.000548425662
  error estimate for blocks of size 2^( 3) =       0.000567659987
  error estimate for blocks of size 2^( 4) =       0.000581615194
  error estimate for blocks of size 2^( 5) =       0.000590211288
  error estimate for blocks of size 2^( 6) =       0.000593689589
  error estimate for blocks of size 2^( 7) =       0.000596084647

      target function =                  N/A
              le_mean =     -22.438650166468
             les_mean =     504.051805840701
             stat err =       0.000590400179
             autocorr =       1.247608578102
              std dev =       0.747519114793
             le_variance =       0.558784826981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558843827334
                                         uncertainty =       0.003782173052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558843827334
                                         uncertainty =       0.003782173052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528575835
  error estimate for blocks of size 2^( 2) =       0.000548425662
  error estimate for blocks of size 2^( 3) =       0.000567659987
  error estimate for blocks of size 2^( 4) =       0.000581615194
  error estimate for blocks of size 2^( 5) =       0.000590211288
  error estimate for blocks of size 2^( 6) =       0.000593689589
  error estimate for blocks of size 2^( 7) =       0.000596084647

      target function =                  N/A
              le_mean =     -22.438650166466
             les_mean =     504.051805840740
             stat err =       0.000590400179
             autocorr =       1.247608577998
              std dev =       0.747519114861
             le_variance =       0.558784827083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558843827283
                                         uncertainty =       0.003782173052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558843827283
                                         uncertainty =       0.003782173052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528575835
  error estimate for blocks of size 2^( 2) =       0.000548425662
  error estimate for blocks of size 2^( 3) =       0.000567659987
  error estimate for blocks of size 2^( 4) =       0.000581615194
  error estimate for blocks of size 2^( 5) =       0.000590211288
  error estimate for blocks of size 2^( 6) =       0.000593689589
  error estimate for blocks of size 2^( 7) =       0.000596084647

      target function =                  N/A
              le_mean =     -22.438650166467
             les_mean =     504.051805840720
             stat err =       0.000590400179
             autocorr =       1.247608578055
              std dev =       0.747519114827
             le_variance =       0.558784827032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558843827238
                                         uncertainty =       0.003782173051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558843827238
                                         uncertainty =       0.003782173051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528575835
  error estimate for blocks of size 2^( 2) =       0.000548425662
  error estimate for blocks of size 2^( 3) =       0.000567659987
  error estimate for blocks of size 2^( 4) =       0.000581615194
  error estimate for blocks of size 2^( 5) =       0.000590211288
  error estimate for blocks of size 2^( 6) =       0.000593689589
  error estimate for blocks of size 2^( 7) =       0.000596084647

      target function =                  N/A
              le_mean =     -22.438650166467
             les_mean =     504.051805840703
             stat err =       0.000590400179
             autocorr =       1.247608578098
              std dev =       0.747519114797
             le_variance =       0.558784826988


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.438650166468        initial  <--
     9.3132e+05     9.3132e+06             2.1197e-10       -22.438650166466
     3.7253e+06     3.7253e+07             5.2993e-11       -22.438650166467
     1.4901e+07     1.4901e+08             1.3248e-11       -22.438650166467

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.3197
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2864e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2438e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.4438
    reference variance = 0.469998
====================================================
  Execution time = 4.6028e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6069e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5569e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560788618173
                                         uncertainty =       0.003385565985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560788618173
                                         uncertainty =       0.003385565985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529474845
  error estimate for blocks of size 2^( 2) =       0.000549334671
  error estimate for blocks of size 2^( 3) =       0.000568677441
  error estimate for blocks of size 2^( 4) =       0.000582505667
  error estimate for blocks of size 2^( 5) =       0.000590411063
  error estimate for blocks of size 2^( 6) =       0.000594569878
  error estimate for blocks of size 2^( 7) =       0.000599535425

      target function =                  N/A
              le_mean =     -22.437272586974
             les_mean =     503.991888084581
             stat err =       0.000591755508
             autocorr =       1.249090642011
              std dev =       0.748790506578
             le_variance =       0.560687222741


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243727258697e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437272586974       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437272586974       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437272586974       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437272584782       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437272586974       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437272587622       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437272592345       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437272587823       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437272605620       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437272568359       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+06 is 2.137661e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437272586974       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437272586974       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437272586974       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437272580733       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437272607930       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437272603500       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437272535084       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437272581288       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437272560763       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437272585017       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+07 is 5.343385e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437272586974       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437272586974       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437272586974       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437272578446       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437272572832       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437272553516       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437272555270       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437272513668       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437272753514       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437272580947       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+08 is 1.335972e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271092 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.4292e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.5754
    reference variance = 1.34839
====================================================
  Execution time = 4.4898e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5700e-01
  Total weights = 2.0000e+06
  Execution time = 3.8615e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557009464757
                                         uncertainty =       0.003326185649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557009464757
                                         uncertainty =       0.003326185649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527732474
  error estimate for blocks of size 2^( 2) =       0.000548051074
  error estimate for blocks of size 2^( 3) =       0.000567135481
  error estimate for blocks of size 2^( 4) =       0.000581419992
  error estimate for blocks of size 2^( 5) =       0.000589935019
  error estimate for blocks of size 2^( 6) =       0.000592713370
  error estimate for blocks of size 2^( 7) =       0.000593948678

      target function =                  N/A
              le_mean =     -22.436657939200
             les_mean =     503.960622330489
             stat err =       0.000589504265
             autocorr =       1.247803686719
              std dev =       0.746326422111
             le_variance =       0.557003128341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557009464762
                                         uncertainty =       0.003326185649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557009464762
                                         uncertainty =       0.003326185649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527732474
  error estimate for blocks of size 2^( 2) =       0.000548051074
  error estimate for blocks of size 2^( 3) =       0.000567135481
  error estimate for blocks of size 2^( 4) =       0.000581419992
  error estimate for blocks of size 2^( 5) =       0.000589935019
  error estimate for blocks of size 2^( 6) =       0.000592713370
  error estimate for blocks of size 2^( 7) =       0.000593948679

      target function =                  N/A
              le_mean =     -22.436657939200
             les_mean =     503.960622330489
             stat err =       0.000589504265
             autocorr =       1.247803686722
              std dev =       0.746326422114
             le_variance =       0.557003128346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557009464760
                                         uncertainty =       0.003326185649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557009464760
                                         uncertainty =       0.003326185649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527732474
  error estimate for blocks of size 2^( 2) =       0.000548051074
  error estimate for blocks of size 2^( 3) =       0.000567135481
  error estimate for blocks of size 2^( 4) =       0.000581419992
  error estimate for blocks of size 2^( 5) =       0.000589935019
  error estimate for blocks of size 2^( 6) =       0.000592713370
  error estimate for blocks of size 2^( 7) =       0.000593948678

      target function =                  N/A
              le_mean =     -22.436657939200
             les_mean =     503.960622330489
             stat err =       0.000589504265
             autocorr =       1.247803686714
              std dev =       0.746326422112
             le_variance =       0.557003128343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557009464758
                                         uncertainty =       0.003326185649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557009464758
                                         uncertainty =       0.003326185649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527732474
  error estimate for blocks of size 2^( 2) =       0.000548051074
  error estimate for blocks of size 2^( 3) =       0.000567135481
  error estimate for blocks of size 2^( 4) =       0.000581419992
  error estimate for blocks of size 2^( 5) =       0.000589935019
  error estimate for blocks of size 2^( 6) =       0.000592713370
  error estimate for blocks of size 2^( 7) =       0.000593948678

      target function =                  N/A
              le_mean =     -22.436657939200
             les_mean =     503.960622330489
             stat err =       0.000589504265
             autocorr =       1.247803686716
              std dev =       0.746326422111
             le_variance =       0.557003128341


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436657939200        initial  <--
     9.3132e+06     9.3132e+07             2.1377e-11       -22.436657939200
     3.7253e+07     3.7253e+08             5.3434e-12       -22.436657939200
     1.4901e+08     1.4901e+09             1.3360e-12       -22.436657939200

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.3053
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2860e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2440e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.4711
    reference variance = 0.407474
====================================================
  Execution time = 4.5529e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7028e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5321e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570196244095
                                         uncertainty =       0.007999011052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570196244095
                                         uncertainty =       0.007999011052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533985642
  error estimate for blocks of size 2^( 2) =       0.000554356015
  error estimate for blocks of size 2^( 3) =       0.000572788251
  error estimate for blocks of size 2^( 4) =       0.000586203324
  error estimate for blocks of size 2^( 5) =       0.000593434823
  error estimate for blocks of size 2^( 6) =       0.000599333844
  error estimate for blocks of size 2^( 7) =       0.000600836981

      target function =                  N/A
              le_mean =     -22.436959158777
             les_mean =     503.987417339174
             stat err =       0.000594952243
             autocorr =       1.241380882803
              std dev =       0.755169736996
             le_variance =       0.570281331674


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243695915878e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436959158777       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436959158777       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436959158777       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436959158777       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436959177609       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436959180976       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436959175938       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436959178048       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436959148073       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436959111054       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+07 is 2.206261e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436959158777       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436959158777       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436959158777       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436959158777       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436959142952       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436958958730       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436959213195       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436959402603       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436959233861       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436959067696       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+08 is 5.521136e-13

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436959158777       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436959158777       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436959158777       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436959169290       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436958504602       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436959818090       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436958930289       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436958932648       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436960505885       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436956475743       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+09 is 1.382883e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.274542 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0858e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.4638
    reference variance = 0.809378
====================================================
  Execution time = 4.6831e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6823e-01
  Total weights = 2.0000e+06
  Execution time = 3.8600e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568311702388
                                         uncertainty =       0.005445398081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568311702388
                                         uncertainty =       0.005445398081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533022412
  error estimate for blocks of size 2^( 2) =       0.000553249820
  error estimate for blocks of size 2^( 3) =       0.000571714873
  error estimate for blocks of size 2^( 4) =       0.000585020979
  error estimate for blocks of size 2^( 5) =       0.000595332599
  error estimate for blocks of size 2^( 6) =       0.000599894288
  error estimate for blocks of size 2^( 7) =       0.000603721452

      target function =                  N/A
              le_mean =     -22.437863888818
             les_mean =     504.025961391358
             stat err =       0.000595992330
             autocorr =       1.250231397476
              std dev =       0.753807523422
             le_variance =       0.568225782367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568311702388
                                         uncertainty =       0.005445398081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568311702388
                                         uncertainty =       0.005445398081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533022412
  error estimate for blocks of size 2^( 2) =       0.000553249820
  error estimate for blocks of size 2^( 3) =       0.000571714873
  error estimate for blocks of size 2^( 4) =       0.000585020979
  error estimate for blocks of size 2^( 5) =       0.000595332599
  error estimate for blocks of size 2^( 6) =       0.000599894288
  error estimate for blocks of size 2^( 7) =       0.000603721452

      target function =                  N/A
              le_mean =     -22.437863888818
             les_mean =     504.025961391358
             stat err =       0.000595992330
             autocorr =       1.250231397469
              std dev =       0.753807523422
             le_variance =       0.568225782367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568311702388
                                         uncertainty =       0.005445398081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568311702388
                                         uncertainty =       0.005445398081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533022412
  error estimate for blocks of size 2^( 2) =       0.000553249820
  error estimate for blocks of size 2^( 3) =       0.000571714873
  error estimate for blocks of size 2^( 4) =       0.000585020979
  error estimate for blocks of size 2^( 5) =       0.000595332599
  error estimate for blocks of size 2^( 6) =       0.000599894288
  error estimate for blocks of size 2^( 7) =       0.000603721452

      target function =                  N/A
              le_mean =     -22.437863888818
             les_mean =     504.025961391358
             stat err =       0.000595992330
             autocorr =       1.250231397472
              std dev =       0.753807523422
             le_variance =       0.568225782367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568311702388
                                         uncertainty =       0.005445398081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568311702388
                                         uncertainty =       0.005445398081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533022412
  error estimate for blocks of size 2^( 2) =       0.000553249820
  error estimate for blocks of size 2^( 3) =       0.000571714873
  error estimate for blocks of size 2^( 4) =       0.000585020979
  error estimate for blocks of size 2^( 5) =       0.000595332599
  error estimate for blocks of size 2^( 6) =       0.000599894288
  error estimate for blocks of size 2^( 7) =       0.000603721452

      target function =                  N/A
              le_mean =     -22.437863888818
             les_mean =     504.025961391358
             stat err =       0.000595992330
             autocorr =       1.250231397467
              std dev =       0.753807523422
             le_variance =       0.568225782367


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437863888818        initial
     9.3132e+07     9.3132e+08             2.2063e-12       -22.437863888818  <--
     3.7253e+08     3.7253e+09             5.5211e-13       -22.437863888818
     1.4901e+09     1.4901e+10             1.3829e-13       -22.437863888818

*****************************************************************************
Applying the update for shift_i =   9.3132e+07     and shift_s =   9.3132e+08
*****************************************************************************

  Execution time = 6.6165e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2744e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2441e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.4516
    reference variance = 0.825095
====================================================
  Execution time = 4.6022e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 6.0142e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5521e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.601467720653
                                         uncertainty =       0.025476515264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.601467720653
                                         uncertainty =       0.025476515264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000548370705
  error estimate for blocks of size 2^( 2) =       0.000567745521
  error estimate for blocks of size 2^( 3) =       0.000585647430
  error estimate for blocks of size 2^( 4) =       0.000599562822
  error estimate for blocks of size 2^( 5) =       0.000609536323
  error estimate for blocks of size 2^( 6) =       0.000614738686
  error estimate for blocks of size 2^( 7) =       0.000617456250

      target function =                  N/A
              le_mean =     -22.437149913554
             les_mean =     504.027116803807
             stat err =       0.000610323520
             autocorr =       1.238715924670
              std dev =       0.775513288881
             le_variance =       0.601420861230


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243714991355e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437149913554       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437149913554       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437149913554       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437149920004       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437149909391       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437149913472       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437149910124       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437149913953       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437149910418       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437149891234       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+07 is 1.297084e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437149913554       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437149913554       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437149913554       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437149912855       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437149915550       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437149881057       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437149873177       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437149856315       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437149963828       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437149864926       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+07 is 3.242860e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437149913554       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437149913554       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437149913554       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437149890318       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437149917585       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437149708244       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437149928423       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437149987878       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437150225755       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437149951712       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+08 is 8.104900e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.278053 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1551e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.4602
    reference variance = 0.494856
====================================================
  Execution time = 4.7836e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6909e-01
  Total weights = 2.0000e+06
  Execution time = 3.8721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569066007182
                                         uncertainty =       0.005334690288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569066007182
                                         uncertainty =       0.005334690288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533427266
  error estimate for blocks of size 2^( 2) =       0.000553422736
  error estimate for blocks of size 2^( 3) =       0.000571351758
  error estimate for blocks of size 2^( 4) =       0.000584947267
  error estimate for blocks of size 2^( 5) =       0.000594404091
  error estimate for blocks of size 2^( 6) =       0.000600676466
  error estimate for blocks of size 2^( 7) =       0.000602023851

      target function =                  N/A
              le_mean =     -22.437564253118
             les_mean =     504.013378624049
             stat err =       0.000595512919
             autocorr =       1.246326855235
              std dev =       0.754380073819
             le_variance =       0.569089295775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569066007183
                                         uncertainty =       0.005334690287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569066007183
                                         uncertainty =       0.005334690287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533427266
  error estimate for blocks of size 2^( 2) =       0.000553422736
  error estimate for blocks of size 2^( 3) =       0.000571351758
  error estimate for blocks of size 2^( 4) =       0.000584947267
  error estimate for blocks of size 2^( 5) =       0.000594404091
  error estimate for blocks of size 2^( 6) =       0.000600676466
  error estimate for blocks of size 2^( 7) =       0.000602023851

      target function =                  N/A
              le_mean =     -22.437564253119
             les_mean =     504.013378624056
             stat err =       0.000595512919
             autocorr =       1.246326855234
              std dev =       0.754380073819
             le_variance =       0.569089295776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569066007183
                                         uncertainty =       0.005334690287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569066007183
                                         uncertainty =       0.005334690287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533427266
  error estimate for blocks of size 2^( 2) =       0.000553422736
  error estimate for blocks of size 2^( 3) =       0.000571351758
  error estimate for blocks of size 2^( 4) =       0.000584947267
  error estimate for blocks of size 2^( 5) =       0.000594404091
  error estimate for blocks of size 2^( 6) =       0.000600676466
  error estimate for blocks of size 2^( 7) =       0.000602023851

      target function =                  N/A
              le_mean =     -22.437564253119
             les_mean =     504.013378624053
             stat err =       0.000595512919
             autocorr =       1.246326855236
              std dev =       0.754380073819
             le_variance =       0.569089295775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569066007182
                                         uncertainty =       0.005334690288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569066007182
                                         uncertainty =       0.005334690288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533427266
  error estimate for blocks of size 2^( 2) =       0.000553422736
  error estimate for blocks of size 2^( 3) =       0.000571351758
  error estimate for blocks of size 2^( 4) =       0.000584947267
  error estimate for blocks of size 2^( 5) =       0.000594404091
  error estimate for blocks of size 2^( 6) =       0.000600676466
  error estimate for blocks of size 2^( 7) =       0.000602023851

      target function =                  N/A
              le_mean =     -22.437564253118
             les_mean =     504.013378624050
             stat err =       0.000595512919
             autocorr =       1.246326855233
              std dev =       0.754380073819
             le_variance =       0.569089295775


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437564253118        initial
     2.3283e+07     2.3283e+08             1.2971e-11       -22.437564253119  <--
     9.3132e+07     9.3132e+08             3.2429e-12       -22.437564253119
     3.7253e+08     3.7253e+09             8.1049e-13       -22.437564253118

*****************************************************************************
Applying the update for shift_i =   2.3283e+07     and shift_s =   2.3283e+08
*****************************************************************************

  Execution time = 6.7214e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2878e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2441e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.3874
    reference variance = 0.55477
====================================================
  Execution time = 4.5571e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6300e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5285e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562676139229
                                         uncertainty =       0.003962733864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562676139229
                                         uncertainty =       0.003962733864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530566022
  error estimate for blocks of size 2^( 2) =       0.000550788274
  error estimate for blocks of size 2^( 3) =       0.000569660019
  error estimate for blocks of size 2^( 4) =       0.000583807970
  error estimate for blocks of size 2^( 5) =       0.000594084402
  error estimate for blocks of size 2^( 6) =       0.000600195086
  error estimate for blocks of size 2^( 7) =       0.000603046407

      target function =                  N/A
              le_mean =     -22.437468219630
             les_mean =     504.002980431868
             stat err =       0.000595283466
             autocorr =       1.258834896842
              std dev =       0.750333663408
             le_variance =       0.563000606443


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243746821963e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437468219630       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437468219630       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437468219630       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437468219488       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437468219631       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437468221087       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437468219629       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437468219384       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437468218785       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437468230351       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+06 is 5.862248e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437468219630       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437468219630       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437468219630       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437468225622       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437468232705       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437468243426       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437468337969       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437468220105       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437468209732       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437468222097       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+07 is 1.465875e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437468219630       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437468219630       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437468219630       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437468219630       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437468289489       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437468233114       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437468221377       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437468260194       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437468199934       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437468097508       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+07 is 3.664481e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.281481 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0865e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.373
    reference variance = 0.404886
====================================================
  Execution time = 4.5853e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6684e-01
  Total weights = 2.0000e+06
  Execution time = 3.8684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566898251615
                                         uncertainty =       0.004645028878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566898251615
                                         uncertainty =       0.004645028878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532372049
  error estimate for blocks of size 2^( 2) =       0.000552435402
  error estimate for blocks of size 2^( 3) =       0.000571217014
  error estimate for blocks of size 2^( 4) =       0.000585249795
  error estimate for blocks of size 2^( 5) =       0.000594139594
  error estimate for blocks of size 2^( 6) =       0.000598334765
  error estimate for blocks of size 2^( 7) =       0.000599610892

      target function =                  N/A
              le_mean =     -22.437843028812
             les_mean =     504.023639498444
             stat err =       0.000594333761
             autocorr =       1.246322145088
              std dev =       0.752887771366
             le_variance =       0.566839996273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566898251688
                                         uncertainty =       0.004645028878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566898251688
                                         uncertainty =       0.004645028878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532372049
  error estimate for blocks of size 2^( 2) =       0.000552435402
  error estimate for blocks of size 2^( 3) =       0.000571217014
  error estimate for blocks of size 2^( 4) =       0.000585249795
  error estimate for blocks of size 2^( 5) =       0.000594139594
  error estimate for blocks of size 2^( 6) =       0.000598334765
  error estimate for blocks of size 2^( 7) =       0.000599610892

      target function =                  N/A
              le_mean =     -22.437843028811
             les_mean =     504.023639498495
             stat err =       0.000594333762
             autocorr =       1.246322145038
              std dev =       0.752887771415
             le_variance =       0.566839996347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566898251651
                                         uncertainty =       0.004645028878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566898251651
                                         uncertainty =       0.004645028878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532372049
  error estimate for blocks of size 2^( 2) =       0.000552435402
  error estimate for blocks of size 2^( 3) =       0.000571217014
  error estimate for blocks of size 2^( 4) =       0.000585249795
  error estimate for blocks of size 2^( 5) =       0.000594139594
  error estimate for blocks of size 2^( 6) =       0.000598334765
  error estimate for blocks of size 2^( 7) =       0.000599610892

      target function =                  N/A
              le_mean =     -22.437843028811
             les_mean =     504.023639498469
             stat err =       0.000594333761
             autocorr =       1.246322145061
              std dev =       0.752887771391
             le_variance =       0.566839996310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566898251619
                                         uncertainty =       0.004645028878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566898251619
                                         uncertainty =       0.004645028878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532372049
  error estimate for blocks of size 2^( 2) =       0.000552435402
  error estimate for blocks of size 2^( 3) =       0.000571217014
  error estimate for blocks of size 2^( 4) =       0.000585249795
  error estimate for blocks of size 2^( 5) =       0.000594139594
  error estimate for blocks of size 2^( 6) =       0.000598334765
  error estimate for blocks of size 2^( 7) =       0.000599610892

      target function =                  N/A
              le_mean =     -22.437843028812
             les_mean =     504.023639498447
             stat err =       0.000594333761
             autocorr =       1.246322145083
              std dev =       0.752887771369
             le_variance =       0.566839996277


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437843028812        initial  <--
     5.8208e+06     5.8208e+07             5.8622e-11       -22.437843028811
     2.3283e+07     2.3283e+08             1.4659e-11       -22.437843028811
     9.3132e+07     9.3132e+08             3.6645e-12       -22.437843028812

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.7533
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2962e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2440e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.4667
    reference variance = 0.579018
====================================================
  Execution time = 4.5620e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.8274e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5895e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.582793896331
                                         uncertainty =       0.022485129888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.582793896331
                                         uncertainty =       0.022485129888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539787175
  error estimate for blocks of size 2^( 2) =       0.000559606150
  error estimate for blocks of size 2^( 3) =       0.000578308678
  error estimate for blocks of size 2^( 4) =       0.000591571205
  error estimate for blocks of size 2^( 5) =       0.000599531452
  error estimate for blocks of size 2^( 6) =       0.000602615041
  error estimate for blocks of size 2^( 7) =       0.000607302822

      target function =                  N/A
              le_mean =     -22.437194496335
             les_mean =     504.010436964515
             stat err =       0.000600255130
             autocorr =       1.236592580364
              std dev =       0.763374344291
             le_variance =       0.582740389522


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243719449633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437194496335       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437194496335       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437194496335       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437194496154       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437194502479       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437194484693       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437194511227       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437194497817       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437194510994       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437194501187       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+07 is 3.506547e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437194496335       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437194496335       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437194496335       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437194339864       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437194490772       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437194497486       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437194495978       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437194446475       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437194440486       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437194398281       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+08 is 8.769222e-13

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437194496335       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437194496335       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437194496335       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437194324846       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437194211362       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437194924979       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437194067598       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437194605278       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437193410673       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437192574102       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+08 is 2.192580e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288748 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1531e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.3924
    reference variance = 0.397132
====================================================
  Execution time = 4.6340e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5872e-01
  Total weights = 2.0000e+06
  Execution time = 3.8684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558669746431
                                         uncertainty =       0.003825364716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558669746431
                                         uncertainty =       0.003825364716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528544070
  error estimate for blocks of size 2^( 2) =       0.000549395295
  error estimate for blocks of size 2^( 3) =       0.000567846371
  error estimate for blocks of size 2^( 4) =       0.000581602007
  error estimate for blocks of size 2^( 5) =       0.000590881851
  error estimate for blocks of size 2^( 6) =       0.000594860473
  error estimate for blocks of size 2^( 7) =       0.000597928422

      target function =                  N/A
              le_mean =     -22.436707198196
             les_mean =     503.964547285889
             stat err =       0.000591318189
             autocorr =       1.251641823131
              std dev =       0.747474191962
             le_variance =       0.558717667649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558669746433
                                         uncertainty =       0.003825364716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558669746433
                                         uncertainty =       0.003825364716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528544070
  error estimate for blocks of size 2^( 2) =       0.000549395295
  error estimate for blocks of size 2^( 3) =       0.000567846371
  error estimate for blocks of size 2^( 4) =       0.000581602007
  error estimate for blocks of size 2^( 5) =       0.000590881851
  error estimate for blocks of size 2^( 6) =       0.000594860473
  error estimate for blocks of size 2^( 7) =       0.000597928422

      target function =                  N/A
              le_mean =     -22.436707198196
             les_mean =     503.964547285889
             stat err =       0.000591318189
             autocorr =       1.251641823126
              std dev =       0.747474191963
             le_variance =       0.558717667651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558669746432
                                         uncertainty =       0.003825364716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558669746432
                                         uncertainty =       0.003825364716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528544070
  error estimate for blocks of size 2^( 2) =       0.000549395295
  error estimate for blocks of size 2^( 3) =       0.000567846371
  error estimate for blocks of size 2^( 4) =       0.000581602007
  error estimate for blocks of size 2^( 5) =       0.000590881851
  error estimate for blocks of size 2^( 6) =       0.000594860473
  error estimate for blocks of size 2^( 7) =       0.000597928422

      target function =                  N/A
              le_mean =     -22.436707198196
             les_mean =     503.964547285889
             stat err =       0.000591318189
             autocorr =       1.251641823127
              std dev =       0.747474191962
             le_variance =       0.558717667650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558669746431
                                         uncertainty =       0.003825364716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558669746431
                                         uncertainty =       0.003825364716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528544070
  error estimate for blocks of size 2^( 2) =       0.000549395295
  error estimate for blocks of size 2^( 3) =       0.000567846371
  error estimate for blocks of size 2^( 4) =       0.000581602007
  error estimate for blocks of size 2^( 5) =       0.000590881851
  error estimate for blocks of size 2^( 6) =       0.000594860473
  error estimate for blocks of size 2^( 7) =       0.000597928422

      target function =                  N/A
              le_mean =     -22.436707198196
             les_mean =     503.964547285889
             stat err =       0.000591318189
             autocorr =       1.251641823132
              std dev =       0.747474191962
             le_variance =       0.558717667649


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436707198196        initial  <--
     5.8208e+07     5.8208e+08             3.5065e-12       -22.436707198196
     2.3283e+08     2.3283e+09             8.7692e-13       -22.436707198196
     9.3132e+08     9.3132e+09             2.1926e-13       -22.436707198196

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.7070
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2725e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.5112
    reference variance = 0.529126
====================================================
  Execution time = 4.8233e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7218e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5401e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572187579352
                                         uncertainty =       0.006884841078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572187579352
                                         uncertainty =       0.006884841078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534874894
  error estimate for blocks of size 2^( 2) =       0.000554900426
  error estimate for blocks of size 2^( 3) =       0.000573703912
  error estimate for blocks of size 2^( 4) =       0.000588272526
  error estimate for blocks of size 2^( 5) =       0.000597070174
  error estimate for blocks of size 2^( 6) =       0.000601460749
  error estimate for blocks of size 2^( 7) =       0.000603061098

      target function =                  N/A
              le_mean =     -22.436926255303
             les_mean =     503.987841804833
             stat err =       0.000597466137
             autocorr =       1.247734442078
              std dev =       0.756427329638
             le_variance =       0.572182305023


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243692625530e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436926255303       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436926255303       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436926255303       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436926255303       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436926255303       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436926275029       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436926562463       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436926083298       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436926333210       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436926389075       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+08 is 3.393462e-13

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436926255303       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436926255303       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436926255303       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436926255303       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436926255303       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436926525148       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436923478594       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436928946813       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436927769355       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436925449454       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+09 is 8.545171e-14

solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436926255303       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436926255303       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436926255303       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436926255303       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436928263807       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436930833769       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436925416954       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436925862927       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436936587445       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436895574334       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436942234702       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436933789722       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436938407307       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436953925972       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436982202220       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436794863367       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436811413359       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436951447408       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.437096171203       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436746482046       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.436825122693       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.437031205611       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.436863713484       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.436818904072       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.436660423811       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.438511829281       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.436635261612       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.437651900539       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.437190025440       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.436964454174       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.436407588526       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.437357987914       residual = 9.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.437580514459       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.436657972949       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.437957945390       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.436869598988       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.436802466752       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.438265303170       residual = 9.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -22.436717438218       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -22.438505850876       residual = 1.23e-03           smallest_sin_value = 9.98e-01
davidson iteration   40:   krylov dim =  41   energy =     -22.437111828901       residual = 6.27e-05           smallest_sin_value = 9.97e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+09 is 2.112044e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.323003 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3674e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.4542
    reference variance = 0.284646
====================================================
  Execution time = 4.6989e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7481e-01
  Total weights = 2.0000e+06
  Execution time = 3.8812e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574908693103
                                         uncertainty =       0.011891996237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574908693103
                                         uncertainty =       0.011891996237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536103459
  error estimate for blocks of size 2^( 2) =       0.000556044818
  error estimate for blocks of size 2^( 3) =       0.000574270439
  error estimate for blocks of size 2^( 4) =       0.000587702994
  error estimate for blocks of size 2^( 5) =       0.000597319504
  error estimate for blocks of size 2^( 6) =       0.000600628332
  error estimate for blocks of size 2^( 7) =       0.000604235823

      target function =                  N/A
              le_mean =     -22.436836446411
             les_mean =     503.986443273334
             stat err =       0.000597471663
             autocorr =       1.242045216070
              std dev =       0.758164782725
             le_variance =       0.574813837765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574908693103
                                         uncertainty =       0.011891996237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574908693103
                                         uncertainty =       0.011891996237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536103459
  error estimate for blocks of size 2^( 2) =       0.000556044818
  error estimate for blocks of size 2^( 3) =       0.000574270439
  error estimate for blocks of size 2^( 4) =       0.000587702994
  error estimate for blocks of size 2^( 5) =       0.000597319504
  error estimate for blocks of size 2^( 6) =       0.000600628332
  error estimate for blocks of size 2^( 7) =       0.000604235823

      target function =                  N/A
              le_mean =     -22.436836446411
             les_mean =     503.986443273334
             stat err =       0.000597471663
             autocorr =       1.242045216070
              std dev =       0.758164782725
             le_variance =       0.574813837765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574908693103
                                         uncertainty =       0.011891996237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574908693103
                                         uncertainty =       0.011891996237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536103459
  error estimate for blocks of size 2^( 2) =       0.000556044818
  error estimate for blocks of size 2^( 3) =       0.000574270439
  error estimate for blocks of size 2^( 4) =       0.000587702994
  error estimate for blocks of size 2^( 5) =       0.000597319504
  error estimate for blocks of size 2^( 6) =       0.000600628332
  error estimate for blocks of size 2^( 7) =       0.000604235823

      target function =                  N/A
              le_mean =     -22.436836446411
             les_mean =     503.986443273334
             stat err =       0.000597471663
             autocorr =       1.242045216067
              std dev =       0.758164782725
             le_variance =       0.574813837765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574908693103
                                         uncertainty =       0.011891996237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574908693103
                                         uncertainty =       0.011891996237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536103459
  error estimate for blocks of size 2^( 2) =       0.000556044818
  error estimate for blocks of size 2^( 3) =       0.000574270439
  error estimate for blocks of size 2^( 4) =       0.000587702994
  error estimate for blocks of size 2^( 5) =       0.000597319504
  error estimate for blocks of size 2^( 6) =       0.000600628332
  error estimate for blocks of size 2^( 7) =       0.000604235823

      target function =                  N/A
              le_mean =     -22.436836446411
             les_mean =     503.986443273334
             stat err =       0.000597471663
             autocorr =       1.242045216071
              std dev =       0.758164782725
             le_variance =       0.574813837765


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436836446411        initial  <--
     5.8208e+08     5.8208e+09             3.3935e-13       -22.436836446411
     2.3283e+09     2.3283e+10             8.5452e-14       -22.436836446411
     9.3132e+09     9.3132e+10             2.1120e-14       -22.436836446411

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.4572
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3020e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2440e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.4203
    reference variance = 0.376838
====================================================
  Execution time = 4.8345e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6157e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5311e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561531760106
                                         uncertainty =       0.004732569343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561531760106
                                         uncertainty =       0.004732569343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529889666
  error estimate for blocks of size 2^( 2) =       0.000549804948
  error estimate for blocks of size 2^( 3) =       0.000567751757
  error estimate for blocks of size 2^( 4) =       0.000581279584
  error estimate for blocks of size 2^( 5) =       0.000590862845
  error estimate for blocks of size 2^( 6) =       0.000595740955
  error estimate for blocks of size 2^( 7) =       0.000598456066

      target function =                  N/A
              le_mean =     -22.437594524751
             les_mean =     504.007213893172
             stat err =       0.000591584862
             autocorr =       1.246416544509
              std dev =       0.749377152596
             le_variance =       0.561566116832


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243759452475e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437594524751       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437594524751       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437594524751       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437594524751       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437594700891       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437594594033       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437592490134       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437597680230       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437586222306       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437584909977       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437594220324       residual = 5.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+09 is 4.062866e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437594524751       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437594524751       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437594524751       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437593670928       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437594268725       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437585257400       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437563617718       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437604908194       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437600999588       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437606241395       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437637317643       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437674269777       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437559467970       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437686124576       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437622710317       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437501950338       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.437519359514       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.437727831365       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.437567390880       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436795855384       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.436501408651       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.437297819761       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.436494818867       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.436548790916       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.437594602064       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.435900833523       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.436684813154       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.440126628999       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.437793184885       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.438674224639       residual = 5.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.437357628799       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.438467860443       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.436195033871       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.438919433814       residual = 9.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.437482887514       residual = 2.74e-05           smallest_sin_value = 9.99e-01
davidson iteration   35:   krylov dim =  36   energy =     -22.436977001922       residual = 2.82e-04           smallest_sin_value = 9.96e-01
davidson iteration   36 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+10 is 1.012510e-14

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437594524751       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437594524751       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437594524751       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437637208360       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437554497112       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437539774275       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437787587155       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437678823022       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437692898353       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437918606168       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437902700597       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437341394132       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437230414050       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437854884205       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437788482459       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436634170391       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436983214989       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.438106139969       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436326427888       residual = 8.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.442171078459       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.440247592058       residual = 3.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.436793285946       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.440591878176       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.431044012530       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.433754668040       residual = 8.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.447721072389       residual = 5.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.438830448873       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.432449786398       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.440650878514       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.432205155394       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.439350183083       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.445701080672       residual = 3.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.451069259769       residual = 9.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.434377842500       residual = 5.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.426340753010       residual = 6.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.451542165794       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.439957948272       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.432771510564       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -22.438799845836       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -22.442556164452       residual = 1.35e-02           smallest_sin_value = 9.98e-01
davidson iteration   40:   krylov dim =  41   energy =     -22.420387218889       residual = 1.51e-01           smallest_sin_value = 9.91e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+10 is 1.865994e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.374145 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3712e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.3668
    reference variance = 0.388034
====================================================
  Execution time = 4.5304e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6538e-01
  Total weights = 2.0000e+06
  Execution time = 3.8575e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565287710155
                                         uncertainty =       0.007184354815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565287710155
                                         uncertainty =       0.007184354815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531683958
  error estimate for blocks of size 2^( 2) =       0.000551835503
  error estimate for blocks of size 2^( 3) =       0.000570501683
  error estimate for blocks of size 2^( 4) =       0.000583219630
  error estimate for blocks of size 2^( 5) =       0.000592694484
  error estimate for blocks of size 2^( 6) =       0.000596409823
  error estimate for blocks of size 2^( 7) =       0.000597382721

      target function =                  N/A
              le_mean =     -22.437774054093
             les_mean =     504.019079882883
             stat err =       0.000592426665
             autocorr =       1.241543900793
              std dev =       0.751914664722
             le_variance =       0.565375663024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565287710155
                                         uncertainty =       0.007184354815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565287710155
                                         uncertainty =       0.007184354815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531683958
  error estimate for blocks of size 2^( 2) =       0.000551835503
  error estimate for blocks of size 2^( 3) =       0.000570501683
  error estimate for blocks of size 2^( 4) =       0.000583219630
  error estimate for blocks of size 2^( 5) =       0.000592694484
  error estimate for blocks of size 2^( 6) =       0.000596409823
  error estimate for blocks of size 2^( 7) =       0.000597382721

      target function =                  N/A
              le_mean =     -22.437774054093
             les_mean =     504.019079882883
             stat err =       0.000592426665
             autocorr =       1.241543900793
              std dev =       0.751914664722
             le_variance =       0.565375663024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565287710155
                                         uncertainty =       0.007184354815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565287710155
                                         uncertainty =       0.007184354815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531683958
  error estimate for blocks of size 2^( 2) =       0.000551835503
  error estimate for blocks of size 2^( 3) =       0.000570501683
  error estimate for blocks of size 2^( 4) =       0.000583219630
  error estimate for blocks of size 2^( 5) =       0.000592694484
  error estimate for blocks of size 2^( 6) =       0.000596409823
  error estimate for blocks of size 2^( 7) =       0.000597382721

      target function =                  N/A
              le_mean =     -22.437774054093
             les_mean =     504.019079882883
             stat err =       0.000592426665
             autocorr =       1.241543900793
              std dev =       0.751914664722
             le_variance =       0.565375663024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565287710155
                                         uncertainty =       0.007184354815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565287710155
                                         uncertainty =       0.007184354815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531683958
  error estimate for blocks of size 2^( 2) =       0.000551835503
  error estimate for blocks of size 2^( 3) =       0.000570501683
  error estimate for blocks of size 2^( 4) =       0.000583219630
  error estimate for blocks of size 2^( 5) =       0.000592694484
  error estimate for blocks of size 2^( 6) =       0.000596409823
  error estimate for blocks of size 2^( 7) =       0.000597382721

      target function =                  N/A
              le_mean =     -22.437774054093
             les_mean =     504.019079882883
             stat err =       0.000592426665
             autocorr =       1.241543900794
              std dev =       0.751914664722
             le_variance =       0.565375663024


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437774054093        initial
     5.8208e+09     5.8208e+10             4.0629e-14       -22.437774054093
     2.3283e+10     2.3283e+11             1.0125e-14       -22.437774054093
     9.3132e+10     9.3132e+11             1.8660e-15       -22.437774054093  <--

*****************************************************************************
Applying the update for shift_i =   9.3132e+10     and shift_s =   9.3132e+11
*****************************************************************************

  Execution time = 6.4634e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2870e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.4441
    reference variance = 0.391853
====================================================
  Execution time = 4.8128e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6115e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5529e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561184586683
                                         uncertainty =       0.004158894685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561184586683
                                         uncertainty =       0.004158894685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529692906
  error estimate for blocks of size 2^( 2) =       0.000549875176
  error estimate for blocks of size 2^( 3) =       0.000568202684
  error estimate for blocks of size 2^( 4) =       0.000582092561
  error estimate for blocks of size 2^( 5) =       0.000592576608
  error estimate for blocks of size 2^( 6) =       0.000597102664
  error estimate for blocks of size 2^( 7) =       0.000599789380

      target function =                  N/A
              le_mean =     -22.437125922776
             les_mean =     503.985768544105
             stat err =       0.000592890303
             autocorr =       1.252853762162
              std dev =       0.749098892113
             le_variance =       0.561149150164


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243712592278e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437125922776       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437125922776       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437125922776       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437116511770       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437125586085       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437114930584       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437116161546       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437126412785       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437124595807       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437129180184       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437115113020       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437132390043       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437126562276       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437041630685       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437162685542       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437325788653       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.437167029039       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436725377407       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436693725534       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436825827830       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.438292184938       residual = 7.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.436813473747       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.437921472017       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.438638505689       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.439786417490       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.438694034373       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.436796310403       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.437104744537       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.436498339151       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.434790180423       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.437937435413       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.436791592939       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.439270804951       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.437586451361       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.436016170640       residual = 6.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.435660048832       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.436664841837       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.437945622885       residual = 6.10e-04           smallest_sin_value = 9.99e-01
davidson iteration   38:   krylov dim =  39   energy =     -22.438626304398       residual = 1.11e-03           smallest_sin_value = 9.99e-01
davidson iteration   39:   krylov dim =  40   energy =     -22.436318764843       residual = 3.04e-04           smallest_sin_value = 9.98e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+10 is 1.236328e-14

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437125922776       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437125922776       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437125922776       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437125922776       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437126111190       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437156669716       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437124701390       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437082510747       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437002452740       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437125541903       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436823015910       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436644221672       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436902395513       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437268850325       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437012558527       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436026611566       residual = 6.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.438616109136       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.435498023686       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436343571530       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436272092064       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.435603891181       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.435924237192       residual = 7.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.437143524497       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.435326583218       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.429711198177       residual = 3.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.436116837838       residual = 7.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.436998142943       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.438887738626       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.439297698428       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.443643708777       residual = 2.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.439336460127       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.445089564121       residual = 3.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.448669999408       residual = 6.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.431642828277       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.429210146364       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.440832441762       residual = 7.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.428594217960       residual = 3.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.459303985701       residual = 2.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -22.438782528900       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -22.433959669678       residual = 6.31e-03           smallest_sin_value = 9.99e-01
davidson iteration   40:   krylov dim =  41   energy =     -22.442571558918       residual = 1.36e-02           smallest_sin_value = 9.95e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.76e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+10 is 2.353541e-15

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437125922776       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437125922776       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437125922776       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437148166138       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437129981949       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437135995576       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437358011761       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437263246528       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436569487375       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437397025924       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437548537390       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437487589624       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.435836133633       residual = 9.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.435955062839       residual = 7.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.442718651156       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.435130745245       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.430153538494       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.435356287924       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.438064622443       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.423270790895       residual = 9.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.431737968540       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.437774343225       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.439816047067       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.422910578784       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.435627847486       residual = 3.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.455396440062       residual = 1.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.438331170467       residual = 9.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.439841831395       residual = 4.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.419099073234       residual = 1.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.436141364433       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.445316668968       residual = 3.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.438841485834       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.441106983281       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.402926109326       residual = 6.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.428918165757       residual = 3.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.429062903002       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.423606179125       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.424292943549       residual = 7.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -22.485709474037       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -22.396394416137       residual = 8.91e-01           smallest_sin_value = 9.98e-01
davidson iteration   40:   krylov dim =  41   energy =     -22.387975109611       residual = 1.21e+00           smallest_sin_value = 9.94e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.48e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+11 is 4.826692e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.459065 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3746e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.5095
    reference variance = 0.723639
====================================================
  Execution time = 4.5688e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5694e-01
  Total weights = 2.0000e+06
  Execution time = 3.8834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557012364691
                                         uncertainty =       0.003476433501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557012364691
                                         uncertainty =       0.003476433501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527703589
  error estimate for blocks of size 2^( 2) =       0.000548039413
  error estimate for blocks of size 2^( 3) =       0.000566919529
  error estimate for blocks of size 2^( 4) =       0.000581153774
  error estimate for blocks of size 2^( 5) =       0.000588875570
  error estimate for blocks of size 2^( 6) =       0.000594862586
  error estimate for blocks of size 2^( 7) =       0.000598633982

      target function =                  N/A
              le_mean =     -22.435868791472
             les_mean =     503.925150304411
             stat err =       0.000590881478
             autocorr =       1.253778037029
              std dev =       0.746285571841
             le_variance =       0.556942154738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557012364691
                                         uncertainty =       0.003476433501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557012364691
                                         uncertainty =       0.003476433501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527703589
  error estimate for blocks of size 2^( 2) =       0.000548039413
  error estimate for blocks of size 2^( 3) =       0.000566919529
  error estimate for blocks of size 2^( 4) =       0.000581153774
  error estimate for blocks of size 2^( 5) =       0.000588875570
  error estimate for blocks of size 2^( 6) =       0.000594862586
  error estimate for blocks of size 2^( 7) =       0.000598633982

      target function =                  N/A
              le_mean =     -22.435868791472
             les_mean =     503.925150304411
             stat err =       0.000590881478
             autocorr =       1.253778037026
              std dev =       0.746285571841
             le_variance =       0.556942154738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557012364691
                                         uncertainty =       0.003476433501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557012364691
                                         uncertainty =       0.003476433501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527703589
  error estimate for blocks of size 2^( 2) =       0.000548039413
  error estimate for blocks of size 2^( 3) =       0.000566919529
  error estimate for blocks of size 2^( 4) =       0.000581153774
  error estimate for blocks of size 2^( 5) =       0.000588875570
  error estimate for blocks of size 2^( 6) =       0.000594862586
  error estimate for blocks of size 2^( 7) =       0.000598633982

      target function =                  N/A
              le_mean =     -22.435868791472
             les_mean =     503.925150304411
             stat err =       0.000590881478
             autocorr =       1.253778037024
              std dev =       0.746285571841
             le_variance =       0.556942154738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557012364691
                                         uncertainty =       0.003476433501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557012364691
                                         uncertainty =       0.003476433501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527703589
  error estimate for blocks of size 2^( 2) =       0.000548039413
  error estimate for blocks of size 2^( 3) =       0.000566919529
  error estimate for blocks of size 2^( 4) =       0.000581153774
  error estimate for blocks of size 2^( 5) =       0.000588875570
  error estimate for blocks of size 2^( 6) =       0.000594862586
  error estimate for blocks of size 2^( 7) =       0.000598633982

      target function =                  N/A
              le_mean =     -22.435868791472
             les_mean =     503.925150304411
             stat err =       0.000590881478
             autocorr =       1.253778037029
              std dev =       0.746285571841
             le_variance =       0.556942154738


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435868791472        initial  <--
     2.3283e+10     2.3283e+11             1.2363e-14       -22.435868791472
     9.3132e+10     9.3132e+11             2.3535e-15       -22.435868791472
     3.7253e+11     3.7253e+12             4.8267e-16       -22.435868791472

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.1500
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2893e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2440e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.5486
    reference variance = 0.327019
====================================================
  Execution time = 4.6204e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6924e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5327e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569328877903
                                         uncertainty =       0.006197935460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569328877903
                                         uncertainty =       0.006197935460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533499585
  error estimate for blocks of size 2^( 2) =       0.000553576967
  error estimate for blocks of size 2^( 3) =       0.000572152255
  error estimate for blocks of size 2^( 4) =       0.000585986447
  error estimate for blocks of size 2^( 5) =       0.000594521087
  error estimate for blocks of size 2^( 6) =       0.000600165876
  error estimate for blocks of size 2^( 7) =       0.000599106432

      target function =                  N/A
              le_mean =     -22.437452800549
             les_mean =     504.008531507196
             stat err =       0.000594944961
             autocorr =       1.243613443323
              std dev =       0.754482349012
             le_variance =       0.569243614970


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243745280055e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437452800549       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437452800549       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437452800549       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437452810999       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437452800549       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437281263046       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437766088851       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437692841951       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438545797956       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435095047835       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.439107774458       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.439240770715       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.438833097794       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437009881784       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.445325245573       residual = 3.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.439731888426       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.433967934296       residual = 6.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.432982519901       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.431041666925       residual = 2.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.435829628160       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.433683177756       residual = 7.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.453313129277       residual = 1.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.443018049596       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.448618069737       residual = 6.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.443393810218       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.424962757411       residual = 8.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.430139766653       residual = 2.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.405505557247       residual = 5.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.452793280570       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.444730654091       residual = 3.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.431338226177       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.458716120495       residual = 2.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.449854533651       residual = 7.91e-02           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -22.451918614782       residual = 1.03e-01           smallest_sin_value = 9.97e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+11 is 4.819785e-16

solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437452800549       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437452800549       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437452800549       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437452800549       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437452800555       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437595541069       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437567209390       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438372182179       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437291413076       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.430357733133       residual = 2.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.448562565632       residual = 6.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.428200350618       residual = 4.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.432163597298       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.407189586107       residual = 4.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.442981765104       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436130355320       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.420107708011       residual = 1.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.443139452886       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.430213067000       residual = 2.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.487961181502       residual = 1.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.383209881056       residual = 1.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.425910320805       residual = 6.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.385600024458       residual = 1.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.466674187903       residual = 4.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.449549316651       residual = 8.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.427326903404       residual = 6.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.385827182794       residual = 1.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.436936523961       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.445318126223       residual = 1.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.434866377501       residual = 2.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.537978047569       residual = 5.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.359431272730       residual = 3.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.423719839553       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.370993366935       residual = 2.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.379650735346       residual = 1.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.586087390718       residual = 1.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.391065931068       residual = 1.25e+00           smallest_sin_value = 9.99e-01
davidson iteration   37:   krylov dim =  38   energy =     -22.376421946697       residual = 1.82e+00           smallest_sin_value = 9.96e-01
davidson iteration   38:   krylov dim =  39   energy =     -22.622253885221       residual = 1.83e+01           smallest_sin_value = 9.95e-01
davidson iteration   39 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         39 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+11 is 1.206375e-16

solving harmonic davidson linear method for identity shift 3.7253e+12, overlap shift 3.7253e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437452800549       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437452800549       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437452800549       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436032017241       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.439099813281       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438588775811       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.439887839912       residual = 4.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.441773859330       residual = 9.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.427080261159       residual = 5.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.450107635409       residual = 8.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.447031725421       residual = 5.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.458480024649       residual = 2.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.450960435412       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.464797591031       residual = 3.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.237166404440       residual = 2.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.375577943423       residual = 2.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.394894610733       residual = 9.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.494359435930       residual = 1.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.389609764802       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.345831374967       residual = 4.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.389586600898       residual = 1.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.428125040268       residual = 7.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.348083421087       residual = 4.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.550556655044       residual = 6.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.431190469984       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.309275285418       residual = 8.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.276555754196       residual = 1.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.462539467264       residual = 3.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.397757186226       residual = 1.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.621668953552       residual = 1.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.488699816051       residual = 2.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.190277283437       residual = 3.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.007242351492       residual = 9.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -23.034533515183       residual = 1.91e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.642698108708       residual = 2.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.641891112597       residual = 2.41e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.785270446920       residual = 6.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.269908904914       residual = 1.82e+01           smallest_sin_value = 9.99e-01
davidson iteration   38:   krylov dim =  39   energy =     -22.115774760955       residual = 5.20e+01           smallest_sin_value = 9.97e-01
davidson iteration   39:   krylov dim =  40   energy =     -22.070985711639       residual = 7.97e+01           smallest_sin_value = 9.91e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.36e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.528384 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1605e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.4644
    reference variance = 0.542212
====================================================
  Execution time = 4.7122e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6637e-01
  Total weights = 2.0000e+06
  Execution time = 3.8722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566469407256
                                         uncertainty =       0.004261736327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566469407256
                                         uncertainty =       0.004261736327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532152965
  error estimate for blocks of size 2^( 2) =       0.000552209023
  error estimate for blocks of size 2^( 3) =       0.000570992814
  error estimate for blocks of size 2^( 4) =       0.000584235719
  error estimate for blocks of size 2^( 5) =       0.000593492480
  error estimate for blocks of size 2^( 6) =       0.000598951908
  error estimate for blocks of size 2^( 7) =       0.000600241032

      target function =                  N/A
              le_mean =     -22.437782113462
             les_mean =     504.020439445218
             stat err =       0.000594230285
             autocorr =       1.246914255658
              std dev =       0.752577940963
             le_variance =       0.566373557225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566469407256
                                         uncertainty =       0.004261736327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566469407256
                                         uncertainty =       0.004261736327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532152965
  error estimate for blocks of size 2^( 2) =       0.000552209023
  error estimate for blocks of size 2^( 3) =       0.000570992814
  error estimate for blocks of size 2^( 4) =       0.000584235719
  error estimate for blocks of size 2^( 5) =       0.000593492480
  error estimate for blocks of size 2^( 6) =       0.000598951908
  error estimate for blocks of size 2^( 7) =       0.000600241032

      target function =                  N/A
              le_mean =     -22.437782113462
             les_mean =     504.020439445218
             stat err =       0.000594230285
             autocorr =       1.246914255658
              std dev =       0.752577940963
             le_variance =       0.566373557224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566469407256
                                         uncertainty =       0.004261736327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566469407256
                                         uncertainty =       0.004261736327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532152965
  error estimate for blocks of size 2^( 2) =       0.000552209023
  error estimate for blocks of size 2^( 3) =       0.000570992814
  error estimate for blocks of size 2^( 4) =       0.000584235719
  error estimate for blocks of size 2^( 5) =       0.000593492480
  error estimate for blocks of size 2^( 6) =       0.000598951908
  error estimate for blocks of size 2^( 7) =       0.000600241032

      target function =                  N/A
              le_mean =     -22.437782113462
             les_mean =     504.020439445218
             stat err =       0.000594230285
             autocorr =       1.246914255660
              std dev =       0.752577940963
             le_variance =       0.566373557224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566469407256
                                         uncertainty =       0.004261736327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566469407256
                                         uncertainty =       0.004261736327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532152965
  error estimate for blocks of size 2^( 2) =       0.000552209023
  error estimate for blocks of size 2^( 3) =       0.000570992814
  error estimate for blocks of size 2^( 4) =       0.000584235719
  error estimate for blocks of size 2^( 5) =       0.000593492480
  error estimate for blocks of size 2^( 6) =       0.000598951908
  error estimate for blocks of size 2^( 7) =       0.000600241032

      target function =                  N/A
              le_mean =     -22.437782113462
             les_mean =     504.020439445218
             stat err =       0.000594230285
             autocorr =       1.246914255658
              std dev =       0.752577940963
             le_variance =       0.566373557225


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437782113462        initial
     2.3283e+11     2.3283e+12             4.8198e-16       -22.437782113462
     9.3132e+11     9.3132e+12             1.2064e-16       -22.437782113462  <--
     3.7253e+12     3.7253e+13             0.0000e+00       -22.437782113462

*****************************************************************************
Applying the update for shift_i =   9.3132e+11     and shift_s =   9.3132e+12
*****************************************************************************

  Execution time = 6.6506e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.739601e-01 1 1  ON 0
 uu_1                 9.863703e-02 1 1  ON 1
 uu_2                -1.784563e-02 1 1  ON 2
 uu_3                -8.833977e-02 1 1  ON 3
 uu_4                -1.300142e-01 1 1  ON 4
 uu_5                -1.551880e-01 1 1  ON 5
 uu_6                -1.679795e-01 1 1  ON 6
 uu_7                -1.686359e-01 1 1  ON 7
 uu_8                -1.529856e-01 1 1  ON 8
 uu_9                -1.129474e-01 1 1  ON 9
 ud_0                 4.660400e-01 1 1  ON 10
 ud_1                 1.816216e-01 1 1  ON 11
 ud_2                 3.094373e-02 1 1  ON 12
 ud_3                -5.384115e-02 1 1  ON 13
 ud_4                -1.042028e-01 1 1  ON 14
 ud_5                -1.374816e-01 1 1  ON 15
 ud_6                -1.582696e-01 1 1  ON 16
 ud_7                -1.658404e-01 1 1  ON 17
 ud_8                -1.567749e-01 1 1  ON 18
 ud_9                -1.264885e-01 1 1  ON 19
 eC_0                -6.709851e-01 1 1  ON 20
 eC_1                -4.980964e-01 1 1  ON 21
 eC_2                -1.966583e-01 1 1  ON 22
 eC_3                 2.182368e-02 1 1  ON 23
 eC_4                 1.639486e-01 1 1  ON 24
 eC_5                 2.843765e-01 1 1  ON 25
 eC_6                 3.000332e-01 1 1  ON 26
 eC_7                 3.287197e-01 1 1  ON 27
 eC_8                 2.213495e-01 1 1  ON 28
 eC_9                 4.708949e-02 1 1  ON 29
 eO_0                -1.207320e+00 1 1  ON 30
 eO_1                -8.147137e-01 1 1  ON 31
 eO_2                -3.215179e-01 1 1  ON 32
 eO_3                 4.497609e-03 1 1  ON 33
 eO_4                 2.290251e-01 1 1  ON 34
 eO_5                 3.701783e-01 1 1  ON 35
 eO_6                 4.054868e-01 1 1  ON 36
 eO_7                 4.309903e-01 1 1  ON 37
 eO_8                 4.437994e-01 1 1  ON 38
 eO_9                 3.233266e-01 1 1  ON 39
eH1_0                -1.649882e-01 1 1  ON 40
eH1_1                -6.446501e-02 1 1  ON 41
eH1_2                -4.335063e-02 1 1  ON 42
eH1_3                -4.066438e-02 1 1  ON 43
eH1_4                -2.056000e-03 1 1  ON 44
eH1_5                 9.937221e-03 1 1  ON 45
eH1_6                 3.966216e-02 1 1  ON 46
eH1_7                 4.560572e-02 1 1  ON 47
eH1_8                 3.129940e-02 1 1  ON 48
eH1_9                 9.090055e-02 1 1  ON 49
eH2_0                -1.673277e-01 1 1  ON 50
eH2_1                -6.724264e-02 1 1  ON 51
eH2_2                -4.591550e-02 1 1  ON 52
eH2_3                -4.350887e-02 1 1  ON 53
eH2_4                -4.985874e-03 1 1  ON 54
eH2_5                 6.736577e-03 1 1  ON 55
eH2_6                 3.617600e-02 1 1  ON 56
eH2_7                 4.269517e-02 1 1  ON 57
eH2_8                 2.831081e-02 1 1  ON 58
eH2_9                 9.544218e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2838e+02 secs
  Total Execution time = 5.1478e+03 secs

=========================================================
  A new xml input file : FORM.s039.cont.xml
